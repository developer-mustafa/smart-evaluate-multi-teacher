var _P=Object.defineProperty;var BP=(r,e,t)=>e in r?_P(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var Fe=(r,e,t)=>BP(r,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function Ng(r){return r+.5|0}const zc=(r,e,t)=>Math.max(Math.min(r,t),e);function hf(r){return zc(Ng(r*2.55),0,255)}function sA(r){return zc(Ng(r*255),0,255)}function Pl(r){return zc(Ng(r/2.55)/100,0,1)}function Z_(r){return zc(Ng(r*100),0,100)}const Va={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},xv=[..."0123456789ABCDEF"],CP=r=>xv[r&15],SP=r=>xv[(r&240)>>4]+xv[r&15],Mp=r=>(r&240)>>4===(r&15),kP=r=>Mp(r.r)&&Mp(r.g)&&Mp(r.b)&&Mp(r.a);function EP(r){var e=r.length,t;return r[0]==="#"&&(e===4||e===5?t={r:255&Va[r[1]]*17,g:255&Va[r[2]]*17,b:255&Va[r[3]]*17,a:e===5?Va[r[4]]*17:255}:(e===7||e===9)&&(t={r:Va[r[1]]<<4|Va[r[2]],g:Va[r[3]]<<4|Va[r[4]],b:Va[r[5]]<<4|Va[r[6]],a:e===9?Va[r[7]]<<4|Va[r[8]]:255})),t}const IP=(r,e)=>r<255?e(r):"";function TP(r){var e=kP(r)?CP:SP;return r?"#"+e(r.r)+e(r.g)+e(r.b)+IP(r.a,e):void 0}const FP=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function hI(r,e,t){const n=e*Math.min(t,1-t),s=(i,a=(i+r/30)%12)=>t-n*Math.max(Math.min(a-3,9-a,1),-1);return[s(0),s(8),s(4)]}function LP(r,e,t){const n=(s,i=(s+r/60)%6)=>t-t*e*Math.max(Math.min(i,4-i,1),0);return[n(5),n(3),n(1)]}function UP(r,e,t){const n=hI(r,1,.5);let s;for(e+t>1&&(s=1/(e+t),e*=s,t*=s),s=0;s<3;s++)n[s]*=1-e-t,n[s]+=e;return n}function MP(r,e,t,n,s){return r===s?(e-t)/n+(e<t?6:0):e===s?(t-r)/n+2:(r-e)/n+4}function yx(r){const t=r.r/255,n=r.g/255,s=r.b/255,i=Math.max(t,n,s),a=Math.min(t,n,s),o=(i+a)/2;let l,c,A;return i!==a&&(A=i-a,c=o>.5?A/(2-i-a):A/(i+a),l=MP(t,n,s,A,i),l=l*60+.5),[l|0,c||0,o]}function wx(r,e,t,n){return(Array.isArray(e)?r(e[0],e[1],e[2]):r(e,t,n)).map(sA)}function vx(r,e,t){return wx(hI,r,e,t)}function NP(r,e,t){return wx(UP,r,e,t)}function PP(r,e,t){return wx(LP,r,e,t)}function fI(r){return(r%360+360)%360}function DP(r){const e=FP.exec(r);let t=255,n;if(!e)return;e[5]!==n&&(t=e[6]?hf(+e[5]):sA(+e[5]));const s=fI(+e[2]),i=+e[3]/100,a=+e[4]/100;return e[1]==="hwb"?n=NP(s,i,a):e[1]==="hsv"?n=PP(s,i,a):n=vx(s,i,a),{r:n[0],g:n[1],b:n[2],a:t}}function RP(r,e){var t=yx(r);t[0]=fI(t[0]+e),t=vx(t),r.r=t[0],r.g=t[1],r.b=t[2]}function OP(r){if(!r)return;const e=yx(r),t=e[0],n=Z_(e[1]),s=Z_(e[2]);return r.a<255?`hsla(${t}, ${n}%, ${s}%, ${Pl(r.a)})`:`hsl(${t}, ${n}%, ${s}%)`}const eB={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},tB={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function QP(){const r={},e=Object.keys(tB),t=Object.keys(eB);let n,s,i,a,o;for(n=0;n<e.length;n++){for(a=o=e[n],s=0;s<t.length;s++)i=t[s],o=o.replace(i,eB[i]);i=parseInt(tB[a],16),r[o]=[i>>16&255,i>>8&255,i&255]}return r}let Np;function HP(r){Np||(Np=QP(),Np.transparent=[0,0,0,0]);const e=Np[r.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const jP=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function VP(r){const e=jP.exec(r);let t=255,n,s,i;if(e){if(e[7]!==n){const a=+e[7];t=e[8]?hf(a):zc(a*255,0,255)}return n=+e[1],s=+e[3],i=+e[5],n=255&(e[2]?hf(n):zc(n,0,255)),s=255&(e[4]?hf(s):zc(s,0,255)),i=255&(e[6]?hf(i):zc(i,0,255)),{r:n,g:s,b:i,a:t}}}function $P(r){return r&&(r.a<255?`rgba(${r.r}, ${r.g}, ${r.b}, ${Pl(r.a)})`:`rgb(${r.r}, ${r.g}, ${r.b})`)}const Hy=r=>r<=.0031308?r*12.92:Math.pow(r,1/2.4)*1.055-.055,Au=r=>r<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4);function GP(r,e,t){const n=Au(Pl(r.r)),s=Au(Pl(r.g)),i=Au(Pl(r.b));return{r:sA(Hy(n+t*(Au(Pl(e.r))-n))),g:sA(Hy(s+t*(Au(Pl(e.g))-s))),b:sA(Hy(i+t*(Au(Pl(e.b))-i))),a:r.a+t*(e.a-r.a)}}function Pp(r,e,t){if(r){let n=yx(r);n[e]=Math.max(0,Math.min(n[e]+n[e]*t,e===0?360:1)),n=vx(n),r.r=n[0],r.g=n[1],r.b=n[2]}}function gI(r,e){return r&&Object.assign(e||{},r)}function rB(r){var e={r:0,g:0,b:0,a:255};return Array.isArray(r)?r.length>=3&&(e={r:r[0],g:r[1],b:r[2],a:255},r.length>3&&(e.a=sA(r[3]))):(e=gI(r,{r:0,g:0,b:0,a:1}),e.a=sA(e.a)),e}function zP(r){return r.charAt(0)==="r"?VP(r):DP(r)}class cg{constructor(e){if(e instanceof cg)return e;const t=typeof e;let n;t==="object"?n=rB(e):t==="string"&&(n=EP(e)||HP(e)||zP(e)),this._rgb=n,this._valid=!!n}get valid(){return this._valid}get rgb(){var e=gI(this._rgb);return e&&(e.a=Pl(e.a)),e}set rgb(e){this._rgb=rB(e)}rgbString(){return this._valid?$P(this._rgb):void 0}hexString(){return this._valid?TP(this._rgb):void 0}hslString(){return this._valid?OP(this._rgb):void 0}mix(e,t){if(e){const n=this.rgb,s=e.rgb;let i;const a=t===i?.5:t,o=2*a-1,l=n.a-s.a,c=((o*l===-1?o:(o+l)/(1+o*l))+1)/2;i=1-c,n.r=255&c*n.r+i*s.r+.5,n.g=255&c*n.g+i*s.g+.5,n.b=255&c*n.b+i*s.b+.5,n.a=a*n.a+(1-a)*s.a,this.rgb=n}return this}interpolate(e,t){return e&&(this._rgb=GP(this._rgb,e._rgb,t)),this}clone(){return new cg(this.rgb)}alpha(e){return this._rgb.a=sA(e),this}clearer(e){const t=this._rgb;return t.a*=1-e,this}greyscale(){const e=this._rgb,t=Ng(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=t,this}opaquer(e){const t=this._rgb;return t.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return Pp(this._rgb,2,e),this}darken(e){return Pp(this._rgb,2,-e),this}saturate(e){return Pp(this._rgb,1,e),this}desaturate(e){return Pp(this._rgb,1,-e),this}rotate(e){return RP(this._rgb,e),this}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function Il(){}const KP=(()=>{let r=0;return()=>r++})();function pr(r){return r==null}function Sn(r){if(Array.isArray&&Array.isArray(r))return!0;const e=Object.prototype.toString.call(r);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function Br(r){return r!==null&&Object.prototype.toString.call(r)==="[object Object]"}function Kn(r){return(typeof r=="number"||r instanceof Number)&&isFinite(+r)}function ka(r,e){return Kn(r)?r:e}function qt(r,e){return typeof r>"u"?e:r}const qP=(r,e)=>typeof r=="string"&&r.endsWith("%")?parseFloat(r)/100:+r/e,pI=(r,e)=>typeof r=="string"&&r.endsWith("%")?parseFloat(r)/100*e:+r;function zt(r,e,t){if(r&&typeof r.call=="function")return r.apply(t,e)}function xr(r,e,t,n){let s,i,a;if(Sn(r))for(i=r.length,s=0;s<i;s++)e.call(t,r[s],s);else if(Br(r))for(a=Object.keys(r),i=a.length,s=0;s<i;s++)e.call(t,r[a[s]],a[s])}function Fm(r,e){let t,n,s,i;if(!r||!e||r.length!==e.length)return!1;for(t=0,n=r.length;t<n;++t)if(s=r[t],i=e[t],s.datasetIndex!==i.datasetIndex||s.index!==i.index)return!1;return!0}function Lm(r){if(Sn(r))return r.map(Lm);if(Br(r)){const e=Object.create(null),t=Object.keys(r),n=t.length;let s=0;for(;s<n;++s)e[t[s]]=Lm(r[t[s]]);return e}return r}function mI(r){return["__proto__","prototype","constructor"].indexOf(r)===-1}function WP(r,e,t,n){if(!mI(r))return;const s=e[r],i=t[r];Br(s)&&Br(i)?ol(s,i,n):e[r]=Lm(i)}function ol(r,e,t){const n=Sn(e)?e:[e],s=n.length;if(!Br(r))return r;t=t||{};const i=t.merger||WP;let a;for(let o=0;o<s;++o){if(a=n[o],!Br(a))continue;const l=Object.keys(a);for(let c=0,A=l.length;c<A;++c)i(l[c],r,a,t)}return r}function Mf(r,e){return ol(r,e,{merger:YP})}function YP(r,e,t){if(!mI(r))return;const n=e[r],s=t[r];Br(n)&&Br(s)?Mf(n,s):Object.prototype.hasOwnProperty.call(e,r)||(e[r]=Lm(s))}const nB={"":r=>r,x:r=>r.x,y:r=>r.y};function XP(r){const e=r.split("."),t=[];let n="";for(const s of e)n+=s,n.endsWith("\\")?n=n.slice(0,-1)+".":(t.push(n),n="");return t}function JP(r){const e=XP(r);return t=>{for(const n of e){if(n==="")break;t=t&&t[n]}return t}}function pA(r,e){return(nB[e]||(nB[e]=JP(e)))(r)}function xx(r){return r.charAt(0).toUpperCase()+r.slice(1)}const Ag=r=>typeof r<"u",mA=r=>typeof r=="function",sB=(r,e)=>{if(r.size!==e.size)return!1;for(const t of r)if(!e.has(t))return!1;return!0};function ZP(r){return r.type==="mouseup"||r.type==="click"||r.type==="contextmenu"}const Gr=Math.PI,In=2*Gr,eD=In+Gr,Um=Number.POSITIVE_INFINITY,tD=Gr/180,ds=Gr/2,YA=Gr/4,iB=Gr*2/3,Kc=Math.log10,eo=Math.sign;function wd(r,e,t){return Math.abs(r-e)<t}function aB(r){const e=Math.round(r);r=wd(r,e,r/1e3)?e:r;const t=Math.pow(10,Math.floor(Kc(r))),n=r/t;return(n<=1?1:n<=2?2:n<=5?5:10)*t}function rD(r){const e=[],t=Math.sqrt(r);let n;for(n=1;n<t;n++)r%n===0&&(e.push(n),e.push(r/n));return t===(t|0)&&e.push(t),e.sort((s,i)=>s-i).pop(),e}function nD(r){return typeof r=="symbol"||typeof r=="object"&&r!==null&&!(Symbol.toPrimitive in r||"toString"in r||"valueOf"in r)}function th(r){return!nD(r)&&!isNaN(parseFloat(r))&&isFinite(r)}function sD(r,e){const t=Math.round(r);return t-e<=r&&t+e>=r}function bI(r,e,t){let n,s,i;for(n=0,s=r.length;n<s;n++)i=r[n][t],isNaN(i)||(e.min=Math.min(e.min,i),e.max=Math.max(e.max,i))}function ho(r){return r*(Gr/180)}function _x(r){return r*(180/Gr)}function oB(r){if(!Kn(r))return;let e=1,t=0;for(;Math.round(r*e)/e!==r;)e*=10,t++;return t}function yI(r,e){const t=e.x-r.x,n=e.y-r.y,s=Math.sqrt(t*t+n*n);let i=Math.atan2(n,t);return i<-.5*Gr&&(i+=In),{angle:i,distance:s}}function _v(r,e){return Math.sqrt(Math.pow(e.x-r.x,2)+Math.pow(e.y-r.y,2))}function iD(r,e){return(r-e+eD)%In-Gr}function Si(r){return(r%In+In)%In}function dg(r,e,t,n){const s=Si(r),i=Si(e),a=Si(t),o=Si(i-s),l=Si(a-s),c=Si(s-i),A=Si(s-a);return s===i||s===a||n&&i===a||o>l&&c<A}function qs(r,e,t){return Math.max(e,Math.min(t,r))}function aD(r){return qs(r,-32768,32767)}function Ql(r,e,t,n=1e-6){return r>=Math.min(e,t)-n&&r<=Math.max(e,t)+n}function Bx(r,e,t){t=t||(a=>r[a]<e);let n=r.length-1,s=0,i;for(;n-s>1;)i=s+n>>1,t(i)?s=i:n=i;return{lo:s,hi:n}}const Hl=(r,e,t,n)=>Bx(r,t,n?s=>{const i=r[s][e];return i<t||i===t&&r[s+1][e]===t}:s=>r[s][e]<t),oD=(r,e,t)=>Bx(r,t,n=>r[n][e]>=t);function lD(r,e,t){let n=0,s=r.length;for(;n<s&&r[n]<e;)n++;for(;s>n&&r[s-1]>t;)s--;return n>0||s<r.length?r.slice(n,s):r}const wI=["push","pop","shift","splice","unshift"];function cD(r,e){if(r._chartjs){r._chartjs.listeners.push(e);return}Object.defineProperty(r,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),wI.forEach(t=>{const n="_onData"+xx(t),s=r[t];Object.defineProperty(r,t,{configurable:!0,enumerable:!1,value(...i){const a=s.apply(this,i);return r._chartjs.listeners.forEach(o=>{typeof o[n]=="function"&&o[n](...i)}),a}})})}function lB(r,e){const t=r._chartjs;if(!t)return;const n=t.listeners,s=n.indexOf(e);s!==-1&&n.splice(s,1),!(n.length>0)&&(wI.forEach(i=>{delete r[i]}),delete r._chartjs)}function vI(r){const e=new Set(r);return e.size===r.length?r:Array.from(e)}const xI=(function(){return typeof window>"u"?function(r){return r()}:window.requestAnimationFrame})();function _I(r,e){let t=[],n=!1;return function(...s){t=s,n||(n=!0,xI.call(window,()=>{n=!1,r.apply(e,t)}))}}function AD(r,e){let t;return function(...n){return e?(clearTimeout(t),t=setTimeout(r,e,n)):r.apply(this,n),e}}const Cx=r=>r==="start"?"left":r==="end"?"right":"center",_i=(r,e,t)=>r==="start"?e:r==="end"?t:(e+t)/2,dD=(r,e,t,n)=>r===(n?"left":"right")?t:r==="center"?(e+t)/2:e;function BI(r,e,t){const n=e.length;let s=0,i=n;if(r._sorted){const{iScale:a,vScale:o,_parsed:l}=r,c=r.dataset&&r.dataset.options?r.dataset.options.spanGaps:null,A=a.axis,{min:d,max:h,minDefined:u,maxDefined:p}=a.getUserBounds();if(u){if(s=Math.min(Hl(l,A,d).lo,t?n:Hl(e,A,a.getPixelForValue(d)).lo),c){const f=l.slice(0,s+1).reverse().findIndex(g=>!pr(g[o.axis]));s-=Math.max(0,f)}s=qs(s,0,n-1)}if(p){let f=Math.max(Hl(l,a.axis,h,!0).hi+1,t?0:Hl(e,A,a.getPixelForValue(h),!0).hi+1);if(c){const g=l.slice(f-1).findIndex(m=>!pr(m[o.axis]));f+=Math.max(0,g)}i=qs(f,s,n)-s}else i=n-s}return{start:s,count:i}}function CI(r){const{xScale:e,yScale:t,_scaleRanges:n}=r,s={xmin:e.min,xmax:e.max,ymin:t.min,ymax:t.max};if(!n)return r._scaleRanges=s,!0;const i=n.xmin!==e.min||n.xmax!==e.max||n.ymin!==t.min||n.ymax!==t.max;return Object.assign(n,s),i}const Dp=r=>r===0||r===1,cB=(r,e,t)=>-(Math.pow(2,10*(r-=1))*Math.sin((r-e)*In/t)),AB=(r,e,t)=>Math.pow(2,-10*r)*Math.sin((r-e)*In/t)+1,Nf={linear:r=>r,easeInQuad:r=>r*r,easeOutQuad:r=>-r*(r-2),easeInOutQuad:r=>(r/=.5)<1?.5*r*r:-.5*(--r*(r-2)-1),easeInCubic:r=>r*r*r,easeOutCubic:r=>(r-=1)*r*r+1,easeInOutCubic:r=>(r/=.5)<1?.5*r*r*r:.5*((r-=2)*r*r+2),easeInQuart:r=>r*r*r*r,easeOutQuart:r=>-((r-=1)*r*r*r-1),easeInOutQuart:r=>(r/=.5)<1?.5*r*r*r*r:-.5*((r-=2)*r*r*r-2),easeInQuint:r=>r*r*r*r*r,easeOutQuint:r=>(r-=1)*r*r*r*r+1,easeInOutQuint:r=>(r/=.5)<1?.5*r*r*r*r*r:.5*((r-=2)*r*r*r*r+2),easeInSine:r=>-Math.cos(r*ds)+1,easeOutSine:r=>Math.sin(r*ds),easeInOutSine:r=>-.5*(Math.cos(Gr*r)-1),easeInExpo:r=>r===0?0:Math.pow(2,10*(r-1)),easeOutExpo:r=>r===1?1:-Math.pow(2,-10*r)+1,easeInOutExpo:r=>Dp(r)?r:r<.5?.5*Math.pow(2,10*(r*2-1)):.5*(-Math.pow(2,-10*(r*2-1))+2),easeInCirc:r=>r>=1?r:-(Math.sqrt(1-r*r)-1),easeOutCirc:r=>Math.sqrt(1-(r-=1)*r),easeInOutCirc:r=>(r/=.5)<1?-.5*(Math.sqrt(1-r*r)-1):.5*(Math.sqrt(1-(r-=2)*r)+1),easeInElastic:r=>Dp(r)?r:cB(r,.075,.3),easeOutElastic:r=>Dp(r)?r:AB(r,.075,.3),easeInOutElastic(r){return Dp(r)?r:r<.5?.5*cB(r*2,.1125,.45):.5+.5*AB(r*2-1,.1125,.45)},easeInBack(r){return r*r*((1.70158+1)*r-1.70158)},easeOutBack(r){return(r-=1)*r*((1.70158+1)*r+1.70158)+1},easeInOutBack(r){let e=1.70158;return(r/=.5)<1?.5*(r*r*(((e*=1.525)+1)*r-e)):.5*((r-=2)*r*(((e*=1.525)+1)*r+e)+2)},easeInBounce:r=>1-Nf.easeOutBounce(1-r),easeOutBounce(r){return r<1/2.75?7.5625*r*r:r<2/2.75?7.5625*(r-=1.5/2.75)*r+.75:r<2.5/2.75?7.5625*(r-=2.25/2.75)*r+.9375:7.5625*(r-=2.625/2.75)*r+.984375},easeInOutBounce:r=>r<.5?Nf.easeInBounce(r*2)*.5:Nf.easeOutBounce(r*2-1)*.5+.5};function Sx(r){if(r&&typeof r=="object"){const e=r.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function dB(r){return Sx(r)?r:new cg(r)}function jy(r){return Sx(r)?r:new cg(r).saturate(.5).darken(.1).hexString()}const uD=["x","y","borderWidth","radius","tension"],hD=["color","borderColor","backgroundColor"];function fD(r){r.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),r.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),r.set("animations",{colors:{type:"color",properties:hD},numbers:{type:"number",properties:uD}}),r.describe("animations",{_fallback:"animation"}),r.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function gD(r){r.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const uB=new Map;function pD(r,e){e=e||{};const t=r+JSON.stringify(e);let n=uB.get(t);return n||(n=new Intl.NumberFormat(r,e),uB.set(t,n)),n}function Pg(r,e,t){return pD(e,t).format(r)}const SI={values(r){return Sn(r)?r:""+r},numeric(r,e,t){if(r===0)return"0";const n=this.chart.options.locale;let s,i=r;if(t.length>1){const c=Math.max(Math.abs(t[0].value),Math.abs(t[t.length-1].value));(c<1e-4||c>1e15)&&(s="scientific"),i=mD(r,t)}const a=Kc(Math.abs(i)),o=isNaN(a)?1:Math.max(Math.min(-1*Math.floor(a),20),0),l={notation:s,minimumFractionDigits:o,maximumFractionDigits:o};return Object.assign(l,this.options.ticks.format),Pg(r,n,l)},logarithmic(r,e,t){if(r===0)return"0";const n=t[e].significand||r/Math.pow(10,Math.floor(Kc(r)));return[1,2,3,5,10,15].includes(n)||e>.8*t.length?SI.numeric.call(this,r,e,t):""}};function mD(r,e){let t=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(t)>=1&&r!==Math.floor(r)&&(t=r-Math.floor(r)),t}var Eb={formatters:SI};function bD(r){r.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,t)=>t.lineWidth,tickColor:(e,t)=>t.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Eb.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),r.route("scale.ticks","color","","color"),r.route("scale.grid","color","","borderColor"),r.route("scale.border","color","","borderColor"),r.route("scale.title","color","","color"),r.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),r.describe("scales",{_fallback:"scale"}),r.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const Fd=Object.create(null),Bv=Object.create(null);function Pf(r,e){if(!e)return r;const t=e.split(".");for(let n=0,s=t.length;n<s;++n){const i=t[n];r=r[i]||(r[i]=Object.create(null))}return r}function Vy(r,e,t){return typeof e=="string"?ol(Pf(r,e),t):ol(Pf(r,""),e)}class yD{constructor(e,t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=n=>n.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(n,s)=>jy(s.backgroundColor),this.hoverBorderColor=(n,s)=>jy(s.borderColor),this.hoverColor=(n,s)=>jy(s.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(t)}set(e,t){return Vy(this,e,t)}get(e){return Pf(this,e)}describe(e,t){return Vy(Bv,e,t)}override(e,t){return Vy(Fd,e,t)}route(e,t,n,s){const i=Pf(this,e),a=Pf(this,n),o="_"+t;Object.defineProperties(i,{[o]:{value:i[t],writable:!0},[t]:{enumerable:!0,get(){const l=this[o],c=a[s];return Br(l)?Object.assign({},c,l):qt(l,c)},set(l){this[o]=l}}})}apply(e){e.forEach(t=>t(this))}}var Tn=new yD({_scriptable:r=>!r.startsWith("on"),_indexable:r=>r!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[fD,gD,bD]);function wD(r){return!r||pr(r.size)||pr(r.family)?null:(r.style?r.style+" ":"")+(r.weight?r.weight+" ":"")+r.size+"px "+r.family}function Mm(r,e,t,n,s){let i=e[s];return i||(i=e[s]=r.measureText(s).width,t.push(s)),i>n&&(n=i),n}function vD(r,e,t,n){n=n||{};let s=n.data=n.data||{},i=n.garbageCollect=n.garbageCollect||[];n.font!==e&&(s=n.data={},i=n.garbageCollect=[],n.font=e),r.save(),r.font=e;let a=0;const o=t.length;let l,c,A,d,h;for(l=0;l<o;l++)if(d=t[l],d!=null&&!Sn(d))a=Mm(r,s,i,a,d);else if(Sn(d))for(c=0,A=d.length;c<A;c++)h=d[c],h!=null&&!Sn(h)&&(a=Mm(r,s,i,a,h));r.restore();const u=i.length/2;if(u>t.length){for(l=0;l<u;l++)delete s[i[l]];i.splice(0,u)}return a}function XA(r,e,t){const n=r.currentDevicePixelRatio,s=t!==0?Math.max(t/2,.5):0;return Math.round((e-s)*n)/n+s}function hB(r,e){!e&&!r||(e=e||r.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,r.width,r.height),e.restore())}function Cv(r,e,t,n){kI(r,e,t,n,null)}function kI(r,e,t,n,s){let i,a,o,l,c,A,d,h;const u=e.pointStyle,p=e.rotation,f=e.radius;let g=(p||0)*tD;if(u&&typeof u=="object"&&(i=u.toString(),i==="[object HTMLImageElement]"||i==="[object HTMLCanvasElement]")){r.save(),r.translate(t,n),r.rotate(g),r.drawImage(u,-u.width/2,-u.height/2,u.width,u.height),r.restore();return}if(!(isNaN(f)||f<=0)){switch(r.beginPath(),u){default:s?r.ellipse(t,n,s/2,f,0,0,In):r.arc(t,n,f,0,In),r.closePath();break;case"triangle":A=s?s/2:f,r.moveTo(t+Math.sin(g)*A,n-Math.cos(g)*f),g+=iB,r.lineTo(t+Math.sin(g)*A,n-Math.cos(g)*f),g+=iB,r.lineTo(t+Math.sin(g)*A,n-Math.cos(g)*f),r.closePath();break;case"rectRounded":c=f*.516,l=f-c,a=Math.cos(g+YA)*l,d=Math.cos(g+YA)*(s?s/2-c:l),o=Math.sin(g+YA)*l,h=Math.sin(g+YA)*(s?s/2-c:l),r.arc(t-d,n-o,c,g-Gr,g-ds),r.arc(t+h,n-a,c,g-ds,g),r.arc(t+d,n+o,c,g,g+ds),r.arc(t-h,n+a,c,g+ds,g+Gr),r.closePath();break;case"rect":if(!p){l=Math.SQRT1_2*f,A=s?s/2:l,r.rect(t-A,n-l,2*A,2*l);break}g+=YA;case"rectRot":d=Math.cos(g)*(s?s/2:f),a=Math.cos(g)*f,o=Math.sin(g)*f,h=Math.sin(g)*(s?s/2:f),r.moveTo(t-d,n-o),r.lineTo(t+h,n-a),r.lineTo(t+d,n+o),r.lineTo(t-h,n+a),r.closePath();break;case"crossRot":g+=YA;case"cross":d=Math.cos(g)*(s?s/2:f),a=Math.cos(g)*f,o=Math.sin(g)*f,h=Math.sin(g)*(s?s/2:f),r.moveTo(t-d,n-o),r.lineTo(t+d,n+o),r.moveTo(t+h,n-a),r.lineTo(t-h,n+a);break;case"star":d=Math.cos(g)*(s?s/2:f),a=Math.cos(g)*f,o=Math.sin(g)*f,h=Math.sin(g)*(s?s/2:f),r.moveTo(t-d,n-o),r.lineTo(t+d,n+o),r.moveTo(t+h,n-a),r.lineTo(t-h,n+a),g+=YA,d=Math.cos(g)*(s?s/2:f),a=Math.cos(g)*f,o=Math.sin(g)*f,h=Math.sin(g)*(s?s/2:f),r.moveTo(t-d,n-o),r.lineTo(t+d,n+o),r.moveTo(t+h,n-a),r.lineTo(t-h,n+a);break;case"line":a=s?s/2:Math.cos(g)*f,o=Math.sin(g)*f,r.moveTo(t-a,n-o),r.lineTo(t+a,n+o);break;case"dash":r.moveTo(t,n),r.lineTo(t+Math.cos(g)*(s?s/2:f),n+Math.sin(g)*f);break;case!1:r.closePath();break}r.fill(),e.borderWidth>0&&r.stroke()}}function Yo(r,e,t){return t=t||.5,!e||r&&r.x>e.left-t&&r.x<e.right+t&&r.y>e.top-t&&r.y<e.bottom+t}function Ib(r,e){r.save(),r.beginPath(),r.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),r.clip()}function Tb(r){r.restore()}function xD(r,e,t,n,s){if(!e)return r.lineTo(t.x,t.y);if(s==="middle"){const i=(e.x+t.x)/2;r.lineTo(i,e.y),r.lineTo(i,t.y)}else s==="after"!=!!n?r.lineTo(e.x,t.y):r.lineTo(t.x,e.y);r.lineTo(t.x,t.y)}function _D(r,e,t,n){if(!e)return r.lineTo(t.x,t.y);r.bezierCurveTo(n?e.cp1x:e.cp2x,n?e.cp1y:e.cp2y,n?t.cp2x:t.cp1x,n?t.cp2y:t.cp1y,t.x,t.y)}function BD(r,e){e.translation&&r.translate(e.translation[0],e.translation[1]),pr(e.rotation)||r.rotate(e.rotation),e.color&&(r.fillStyle=e.color),e.textAlign&&(r.textAlign=e.textAlign),e.textBaseline&&(r.textBaseline=e.textBaseline)}function CD(r,e,t,n,s){if(s.strikethrough||s.underline){const i=r.measureText(n),a=e-i.actualBoundingBoxLeft,o=e+i.actualBoundingBoxRight,l=t-i.actualBoundingBoxAscent,c=t+i.actualBoundingBoxDescent,A=s.strikethrough?(l+c)/2:c;r.strokeStyle=r.fillStyle,r.beginPath(),r.lineWidth=s.decorationWidth||2,r.moveTo(a,A),r.lineTo(o,A),r.stroke()}}function SD(r,e){const t=r.fillStyle;r.fillStyle=e.color,r.fillRect(e.left,e.top,e.width,e.height),r.fillStyle=t}function Ld(r,e,t,n,s,i={}){const a=Sn(e)?e:[e],o=i.strokeWidth>0&&i.strokeColor!=="";let l,c;for(r.save(),r.font=s.string,BD(r,i),l=0;l<a.length;++l)c=a[l],i.backdrop&&SD(r,i.backdrop),o&&(i.strokeColor&&(r.strokeStyle=i.strokeColor),pr(i.strokeWidth)||(r.lineWidth=i.strokeWidth),r.strokeText(c,t,n,i.maxWidth)),r.fillText(c,t,n,i.maxWidth),CD(r,t,n,c,i),n+=Number(s.lineHeight);r.restore()}function ug(r,e){const{x:t,y:n,w:s,h:i,radius:a}=e;r.arc(t+a.topLeft,n+a.topLeft,a.topLeft,1.5*Gr,Gr,!0),r.lineTo(t,n+i-a.bottomLeft),r.arc(t+a.bottomLeft,n+i-a.bottomLeft,a.bottomLeft,Gr,ds,!0),r.lineTo(t+s-a.bottomRight,n+i),r.arc(t+s-a.bottomRight,n+i-a.bottomRight,a.bottomRight,ds,0,!0),r.lineTo(t+s,n+a.topRight),r.arc(t+s-a.topRight,n+a.topRight,a.topRight,0,-ds,!0),r.lineTo(t+a.topLeft,n)}const kD=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,ED=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function ID(r,e){const t=(""+r).match(kD);if(!t||t[1]==="normal")return e*1.2;switch(r=+t[2],t[3]){case"px":return r;case"%":r/=100;break}return e*r}const TD=r=>+r||0;function kx(r,e){const t={},n=Br(e),s=n?Object.keys(e):e,i=Br(r)?n?a=>qt(r[a],r[e[a]]):a=>r[a]:()=>r;for(const a of s)t[a]=TD(i(a));return t}function EI(r){return kx(r,{top:"y",right:"x",bottom:"y",left:"x"})}function vd(r){return kx(r,["topLeft","topRight","bottomLeft","bottomRight"])}function ui(r){const e=EI(r);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function vs(r,e){r=r||{},e=e||Tn.font;let t=qt(r.size,e.size);typeof t=="string"&&(t=parseInt(t,10));let n=qt(r.style,e.style);n&&!(""+n).match(ED)&&(console.warn('Invalid font style specified: "'+n+'"'),n=void 0);const s={family:qt(r.family,e.family),lineHeight:ID(qt(r.lineHeight,e.lineHeight),t),size:t,style:n,weight:qt(r.weight,e.weight),string:""};return s.string=wD(s),s}function Cn(r,e,t,n){let s,i,a;for(s=0,i=r.length;s<i;++s)if(a=r[s],a!==void 0&&(e!==void 0&&typeof a=="function"&&(a=a(e)),t!==void 0&&Sn(a)&&(a=a[t%a.length]),a!==void 0))return a}function FD(r,e,t){const{min:n,max:s}=r,i=pI(e,(s-n)/2),a=(o,l)=>t&&o===0?0:o+l;return{min:a(n,-Math.abs(i)),max:a(s,i)}}function IA(r,e){return Object.assign(Object.create(r),e)}function Ex(r,e=[""],t,n,s=()=>r[0]){const i=t||r;typeof n>"u"&&(n=LI("_fallback",r));const a={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:r,_rootScopes:i,_fallback:n,_getTarget:s,override:o=>Ex([o,...r],e,i,n)};return new Proxy(a,{deleteProperty(o,l){return delete o[l],delete o._keys,delete r[0][l],!0},get(o,l){return TI(o,l,()=>OD(l,e,r,o))},getOwnPropertyDescriptor(o,l){return Reflect.getOwnPropertyDescriptor(o._scopes[0],l)},getPrototypeOf(){return Reflect.getPrototypeOf(r[0])},has(o,l){return gB(o).includes(l)},ownKeys(o){return gB(o)},set(o,l,c){const A=o._storage||(o._storage=s());return o[l]=A[l]=c,delete o._keys,!0}})}function rh(r,e,t,n){const s={_cacheable:!1,_proxy:r,_context:e,_subProxy:t,_stack:new Set,_descriptors:II(r,n),setContext:i=>rh(r,i,t,n),override:i=>rh(r.override(i),e,t,n)};return new Proxy(s,{deleteProperty(i,a){return delete i[a],delete r[a],!0},get(i,a,o){return TI(i,a,()=>UD(i,a,o))},getOwnPropertyDescriptor(i,a){return i._descriptors.allKeys?Reflect.has(r,a)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(r,a)},getPrototypeOf(){return Reflect.getPrototypeOf(r)},has(i,a){return Reflect.has(r,a)},ownKeys(){return Reflect.ownKeys(r)},set(i,a,o){return r[a]=o,delete i[a],!0}})}function II(r,e={scriptable:!0,indexable:!0}){const{_scriptable:t=e.scriptable,_indexable:n=e.indexable,_allKeys:s=e.allKeys}=r;return{allKeys:s,scriptable:t,indexable:n,isScriptable:mA(t)?t:()=>t,isIndexable:mA(n)?n:()=>n}}const LD=(r,e)=>r?r+xx(e):e,Ix=(r,e)=>Br(e)&&r!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function TI(r,e,t){if(Object.prototype.hasOwnProperty.call(r,e)||e==="constructor")return r[e];const n=t();return r[e]=n,n}function UD(r,e,t){const{_proxy:n,_context:s,_subProxy:i,_descriptors:a}=r;let o=n[e];return mA(o)&&a.isScriptable(e)&&(o=MD(e,o,r,t)),Sn(o)&&o.length&&(o=ND(e,o,r,a.isIndexable)),Ix(e,o)&&(o=rh(o,s,i&&i[e],a)),o}function MD(r,e,t,n){const{_proxy:s,_context:i,_subProxy:a,_stack:o}=t;if(o.has(r))throw new Error("Recursion detected: "+Array.from(o).join("->")+"->"+r);o.add(r);let l=e(i,a||n);return o.delete(r),Ix(r,l)&&(l=Tx(s._scopes,s,r,l)),l}function ND(r,e,t,n){const{_proxy:s,_context:i,_subProxy:a,_descriptors:o}=t;if(typeof i.index<"u"&&n(r))return e[i.index%e.length];if(Br(e[0])){const l=e,c=s._scopes.filter(A=>A!==l);e=[];for(const A of l){const d=Tx(c,s,r,A);e.push(rh(d,i,a&&a[r],o))}}return e}function FI(r,e,t){return mA(r)?r(e,t):r}const PD=(r,e)=>r===!0?e:typeof r=="string"?pA(e,r):void 0;function DD(r,e,t,n,s){for(const i of e){const a=PD(t,i);if(a){r.add(a);const o=FI(a._fallback,t,s);if(typeof o<"u"&&o!==t&&o!==n)return o}else if(a===!1&&typeof n<"u"&&t!==n)return null}return!1}function Tx(r,e,t,n){const s=e._rootScopes,i=FI(e._fallback,t,n),a=[...r,...s],o=new Set;o.add(n);let l=fB(o,a,t,i||t,n);return l===null||typeof i<"u"&&i!==t&&(l=fB(o,a,i,l,n),l===null)?!1:Ex(Array.from(o),[""],s,i,()=>RD(e,t,n))}function fB(r,e,t,n,s){for(;t;)t=DD(r,e,t,n,s);return t}function RD(r,e,t){const n=r._getTarget();e in n||(n[e]={});const s=n[e];return Sn(s)&&Br(t)?t:s||{}}function OD(r,e,t,n){let s;for(const i of e)if(s=LI(LD(i,r),t),typeof s<"u")return Ix(r,s)?Tx(t,n,r,s):s}function LI(r,e){for(const t of e){if(!t)continue;const n=t[r];if(typeof n<"u")return n}}function gB(r){let e=r._keys;return e||(e=r._keys=QD(r._scopes)),e}function QD(r){const e=new Set;for(const t of r)for(const n of Object.keys(t).filter(s=>!s.startsWith("_")))e.add(n);return Array.from(e)}function UI(r,e,t,n){const{iScale:s}=r,{key:i="r"}=this._parsing,a=new Array(n);let o,l,c,A;for(o=0,l=n;o<l;++o)c=o+t,A=e[c],a[o]={r:s.parse(pA(A,i),c)};return a}const HD=Number.EPSILON||1e-14,nh=(r,e)=>e<r.length&&!r[e].skip&&r[e],MI=r=>r==="x"?"y":"x";function jD(r,e,t,n){const s=r.skip?e:r,i=e,a=t.skip?e:t,o=_v(i,s),l=_v(a,i);let c=o/(o+l),A=l/(o+l);c=isNaN(c)?0:c,A=isNaN(A)?0:A;const d=n*c,h=n*A;return{previous:{x:i.x-d*(a.x-s.x),y:i.y-d*(a.y-s.y)},next:{x:i.x+h*(a.x-s.x),y:i.y+h*(a.y-s.y)}}}function VD(r,e,t){const n=r.length;let s,i,a,o,l,c=nh(r,0);for(let A=0;A<n-1;++A)if(l=c,c=nh(r,A+1),!(!l||!c)){if(wd(e[A],0,HD)){t[A]=t[A+1]=0;continue}s=t[A]/e[A],i=t[A+1]/e[A],o=Math.pow(s,2)+Math.pow(i,2),!(o<=9)&&(a=3/Math.sqrt(o),t[A]=s*a*e[A],t[A+1]=i*a*e[A])}}function $D(r,e,t="x"){const n=MI(t),s=r.length;let i,a,o,l=nh(r,0);for(let c=0;c<s;++c){if(a=o,o=l,l=nh(r,c+1),!o)continue;const A=o[t],d=o[n];a&&(i=(A-a[t])/3,o[`cp1${t}`]=A-i,o[`cp1${n}`]=d-i*e[c]),l&&(i=(l[t]-A)/3,o[`cp2${t}`]=A+i,o[`cp2${n}`]=d+i*e[c])}}function GD(r,e="x"){const t=MI(e),n=r.length,s=Array(n).fill(0),i=Array(n);let a,o,l,c=nh(r,0);for(a=0;a<n;++a)if(o=l,l=c,c=nh(r,a+1),!!l){if(c){const A=c[e]-l[e];s[a]=A!==0?(c[t]-l[t])/A:0}i[a]=o?c?eo(s[a-1])!==eo(s[a])?0:(s[a-1]+s[a])/2:s[a-1]:s[a]}VD(r,s,i),$D(r,i,e)}function Rp(r,e,t){return Math.max(Math.min(r,t),e)}function zD(r,e){let t,n,s,i,a,o=Yo(r[0],e);for(t=0,n=r.length;t<n;++t)a=i,i=o,o=t<n-1&&Yo(r[t+1],e),i&&(s=r[t],a&&(s.cp1x=Rp(s.cp1x,e.left,e.right),s.cp1y=Rp(s.cp1y,e.top,e.bottom)),o&&(s.cp2x=Rp(s.cp2x,e.left,e.right),s.cp2y=Rp(s.cp2y,e.top,e.bottom)))}function KD(r,e,t,n,s){let i,a,o,l;if(e.spanGaps&&(r=r.filter(c=>!c.skip)),e.cubicInterpolationMode==="monotone")GD(r,s);else{let c=n?r[r.length-1]:r[0];for(i=0,a=r.length;i<a;++i)o=r[i],l=jD(c,o,r[Math.min(i+1,a-(n?0:1))%a],e.tension),o.cp1x=l.previous.x,o.cp1y=l.previous.y,o.cp2x=l.next.x,o.cp2y=l.next.y,c=o}e.capBezierPoints&&zD(r,t)}function Fx(){return typeof window<"u"&&typeof document<"u"}function Lx(r){let e=r.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function Nm(r,e,t){let n;return typeof r=="string"?(n=parseInt(r,10),r.indexOf("%")!==-1&&(n=n/100*e.parentNode[t])):n=r,n}const Fb=r=>r.ownerDocument.defaultView.getComputedStyle(r,null);function qD(r,e){return Fb(r).getPropertyValue(e)}const WD=["top","right","bottom","left"];function xd(r,e,t){const n={};t=t?"-"+t:"";for(let s=0;s<4;s++){const i=WD[s];n[i]=parseFloat(r[e+"-"+i+t])||0}return n.width=n.left+n.right,n.height=n.top+n.bottom,n}const YD=(r,e,t)=>(r>0||e>0)&&(!t||!t.shadowRoot);function XD(r,e){const t=r.touches,n=t&&t.length?t[0]:r,{offsetX:s,offsetY:i}=n;let a=!1,o,l;if(YD(s,i,r.target))o=s,l=i;else{const c=e.getBoundingClientRect();o=n.clientX-c.left,l=n.clientY-c.top,a=!0}return{x:o,y:l,box:a}}function Go(r,e){if("native"in r)return r;const{canvas:t,currentDevicePixelRatio:n}=e,s=Fb(t),i=s.boxSizing==="border-box",a=xd(s,"padding"),o=xd(s,"border","width"),{x:l,y:c,box:A}=XD(r,t),d=a.left+(A&&o.left),h=a.top+(A&&o.top);let{width:u,height:p}=e;return i&&(u-=a.width+o.width,p-=a.height+o.height),{x:Math.round((l-d)/u*t.width/n),y:Math.round((c-h)/p*t.height/n)}}function JD(r,e,t){let n,s;if(e===void 0||t===void 0){const i=r&&Lx(r);if(!i)e=r.clientWidth,t=r.clientHeight;else{const a=i.getBoundingClientRect(),o=Fb(i),l=xd(o,"border","width"),c=xd(o,"padding");e=a.width-c.width-l.width,t=a.height-c.height-l.height,n=Nm(o.maxWidth,i,"clientWidth"),s=Nm(o.maxHeight,i,"clientHeight")}}return{width:e,height:t,maxWidth:n||Um,maxHeight:s||Um}}const qc=r=>Math.round(r*10)/10;function ZD(r,e,t,n){const s=Fb(r),i=xd(s,"margin"),a=Nm(s.maxWidth,r,"clientWidth")||Um,o=Nm(s.maxHeight,r,"clientHeight")||Um,l=JD(r,e,t);let{width:c,height:A}=l;if(s.boxSizing==="content-box"){const h=xd(s,"border","width"),u=xd(s,"padding");c-=u.width+h.width,A-=u.height+h.height}return c=Math.max(0,c-i.width),A=Math.max(0,n?c/n:A-i.height),c=qc(Math.min(c,a,l.maxWidth)),A=qc(Math.min(A,o,l.maxHeight)),c&&!A&&(A=qc(c/2)),(e!==void 0||t!==void 0)&&n&&l.height&&A>l.height&&(A=l.height,c=qc(Math.floor(A*n))),{width:c,height:A}}function pB(r,e,t){const n=e||1,s=qc(r.height*n),i=qc(r.width*n);r.height=qc(r.height),r.width=qc(r.width);const a=r.canvas;return a.style&&(t||!a.style.height&&!a.style.width)&&(a.style.height=`${r.height}px`,a.style.width=`${r.width}px`),r.currentDevicePixelRatio!==n||a.height!==s||a.width!==i?(r.currentDevicePixelRatio=n,a.height=s,a.width=i,r.ctx.setTransform(n,0,0,n,0,0),!0):!1}const e6=(function(){let r=!1;try{const e={get passive(){return r=!0,!1}};Fx()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return r})();function mB(r,e){const t=qD(r,e),n=t&&t.match(/^(\d+)(\.\d+)?px$/);return n?+n[1]:void 0}function td(r,e,t,n){return{x:r.x+t*(e.x-r.x),y:r.y+t*(e.y-r.y)}}function t6(r,e,t,n){return{x:r.x+t*(e.x-r.x),y:n==="middle"?t<.5?r.y:e.y:n==="after"?t<1?r.y:e.y:t>0?e.y:r.y}}function r6(r,e,t,n){const s={x:r.cp2x,y:r.cp2y},i={x:e.cp1x,y:e.cp1y},a=td(r,s,t),o=td(s,i,t),l=td(i,e,t),c=td(a,o,t),A=td(o,l,t);return td(c,A,t)}const n6=function(r,e){return{x(t){return r+r+e-t},setWidth(t){e=t},textAlign(t){return t==="center"?t:t==="right"?"left":"right"},xPlus(t,n){return t-n},leftForLtr(t,n){return t-n}}},s6=function(){return{x(r){return r},setWidth(r){},textAlign(r){return r},xPlus(r,e){return r+e},leftForLtr(r,e){return r}}};function Qu(r,e,t){return r?n6(e,t):s6()}function NI(r,e){let t,n;(e==="ltr"||e==="rtl")&&(t=r.canvas.style,n=[t.getPropertyValue("direction"),t.getPropertyPriority("direction")],t.setProperty("direction",e,"important"),r.prevTextDirection=n)}function PI(r,e){e!==void 0&&(delete r.prevTextDirection,r.canvas.style.setProperty("direction",e[0],e[1]))}function DI(r){return r==="angle"?{between:dg,compare:iD,normalize:Si}:{between:Ql,compare:(e,t)=>e-t,normalize:e=>e}}function bB({start:r,end:e,count:t,loop:n,style:s}){return{start:r%t,end:e%t,loop:n&&(e-r+1)%t===0,style:s}}function i6(r,e,t){const{property:n,start:s,end:i}=t,{between:a,normalize:o}=DI(n),l=e.length;let{start:c,end:A,loop:d}=r,h,u;if(d){for(c+=l,A+=l,h=0,u=l;h<u&&a(o(e[c%l][n]),s,i);++h)c--,A--;c%=l,A%=l}return A<c&&(A+=l),{start:c,end:A,loop:d,style:r.style}}function RI(r,e,t){if(!t)return[r];const{property:n,start:s,end:i}=t,a=e.length,{compare:o,between:l,normalize:c}=DI(n),{start:A,end:d,loop:h,style:u}=i6(r,e,t),p=[];let f=!1,g=null,m,x,S;const B=()=>l(s,S,m)&&o(s,S)!==0,F=()=>o(i,m)===0||l(i,S,m),N=()=>f||B(),E=()=>!f||F();for(let w=A,v=A;w<=d;++w)x=e[w%a],!x.skip&&(m=c(x[n]),m!==S&&(f=l(m,s,i),g===null&&N()&&(g=o(m,s)===0?w:v),g!==null&&E()&&(p.push(bB({start:g,end:w,loop:h,count:a,style:u})),g=null),v=w,S=m));return g!==null&&p.push(bB({start:g,end:d,loop:h,count:a,style:u})),p}function OI(r,e){const t=[],n=r.segments;for(let s=0;s<n.length;s++){const i=RI(n[s],r.points,e);i.length&&t.push(...i)}return t}function a6(r,e,t,n){let s=0,i=e-1;if(t&&!n)for(;s<e&&!r[s].skip;)s++;for(;s<e&&r[s].skip;)s++;for(s%=e,t&&(i+=s);i>s&&r[i%e].skip;)i--;return i%=e,{start:s,end:i}}function o6(r,e,t,n){const s=r.length,i=[];let a=e,o=r[e],l;for(l=e+1;l<=t;++l){const c=r[l%s];c.skip||c.stop?o.skip||(n=!1,i.push({start:e%s,end:(l-1)%s,loop:n}),e=a=c.stop?l:null):(a=l,o.skip&&(e=l)),o=c}return a!==null&&i.push({start:e%s,end:a%s,loop:n}),i}function l6(r,e){const t=r.points,n=r.options.spanGaps,s=t.length;if(!s)return[];const i=!!r._loop,{start:a,end:o}=a6(t,s,i,n);if(n===!0)return yB(r,[{start:a,end:o,loop:i}],t,e);const l=o<a?o+s:o,c=!!r._fullLoop&&a===0&&o===s-1;return yB(r,o6(t,a,l,c),t,e)}function yB(r,e,t,n){return!n||!n.setContext||!t?e:c6(r,e,t,n)}function c6(r,e,t,n){const s=r._chart.getContext(),i=wB(r.options),{_datasetIndex:a,options:{spanGaps:o}}=r,l=t.length,c=[];let A=i,d=e[0].start,h=d;function u(p,f,g,m){const x=o?-1:1;if(p!==f){for(p+=l;t[p%l].skip;)p-=x;for(;t[f%l].skip;)f+=x;p%l!==f%l&&(c.push({start:p%l,end:f%l,loop:g,style:m}),A=m,d=f%l)}}for(const p of e){d=o?d:p.start;let f=t[d%l],g;for(h=d+1;h<=p.end;h++){const m=t[h%l];g=wB(n.setContext(IA(s,{type:"segment",p0:f,p1:m,p0DataIndex:(h-1)%l,p1DataIndex:h%l,datasetIndex:a}))),A6(g,A)&&u(d,h-1,p.loop,A),f=m,A=g}d<h-1&&u(d,h-1,p.loop,A)}return c}function wB(r){return{backgroundColor:r.backgroundColor,borderCapStyle:r.borderCapStyle,borderDash:r.borderDash,borderDashOffset:r.borderDashOffset,borderJoinStyle:r.borderJoinStyle,borderWidth:r.borderWidth,borderColor:r.borderColor}}function A6(r,e){if(!e)return!1;const t=[],n=function(s,i){return Sx(i)?(t.includes(i)||t.push(i),t.indexOf(i)):i};return JSON.stringify(r,n)!==JSON.stringify(e,n)}function Op(r,e,t){return r.options.clip?r[t]:e[t]}function d6(r,e){const{xScale:t,yScale:n}=r;return t&&n?{left:Op(t,e,"left"),right:Op(t,e,"right"),top:Op(n,e,"top"),bottom:Op(n,e,"bottom")}:e}function QI(r,e){const t=e._clip;if(t.disabled)return!1;const n=d6(e,r.chartArea);return{left:t.left===!1?0:n.left-(t.left===!0?0:t.left),right:t.right===!1?r.width:n.right+(t.right===!0?0:t.right),top:t.top===!1?0:n.top-(t.top===!0?0:t.top),bottom:t.bottom===!1?r.height:n.bottom+(t.bottom===!0?0:t.bottom)}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class u6{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,t,n,s){const i=t.listeners[s],a=t.duration;i.forEach(o=>o({chart:e,initial:t.initial,numSteps:a,currentStep:Math.min(n-t.start,a)}))}_refresh(){this._request||(this._running=!0,this._request=xI.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let t=0;this._charts.forEach((n,s)=>{if(!n.running||!n.items.length)return;const i=n.items;let a=i.length-1,o=!1,l;for(;a>=0;--a)l=i[a],l._active?(l._total>n.duration&&(n.duration=l._total),l.tick(e),o=!0):(i[a]=i[i.length-1],i.pop());o&&(s.draw(),this._notify(s,n,e,"progress")),i.length||(n.running=!1,this._notify(s,n,e,"complete"),n.initial=!1),t+=i.length}),this._lastDate=e,t===0&&(this._running=!1)}_getAnims(e){const t=this._charts;let n=t.get(e);return n||(n={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,n)),n}listen(e,t,n){this._getAnims(e).listeners[t].push(n)}add(e,t){!t||!t.length||this._getAnims(e).items.push(...t)}has(e){return this._getAnims(e).items.length>0}start(e){const t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce((n,s)=>Math.max(n,s._duration),0),this._refresh())}running(e){if(!this._running)return!1;const t=this._charts.get(e);return!(!t||!t.running||!t.items.length)}stop(e){const t=this._charts.get(e);if(!t||!t.items.length)return;const n=t.items;let s=n.length-1;for(;s>=0;--s)n[s].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var Ml=new u6;const vB="transparent",h6={boolean(r,e,t){return t>.5?e:r},color(r,e,t){const n=dB(r||vB),s=n.valid&&dB(e||vB);return s&&s.valid?s.mix(n,t).hexString():e},number(r,e,t){return r+(e-r)*t}};class f6{constructor(e,t,n,s){const i=t[n];s=Cn([e.to,s,i,e.from]);const a=Cn([e.from,i,s]);this._active=!0,this._fn=e.fn||h6[e.type||typeof a],this._easing=Nf[e.easing]||Nf.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=t,this._prop=n,this._from=a,this._to=s,this._promises=void 0}active(){return this._active}update(e,t,n){if(this._active){this._notify(!1);const s=this._target[this._prop],i=n-this._start,a=this._duration-i;this._start=n,this._duration=Math.floor(Math.max(a,e.duration)),this._total+=i,this._loop=!!e.loop,this._to=Cn([e.to,t,s,e.from]),this._from=Cn([e.from,s,t])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const t=e-this._start,n=this._duration,s=this._prop,i=this._from,a=this._loop,o=this._to;let l;if(this._active=i!==o&&(a||t<n),!this._active){this._target[s]=o,this._notify(!0);return}if(t<0){this._target[s]=i;return}l=t/n%2,l=a&&l>1?2-l:l,l=this._easing(Math.min(1,Math.max(0,l))),this._target[s]=this._fn(i,o,l)}wait(){const e=this._promises||(this._promises=[]);return new Promise((t,n)=>{e.push({res:t,rej:n})})}_notify(e){const t=e?"res":"rej",n=this._promises||[];for(let s=0;s<n.length;s++)n[s][t]()}}class HI{constructor(e,t){this._chart=e,this._properties=new Map,this.configure(t)}configure(e){if(!Br(e))return;const t=Object.keys(Tn.animation),n=this._properties;Object.getOwnPropertyNames(e).forEach(s=>{const i=e[s];if(!Br(i))return;const a={};for(const o of t)a[o]=i[o];(Sn(i.properties)&&i.properties||[s]).forEach(o=>{(o===s||!n.has(o))&&n.set(o,a)})})}_animateOptions(e,t){const n=t.options,s=p6(e,n);if(!s)return[];const i=this._createAnimations(s,n);return n.$shared&&g6(e.options.$animations,n).then(()=>{e.options=n},()=>{}),i}_createAnimations(e,t){const n=this._properties,s=[],i=e.$animations||(e.$animations={}),a=Object.keys(t),o=Date.now();let l;for(l=a.length-1;l>=0;--l){const c=a[l];if(c.charAt(0)==="$")continue;if(c==="options"){s.push(...this._animateOptions(e,t));continue}const A=t[c];let d=i[c];const h=n.get(c);if(d)if(h&&d.active()){d.update(h,A,o);continue}else d.cancel();if(!h||!h.duration){e[c]=A;continue}i[c]=d=new f6(h,e,c,A),s.push(d)}return s}update(e,t){if(this._properties.size===0){Object.assign(e,t);return}const n=this._createAnimations(e,t);if(n.length)return Ml.add(this._chart,n),!0}}function g6(r,e){const t=[],n=Object.keys(e);for(let s=0;s<n.length;s++){const i=r[n[s]];i&&i.active()&&t.push(i.wait())}return Promise.all(t)}function p6(r,e){if(!e)return;let t=r.options;if(!t){r.options=e;return}return t.$shared&&(r.options=t=Object.assign({},t,{$shared:!1,$animations:{}})),t}function xB(r,e){const t=r&&r.options||{},n=t.reverse,s=t.min===void 0?e:0,i=t.max===void 0?e:0;return{start:n?i:s,end:n?s:i}}function m6(r,e,t){if(t===!1)return!1;const n=xB(r,t),s=xB(e,t);return{top:s.end,right:n.end,bottom:s.start,left:n.start}}function b6(r){let e,t,n,s;return Br(r)?(e=r.top,t=r.right,n=r.bottom,s=r.left):e=t=n=s=r,{top:e,right:t,bottom:n,left:s,disabled:r===!1}}function jI(r,e){const t=[],n=r._getSortedDatasetMetas(e);let s,i;for(s=0,i=n.length;s<i;++s)t.push(n[s].index);return t}function _B(r,e,t,n={}){const s=r.keys,i=n.mode==="single";let a,o,l,c;if(e===null)return;let A=!1;for(a=0,o=s.length;a<o;++a){if(l=+s[a],l===t){if(A=!0,n.all)continue;break}c=r.values[l],Kn(c)&&(i||e===0||eo(e)===eo(c))&&(e+=c)}return!A&&!n.all?0:e}function y6(r,e){const{iScale:t,vScale:n}=e,s=t.axis==="x"?"x":"y",i=n.axis==="x"?"x":"y",a=Object.keys(r),o=new Array(a.length);let l,c,A;for(l=0,c=a.length;l<c;++l)A=a[l],o[l]={[s]:A,[i]:r[A]};return o}function $y(r,e){const t=r&&r.options.stacked;return t||t===void 0&&e.stack!==void 0}function w6(r,e,t){return`${r.id}.${e.id}.${t.stack||t.type}`}function v6(r){const{min:e,max:t,minDefined:n,maxDefined:s}=r.getUserBounds();return{min:n?e:Number.NEGATIVE_INFINITY,max:s?t:Number.POSITIVE_INFINITY}}function x6(r,e,t){const n=r[e]||(r[e]={});return n[t]||(n[t]={})}function BB(r,e,t,n){for(const s of e.getMatchingVisibleMetas(n).reverse()){const i=r[s.index];if(t&&i>0||!t&&i<0)return s.index}return null}function CB(r,e){const{chart:t,_cachedMeta:n}=r,s=t._stacks||(t._stacks={}),{iScale:i,vScale:a,index:o}=n,l=i.axis,c=a.axis,A=w6(i,a,n),d=e.length;let h;for(let u=0;u<d;++u){const p=e[u],{[l]:f,[c]:g}=p,m=p._stacks||(p._stacks={});h=m[c]=x6(s,A,f),h[o]=g,h._top=BB(h,a,!0,n.type),h._bottom=BB(h,a,!1,n.type);const x=h._visualValues||(h._visualValues={});x[o]=g}}function Gy(r,e){const t=r.scales;return Object.keys(t).filter(n=>t[n].axis===e).shift()}function _6(r,e){return IA(r,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function B6(r,e,t){return IA(r,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:t,index:e,mode:"default",type:"data"})}function qh(r,e){const t=r.controller.index,n=r.vScale&&r.vScale.axis;if(n){e=e||r._parsed;for(const s of e){const i=s._stacks;if(!i||i[n]===void 0||i[n][t]===void 0)return;delete i[n][t],i[n]._visualValues!==void 0&&i[n]._visualValues[t]!==void 0&&delete i[n]._visualValues[t]}}}const zy=r=>r==="reset"||r==="none",SB=(r,e)=>e?r:Object.assign({},r),C6=(r,e,t)=>r&&!e.hidden&&e._stacked&&{keys:jI(t,!0),values:null};class po{constructor(e,t){this.chart=e,this._ctx=e.ctx,this.index=t,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=$y(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&qh(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,t=this._cachedMeta,n=this.getDataset(),s=(d,h,u,p)=>d==="x"?h:d==="r"?p:u,i=t.xAxisID=qt(n.xAxisID,Gy(e,"x")),a=t.yAxisID=qt(n.yAxisID,Gy(e,"y")),o=t.rAxisID=qt(n.rAxisID,Gy(e,"r")),l=t.indexAxis,c=t.iAxisID=s(l,i,a,o),A=t.vAxisID=s(l,a,i,o);t.xScale=this.getScaleForId(i),t.yScale=this.getScaleForId(a),t.rScale=this.getScaleForId(o),t.iScale=this.getScaleForId(c),t.vScale=this.getScaleForId(A)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&lB(this._data,this),e._stacked&&qh(e)}_dataCheck(){const e=this.getDataset(),t=e.data||(e.data=[]),n=this._data;if(Br(t)){const s=this._cachedMeta;this._data=y6(t,s)}else if(n!==t){if(n){lB(n,this);const s=this._cachedMeta;qh(s),s._parsed=[]}t&&Object.isExtensible(t)&&cD(t,this),this._syncList=[],this._data=t}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const t=this._cachedMeta,n=this.getDataset();let s=!1;this._dataCheck();const i=t._stacked;t._stacked=$y(t.vScale,t),t.stack!==n.stack&&(s=!0,qh(t),t.stack=n.stack),this._resyncElements(e),(s||i!==t._stacked)&&(CB(this,t._parsed),t._stacked=$y(t.vScale,t))}configure(){const e=this.chart.config,t=e.datasetScopeKeys(this._type),n=e.getOptionScopes(this.getDataset(),t,!0);this.options=e.createResolver(n,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,t){const{_cachedMeta:n,_data:s}=this,{iScale:i,_stacked:a}=n,o=i.axis;let l=e===0&&t===s.length?!0:n._sorted,c=e>0&&n._parsed[e-1],A,d,h;if(this._parsing===!1)n._parsed=s,n._sorted=!0,h=s;else{Sn(s[e])?h=this.parseArrayData(n,s,e,t):Br(s[e])?h=this.parseObjectData(n,s,e,t):h=this.parsePrimitiveData(n,s,e,t);const u=()=>d[o]===null||c&&d[o]<c[o];for(A=0;A<t;++A)n._parsed[A+e]=d=h[A],l&&(u()&&(l=!1),c=d);n._sorted=l}a&&CB(this,h)}parsePrimitiveData(e,t,n,s){const{iScale:i,vScale:a}=e,o=i.axis,l=a.axis,c=i.getLabels(),A=i===a,d=new Array(s);let h,u,p;for(h=0,u=s;h<u;++h)p=h+n,d[h]={[o]:A||i.parse(c[p],p),[l]:a.parse(t[p],p)};return d}parseArrayData(e,t,n,s){const{xScale:i,yScale:a}=e,o=new Array(s);let l,c,A,d;for(l=0,c=s;l<c;++l)A=l+n,d=t[A],o[l]={x:i.parse(d[0],A),y:a.parse(d[1],A)};return o}parseObjectData(e,t,n,s){const{xScale:i,yScale:a}=e,{xAxisKey:o="x",yAxisKey:l="y"}=this._parsing,c=new Array(s);let A,d,h,u;for(A=0,d=s;A<d;++A)h=A+n,u=t[h],c[A]={x:i.parse(pA(u,o),h),y:a.parse(pA(u,l),h)};return c}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,t,n){const s=this.chart,i=this._cachedMeta,a=t[e.axis],o={keys:jI(s,!0),values:t._stacks[e.axis]._visualValues};return _B(o,a,i.index,{mode:n})}updateRangeFromParsed(e,t,n,s){const i=n[t.axis];let a=i===null?NaN:i;const o=s&&n._stacks[t.axis];s&&o&&(s.values=o,a=_B(s,i,this._cachedMeta.index)),e.min=Math.min(e.min,a),e.max=Math.max(e.max,a)}getMinMax(e,t){const n=this._cachedMeta,s=n._parsed,i=n._sorted&&e===n.iScale,a=s.length,o=this._getOtherScale(e),l=C6(t,n,this.chart),c={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:A,max:d}=v6(o);let h,u;function p(){u=s[h];const f=u[o.axis];return!Kn(u[e.axis])||A>f||d<f}for(h=0;h<a&&!(!p()&&(this.updateRangeFromParsed(c,e,u,l),i));++h);if(i){for(h=a-1;h>=0;--h)if(!p()){this.updateRangeFromParsed(c,e,u,l);break}}return c}getAllParsedValues(e){const t=this._cachedMeta._parsed,n=[];let s,i,a;for(s=0,i=t.length;s<i;++s)a=t[s][e.axis],Kn(a)&&n.push(a);return n}getMaxOverflow(){return!1}getLabelAndValue(e){const t=this._cachedMeta,n=t.iScale,s=t.vScale,i=this.getParsed(e);return{label:n?""+n.getLabelForValue(i[n.axis]):"",value:s?""+s.getLabelForValue(i[s.axis]):""}}_update(e){const t=this._cachedMeta;this.update(e||"default"),t._clip=b6(qt(this.options.clip,m6(t.xScale,t.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,t=this.chart,n=this._cachedMeta,s=n.data||[],i=t.chartArea,a=[],o=this._drawStart||0,l=this._drawCount||s.length-o,c=this.options.drawActiveElementsOnTop;let A;for(n.dataset&&n.dataset.draw(e,i,o,l),A=o;A<o+l;++A){const d=s[A];d.hidden||(d.active&&c?a.push(d):d.draw(e,i))}for(A=0;A<a.length;++A)a[A].draw(e,i)}getStyle(e,t){const n=t?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(n):this.resolveDataElementOptions(e||0,n)}getContext(e,t,n){const s=this.getDataset();let i;if(e>=0&&e<this._cachedMeta.data.length){const a=this._cachedMeta.data[e];i=a.$context||(a.$context=B6(this.getContext(),e,a)),i.parsed=this.getParsed(e),i.raw=s.data[e],i.index=i.dataIndex=e}else i=this.$context||(this.$context=_6(this.chart.getContext(),this.index)),i.dataset=s,i.index=i.datasetIndex=this.index;return i.active=!!t,i.mode=n,i}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}_resolveElementOptions(e,t="default",n){const s=t==="active",i=this._cachedDataOpts,a=e+"-"+t,o=i[a],l=this.enableOptionSharing&&Ag(n);if(o)return SB(o,l);const c=this.chart.config,A=c.datasetElementScopeKeys(this._type,e),d=s?[`${e}Hover`,"hover",e,""]:[e,""],h=c.getOptionScopes(this.getDataset(),A),u=Object.keys(Tn.elements[e]),p=()=>this.getContext(n,s,t),f=c.resolveNamedOptions(h,u,p,d);return f.$shared&&(f.$shared=l,i[a]=Object.freeze(SB(f,l))),f}_resolveAnimations(e,t,n){const s=this.chart,i=this._cachedDataOpts,a=`animation-${t}`,o=i[a];if(o)return o;let l;if(s.options.animation!==!1){const A=this.chart.config,d=A.datasetAnimationScopeKeys(this._type,t),h=A.getOptionScopes(this.getDataset(),d);l=A.createResolver(h,this.getContext(e,n,t))}const c=new HI(s,l&&l.animations);return l&&l._cacheable&&(i[a]=Object.freeze(c)),c}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,t){return!t||zy(e)||this.chart._animationsDisabled}_getSharedOptions(e,t){const n=this.resolveDataElementOptions(e,t),s=this._sharedOptions,i=this.getSharedOptions(n),a=this.includeOptions(t,i)||i!==s;return this.updateSharedOptions(i,t,n),{sharedOptions:i,includeOptions:a}}updateElement(e,t,n,s){zy(s)?Object.assign(e,n):this._resolveAnimations(t,s).update(e,n)}updateSharedOptions(e,t,n){e&&!zy(t)&&this._resolveAnimations(void 0,t).update(e,n)}_setStyle(e,t,n,s){e.active=s;const i=this.getStyle(t,s);this._resolveAnimations(t,n,s).update(e,{options:!s&&this.getSharedOptions(i)||i})}removeHoverStyle(e,t,n){this._setStyle(e,n,"active",!1)}setHoverStyle(e,t,n){this._setStyle(e,n,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const t=this._data,n=this._cachedMeta.data;for(const[o,l,c]of this._syncList)this[o](l,c);this._syncList=[];const s=n.length,i=t.length,a=Math.min(i,s);a&&this.parse(0,a),i>s?this._insertElements(s,i-s,e):i<s&&this._removeElements(i,s-i)}_insertElements(e,t,n=!0){const s=this._cachedMeta,i=s.data,a=e+t;let o;const l=c=>{for(c.length+=t,o=c.length-1;o>=a;o--)c[o]=c[o-t]};for(l(i),o=e;o<a;++o)i[o]=new this.dataElementType;this._parsing&&l(s._parsed),this.parse(e,t),n&&this.updateElements(i,e,t,"reset")}updateElements(e,t,n,s){}_removeElements(e,t){const n=this._cachedMeta;if(this._parsing){const s=n._parsed.splice(e,t);n._stacked&&qh(n,s)}n.data.splice(e,t)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[t,n,s]=e;this[t](n,s)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,t){t&&this._sync(["_removeElements",e,t]);const n=arguments.length-2;n&&this._sync(["_insertElements",e,n])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}Fe(po,"defaults",{}),Fe(po,"datasetElementType",null),Fe(po,"dataElementType",null);function S6(r,e){if(!r._cache.$bar){const t=r.getMatchingVisibleMetas(e);let n=[];for(let s=0,i=t.length;s<i;s++)n=n.concat(t[s].controller.getAllParsedValues(r));r._cache.$bar=vI(n.sort((s,i)=>s-i))}return r._cache.$bar}function k6(r){const e=r.iScale,t=S6(e,r.type);let n=e._length,s,i,a,o;const l=()=>{a===32767||a===-32768||(Ag(o)&&(n=Math.min(n,Math.abs(a-o)||n)),o=a)};for(s=0,i=t.length;s<i;++s)a=e.getPixelForValue(t[s]),l();for(o=void 0,s=0,i=e.ticks.length;s<i;++s)a=e.getPixelForTick(s),l();return n}function E6(r,e,t,n){const s=t.barThickness;let i,a;return pr(s)?(i=e.min*t.categoryPercentage,a=t.barPercentage):(i=s*n,a=1),{chunk:i/n,ratio:a,start:e.pixels[r]-i/2}}function I6(r,e,t,n){const s=e.pixels,i=s[r];let a=r>0?s[r-1]:null,o=r<s.length-1?s[r+1]:null;const l=t.categoryPercentage;a===null&&(a=i-(o===null?e.end-e.start:o-i)),o===null&&(o=i+i-a);const c=i-(i-Math.min(a,o))/2*l;return{chunk:Math.abs(o-a)/2*l/n,ratio:t.barPercentage,start:c}}function T6(r,e,t,n){const s=t.parse(r[0],n),i=t.parse(r[1],n),a=Math.min(s,i),o=Math.max(s,i);let l=a,c=o;Math.abs(a)>Math.abs(o)&&(l=o,c=a),e[t.axis]=c,e._custom={barStart:l,barEnd:c,start:s,end:i,min:a,max:o}}function VI(r,e,t,n){return Sn(r)?T6(r,e,t,n):e[t.axis]=t.parse(r,n),e}function kB(r,e,t,n){const s=r.iScale,i=r.vScale,a=s.getLabels(),o=s===i,l=[];let c,A,d,h;for(c=t,A=t+n;c<A;++c)h=e[c],d={},d[s.axis]=o||s.parse(a[c],c),l.push(VI(h,d,i,c));return l}function Ky(r){return r&&r.barStart!==void 0&&r.barEnd!==void 0}function F6(r,e,t){return r!==0?eo(r):(e.isHorizontal()?1:-1)*(e.min>=t?1:-1)}function L6(r){let e,t,n,s,i;return r.horizontal?(e=r.base>r.x,t="left",n="right"):(e=r.base<r.y,t="bottom",n="top"),e?(s="end",i="start"):(s="start",i="end"),{start:t,end:n,reverse:e,top:s,bottom:i}}function U6(r,e,t,n){let s=e.borderSkipped;const i={};if(!s){r.borderSkipped=i;return}if(s===!0){r.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:a,end:o,reverse:l,top:c,bottom:A}=L6(r);s==="middle"&&t&&(r.enableBorderRadius=!0,(t._top||0)===n?s=c:(t._bottom||0)===n?s=A:(i[EB(A,a,o,l)]=!0,s=c)),i[EB(s,a,o,l)]=!0,r.borderSkipped=i}function EB(r,e,t,n){return n?(r=M6(r,e,t),r=IB(r,t,e)):r=IB(r,e,t),r}function M6(r,e,t){return r===e?t:r===t?e:r}function IB(r,e,t){return r==="start"?e:r==="end"?t:r}function N6(r,{inflateAmount:e},t){r.inflateAmount=e==="auto"?t===1?.33:0:e}class q0 extends po{parsePrimitiveData(e,t,n,s){return kB(e,t,n,s)}parseArrayData(e,t,n,s){return kB(e,t,n,s)}parseObjectData(e,t,n,s){const{iScale:i,vScale:a}=e,{xAxisKey:o="x",yAxisKey:l="y"}=this._parsing,c=i.axis==="x"?o:l,A=a.axis==="x"?o:l,d=[];let h,u,p,f;for(h=n,u=n+s;h<u;++h)f=t[h],p={},p[i.axis]=i.parse(pA(f,c),h),d.push(VI(pA(f,A),p,a,h));return d}updateRangeFromParsed(e,t,n,s){super.updateRangeFromParsed(e,t,n,s);const i=n._custom;i&&t===this._cachedMeta.vScale&&(e.min=Math.min(e.min,i.min),e.max=Math.max(e.max,i.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const t=this._cachedMeta,{iScale:n,vScale:s}=t,i=this.getParsed(e),a=i._custom,o=Ky(a)?"["+a.start+", "+a.end+"]":""+s.getLabelForValue(i[s.axis]);return{label:""+n.getLabelForValue(i[n.axis]),value:o}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const t=this._cachedMeta;this.updateElements(t.data,0,t.data.length,e)}updateElements(e,t,n,s){const i=s==="reset",{index:a,_cachedMeta:{vScale:o}}=this,l=o.getBasePixel(),c=o.isHorizontal(),A=this._getRuler(),{sharedOptions:d,includeOptions:h}=this._getSharedOptions(t,s);for(let u=t;u<t+n;u++){const p=this.getParsed(u),f=i||pr(p[o.axis])?{base:l,head:l}:this._calculateBarValuePixels(u),g=this._calculateBarIndexPixels(u,A),m=(p._stacks||{})[o.axis],x={horizontal:c,base:f.base,enableBorderRadius:!m||Ky(p._custom)||a===m._top||a===m._bottom,x:c?f.head:g.center,y:c?g.center:f.head,height:c?g.size:Math.abs(f.size),width:c?Math.abs(f.size):g.size};h&&(x.options=d||this.resolveDataElementOptions(u,e[u].active?"active":s));const S=x.options||e[u].options;U6(x,S,m,a),N6(x,S,A.ratio),this.updateElement(e[u],u,x,s)}}_getStacks(e,t){const{iScale:n}=this._cachedMeta,s=n.getMatchingVisibleMetas(this._type).filter(A=>A.controller.options.grouped),i=n.options.stacked,a=[],o=this._cachedMeta.controller.getParsed(t),l=o&&o[n.axis],c=A=>{const d=A._parsed.find(u=>u[n.axis]===l),h=d&&d[A.vScale.axis];if(pr(h)||isNaN(h))return!0};for(const A of s)if(!(t!==void 0&&c(A))&&((i===!1||a.indexOf(A.stack)===-1||i===void 0&&A.stack===void 0)&&a.push(A.stack),A.index===e))break;return a.length||a.push(void 0),a}_getStackCount(e){return this._getStacks(void 0,e).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const e=this.chart.scales,t=this.chart.options.indexAxis;return Object.keys(e).filter(n=>e[n].axis===t).shift()}_getAxis(){const e={},t=this.getFirstScaleIdForIndexAxis();for(const n of this.chart.data.datasets)e[qt(this.chart.options.indexAxis==="x"?n.xAxisID:n.yAxisID,t)]=!0;return Object.keys(e)}_getStackIndex(e,t,n){const s=this._getStacks(e,n),i=t!==void 0?s.indexOf(t):-1;return i===-1?s.length-1:i}_getRuler(){const e=this.options,t=this._cachedMeta,n=t.iScale,s=[];let i,a;for(i=0,a=t.data.length;i<a;++i)s.push(n.getPixelForValue(this.getParsed(i)[n.axis],i));const o=e.barThickness;return{min:o||k6(t),pixels:s,start:n._startPixel,end:n._endPixel,stackCount:this._getStackCount(),scale:n,grouped:e.grouped,ratio:o?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:t,_stacked:n,index:s},options:{base:i,minBarLength:a}}=this,o=i||0,l=this.getParsed(e),c=l._custom,A=Ky(c);let d=l[t.axis],h=0,u=n?this.applyStack(t,l,n):d,p,f;u!==d&&(h=u-d,u=d),A&&(d=c.barStart,u=c.barEnd-c.barStart,d!==0&&eo(d)!==eo(c.barEnd)&&(h=0),h+=d);const g=!pr(i)&&!A?i:h;let m=t.getPixelForValue(g);if(this.chart.getDataVisibility(e)?p=t.getPixelForValue(h+u):p=m,f=p-m,Math.abs(f)<a){f=F6(f,t,o)*a,d===o&&(m-=f/2);const x=t.getPixelForDecimal(0),S=t.getPixelForDecimal(1),B=Math.min(x,S),F=Math.max(x,S);m=Math.max(Math.min(m,F),B),p=m+f,n&&!A&&(l._stacks[t.axis]._visualValues[s]=t.getValueForPixel(p)-t.getValueForPixel(m))}if(m===t.getPixelForValue(o)){const x=eo(f)*t.getLineWidthForValue(o)/2;m+=x,f-=x}return{size:f,base:m,head:p,center:p+f/2}}_calculateBarIndexPixels(e,t){const n=t.scale,s=this.options,i=s.skipNull,a=qt(s.maxBarThickness,1/0);let o,l;const c=this._getAxisCount();if(t.grouped){const A=i?this._getStackCount(e):t.stackCount,d=s.barThickness==="flex"?I6(e,t,s,A*c):E6(e,t,s,A*c),h=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,u=this._getAxis().indexOf(qt(h,this.getFirstScaleIdForIndexAxis())),p=this._getStackIndex(this.index,this._cachedMeta.stack,i?e:void 0)+u;o=d.start+d.chunk*p+d.chunk/2,l=Math.min(a,d.chunk*d.ratio)}else o=n.getPixelForValue(this.getParsed(e)[n.axis],e),l=Math.min(a,t.min*t.ratio);return{base:o-l/2,head:o+l/2,center:o,size:l}}draw(){const e=this._cachedMeta,t=e.vScale,n=e.data,s=n.length;let i=0;for(;i<s;++i)this.getParsed(i)[t.axis]!==null&&!n[i].hidden&&n[i].draw(this._ctx)}}Fe(q0,"id","bar"),Fe(q0,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),Fe(q0,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});class W0 extends po{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(e,t,n,s){const i=super.parsePrimitiveData(e,t,n,s);for(let a=0;a<i.length;a++)i[a]._custom=this.resolveDataElementOptions(a+n).radius;return i}parseArrayData(e,t,n,s){const i=super.parseArrayData(e,t,n,s);for(let a=0;a<i.length;a++){const o=t[n+a];i[a]._custom=qt(o[2],this.resolveDataElementOptions(a+n).radius)}return i}parseObjectData(e,t,n,s){const i=super.parseObjectData(e,t,n,s);for(let a=0;a<i.length;a++){const o=t[n+a];i[a]._custom=qt(o&&o.r&&+o.r,this.resolveDataElementOptions(a+n).radius)}return i}getMaxOverflow(){const e=this._cachedMeta.data;let t=0;for(let n=e.length-1;n>=0;--n)t=Math.max(t,e[n].size(this.resolveDataElementOptions(n))/2);return t>0&&t}getLabelAndValue(e){const t=this._cachedMeta,n=this.chart.data.labels||[],{xScale:s,yScale:i}=t,a=this.getParsed(e),o=s.getLabelForValue(a.x),l=i.getLabelForValue(a.y),c=a._custom;return{label:n[e]||"",value:"("+o+", "+l+(c?", "+c:"")+")"}}update(e){const t=this._cachedMeta.data;this.updateElements(t,0,t.length,e)}updateElements(e,t,n,s){const i=s==="reset",{iScale:a,vScale:o}=this._cachedMeta,{sharedOptions:l,includeOptions:c}=this._getSharedOptions(t,s),A=a.axis,d=o.axis;for(let h=t;h<t+n;h++){const u=e[h],p=!i&&this.getParsed(h),f={},g=f[A]=i?a.getPixelForDecimal(.5):a.getPixelForValue(p[A]),m=f[d]=i?o.getBasePixel():o.getPixelForValue(p[d]);f.skip=isNaN(g)||isNaN(m),c&&(f.options=l||this.resolveDataElementOptions(h,u.active?"active":s),i&&(f.options.radius=0)),this.updateElement(u,h,f,s)}}resolveDataElementOptions(e,t){const n=this.getParsed(e);let s=super.resolveDataElementOptions(e,t);s.$shared&&(s=Object.assign({},s,{$shared:!1}));const i=s.radius;return t!=="active"&&(s.radius=0),s.radius+=qt(n&&n._custom,i),s}}Fe(W0,"id","bubble"),Fe(W0,"defaults",{datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}}),Fe(W0,"overrides",{scales:{x:{type:"linear"},y:{type:"linear"}}});function P6(r,e,t){let n=1,s=1,i=0,a=0;if(e<In){const o=r,l=o+e,c=Math.cos(o),A=Math.sin(o),d=Math.cos(l),h=Math.sin(l),u=(S,B,F)=>dg(S,o,l,!0)?1:Math.max(B,B*t,F,F*t),p=(S,B,F)=>dg(S,o,l,!0)?-1:Math.min(B,B*t,F,F*t),f=u(0,c,d),g=u(ds,A,h),m=p(Gr,c,d),x=p(Gr+ds,A,h);n=(f-m)/2,s=(g-x)/2,i=-(f+m)/2,a=-(g+x)/2}return{ratioX:n,ratioY:s,offsetX:i,offsetY:a}}class dd extends po{constructor(e,t){super(e,t),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,t){const n=this.getDataset().data,s=this._cachedMeta;if(this._parsing===!1)s._parsed=n;else{let i=l=>+n[l];if(Br(n[e])){const{key:l="value"}=this._parsing;i=c=>+pA(n[c],l)}let a,o;for(a=e,o=e+t;a<o;++a)s._parsed[a]=i(a)}}_getRotation(){return ho(this.options.rotation-90)}_getCircumference(){return ho(this.options.circumference)}_getRotationExtents(){let e=In,t=-In;for(let n=0;n<this.chart.data.datasets.length;++n)if(this.chart.isDatasetVisible(n)&&this.chart.getDatasetMeta(n).type===this._type){const s=this.chart.getDatasetMeta(n).controller,i=s._getRotation(),a=s._getCircumference();e=Math.min(e,i),t=Math.max(t,i+a)}return{rotation:e,circumference:t-e}}update(e){const t=this.chart,{chartArea:n}=t,s=this._cachedMeta,i=s.data,a=this.getMaxBorderWidth()+this.getMaxOffset(i)+this.options.spacing,o=Math.max((Math.min(n.width,n.height)-a)/2,0),l=Math.min(qP(this.options.cutout,o),1),c=this._getRingWeight(this.index),{circumference:A,rotation:d}=this._getRotationExtents(),{ratioX:h,ratioY:u,offsetX:p,offsetY:f}=P6(d,A,l),g=(n.width-a)/h,m=(n.height-a)/u,x=Math.max(Math.min(g,m)/2,0),S=pI(this.options.radius,x),B=Math.max(S*l,0),F=(S-B)/this._getVisibleDatasetWeightTotal();this.offsetX=p*S,this.offsetY=f*S,s.total=this.calculateTotal(),this.outerRadius=S-F*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-F*c,0),this.updateElements(i,0,i.length,e)}_circumference(e,t){const n=this.options,s=this._cachedMeta,i=this._getCircumference();return t&&n.animation.animateRotate||!this.chart.getDataVisibility(e)||s._parsed[e]===null||s.data[e].hidden?0:this.calculateCircumference(s._parsed[e]*i/In)}updateElements(e,t,n,s){const i=s==="reset",a=this.chart,o=a.chartArea,c=a.options.animation,A=(o.left+o.right)/2,d=(o.top+o.bottom)/2,h=i&&c.animateScale,u=h?0:this.innerRadius,p=h?0:this.outerRadius,{sharedOptions:f,includeOptions:g}=this._getSharedOptions(t,s);let m=this._getRotation(),x;for(x=0;x<t;++x)m+=this._circumference(x,i);for(x=t;x<t+n;++x){const S=this._circumference(x,i),B=e[x],F={x:A+this.offsetX,y:d+this.offsetY,startAngle:m,endAngle:m+S,circumference:S,outerRadius:p,innerRadius:u};g&&(F.options=f||this.resolveDataElementOptions(x,B.active?"active":s)),m+=S,this.updateElement(B,x,F,s)}}calculateTotal(){const e=this._cachedMeta,t=e.data;let n=0,s;for(s=0;s<t.length;s++){const i=e._parsed[s];i!==null&&!isNaN(i)&&this.chart.getDataVisibility(s)&&!t[s].hidden&&(n+=Math.abs(i))}return n}calculateCircumference(e){const t=this._cachedMeta.total;return t>0&&!isNaN(e)?In*(Math.abs(e)/t):0}getLabelAndValue(e){const t=this._cachedMeta,n=this.chart,s=n.data.labels||[],i=Pg(t._parsed[e],n.options.locale);return{label:s[e]||"",value:i}}getMaxBorderWidth(e){let t=0;const n=this.chart;let s,i,a,o,l;if(!e){for(s=0,i=n.data.datasets.length;s<i;++s)if(n.isDatasetVisible(s)){a=n.getDatasetMeta(s),e=a.data,o=a.controller;break}}if(!e)return 0;for(s=0,i=e.length;s<i;++s)l=o.resolveDataElementOptions(s),l.borderAlign!=="inner"&&(t=Math.max(t,l.borderWidth||0,l.hoverBorderWidth||0));return t}getMaxOffset(e){let t=0;for(let n=0,s=e.length;n<s;++n){const i=this.resolveDataElementOptions(n);t=Math.max(t,i.offset||0,i.hoverOffset||0)}return t}_getRingWeightOffset(e){let t=0;for(let n=0;n<e;++n)this.chart.isDatasetVisible(n)&&(t+=this._getRingWeight(n));return t}_getRingWeight(e){return Math.max(qt(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}Fe(dd,"id","doughnut"),Fe(dd,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),Fe(dd,"descriptors",{_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")}),Fe(dd,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data,{labels:{pointStyle:n,textAlign:s,color:i,useBorderRadius:a,borderRadius:o}}=e.legend.options;return t.labels.length&&t.datasets.length?t.labels.map((l,c)=>{const d=e.getDatasetMeta(0).controller.getStyle(c);return{text:l,fillStyle:d.backgroundColor,fontColor:i,hidden:!e.getDataVisibility(c),lineDash:d.borderDash,lineDashOffset:d.borderDashOffset,lineJoin:d.borderJoinStyle,lineWidth:d.borderWidth,strokeStyle:d.borderColor,textAlign:s,pointStyle:n,borderRadius:a&&(o||d.borderRadius),index:c}}):[]}},onClick(e,t,n){n.chart.toggleDataVisibility(t.index),n.chart.update()}}}});class Y0 extends po{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const t=this._cachedMeta,{dataset:n,data:s=[],_dataset:i}=t,a=this.chart._animationsDisabled;let{start:o,count:l}=BI(t,s,a);this._drawStart=o,this._drawCount=l,CI(t)&&(o=0,l=s.length),n._chart=this.chart,n._datasetIndex=this.index,n._decimated=!!i._decimated,n.points=s;const c=this.resolveDatasetElementOptions(e);this.options.showLine||(c.borderWidth=0),c.segment=this.options.segment,this.updateElement(n,void 0,{animated:!a,options:c},e),this.updateElements(s,o,l,e)}updateElements(e,t,n,s){const i=s==="reset",{iScale:a,vScale:o,_stacked:l,_dataset:c}=this._cachedMeta,{sharedOptions:A,includeOptions:d}=this._getSharedOptions(t,s),h=a.axis,u=o.axis,{spanGaps:p,segment:f}=this.options,g=th(p)?p:Number.POSITIVE_INFINITY,m=this.chart._animationsDisabled||i||s==="none",x=t+n,S=e.length;let B=t>0&&this.getParsed(t-1);for(let F=0;F<S;++F){const N=e[F],E=m?N:{};if(F<t||F>=x){E.skip=!0;continue}const w=this.getParsed(F),v=pr(w[u]),I=E[h]=a.getPixelForValue(w[h],F),k=E[u]=i||v?o.getBasePixel():o.getPixelForValue(l?this.applyStack(o,w,l):w[u],F);E.skip=isNaN(I)||isNaN(k)||v,E.stop=F>0&&Math.abs(w[h]-B[h])>g,f&&(E.parsed=w,E.raw=c.data[F]),d&&(E.options=A||this.resolveDataElementOptions(F,N.active?"active":s)),m||this.updateElement(N,F,E,s),B=w}}getMaxOverflow(){const e=this._cachedMeta,t=e.dataset,n=t.options&&t.options.borderWidth||0,s=e.data||[];if(!s.length)return n;const i=s[0].size(this.resolveDataElementOptions(0)),a=s[s.length-1].size(this.resolveDataElementOptions(s.length-1));return Math.max(n,i,a)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}Fe(Y0,"id","line"),Fe(Y0,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),Fe(Y0,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});class Df extends po{constructor(e,t){super(e,t),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(e){const t=this._cachedMeta,n=this.chart,s=n.data.labels||[],i=Pg(t._parsed[e].r,n.options.locale);return{label:s[e]||"",value:i}}parseObjectData(e,t,n,s){return UI.bind(this)(e,t,n,s)}update(e){const t=this._cachedMeta.data;this._updateRadius(),this.updateElements(t,0,t.length,e)}getMinMax(){const e=this._cachedMeta,t={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return e.data.forEach((n,s)=>{const i=this.getParsed(s).r;!isNaN(i)&&this.chart.getDataVisibility(s)&&(i<t.min&&(t.min=i),i>t.max&&(t.max=i))}),t}_updateRadius(){const e=this.chart,t=e.chartArea,n=e.options,s=Math.min(t.right-t.left,t.bottom-t.top),i=Math.max(s/2,0),a=Math.max(n.cutoutPercentage?i/100*n.cutoutPercentage:1,0),o=(i-a)/e.getVisibleDatasetCount();this.outerRadius=i-o*this.index,this.innerRadius=this.outerRadius-o}updateElements(e,t,n,s){const i=s==="reset",a=this.chart,l=a.options.animation,c=this._cachedMeta.rScale,A=c.xCenter,d=c.yCenter,h=c.getIndexAngle(0)-.5*Gr;let u=h,p;const f=360/this.countVisibleElements();for(p=0;p<t;++p)u+=this._computeAngle(p,s,f);for(p=t;p<t+n;p++){const g=e[p];let m=u,x=u+this._computeAngle(p,s,f),S=a.getDataVisibility(p)?c.getDistanceFromCenterForValue(this.getParsed(p).r):0;u=x,i&&(l.animateScale&&(S=0),l.animateRotate&&(m=x=h));const B={x:A,y:d,innerRadius:0,outerRadius:S,startAngle:m,endAngle:x,options:this.resolveDataElementOptions(p,g.active?"active":s)};this.updateElement(g,p,B,s)}}countVisibleElements(){const e=this._cachedMeta;let t=0;return e.data.forEach((n,s)=>{!isNaN(this.getParsed(s).r)&&this.chart.getDataVisibility(s)&&t++}),t}_computeAngle(e,t,n){return this.chart.getDataVisibility(e)?ho(this.resolveDataElementOptions(e,t).angle||n):0}}Fe(Df,"id","polarArea"),Fe(Df,"defaults",{dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0}),Fe(Df,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data;if(t.labels.length&&t.datasets.length){const{labels:{pointStyle:n,color:s}}=e.legend.options;return t.labels.map((i,a)=>{const l=e.getDatasetMeta(0).controller.getStyle(a);return{text:i,fillStyle:l.backgroundColor,strokeStyle:l.borderColor,fontColor:s,lineWidth:l.borderWidth,pointStyle:n,hidden:!e.getDataVisibility(a),index:a}})}return[]}},onClick(e,t,n){n.chart.toggleDataVisibility(t.index),n.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}});class Sv extends dd{}Fe(Sv,"id","pie"),Fe(Sv,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});class X0 extends po{getLabelAndValue(e){const t=this._cachedMeta.vScale,n=this.getParsed(e);return{label:t.getLabels()[e],value:""+t.getLabelForValue(n[t.axis])}}parseObjectData(e,t,n,s){return UI.bind(this)(e,t,n,s)}update(e){const t=this._cachedMeta,n=t.dataset,s=t.data||[],i=t.iScale.getLabels();if(n.points=s,e!=="resize"){const a=this.resolveDatasetElementOptions(e);this.options.showLine||(a.borderWidth=0);const o={_loop:!0,_fullLoop:i.length===s.length,options:a};this.updateElement(n,void 0,o,e)}this.updateElements(s,0,s.length,e)}updateElements(e,t,n,s){const i=this._cachedMeta.rScale,a=s==="reset";for(let o=t;o<t+n;o++){const l=e[o],c=this.resolveDataElementOptions(o,l.active?"active":s),A=i.getPointPositionForValue(o,this.getParsed(o).r),d=a?i.xCenter:A.x,h=a?i.yCenter:A.y,u={x:d,y:h,angle:A.angle,skip:isNaN(d)||isNaN(h),options:c};this.updateElement(l,o,u,s)}}}Fe(X0,"id","radar"),Fe(X0,"defaults",{datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}}),Fe(X0,"overrides",{aspectRatio:1,scales:{r:{type:"radialLinear"}}});class J0 extends po{getLabelAndValue(e){const t=this._cachedMeta,n=this.chart.data.labels||[],{xScale:s,yScale:i}=t,a=this.getParsed(e),o=s.getLabelForValue(a.x),l=i.getLabelForValue(a.y);return{label:n[e]||"",value:"("+o+", "+l+")"}}update(e){const t=this._cachedMeta,{data:n=[]}=t,s=this.chart._animationsDisabled;let{start:i,count:a}=BI(t,n,s);if(this._drawStart=i,this._drawCount=a,CI(t)&&(i=0,a=n.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:o,_dataset:l}=t;o._chart=this.chart,o._datasetIndex=this.index,o._decimated=!!l._decimated,o.points=n;const c=this.resolveDatasetElementOptions(e);c.segment=this.options.segment,this.updateElement(o,void 0,{animated:!s,options:c},e)}else this.datasetElementType&&(delete t.dataset,this.datasetElementType=!1);this.updateElements(n,i,a,e)}addElements(){const{showLine:e}=this.options;!this.datasetElementType&&e&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(e,t,n,s){const i=s==="reset",{iScale:a,vScale:o,_stacked:l,_dataset:c}=this._cachedMeta,A=this.resolveDataElementOptions(t,s),d=this.getSharedOptions(A),h=this.includeOptions(s,d),u=a.axis,p=o.axis,{spanGaps:f,segment:g}=this.options,m=th(f)?f:Number.POSITIVE_INFINITY,x=this.chart._animationsDisabled||i||s==="none";let S=t>0&&this.getParsed(t-1);for(let B=t;B<t+n;++B){const F=e[B],N=this.getParsed(B),E=x?F:{},w=pr(N[p]),v=E[u]=a.getPixelForValue(N[u],B),I=E[p]=i||w?o.getBasePixel():o.getPixelForValue(l?this.applyStack(o,N,l):N[p],B);E.skip=isNaN(v)||isNaN(I)||w,E.stop=B>0&&Math.abs(N[u]-S[u])>m,g&&(E.parsed=N,E.raw=c.data[B]),h&&(E.options=d||this.resolveDataElementOptions(B,F.active?"active":s)),x||this.updateElement(F,B,E,s),S=N}this.updateSharedOptions(d,s,A)}getMaxOverflow(){const e=this._cachedMeta,t=e.data||[];if(!this.options.showLine){let o=0;for(let l=t.length-1;l>=0;--l)o=Math.max(o,t[l].size(this.resolveDataElementOptions(l))/2);return o>0&&o}const n=e.dataset,s=n.options&&n.options.borderWidth||0;if(!t.length)return s;const i=t[0].size(this.resolveDataElementOptions(0)),a=t[t.length-1].size(this.resolveDataElementOptions(t.length-1));return Math.max(s,i,a)/2}}Fe(J0,"id","scatter"),Fe(J0,"defaults",{datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1}),Fe(J0,"overrides",{interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}});var D6=Object.freeze({__proto__:null,BarController:q0,BubbleController:W0,DoughnutController:dd,LineController:Y0,PieController:Sv,PolarAreaController:Df,RadarController:X0,ScatterController:J0});function JA(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class Ux{constructor(e){Fe(this,"options");this.options=e||{}}static override(e){Object.assign(Ux.prototype,e)}init(){}formats(){return JA()}parse(){return JA()}format(){return JA()}add(){return JA()}diff(){return JA()}startOf(){return JA()}endOf(){return JA()}}var $I={_date:Ux};function R6(r,e,t,n){const{controller:s,data:i,_sorted:a}=r,o=s._cachedMeta.iScale,l=r.dataset&&r.dataset.options?r.dataset.options.spanGaps:null;if(o&&e===o.axis&&e!=="r"&&a&&i.length){const c=o._reversePixels?oD:Hl;if(n){if(s._sharedOptions){const A=i[0],d=typeof A.getRange=="function"&&A.getRange(e);if(d){const h=c(i,e,t-d),u=c(i,e,t+d);return{lo:h.lo,hi:u.hi}}}}else{const A=c(i,e,t);if(l){const{vScale:d}=s._cachedMeta,{_parsed:h}=r,u=h.slice(0,A.lo+1).reverse().findIndex(f=>!pr(f[d.axis]));A.lo-=Math.max(0,u);const p=h.slice(A.hi).findIndex(f=>!pr(f[d.axis]));A.hi+=Math.max(0,p)}return A}}return{lo:0,hi:i.length-1}}function Lb(r,e,t,n,s){const i=r.getSortedVisibleDatasetMetas(),a=t[e];for(let o=0,l=i.length;o<l;++o){const{index:c,data:A}=i[o],{lo:d,hi:h}=R6(i[o],e,a,s);for(let u=d;u<=h;++u){const p=A[u];p.skip||n(p,c,u)}}}function O6(r){const e=r.indexOf("x")!==-1,t=r.indexOf("y")!==-1;return function(n,s){const i=e?Math.abs(n.x-s.x):0,a=t?Math.abs(n.y-s.y):0;return Math.sqrt(Math.pow(i,2)+Math.pow(a,2))}}function qy(r,e,t,n,s){const i=[];return!s&&!r.isPointInArea(e)||Lb(r,t,e,function(o,l,c){!s&&!Yo(o,r.chartArea,0)||o.inRange(e.x,e.y,n)&&i.push({element:o,datasetIndex:l,index:c})},!0),i}function Q6(r,e,t,n){let s=[];function i(a,o,l){const{startAngle:c,endAngle:A}=a.getProps(["startAngle","endAngle"],n),{angle:d}=yI(a,{x:e.x,y:e.y});dg(d,c,A)&&s.push({element:a,datasetIndex:o,index:l})}return Lb(r,t,e,i),s}function H6(r,e,t,n,s,i){let a=[];const o=O6(t);let l=Number.POSITIVE_INFINITY;function c(A,d,h){const u=A.inRange(e.x,e.y,s);if(n&&!u)return;const p=A.getCenterPoint(s);if(!(!!i||r.isPointInArea(p))&&!u)return;const g=o(e,p);g<l?(a=[{element:A,datasetIndex:d,index:h}],l=g):g===l&&a.push({element:A,datasetIndex:d,index:h})}return Lb(r,t,e,c),a}function Wy(r,e,t,n,s,i){return!i&&!r.isPointInArea(e)?[]:t==="r"&&!n?Q6(r,e,t,s):H6(r,e,t,n,s,i)}function TB(r,e,t,n,s){const i=[],a=t==="x"?"inXRange":"inYRange";let o=!1;return Lb(r,t,e,(l,c,A)=>{l[a]&&l[a](e[t],s)&&(i.push({element:l,datasetIndex:c,index:A}),o=o||l.inRange(e.x,e.y,s))}),n&&!o?[]:i}var j6={modes:{index(r,e,t,n){const s=Go(e,r),i=t.axis||"x",a=t.includeInvisible||!1,o=t.intersect?qy(r,s,i,n,a):Wy(r,s,i,!1,n,a),l=[];return o.length?(r.getSortedVisibleDatasetMetas().forEach(c=>{const A=o[0].index,d=c.data[A];d&&!d.skip&&l.push({element:d,datasetIndex:c.index,index:A})}),l):[]},dataset(r,e,t,n){const s=Go(e,r),i=t.axis||"xy",a=t.includeInvisible||!1;let o=t.intersect?qy(r,s,i,n,a):Wy(r,s,i,!1,n,a);if(o.length>0){const l=o[0].datasetIndex,c=r.getDatasetMeta(l).data;o=[];for(let A=0;A<c.length;++A)o.push({element:c[A],datasetIndex:l,index:A})}return o},point(r,e,t,n){const s=Go(e,r),i=t.axis||"xy",a=t.includeInvisible||!1;return qy(r,s,i,n,a)},nearest(r,e,t,n){const s=Go(e,r),i=t.axis||"xy",a=t.includeInvisible||!1;return Wy(r,s,i,t.intersect,n,a)},x(r,e,t,n){const s=Go(e,r);return TB(r,s,"x",t.intersect,n)},y(r,e,t,n){const s=Go(e,r);return TB(r,s,"y",t.intersect,n)}}};const GI=["left","top","right","bottom"];function Wh(r,e){return r.filter(t=>t.pos===e)}function FB(r,e){return r.filter(t=>GI.indexOf(t.pos)===-1&&t.box.axis===e)}function Yh(r,e){return r.sort((t,n)=>{const s=e?n:t,i=e?t:n;return s.weight===i.weight?s.index-i.index:s.weight-i.weight})}function V6(r){const e=[];let t,n,s,i,a,o;for(t=0,n=(r||[]).length;t<n;++t)s=r[t],{position:i,options:{stack:a,stackWeight:o=1}}=s,e.push({index:t,box:s,pos:i,horizontal:s.isHorizontal(),weight:s.weight,stack:a&&i+a,stackWeight:o});return e}function $6(r){const e={};for(const t of r){const{stack:n,pos:s,stackWeight:i}=t;if(!n||!GI.includes(s))continue;const a=e[n]||(e[n]={count:0,placed:0,weight:0,size:0});a.count++,a.weight+=i}return e}function G6(r,e){const t=$6(r),{vBoxMaxWidth:n,hBoxMaxHeight:s}=e;let i,a,o;for(i=0,a=r.length;i<a;++i){o=r[i];const{fullSize:l}=o.box,c=t[o.stack],A=c&&o.stackWeight/c.weight;o.horizontal?(o.width=A?A*n:l&&e.availableWidth,o.height=s):(o.width=n,o.height=A?A*s:l&&e.availableHeight)}return t}function z6(r){const e=V6(r),t=Yh(e.filter(c=>c.box.fullSize),!0),n=Yh(Wh(e,"left"),!0),s=Yh(Wh(e,"right")),i=Yh(Wh(e,"top"),!0),a=Yh(Wh(e,"bottom")),o=FB(e,"x"),l=FB(e,"y");return{fullSize:t,leftAndTop:n.concat(i),rightAndBottom:s.concat(l).concat(a).concat(o),chartArea:Wh(e,"chartArea"),vertical:n.concat(s).concat(l),horizontal:i.concat(a).concat(o)}}function LB(r,e,t,n){return Math.max(r[t],e[t])+Math.max(r[n],e[n])}function zI(r,e){r.top=Math.max(r.top,e.top),r.left=Math.max(r.left,e.left),r.bottom=Math.max(r.bottom,e.bottom),r.right=Math.max(r.right,e.right)}function K6(r,e,t,n){const{pos:s,box:i}=t,a=r.maxPadding;if(!Br(s)){t.size&&(r[s]-=t.size);const d=n[t.stack]||{size:0,count:1};d.size=Math.max(d.size,t.horizontal?i.height:i.width),t.size=d.size/d.count,r[s]+=t.size}i.getPadding&&zI(a,i.getPadding());const o=Math.max(0,e.outerWidth-LB(a,r,"left","right")),l=Math.max(0,e.outerHeight-LB(a,r,"top","bottom")),c=o!==r.w,A=l!==r.h;return r.w=o,r.h=l,t.horizontal?{same:c,other:A}:{same:A,other:c}}function q6(r){const e=r.maxPadding;function t(n){const s=Math.max(e[n]-r[n],0);return r[n]+=s,s}r.y+=t("top"),r.x+=t("left"),t("right"),t("bottom")}function W6(r,e){const t=e.maxPadding;function n(s){const i={left:0,top:0,right:0,bottom:0};return s.forEach(a=>{i[a]=Math.max(e[a],t[a])}),i}return n(r?["left","right"]:["top","bottom"])}function ff(r,e,t,n){const s=[];let i,a,o,l,c,A;for(i=0,a=r.length,c=0;i<a;++i){o=r[i],l=o.box,l.update(o.width||e.w,o.height||e.h,W6(o.horizontal,e));const{same:d,other:h}=K6(e,t,o,n);c|=d&&s.length,A=A||h,l.fullSize||s.push(o)}return c&&ff(s,e,t,n)||A}function Qp(r,e,t,n,s){r.top=t,r.left=e,r.right=e+n,r.bottom=t+s,r.width=n,r.height=s}function UB(r,e,t,n){const s=t.padding;let{x:i,y:a}=e;for(const o of r){const l=o.box,c=n[o.stack]||{placed:0,weight:1},A=o.stackWeight/c.weight||1;if(o.horizontal){const d=e.w*A,h=c.size||l.height;Ag(c.start)&&(a=c.start),l.fullSize?Qp(l,s.left,a,t.outerWidth-s.right-s.left,h):Qp(l,e.left+c.placed,a,d,h),c.start=a,c.placed+=d,a=l.bottom}else{const d=e.h*A,h=c.size||l.width;Ag(c.start)&&(i=c.start),l.fullSize?Qp(l,i,s.top,h,t.outerHeight-s.bottom-s.top):Qp(l,i,e.top+c.placed,h,d),c.start=i,c.placed+=d,i=l.right}}e.x=i,e.y=a}var Ti={addBox(r,e){r.boxes||(r.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(t){e.draw(t)}}]},r.boxes.push(e)},removeBox(r,e){const t=r.boxes?r.boxes.indexOf(e):-1;t!==-1&&r.boxes.splice(t,1)},configure(r,e,t){e.fullSize=t.fullSize,e.position=t.position,e.weight=t.weight},update(r,e,t,n){if(!r)return;const s=ui(r.options.layout.padding),i=Math.max(e-s.width,0),a=Math.max(t-s.height,0),o=z6(r.boxes),l=o.vertical,c=o.horizontal;xr(r.boxes,f=>{typeof f.beforeLayout=="function"&&f.beforeLayout()});const A=l.reduce((f,g)=>g.box.options&&g.box.options.display===!1?f:f+1,0)||1,d=Object.freeze({outerWidth:e,outerHeight:t,padding:s,availableWidth:i,availableHeight:a,vBoxMaxWidth:i/2/A,hBoxMaxHeight:a/2}),h=Object.assign({},s);zI(h,ui(n));const u=Object.assign({maxPadding:h,w:i,h:a,x:s.left,y:s.top},s),p=G6(l.concat(c),d);ff(o.fullSize,u,d,p),ff(l,u,d,p),ff(c,u,d,p)&&ff(l,u,d,p),q6(u),UB(o.leftAndTop,u,d,p),u.x+=u.w,u.y+=u.h,UB(o.rightAndBottom,u,d,p),r.chartArea={left:u.left,top:u.top,right:u.left+u.w,bottom:u.top+u.h,height:u.h,width:u.w},xr(o.chartArea,f=>{const g=f.box;Object.assign(g,r.chartArea),g.update(u.w,u.h,{left:0,top:0,right:0,bottom:0})})}};class KI{acquireContext(e,t){}releaseContext(e){return!1}addEventListener(e,t,n){}removeEventListener(e,t,n){}getDevicePixelRatio(){return 1}getMaximumSize(e,t,n,s){return t=Math.max(0,t||e.width),n=n||e.height,{width:t,height:Math.max(0,s?Math.floor(t/s):n)}}isAttached(e){return!0}updateConfig(e){}}class Y6 extends KI{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const Z0="$chartjs",X6={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},MB=r=>r===null||r==="";function J6(r,e){const t=r.style,n=r.getAttribute("height"),s=r.getAttribute("width");if(r[Z0]={initial:{height:n,width:s,style:{display:t.display,height:t.height,width:t.width}}},t.display=t.display||"block",t.boxSizing=t.boxSizing||"border-box",MB(s)){const i=mB(r,"width");i!==void 0&&(r.width=i)}if(MB(n))if(r.style.height==="")r.height=r.width/(e||2);else{const i=mB(r,"height");i!==void 0&&(r.height=i)}return r}const qI=e6?{passive:!0}:!1;function Z6(r,e,t){r&&r.addEventListener(e,t,qI)}function eR(r,e,t){r&&r.canvas&&r.canvas.removeEventListener(e,t,qI)}function tR(r,e){const t=X6[r.type]||r.type,{x:n,y:s}=Go(r,e);return{type:t,chart:e,native:r,x:n!==void 0?n:null,y:s!==void 0?s:null}}function Pm(r,e){for(const t of r)if(t===e||t.contains(e))return!0}function rR(r,e,t){const n=r.canvas,s=new MutationObserver(i=>{let a=!1;for(const o of i)a=a||Pm(o.addedNodes,n),a=a&&!Pm(o.removedNodes,n);a&&t()});return s.observe(document,{childList:!0,subtree:!0}),s}function nR(r,e,t){const n=r.canvas,s=new MutationObserver(i=>{let a=!1;for(const o of i)a=a||Pm(o.removedNodes,n),a=a&&!Pm(o.addedNodes,n);a&&t()});return s.observe(document,{childList:!0,subtree:!0}),s}const hg=new Map;let NB=0;function WI(){const r=window.devicePixelRatio;r!==NB&&(NB=r,hg.forEach((e,t)=>{t.currentDevicePixelRatio!==r&&e()}))}function sR(r,e){hg.size||window.addEventListener("resize",WI),hg.set(r,e)}function iR(r){hg.delete(r),hg.size||window.removeEventListener("resize",WI)}function aR(r,e,t){const n=r.canvas,s=n&&Lx(n);if(!s)return;const i=_I((o,l)=>{const c=s.clientWidth;t(o,l),c<s.clientWidth&&t()},window),a=new ResizeObserver(o=>{const l=o[0],c=l.contentRect.width,A=l.contentRect.height;c===0&&A===0||i(c,A)});return a.observe(s),sR(r,i),a}function Yy(r,e,t){t&&t.disconnect(),e==="resize"&&iR(r)}function oR(r,e,t){const n=r.canvas,s=_I(i=>{r.ctx!==null&&t(tR(i,r))},r);return Z6(n,e,s),s}class lR extends KI{acquireContext(e,t){const n=e&&e.getContext&&e.getContext("2d");return n&&n.canvas===e?(J6(e,t),n):null}releaseContext(e){const t=e.canvas;if(!t[Z0])return!1;const n=t[Z0].initial;["height","width"].forEach(i=>{const a=n[i];pr(a)?t.removeAttribute(i):t.setAttribute(i,a)});const s=n.style||{};return Object.keys(s).forEach(i=>{t.style[i]=s[i]}),t.width=t.width,delete t[Z0],!0}addEventListener(e,t,n){this.removeEventListener(e,t);const s=e.$proxies||(e.$proxies={}),a={attach:rR,detach:nR,resize:aR}[t]||oR;s[t]=a(e,t,n)}removeEventListener(e,t){const n=e.$proxies||(e.$proxies={}),s=n[t];if(!s)return;({attach:Yy,detach:Yy,resize:Yy}[t]||eR)(e,t,s),n[t]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,t,n,s){return ZD(e,t,n,s)}isAttached(e){const t=e&&Lx(e);return!!(t&&t.isConnected)}}function cR(r){return!Fx()||typeof OffscreenCanvas<"u"&&r instanceof OffscreenCanvas?Y6:lR}var K0;let oc=(K0=class{constructor(){Fe(this,"x");Fe(this,"y");Fe(this,"active",!1);Fe(this,"options");Fe(this,"$animations")}tooltipPosition(e){const{x:t,y:n}=this.getProps(["x","y"],e);return{x:t,y:n}}hasValue(){return th(this.x)&&th(this.y)}getProps(e,t){const n=this.$animations;if(!t||!n)return this;const s={};return e.forEach(i=>{s[i]=n[i]&&n[i].active()?n[i]._to:this[i]}),s}},Fe(K0,"defaults",{}),Fe(K0,"defaultRoutes"),K0);function AR(r,e){const t=r.options.ticks,n=dR(r),s=Math.min(t.maxTicksLimit||n,n),i=t.major.enabled?hR(e):[],a=i.length,o=i[0],l=i[a-1],c=[];if(a>s)return fR(e,c,i,a/s),c;const A=uR(i,e,s);if(a>0){let d,h;const u=a>1?Math.round((l-o)/(a-1)):null;for(Hp(e,c,A,pr(u)?0:o-u,o),d=0,h=a-1;d<h;d++)Hp(e,c,A,i[d],i[d+1]);return Hp(e,c,A,l,pr(u)?e.length:l+u),c}return Hp(e,c,A),c}function dR(r){const e=r.options.offset,t=r._tickSize(),n=r._length/t+(e?0:1),s=r._maxLength/t;return Math.floor(Math.min(n,s))}function uR(r,e,t){const n=gR(r),s=e.length/t;if(!n)return Math.max(s,1);const i=rD(n);for(let a=0,o=i.length-1;a<o;a++){const l=i[a];if(l>s)return l}return Math.max(s,1)}function hR(r){const e=[];let t,n;for(t=0,n=r.length;t<n;t++)r[t].major&&e.push(t);return e}function fR(r,e,t,n){let s=0,i=t[0],a;for(n=Math.ceil(n),a=0;a<r.length;a++)a===i&&(e.push(r[a]),s++,i=t[s*n])}function Hp(r,e,t,n,s){const i=qt(n,0),a=Math.min(qt(s,r.length),r.length);let o=0,l,c,A;for(t=Math.ceil(t),s&&(l=s-n,t=l/Math.floor(l/t)),A=i;A<0;)o++,A=Math.round(i+o*t);for(c=Math.max(i,0);c<a;c++)c===A&&(e.push(r[c]),o++,A=Math.round(i+o*t))}function gR(r){const e=r.length;let t,n;if(e<2)return!1;for(n=r[0],t=1;t<e;++t)if(r[t]-r[t-1]!==n)return!1;return n}const pR=r=>r==="left"?"right":r==="right"?"left":r,PB=(r,e,t)=>e==="top"||e==="left"?r[e]+t:r[e]-t,DB=(r,e)=>Math.min(e||r,r);function RB(r,e){const t=[],n=r.length/e,s=r.length;let i=0;for(;i<s;i+=n)t.push(r[Math.floor(i)]);return t}function mR(r,e,t){const n=r.ticks.length,s=Math.min(e,n-1),i=r._startPixel,a=r._endPixel,o=1e-6;let l=r.getPixelForTick(s),c;if(!(t&&(n===1?c=Math.max(l-i,a-l):e===0?c=(r.getPixelForTick(1)-l)/2:c=(l-r.getPixelForTick(s-1))/2,l+=s<e?c:-c,l<i-o||l>a+o)))return l}function bR(r,e){xr(r,t=>{const n=t.gc,s=n.length/2;let i;if(s>e){for(i=0;i<s;++i)delete t.data[n[i]];n.splice(0,s)}})}function Xh(r){return r.drawTicks?r.tickLength:0}function OB(r,e){if(!r.display)return 0;const t=vs(r.font,e),n=ui(r.padding);return(Sn(r.text)?r.text.length:1)*t.lineHeight+n.height}function yR(r,e){return IA(r,{scale:e,type:"scale"})}function wR(r,e,t){return IA(r,{tick:t,index:e,type:"tick"})}function vR(r,e,t){let n=Cx(r);return(t&&e!=="right"||!t&&e==="right")&&(n=pR(n)),n}function xR(r,e,t,n){const{top:s,left:i,bottom:a,right:o,chart:l}=r,{chartArea:c,scales:A}=l;let d=0,h,u,p;const f=a-s,g=o-i;if(r.isHorizontal()){if(u=_i(n,i,o),Br(t)){const m=Object.keys(t)[0],x=t[m];p=A[m].getPixelForValue(x)+f-e}else t==="center"?p=(c.bottom+c.top)/2+f-e:p=PB(r,t,e);h=o-i}else{if(Br(t)){const m=Object.keys(t)[0],x=t[m];u=A[m].getPixelForValue(x)-g+e}else t==="center"?u=(c.left+c.right)/2-g+e:u=PB(r,t,e);p=_i(n,a,s),d=t==="left"?-ds:ds}return{titleX:u,titleY:p,maxWidth:h,rotation:d}}class zd extends oc{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,t){return e}getUserBounds(){let{_userMin:e,_userMax:t,_suggestedMin:n,_suggestedMax:s}=this;return e=ka(e,Number.POSITIVE_INFINITY),t=ka(t,Number.NEGATIVE_INFINITY),n=ka(n,Number.POSITIVE_INFINITY),s=ka(s,Number.NEGATIVE_INFINITY),{min:ka(e,n),max:ka(t,s),minDefined:Kn(e),maxDefined:Kn(t)}}getMinMax(e){let{min:t,max:n,minDefined:s,maxDefined:i}=this.getUserBounds(),a;if(s&&i)return{min:t,max:n};const o=this.getMatchingVisibleMetas();for(let l=0,c=o.length;l<c;++l)a=o[l].controller.getMinMax(this,e),s||(t=Math.min(t,a.min)),i||(n=Math.max(n,a.max));return t=i&&t>n?n:t,n=s&&t>n?t:n,{min:ka(t,ka(n,t)),max:ka(n,ka(t,n))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){zt(this.options.beforeUpdate,[this])}update(e,t,n){const{beginAtZero:s,grace:i,ticks:a}=this.options,o=a.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this._margins=n=Object.assign({left:0,right:0,top:0,bottom:0},n),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+n.left+n.right:this.height+n.top+n.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=FD(this,i,s),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const l=o<this.ticks.length;this._convertTicksToLabels(l?RB(this.ticks,o):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),a.display&&(a.autoSkip||a.source==="auto")&&(this.ticks=AR(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),l&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,t,n;this.isHorizontal()?(t=this.left,n=this.right):(t=this.top,n=this.bottom,e=!e),this._startPixel=t,this._endPixel=n,this._reversePixels=e,this._length=n-t,this._alignToPixels=this.options.alignToPixels}afterUpdate(){zt(this.options.afterUpdate,[this])}beforeSetDimensions(){zt(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){zt(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),zt(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){zt(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const t=this.options.ticks;let n,s,i;for(n=0,s=e.length;n<s;n++)i=e[n],i.label=zt(t.callback,[i.value,n,e],this)}afterTickToLabelConversion(){zt(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){zt(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,t=e.ticks,n=DB(this.ticks.length,e.ticks.maxTicksLimit),s=t.minRotation||0,i=t.maxRotation;let a=s,o,l,c;if(!this._isVisible()||!t.display||s>=i||n<=1||!this.isHorizontal()){this.labelRotation=s;return}const A=this._getLabelSizes(),d=A.widest.width,h=A.highest.height,u=qs(this.chart.width-d,0,this.maxWidth);o=e.offset?this.maxWidth/n:u/(n-1),d+6>o&&(o=u/(n-(e.offset?.5:1)),l=this.maxHeight-Xh(e.grid)-t.padding-OB(e.title,this.chart.options.font),c=Math.sqrt(d*d+h*h),a=_x(Math.min(Math.asin(qs((A.highest.height+6)/o,-1,1)),Math.asin(qs(l/c,-1,1))-Math.asin(qs(h/c,-1,1)))),a=Math.max(s,Math.min(i,a))),this.labelRotation=a}afterCalculateLabelRotation(){zt(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){zt(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:t,options:{ticks:n,title:s,grid:i}}=this,a=this._isVisible(),o=this.isHorizontal();if(a){const l=OB(s,t.options.font);if(o?(e.width=this.maxWidth,e.height=Xh(i)+l):(e.height=this.maxHeight,e.width=Xh(i)+l),n.display&&this.ticks.length){const{first:c,last:A,widest:d,highest:h}=this._getLabelSizes(),u=n.padding*2,p=ho(this.labelRotation),f=Math.cos(p),g=Math.sin(p);if(o){const m=n.mirror?0:g*d.width+f*h.height;e.height=Math.min(this.maxHeight,e.height+m+u)}else{const m=n.mirror?0:f*d.width+g*h.height;e.width=Math.min(this.maxWidth,e.width+m+u)}this._calculatePadding(c,A,g,f)}}this._handleMargins(),o?(this.width=this._length=t.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=t.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,t,n,s){const{ticks:{align:i,padding:a},position:o}=this.options,l=this.labelRotation!==0,c=o!=="top"&&this.axis==="x";if(this.isHorizontal()){const A=this.getPixelForTick(0)-this.left,d=this.right-this.getPixelForTick(this.ticks.length-1);let h=0,u=0;l?c?(h=s*e.width,u=n*t.height):(h=n*e.height,u=s*t.width):i==="start"?u=t.width:i==="end"?h=e.width:i!=="inner"&&(h=e.width/2,u=t.width/2),this.paddingLeft=Math.max((h-A+a)*this.width/(this.width-A),0),this.paddingRight=Math.max((u-d+a)*this.width/(this.width-d),0)}else{let A=t.height/2,d=e.height/2;i==="start"?(A=0,d=e.height):i==="end"&&(A=t.height,d=0),this.paddingTop=A+a,this.paddingBottom=d+a}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){zt(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:t}=this.options;return t==="top"||t==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let t,n;for(t=0,n=e.length;t<n;t++)pr(e[t].label)&&(e.splice(t,1),n--,t--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const t=this.options.ticks.sampleSize;let n=this.ticks;t<n.length&&(n=RB(n,t)),this._labelSizes=e=this._computeLabelSizes(n,n.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,t,n){const{ctx:s,_longestTextCache:i}=this,a=[],o=[],l=Math.floor(t/DB(t,n));let c=0,A=0,d,h,u,p,f,g,m,x,S,B,F;for(d=0;d<t;d+=l){if(p=e[d].label,f=this._resolveTickFontOptions(d),s.font=g=f.string,m=i[g]=i[g]||{data:{},gc:[]},x=f.lineHeight,S=B=0,!pr(p)&&!Sn(p))S=Mm(s,m.data,m.gc,S,p),B=x;else if(Sn(p))for(h=0,u=p.length;h<u;++h)F=p[h],!pr(F)&&!Sn(F)&&(S=Mm(s,m.data,m.gc,S,F),B+=x);a.push(S),o.push(B),c=Math.max(S,c),A=Math.max(B,A)}bR(i,t);const N=a.indexOf(c),E=o.indexOf(A),w=v=>({width:a[v]||0,height:o[v]||0});return{first:w(0),last:w(t-1),widest:w(N),highest:w(E),widths:a,heights:o}}getLabelForValue(e){return e}getPixelForValue(e,t){return NaN}getValueForPixel(e){}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const t=this._startPixel+e*this._length;return aD(this._alignToPixels?XA(this.chart,t,0):t)}getDecimalForPixel(e){const t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:t}=this;return e<0&&t<0?t:e>0&&t>0?e:0}getContext(e){const t=this.ticks||[];if(e>=0&&e<t.length){const n=t[e];return n.$context||(n.$context=wR(this.getContext(),e,n))}return this.$context||(this.$context=yR(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,t=ho(this.labelRotation),n=Math.abs(Math.cos(t)),s=Math.abs(Math.sin(t)),i=this._getLabelSizes(),a=e.autoSkipPadding||0,o=i?i.widest.width+a:0,l=i?i.highest.height+a:0;return this.isHorizontal()?l*n>o*s?o/n:l/s:l*s<o*n?l/n:o/s}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const t=this.axis,n=this.chart,s=this.options,{grid:i,position:a,border:o}=s,l=i.offset,c=this.isHorizontal(),d=this.ticks.length+(l?1:0),h=Xh(i),u=[],p=o.setContext(this.getContext()),f=p.display?p.width:0,g=f/2,m=function(se){return XA(n,se,f)};let x,S,B,F,N,E,w,v,I,k,_,T;if(a==="top")x=m(this.bottom),E=this.bottom-h,v=x-g,k=m(e.top)+g,T=e.bottom;else if(a==="bottom")x=m(this.top),k=e.top,T=m(e.bottom)-g,E=x+g,v=this.top+h;else if(a==="left")x=m(this.right),N=this.right-h,w=x-g,I=m(e.left)+g,_=e.right;else if(a==="right")x=m(this.left),I=e.left,_=m(e.right)-g,N=x+g,w=this.left+h;else if(t==="x"){if(a==="center")x=m((e.top+e.bottom)/2+.5);else if(Br(a)){const se=Object.keys(a)[0],X=a[se];x=m(this.chart.scales[se].getPixelForValue(X))}k=e.top,T=e.bottom,E=x+g,v=E+h}else if(t==="y"){if(a==="center")x=m((e.left+e.right)/2);else if(Br(a)){const se=Object.keys(a)[0],X=a[se];x=m(this.chart.scales[se].getPixelForValue(X))}N=x-g,w=N-h,I=e.left,_=e.right}const L=qt(s.ticks.maxTicksLimit,d),K=Math.max(1,Math.ceil(d/L));for(S=0;S<d;S+=K){const se=this.getContext(S),X=i.setContext(se),$=o.setContext(se),V=X.lineWidth,he=X.color,z=$.dash||[],M=$.dashOffset,O=X.tickWidth,H=X.tickColor,J=X.tickBorderDash||[],de=X.tickBorderDashOffset;B=mR(this,S,l),B!==void 0&&(F=XA(n,B,V),c?N=w=I=_=F:E=v=k=T=F,u.push({tx1:N,ty1:E,tx2:w,ty2:v,x1:I,y1:k,x2:_,y2:T,width:V,color:he,borderDash:z,borderDashOffset:M,tickWidth:O,tickColor:H,tickBorderDash:J,tickBorderDashOffset:de}))}return this._ticksLength=d,this._borderValue=x,u}_computeLabelItems(e){const t=this.axis,n=this.options,{position:s,ticks:i}=n,a=this.isHorizontal(),o=this.ticks,{align:l,crossAlign:c,padding:A,mirror:d}=i,h=Xh(n.grid),u=h+A,p=d?-A:u,f=-ho(this.labelRotation),g=[];let m,x,S,B,F,N,E,w,v,I,k,_,T="middle";if(s==="top")N=this.bottom-p,E=this._getXAxisLabelAlignment();else if(s==="bottom")N=this.top+p,E=this._getXAxisLabelAlignment();else if(s==="left"){const K=this._getYAxisLabelAlignment(h);E=K.textAlign,F=K.x}else if(s==="right"){const K=this._getYAxisLabelAlignment(h);E=K.textAlign,F=K.x}else if(t==="x"){if(s==="center")N=(e.top+e.bottom)/2+u;else if(Br(s)){const K=Object.keys(s)[0],se=s[K];N=this.chart.scales[K].getPixelForValue(se)+u}E=this._getXAxisLabelAlignment()}else if(t==="y"){if(s==="center")F=(e.left+e.right)/2-u;else if(Br(s)){const K=Object.keys(s)[0],se=s[K];F=this.chart.scales[K].getPixelForValue(se)}E=this._getYAxisLabelAlignment(h).textAlign}t==="y"&&(l==="start"?T="top":l==="end"&&(T="bottom"));const L=this._getLabelSizes();for(m=0,x=o.length;m<x;++m){S=o[m],B=S.label;const K=i.setContext(this.getContext(m));w=this.getPixelForTick(m)+i.labelOffset,v=this._resolveTickFontOptions(m),I=v.lineHeight,k=Sn(B)?B.length:1;const se=k/2,X=K.color,$=K.textStrokeColor,V=K.textStrokeWidth;let he=E;a?(F=w,E==="inner"&&(m===x-1?he=this.options.reverse?"left":"right":m===0?he=this.options.reverse?"right":"left":he="center"),s==="top"?c==="near"||f!==0?_=-k*I+I/2:c==="center"?_=-L.highest.height/2-se*I+I:_=-L.highest.height+I/2:c==="near"||f!==0?_=I/2:c==="center"?_=L.highest.height/2-se*I:_=L.highest.height-k*I,d&&(_*=-1),f!==0&&!K.showLabelBackdrop&&(F+=I/2*Math.sin(f))):(N=w,_=(1-k)*I/2);let z;if(K.showLabelBackdrop){const M=ui(K.backdropPadding),O=L.heights[m],H=L.widths[m];let J=_-M.top,de=0-M.left;switch(T){case"middle":J-=O/2;break;case"bottom":J-=O;break}switch(E){case"center":de-=H/2;break;case"right":de-=H;break;case"inner":m===x-1?de-=H:m>0&&(de-=H/2);break}z={left:de,top:J,width:H+M.width,height:O+M.height,color:K.backdropColor}}g.push({label:B,font:v,textOffset:_,options:{rotation:f,color:X,strokeColor:$,strokeWidth:V,textAlign:he,textBaseline:T,translation:[F,N],backdrop:z}})}return g}_getXAxisLabelAlignment(){const{position:e,ticks:t}=this.options;if(-ho(this.labelRotation))return e==="top"?"left":"right";let s="center";return t.align==="start"?s="left":t.align==="end"?s="right":t.align==="inner"&&(s="inner"),s}_getYAxisLabelAlignment(e){const{position:t,ticks:{crossAlign:n,mirror:s,padding:i}}=this.options,a=this._getLabelSizes(),o=e+i,l=a.widest.width;let c,A;return t==="left"?s?(A=this.right+i,n==="near"?c="left":n==="center"?(c="center",A+=l/2):(c="right",A+=l)):(A=this.right-o,n==="near"?c="right":n==="center"?(c="center",A-=l/2):(c="left",A=this.left)):t==="right"?s?(A=this.left+i,n==="near"?c="right":n==="center"?(c="center",A-=l/2):(c="left",A-=l)):(A=this.left+o,n==="near"?c="left":n==="center"?(c="center",A+=l/2):(c="right",A=this.right)):c="right",{textAlign:c,x:A}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,t=this.options.position;if(t==="left"||t==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(t==="top"||t==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:t},left:n,top:s,width:i,height:a}=this;t&&(e.save(),e.fillStyle=t,e.fillRect(n,s,i,a),e.restore())}getLineWidthForValue(e){const t=this.options.grid;if(!this._isVisible()||!t.display)return 0;const s=this.ticks.findIndex(i=>i.value===e);return s>=0?t.setContext(this.getContext(s)).lineWidth:0}drawGrid(e){const t=this.options.grid,n=this.ctx,s=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let i,a;const o=(l,c,A)=>{!A.width||!A.color||(n.save(),n.lineWidth=A.width,n.strokeStyle=A.color,n.setLineDash(A.borderDash||[]),n.lineDashOffset=A.borderDashOffset,n.beginPath(),n.moveTo(l.x,l.y),n.lineTo(c.x,c.y),n.stroke(),n.restore())};if(t.display)for(i=0,a=s.length;i<a;++i){const l=s[i];t.drawOnChartArea&&o({x:l.x1,y:l.y1},{x:l.x2,y:l.y2},l),t.drawTicks&&o({x:l.tx1,y:l.ty1},{x:l.tx2,y:l.ty2},{color:l.tickColor,width:l.tickWidth,borderDash:l.tickBorderDash,borderDashOffset:l.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:t,options:{border:n,grid:s}}=this,i=n.setContext(this.getContext()),a=n.display?i.width:0;if(!a)return;const o=s.setContext(this.getContext(0)).lineWidth,l=this._borderValue;let c,A,d,h;this.isHorizontal()?(c=XA(e,this.left,a)-a/2,A=XA(e,this.right,o)+o/2,d=h=l):(d=XA(e,this.top,a)-a/2,h=XA(e,this.bottom,o)+o/2,c=A=l),t.save(),t.lineWidth=i.width,t.strokeStyle=i.color,t.beginPath(),t.moveTo(c,d),t.lineTo(A,h),t.stroke(),t.restore()}drawLabels(e){if(!this.options.ticks.display)return;const n=this.ctx,s=this._computeLabelArea();s&&Ib(n,s);const i=this.getLabelItems(e);for(const a of i){const o=a.options,l=a.font,c=a.label,A=a.textOffset;Ld(n,c,0,A,l,o)}s&&Tb(n)}drawTitle(){const{ctx:e,options:{position:t,title:n,reverse:s}}=this;if(!n.display)return;const i=vs(n.font),a=ui(n.padding),o=n.align;let l=i.lineHeight/2;t==="bottom"||t==="center"||Br(t)?(l+=a.bottom,Sn(n.text)&&(l+=i.lineHeight*(n.text.length-1))):l+=a.top;const{titleX:c,titleY:A,maxWidth:d,rotation:h}=xR(this,l,t,o);Ld(e,n.text,0,0,i,{color:n.color,maxWidth:d,rotation:h,textAlign:vR(o,t,s),textBaseline:"middle",translation:[c,A]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,t=e.ticks&&e.ticks.z||0,n=qt(e.grid&&e.grid.z,-1),s=qt(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==zd.prototype.draw?[{z:t,draw:i=>{this.draw(i)}}]:[{z:n,draw:i=>{this.drawBackground(),this.drawGrid(i),this.drawTitle()}},{z:s,draw:()=>{this.drawBorder()}},{z:t,draw:i=>{this.drawLabels(i)}}]}getMatchingVisibleMetas(e){const t=this.chart.getSortedVisibleDatasetMetas(),n=this.axis+"AxisID",s=[];let i,a;for(i=0,a=t.length;i<a;++i){const o=t[i];o[n]===this.id&&(!e||o.type===e)&&s.push(o)}return s}_resolveTickFontOptions(e){const t=this.options.ticks.setContext(this.getContext(e));return vs(t.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class jp{constructor(e,t,n){this.type=e,this.scope=t,this.override=n,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const t=Object.getPrototypeOf(e);let n;CR(t)&&(n=this.register(t));const s=this.items,i=e.id,a=this.scope+"."+i;if(!i)throw new Error("class does not have id: "+e);return i in s||(s[i]=e,_R(e,a,n),this.override&&Tn.override(e.id,e.overrides)),a}get(e){return this.items[e]}unregister(e){const t=this.items,n=e.id,s=this.scope;n in t&&delete t[n],s&&n in Tn[s]&&(delete Tn[s][n],this.override&&delete Fd[n])}}function _R(r,e,t){const n=ol(Object.create(null),[t?Tn.get(t):{},Tn.get(e),r.defaults]);Tn.set(e,n),r.defaultRoutes&&BR(e,r.defaultRoutes),r.descriptors&&Tn.describe(e,r.descriptors)}function BR(r,e){Object.keys(e).forEach(t=>{const n=t.split("."),s=n.pop(),i=[r].concat(n).join("."),a=e[t].split("."),o=a.pop(),l=a.join(".");Tn.route(i,s,l,o)})}function CR(r){return"id"in r&&"defaults"in r}class SR{constructor(){this.controllers=new jp(po,"datasets",!0),this.elements=new jp(oc,"elements"),this.plugins=new jp(Object,"plugins"),this.scales=new jp(zd,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,t,n){[...t].forEach(s=>{const i=n||this._getRegistryForType(s);n||i.isForType(s)||i===this.plugins&&s.id?this._exec(e,i,s):xr(s,a=>{const o=n||this._getRegistryForType(a);this._exec(e,o,a)})})}_exec(e,t,n){const s=xx(e);zt(n["before"+s],[],n),t[e](n),zt(n["after"+s],[],n)}_getRegistryForType(e){for(let t=0;t<this._typedRegistries.length;t++){const n=this._typedRegistries[t];if(n.isForType(e))return n}return this.plugins}_get(e,t,n){const s=t.get(e);if(s===void 0)throw new Error('"'+e+'" is not a registered '+n+".");return s}}var jo=new SR;class kR{constructor(){this._init=void 0}notify(e,t,n,s){if(t==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install")),this._init===void 0)return;const i=s?this._descriptors(e).filter(s):this._descriptors(e),a=this._notify(i,e,t,n);return t==="afterDestroy"&&(this._notify(i,e,"stop"),this._notify(this._init,e,"uninstall"),this._init=void 0),a}_notify(e,t,n,s){s=s||{};for(const i of e){const a=i.plugin,o=a[n],l=[t,s,i.options];if(zt(o,l,a)===!1&&s.cancelable)return!1}return!0}invalidate(){pr(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}_createDescriptors(e,t){const n=e&&e.config,s=qt(n.options&&n.options.plugins,{}),i=ER(n);return s===!1&&!t?[]:TR(e,i,s,t)}_notifyStateChanges(e){const t=this._oldCache||[],n=this._cache,s=(i,a)=>i.filter(o=>!a.some(l=>o.plugin.id===l.plugin.id));this._notify(s(t,n),e,"stop"),this._notify(s(n,t),e,"start")}}function ER(r){const e={},t=[],n=Object.keys(jo.plugins.items);for(let i=0;i<n.length;i++)t.push(jo.getPlugin(n[i]));const s=r.plugins||[];for(let i=0;i<s.length;i++){const a=s[i];t.indexOf(a)===-1&&(t.push(a),e[a.id]=!0)}return{plugins:t,localIds:e}}function IR(r,e){return!e&&r===!1?null:r===!0?{}:r}function TR(r,{plugins:e,localIds:t},n,s){const i=[],a=r.getContext();for(const o of e){const l=o.id,c=IR(n[l],s);c!==null&&i.push({plugin:o,options:FR(r.config,{plugin:o,local:t[l]},c,a)})}return i}function FR(r,{plugin:e,local:t},n,s){const i=r.pluginScopeKeys(e),a=r.getOptionScopes(n,i);return t&&e.defaults&&a.push(e.defaults),r.createResolver(a,s,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function kv(r,e){const t=Tn.datasets[r]||{};return((e.datasets||{})[r]||{}).indexAxis||e.indexAxis||t.indexAxis||"x"}function LR(r,e){let t=r;return r==="_index_"?t=e:r==="_value_"&&(t=e==="x"?"y":"x"),t}function UR(r,e){return r===e?"_index_":"_value_"}function QB(r){if(r==="x"||r==="y"||r==="r")return r}function MR(r){if(r==="top"||r==="bottom")return"x";if(r==="left"||r==="right")return"y"}function Ev(r,...e){if(QB(r))return r;for(const t of e){const n=t.axis||MR(t.position)||r.length>1&&QB(r[0].toLowerCase());if(n)return n}throw new Error(`Cannot determine type of '${r}' axis. Please provide 'axis' or 'position' option.`)}function HB(r,e,t){if(t[e+"AxisID"]===r)return{axis:e}}function NR(r,e){if(e.data&&e.data.datasets){const t=e.data.datasets.filter(n=>n.xAxisID===r||n.yAxisID===r);if(t.length)return HB(r,"x",t[0])||HB(r,"y",t[0])}return{}}function PR(r,e){const t=Fd[r.type]||{scales:{}},n=e.scales||{},s=kv(r.type,e),i=Object.create(null);return Object.keys(n).forEach(a=>{const o=n[a];if(!Br(o))return console.error(`Invalid scale configuration for scale: ${a}`);if(o._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${a}`);const l=Ev(a,o,NR(a,r),Tn.scales[o.type]),c=UR(l,s),A=t.scales||{};i[a]=Mf(Object.create(null),[{axis:l},o,A[l],A[c]])}),r.data.datasets.forEach(a=>{const o=a.type||r.type,l=a.indexAxis||kv(o,e),A=(Fd[o]||{}).scales||{};Object.keys(A).forEach(d=>{const h=LR(d,l),u=a[h+"AxisID"]||h;i[u]=i[u]||Object.create(null),Mf(i[u],[{axis:h},n[u],A[d]])})}),Object.keys(i).forEach(a=>{const o=i[a];Mf(o,[Tn.scales[o.type],Tn.scale])}),i}function YI(r){const e=r.options||(r.options={});e.plugins=qt(e.plugins,{}),e.scales=PR(r,e)}function XI(r){return r=r||{},r.datasets=r.datasets||[],r.labels=r.labels||[],r}function DR(r){return r=r||{},r.data=XI(r.data),YI(r),r}const jB=new Map,JI=new Set;function Vp(r,e){let t=jB.get(r);return t||(t=e(),jB.set(r,t),JI.add(t)),t}const Jh=(r,e,t)=>{const n=pA(e,t);n!==void 0&&r.add(n)};class RR{constructor(e){this._config=DR(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=XI(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),YI(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return Vp(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,t){return Vp(`${e}.transition.${t}`,()=>[[`datasets.${e}.transitions.${t}`,`transitions.${t}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,t){return Vp(`${e}-${t}`,()=>[[`datasets.${e}.elements.${t}`,`datasets.${e}`,`elements.${t}`,""]])}pluginScopeKeys(e){const t=e.id,n=this.type;return Vp(`${n}-plugin-${t}`,()=>[[`plugins.${t}`,...e.ProgressOptionScopes||[]]])}_cachedScopes(e,t){const n=this._scopeCache;let s=n.get(e);return(!s||t)&&(s=new Map,n.set(e,s)),s}getOptionScopes(e,t,n){const{options:s,type:i}=this,a=this._cachedScopes(e,n),o=a.get(t);if(o)return o;const l=new Set;t.forEach(A=>{e&&(l.add(e),A.forEach(d=>Jh(l,e,d))),A.forEach(d=>Jh(l,s,d)),A.forEach(d=>Jh(l,Fd[i]||{},d)),A.forEach(d=>Jh(l,Tn,d)),A.forEach(d=>Jh(l,Bv,d))});const c=Array.from(l);return c.length===0&&c.push(Object.create(null)),JI.has(t)&&a.set(t,c),c}chartOptionScopes(){const{options:e,type:t}=this;return[e,Fd[t]||{},Tn.datasets[t]||{},{type:t},Tn,Bv]}resolveNamedOptions(e,t,n,s=[""]){const i={$shared:!0},{resolver:a,subPrefixes:o}=VB(this._resolverCache,e,s);let l=a;if(QR(a,t)){i.$shared=!1,n=mA(n)?n():n;const c=this.createResolver(e,n,o);l=rh(a,n,c)}for(const c of t)i[c]=l[c];return i}createResolver(e,t,n=[""],s){const{resolver:i}=VB(this._resolverCache,e,n);return Br(t)?rh(i,t,void 0,s):i}}function VB(r,e,t){let n=r.get(e);n||(n=new Map,r.set(e,n));const s=t.join();let i=n.get(s);return i||(i={resolver:Ex(e,t),subPrefixes:t.filter(o=>!o.toLowerCase().includes("hover"))},n.set(s,i)),i}const OR=r=>Br(r)&&Object.getOwnPropertyNames(r).some(e=>mA(r[e]));function QR(r,e){const{isScriptable:t,isIndexable:n}=II(r);for(const s of e){const i=t(s),a=n(s),o=(a||i)&&r[s];if(i&&(mA(o)||OR(o))||a&&Sn(o))return!0}return!1}var HR="4.5.1";const jR=["top","bottom","left","right","chartArea"];function $B(r,e){return r==="top"||r==="bottom"||jR.indexOf(r)===-1&&e==="x"}function GB(r,e){return function(t,n){return t[r]===n[r]?t[e]-n[e]:t[r]-n[r]}}function zB(r){const e=r.chart,t=e.options.animation;e.notifyPlugins("afterRender"),zt(t&&t.onComplete,[r],e)}function VR(r){const e=r.chart,t=e.options.animation;zt(t&&t.onProgress,[r],e)}function ZI(r){return Fx()&&typeof r=="string"?r=document.getElementById(r):r&&r.length&&(r=r[0]),r&&r.canvas&&(r=r.canvas),r}const em={},KB=r=>{const e=ZI(r);return Object.values(em).filter(t=>t.canvas===e).pop()};function $R(r,e,t){const n=Object.keys(r);for(const s of n){const i=+s;if(i>=e){const a=r[s];delete r[s],(t>0||i>e)&&(r[i+t]=a)}}}function GR(r,e,t,n){return!t||r.type==="mouseout"?null:n?e:r}var Rc;let bh=(Rc=class{static register(...e){jo.add(...e),qB()}static unregister(...e){jo.remove(...e),qB()}constructor(e,t){const n=this.config=new RR(t),s=ZI(e),i=KB(s);if(i)throw new Error("Canvas is already in use. Chart with ID '"+i.id+"' must be destroyed before the canvas with ID '"+i.canvas.id+"' can be reused.");const a=n.createResolver(n.chartOptionScopes(),this.getContext());this.platform=new(n.platform||cR(s)),this.platform.updateConfig(n);const o=this.platform.acquireContext(s,a.aspectRatio),l=o&&o.canvas,c=l&&l.height,A=l&&l.width;if(this.id=KP(),this.ctx=o,this.canvas=l,this.width=A,this.height=c,this._options=a,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new kR,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=AD(d=>this.update(d),a.resizeDelay||0),this._dataChanges=[],em[this.id]=this,!o||!l){console.error("Failed to create chart: can't acquire context from the given item");return}Ml.listen(this,"complete",zB),Ml.listen(this,"progress",VR),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:t},width:n,height:s,_aspectRatio:i}=this;return pr(e)?t&&i?i:s?n/s:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return jo}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():pB(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return hB(this.canvas,this.ctx),this}stop(){return Ml.stop(this),this}resize(e,t){Ml.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}_resize(e,t){const n=this.options,s=this.canvas,i=n.maintainAspectRatio&&this.aspectRatio,a=this.platform.getMaximumSize(s,e,t,i),o=n.devicePixelRatio||this.platform.getDevicePixelRatio(),l=this.width?"resize":"attach";this.width=a.width,this.height=a.height,this._aspectRatio=this.aspectRatio,pB(this,o,!0)&&(this.notifyPlugins("resize",{size:a}),zt(n.onResize,[this,a],this),this.attached&&this._doResize(l)&&this.render())}ensureScalesHaveIDs(){const t=this.options.scales||{};xr(t,(n,s)=>{n.id=s})}buildOrUpdateScales(){const e=this.options,t=e.scales,n=this.scales,s=Object.keys(n).reduce((a,o)=>(a[o]=!1,a),{});let i=[];t&&(i=i.concat(Object.keys(t).map(a=>{const o=t[a],l=Ev(a,o),c=l==="r",A=l==="x";return{options:o,dposition:c?"chartArea":A?"bottom":"left",dtype:c?"radialLinear":A?"category":"linear"}}))),xr(i,a=>{const o=a.options,l=o.id,c=Ev(l,o),A=qt(o.type,a.dtype);(o.position===void 0||$B(o.position,c)!==$B(a.dposition))&&(o.position=a.dposition),s[l]=!0;let d=null;if(l in n&&n[l].type===A)d=n[l];else{const h=jo.getScale(A);d=new h({id:l,type:A,ctx:this.ctx,chart:this}),n[d.id]=d}d.init(o,e)}),xr(s,(a,o)=>{a||delete n[o]}),xr(n,a=>{Ti.configure(this,a,a.options),Ti.addBox(this,a)})}_updateMetasets(){const e=this._metasets,t=this.data.datasets.length,n=e.length;if(e.sort((s,i)=>s.index-i.index),n>t){for(let s=t;s<n;++s)this._destroyDatasetMeta(s);e.splice(t,n-t)}this._sortedMetasets=e.slice(0).sort(GB("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:t}}=this;e.length>t.length&&delete this._stacks,e.forEach((n,s)=>{t.filter(i=>i===n._dataset).length===0&&this._destroyDatasetMeta(s)})}buildOrUpdateControllers(){const e=[],t=this.data.datasets;let n,s;for(this._removeUnreferencedMetasets(),n=0,s=t.length;n<s;n++){const i=t[n];let a=this.getDatasetMeta(n);const o=i.type||this.config.type;if(a.type&&a.type!==o&&(this._destroyDatasetMeta(n),a=this.getDatasetMeta(n)),a.type=o,a.indexAxis=i.indexAxis||kv(o,this.options),a.order=i.order||0,a.index=n,a.label=""+i.label,a.visible=this.isDatasetVisible(n),a.controller)a.controller.updateIndex(n),a.controller.linkScales();else{const l=jo.getController(o),{datasetElementType:c,dataElementType:A}=Tn.datasets[o];Object.assign(l,{dataElementType:jo.getElement(A),datasetElementType:c&&jo.getElement(c)}),a.controller=new l(this,n),e.push(a.controller)}}return this._updateMetasets(),e}_resetElements(){xr(this.data.datasets,(e,t)=>{this.getDatasetMeta(t).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const t=this.config;t.update();const n=this._options=t.createResolver(t.chartOptionScopes(),this.getContext()),s=this._animationsDisabled=!n.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const i=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let a=0;for(let c=0,A=this.data.datasets.length;c<A;c++){const{controller:d}=this.getDatasetMeta(c),h=!s&&i.indexOf(d)===-1;d.buildOrUpdateElements(h),a=Math.max(+d.getMaxOverflow(),a)}a=this._minPadding=n.layout.autoPadding?a:0,this._updateLayout(a),s||xr(i,c=>{c.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(GB("z","_idx"));const{_active:o,_lastEvent:l}=this;l?this._eventHandler(l,!0):o.length&&this._updateHoverStyles(o,o,!0),this.render()}_updateScales(){xr(this.scales,e=>{Ti.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,t=new Set(Object.keys(this._listeners)),n=new Set(e.events);(!sB(t,n)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,t=this._getUniformDataChanges()||[];for(const{method:n,start:s,count:i}of t){const a=n==="_removeElements"?-i:i;$R(e,s,a)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const t=this.data.datasets.length,n=i=>new Set(e.filter(a=>a[0]===i).map((a,o)=>o+","+a.splice(1).join(","))),s=n(0);for(let i=1;i<t;i++)if(!sB(s,n(i)))return;return Array.from(s).map(i=>i.split(",")).map(i=>({method:i[1],start:+i[2],count:+i[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;Ti.update(this,this.width,this.height,e);const t=this.chartArea,n=t.width<=0||t.height<=0;this._layers=[],xr(this.boxes,s=>{n&&s.position==="chartArea"||(s.configure&&s.configure(),this._layers.push(...s._layers()))},this),this._layers.forEach((s,i)=>{s._idx=i}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let t=0,n=this.data.datasets.length;t<n;++t)this.getDatasetMeta(t).controller.configure();for(let t=0,n=this.data.datasets.length;t<n;++t)this._updateDataset(t,mA(e)?e({datasetIndex:t}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,t){const n=this.getDatasetMeta(e),s={meta:n,index:e,mode:t,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",s)!==!1&&(n.controller._update(t),s.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",s))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(Ml.has(this)?this.attached&&!Ml.running(this)&&Ml.start(this):(this.draw(),zB({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:n,height:s}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(n,s)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const t=this._layers;for(e=0;e<t.length&&t[e].z<=0;++e)t[e].draw(this.chartArea);for(this._drawDatasets();e<t.length;++e)t[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const t=this._sortedMetasets,n=[];let s,i;for(s=0,i=t.length;s<i;++s){const a=t[s];(!e||a.visible)&&n.push(a)}return n}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let t=e.length-1;t>=0;--t)this._drawDataset(e[t]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const t=this.ctx,n={meta:e,index:e.index,cancelable:!0},s=QI(this,e);this.notifyPlugins("beforeDatasetDraw",n)!==!1&&(s&&Ib(t,s),e.controller.draw(),s&&Tb(t),n.cancelable=!1,this.notifyPlugins("afterDatasetDraw",n))}isPointInArea(e){return Yo(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,t,n,s){const i=j6.modes[t];return typeof i=="function"?i(this,e,n,s):[]}getDatasetMeta(e){const t=this.data.datasets[e],n=this._metasets;let s=n.filter(i=>i&&i._dataset===t).pop();return s||(s={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},n.push(s)),s}getContext(){return this.$context||(this.$context=IA(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const t=this.data.datasets[e];if(!t)return!1;const n=this.getDatasetMeta(e);return typeof n.hidden=="boolean"?!n.hidden:!t.hidden}setDatasetVisibility(e,t){const n=this.getDatasetMeta(e);n.hidden=!t}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,t,n){const s=n?"show":"hide",i=this.getDatasetMeta(e),a=i.controller._resolveAnimations(void 0,s);Ag(t)?(i.data[t].hidden=!n,this.update()):(this.setDatasetVisibility(e,n),a.update(i,{visible:n}),this.update(o=>o.datasetIndex===e?s:void 0))}hide(e,t){this._updateVisibility(e,t,!1)}show(e,t){this._updateVisibility(e,t,!0)}_destroyDatasetMeta(e){const t=this._metasets[e];t&&t.controller&&t.controller._destroy(),delete this._metasets[e]}_stop(){let e,t;for(this.stop(),Ml.remove(this),e=0,t=this.data.datasets.length;e<t;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:t}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),hB(e,t),this.platform.releaseContext(t),this.canvas=null,this.ctx=null),delete em[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,t=this.platform,n=(i,a)=>{t.addEventListener(this,i,a),e[i]=a},s=(i,a,o)=>{i.offsetX=a,i.offsetY=o,this._eventHandler(i)};xr(this.options.events,i=>n(i,s))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,t=this.platform,n=(l,c)=>{t.addEventListener(this,l,c),e[l]=c},s=(l,c)=>{e[l]&&(t.removeEventListener(this,l,c),delete e[l])},i=(l,c)=>{this.canvas&&this.resize(l,c)};let a;const o=()=>{s("attach",o),this.attached=!0,this.resize(),n("resize",i),n("detach",a)};a=()=>{this.attached=!1,s("resize",i),this._stop(),this._resize(0,0),n("attach",o)},t.isAttached(this.canvas)?o():a()}unbindEvents(){xr(this._listeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._listeners={},xr(this._responsiveListeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,t,n){const s=n?"set":"remove";let i,a,o,l;for(t==="dataset"&&(i=this.getDatasetMeta(e[0].datasetIndex),i.controller["_"+s+"DatasetHoverStyle"]()),o=0,l=e.length;o<l;++o){a=e[o];const c=a&&this.getDatasetMeta(a.datasetIndex).controller;c&&c[s+"HoverStyle"](a.element,a.datasetIndex,a.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const t=this._active||[],n=e.map(({datasetIndex:i,index:a})=>{const o=this.getDatasetMeta(i);if(!o)throw new Error("No dataset found at index "+i);return{datasetIndex:i,element:o.data[a],index:a}});!Fm(n,t)&&(this._active=n,this._lastEvent=null,this._updateHoverStyles(n,t))}notifyPlugins(e,t,n){return this._plugins.notify(this,e,t,n)}isPluginEnabled(e){return this._plugins._cache.filter(t=>t.plugin.id===e).length===1}_updateHoverStyles(e,t,n){const s=this.options.hover,i=(l,c)=>l.filter(A=>!c.some(d=>A.datasetIndex===d.datasetIndex&&A.index===d.index)),a=i(t,e),o=n?e:i(e,t);a.length&&this.updateHoverStyle(a,s.mode,!1),o.length&&s.mode&&this.updateHoverStyle(o,s.mode,!0)}_eventHandler(e,t){const n={event:e,replay:t,cancelable:!0,inChartArea:this.isPointInArea(e)},s=a=>(a.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",n,s)===!1)return;const i=this._handleEvent(e,t,n.inChartArea);return n.cancelable=!1,this.notifyPlugins("afterEvent",n,s),(i||n.changed)&&this.render(),this}_handleEvent(e,t,n){const{_active:s=[],options:i}=this,a=t,o=this._getActiveElements(e,s,n,a),l=ZP(e),c=GR(e,this._lastEvent,n,l);n&&(this._lastEvent=null,zt(i.onHover,[e,o,this],this),l&&zt(i.onClick,[e,o,this],this));const A=!Fm(o,s);return(A||t)&&(this._active=o,this._updateHoverStyles(o,s,t)),this._lastEvent=c,A}_getActiveElements(e,t,n,s){if(e.type==="mouseout")return[];if(!n)return t;const i=this.options.hover;return this.getElementsAtEventForMode(e,i.mode,i,s)}},Fe(Rc,"defaults",Tn),Fe(Rc,"instances",em),Fe(Rc,"overrides",Fd),Fe(Rc,"registry",jo),Fe(Rc,"version",HR),Fe(Rc,"getChart",KB),Rc);function qB(){return xr(bh.instances,r=>r._plugins.invalidate())}function zR(r,e,t){const{startAngle:n,x:s,y:i,outerRadius:a,innerRadius:o,options:l}=e,{borderWidth:c,borderJoinStyle:A}=l,d=Math.min(c/a,Si(n-t));if(r.beginPath(),r.arc(s,i,a-c/2,n+d/2,t-d/2),o>0){const h=Math.min(c/o,Si(n-t));r.arc(s,i,o+c/2,t-h/2,n+h/2,!0)}else{const h=Math.min(c/2,a*Si(n-t));if(A==="round")r.arc(s,i,h,t-Gr/2,n+Gr/2,!0);else if(A==="bevel"){const u=2*h*h,p=-u*Math.cos(t+Gr/2)+s,f=-u*Math.sin(t+Gr/2)+i,g=u*Math.cos(n+Gr/2)+s,m=u*Math.sin(n+Gr/2)+i;r.lineTo(p,f),r.lineTo(g,m)}}r.closePath(),r.moveTo(0,0),r.rect(0,0,r.canvas.width,r.canvas.height),r.clip("evenodd")}function KR(r,e,t){const{startAngle:n,pixelMargin:s,x:i,y:a,outerRadius:o,innerRadius:l}=e;let c=s/o;r.beginPath(),r.arc(i,a,o,n-c,t+c),l>s?(c=s/l,r.arc(i,a,l,t+c,n-c,!0)):r.arc(i,a,s,t+ds,n-ds),r.closePath(),r.clip()}function qR(r){return kx(r,["outerStart","outerEnd","innerStart","innerEnd"])}function WR(r,e,t,n){const s=qR(r.options.borderRadius),i=(t-e)/2,a=Math.min(i,n*e/2),o=l=>{const c=(t-Math.min(i,l))*n/2;return qs(l,0,Math.min(i,c))};return{outerStart:o(s.outerStart),outerEnd:o(s.outerEnd),innerStart:qs(s.innerStart,0,a),innerEnd:qs(s.innerEnd,0,a)}}function du(r,e,t,n){return{x:t+r*Math.cos(e),y:n+r*Math.sin(e)}}function Dm(r,e,t,n,s,i){const{x:a,y:o,startAngle:l,pixelMargin:c,innerRadius:A}=e,d=Math.max(e.outerRadius+n+t-c,0),h=A>0?A+n+t+c:0;let u=0;const p=s-l;if(n){const K=A>0?A-n:0,se=d>0?d-n:0,X=(K+se)/2,$=X!==0?p*X/(X+n):p;u=(p-$)/2}const f=Math.max(.001,p*d-t/Gr)/d,g=(p-f)/2,m=l+g+u,x=s-g-u,{outerStart:S,outerEnd:B,innerStart:F,innerEnd:N}=WR(e,h,d,x-m),E=d-S,w=d-B,v=m+S/E,I=x-B/w,k=h+F,_=h+N,T=m+F/k,L=x-N/_;if(r.beginPath(),i){const K=(v+I)/2;if(r.arc(a,o,d,v,K),r.arc(a,o,d,K,I),B>0){const V=du(w,I,a,o);r.arc(V.x,V.y,B,I,x+ds)}const se=du(_,x,a,o);if(r.lineTo(se.x,se.y),N>0){const V=du(_,L,a,o);r.arc(V.x,V.y,N,x+ds,L+Math.PI)}const X=(x-N/h+(m+F/h))/2;if(r.arc(a,o,h,x-N/h,X,!0),r.arc(a,o,h,X,m+F/h,!0),F>0){const V=du(k,T,a,o);r.arc(V.x,V.y,F,T+Math.PI,m-ds)}const $=du(E,m,a,o);if(r.lineTo($.x,$.y),S>0){const V=du(E,v,a,o);r.arc(V.x,V.y,S,m-ds,v)}}else{r.moveTo(a,o);const K=Math.cos(v)*d+a,se=Math.sin(v)*d+o;r.lineTo(K,se);const X=Math.cos(I)*d+a,$=Math.sin(I)*d+o;r.lineTo(X,$)}r.closePath()}function YR(r,e,t,n,s){const{fullCircles:i,startAngle:a,circumference:o}=e;let l=e.endAngle;if(i){Dm(r,e,t,n,l,s);for(let c=0;c<i;++c)r.fill();isNaN(o)||(l=a+(o%In||In))}return Dm(r,e,t,n,l,s),r.fill(),l}function XR(r,e,t,n,s){const{fullCircles:i,startAngle:a,circumference:o,options:l}=e,{borderWidth:c,borderJoinStyle:A,borderDash:d,borderDashOffset:h,borderRadius:u}=l,p=l.borderAlign==="inner";if(!c)return;r.setLineDash(d||[]),r.lineDashOffset=h,p?(r.lineWidth=c*2,r.lineJoin=A||"round"):(r.lineWidth=c,r.lineJoin=A||"bevel");let f=e.endAngle;if(i){Dm(r,e,t,n,f,s);for(let g=0;g<i;++g)r.stroke();isNaN(o)||(f=a+(o%In||In))}p&&KR(r,e,f),l.selfJoin&&f-a>=Gr&&u===0&&A!=="miter"&&zR(r,e,f),i||(Dm(r,e,t,n,f,s),r.stroke())}class Lu extends oc{constructor(t){super();Fe(this,"circumference");Fe(this,"endAngle");Fe(this,"fullCircles");Fe(this,"innerRadius");Fe(this,"outerRadius");Fe(this,"pixelMargin");Fe(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,t&&Object.assign(this,t)}inRange(t,n,s){const i=this.getProps(["x","y"],s),{angle:a,distance:o}=yI(i,{x:t,y:n}),{startAngle:l,endAngle:c,innerRadius:A,outerRadius:d,circumference:h}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],s),u=(this.options.spacing+this.options.borderWidth)/2,p=qt(h,c-l),f=dg(a,l,c)&&l!==c,g=p>=In||f,m=Ql(o,A+u,d+u);return g&&m}getCenterPoint(t){const{x:n,y:s,startAngle:i,endAngle:a,innerRadius:o,outerRadius:l}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],t),{offset:c,spacing:A}=this.options,d=(i+a)/2,h=(o+l+A+c)/2;return{x:n+Math.cos(d)*h,y:s+Math.sin(d)*h}}tooltipPosition(t){return this.getCenterPoint(t)}draw(t){const{options:n,circumference:s}=this,i=(n.offset||0)/4,a=(n.spacing||0)/2,o=n.circular;if(this.pixelMargin=n.borderAlign==="inner"?.33:0,this.fullCircles=s>In?Math.floor(s/In):0,s===0||this.innerRadius<0||this.outerRadius<0)return;t.save();const l=(this.startAngle+this.endAngle)/2;t.translate(Math.cos(l)*i,Math.sin(l)*i);const c=1-Math.sin(Math.min(Gr,s||0)),A=i*c;t.fillStyle=n.backgroundColor,t.strokeStyle=n.borderColor,YR(t,this,A,a,o),XR(t,this,A,a,o),t.restore()}}Fe(Lu,"id","arc"),Fe(Lu,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1}),Fe(Lu,"defaultRoutes",{backgroundColor:"backgroundColor"}),Fe(Lu,"descriptors",{_scriptable:!0,_indexable:t=>t!=="borderDash"});function eT(r,e,t=e){r.lineCap=qt(t.borderCapStyle,e.borderCapStyle),r.setLineDash(qt(t.borderDash,e.borderDash)),r.lineDashOffset=qt(t.borderDashOffset,e.borderDashOffset),r.lineJoin=qt(t.borderJoinStyle,e.borderJoinStyle),r.lineWidth=qt(t.borderWidth,e.borderWidth),r.strokeStyle=qt(t.borderColor,e.borderColor)}function JR(r,e,t){r.lineTo(t.x,t.y)}function ZR(r){return r.stepped?xD:r.tension||r.cubicInterpolationMode==="monotone"?_D:JR}function tT(r,e,t={}){const n=r.length,{start:s=0,end:i=n-1}=t,{start:a,end:o}=e,l=Math.max(s,a),c=Math.min(i,o),A=s<a&&i<a||s>o&&i>o;return{count:n,start:l,loop:e.loop,ilen:c<l&&!A?n+c-l:c-l}}function eO(r,e,t,n){const{points:s,options:i}=e,{count:a,start:o,loop:l,ilen:c}=tT(s,t,n),A=ZR(i);let{move:d=!0,reverse:h}=n||{},u,p,f;for(u=0;u<=c;++u)p=s[(o+(h?c-u:u))%a],!p.skip&&(d?(r.moveTo(p.x,p.y),d=!1):A(r,f,p,h,i.stepped),f=p);return l&&(p=s[(o+(h?c:0))%a],A(r,f,p,h,i.stepped)),!!l}function tO(r,e,t,n){const s=e.points,{count:i,start:a,ilen:o}=tT(s,t,n),{move:l=!0,reverse:c}=n||{};let A=0,d=0,h,u,p,f,g,m;const x=B=>(a+(c?o-B:B))%i,S=()=>{f!==g&&(r.lineTo(A,g),r.lineTo(A,f),r.lineTo(A,m))};for(l&&(u=s[x(0)],r.moveTo(u.x,u.y)),h=0;h<=o;++h){if(u=s[x(h)],u.skip)continue;const B=u.x,F=u.y,N=B|0;N===p?(F<f?f=F:F>g&&(g=F),A=(d*A+B)/++d):(S(),r.lineTo(B,F),p=N,d=0,f=g=F),m=F}S()}function Iv(r){const e=r.options,t=e.borderDash&&e.borderDash.length;return!r._decimated&&!r._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!t?tO:eO}function rO(r){return r.stepped?t6:r.tension||r.cubicInterpolationMode==="monotone"?r6:td}function nO(r,e,t,n){let s=e._path;s||(s=e._path=new Path2D,e.path(s,t,n)&&s.closePath()),eT(r,e.options),r.stroke(s)}function sO(r,e,t,n){const{segments:s,options:i}=e,a=Iv(e);for(const o of s)eT(r,i,o.style),r.beginPath(),a(r,e,o,{start:t,end:t+n-1})&&r.closePath(),r.stroke()}const iO=typeof Path2D=="function";function aO(r,e,t,n){iO&&!e.options.segment?nO(r,e,t,n):sO(r,e,t,n)}class Wc extends oc{constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,t){const n=this.options;if((n.tension||n.cubicInterpolationMode==="monotone")&&!n.stepped&&!this._pointsUpdated){const s=n.spanGaps?this._loop:this._fullLoop;KD(this._points,n,e,s,t),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=l6(this,this.options.segment))}first(){const e=this.segments,t=this.points;return e.length&&t[e[0].start]}last(){const e=this.segments,t=this.points,n=e.length;return n&&t[e[n-1].end]}interpolate(e,t){const n=this.options,s=e[t],i=this.points,a=OI(this,{property:t,start:s,end:s});if(!a.length)return;const o=[],l=rO(n);let c,A;for(c=0,A=a.length;c<A;++c){const{start:d,end:h}=a[c],u=i[d],p=i[h];if(u===p){o.push(u);continue}const f=Math.abs((s-u[t])/(p[t]-u[t])),g=l(u,p,f,n.stepped);g[t]=e[t],o.push(g)}return o.length===1?o[0]:o}pathSegment(e,t,n){return Iv(this)(e,this,t,n)}path(e,t,n){const s=this.segments,i=Iv(this);let a=this._loop;t=t||0,n=n||this.points.length-t;for(const o of s)a&=i(e,this,o,{start:t,end:t+n-1});return!!a}draw(e,t,n,s){const i=this.options||{};(this.points||[]).length&&i.borderWidth&&(e.save(),aO(e,this,n,s),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}Fe(Wc,"id","line"),Fe(Wc,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),Fe(Wc,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),Fe(Wc,"descriptors",{_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"});function WB(r,e,t,n){const s=r.options,{[t]:i}=r.getProps([t],n);return Math.abs(e-i)<s.radius+s.hitRadius}class Rf extends oc{constructor(t){super();Fe(this,"parsed");Fe(this,"skip");Fe(this,"stop");this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,t&&Object.assign(this,t)}inRange(t,n,s){const i=this.options,{x:a,y:o}=this.getProps(["x","y"],s);return Math.pow(t-a,2)+Math.pow(n-o,2)<Math.pow(i.hitRadius+i.radius,2)}inXRange(t,n){return WB(this,t,"x",n)}inYRange(t,n){return WB(this,t,"y",n)}getCenterPoint(t){const{x:n,y:s}=this.getProps(["x","y"],t);return{x:n,y:s}}size(t){t=t||this.options||{};let n=t.radius||0;n=Math.max(n,n&&t.hoverRadius||0);const s=n&&t.borderWidth||0;return(n+s)*2}draw(t,n){const s=this.options;this.skip||s.radius<.1||!Yo(this,n,this.size(s)/2)||(t.strokeStyle=s.borderColor,t.lineWidth=s.borderWidth,t.fillStyle=s.backgroundColor,Cv(t,s,this.x,this.y))}getRange(){const t=this.options||{};return t.radius+t.hitRadius}}Fe(Rf,"id","point"),Fe(Rf,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),Fe(Rf,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function rT(r,e){const{x:t,y:n,base:s,width:i,height:a}=r.getProps(["x","y","base","width","height"],e);let o,l,c,A,d;return r.horizontal?(d=a/2,o=Math.min(t,s),l=Math.max(t,s),c=n-d,A=n+d):(d=i/2,o=t-d,l=t+d,c=Math.min(n,s),A=Math.max(n,s)),{left:o,top:c,right:l,bottom:A}}function Yc(r,e,t,n){return r?0:qs(e,t,n)}function oO(r,e,t){const n=r.options.borderWidth,s=r.borderSkipped,i=EI(n);return{t:Yc(s.top,i.top,0,t),r:Yc(s.right,i.right,0,e),b:Yc(s.bottom,i.bottom,0,t),l:Yc(s.left,i.left,0,e)}}function lO(r,e,t){const{enableBorderRadius:n}=r.getProps(["enableBorderRadius"]),s=r.options.borderRadius,i=vd(s),a=Math.min(e,t),o=r.borderSkipped,l=n||Br(s);return{topLeft:Yc(!l||o.top||o.left,i.topLeft,0,a),topRight:Yc(!l||o.top||o.right,i.topRight,0,a),bottomLeft:Yc(!l||o.bottom||o.left,i.bottomLeft,0,a),bottomRight:Yc(!l||o.bottom||o.right,i.bottomRight,0,a)}}function cO(r){const e=rT(r),t=e.right-e.left,n=e.bottom-e.top,s=oO(r,t/2,n/2),i=lO(r,t/2,n/2);return{outer:{x:e.left,y:e.top,w:t,h:n,radius:i},inner:{x:e.left+s.l,y:e.top+s.t,w:t-s.l-s.r,h:n-s.t-s.b,radius:{topLeft:Math.max(0,i.topLeft-Math.max(s.t,s.l)),topRight:Math.max(0,i.topRight-Math.max(s.t,s.r)),bottomLeft:Math.max(0,i.bottomLeft-Math.max(s.b,s.l)),bottomRight:Math.max(0,i.bottomRight-Math.max(s.b,s.r))}}}}function Xy(r,e,t,n){const s=e===null,i=t===null,o=r&&!(s&&i)&&rT(r,n);return o&&(s||Ql(e,o.left,o.right))&&(i||Ql(t,o.top,o.bottom))}function AO(r){return r.topLeft||r.topRight||r.bottomLeft||r.bottomRight}function dO(r,e){r.rect(e.x,e.y,e.w,e.h)}function Jy(r,e,t={}){const n=r.x!==t.x?-e:0,s=r.y!==t.y?-e:0,i=(r.x+r.w!==t.x+t.w?e:0)-n,a=(r.y+r.h!==t.y+t.h?e:0)-s;return{x:r.x+n,y:r.y+s,w:r.w+i,h:r.h+a,radius:r.radius}}class Of extends oc{constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:t,options:{borderColor:n,backgroundColor:s}}=this,{inner:i,outer:a}=cO(this),o=AO(a.radius)?ug:dO;e.save(),(a.w!==i.w||a.h!==i.h)&&(e.beginPath(),o(e,Jy(a,t,i)),e.clip(),o(e,Jy(i,-t,a)),e.fillStyle=n,e.fill("evenodd")),e.beginPath(),o(e,Jy(i,t)),e.fillStyle=s,e.fill(),e.restore()}inRange(e,t,n){return Xy(this,e,t,n)}inXRange(e,t){return Xy(this,e,null,t)}inYRange(e,t){return Xy(this,null,e,t)}getCenterPoint(e){const{x:t,y:n,base:s,horizontal:i}=this.getProps(["x","y","base","horizontal"],e);return{x:i?(t+s)/2:t,y:i?n:(n+s)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}Fe(Of,"id","bar"),Fe(Of,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),Fe(Of,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});var uO=Object.freeze({__proto__:null,ArcElement:Lu,BarElement:Of,LineElement:Wc,PointElement:Rf});const Tv=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],YB=Tv.map(r=>r.replace("rgb(","rgba(").replace(")",", 0.5)"));function nT(r){return Tv[r%Tv.length]}function sT(r){return YB[r%YB.length]}function hO(r,e){return r.borderColor=nT(e),r.backgroundColor=sT(e),++e}function fO(r,e){return r.backgroundColor=r.data.map(()=>nT(e++)),e}function gO(r,e){return r.backgroundColor=r.data.map(()=>sT(e++)),e}function pO(r){let e=0;return(t,n)=>{const s=r.getDatasetMeta(n).controller;s instanceof dd?e=fO(t,e):s instanceof Df?e=gO(t,e):s&&(e=hO(t,e))}}function XB(r){let e;for(e in r)if(r[e].borderColor||r[e].backgroundColor)return!0;return!1}function mO(r){return r&&(r.borderColor||r.backgroundColor)}function bO(){return Tn.borderColor!=="rgba(0,0,0,0.1)"||Tn.backgroundColor!=="rgba(0,0,0,0.1)"}var yO={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(r,e,t){if(!t.enabled)return;const{data:{datasets:n},options:s}=r.config,{elements:i}=s,a=XB(n)||mO(s)||i&&XB(i)||bO();if(!t.forceOverride&&a)return;const o=pO(r);n.forEach(o)}};function wO(r,e,t,n,s){const i=s.samples||n;if(i>=t)return r.slice(e,e+t);const a=[],o=(t-2)/(i-2);let l=0;const c=e+t-1;let A=e,d,h,u,p,f;for(a[l++]=r[A],d=0;d<i-2;d++){let g=0,m=0,x;const S=Math.floor((d+1)*o)+1+e,B=Math.min(Math.floor((d+2)*o)+1,t)+e,F=B-S;for(x=S;x<B;x++)g+=r[x].x,m+=r[x].y;g/=F,m/=F;const N=Math.floor(d*o)+1+e,E=Math.min(Math.floor((d+1)*o)+1,t)+e,{x:w,y:v}=r[A];for(u=p=-1,x=N;x<E;x++)p=.5*Math.abs((w-g)*(r[x].y-v)-(w-r[x].x)*(m-v)),p>u&&(u=p,h=r[x],f=x);a[l++]=h,A=f}return a[l++]=r[c],a}function vO(r,e,t,n){let s=0,i=0,a,o,l,c,A,d,h,u,p,f;const g=[],m=e+t-1,x=r[e].x,B=r[m].x-x;for(a=e;a<e+t;++a){o=r[a],l=(o.x-x)/B*n,c=o.y;const F=l|0;if(F===A)c<p?(p=c,d=a):c>f&&(f=c,h=a),s=(i*s+o.x)/++i;else{const N=a-1;if(!pr(d)&&!pr(h)){const E=Math.min(d,h),w=Math.max(d,h);E!==u&&E!==N&&g.push({...r[E],x:s}),w!==u&&w!==N&&g.push({...r[w],x:s})}a>0&&N!==u&&g.push(r[N]),g.push(o),A=F,i=0,p=f=c,d=h=u=a}}return g}function iT(r){if(r._decimated){const e=r._data;delete r._decimated,delete r._data,Object.defineProperty(r,"data",{configurable:!0,enumerable:!0,writable:!0,value:e})}}function JB(r){r.data.datasets.forEach(e=>{iT(e)})}function xO(r,e){const t=e.length;let n=0,s;const{iScale:i}=r,{min:a,max:o,minDefined:l,maxDefined:c}=i.getUserBounds();return l&&(n=qs(Hl(e,i.axis,a).lo,0,t-1)),c?s=qs(Hl(e,i.axis,o).hi+1,n,t)-n:s=t-n,{start:n,count:s}}var _O={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(r,e,t)=>{if(!t.enabled){JB(r);return}const n=r.width;r.data.datasets.forEach((s,i)=>{const{_data:a,indexAxis:o}=s,l=r.getDatasetMeta(i),c=a||s.data;if(Cn([o,r.options.indexAxis])==="y"||!l.controller.supportsDecimation)return;const A=r.scales[l.xAxisID];if(A.type!=="linear"&&A.type!=="time"||r.options.parsing)return;let{start:d,count:h}=xO(l,c);const u=t.threshold||4*n;if(h<=u){iT(s);return}pr(a)&&(s._data=c,delete s.data,Object.defineProperty(s,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(f){this._data=f}}));let p;switch(t.algorithm){case"lttb":p=wO(c,d,h,n,t);break;case"min-max":p=vO(c,d,h,n);break;default:throw new Error(`Unsupported decimation algorithm '${t.algorithm}'`)}s._decimated=p})},destroy(r){JB(r)}};function BO(r,e,t){const n=r.segments,s=r.points,i=e.points,a=[];for(const o of n){let{start:l,end:c}=o;c=Ub(l,c,s);const A=Fv(t,s[l],s[c],o.loop);if(!e.segments){a.push({source:o,target:A,start:s[l],end:s[c]});continue}const d=OI(e,A);for(const h of d){const u=Fv(t,i[h.start],i[h.end],h.loop),p=RI(o,s,u);for(const f of p)a.push({source:f,target:h,start:{[t]:ZB(A,u,"start",Math.max)},end:{[t]:ZB(A,u,"end",Math.min)}})}}return a}function Fv(r,e,t,n){if(n)return;let s=e[r],i=t[r];return r==="angle"&&(s=Si(s),i=Si(i)),{property:r,start:s,end:i}}function CO(r,e){const{x:t=null,y:n=null}=r||{},s=e.points,i=[];return e.segments.forEach(({start:a,end:o})=>{o=Ub(a,o,s);const l=s[a],c=s[o];n!==null?(i.push({x:l.x,y:n}),i.push({x:c.x,y:n})):t!==null&&(i.push({x:t,y:l.y}),i.push({x:t,y:c.y}))}),i}function Ub(r,e,t){for(;e>r;e--){const n=t[e];if(!isNaN(n.x)&&!isNaN(n.y))break}return e}function ZB(r,e,t,n){return r&&e?n(r[t],e[t]):r?r[t]:e?e[t]:0}function aT(r,e){let t=[],n=!1;return Sn(r)?(n=!0,t=r):t=CO(r,e),t.length?new Wc({points:t,options:{tension:0},_loop:n,_fullLoop:n}):null}function e5(r){return r&&r.fill!==!1}function SO(r,e,t){let s=r[e].fill;const i=[e];let a;if(!t)return s;for(;s!==!1&&i.indexOf(s)===-1;){if(!Kn(s))return s;if(a=r[s],!a)return!1;if(a.visible)return s;i.push(s),s=a.fill}return!1}function kO(r,e,t){const n=FO(r);if(Br(n))return isNaN(n.value)?!1:n;let s=parseFloat(n);return Kn(s)&&Math.floor(s)===s?EO(n[0],e,s,t):["origin","start","end","stack","shape"].indexOf(n)>=0&&n}function EO(r,e,t,n){return(r==="-"||r==="+")&&(t=e+t),t===e||t<0||t>=n?!1:t}function IO(r,e){let t=null;return r==="start"?t=e.bottom:r==="end"?t=e.top:Br(r)?t=e.getPixelForValue(r.value):e.getBasePixel&&(t=e.getBasePixel()),t}function TO(r,e,t){let n;return r==="start"?n=t:r==="end"?n=e.options.reverse?e.min:e.max:Br(r)?n=r.value:n=e.getBaseValue(),n}function FO(r){const e=r.options,t=e.fill;let n=qt(t&&t.target,t);return n===void 0&&(n=!!e.backgroundColor),n===!1||n===null?!1:n===!0?"origin":n}function LO(r){const{scale:e,index:t,line:n}=r,s=[],i=n.segments,a=n.points,o=UO(e,t);o.push(aT({x:null,y:e.bottom},n));for(let l=0;l<i.length;l++){const c=i[l];for(let A=c.start;A<=c.end;A++)MO(s,a[A],o)}return new Wc({points:s,options:{}})}function UO(r,e){const t=[],n=r.getMatchingVisibleMetas("line");for(let s=0;s<n.length;s++){const i=n[s];if(i.index===e)break;i.hidden||t.unshift(i.dataset)}return t}function MO(r,e,t){const n=[];for(let s=0;s<t.length;s++){const i=t[s],{first:a,last:o,point:l}=NO(i,e,"x");if(!(!l||a&&o)){if(a)n.unshift(l);else if(r.push(l),!o)break}}r.push(...n)}function NO(r,e,t){const n=r.interpolate(e,t);if(!n)return{};const s=n[t],i=r.segments,a=r.points;let o=!1,l=!1;for(let c=0;c<i.length;c++){const A=i[c],d=a[A.start][t],h=a[A.end][t];if(Ql(s,d,h)){o=s===d,l=s===h;break}}return{first:o,last:l,point:n}}class oT{constructor(e){this.x=e.x,this.y=e.y,this.radius=e.radius}pathSegment(e,t,n){const{x:s,y:i,radius:a}=this;return t=t||{start:0,end:In},e.arc(s,i,a,t.end,t.start,!0),!n.bounds}interpolate(e){const{x:t,y:n,radius:s}=this,i=e.angle;return{x:t+Math.cos(i)*s,y:n+Math.sin(i)*s,angle:i}}}function PO(r){const{chart:e,fill:t,line:n}=r;if(Kn(t))return DO(e,t);if(t==="stack")return LO(r);if(t==="shape")return!0;const s=RO(r);return s instanceof oT?s:aT(s,n)}function DO(r,e){const t=r.getDatasetMeta(e);return t&&r.isDatasetVisible(e)?t.dataset:null}function RO(r){return(r.scale||{}).getPointPositionForValue?QO(r):OO(r)}function OO(r){const{scale:e={},fill:t}=r,n=IO(t,e);if(Kn(n)){const s=e.isHorizontal();return{x:s?n:null,y:s?null:n}}return null}function QO(r){const{scale:e,fill:t}=r,n=e.options,s=e.getLabels().length,i=n.reverse?e.max:e.min,a=TO(t,e,i),o=[];if(n.grid.circular){const l=e.getPointPositionForValue(0,i);return new oT({x:l.x,y:l.y,radius:e.getDistanceFromCenterForValue(a)})}for(let l=0;l<s;++l)o.push(e.getPointPositionForValue(l,a));return o}function Zy(r,e,t){const n=PO(e),{chart:s,index:i,line:a,scale:o,axis:l}=e,c=a.options,A=c.fill,d=c.backgroundColor,{above:h=d,below:u=d}=A||{},p=s.getDatasetMeta(i),f=QI(s,p);n&&a.points.length&&(Ib(r,t),HO(r,{line:a,target:n,above:h,below:u,area:t,scale:o,axis:l,clip:f}),Tb(r))}function HO(r,e){const{line:t,target:n,above:s,below:i,area:a,scale:o,clip:l}=e,c=t._loop?"angle":e.axis;r.save();let A=i;i!==s&&(c==="x"?(t5(r,n,a.top),ew(r,{line:t,target:n,color:s,scale:o,property:c,clip:l}),r.restore(),r.save(),t5(r,n,a.bottom)):c==="y"&&(r5(r,n,a.left),ew(r,{line:t,target:n,color:i,scale:o,property:c,clip:l}),r.restore(),r.save(),r5(r,n,a.right),A=s)),ew(r,{line:t,target:n,color:A,scale:o,property:c,clip:l}),r.restore()}function t5(r,e,t){const{segments:n,points:s}=e;let i=!0,a=!1;r.beginPath();for(const o of n){const{start:l,end:c}=o,A=s[l],d=s[Ub(l,c,s)];i?(r.moveTo(A.x,A.y),i=!1):(r.lineTo(A.x,t),r.lineTo(A.x,A.y)),a=!!e.pathSegment(r,o,{move:a}),a?r.closePath():r.lineTo(d.x,t)}r.lineTo(e.first().x,t),r.closePath(),r.clip()}function r5(r,e,t){const{segments:n,points:s}=e;let i=!0,a=!1;r.beginPath();for(const o of n){const{start:l,end:c}=o,A=s[l],d=s[Ub(l,c,s)];i?(r.moveTo(A.x,A.y),i=!1):(r.lineTo(t,A.y),r.lineTo(A.x,A.y)),a=!!e.pathSegment(r,o,{move:a}),a?r.closePath():r.lineTo(t,d.y)}r.lineTo(t,e.first().y),r.closePath(),r.clip()}function ew(r,e){const{line:t,target:n,property:s,color:i,scale:a,clip:o}=e,l=BO(t,n,s);for(const{source:c,target:A,start:d,end:h}of l){const{style:{backgroundColor:u=i}={}}=c,p=n!==!0;r.save(),r.fillStyle=u,jO(r,a,o,p&&Fv(s,d,h)),r.beginPath();const f=!!t.pathSegment(r,c);let g;if(p){f?r.closePath():n5(r,n,h,s);const m=!!n.pathSegment(r,A,{move:f,reverse:!0});g=f&&m,g||n5(r,n,d,s)}r.closePath(),r.fill(g?"evenodd":"nonzero"),r.restore()}}function jO(r,e,t,n){const s=e.chart.chartArea,{property:i,start:a,end:o}=n||{};if(i==="x"||i==="y"){let l,c,A,d;i==="x"?(l=a,c=s.top,A=o,d=s.bottom):(l=s.left,c=a,A=s.right,d=o),r.beginPath(),t&&(l=Math.max(l,t.left),A=Math.min(A,t.right),c=Math.max(c,t.top),d=Math.min(d,t.bottom)),r.rect(l,c,A-l,d-c),r.clip()}}function n5(r,e,t,n){const s=e.interpolate(t,n);s&&r.lineTo(s.x,s.y)}var VO={id:"filler",afterDatasetsUpdate(r,e,t){const n=(r.data.datasets||[]).length,s=[];let i,a,o,l;for(a=0;a<n;++a)i=r.getDatasetMeta(a),o=i.dataset,l=null,o&&o.options&&o instanceof Wc&&(l={visible:r.isDatasetVisible(a),index:a,fill:kO(o,a,n),chart:r,axis:i.controller.options.indexAxis,scale:i.vScale,line:o}),i.$filler=l,s.push(l);for(a=0;a<n;++a)l=s[a],!(!l||l.fill===!1)&&(l.fill=SO(s,a,t.propagate))},beforeDraw(r,e,t){const n=t.drawTime==="beforeDraw",s=r.getSortedVisibleDatasetMetas(),i=r.chartArea;for(let a=s.length-1;a>=0;--a){const o=s[a].$filler;o&&(o.line.updateControlPoints(i,o.axis),n&&o.fill&&Zy(r.ctx,o,i))}},beforeDatasetsDraw(r,e,t){if(t.drawTime!=="beforeDatasetsDraw")return;const n=r.getSortedVisibleDatasetMetas();for(let s=n.length-1;s>=0;--s){const i=n[s].$filler;e5(i)&&Zy(r.ctx,i,r.chartArea)}},beforeDatasetDraw(r,e,t){const n=e.meta.$filler;!e5(n)||t.drawTime!=="beforeDatasetDraw"||Zy(r.ctx,n,r.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const s5=(r,e)=>{let{boxHeight:t=e,boxWidth:n=e}=r;return r.usePointStyle&&(t=Math.min(t,e),n=r.pointStyleWidth||Math.min(n,e)),{boxWidth:n,boxHeight:t,itemHeight:Math.max(e,t)}},$O=(r,e)=>r!==null&&e!==null&&r.datasetIndex===e.datasetIndex&&r.index===e.index;class i5 extends oc{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t,n){this.maxWidth=e,this.maxHeight=t,this._margins=n,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let t=zt(e.generateLabels,[this.chart],this)||[];e.filter&&(t=t.filter(n=>e.filter(n,this.chart.data))),e.sort&&(t=t.sort((n,s)=>e.sort(n,s,this.chart.data))),this.options.reverse&&t.reverse(),this.legendItems=t}fit(){const{options:e,ctx:t}=this;if(!e.display){this.width=this.height=0;return}const n=e.labels,s=vs(n.font),i=s.size,a=this._computeTitleHeight(),{boxWidth:o,itemHeight:l}=s5(n,i);let c,A;t.font=s.string,this.isHorizontal()?(c=this.maxWidth,A=this._fitRows(a,i,o,l)+10):(A=this.maxHeight,c=this._fitCols(a,s,o,l)+10),this.width=Math.min(c,e.maxWidth||this.maxWidth),this.height=Math.min(A,e.maxHeight||this.maxHeight)}_fitRows(e,t,n,s){const{ctx:i,maxWidth:a,options:{labels:{padding:o}}}=this,l=this.legendHitBoxes=[],c=this.lineWidths=[0],A=s+o;let d=e;i.textAlign="left",i.textBaseline="middle";let h=-1,u=-A;return this.legendItems.forEach((p,f)=>{const g=n+t/2+i.measureText(p.text).width;(f===0||c[c.length-1]+g+2*o>a)&&(d+=A,c[c.length-(f>0?0:1)]=0,u+=A,h++),l[f]={left:0,top:u,row:h,width:g,height:s},c[c.length-1]+=g+o}),d}_fitCols(e,t,n,s){const{ctx:i,maxHeight:a,options:{labels:{padding:o}}}=this,l=this.legendHitBoxes=[],c=this.columnSizes=[],A=a-e;let d=o,h=0,u=0,p=0,f=0;return this.legendItems.forEach((g,m)=>{const{itemWidth:x,itemHeight:S}=GO(n,t,i,g,s);m>0&&u+S+2*o>A&&(d+=h+o,c.push({width:h,height:u}),p+=h+o,f++,h=u=0),l[m]={left:p,top:u,col:f,width:x,height:S},h=Math.max(h,x),u+=S+o}),d+=h,c.push({width:h,height:u}),d}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:t,options:{align:n,labels:{padding:s},rtl:i}}=this,a=Qu(i,this.left,this.width);if(this.isHorizontal()){let o=0,l=_i(n,this.left+s,this.right-this.lineWidths[o]);for(const c of t)o!==c.row&&(o=c.row,l=_i(n,this.left+s,this.right-this.lineWidths[o])),c.top+=this.top+e+s,c.left=a.leftForLtr(a.x(l),c.width),l+=c.width+s}else{let o=0,l=_i(n,this.top+e+s,this.bottom-this.columnSizes[o].height);for(const c of t)c.col!==o&&(o=c.col,l=_i(n,this.top+e+s,this.bottom-this.columnSizes[o].height)),c.top=l,c.left+=this.left+s,c.left=a.leftForLtr(a.x(c.left),c.width),l+=c.height+s}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;Ib(e,this),this._draw(),Tb(e)}}_draw(){const{options:e,columnSizes:t,lineWidths:n,ctx:s}=this,{align:i,labels:a}=e,o=Tn.color,l=Qu(e.rtl,this.left,this.width),c=vs(a.font),{padding:A}=a,d=c.size,h=d/2;let u;this.drawTitle(),s.textAlign=l.textAlign("left"),s.textBaseline="middle",s.lineWidth=.5,s.font=c.string;const{boxWidth:p,boxHeight:f,itemHeight:g}=s5(a,d),m=function(N,E,w){if(isNaN(p)||p<=0||isNaN(f)||f<0)return;s.save();const v=qt(w.lineWidth,1);if(s.fillStyle=qt(w.fillStyle,o),s.lineCap=qt(w.lineCap,"butt"),s.lineDashOffset=qt(w.lineDashOffset,0),s.lineJoin=qt(w.lineJoin,"miter"),s.lineWidth=v,s.strokeStyle=qt(w.strokeStyle,o),s.setLineDash(qt(w.lineDash,[])),a.usePointStyle){const I={radius:f*Math.SQRT2/2,pointStyle:w.pointStyle,rotation:w.rotation,borderWidth:v},k=l.xPlus(N,p/2),_=E+h;kI(s,I,k,_,a.pointStyleWidth&&p)}else{const I=E+Math.max((d-f)/2,0),k=l.leftForLtr(N,p),_=vd(w.borderRadius);s.beginPath(),Object.values(_).some(T=>T!==0)?ug(s,{x:k,y:I,w:p,h:f,radius:_}):s.rect(k,I,p,f),s.fill(),v!==0&&s.stroke()}s.restore()},x=function(N,E,w){Ld(s,w.text,N,E+g/2,c,{strikethrough:w.hidden,textAlign:l.textAlign(w.textAlign)})},S=this.isHorizontal(),B=this._computeTitleHeight();S?u={x:_i(i,this.left+A,this.right-n[0]),y:this.top+A+B,line:0}:u={x:this.left+A,y:_i(i,this.top+B+A,this.bottom-t[0].height),line:0},NI(this.ctx,e.textDirection);const F=g+A;this.legendItems.forEach((N,E)=>{s.strokeStyle=N.fontColor,s.fillStyle=N.fontColor;const w=s.measureText(N.text).width,v=l.textAlign(N.textAlign||(N.textAlign=a.textAlign)),I=p+h+w;let k=u.x,_=u.y;l.setWidth(this.width),S?E>0&&k+I+A>this.right&&(_=u.y+=F,u.line++,k=u.x=_i(i,this.left+A,this.right-n[u.line])):E>0&&_+F>this.bottom&&(k=u.x=k+t[u.line].width+A,u.line++,_=u.y=_i(i,this.top+B+A,this.bottom-t[u.line].height));const T=l.x(k);if(m(T,_,N),k=dD(v,k+p+h,S?k+I:this.right,e.rtl),x(l.x(k),_,N),S)u.x+=I+A;else if(typeof N.text!="string"){const L=c.lineHeight;u.y+=lT(N,L)+A}else u.y+=F}),PI(this.ctx,e.textDirection)}drawTitle(){const e=this.options,t=e.title,n=vs(t.font),s=ui(t.padding);if(!t.display)return;const i=Qu(e.rtl,this.left,this.width),a=this.ctx,o=t.position,l=n.size/2,c=s.top+l;let A,d=this.left,h=this.width;if(this.isHorizontal())h=Math.max(...this.lineWidths),A=this.top+c,d=_i(e.align,d,this.right-h);else{const p=this.columnSizes.reduce((f,g)=>Math.max(f,g.height),0);A=c+_i(e.align,this.top,this.bottom-p-e.labels.padding-this._computeTitleHeight())}const u=_i(o,d,d+h);a.textAlign=i.textAlign(Cx(o)),a.textBaseline="middle",a.strokeStyle=t.color,a.fillStyle=t.color,a.font=n.string,Ld(a,t.text,u,A,n)}_computeTitleHeight(){const e=this.options.title,t=vs(e.font),n=ui(e.padding);return e.display?t.lineHeight+n.height:0}_getLegendItemAt(e,t){let n,s,i;if(Ql(e,this.left,this.right)&&Ql(t,this.top,this.bottom)){for(i=this.legendHitBoxes,n=0;n<i.length;++n)if(s=i[n],Ql(e,s.left,s.left+s.width)&&Ql(t,s.top,s.top+s.height))return this.legendItems[n]}return null}handleEvent(e){const t=this.options;if(!qO(e.type,t))return;const n=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const s=this._hoveredItem,i=$O(s,n);s&&!i&&zt(t.onLeave,[e,s,this],this),this._hoveredItem=n,n&&!i&&zt(t.onHover,[e,n,this],this)}else n&&zt(t.onClick,[e,n,this],this)}}function GO(r,e,t,n,s){const i=zO(n,r,e,t),a=KO(s,n,e.lineHeight);return{itemWidth:i,itemHeight:a}}function zO(r,e,t,n){let s=r.text;return s&&typeof s!="string"&&(s=s.reduce((i,a)=>i.length>a.length?i:a)),e+t.size/2+n.measureText(s).width}function KO(r,e,t){let n=r;return typeof e.text!="string"&&(n=lT(e,t)),n}function lT(r,e){const t=r.text?r.text.length:0;return e*t}function qO(r,e){return!!((r==="mousemove"||r==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(r==="click"||r==="mouseup"))}var WO={id:"legend",_element:i5,start(r,e,t){const n=r.legend=new i5({ctx:r.ctx,options:t,chart:r});Ti.configure(r,n,t),Ti.addBox(r,n)},stop(r){Ti.removeBox(r,r.legend),delete r.legend},beforeUpdate(r,e,t){const n=r.legend;Ti.configure(r,n,t),n.options=t},afterUpdate(r){const e=r.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(r,e){e.replay||r.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(r,e,t){const n=e.datasetIndex,s=t.chart;s.isDatasetVisible(n)?(s.hide(n),e.hidden=!0):(s.show(n),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:r=>r.chart.options.color,boxWidth:40,padding:10,generateLabels(r){const e=r.data.datasets,{labels:{usePointStyle:t,pointStyle:n,textAlign:s,color:i,useBorderRadius:a,borderRadius:o}}=r.legend.options;return r._getSortedDatasetMetas().map(l=>{const c=l.controller.getStyle(t?0:void 0),A=ui(c.borderWidth);return{text:e[l.index].label,fillStyle:c.backgroundColor,fontColor:i,hidden:!l.visible,lineCap:c.borderCapStyle,lineDash:c.borderDash,lineDashOffset:c.borderDashOffset,lineJoin:c.borderJoinStyle,lineWidth:(A.width+A.height)/4,strokeStyle:c.borderColor,pointStyle:n||c.pointStyle,rotation:c.rotation,textAlign:s||c.textAlign,borderRadius:a&&(o||c.borderRadius),datasetIndex:l.index}},this)}},title:{color:r=>r.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:r=>!r.startsWith("on"),labels:{_scriptable:r=>!["generateLabels","filter","sort"].includes(r)}}};class Mx extends oc{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t){const n=this.options;if(this.left=0,this.top=0,!n.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=t;const s=Sn(n.text)?n.text.length:1;this._padding=ui(n.padding);const i=s*vs(n.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=i:this.width=i}isHorizontal(){const e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){const{top:t,left:n,bottom:s,right:i,options:a}=this,o=a.align;let l=0,c,A,d;return this.isHorizontal()?(A=_i(o,n,i),d=t+e,c=i-n):(a.position==="left"?(A=n+e,d=_i(o,s,t),l=Gr*-.5):(A=i-e,d=_i(o,t,s),l=Gr*.5),c=s-t),{titleX:A,titleY:d,maxWidth:c,rotation:l}}draw(){const e=this.ctx,t=this.options;if(!t.display)return;const n=vs(t.font),i=n.lineHeight/2+this._padding.top,{titleX:a,titleY:o,maxWidth:l,rotation:c}=this._drawArgs(i);Ld(e,t.text,0,0,n,{color:t.color,maxWidth:l,rotation:c,textAlign:Cx(t.align),textBaseline:"middle",translation:[a,o]})}}function YO(r,e){const t=new Mx({ctx:r.ctx,options:e,chart:r});Ti.configure(r,t,e),Ti.addBox(r,t),r.titleBlock=t}var XO={id:"title",_element:Mx,start(r,e,t){YO(r,t)},stop(r){const e=r.titleBlock;Ti.removeBox(r,e),delete r.titleBlock},beforeUpdate(r,e,t){const n=r.titleBlock;Ti.configure(r,n,t),n.options=t},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const $p=new WeakMap;var JO={id:"subtitle",start(r,e,t){const n=new Mx({ctx:r.ctx,options:t,chart:r});Ti.configure(r,n,t),Ti.addBox(r,n),$p.set(r,n)},stop(r){Ti.removeBox(r,$p.get(r)),$p.delete(r)},beforeUpdate(r,e,t){const n=$p.get(r);Ti.configure(r,n,t),n.options=t},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const gf={average(r){if(!r.length)return!1;let e,t,n=new Set,s=0,i=0;for(e=0,t=r.length;e<t;++e){const o=r[e].element;if(o&&o.hasValue()){const l=o.tooltipPosition();n.add(l.x),s+=l.y,++i}}return i===0||n.size===0?!1:{x:[...n].reduce((o,l)=>o+l)/n.size,y:s/i}},nearest(r,e){if(!r.length)return!1;let t=e.x,n=e.y,s=Number.POSITIVE_INFINITY,i,a,o;for(i=0,a=r.length;i<a;++i){const l=r[i].element;if(l&&l.hasValue()){const c=l.getCenterPoint(),A=_v(e,c);A<s&&(s=A,o=l)}}if(o){const l=o.tooltipPosition();t=l.x,n=l.y}return{x:t,y:n}}};function Qo(r,e){return e&&(Sn(e)?Array.prototype.push.apply(r,e):r.push(e)),r}function Nl(r){return(typeof r=="string"||r instanceof String)&&r.indexOf(`
`)>-1?r.split(`
`):r}function ZO(r,e){const{element:t,datasetIndex:n,index:s}=e,i=r.getDatasetMeta(n).controller,{label:a,value:o}=i.getLabelAndValue(s);return{chart:r,label:a,parsed:i.getParsed(s),raw:r.data.datasets[n].data[s],formattedValue:o,dataset:i.getDataset(),dataIndex:s,datasetIndex:n,element:t}}function a5(r,e){const t=r.chart.ctx,{body:n,footer:s,title:i}=r,{boxWidth:a,boxHeight:o}=e,l=vs(e.bodyFont),c=vs(e.titleFont),A=vs(e.footerFont),d=i.length,h=s.length,u=n.length,p=ui(e.padding);let f=p.height,g=0,m=n.reduce((B,F)=>B+F.before.length+F.lines.length+F.after.length,0);if(m+=r.beforeBody.length+r.afterBody.length,d&&(f+=d*c.lineHeight+(d-1)*e.titleSpacing+e.titleMarginBottom),m){const B=e.displayColors?Math.max(o,l.lineHeight):l.lineHeight;f+=u*B+(m-u)*l.lineHeight+(m-1)*e.bodySpacing}h&&(f+=e.footerMarginTop+h*A.lineHeight+(h-1)*e.footerSpacing);let x=0;const S=function(B){g=Math.max(g,t.measureText(B).width+x)};return t.save(),t.font=c.string,xr(r.title,S),t.font=l.string,xr(r.beforeBody.concat(r.afterBody),S),x=e.displayColors?a+2+e.boxPadding:0,xr(n,B=>{xr(B.before,S),xr(B.lines,S),xr(B.after,S)}),x=0,t.font=A.string,xr(r.footer,S),t.restore(),g+=p.width,{width:g,height:f}}function eQ(r,e){const{y:t,height:n}=e;return t<n/2?"top":t>r.height-n/2?"bottom":"center"}function tQ(r,e,t,n){const{x:s,width:i}=n,a=t.caretSize+t.caretPadding;if(r==="left"&&s+i+a>e.width||r==="right"&&s-i-a<0)return!0}function rQ(r,e,t,n){const{x:s,width:i}=t,{width:a,chartArea:{left:o,right:l}}=r;let c="center";return n==="center"?c=s<=(o+l)/2?"left":"right":s<=i/2?c="left":s>=a-i/2&&(c="right"),tQ(c,r,e,t)&&(c="center"),c}function o5(r,e,t){const n=t.yAlign||e.yAlign||eQ(r,t);return{xAlign:t.xAlign||e.xAlign||rQ(r,e,t,n),yAlign:n}}function nQ(r,e){let{x:t,width:n}=r;return e==="right"?t-=n:e==="center"&&(t-=n/2),t}function sQ(r,e,t){let{y:n,height:s}=r;return e==="top"?n+=t:e==="bottom"?n-=s+t:n-=s/2,n}function l5(r,e,t,n){const{caretSize:s,caretPadding:i,cornerRadius:a}=r,{xAlign:o,yAlign:l}=t,c=s+i,{topLeft:A,topRight:d,bottomLeft:h,bottomRight:u}=vd(a);let p=nQ(e,o);const f=sQ(e,l,c);return l==="center"?o==="left"?p+=c:o==="right"&&(p-=c):o==="left"?p-=Math.max(A,h)+s:o==="right"&&(p+=Math.max(d,u)+s),{x:qs(p,0,n.width-e.width),y:qs(f,0,n.height-e.height)}}function Gp(r,e,t){const n=ui(t.padding);return e==="center"?r.x+r.width/2:e==="right"?r.x+r.width-n.right:r.x+n.left}function c5(r){return Qo([],Nl(r))}function iQ(r,e,t){return IA(r,{tooltip:e,tooltipItems:t,type:"tooltip"})}function A5(r,e){const t=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return t?r.override(t):r}const cT={beforeTitle:Il,title(r){if(r.length>0){const e=r[0],t=e.chart.data.labels,n=t?t.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(n>0&&e.dataIndex<n)return t[e.dataIndex]}return""},afterTitle:Il,beforeBody:Il,beforeLabel:Il,label(r){if(this&&this.options&&this.options.mode==="dataset")return r.label+": "+r.formattedValue||r.formattedValue;let e=r.dataset.label||"";e&&(e+=": ");const t=r.formattedValue;return pr(t)||(e+=t),e},labelColor(r){const t=r.chart.getDatasetMeta(r.datasetIndex).controller.getStyle(r.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(r){const t=r.chart.getDatasetMeta(r.datasetIndex).controller.getStyle(r.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:Il,afterBody:Il,beforeFooter:Il,footer:Il,afterFooter:Il};function ta(r,e,t,n){const s=r[e].call(t,n);return typeof s>"u"?cT[e].call(t,n):s}class Lv extends oc{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const t=this.chart,n=this.options.setContext(this.getContext()),s=n.enabled&&t.options.animation&&n.animations,i=new HI(this.chart,s);return s._cacheable&&(this._cachedAnimations=Object.freeze(i)),i}getContext(){return this.$context||(this.$context=iQ(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,t){const{callbacks:n}=t,s=ta(n,"beforeTitle",this,e),i=ta(n,"title",this,e),a=ta(n,"afterTitle",this,e);let o=[];return o=Qo(o,Nl(s)),o=Qo(o,Nl(i)),o=Qo(o,Nl(a)),o}getBeforeBody(e,t){return c5(ta(t.callbacks,"beforeBody",this,e))}getBody(e,t){const{callbacks:n}=t,s=[];return xr(e,i=>{const a={before:[],lines:[],after:[]},o=A5(n,i);Qo(a.before,Nl(ta(o,"beforeLabel",this,i))),Qo(a.lines,ta(o,"label",this,i)),Qo(a.after,Nl(ta(o,"afterLabel",this,i))),s.push(a)}),s}getAfterBody(e,t){return c5(ta(t.callbacks,"afterBody",this,e))}getFooter(e,t){const{callbacks:n}=t,s=ta(n,"beforeFooter",this,e),i=ta(n,"footer",this,e),a=ta(n,"afterFooter",this,e);let o=[];return o=Qo(o,Nl(s)),o=Qo(o,Nl(i)),o=Qo(o,Nl(a)),o}_createItems(e){const t=this._active,n=this.chart.data,s=[],i=[],a=[];let o=[],l,c;for(l=0,c=t.length;l<c;++l)o.push(ZO(this.chart,t[l]));return e.filter&&(o=o.filter((A,d,h)=>e.filter(A,d,h,n))),e.itemSort&&(o=o.sort((A,d)=>e.itemSort(A,d,n))),xr(o,A=>{const d=A5(e.callbacks,A);s.push(ta(d,"labelColor",this,A)),i.push(ta(d,"labelPointStyle",this,A)),a.push(ta(d,"labelTextColor",this,A))}),this.labelColors=s,this.labelPointStyles=i,this.labelTextColors=a,this.dataPoints=o,o}update(e,t){const n=this.options.setContext(this.getContext()),s=this._active;let i,a=[];if(!s.length)this.opacity!==0&&(i={opacity:0});else{const o=gf[n.position].call(this,s,this._eventPosition);a=this._createItems(n),this.title=this.getTitle(a,n),this.beforeBody=this.getBeforeBody(a,n),this.body=this.getBody(a,n),this.afterBody=this.getAfterBody(a,n),this.footer=this.getFooter(a,n);const l=this._size=a5(this,n),c=Object.assign({},o,l),A=o5(this.chart,n,c),d=l5(n,c,A,this.chart);this.xAlign=A.xAlign,this.yAlign=A.yAlign,i={opacity:1,x:d.x,y:d.y,width:l.width,height:l.height,caretX:o.x,caretY:o.y}}this._tooltipItems=a,this.$context=void 0,i&&this._resolveAnimations().update(this,i),e&&n.external&&n.external.call(this,{chart:this.chart,tooltip:this,replay:t})}drawCaret(e,t,n,s){const i=this.getCaretPosition(e,n,s);t.lineTo(i.x1,i.y1),t.lineTo(i.x2,i.y2),t.lineTo(i.x3,i.y3)}getCaretPosition(e,t,n){const{xAlign:s,yAlign:i}=this,{caretSize:a,cornerRadius:o}=n,{topLeft:l,topRight:c,bottomLeft:A,bottomRight:d}=vd(o),{x:h,y:u}=e,{width:p,height:f}=t;let g,m,x,S,B,F;return i==="center"?(B=u+f/2,s==="left"?(g=h,m=g-a,S=B+a,F=B-a):(g=h+p,m=g+a,S=B-a,F=B+a),x=g):(s==="left"?m=h+Math.max(l,A)+a:s==="right"?m=h+p-Math.max(c,d)-a:m=this.caretX,i==="top"?(S=u,B=S-a,g=m-a,x=m+a):(S=u+f,B=S+a,g=m+a,x=m-a),F=S),{x1:g,x2:m,x3:x,y1:S,y2:B,y3:F}}drawTitle(e,t,n){const s=this.title,i=s.length;let a,o,l;if(i){const c=Qu(n.rtl,this.x,this.width);for(e.x=Gp(this,n.titleAlign,n),t.textAlign=c.textAlign(n.titleAlign),t.textBaseline="middle",a=vs(n.titleFont),o=n.titleSpacing,t.fillStyle=n.titleColor,t.font=a.string,l=0;l<i;++l)t.fillText(s[l],c.x(e.x),e.y+a.lineHeight/2),e.y+=a.lineHeight+o,l+1===i&&(e.y+=n.titleMarginBottom-o)}}_drawColorBox(e,t,n,s,i){const a=this.labelColors[n],o=this.labelPointStyles[n],{boxHeight:l,boxWidth:c}=i,A=vs(i.bodyFont),d=Gp(this,"left",i),h=s.x(d),u=l<A.lineHeight?(A.lineHeight-l)/2:0,p=t.y+u;if(i.usePointStyle){const f={radius:Math.min(c,l)/2,pointStyle:o.pointStyle,rotation:o.rotation,borderWidth:1},g=s.leftForLtr(h,c)+c/2,m=p+l/2;e.strokeStyle=i.multiKeyBackground,e.fillStyle=i.multiKeyBackground,Cv(e,f,g,m),e.strokeStyle=a.borderColor,e.fillStyle=a.backgroundColor,Cv(e,f,g,m)}else{e.lineWidth=Br(a.borderWidth)?Math.max(...Object.values(a.borderWidth)):a.borderWidth||1,e.strokeStyle=a.borderColor,e.setLineDash(a.borderDash||[]),e.lineDashOffset=a.borderDashOffset||0;const f=s.leftForLtr(h,c),g=s.leftForLtr(s.xPlus(h,1),c-2),m=vd(a.borderRadius);Object.values(m).some(x=>x!==0)?(e.beginPath(),e.fillStyle=i.multiKeyBackground,ug(e,{x:f,y:p,w:c,h:l,radius:m}),e.fill(),e.stroke(),e.fillStyle=a.backgroundColor,e.beginPath(),ug(e,{x:g,y:p+1,w:c-2,h:l-2,radius:m}),e.fill()):(e.fillStyle=i.multiKeyBackground,e.fillRect(f,p,c,l),e.strokeRect(f,p,c,l),e.fillStyle=a.backgroundColor,e.fillRect(g,p+1,c-2,l-2))}e.fillStyle=this.labelTextColors[n]}drawBody(e,t,n){const{body:s}=this,{bodySpacing:i,bodyAlign:a,displayColors:o,boxHeight:l,boxWidth:c,boxPadding:A}=n,d=vs(n.bodyFont);let h=d.lineHeight,u=0;const p=Qu(n.rtl,this.x,this.width),f=function(w){t.fillText(w,p.x(e.x+u),e.y+h/2),e.y+=h+i},g=p.textAlign(a);let m,x,S,B,F,N,E;for(t.textAlign=a,t.textBaseline="middle",t.font=d.string,e.x=Gp(this,g,n),t.fillStyle=n.bodyColor,xr(this.beforeBody,f),u=o&&g!=="right"?a==="center"?c/2+A:c+2+A:0,B=0,N=s.length;B<N;++B){for(m=s[B],x=this.labelTextColors[B],t.fillStyle=x,xr(m.before,f),S=m.lines,o&&S.length&&(this._drawColorBox(t,e,B,p,n),h=Math.max(d.lineHeight,l)),F=0,E=S.length;F<E;++F)f(S[F]),h=d.lineHeight;xr(m.after,f)}u=0,h=d.lineHeight,xr(this.afterBody,f),e.y-=i}drawFooter(e,t,n){const s=this.footer,i=s.length;let a,o;if(i){const l=Qu(n.rtl,this.x,this.width);for(e.x=Gp(this,n.footerAlign,n),e.y+=n.footerMarginTop,t.textAlign=l.textAlign(n.footerAlign),t.textBaseline="middle",a=vs(n.footerFont),t.fillStyle=n.footerColor,t.font=a.string,o=0;o<i;++o)t.fillText(s[o],l.x(e.x),e.y+a.lineHeight/2),e.y+=a.lineHeight+n.footerSpacing}}drawBackground(e,t,n,s){const{xAlign:i,yAlign:a}=this,{x:o,y:l}=e,{width:c,height:A}=n,{topLeft:d,topRight:h,bottomLeft:u,bottomRight:p}=vd(s.cornerRadius);t.fillStyle=s.backgroundColor,t.strokeStyle=s.borderColor,t.lineWidth=s.borderWidth,t.beginPath(),t.moveTo(o+d,l),a==="top"&&this.drawCaret(e,t,n,s),t.lineTo(o+c-h,l),t.quadraticCurveTo(o+c,l,o+c,l+h),a==="center"&&i==="right"&&this.drawCaret(e,t,n,s),t.lineTo(o+c,l+A-p),t.quadraticCurveTo(o+c,l+A,o+c-p,l+A),a==="bottom"&&this.drawCaret(e,t,n,s),t.lineTo(o+u,l+A),t.quadraticCurveTo(o,l+A,o,l+A-u),a==="center"&&i==="left"&&this.drawCaret(e,t,n,s),t.lineTo(o,l+d),t.quadraticCurveTo(o,l,o+d,l),t.closePath(),t.fill(),s.borderWidth>0&&t.stroke()}_updateAnimationTarget(e){const t=this.chart,n=this.$animations,s=n&&n.x,i=n&&n.y;if(s||i){const a=gf[e.position].call(this,this._active,this._eventPosition);if(!a)return;const o=this._size=a5(this,e),l=Object.assign({},a,this._size),c=o5(t,e,l),A=l5(e,l,c,t);(s._to!==A.x||i._to!==A.y)&&(this.xAlign=c.xAlign,this.yAlign=c.yAlign,this.width=o.width,this.height=o.height,this.caretX=a.x,this.caretY=a.y,this._resolveAnimations().update(this,A))}}_willRender(){return!!this.opacity}draw(e){const t=this.options.setContext(this.getContext());let n=this.opacity;if(!n)return;this._updateAnimationTarget(t);const s={width:this.width,height:this.height},i={x:this.x,y:this.y};n=Math.abs(n)<.001?0:n;const a=ui(t.padding),o=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;t.enabled&&o&&(e.save(),e.globalAlpha=n,this.drawBackground(i,e,s,t),NI(e,t.textDirection),i.y+=a.top,this.drawTitle(i,e,t),this.drawBody(i,e,t),this.drawFooter(i,e,t),PI(e,t.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,t){const n=this._active,s=e.map(({datasetIndex:o,index:l})=>{const c=this.chart.getDatasetMeta(o);if(!c)throw new Error("Cannot find a dataset at index "+o);return{datasetIndex:o,element:c.data[l],index:l}}),i=!Fm(n,s),a=this._positionChanged(s,t);(i||a)&&(this._active=s,this._eventPosition=t,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,t,n=!0){if(t&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const s=this.options,i=this._active||[],a=this._getActiveElements(e,i,t,n),o=this._positionChanged(a,e),l=t||!Fm(a,i)||o;return l&&(this._active=a,(s.enabled||s.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,t))),l}_getActiveElements(e,t,n,s){const i=this.options;if(e.type==="mouseout")return[];if(!s)return t.filter(o=>this.chart.data.datasets[o.datasetIndex]&&this.chart.getDatasetMeta(o.datasetIndex).controller.getParsed(o.index)!==void 0);const a=this.chart.getElementsAtEventForMode(e,i.mode,i,n);return i.reverse&&a.reverse(),a}_positionChanged(e,t){const{caretX:n,caretY:s,options:i}=this,a=gf[i.position].call(this,e,t);return a!==!1&&(n!==a.x||s!==a.y)}}Fe(Lv,"positioners",gf);var aQ={id:"tooltip",_element:Lv,positioners:gf,afterInit(r,e,t){t&&(r.tooltip=new Lv({chart:r,options:t}))},beforeUpdate(r,e,t){r.tooltip&&r.tooltip.initialize(t)},reset(r,e,t){r.tooltip&&r.tooltip.initialize(t)},afterDraw(r){const e=r.tooltip;if(e&&e._willRender()){const t={tooltip:e};if(r.notifyPlugins("beforeTooltipDraw",{...t,cancelable:!0})===!1)return;e.draw(r.ctx),r.notifyPlugins("afterTooltipDraw",t)}},afterEvent(r,e){if(r.tooltip){const t=e.replay;r.tooltip.handleEvent(e.event,t,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(r,e)=>e.bodyFont.size,boxWidth:(r,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:cT},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:r=>r!=="filter"&&r!=="itemSort"&&r!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},ProgressOptionScopes:["interaction"]},oQ=Object.freeze({__proto__:null,Colors:yO,Decimation:_O,Filler:VO,Legend:WO,SubTitle:JO,Title:XO,Tooltip:aQ});const lQ=(r,e,t,n)=>(typeof e=="string"?(t=r.push(e)-1,n.unshift({index:t,label:e})):isNaN(e)&&(t=null),t);function cQ(r,e,t,n){const s=r.indexOf(e);if(s===-1)return lQ(r,e,t,n);const i=r.lastIndexOf(e);return s!==i?t:s}const AQ=(r,e)=>r===null?null:qs(Math.round(r),0,e);function d5(r){const e=this.getLabels();return r>=0&&r<e.length?e[r]:r}class Uv extends zd{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const t=this._addedLabels;if(t.length){const n=this.getLabels();for(const{index:s,label:i}of t)n[s]===i&&n.splice(s,1);this._addedLabels=[]}super.init(e)}parse(e,t){if(pr(e))return null;const n=this.getLabels();return t=isFinite(t)&&n[t]===e?t:cQ(n,e,qt(t,e),this._addedLabels),AQ(t,n.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let{min:n,max:s}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(n=0),t||(s=this.getLabels().length-1)),this.min=n,this.max=s}buildTicks(){const e=this.min,t=this.max,n=this.options.offset,s=[];let i=this.getLabels();i=e===0&&t===i.length-1?i:i.slice(e,t+1),this._valueRange=Math.max(i.length-(n?0:1),1),this._startValue=this.min-(n?.5:0);for(let a=e;a<=t;a++)s.push({value:a});return s}getLabelForValue(e){return d5.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}Fe(Uv,"id","category"),Fe(Uv,"defaults",{ticks:{callback:d5}});function dQ(r,e){const t=[],{bounds:s,step:i,min:a,max:o,precision:l,count:c,maxTicks:A,maxDigits:d,includeBounds:h}=r,u=i||1,p=A-1,{min:f,max:g}=e,m=!pr(a),x=!pr(o),S=!pr(c),B=(g-f)/(d+1);let F=aB((g-f)/p/u)*u,N,E,w,v;if(F<1e-14&&!m&&!x)return[{value:f},{value:g}];v=Math.ceil(g/F)-Math.floor(f/F),v>p&&(F=aB(v*F/p/u)*u),pr(l)||(N=Math.pow(10,l),F=Math.ceil(F*N)/N),s==="ticks"?(E=Math.floor(f/F)*F,w=Math.ceil(g/F)*F):(E=f,w=g),m&&x&&i&&sD((o-a)/i,F/1e3)?(v=Math.round(Math.min((o-a)/F,A)),F=(o-a)/v,E=a,w=o):S?(E=m?a:E,w=x?o:w,v=c-1,F=(w-E)/v):(v=(w-E)/F,wd(v,Math.round(v),F/1e3)?v=Math.round(v):v=Math.ceil(v));const I=Math.max(oB(F),oB(E));N=Math.pow(10,pr(l)?I:l),E=Math.round(E*N)/N,w=Math.round(w*N)/N;let k=0;for(m&&(h&&E!==a?(t.push({value:a}),E<a&&k++,wd(Math.round((E+k*F)*N)/N,a,u5(a,B,r))&&k++):E<a&&k++);k<v;++k){const _=Math.round((E+k*F)*N)/N;if(x&&_>o)break;t.push({value:_})}return x&&h&&w!==o?t.length&&wd(t[t.length-1].value,o,u5(o,B,r))?t[t.length-1].value=o:t.push({value:o}):(!x||w===o)&&t.push({value:w}),t}function u5(r,e,{horizontal:t,minRotation:n}){const s=ho(n),i=(t?Math.sin(s):Math.cos(s))||.001,a=.75*e*(""+r).length;return Math.min(e/i,a)}class Rm extends zd{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,t){return pr(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:t,maxDefined:n}=this.getUserBounds();let{min:s,max:i}=this;const a=l=>s=t?s:l,o=l=>i=n?i:l;if(e){const l=eo(s),c=eo(i);l<0&&c<0?o(0):l>0&&c>0&&a(0)}if(s===i){let l=i===0?1:Math.abs(i*.05);o(i+l),e||a(s-l)}this.min=s,this.max=i}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:t,stepSize:n}=e,s;return n?(s=Math.ceil(this.max/n)-Math.floor(this.min/n)+1,s>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${n} would result generating up to ${s} ticks. Limiting to 1000.`),s=1e3)):(s=this.computeTickLimit(),t=t||11),t&&(s=Math.min(t,s)),s}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,t=e.ticks;let n=this.getTickLimit();n=Math.max(2,n);const s={maxTicks:n,bounds:e.bounds,min:e.min,max:e.max,precision:t.precision,step:t.stepSize,count:t.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:t.minRotation||0,includeBounds:t.includeBounds!==!1},i=this._range||this,a=dQ(s,i);return e.bounds==="ticks"&&bI(a,this,"value"),e.reverse?(a.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),a}configure(){const e=this.ticks;let t=this.min,n=this.max;if(super.configure(),this.options.offset&&e.length){const s=(n-t)/Math.max(e.length-1,1)/2;t-=s,n+=s}this._startValue=t,this._endValue=n,this._valueRange=n-t}getLabelForValue(e){return Pg(e,this.chart.options.locale,this.options.ticks.format)}}class Mv extends Rm{determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=Kn(e)?e:0,this.max=Kn(t)?t:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),t=e?this.width:this.height,n=ho(this.options.ticks.minRotation),s=(e?Math.sin(n):Math.cos(n))||.001,i=this._resolveTickFontOptions(0);return Math.ceil(t/Math.min(40,i.lineHeight/s))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}Fe(Mv,"id","linear"),Fe(Mv,"defaults",{ticks:{callback:Eb.formatters.numeric}});const fg=r=>Math.floor(Kc(r)),ZA=(r,e)=>Math.pow(10,fg(r)+e);function h5(r){return r/Math.pow(10,fg(r))===1}function f5(r,e,t){const n=Math.pow(10,t),s=Math.floor(r/n);return Math.ceil(e/n)-s}function uQ(r,e){const t=e-r;let n=fg(t);for(;f5(r,e,n)>10;)n++;for(;f5(r,e,n)<10;)n--;return Math.min(n,fg(r))}function hQ(r,{min:e,max:t}){e=ka(r.min,e);const n=[],s=fg(e);let i=uQ(e,t),a=i<0?Math.pow(10,Math.abs(i)):1;const o=Math.pow(10,i),l=s>i?Math.pow(10,s):0,c=Math.round((e-l)*a)/a,A=Math.floor((e-l)/o/10)*o*10;let d=Math.floor((c-A)/Math.pow(10,i)),h=ka(r.min,Math.round((l+A+d*Math.pow(10,i))*a)/a);for(;h<t;)n.push({value:h,major:h5(h),significand:d}),d>=10?d=d<15?15:20:d++,d>=20&&(i++,d=2,a=i>=0?1:a),h=Math.round((l+A+d*Math.pow(10,i))*a)/a;const u=ka(r.max,h);return n.push({value:u,major:h5(u),significand:d}),n}class Nv extends zd{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(e,t){const n=Rm.prototype.parse.apply(this,[e,t]);if(n===0){this._zero=!0;return}return Kn(n)&&n>0?n:null}determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=Kn(e)?Math.max(0,e):null,this.max=Kn(t)?Math.max(0,t):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!Kn(this._userMin)&&(this.min=e===ZA(this.min,0)?ZA(this.min,-1):ZA(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let n=this.min,s=this.max;const i=o=>n=e?n:o,a=o=>s=t?s:o;n===s&&(n<=0?(i(1),a(10)):(i(ZA(n,-1)),a(ZA(s,1)))),n<=0&&i(ZA(s,-1)),s<=0&&a(ZA(n,1)),this.min=n,this.max=s}buildTicks(){const e=this.options,t={min:this._userMin,max:this._userMax},n=hQ(t,this);return e.bounds==="ticks"&&bI(n,this,"value"),e.reverse?(n.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),n}getLabelForValue(e){return e===void 0?"0":Pg(e,this.chart.options.locale,this.options.ticks.format)}configure(){const e=this.min;super.configure(),this._startValue=Kc(e),this._valueRange=Kc(this.max)-Kc(e)}getPixelForValue(e){return(e===void 0||e===0)&&(e=this.min),e===null||isNaN(e)?NaN:this.getPixelForDecimal(e===this.min?0:(Kc(e)-this._startValue)/this._valueRange)}getValueForPixel(e){const t=this.getDecimalForPixel(e);return Math.pow(10,this._startValue+t*this._valueRange)}}Fe(Nv,"id","logarithmic"),Fe(Nv,"defaults",{ticks:{callback:Eb.formatters.logarithmic,major:{enabled:!0}}});function Pv(r){const e=r.ticks;if(e.display&&r.display){const t=ui(e.backdropPadding);return qt(e.font&&e.font.size,Tn.font.size)+t.height}return 0}function fQ(r,e,t){return t=Sn(t)?t:[t],{w:vD(r,e.string,t),h:t.length*e.lineHeight}}function g5(r,e,t,n,s){return r===n||r===s?{start:e-t/2,end:e+t/2}:r<n||r>s?{start:e-t,end:e}:{start:e,end:e+t}}function gQ(r){const e={l:r.left+r._padding.left,r:r.right-r._padding.right,t:r.top+r._padding.top,b:r.bottom-r._padding.bottom},t=Object.assign({},e),n=[],s=[],i=r._pointLabels.length,a=r.options.pointLabels,o=a.centerPointLabels?Gr/i:0;for(let l=0;l<i;l++){const c=a.setContext(r.getPointLabelContext(l));s[l]=c.padding;const A=r.getPointPosition(l,r.drawingArea+s[l],o),d=vs(c.font),h=fQ(r.ctx,d,r._pointLabels[l]);n[l]=h;const u=Si(r.getIndexAngle(l)+o),p=Math.round(_x(u)),f=g5(p,A.x,h.w,0,180),g=g5(p,A.y,h.h,90,270);pQ(t,e,u,f,g)}r.setCenterPoint(e.l-t.l,t.r-e.r,e.t-t.t,t.b-e.b),r._pointLabelItems=yQ(r,n,s)}function pQ(r,e,t,n,s){const i=Math.abs(Math.sin(t)),a=Math.abs(Math.cos(t));let o=0,l=0;n.start<e.l?(o=(e.l-n.start)/i,r.l=Math.min(r.l,e.l-o)):n.end>e.r&&(o=(n.end-e.r)/i,r.r=Math.max(r.r,e.r+o)),s.start<e.t?(l=(e.t-s.start)/a,r.t=Math.min(r.t,e.t-l)):s.end>e.b&&(l=(s.end-e.b)/a,r.b=Math.max(r.b,e.b+l))}function mQ(r,e,t){const n=r.drawingArea,{extra:s,ProgressAngle:i,padding:a,size:o}=t,l=r.getPointPosition(e,n+s+a,i),c=Math.round(_x(Si(l.angle+ds))),A=xQ(l.y,o.h,c),d=wQ(c),h=vQ(l.x,o.w,d);return{visible:!0,x:l.x,y:A,textAlign:d,left:h,top:A,right:h+o.w,bottom:A+o.h}}function bQ(r,e){if(!e)return!0;const{left:t,top:n,right:s,bottom:i}=r;return!(Yo({x:t,y:n},e)||Yo({x:t,y:i},e)||Yo({x:s,y:n},e)||Yo({x:s,y:i},e))}function yQ(r,e,t){const n=[],s=r._pointLabels.length,i=r.options,{centerPointLabels:a,display:o}=i.pointLabels,l={extra:Pv(i)/2,ProgressAngle:a?Gr/s:0};let c;for(let A=0;A<s;A++){l.padding=t[A],l.size=e[A];const d=mQ(r,A,l);n.push(d),o==="auto"&&(d.visible=bQ(d,c),d.visible&&(c=d))}return n}function wQ(r){return r===0||r===180?"center":r<180?"left":"right"}function vQ(r,e,t){return t==="right"?r-=e:t==="center"&&(r-=e/2),r}function xQ(r,e,t){return t===90||t===270?r-=e/2:(t>270||t<90)&&(r-=e),r}function _Q(r,e,t){const{left:n,top:s,right:i,bottom:a}=t,{backdropColor:o}=e;if(!pr(o)){const l=vd(e.borderRadius),c=ui(e.backdropPadding);r.fillStyle=o;const A=n-c.left,d=s-c.top,h=i-n+c.width,u=a-s+c.height;Object.values(l).some(p=>p!==0)?(r.beginPath(),ug(r,{x:A,y:d,w:h,h:u,radius:l}),r.fill()):r.fillRect(A,d,h,u)}}function BQ(r,e){const{ctx:t,options:{pointLabels:n}}=r;for(let s=e-1;s>=0;s--){const i=r._pointLabelItems[s];if(!i.visible)continue;const a=n.setContext(r.getPointLabelContext(s));_Q(t,a,i);const o=vs(a.font),{x:l,y:c,textAlign:A}=i;Ld(t,r._pointLabels[s],l,c+o.lineHeight/2,o,{color:a.color,textAlign:A,textBaseline:"middle"})}}function AT(r,e,t,n){const{ctx:s}=r;if(t)s.arc(r.xCenter,r.yCenter,e,0,In);else{let i=r.getPointPosition(0,e);s.moveTo(i.x,i.y);for(let a=1;a<n;a++)i=r.getPointPosition(a,e),s.lineTo(i.x,i.y)}}function CQ(r,e,t,n,s){const i=r.ctx,a=e.circular,{color:o,lineWidth:l}=e;!a&&!n||!o||!l||t<0||(i.save(),i.strokeStyle=o,i.lineWidth=l,i.setLineDash(s.dash||[]),i.lineDashOffset=s.dashOffset,i.beginPath(),AT(r,t,a,n),i.closePath(),i.stroke(),i.restore())}function SQ(r,e,t){return IA(r,{label:t,index:e,type:"pointLabel"})}class pf extends Rm{constructor(e){super(e),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const e=this._padding=ui(Pv(this.options)/2),t=this.width=this.maxWidth-e.width,n=this.height=this.maxHeight-e.height;this.xCenter=Math.floor(this.left+t/2+e.left),this.yCenter=Math.floor(this.top+n/2+e.top),this.drawingArea=Math.floor(Math.min(t,n)/2)}determineDataLimits(){const{min:e,max:t}=this.getMinMax(!1);this.min=Kn(e)&&!isNaN(e)?e:0,this.max=Kn(t)&&!isNaN(t)?t:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/Pv(this.options))}generateTickLabels(e){Rm.prototype.generateTickLabels.call(this,e),this._pointLabels=this.getLabels().map((t,n)=>{const s=zt(this.options.pointLabels.callback,[t,n],this);return s||s===0?s:""}).filter((t,n)=>this.chart.getDataVisibility(n))}fit(){const e=this.options;e.display&&e.pointLabels.display?gQ(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(e,t,n,s){this.xCenter+=Math.floor((e-t)/2),this.yCenter+=Math.floor((n-s)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(e,t,n,s))}getIndexAngle(e){const t=In/(this._pointLabels.length||1),n=this.options.startAngle||0;return Si(e*t+ho(n))}getDistanceFromCenterForValue(e){if(pr(e))return NaN;const t=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-e)*t:(e-this.min)*t}getValueForDistanceFromCenter(e){if(pr(e))return NaN;const t=e/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-t:this.min+t}getPointLabelContext(e){const t=this._pointLabels||[];if(e>=0&&e<t.length){const n=t[e];return SQ(this.getContext(),e,n)}}getPointPosition(e,t,n=0){const s=this.getIndexAngle(e)-ds+n;return{x:Math.cos(s)*t+this.xCenter,y:Math.sin(s)*t+this.yCenter,angle:s}}getPointPositionForValue(e,t){return this.getPointPosition(e,this.getDistanceFromCenterForValue(t))}getBasePosition(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}getPointLabelPosition(e){const{left:t,top:n,right:s,bottom:i}=this._pointLabelItems[e];return{left:t,top:n,right:s,bottom:i}}drawBackground(){const{backgroundColor:e,grid:{circular:t}}=this.options;if(e){const n=this.ctx;n.save(),n.beginPath(),AT(this,this.getDistanceFromCenterForValue(this._endValue),t,this._pointLabels.length),n.closePath(),n.fillStyle=e,n.fill(),n.restore()}}drawGrid(){const e=this.ctx,t=this.options,{angleLines:n,grid:s,border:i}=t,a=this._pointLabels.length;let o,l,c;if(t.pointLabels.display&&BQ(this,a),s.display&&this.ticks.forEach((A,d)=>{if(d!==0||d===0&&this.min<0){l=this.getDistanceFromCenterForValue(A.value);const h=this.getContext(d),u=s.setContext(h),p=i.setContext(h);CQ(this,u,l,a,p)}}),n.display){for(e.save(),o=a-1;o>=0;o--){const A=n.setContext(this.getPointLabelContext(o)),{color:d,lineWidth:h}=A;!h||!d||(e.lineWidth=h,e.strokeStyle=d,e.setLineDash(A.borderDash),e.lineDashOffset=A.borderDashOffset,l=this.getDistanceFromCenterForValue(t.reverse?this.min:this.max),c=this.getPointPosition(o,l),e.beginPath(),e.moveTo(this.xCenter,this.yCenter),e.lineTo(c.x,c.y),e.stroke())}e.restore()}}drawBorder(){}drawLabels(){const e=this.ctx,t=this.options,n=t.ticks;if(!n.display)return;const s=this.getIndexAngle(0);let i,a;e.save(),e.translate(this.xCenter,this.yCenter),e.rotate(s),e.textAlign="center",e.textBaseline="middle",this.ticks.forEach((o,l)=>{if(l===0&&this.min>=0&&!t.reverse)return;const c=n.setContext(this.getContext(l)),A=vs(c.font);if(i=this.getDistanceFromCenterForValue(this.ticks[l].value),c.showLabelBackdrop){e.font=A.string,a=e.measureText(o.label).width,e.fillStyle=c.backdropColor;const d=ui(c.backdropPadding);e.fillRect(-a/2-d.left,-i-A.size/2-d.top,a+d.width,A.size+d.height)}Ld(e,o.label,0,-i,A,{color:c.color,strokeColor:c.textStrokeColor,strokeWidth:c.textStrokeWidth})}),e.restore()}drawTitle(){}}Fe(pf,"id","radialLinear"),Fe(pf,"defaults",{display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:Eb.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(e){return e},padding:5,centerPointLabels:!1}}),Fe(pf,"defaultRoutes",{"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"}),Fe(pf,"descriptors",{angleLines:{_fallback:"grid"}});const Mb={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},la=Object.keys(Mb);function p5(r,e){return r-e}function m5(r,e){if(pr(e))return null;const t=r._adapter,{parser:n,round:s,isoWeekday:i}=r._parseOpts;let a=e;return typeof n=="function"&&(a=n(a)),Kn(a)||(a=typeof n=="string"?t.parse(a,n):t.parse(a)),a===null?null:(s&&(a=s==="week"&&(th(i)||i===!0)?t.startOf(a,"isoWeek",i):t.startOf(a,s)),+a)}function b5(r,e,t,n){const s=la.length;for(let i=la.indexOf(r);i<s-1;++i){const a=Mb[la[i]],o=a.steps?a.steps:Number.MAX_SAFE_INTEGER;if(a.common&&Math.ceil((t-e)/(o*a.size))<=n)return la[i]}return la[s-1]}function kQ(r,e,t,n,s){for(let i=la.length-1;i>=la.indexOf(t);i--){const a=la[i];if(Mb[a].common&&r._adapter.diff(s,n,a)>=e-1)return a}return la[t?la.indexOf(t):0]}function EQ(r){for(let e=la.indexOf(r)+1,t=la.length;e<t;++e)if(Mb[la[e]].common)return la[e]}function y5(r,e,t){if(!t)r[e]=!0;else if(t.length){const{lo:n,hi:s}=Bx(t,e),i=t[n]>=e?t[n]:t[s];r[i]=!0}}function IQ(r,e,t,n){const s=r._adapter,i=+s.startOf(e[0].value,n),a=e[e.length-1].value;let o,l;for(o=i;o<=a;o=+s.add(o,1,n))l=t[o],l>=0&&(e[l].major=!0);return e}function w5(r,e,t){const n=[],s={},i=e.length;let a,o;for(a=0;a<i;++a)o=e[a],s[o]=a,n.push({value:o,major:!1});return i===0||!t?n:IQ(r,n,s,t)}class gg extends zd{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,t={}){const n=e.time||(e.time={}),s=this._adapter=new $I._date(e.adapters.date);s.init(t),Mf(n.displayFormats,s.formats()),this._parseOpts={parser:n.parser,round:n.round,isoWeekday:n.isoWeekday},super.init(e),this._normalized=t.normalized}parse(e,t){return e===void 0?null:m5(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,t=this._adapter,n=e.time.unit||"day";let{min:s,max:i,minDefined:a,maxDefined:o}=this.getUserBounds();function l(c){!a&&!isNaN(c.min)&&(s=Math.min(s,c.min)),!o&&!isNaN(c.max)&&(i=Math.max(i,c.max))}(!a||!o)&&(l(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&l(this.getMinMax(!1))),s=Kn(s)&&!isNaN(s)?s:+t.startOf(Date.now(),n),i=Kn(i)&&!isNaN(i)?i:+t.endOf(Date.now(),n)+1,this.min=Math.min(s,i-1),this.max=Math.max(s+1,i)}_getLabelBounds(){const e=this.getLabelTimestamps();let t=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;return e.length&&(t=e[0],n=e[e.length-1]),{min:t,max:n}}buildTicks(){const e=this.options,t=e.time,n=e.ticks,s=n.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&s.length&&(this.min=this._userMin||s[0],this.max=this._userMax||s[s.length-1]);const i=this.min,a=this.max,o=lD(s,i,a);return this._unit=t.unit||(n.autoSkip?b5(t.minUnit,this.min,this.max,this._getLabelCapacity(i)):kQ(this,o.length,t.minUnit,this.min,this.max)),this._majorUnit=!n.major.enabled||this._unit==="year"?void 0:EQ(this._unit),this.initOffsets(s),e.reverse&&o.reverse(),w5(this,o,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let t=0,n=0,s,i;this.options.offset&&e.length&&(s=this.getDecimalForValue(e[0]),e.length===1?t=1-s:t=(this.getDecimalForValue(e[1])-s)/2,i=this.getDecimalForValue(e[e.length-1]),e.length===1?n=i:n=(i-this.getDecimalForValue(e[e.length-2]))/2);const a=e.length<3?.5:.25;t=qs(t,0,a),n=qs(n,0,a),this._offsets={start:t,end:n,factor:1/(t+1+n)}}_generate(){const e=this._adapter,t=this.min,n=this.max,s=this.options,i=s.time,a=i.unit||b5(i.minUnit,t,n,this._getLabelCapacity(t)),o=qt(s.ticks.stepSize,1),l=a==="week"?i.isoWeekday:!1,c=th(l)||l===!0,A={};let d=t,h,u;if(c&&(d=+e.startOf(d,"isoWeek",l)),d=+e.startOf(d,c?"day":a),e.diff(n,t,a)>1e5*o)throw new Error(t+" and "+n+" are too far apart with stepSize of "+o+" "+a);const p=s.ticks.source==="data"&&this.getDataTimestamps();for(h=d,u=0;h<n;h=+e.add(h,o,a),u++)y5(A,h,p);return(h===n||s.bounds==="ticks"||u===1)&&y5(A,h,p),Object.keys(A).sort(p5).map(f=>+f)}getLabelForValue(e){const t=this._adapter,n=this.options.time;return n.tooltipFormat?t.format(e,n.tooltipFormat):t.format(e,n.displayFormats.datetime)}format(e,t){const s=this.options.time.displayFormats,i=this._unit,a=t||s[i];return this._adapter.format(e,a)}_tickFormatFunction(e,t,n,s){const i=this.options,a=i.ticks.callback;if(a)return zt(a,[e,t,n],this);const o=i.time.displayFormats,l=this._unit,c=this._majorUnit,A=l&&o[l],d=c&&o[c],h=n[t],u=c&&d&&h&&h.major;return this._adapter.format(e,s||(u?d:A))}generateTickLabels(e){let t,n,s;for(t=0,n=e.length;t<n;++t)s=e[t],s.label=this._tickFormatFunction(s.value,t,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const t=this._offsets,n=this.getDecimalForValue(e);return this.getPixelForDecimal((t.start+n)*t.factor)}getValueForPixel(e){const t=this._offsets,n=this.getDecimalForPixel(e)/t.factor-t.end;return this.min+n*(this.max-this.min)}_getLabelSize(e){const t=this.options.ticks,n=this.ctx.measureText(e).width,s=ho(this.isHorizontal()?t.maxRotation:t.minRotation),i=Math.cos(s),a=Math.sin(s),o=this._resolveTickFontOptions(0).size;return{w:n*i+o*a,h:n*a+o*i}}_getLabelCapacity(e){const t=this.options.time,n=t.displayFormats,s=n[t.unit]||n.millisecond,i=this._tickFormatFunction(e,0,w5(this,[e],this._majorUnit),s),a=this._getLabelSize(i),o=Math.floor(this.isHorizontal()?this.width/a.w:this.height/a.h)-1;return o>0?o:1}getDataTimestamps(){let e=this._cache.data||[],t,n;if(e.length)return e;const s=this.getMatchingVisibleMetas();if(this._normalized&&s.length)return this._cache.data=s[0].controller.getAllParsedValues(this);for(t=0,n=s.length;t<n;++t)e=e.concat(s[t].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let t,n;if(e.length)return e;const s=this.getLabels();for(t=0,n=s.length;t<n;++t)e.push(m5(this,s[t]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return vI(e.sort(p5))}}Fe(gg,"id","time"),Fe(gg,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function zp(r,e,t){let n=0,s=r.length-1,i,a,o,l;t?(e>=r[n].pos&&e<=r[s].pos&&({lo:n,hi:s}=Hl(r,"pos",e)),{pos:i,time:o}=r[n],{pos:a,time:l}=r[s]):(e>=r[n].time&&e<=r[s].time&&({lo:n,hi:s}=Hl(r,"time",e)),{time:i,pos:o}=r[n],{time:a,pos:l}=r[s]);const c=a-i;return c?o+(l-o)*(e-i)/c:o}class Dv extends gg{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),t=this._table=this.buildLookupTable(e);this._minPos=zp(t,this.min),this._tableRange=zp(t,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:t,max:n}=this,s=[],i=[];let a,o,l,c,A;for(a=0,o=e.length;a<o;++a)c=e[a],c>=t&&c<=n&&s.push(c);if(s.length<2)return[{time:t,pos:0},{time:n,pos:1}];for(a=0,o=s.length;a<o;++a)A=s[a+1],l=s[a-1],c=s[a],Math.round((A+l)/2)!==c&&i.push({time:c,pos:a/(o-1)});return i}_generate(){const e=this.min,t=this.max;let n=super.getDataTimestamps();return(!n.includes(e)||!n.length)&&n.splice(0,0,e),(!n.includes(t)||n.length===1)&&n.push(t),n.sort((s,i)=>s-i)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const t=this.getDataTimestamps(),n=this.getLabelTimestamps();return t.length&&n.length?e=this.normalize(t.concat(n)):e=t.length?t:n,e=this._cache.all=e,e}getDecimalForValue(e){return(zp(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const t=this._offsets,n=this.getDecimalForPixel(e)/t.factor-t.end;return zp(this._table,n*this._tableRange+this._minPos,!0)}}Fe(Dv,"id","timeseries"),Fe(Dv,"defaults",gg.defaults);var TQ=Object.freeze({__proto__:null,CategoryScale:Uv,LinearScale:Mv,LogarithmicScale:Nv,RadialLinearScale:pf,TimeScale:gg,TimeSeriesScale:Dv});const dT=[D6,uO,oQ,TQ],uT=6048e5,FQ=864e5,Dg=6e4,Rg=36e5,LQ=1e3,v5=Symbol.for("constructDateFrom");function Wn(r,e){return typeof r=="function"?r(e):r&&typeof r=="object"&&v5 in r?r[v5](e):r instanceof Date?new r.constructor(e):new Date(e)}function lr(r,e){return Wn(e||r,r)}function Nb(r,e,t){const n=lr(r,t==null?void 0:t.in);return isNaN(e)?Wn((t==null?void 0:t.in)||r,NaN):(e&&n.setDate(n.getDate()+e),n)}function Nx(r,e,t){const n=lr(r,t==null?void 0:t.in);if(isNaN(e))return Wn(r,NaN);if(!e)return n;const s=n.getDate(),i=Wn(r,n.getTime());i.setMonth(n.getMonth()+e+1,0);const a=i.getDate();return s>=a?i:(n.setFullYear(i.getFullYear(),i.getMonth(),s),n)}function Px(r,e,t){return Wn(r,+lr(r)+e)}function UQ(r,e,t){return Px(r,e*Rg)}let MQ={};function Kd(){return MQ}function ll(r,e){var o,l,c,A;const t=Kd(),n=(e==null?void 0:e.weekStartsOn)??((l=(o=e==null?void 0:e.locale)==null?void 0:o.options)==null?void 0:l.weekStartsOn)??t.weekStartsOn??((A=(c=t.locale)==null?void 0:c.options)==null?void 0:A.weekStartsOn)??0,s=lr(r,e==null?void 0:e.in),i=s.getDay(),a=(i<n?7:0)+i-n;return s.setDate(s.getDate()-a),s.setHours(0,0,0,0),s}function sh(r,e){return ll(r,{...e,weekStartsOn:1})}function hT(r,e){const t=lr(r,e==null?void 0:e.in),n=t.getFullYear(),s=Wn(t,0);s.setFullYear(n+1,0,4),s.setHours(0,0,0,0);const i=sh(s),a=Wn(t,0);a.setFullYear(n,0,4),a.setHours(0,0,0,0);const o=sh(a);return t.getTime()>=i.getTime()?n+1:t.getTime()>=o.getTime()?n:n-1}function Om(r){const e=lr(r),t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),+r-+t}function qd(r,...e){const t=Wn.bind(null,e.find(n=>typeof n=="object"));return e.map(t)}function Rv(r,e){const t=lr(r,e==null?void 0:e.in);return t.setHours(0,0,0,0),t}function fT(r,e,t){const[n,s]=qd(t==null?void 0:t.in,r,e),i=Rv(n),a=Rv(s),o=+i-Om(i),l=+a-Om(a);return Math.round((o-l)/FQ)}function NQ(r,e){const t=hT(r,e),n=Wn(r,0);return n.setFullYear(t,0,4),n.setHours(0,0,0,0),sh(n)}function PQ(r,e,t){const n=lr(r,t==null?void 0:t.in);return n.setTime(n.getTime()+e*Dg),n}function DQ(r,e,t){return Nx(r,e*3,t)}function RQ(r,e,t){return Px(r,e*1e3)}function OQ(r,e,t){return Nb(r,e*7,t)}function QQ(r,e,t){return Nx(r,e*12,t)}function Qf(r,e){const t=+lr(r)-+lr(e);return t<0?-1:t>0?1:t}function HQ(r){return r instanceof Date||typeof r=="object"&&Object.prototype.toString.call(r)==="[object Date]"}function gT(r){return!(!HQ(r)&&typeof r!="number"||isNaN(+lr(r)))}function jQ(r,e,t){const[n,s]=qd(t==null?void 0:t.in,r,e),i=n.getFullYear()-s.getFullYear(),a=n.getMonth()-s.getMonth();return i*12+a}function VQ(r,e,t){const[n,s]=qd(t==null?void 0:t.in,r,e);return n.getFullYear()-s.getFullYear()}function pT(r,e,t){const[n,s]=qd(t==null?void 0:t.in,r,e),i=x5(n,s),a=Math.abs(fT(n,s));n.setDate(n.getDate()-i*a);const o=+(x5(n,s)===-i),l=i*(a-o);return l===0?0:l}function x5(r,e){const t=r.getFullYear()-e.getFullYear()||r.getMonth()-e.getMonth()||r.getDate()-e.getDate()||r.getHours()-e.getHours()||r.getMinutes()-e.getMinutes()||r.getSeconds()-e.getSeconds()||r.getMilliseconds()-e.getMilliseconds();return t<0?-1:t>0?1:t}function Og(r){return e=>{const n=(r?Math[r]:Math.trunc)(e);return n===0?0:n}}function $Q(r,e,t){const[n,s]=qd(t==null?void 0:t.in,r,e),i=(+n-+s)/Rg;return Og(t==null?void 0:t.roundingMethod)(i)}function Dx(r,e){return+lr(r)-+lr(e)}function GQ(r,e,t){const n=Dx(r,e)/Dg;return Og(t==null?void 0:t.roundingMethod)(n)}function mT(r,e){const t=lr(r,e==null?void 0:e.in);return t.setHours(23,59,59,999),t}function bT(r,e){const t=lr(r,e==null?void 0:e.in),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(23,59,59,999),t}function zQ(r,e){const t=lr(r,e==null?void 0:e.in);return+mT(t,e)==+bT(t,e)}function yT(r,e,t){const[n,s,i]=qd(t==null?void 0:t.in,r,r,e),a=Qf(s,i),o=Math.abs(jQ(s,i));if(o<1)return 0;s.getMonth()===1&&s.getDate()>27&&s.setDate(30),s.setMonth(s.getMonth()-a*o);let l=Qf(s,i)===-a;zQ(n)&&o===1&&Qf(n,i)===1&&(l=!1);const c=a*(o-+l);return c===0?0:c}function KQ(r,e,t){const n=yT(r,e,t)/3;return Og(t==null?void 0:t.roundingMethod)(n)}function qQ(r,e,t){const n=Dx(r,e)/1e3;return Og(t==null?void 0:t.roundingMethod)(n)}function WQ(r,e,t){const n=pT(r,e,t)/7;return Og(t==null?void 0:t.roundingMethod)(n)}function YQ(r,e,t){const[n,s]=qd(t==null?void 0:t.in,r,e),i=Qf(n,s),a=Math.abs(VQ(n,s));n.setFullYear(1584),s.setFullYear(1584);const o=Qf(n,s)===-i,l=i*(a-+o);return l===0?0:l}function XQ(r,e){const t=lr(r,e==null?void 0:e.in),n=t.getMonth(),s=n-n%3;return t.setMonth(s,1),t.setHours(0,0,0,0),t}function JQ(r,e){const t=lr(r,e==null?void 0:e.in);return t.setDate(1),t.setHours(0,0,0,0),t}function ZQ(r,e){const t=lr(r,e==null?void 0:e.in),n=t.getFullYear();return t.setFullYear(n+1,0,0),t.setHours(23,59,59,999),t}function wT(r,e){const t=lr(r,e==null?void 0:e.in);return t.setFullYear(t.getFullYear(),0,1),t.setHours(0,0,0,0),t}function e8(r,e){const t=lr(r,e==null?void 0:e.in);return t.setMinutes(59,59,999),t}function t8(r,e){var o,l;const t=Kd(),n=t.weekStartsOn??((l=(o=t.locale)==null?void 0:o.options)==null?void 0:l.weekStartsOn)??0,s=lr(r,e==null?void 0:e.in),i=s.getDay(),a=(i<n?-7:0)+6-(i-n);return s.setDate(s.getDate()+a),s.setHours(23,59,59,999),s}function r8(r,e){const t=lr(r,e==null?void 0:e.in);return t.setSeconds(59,999),t}function n8(r,e){const t=lr(r,e==null?void 0:e.in),n=t.getMonth(),s=n-n%3+3;return t.setMonth(s,0),t.setHours(23,59,59,999),t}function s8(r,e){const t=lr(r,e==null?void 0:e.in);return t.setMilliseconds(999),t}const i8={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},a8=(r,e,t)=>{let n;const s=i8[r];return typeof s=="string"?n=s:e===1?n=s.one:n=s.other.replace("{{count}}",e.toString()),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?"in "+n:n+" ago":n};function tw(r){return(e={})=>{const t=e.width?String(e.width):r.defaultWidth;return r.formats[t]||r.formats[r.defaultWidth]}}const o8={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},l8={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},c8={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},A8={date:tw({formats:o8,defaultWidth:"full"}),time:tw({formats:l8,defaultWidth:"full"}),dateTime:tw({formats:c8,defaultWidth:"full"})},d8={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},u8=(r,e,t,n)=>d8[r];function Zh(r){return(e,t)=>{const n=t!=null&&t.context?String(t.context):"standalone";let s;if(n==="formatting"&&r.formattingValues){const a=r.defaultFormattingWidth||r.defaultWidth,o=t!=null&&t.width?String(t.width):a;s=r.formattingValues[o]||r.formattingValues[a]}else{const a=r.defaultWidth,o=t!=null&&t.width?String(t.width):r.defaultWidth;s=r.values[o]||r.values[a]}const i=r.argumentCallback?r.argumentCallback(e):e;return s[i]}}const h8={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},f8={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},g8={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},p8={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},m8={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},b8={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},y8=(r,e)=>{const t=Number(r),n=t%100;if(n>20||n<10)switch(n%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},w8={ordinalNumber:y8,era:Zh({values:h8,defaultWidth:"wide"}),quarter:Zh({values:f8,defaultWidth:"wide",argumentCallback:r=>r-1}),month:Zh({values:g8,defaultWidth:"wide"}),day:Zh({values:p8,defaultWidth:"wide"}),dayPeriod:Zh({values:m8,defaultWidth:"wide",formattingValues:b8,defaultFormattingWidth:"wide"})};function ef(r){return(e,t={})=>{const n=t.width,s=n&&r.matchPatterns[n]||r.matchPatterns[r.defaultMatchWidth],i=e.match(s);if(!i)return null;const a=i[0],o=n&&r.parsePatterns[n]||r.parsePatterns[r.defaultParseWidth],l=Array.isArray(o)?x8(o,d=>d.test(a)):v8(o,d=>d.test(a));let c;c=r.valueCallback?r.valueCallback(l):l,c=t.valueCallback?t.valueCallback(c):c;const A=e.slice(a.length);return{value:c,rest:A}}}function v8(r,e){for(const t in r)if(Object.prototype.hasOwnProperty.call(r,t)&&e(r[t]))return t}function x8(r,e){for(let t=0;t<r.length;t++)if(e(r[t]))return t}function _8(r){return(e,t={})=>{const n=e.match(r.matchPattern);if(!n)return null;const s=n[0],i=e.match(r.parsePattern);if(!i)return null;let a=r.valueCallback?r.valueCallback(i[0]):i[0];a=t.valueCallback?t.valueCallback(a):a;const o=e.slice(s.length);return{value:a,rest:o}}}const B8=/^(\d+)(th|st|nd|rd)?/i,C8=/\d+/i,S8={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},k8={any:[/^b/i,/^(a|c)/i]},E8={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},I8={any:[/1/i,/2/i,/3/i,/4/i]},T8={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},F8={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},L8={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},U8={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},M8={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},N8={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},P8={ordinalNumber:_8({matchPattern:B8,parsePattern:C8,valueCallback:r=>parseInt(r,10)}),era:ef({matchPatterns:S8,defaultMatchWidth:"wide",parsePatterns:k8,defaultParseWidth:"any"}),quarter:ef({matchPatterns:E8,defaultMatchWidth:"wide",parsePatterns:I8,defaultParseWidth:"any",valueCallback:r=>r+1}),month:ef({matchPatterns:T8,defaultMatchWidth:"wide",parsePatterns:F8,defaultParseWidth:"any"}),day:ef({matchPatterns:L8,defaultMatchWidth:"wide",parsePatterns:U8,defaultParseWidth:"any"}),dayPeriod:ef({matchPatterns:M8,defaultMatchWidth:"any",parsePatterns:N8,defaultParseWidth:"any"})},vT={code:"en-US",formatDistance:a8,formatLong:A8,formatRelative:u8,localize:w8,match:P8,options:{weekStartsOn:0,firstWeekContainsDate:1}};function D8(r,e){const t=lr(r,e==null?void 0:e.in);return fT(t,wT(t))+1}function xT(r,e){const t=lr(r,e==null?void 0:e.in),n=+sh(t)-+NQ(t);return Math.round(n/uT)+1}function Rx(r,e){var A,d,h,u;const t=lr(r,e==null?void 0:e.in),n=t.getFullYear(),s=Kd(),i=(e==null?void 0:e.firstWeekContainsDate)??((d=(A=e==null?void 0:e.locale)==null?void 0:A.options)==null?void 0:d.firstWeekContainsDate)??s.firstWeekContainsDate??((u=(h=s.locale)==null?void 0:h.options)==null?void 0:u.firstWeekContainsDate)??1,a=Wn((e==null?void 0:e.in)||r,0);a.setFullYear(n+1,0,i),a.setHours(0,0,0,0);const o=ll(a,e),l=Wn((e==null?void 0:e.in)||r,0);l.setFullYear(n,0,i),l.setHours(0,0,0,0);const c=ll(l,e);return+t>=+o?n+1:+t>=+c?n:n-1}function R8(r,e){var o,l,c,A;const t=Kd(),n=(e==null?void 0:e.firstWeekContainsDate)??((l=(o=e==null?void 0:e.locale)==null?void 0:o.options)==null?void 0:l.firstWeekContainsDate)??t.firstWeekContainsDate??((A=(c=t.locale)==null?void 0:c.options)==null?void 0:A.firstWeekContainsDate)??1,s=Rx(r,e),i=Wn((e==null?void 0:e.in)||r,0);return i.setFullYear(s,0,n),i.setHours(0,0,0,0),ll(i,e)}function _T(r,e){const t=lr(r,e==null?void 0:e.in),n=+ll(t,e)-+R8(t,e);return Math.round(n/uT)+1}function rn(r,e){const t=r<0?"-":"",n=Math.abs(r).toString().padStart(e,"0");return t+n}const Uc={y(r,e){const t=r.getFullYear(),n=t>0?t:1-t;return rn(e==="yy"?n%100:n,e.length)},M(r,e){const t=r.getMonth();return e==="M"?String(t+1):rn(t+1,2)},d(r,e){return rn(r.getDate(),e.length)},a(r,e){const t=r.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(r,e){return rn(r.getHours()%12||12,e.length)},H(r,e){return rn(r.getHours(),e.length)},m(r,e){return rn(r.getMinutes(),e.length)},s(r,e){return rn(r.getSeconds(),e.length)},S(r,e){const t=e.length,n=r.getMilliseconds(),s=Math.trunc(n*Math.pow(10,t-3));return rn(s,e.length)}},uu={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},_5={G:function(r,e,t){const n=r.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return t.era(n,{width:"abbreviated"});case"GGGGG":return t.era(n,{width:"narrow"});case"GGGG":default:return t.era(n,{width:"wide"})}},y:function(r,e,t){if(e==="yo"){const n=r.getFullYear(),s=n>0?n:1-n;return t.ordinalNumber(s,{unit:"year"})}return Uc.y(r,e)},Y:function(r,e,t,n){const s=Rx(r,n),i=s>0?s:1-s;if(e==="YY"){const a=i%100;return rn(a,2)}return e==="Yo"?t.ordinalNumber(i,{unit:"year"}):rn(i,e.length)},R:function(r,e){const t=hT(r);return rn(t,e.length)},u:function(r,e){const t=r.getFullYear();return rn(t,e.length)},Q:function(r,e,t){const n=Math.ceil((r.getMonth()+1)/3);switch(e){case"Q":return String(n);case"QQ":return rn(n,2);case"Qo":return t.ordinalNumber(n,{unit:"quarter"});case"QQQ":return t.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(n,{width:"wide",context:"formatting"})}},q:function(r,e,t){const n=Math.ceil((r.getMonth()+1)/3);switch(e){case"q":return String(n);case"qq":return rn(n,2);case"qo":return t.ordinalNumber(n,{unit:"quarter"});case"qqq":return t.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(n,{width:"wide",context:"standalone"})}},M:function(r,e,t){const n=r.getMonth();switch(e){case"M":case"MM":return Uc.M(r,e);case"Mo":return t.ordinalNumber(n+1,{unit:"month"});case"MMM":return t.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(n,{width:"wide",context:"formatting"})}},L:function(r,e,t){const n=r.getMonth();switch(e){case"L":return String(n+1);case"LL":return rn(n+1,2);case"Lo":return t.ordinalNumber(n+1,{unit:"month"});case"LLL":return t.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(n,{width:"wide",context:"standalone"})}},w:function(r,e,t,n){const s=_T(r,n);return e==="wo"?t.ordinalNumber(s,{unit:"week"}):rn(s,e.length)},I:function(r,e,t){const n=xT(r);return e==="Io"?t.ordinalNumber(n,{unit:"week"}):rn(n,e.length)},d:function(r,e,t){return e==="do"?t.ordinalNumber(r.getDate(),{unit:"date"}):Uc.d(r,e)},D:function(r,e,t){const n=D8(r);return e==="Do"?t.ordinalNumber(n,{unit:"dayOfYear"}):rn(n,e.length)},E:function(r,e,t){const n=r.getDay();switch(e){case"E":case"EE":case"EEE":return t.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(n,{width:"short",context:"formatting"});case"EEEE":default:return t.day(n,{width:"wide",context:"formatting"})}},e:function(r,e,t,n){const s=r.getDay(),i=(s-n.weekStartsOn+8)%7||7;switch(e){case"e":return String(i);case"ee":return rn(i,2);case"eo":return t.ordinalNumber(i,{unit:"day"});case"eee":return t.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(s,{width:"short",context:"formatting"});case"eeee":default:return t.day(s,{width:"wide",context:"formatting"})}},c:function(r,e,t,n){const s=r.getDay(),i=(s-n.weekStartsOn+8)%7||7;switch(e){case"c":return String(i);case"cc":return rn(i,e.length);case"co":return t.ordinalNumber(i,{unit:"day"});case"ccc":return t.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(s,{width:"narrow",context:"standalone"});case"cccccc":return t.day(s,{width:"short",context:"standalone"});case"cccc":default:return t.day(s,{width:"wide",context:"standalone"})}},i:function(r,e,t){const n=r.getDay(),s=n===0?7:n;switch(e){case"i":return String(s);case"ii":return rn(s,e.length);case"io":return t.ordinalNumber(s,{unit:"day"});case"iii":return t.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(n,{width:"short",context:"formatting"});case"iiii":default:return t.day(n,{width:"wide",context:"formatting"})}},a:function(r,e,t){const s=r.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(r,e,t){const n=r.getHours();let s;switch(n===12?s=uu.noon:n===0?s=uu.midnight:s=n/12>=1?"pm":"am",e){case"b":case"bb":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(r,e,t){const n=r.getHours();let s;switch(n>=17?s=uu.evening:n>=12?s=uu.afternoon:n>=4?s=uu.morning:s=uu.night,e){case"B":case"BB":case"BBB":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(r,e,t){if(e==="ho"){let n=r.getHours()%12;return n===0&&(n=12),t.ordinalNumber(n,{unit:"hour"})}return Uc.h(r,e)},H:function(r,e,t){return e==="Ho"?t.ordinalNumber(r.getHours(),{unit:"hour"}):Uc.H(r,e)},K:function(r,e,t){const n=r.getHours()%12;return e==="Ko"?t.ordinalNumber(n,{unit:"hour"}):rn(n,e.length)},k:function(r,e,t){let n=r.getHours();return n===0&&(n=24),e==="ko"?t.ordinalNumber(n,{unit:"hour"}):rn(n,e.length)},m:function(r,e,t){return e==="mo"?t.ordinalNumber(r.getMinutes(),{unit:"minute"}):Uc.m(r,e)},s:function(r,e,t){return e==="so"?t.ordinalNumber(r.getSeconds(),{unit:"second"}):Uc.s(r,e)},S:function(r,e){return Uc.S(r,e)},X:function(r,e,t){const n=r.getTimezoneOffset();if(n===0)return"Z";switch(e){case"X":return C5(n);case"XXXX":case"XX":return rd(n);case"XXXXX":case"XXX":default:return rd(n,":")}},x:function(r,e,t){const n=r.getTimezoneOffset();switch(e){case"x":return C5(n);case"xxxx":case"xx":return rd(n);case"xxxxx":case"xxx":default:return rd(n,":")}},O:function(r,e,t){const n=r.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+B5(n,":");case"OOOO":default:return"GMT"+rd(n,":")}},z:function(r,e,t){const n=r.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+B5(n,":");case"zzzz":default:return"GMT"+rd(n,":")}},t:function(r,e,t){const n=Math.trunc(+r/1e3);return rn(n,e.length)},T:function(r,e,t){return rn(+r,e.length)}};function B5(r,e=""){const t=r>0?"-":"+",n=Math.abs(r),s=Math.trunc(n/60),i=n%60;return i===0?t+String(s):t+String(s)+e+rn(i,2)}function C5(r,e){return r%60===0?(r>0?"-":"+")+rn(Math.abs(r)/60,2):rd(r,e)}function rd(r,e=""){const t=r>0?"-":"+",n=Math.abs(r),s=rn(Math.trunc(n/60),2),i=rn(n%60,2);return t+s+e+i}const S5=(r,e)=>{switch(r){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},BT=(r,e)=>{switch(r){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},O8=(r,e)=>{const t=r.match(/(P+)(p+)?/)||[],n=t[1],s=t[2];if(!s)return S5(r,e);let i;switch(n){case"P":i=e.dateTime({width:"short"});break;case"PP":i=e.dateTime({width:"medium"});break;case"PPP":i=e.dateTime({width:"long"});break;case"PPPP":default:i=e.dateTime({width:"full"});break}return i.replace("{{date}}",S5(n,e)).replace("{{time}}",BT(s,e))},Ov={p:BT,P:O8},Q8=/^D+$/,H8=/^Y+$/,j8=["D","DD","YY","YYYY"];function CT(r){return Q8.test(r)}function ST(r){return H8.test(r)}function Qv(r,e,t){const n=V8(r,e,t);if(console.warn(n),j8.includes(r))throw new RangeError(n)}function V8(r,e,t){const n=r[0]==="Y"?"years":"days of the month";return`Use \`${r.toLowerCase()}\` instead of \`${r}\` (in \`${e}\`) for formatting ${n} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const $8=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,G8=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,z8=/^'([^]*?)'?$/,K8=/''/g,q8=/[a-zA-Z]/;function W8(r,e,t){var A,d,h,u,p,f,g,m;const n=Kd(),s=(t==null?void 0:t.locale)??n.locale??vT,i=(t==null?void 0:t.firstWeekContainsDate)??((d=(A=t==null?void 0:t.locale)==null?void 0:A.options)==null?void 0:d.firstWeekContainsDate)??n.firstWeekContainsDate??((u=(h=n.locale)==null?void 0:h.options)==null?void 0:u.firstWeekContainsDate)??1,a=(t==null?void 0:t.weekStartsOn)??((f=(p=t==null?void 0:t.locale)==null?void 0:p.options)==null?void 0:f.weekStartsOn)??n.weekStartsOn??((m=(g=n.locale)==null?void 0:g.options)==null?void 0:m.weekStartsOn)??0,o=lr(r,t==null?void 0:t.in);if(!gT(o))throw new RangeError("Invalid time value");let l=e.match(G8).map(x=>{const S=x[0];if(S==="p"||S==="P"){const B=Ov[S];return B(x,s.formatLong)}return x}).join("").match($8).map(x=>{if(x==="''")return{isToken:!1,value:"'"};const S=x[0];if(S==="'")return{isToken:!1,value:Y8(x)};if(_5[S])return{isToken:!0,value:x};if(S.match(q8))throw new RangeError("Format string contains an unescaped latin alphabet character `"+S+"`");return{isToken:!1,value:x}});s.localize.preprocessor&&(l=s.localize.preprocessor(o,l));const c={firstWeekContainsDate:i,weekStartsOn:a,locale:s};return l.map(x=>{if(!x.isToken)return x.value;const S=x.value;(!(t!=null&&t.useProgressWeekYearTokens)&&ST(S)||!(t!=null&&t.useProgressDayOfYearTokens)&&CT(S))&&Qv(S,e,String(r));const B=_5[S[0]];return B(o,S,s.localize,c)}).join("")}function Y8(r){const e=r.match(z8);return e?e[1].replace(K8,"'"):r}function X8(){return Object.assign({},Kd())}function J8(r,e){const t=lr(r,e==null?void 0:e.in).getDay();return t===0?7:t}function Z8(r,e){const t=e7(e)?new e(0):Wn(e,0);return t.setFullYear(r.getFullYear(),r.getMonth(),r.getDate()),t.setHours(r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()),t}function e7(r){var e;return typeof r=="function"&&((e=r.prototype)==null?void 0:e.constructor)===r}const t7=10;class kT{constructor(){Fe(this,"subPriority",0)}validate(e,t){return!0}}class r7 extends kT{constructor(e,t,n,s,i){super(),this.value=e,this.validateValue=t,this.setValue=n,this.priority=s,i&&(this.subPriority=i)}validate(e,t){return this.validateValue(e,this.value,t)}set(e,t,n){return this.setValue(e,t,this.value,n)}}class n7 extends kT{constructor(t,n){super();Fe(this,"priority",t7);Fe(this,"subPriority",-1);this.context=t||(s=>Wn(n,s))}set(t,n){return n.timestampIsSet?t:Wn(t,Z8(t,this.context))}}let Kr=class{run(e,t,n,s){const i=this.parse(e,t,n,s);return i?{setter:new r7(i.value,this.validate,this.set,this.priority,this.subPriority),rest:i.rest}:null}validate(e,t,n){return!0}};class s7 extends Kr{constructor(){super(...arguments);Fe(this,"priority",140);Fe(this,"incompatibleTokens",["R","u","t","T"])}parse(t,n,s){switch(n){case"G":case"GG":case"GGG":return s.era(t,{width:"abbreviated"})||s.era(t,{width:"narrow"});case"GGGGG":return s.era(t,{width:"narrow"});case"GGGG":default:return s.era(t,{width:"wide"})||s.era(t,{width:"abbreviated"})||s.era(t,{width:"narrow"})}}set(t,n,s){return n.era=s,t.setFullYear(s,0,1),t.setHours(0,0,0,0),t}}const us={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},zo={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function hs(r,e){return r&&{value:e(r.value),rest:r.rest}}function Dn(r,e){const t=e.match(r);return t?{value:parseInt(t[0],10),rest:e.slice(t[0].length)}:null}function Ko(r,e){const t=e.match(r);if(!t)return null;if(t[0]==="Z")return{value:0,rest:e.slice(1)};const n=t[1]==="+"?1:-1,s=t[2]?parseInt(t[2],10):0,i=t[3]?parseInt(t[3],10):0,a=t[5]?parseInt(t[5],10):0;return{value:n*(s*Rg+i*Dg+a*LQ),rest:e.slice(t[0].length)}}function ET(r){return Dn(us.anyDigitsSigned,r)}function Yn(r,e){switch(r){case 1:return Dn(us.singleDigit,e);case 2:return Dn(us.twoDigits,e);case 3:return Dn(us.threeDigits,e);case 4:return Dn(us.fourDigits,e);default:return Dn(new RegExp("^\\d{1,"+r+"}"),e)}}function Qm(r,e){switch(r){case 1:return Dn(us.singleDigitSigned,e);case 2:return Dn(us.twoDigitsSigned,e);case 3:return Dn(us.threeDigitsSigned,e);case 4:return Dn(us.fourDigitsSigned,e);default:return Dn(new RegExp("^-?\\d{1,"+r+"}"),e)}}function Ox(r){switch(r){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function IT(r,e){const t=e>0,n=t?e:1-e;let s;if(n<=50)s=r||100;else{const i=n+50,a=Math.trunc(i/100)*100,o=r>=i%100;s=r+a-(o?100:0)}return t?s:1-s}function TT(r){return r%400===0||r%4===0&&r%100!==0}class i7 extends Kr{constructor(){super(...arguments);Fe(this,"priority",130);Fe(this,"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"])}parse(t,n,s){const i=a=>({year:a,isTwoDigitYear:n==="yy"});switch(n){case"y":return hs(Yn(4,t),i);case"yo":return hs(s.ordinalNumber(t,{unit:"year"}),i);default:return hs(Yn(n.length,t),i)}}validate(t,n){return n.isTwoDigitYear||n.year>0}set(t,n,s){const i=t.getFullYear();if(s.isTwoDigitYear){const o=IT(s.year,i);return t.setFullYear(o,0,1),t.setHours(0,0,0,0),t}const a=!("era"in n)||n.era===1?s.year:1-s.year;return t.setFullYear(a,0,1),t.setHours(0,0,0,0),t}}class a7 extends Kr{constructor(){super(...arguments);Fe(this,"priority",130);Fe(this,"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"])}parse(t,n,s){const i=a=>({year:a,isTwoDigitYear:n==="YY"});switch(n){case"Y":return hs(Yn(4,t),i);case"Yo":return hs(s.ordinalNumber(t,{unit:"year"}),i);default:return hs(Yn(n.length,t),i)}}validate(t,n){return n.isTwoDigitYear||n.year>0}set(t,n,s,i){const a=Rx(t,i);if(s.isTwoDigitYear){const l=IT(s.year,a);return t.setFullYear(l,0,i.firstWeekContainsDate),t.setHours(0,0,0,0),ll(t,i)}const o=!("era"in n)||n.era===1?s.year:1-s.year;return t.setFullYear(o,0,i.firstWeekContainsDate),t.setHours(0,0,0,0),ll(t,i)}}class o7 extends Kr{constructor(){super(...arguments);Fe(this,"priority",130);Fe(this,"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"])}parse(t,n){return Qm(n==="R"?4:n.length,t)}set(t,n,s){const i=Wn(t,0);return i.setFullYear(s,0,4),i.setHours(0,0,0,0),sh(i)}}class l7 extends Kr{constructor(){super(...arguments);Fe(this,"priority",130);Fe(this,"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"])}parse(t,n){return Qm(n==="u"?4:n.length,t)}set(t,n,s){return t.setFullYear(s,0,1),t.setHours(0,0,0,0),t}}class c7 extends Kr{constructor(){super(...arguments);Fe(this,"priority",120);Fe(this,"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"])}parse(t,n,s){switch(n){case"Q":case"QQ":return Yn(n.length,t);case"Qo":return s.ordinalNumber(t,{unit:"quarter"});case"QQQ":return s.quarter(t,{width:"abbreviated",context:"formatting"})||s.quarter(t,{width:"narrow",context:"formatting"});case"QQQQQ":return s.quarter(t,{width:"narrow",context:"formatting"});case"QQQQ":default:return s.quarter(t,{width:"wide",context:"formatting"})||s.quarter(t,{width:"abbreviated",context:"formatting"})||s.quarter(t,{width:"narrow",context:"formatting"})}}validate(t,n){return n>=1&&n<=4}set(t,n,s){return t.setMonth((s-1)*3,1),t.setHours(0,0,0,0),t}}class A7 extends Kr{constructor(){super(...arguments);Fe(this,"priority",120);Fe(this,"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"])}parse(t,n,s){switch(n){case"q":case"qq":return Yn(n.length,t);case"qo":return s.ordinalNumber(t,{unit:"quarter"});case"qqq":return s.quarter(t,{width:"abbreviated",context:"standalone"})||s.quarter(t,{width:"narrow",context:"standalone"});case"qqqqq":return s.quarter(t,{width:"narrow",context:"standalone"});case"qqqq":default:return s.quarter(t,{width:"wide",context:"standalone"})||s.quarter(t,{width:"abbreviated",context:"standalone"})||s.quarter(t,{width:"narrow",context:"standalone"})}}validate(t,n){return n>=1&&n<=4}set(t,n,s){return t.setMonth((s-1)*3,1),t.setHours(0,0,0,0),t}}class d7 extends Kr{constructor(){super(...arguments);Fe(this,"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]);Fe(this,"priority",110)}parse(t,n,s){const i=a=>a-1;switch(n){case"M":return hs(Dn(us.month,t),i);case"MM":return hs(Yn(2,t),i);case"Mo":return hs(s.ordinalNumber(t,{unit:"month"}),i);case"MMM":return s.month(t,{width:"abbreviated",context:"formatting"})||s.month(t,{width:"narrow",context:"formatting"});case"MMMMM":return s.month(t,{width:"narrow",context:"formatting"});case"MMMM":default:return s.month(t,{width:"wide",context:"formatting"})||s.month(t,{width:"abbreviated",context:"formatting"})||s.month(t,{width:"narrow",context:"formatting"})}}validate(t,n){return n>=0&&n<=11}set(t,n,s){return t.setMonth(s,1),t.setHours(0,0,0,0),t}}class u7 extends Kr{constructor(){super(...arguments);Fe(this,"priority",110);Fe(this,"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"])}parse(t,n,s){const i=a=>a-1;switch(n){case"L":return hs(Dn(us.month,t),i);case"LL":return hs(Yn(2,t),i);case"Lo":return hs(s.ordinalNumber(t,{unit:"month"}),i);case"LLL":return s.month(t,{width:"abbreviated",context:"standalone"})||s.month(t,{width:"narrow",context:"standalone"});case"LLLLL":return s.month(t,{width:"narrow",context:"standalone"});case"LLLL":default:return s.month(t,{width:"wide",context:"standalone"})||s.month(t,{width:"abbreviated",context:"standalone"})||s.month(t,{width:"narrow",context:"standalone"})}}validate(t,n){return n>=0&&n<=11}set(t,n,s){return t.setMonth(s,1),t.setHours(0,0,0,0),t}}function h7(r,e,t){const n=lr(r,t==null?void 0:t.in),s=_T(n,t)-e;return n.setDate(n.getDate()-s*7),lr(n,t==null?void 0:t.in)}class f7 extends Kr{constructor(){super(...arguments);Fe(this,"priority",100);Fe(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"])}parse(t,n,s){switch(n){case"w":return Dn(us.week,t);case"wo":return s.ordinalNumber(t,{unit:"week"});default:return Yn(n.length,t)}}validate(t,n){return n>=1&&n<=53}set(t,n,s,i){return ll(h7(t,s,i),i)}}function g7(r,e,t){const n=lr(r,t==null?void 0:t.in),s=xT(n,t)-e;return n.setDate(n.getDate()-s*7),n}class p7 extends Kr{constructor(){super(...arguments);Fe(this,"priority",100);Fe(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"])}parse(t,n,s){switch(n){case"I":return Dn(us.week,t);case"Io":return s.ordinalNumber(t,{unit:"week"});default:return Yn(n.length,t)}}validate(t,n){return n>=1&&n<=53}set(t,n,s){return sh(g7(t,s))}}const m7=[31,28,31,30,31,30,31,31,30,31,30,31],b7=[31,29,31,30,31,30,31,31,30,31,30,31];class y7 extends Kr{constructor(){super(...arguments);Fe(this,"priority",90);Fe(this,"subPriority",1);Fe(this,"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"])}parse(t,n,s){switch(n){case"d":return Dn(us.date,t);case"do":return s.ordinalNumber(t,{unit:"date"});default:return Yn(n.length,t)}}validate(t,n){const s=t.getFullYear(),i=TT(s),a=t.getMonth();return i?n>=1&&n<=b7[a]:n>=1&&n<=m7[a]}set(t,n,s){return t.setDate(s),t.setHours(0,0,0,0),t}}class w7 extends Kr{constructor(){super(...arguments);Fe(this,"priority",90);Fe(this,"subpriority",1);Fe(this,"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"])}parse(t,n,s){switch(n){case"D":case"DD":return Dn(us.dayOfYear,t);case"Do":return s.ordinalNumber(t,{unit:"date"});default:return Yn(n.length,t)}}validate(t,n){const s=t.getFullYear();return TT(s)?n>=1&&n<=366:n>=1&&n<=365}set(t,n,s){return t.setMonth(0,s),t.setHours(0,0,0,0),t}}function Qx(r,e,t){var d,h,u,p;const n=Kd(),s=(t==null?void 0:t.weekStartsOn)??((h=(d=t==null?void 0:t.locale)==null?void 0:d.options)==null?void 0:h.weekStartsOn)??n.weekStartsOn??((p=(u=n.locale)==null?void 0:u.options)==null?void 0:p.weekStartsOn)??0,i=lr(r,t==null?void 0:t.in),a=i.getDay(),l=(e%7+7)%7,c=7-s,A=e<0||e>6?e-(a+c)%7:(l+c)%7-(a+c)%7;return Nb(i,A,t)}class v7 extends Kr{constructor(){super(...arguments);Fe(this,"priority",90);Fe(this,"incompatibleTokens",["D","i","e","c","t","T"])}parse(t,n,s){switch(n){case"E":case"EE":case"EEE":return s.day(t,{width:"abbreviated",context:"formatting"})||s.day(t,{width:"short",context:"formatting"})||s.day(t,{width:"narrow",context:"formatting"});case"EEEEE":return s.day(t,{width:"narrow",context:"formatting"});case"EEEEEE":return s.day(t,{width:"short",context:"formatting"})||s.day(t,{width:"narrow",context:"formatting"});case"EEEE":default:return s.day(t,{width:"wide",context:"formatting"})||s.day(t,{width:"abbreviated",context:"formatting"})||s.day(t,{width:"short",context:"formatting"})||s.day(t,{width:"narrow",context:"formatting"})}}validate(t,n){return n>=0&&n<=6}set(t,n,s,i){return t=Qx(t,s,i),t.setHours(0,0,0,0),t}}class x7 extends Kr{constructor(){super(...arguments);Fe(this,"priority",90);Fe(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"])}parse(t,n,s,i){const a=o=>{const l=Math.floor((o-1)/7)*7;return(o+i.weekStartsOn+6)%7+l};switch(n){case"e":case"ee":return hs(Yn(n.length,t),a);case"eo":return hs(s.ordinalNumber(t,{unit:"day"}),a);case"eee":return s.day(t,{width:"abbreviated",context:"formatting"})||s.day(t,{width:"short",context:"formatting"})||s.day(t,{width:"narrow",context:"formatting"});case"eeeee":return s.day(t,{width:"narrow",context:"formatting"});case"eeeeee":return s.day(t,{width:"short",context:"formatting"})||s.day(t,{width:"narrow",context:"formatting"});case"eeee":default:return s.day(t,{width:"wide",context:"formatting"})||s.day(t,{width:"abbreviated",context:"formatting"})||s.day(t,{width:"short",context:"formatting"})||s.day(t,{width:"narrow",context:"formatting"})}}validate(t,n){return n>=0&&n<=6}set(t,n,s,i){return t=Qx(t,s,i),t.setHours(0,0,0,0),t}}class _7 extends Kr{constructor(){super(...arguments);Fe(this,"priority",90);Fe(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"])}parse(t,n,s,i){const a=o=>{const l=Math.floor((o-1)/7)*7;return(o+i.weekStartsOn+6)%7+l};switch(n){case"c":case"cc":return hs(Yn(n.length,t),a);case"co":return hs(s.ordinalNumber(t,{unit:"day"}),a);case"ccc":return s.day(t,{width:"abbreviated",context:"standalone"})||s.day(t,{width:"short",context:"standalone"})||s.day(t,{width:"narrow",context:"standalone"});case"ccccc":return s.day(t,{width:"narrow",context:"standalone"});case"cccccc":return s.day(t,{width:"short",context:"standalone"})||s.day(t,{width:"narrow",context:"standalone"});case"cccc":default:return s.day(t,{width:"wide",context:"standalone"})||s.day(t,{width:"abbreviated",context:"standalone"})||s.day(t,{width:"short",context:"standalone"})||s.day(t,{width:"narrow",context:"standalone"})}}validate(t,n){return n>=0&&n<=6}set(t,n,s,i){return t=Qx(t,s,i),t.setHours(0,0,0,0),t}}function B7(r,e,t){const n=lr(r,t==null?void 0:t.in),s=J8(n,t),i=e-s;return Nb(n,i,t)}class C7 extends Kr{constructor(){super(...arguments);Fe(this,"priority",90);Fe(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"])}parse(t,n,s){const i=a=>a===0?7:a;switch(n){case"i":case"ii":return Yn(n.length,t);case"io":return s.ordinalNumber(t,{unit:"day"});case"iii":return hs(s.day(t,{width:"abbreviated",context:"formatting"})||s.day(t,{width:"short",context:"formatting"})||s.day(t,{width:"narrow",context:"formatting"}),i);case"iiiii":return hs(s.day(t,{width:"narrow",context:"formatting"}),i);case"iiiiii":return hs(s.day(t,{width:"short",context:"formatting"})||s.day(t,{width:"narrow",context:"formatting"}),i);case"iiii":default:return hs(s.day(t,{width:"wide",context:"formatting"})||s.day(t,{width:"abbreviated",context:"formatting"})||s.day(t,{width:"short",context:"formatting"})||s.day(t,{width:"narrow",context:"formatting"}),i)}}validate(t,n){return n>=1&&n<=7}set(t,n,s){return t=B7(t,s),t.setHours(0,0,0,0),t}}class S7 extends Kr{constructor(){super(...arguments);Fe(this,"priority",80);Fe(this,"incompatibleTokens",["b","B","H","k","t","T"])}parse(t,n,s){switch(n){case"a":case"aa":case"aaa":return s.dayPeriod(t,{width:"abbreviated",context:"formatting"})||s.dayPeriod(t,{width:"narrow",context:"formatting"});case"aaaaa":return s.dayPeriod(t,{width:"narrow",context:"formatting"});case"aaaa":default:return s.dayPeriod(t,{width:"wide",context:"formatting"})||s.dayPeriod(t,{width:"abbreviated",context:"formatting"})||s.dayPeriod(t,{width:"narrow",context:"formatting"})}}set(t,n,s){return t.setHours(Ox(s),0,0,0),t}}class k7 extends Kr{constructor(){super(...arguments);Fe(this,"priority",80);Fe(this,"incompatibleTokens",["a","B","H","k","t","T"])}parse(t,n,s){switch(n){case"b":case"bb":case"bbb":return s.dayPeriod(t,{width:"abbreviated",context:"formatting"})||s.dayPeriod(t,{width:"narrow",context:"formatting"});case"bbbbb":return s.dayPeriod(t,{width:"narrow",context:"formatting"});case"bbbb":default:return s.dayPeriod(t,{width:"wide",context:"formatting"})||s.dayPeriod(t,{width:"abbreviated",context:"formatting"})||s.dayPeriod(t,{width:"narrow",context:"formatting"})}}set(t,n,s){return t.setHours(Ox(s),0,0,0),t}}class E7 extends Kr{constructor(){super(...arguments);Fe(this,"priority",80);Fe(this,"incompatibleTokens",["a","b","t","T"])}parse(t,n,s){switch(n){case"B":case"BB":case"BBB":return s.dayPeriod(t,{width:"abbreviated",context:"formatting"})||s.dayPeriod(t,{width:"narrow",context:"formatting"});case"BBBBB":return s.dayPeriod(t,{width:"narrow",context:"formatting"});case"BBBB":default:return s.dayPeriod(t,{width:"wide",context:"formatting"})||s.dayPeriod(t,{width:"abbreviated",context:"formatting"})||s.dayPeriod(t,{width:"narrow",context:"formatting"})}}set(t,n,s){return t.setHours(Ox(s),0,0,0),t}}class I7 extends Kr{constructor(){super(...arguments);Fe(this,"priority",70);Fe(this,"incompatibleTokens",["H","K","k","t","T"])}parse(t,n,s){switch(n){case"h":return Dn(us.hour12h,t);case"ho":return s.ordinalNumber(t,{unit:"hour"});default:return Yn(n.length,t)}}validate(t,n){return n>=1&&n<=12}set(t,n,s){const i=t.getHours()>=12;return i&&s<12?t.setHours(s+12,0,0,0):!i&&s===12?t.setHours(0,0,0,0):t.setHours(s,0,0,0),t}}class T7 extends Kr{constructor(){super(...arguments);Fe(this,"priority",70);Fe(this,"incompatibleTokens",["a","b","h","K","k","t","T"])}parse(t,n,s){switch(n){case"H":return Dn(us.hour23h,t);case"Ho":return s.ordinalNumber(t,{unit:"hour"});default:return Yn(n.length,t)}}validate(t,n){return n>=0&&n<=23}set(t,n,s){return t.setHours(s,0,0,0),t}}class F7 extends Kr{constructor(){super(...arguments);Fe(this,"priority",70);Fe(this,"incompatibleTokens",["h","H","k","t","T"])}parse(t,n,s){switch(n){case"K":return Dn(us.hour11h,t);case"Ko":return s.ordinalNumber(t,{unit:"hour"});default:return Yn(n.length,t)}}validate(t,n){return n>=0&&n<=11}set(t,n,s){return t.getHours()>=12&&s<12?t.setHours(s+12,0,0,0):t.setHours(s,0,0,0),t}}class L7 extends Kr{constructor(){super(...arguments);Fe(this,"priority",70);Fe(this,"incompatibleTokens",["a","b","h","H","K","t","T"])}parse(t,n,s){switch(n){case"k":return Dn(us.hour24h,t);case"ko":return s.ordinalNumber(t,{unit:"hour"});default:return Yn(n.length,t)}}validate(t,n){return n>=1&&n<=24}set(t,n,s){const i=s<=24?s%24:s;return t.setHours(i,0,0,0),t}}class U7 extends Kr{constructor(){super(...arguments);Fe(this,"priority",60);Fe(this,"incompatibleTokens",["t","T"])}parse(t,n,s){switch(n){case"m":return Dn(us.minute,t);case"mo":return s.ordinalNumber(t,{unit:"minute"});default:return Yn(n.length,t)}}validate(t,n){return n>=0&&n<=59}set(t,n,s){return t.setMinutes(s,0,0),t}}class M7 extends Kr{constructor(){super(...arguments);Fe(this,"priority",50);Fe(this,"incompatibleTokens",["t","T"])}parse(t,n,s){switch(n){case"s":return Dn(us.second,t);case"so":return s.ordinalNumber(t,{unit:"second"});default:return Yn(n.length,t)}}validate(t,n){return n>=0&&n<=59}set(t,n,s){return t.setSeconds(s,0),t}}class N7 extends Kr{constructor(){super(...arguments);Fe(this,"priority",30);Fe(this,"incompatibleTokens",["t","T"])}parse(t,n){const s=i=>Math.trunc(i*Math.pow(10,-n.length+3));return hs(Yn(n.length,t),s)}set(t,n,s){return t.setMilliseconds(s),t}}class P7 extends Kr{constructor(){super(...arguments);Fe(this,"priority",10);Fe(this,"incompatibleTokens",["t","T","x"])}parse(t,n){switch(n){case"X":return Ko(zo.basicOptionalMinutes,t);case"XX":return Ko(zo.basic,t);case"XXXX":return Ko(zo.basicOptionalSeconds,t);case"XXXXX":return Ko(zo.extendedOptionalSeconds,t);case"XXX":default:return Ko(zo.extended,t)}}set(t,n,s){return n.timestampIsSet?t:Wn(t,t.getTime()-Om(t)-s)}}class D7 extends Kr{constructor(){super(...arguments);Fe(this,"priority",10);Fe(this,"incompatibleTokens",["t","T","X"])}parse(t,n){switch(n){case"x":return Ko(zo.basicOptionalMinutes,t);case"xx":return Ko(zo.basic,t);case"xxxx":return Ko(zo.basicOptionalSeconds,t);case"xxxxx":return Ko(zo.extendedOptionalSeconds,t);case"xxx":default:return Ko(zo.extended,t)}}set(t,n,s){return n.timestampIsSet?t:Wn(t,t.getTime()-Om(t)-s)}}class R7 extends Kr{constructor(){super(...arguments);Fe(this,"priority",40);Fe(this,"incompatibleTokens","*")}parse(t){return ET(t)}set(t,n,s){return[Wn(t,s*1e3),{timestampIsSet:!0}]}}class O7 extends Kr{constructor(){super(...arguments);Fe(this,"priority",20);Fe(this,"incompatibleTokens","*")}parse(t){return ET(t)}set(t,n,s){return[Wn(t,s),{timestampIsSet:!0}]}}const Q7={G:new s7,y:new i7,Y:new a7,R:new o7,u:new l7,Q:new c7,q:new A7,M:new d7,L:new u7,w:new f7,I:new p7,d:new y7,D:new w7,E:new v7,e:new x7,c:new _7,i:new C7,a:new S7,b:new k7,B:new E7,h:new I7,H:new T7,K:new F7,k:new L7,m:new U7,s:new M7,S:new N7,X:new P7,x:new D7,t:new R7,T:new O7},H7=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,j7=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,V7=/^'([^]*?)'?$/,$7=/''/g,G7=/\S/,z7=/[a-zA-Z]/;function K7(r,e,t,n){var g,m,x,S,B,F,N,E;const s=()=>Wn((n==null?void 0:n.in)||t,NaN),i=X8(),a=(n==null?void 0:n.locale)??i.locale??vT,o=(n==null?void 0:n.firstWeekContainsDate)??((m=(g=n==null?void 0:n.locale)==null?void 0:g.options)==null?void 0:m.firstWeekContainsDate)??i.firstWeekContainsDate??((S=(x=i.locale)==null?void 0:x.options)==null?void 0:S.firstWeekContainsDate)??1,l=(n==null?void 0:n.weekStartsOn)??((F=(B=n==null?void 0:n.locale)==null?void 0:B.options)==null?void 0:F.weekStartsOn)??i.weekStartsOn??((E=(N=i.locale)==null?void 0:N.options)==null?void 0:E.weekStartsOn)??0;if(!e)return r?s():lr(t,n==null?void 0:n.in);const c={firstWeekContainsDate:o,weekStartsOn:l,locale:a},A=[new n7(n==null?void 0:n.in,t)],d=e.match(j7).map(w=>{const v=w[0];if(v in Ov){const I=Ov[v];return I(w,a.formatLong)}return w}).join("").match(H7),h=[];for(let w of d){!(n!=null&&n.useProgressWeekYearTokens)&&ST(w)&&Qv(w,e,r),!(n!=null&&n.useProgressDayOfYearTokens)&&CT(w)&&Qv(w,e,r);const v=w[0],I=Q7[v];if(I){const{incompatibleTokens:k}=I;if(Array.isArray(k)){const T=h.find(L=>k.includes(L.token)||L.token===v);if(T)throw new RangeError(`The format string mustn't contain \`${T.fullToken}\` and \`${w}\` at the same time`)}else if(I.incompatibleTokens==="*"&&h.length>0)throw new RangeError(`The format string mustn't contain \`${w}\` and any other token at the same time`);h.push({token:v,fullToken:w});const _=I.run(r,w,a.match,c);if(!_)return s();A.push(_.setter),r=_.rest}else{if(v.match(z7))throw new RangeError("Format string contains an unescaped latin alphabet character `"+v+"`");if(w==="''"?w="'":v==="'"&&(w=q7(w)),r.indexOf(w)===0)r=r.slice(w.length);else return s()}}if(r.length>0&&G7.test(r))return s();const u=A.map(w=>w.priority).sort((w,v)=>v-w).filter((w,v,I)=>I.indexOf(w)===v).map(w=>A.filter(v=>v.priority===w).sort((v,I)=>I.subPriority-v.subPriority)).map(w=>w[0]);let p=lr(t,n==null?void 0:n.in);if(isNaN(+p))return s();const f={};for(const w of u){if(!w.validate(p,c))return s();const v=w.set(p,f,c);Array.isArray(v)?(p=v[0],Object.assign(f,v[1])):p=v}return p}function q7(r){return r.match(V7)[1].replace($7,"'")}function W7(r,e){const t=lr(r,e==null?void 0:e.in);return t.setMinutes(0,0,0),t}function Y7(r,e){const t=lr(r,e==null?void 0:e.in);return t.setSeconds(0,0),t}function X7(r,e){const t=lr(r,e==null?void 0:e.in);return t.setMilliseconds(0),t}function J7(r,e){const t=()=>Wn(e==null?void 0:e.in,NaN),n=(e==null?void 0:e.ProgressDigits)??2,s=rH(r);let i;if(s.date){const c=nH(s.date,n);i=sH(c.restDateString,c.year)}if(!i||isNaN(+i))return t();const a=+i;let o=0,l;if(s.time&&(o=iH(s.time),isNaN(o)))return t();if(s.timezone){if(l=aH(s.timezone),isNaN(l))return t()}else{const c=new Date(a+o),A=lr(0,e==null?void 0:e.in);return A.setFullYear(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate()),A.setHours(c.getUTCHours(),c.getUTCMinutes(),c.getUTCSeconds(),c.getUTCMilliseconds()),A}return lr(a+o+l,e==null?void 0:e.in)}const Kp={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},Z7=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,eH=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,tH=/^([+-])(\d{2})(?::?(\d{2}))?$/;function rH(r){const e={},t=r.split(Kp.dateTimeDelimiter);let n;if(t.length>2)return e;if(/:/.test(t[0])?n=t[0]:(e.date=t[0],n=t[1],Kp.timeZoneDelimiter.test(e.date)&&(e.date=r.split(Kp.timeZoneDelimiter)[0],n=r.substr(e.date.length,r.length))),n){const s=Kp.timezone.exec(n);s?(e.time=n.replace(s[1],""),e.timezone=s[1]):e.time=n}return e}function nH(r,e){const t=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+e)+"})|(\\d{2}|[+-]\\d{"+(2+e)+"})$)"),n=r.match(t);if(!n)return{year:NaN,restDateString:""};const s=n[1]?parseInt(n[1]):null,i=n[2]?parseInt(n[2]):null;return{year:i===null?s:i*100,restDateString:r.slice((n[1]||n[2]).length)}}function sH(r,e){if(e===null)return new Date(NaN);const t=r.match(Z7);if(!t)return new Date(NaN);const n=!!t[4],s=tf(t[1]),i=tf(t[2])-1,a=tf(t[3]),o=tf(t[4]),l=tf(t[5])-1;if(n)return dH(e,o,l)?oH(e,o,l):new Date(NaN);{const c=new Date(0);return!cH(e,i,a)||!AH(e,s)?new Date(NaN):(c.setUTCFullYear(e,i,Math.max(s,a)),c)}}function tf(r){return r?parseInt(r):1}function iH(r){const e=r.match(eH);if(!e)return NaN;const t=rw(e[1]),n=rw(e[2]),s=rw(e[3]);return uH(t,n,s)?t*Rg+n*Dg+s*1e3:NaN}function rw(r){return r&&parseFloat(r.replace(",","."))||0}function aH(r){if(r==="Z")return 0;const e=r.match(tH);if(!e)return 0;const t=e[1]==="+"?-1:1,n=parseInt(e[2]),s=e[3]&&parseInt(e[3])||0;return hH(n,s)?t*(n*Rg+s*Dg):NaN}function oH(r,e,t){const n=new Date(0);n.setUTCFullYear(r,0,4);const s=n.getUTCDay()||7,i=(e-1)*7+t+1-s;return n.setUTCDate(n.getUTCDate()+i),n}const lH=[31,null,31,30,31,30,31,31,30,31,30,31];function FT(r){return r%400===0||r%4===0&&r%100!==0}function cH(r,e,t){return e>=0&&e<=11&&t>=1&&t<=(lH[e]||(FT(r)?29:28))}function AH(r,e){return e>=1&&e<=(FT(r)?366:365)}function dH(r,e,t){return e>=1&&e<=53&&t>=0&&t<=6}function uH(r,e,t){return r===24?e===0&&t===0:t>=0&&t<60&&e>=0&&e<60&&r>=0&&r<25}function hH(r,e){return e>=0&&e<=59}/*!
 * chartjs-adapter-date-fns v3.0.0
 * https://www.chartjs.org
 * (c) 2022 chartjs-adapter-date-fns Contributors
 * Released under the MIT license
 */const fH={datetime:"MMM d, yyyy, h:mm:ss aaaa",millisecond:"h:mm:ss.SSS aaaa",second:"h:mm:ss aaaa",minute:"h:mm aaaa",hour:"ha",day:"MMM d",week:"PP",month:"MMM yyyy",quarter:"qqq - yyyy",year:"yyyy"};$I._date.override({_id:"date-fns",formats:function(){return fH},parse:function(r,e){if(r===null||typeof r>"u")return null;const t=typeof r;return t==="number"||r instanceof Date?r=lr(r):t==="string"&&(typeof e=="string"?r=K7(r,e,new Date,this.options):r=J7(r,this.options)),gT(r)?r.getTime():null},format:function(r,e){return W8(r,e,this.options)},add:function(r,e,t){switch(t){case"millisecond":return Px(r,e);case"second":return RQ(r,e);case"minute":return PQ(r,e);case"hour":return UQ(r,e);case"day":return Nb(r,e);case"week":return OQ(r,e);case"month":return Nx(r,e);case"quarter":return DQ(r,e);case"year":return QQ(r,e);default:return r}},diff:function(r,e,t){switch(t){case"millisecond":return Dx(r,e);case"second":return qQ(r,e);case"minute":return GQ(r,e);case"hour":return $Q(r,e);case"day":return pT(r,e);case"week":return WQ(r,e);case"month":return yT(r,e);case"quarter":return KQ(r,e);case"year":return YQ(r,e);default:return 0}},startOf:function(r,e,t){switch(e){case"second":return X7(r);case"minute":return Y7(r);case"hour":return W7(r);case"day":return Rv(r);case"week":return ll(r);case"isoWeek":return ll(r,{weekStartsOn:+t});case"month":return JQ(r);case"quarter":return XQ(r);case"year":return wT(r);default:return r}},endOf:function(r,e){switch(e){case"second":return s8(r);case"minute":return r8(r);case"hour":return e8(r);case"day":return mT(r);case"week":return t8(r);case"month":return bT(r);case"quarter":return n8(r);case"year":return ZQ(r);default:return r}}});/*!
 * chartjs-plugin-datalabels v2.2.0
 * https://chartjs-plugin-datalabels.netlify.app
 * (c) 2017-2022 chartjs-plugin-datalabels contributors
 * Released under the MIT license
 */var k5=(function(){if(typeof window<"u"){if(window.devicePixelRatio)return window.devicePixelRatio;var r=window.screen;if(r)return(r.deviceXDPI||1)/(r.logicalXDPI||1)}return 1})(),Hf={toTextLines:function(r){var e=[],t;for(r=[].concat(r);r.length;)t=r.pop(),typeof t=="string"?e.unshift.apply(e,t.split(`
`)):Array.isArray(t)?r.push.apply(r,t):pr(r)||e.unshift(""+t);return e},textSize:function(r,e,t){var n=[].concat(e),s=n.length,i=r.font,a=0,o;for(r.font=t.string,o=0;o<s;++o)a=Math.max(r.measureText(n[o]).width,a);return r.font=i,{height:s*t.lineHeight,width:a}},bound:function(r,e,t){return Math.max(r,Math.min(e,t))},arrayDiff:function(r,e){var t=r.slice(),n=[],s,i,a,o;for(s=0,a=e.length;s<a;++s)o=e[s],i=t.indexOf(o),i===-1?n.push([o,1]):t.splice(i,1);for(s=0,a=t.length;s<a;++s)n.push([t[s],-1]);return n},rasterize:function(r){return Math.round(r*k5)/k5}};function nw(r,e){var t=e.x,n=e.y;if(t===null)return{x:0,y:-1};if(n===null)return{x:1,y:0};var s=r.x-t,i=r.y-n,a=Math.sqrt(s*s+i*i);return{x:a?s/a:0,y:a?i/a:-1}}function gH(r,e,t,n,s){switch(s){case"center":t=n=0;break;case"bottom":t=0,n=1;break;case"right":t=1,n=0;break;case"left":t=-1,n=0;break;case"top":t=0,n=-1;break;case"start":t=-t,n=-n;break;case"end":break;default:s*=Math.PI/180,t=Math.cos(s),n=Math.sin(s);break}return{x:r,y:e,vx:t,vy:n}}var pH=0,LT=1,UT=2,MT=4,NT=8;function qp(r,e,t){var n=pH;return r<t.left?n|=LT:r>t.right&&(n|=UT),e<t.top?n|=NT:e>t.bottom&&(n|=MT),n}function mH(r,e){for(var t=r.x0,n=r.y0,s=r.x1,i=r.y1,a=qp(t,n,e),o=qp(s,i,e),l,c,A;!(!(a|o)||a&o);)l=a||o,l&NT?(c=t+(s-t)*(e.top-n)/(i-n),A=e.top):l&MT?(c=t+(s-t)*(e.bottom-n)/(i-n),A=e.bottom):l&UT?(A=n+(i-n)*(e.right-t)/(s-t),c=e.right):l&LT&&(A=n+(i-n)*(e.left-t)/(s-t),c=e.left),l===a?(t=c,n=A,a=qp(t,n,e)):(s=c,i=A,o=qp(s,i,e));return{x0:t,x1:s,y0:n,y1:i}}function Wp(r,e){var t=e.anchor,n=r,s,i;return e.clamp&&(n=mH(n,e.area)),t==="start"?(s=n.x0,i=n.y0):t==="end"?(s=n.x1,i=n.y1):(s=(n.x0+n.x1)/2,i=(n.y0+n.y1)/2),gH(s,i,r.vx,r.vy,e.align)}var Yp={arc:function(r,e){var t=(r.startAngle+r.endAngle)/2,n=Math.cos(t),s=Math.sin(t),i=r.innerRadius,a=r.outerRadius;return Wp({x0:r.x+n*i,y0:r.y+s*i,x1:r.x+n*a,y1:r.y+s*a,vx:n,vy:s},e)},point:function(r,e){var t=nw(r,e.origin),n=t.x*r.options.radius,s=t.y*r.options.radius;return Wp({x0:r.x-n,y0:r.y-s,x1:r.x+n,y1:r.y+s,vx:t.x,vy:t.y},e)},bar:function(r,e){var t=nw(r,e.origin),n=r.x,s=r.y,i=0,a=0;return r.horizontal?(n=Math.min(r.x,r.base),i=Math.abs(r.base-r.x)):(s=Math.min(r.y,r.base),a=Math.abs(r.base-r.y)),Wp({x0:n,y0:s+a,x1:n+i,y1:s,vx:t.x,vy:t.y},e)},fallback:function(r,e){var t=nw(r,e.origin);return Wp({x0:r.x,y0:r.y,x1:r.x+(r.width||0),y1:r.y+(r.height||0),vx:t.x,vy:t.y},e)}},jl=Hf.rasterize;function bH(r){var e=r.borderWidth||0,t=r.padding,n=r.size.height,s=r.size.width,i=-s/2,a=-n/2;return{frame:{x:i-t.left-e,y:a-t.top-e,w:s+t.width+e*2,h:n+t.height+e*2},text:{x:i,y:a,w:s,h:n}}}function yH(r,e){var t=e.chart.getDatasetMeta(e.datasetIndex).vScale;if(!t)return null;if(t.xCenter!==void 0&&t.yCenter!==void 0)return{x:t.xCenter,y:t.yCenter};var n=t.getBasePixel();return r.horizontal?{x:n,y:null}:{x:null,y:n}}function wH(r){return r instanceof Lu?Yp.arc:r instanceof Rf?Yp.point:r instanceof Of?Yp.bar:Yp.fallback}function vH(r,e,t,n,s,i){var a=Math.PI/2;if(i){var o=Math.min(i,s/2,n/2),l=e+o,c=t+o,A=e+n-o,d=t+s-o;r.moveTo(e,c),l<A&&c<d?(r.arc(l,c,o,-Math.PI,-a),r.arc(A,c,o,-a,0),r.arc(A,d,o,0,a),r.arc(l,d,o,a,Math.PI)):l<A?(r.moveTo(l,t),r.arc(A,c,o,-a,a),r.arc(l,c,o,a,Math.PI+a)):c<d?(r.arc(l,c,o,-Math.PI,0),r.arc(l,d,o,0,Math.PI)):r.arc(l,c,o,-Math.PI,Math.PI),r.closePath(),r.moveTo(e,t)}else r.rect(e,t,n,s)}function xH(r,e,t){var n=t.backgroundColor,s=t.borderColor,i=t.borderWidth;!n&&(!s||!i)||(r.beginPath(),vH(r,jl(e.x)+i/2,jl(e.y)+i/2,jl(e.w)-i,jl(e.h)-i,t.borderRadius),r.closePath(),n&&(r.fillStyle=n,r.fill()),s&&i&&(r.strokeStyle=s,r.lineWidth=i,r.lineJoin="miter",r.stroke()))}function _H(r,e,t){var n=t.lineHeight,s=r.w,i=r.x,a=r.y+n/2;return e==="center"?i+=s/2:(e==="end"||e==="right")&&(i+=s),{h:n,w:s,x:i,y:a}}function BH(r,e,t){var n=r.shadowBlur,s=t.stroked,i=jl(t.x),a=jl(t.y),o=jl(t.w);s&&r.strokeText(e,i,a,o),t.filled&&(n&&s&&(r.shadowBlur=0),r.fillText(e,i,a,o),n&&s&&(r.shadowBlur=n))}function CH(r,e,t,n){var s=n.textAlign,i=n.color,a=!!i,o=n.font,l=e.length,c=n.textStrokeColor,A=n.textStrokeWidth,d=c&&A,h;if(!(!l||!a&&!d))for(t=_H(t,s,o),r.font=o.string,r.textAlign=s,r.textBaseline="middle",r.shadowBlur=n.textShadowBlur,r.shadowColor=n.textShadowColor,a&&(r.fillStyle=i),d&&(r.lineJoin="round",r.lineWidth=A,r.strokeStyle=c),h=0,l=e.length;h<l;++h)BH(r,e[h],{stroked:d,filled:a,w:t.w,x:t.x,y:t.y+t.h*h})}var PT=function(r,e,t,n){var s=this;s._config=r,s._index=n,s._model=null,s._rects=null,s._ctx=e,s._el=t};ol(PT.prototype,{_modelize:function(r,e,t,n){var s=this,i=s._index,a=vs(Cn([t.font,{}],n,i)),o=Cn([t.color,Tn.color],n,i);return{align:Cn([t.align,"center"],n,i),anchor:Cn([t.anchor,"center"],n,i),area:n.chart.chartArea,backgroundColor:Cn([t.backgroundColor,null],n,i),borderColor:Cn([t.borderColor,null],n,i),borderRadius:Cn([t.borderRadius,0],n,i),borderWidth:Cn([t.borderWidth,0],n,i),clamp:Cn([t.clamp,!1],n,i),clip:Cn([t.clip,!1],n,i),color:o,display:r,font:a,lines:e,offset:Cn([t.offset,4],n,i),opacity:Cn([t.opacity,1],n,i),origin:yH(s._el,n),padding:ui(Cn([t.padding,4],n,i)),positioner:wH(s._el),rotation:Cn([t.rotation,0],n,i)*(Math.PI/180),size:Hf.textSize(s._ctx,e,a),textAlign:Cn([t.textAlign,"start"],n,i),textShadowBlur:Cn([t.textShadowBlur,0],n,i),textShadowColor:Cn([t.textShadowColor,o],n,i),textStrokeColor:Cn([t.textStrokeColor,o],n,i),textStrokeWidth:Cn([t.textStrokeWidth,0],n,i)}},update:function(r){var e=this,t=null,n=null,s=e._index,i=e._config,a,o,l,c=Cn([i.display,!0],r,s);c&&(a=r.dataset.data[s],o=qt(zt(i.formatter,[a,r]),a),l=pr(o)?[]:Hf.toTextLines(o),l.length&&(t=e._modelize(c,l,i,r),n=bH(t))),e._model=t,e._rects=n},geometry:function(){return this._rects?this._rects.frame:{}},rotation:function(){return this._model?this._model.rotation:0},visible:function(){return this._model&&this._model.opacity},model:function(){return this._model},draw:function(r,e){var t=this,n=r.ctx,s=t._model,i=t._rects,a;this.visible()&&(n.save(),s.clip&&(a=s.area,n.beginPath(),n.rect(a.left,a.top,a.right-a.left,a.bottom-a.top),n.clip()),n.globalAlpha=Hf.bound(0,s.opacity,1),n.translate(jl(e.x),jl(e.y)),n.rotate(s.rotation),xH(n,i.frame,s),CH(n,s.lines,i.text,s),n.restore())}});var SH=Number.MIN_SAFE_INTEGER||-9007199254740991,kH=Number.MAX_SAFE_INTEGER||9007199254740991;function rf(r,e,t){var n=Math.cos(t),s=Math.sin(t),i=e.x,a=e.y;return{x:i+n*(r.x-i)-s*(r.y-a),y:a+s*(r.x-i)+n*(r.y-a)}}function E5(r,e){var t=kH,n=SH,s=e.origin,i,a,o,l,c;for(i=0;i<r.length;++i)a=r[i],o=a.x-s.x,l=a.y-s.y,c=e.vx*o+e.vy*l,t=Math.min(t,c),n=Math.max(n,c);return{min:t,max:n}}function Xp(r,e){var t=e.x-r.x,n=e.y-r.y,s=Math.sqrt(t*t+n*n);return{vx:(e.x-r.x)/s,vy:(e.y-r.y)/s,origin:r,ln:s}}var DT=function(){this._rotation=0,this._rect={x:0,y:0,w:0,h:0}};ol(DT.prototype,{center:function(){var r=this._rect;return{x:r.x+r.w/2,y:r.y+r.h/2}},update:function(r,e,t){this._rotation=t,this._rect={x:e.x+r.x,y:e.y+r.y,w:e.w,h:e.h}},contains:function(r){var e=this,t=1,n=e._rect;return r=rf(r,e.center(),-e._rotation),!(r.x<n.x-t||r.y<n.y-t||r.x>n.x+n.w+t*2||r.y>n.y+n.h+t*2)},intersects:function(r){var e=this._points(),t=r._points(),n=[Xp(e[0],e[1]),Xp(e[0],e[3])],s,i,a;for(this._rotation!==r._rotation&&n.push(Xp(t[0],t[1]),Xp(t[0],t[3])),s=0;s<n.length;++s)if(i=E5(e,n[s]),a=E5(t,n[s]),i.max<a.min||a.max<i.min)return!1;return!0},_points:function(){var r=this,e=r._rect,t=r._rotation,n=r.center();return[rf({x:e.x,y:e.y},n,t),rf({x:e.x+e.w,y:e.y},n,t),rf({x:e.x+e.w,y:e.y+e.h},n,t),rf({x:e.x,y:e.y+e.h},n,t)]}});function RT(r,e,t){var n=e.positioner(r,e),s=n.vx,i=n.vy;if(!s&&!i)return{x:n.x,y:n.y};var a=t.w,o=t.h,l=e.rotation,c=Math.abs(a/2*Math.cos(l))+Math.abs(o/2*Math.sin(l)),A=Math.abs(a/2*Math.sin(l))+Math.abs(o/2*Math.cos(l)),d=1/Math.max(Math.abs(s),Math.abs(i));return c*=s*d,A*=i*d,c+=e.offset*s,A+=e.offset*i,{x:n.x+c,y:n.y+A}}function EH(r,e){var t,n,s,i;for(t=r.length-1;t>=0;--t)for(s=r[t].$layout,n=t-1;n>=0&&s._visible;--n)i=r[n].$layout,i._visible&&s._box.intersects(i._box)&&e(s,i);return r}function IH(r){var e,t,n,s,i,a,o;for(e=0,t=r.length;e<t;++e)n=r[e],s=n.$layout,s._visible&&(o=new Proxy(n._el,{get:(l,c)=>l.getProps([c],!0)[c]}),i=n.geometry(),a=RT(o,n.model(),i),s._box.update(a,i,n.rotation()));return EH(r,function(l,c){var A=l._hidable,d=c._hidable;A&&d||d?c._visible=!1:A&&(l._visible=!1)})}var jf={prepare:function(r){var e=[],t,n,s,i,a;for(t=0,s=r.length;t<s;++t)for(n=0,i=r[t].length;n<i;++n)a=r[t][n],e.push(a),a.$layout={_box:new DT,_hidable:!1,_visible:!0,_set:t,_idx:a._index};return e.sort(function(o,l){var c=o.$layout,A=l.$layout;return c._idx===A._idx?A._set-c._set:A._idx-c._idx}),this.update(e),e},update:function(r){var e=!1,t,n,s,i,a;for(t=0,n=r.length;t<n;++t)s=r[t],i=s.model(),a=s.$layout,a._hidable=i&&i.display==="auto",a._visible=s.visible(),e|=a._hidable;e&&IH(r)},lookup:function(r,e){var t,n;for(t=r.length-1;t>=0;--t)if(n=r[t].$layout,n&&n._visible&&n._box.contains(e))return r[t];return null},draw:function(r,e){var t,n,s,i,a,o;for(t=0,n=e.length;t<n;++t)s=e[t],i=s.$layout,i._visible&&(a=s.geometry(),o=RT(s._el,s.model(),a),i._box.update(o,a,s.rotation()),s.draw(r,o))}},TH=function(r){if(pr(r))return null;var e=r,t,n,s;if(Br(r))if(!pr(r.label))e=r.label;else if(!pr(r.r))e=r.r;else for(e="",t=Object.keys(r),s=0,n=t.length;s<n;++s)e+=(s!==0?", ":"")+t[s]+": "+r[t[s]];return""+e},FH={align:"center",anchor:"center",backgroundColor:null,borderColor:null,borderRadius:0,borderWidth:0,clamp:!1,clip:!1,color:void 0,display:!0,font:{family:void 0,lineHeight:1.2,size:void 0,style:void 0,weight:null},formatter:TH,labels:void 0,listeners:{},offset:4,opacity:1,padding:{top:4,right:4,bottom:4,left:4},rotation:0,textAlign:"start",textStrokeColor:void 0,textStrokeWidth:0,textShadowBlur:0,textShadowColor:void 0},na="$datalabels",OT="$default";function LH(r,e){var t=r.datalabels,n={},s=[],i,a;return t===!1?null:(t===!0&&(t={}),e=ol({},[e,t]),i=e.labels||{},a=Object.keys(i),delete e.labels,a.length?a.forEach(function(o){i[o]&&s.push(ol({},[e,i[o],{_key:o}]))}):s.push(e),n=s.reduce(function(o,l){return xr(l.listeners||{},function(c,A){o[A]=o[A]||{},o[A][l._key||OT]=c}),delete l.listeners,o},{}),{labels:s,listeners:n})}function Hv(r,e,t,n){if(e){var s=t.$context,i=t.$groups,a;e[i._set]&&(a=e[i._set][i._key],a&&zt(a,[s,n])===!0&&(r[na]._dirty=!0,t.update(s)))}}function UH(r,e,t,n,s){var i,a;!t&&!n||(t?n?t!==n&&(a=i=!0):a=!0:i=!0,a&&Hv(r,e.leave,t,s),i&&Hv(r,e.enter,n,s))}function MH(r,e){var t=r[na],n=t._listeners,s,i;if(!(!n.enter&&!n.leave)){if(e.type==="mousemove")i=jf.lookup(t._labels,e);else if(e.type!=="mouseout")return;s=t._hovered,t._hovered=i,UH(r,n,s,i,e)}}function NH(r,e){var t=r[na],n=t._listeners.click,s=n&&jf.lookup(t._labels,e);s&&Hv(r,n,s,e)}var Hx={id:"datalabels",defaults:FH,beforeInit:function(r){r[na]={_actives:[]}},beforeUpdate:function(r){var e=r[na];e._listened=!1,e._listeners={},e._datasets=[],e._labels=[]},afterDatasetUpdate:function(r,e,t){var n=e.index,s=r[na],i=s._datasets[n]=[],a=r.isDatasetVisible(n),o=r.data.datasets[n],l=LH(o,t),c=e.meta.data||[],A=r.ctx,d,h,u,p,f,g,m,x;for(A.save(),d=0,u=c.length;d<u;++d)if(m=c[d],m[na]=[],a&&m&&r.getDataVisibility(d)&&!m.skip)for(h=0,p=l.labels.length;h<p;++h)f=l.labels[h],g=f._key,x=new PT(f,A,m,d),x.$groups={_set:n,_key:g||OT},x.$context={active:!1,chart:r,dataIndex:d,dataset:o,datasetIndex:n},x.update(x.$context),m[na].push(x),i.push(x);A.restore(),ol(s._listeners,l.listeners,{merger:function(S,B,F){B[S]=B[S]||{},B[S][e.index]=F[S],s._listened=!0}})},afterUpdate:function(r){r[na]._labels=jf.prepare(r[na]._datasets)},afterDatasetsDraw:function(r){jf.draw(r,r[na]._labels)},beforeEvent:function(r,e){if(r[na]._listened){var t=e.event;switch(t.type){case"mousemove":case"mouseout":MH(r,t);break;case"click":NH(r,t);break}}},afterEvent:function(r){var e=r[na],t=e._actives,n=e._actives=r.getActiveElements(),s=Hf.arrayDiff(t,n),i,a,o,l,c,A,d;for(i=0,a=s.length;i<a;++i)if(c=s[i],c[1])for(d=c[0].element[na]||[],o=0,l=d.length;o<l;++o)A=d[o],A.$context.active=c[1]===1,A.update(A.$context);(e._dirty||s.length)&&(jf.update(e._labels),r.render()),delete e._dirty}},Jp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function jx(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var sw={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */var I5;function PH(){return I5||(I5=1,(function(r){(function(e,t,n,s){var i=["","webkit","Moz","MS","ms","o"],a=t.createElement("div"),o="function",l=Math.round,c=Math.abs,A=Date.now;function d(re,Ae,be){return setTimeout(S(re,be),Ae)}function h(re,Ae,be){return Array.isArray(re)?(u(re,be[Ae],be),!0):!1}function u(re,Ae,be){var Oe;if(re)if(re.forEach)re.forEach(Ae,be);else if(re.length!==s)for(Oe=0;Oe<re.length;)Ae.call(be,re[Oe],Oe,re),Oe++;else for(Oe in re)re.hasOwnProperty(Oe)&&Ae.call(be,re[Oe],Oe,re)}function p(re,Ae,be){var Oe="DEPRECATED METHOD: "+Ae+`
`+be+` AT 
`;return function(){var Je=new Error("get-stack-trace"),ht=Je&&Je.stack?Je.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",nr=e.console&&(e.console.warn||e.console.log);return nr&&nr.call(e.console,Oe,ht),re.apply(this,arguments)}}var f;typeof Object.assign!="function"?f=function(Ae){if(Ae===s||Ae===null)throw new TypeError("Cannot convert undefined or null to object");for(var be=Object(Ae),Oe=1;Oe<arguments.length;Oe++){var Je=arguments[Oe];if(Je!==s&&Je!==null)for(var ht in Je)Je.hasOwnProperty(ht)&&(be[ht]=Je[ht])}return be}:f=Object.assign;var g=p(function(Ae,be,Oe){for(var Je=Object.keys(be),ht=0;ht<Je.length;)(!Oe||Oe&&Ae[Je[ht]]===s)&&(Ae[Je[ht]]=be[Je[ht]]),ht++;return Ae},"extend","Use `assign`."),m=p(function(Ae,be){return g(Ae,be,!0)},"merge","Use `assign`.");function x(re,Ae,be){var Oe=Ae.prototype,Je;Je=re.prototype=Object.create(Oe),Je.constructor=re,Je._super=Oe,be&&f(Je,be)}function S(re,Ae){return function(){return re.apply(Ae,arguments)}}function B(re,Ae){return typeof re==o?re.apply(Ae&&Ae[0]||s,Ae):re}function F(re,Ae){return re===s?Ae:re}function N(re,Ae,be){u(I(Ae),function(Oe){re.addEventListener(Oe,be,!1)})}function E(re,Ae,be){u(I(Ae),function(Oe){re.removeEventListener(Oe,be,!1)})}function w(re,Ae){for(;re;){if(re==Ae)return!0;re=re.parentNode}return!1}function v(re,Ae){return re.indexOf(Ae)>-1}function I(re){return re.trim().split(/\s+/g)}function k(re,Ae,be){if(re.indexOf&&!be)return re.indexOf(Ae);for(var Oe=0;Oe<re.length;){if(be&&re[Oe][be]==Ae||!be&&re[Oe]===Ae)return Oe;Oe++}return-1}function _(re){return Array.prototype.slice.call(re,0)}function T(re,Ae,be){for(var Oe=[],Je=[],ht=0;ht<re.length;){var nr=re[ht][Ae];k(Je,nr)<0&&Oe.push(re[ht]),Je[ht]=nr,ht++}return Oe=Oe.sort(function(Hr,hn){return Hr[Ae]>hn[Ae]}),Oe}function L(re,Ae){for(var be,Oe,Je=Ae[0].toUpperCase()+Ae.slice(1),ht=0;ht<i.length;){if(be=i[ht],Oe=be?be+Je:Ae,Oe in re)return Oe;ht++}return s}var K=1;function se(){return K++}function X(re){var Ae=re.ownerDocument||re;return Ae.defaultView||Ae.parentWindow||e}var $=/mobile|tablet|ip(ad|hone|od)|android/i,V="ontouchstart"in e,he=L(e,"PointerEvent")!==s,z=V&&$.test(navigator.userAgent),M="touch",O="pen",H="mouse",J="kinect",de=25,ie=1,le=2,fe=4,ve=8,Ce=1,Be=2,Qe=4,D=8,G=16,ce=Be|Qe,Z=D|G,W=ce|Z,ee=["x","y"],ye=["clientX","clientY"];function xe(re,Ae){var be=this;this.manager=re,this.callback=Ae,this.element=re.element,this.target=re.options.inputTarget,this.domHandler=function(Oe){B(re.options.enable,[re])&&be.handler(Oe)},this.init()}xe.prototype={handler:function(){},init:function(){this.evEl&&N(this.element,this.evEl,this.domHandler),this.evTarget&&N(this.target,this.evTarget,this.domHandler),this.evWin&&N(X(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&E(this.element,this.evEl,this.domHandler),this.evTarget&&E(this.target,this.evTarget,this.domHandler),this.evWin&&E(X(this.element),this.evWin,this.domHandler)}};function we(re){var Ae,be=re.options.inputClass;return be?Ae=be:he?Ae=Ut:z?Ae=Cs:V?Ae=sn:Ae=jt,new Ae(re,Ee)}function Ee(re,Ae,be){var Oe=be.pointers.length,Je=be.changedPointers.length,ht=Ae&ie&&Oe-Je===0,nr=Ae&(fe|ve)&&Oe-Je===0;be.isFirst=!!ht,be.isFinal=!!nr,ht&&(re.session={}),be.eventType=Ae,Ne(re,be),re.emit("hammer.input",be),re.recognize(be),re.session.prevInput=be}function Ne(re,Ae){var be=re.session,Oe=Ae.pointers,Je=Oe.length;be.firstInput||(be.firstInput=st(Ae)),Je>1&&!be.firstMultiple?be.firstMultiple=st(Ae):Je===1&&(be.firstMultiple=!1);var ht=be.firstInput,nr=be.firstMultiple,on=nr?nr.center:ht.center,Hr=Ae.center=Ze(Oe);Ae.timeStamp=A(),Ae.deltaTime=Ae.timeStamp-ht.timeStamp,Ae.angle=lt(on,Hr),Ae.distance=it(on,Hr),Ue(be,Ae),Ae.offsetDirection=wt(Ae.deltaX,Ae.deltaY);var hn=ct(Ae.deltaTime,Ae.deltaX,Ae.deltaY);Ae.overallVelocityX=hn.x,Ae.overallVelocityY=hn.y,Ae.overallVelocity=c(hn.x)>c(hn.y)?hn.x:hn.y,Ae.scale=nr?rt(nr.pointers,Oe):1,Ae.rotation=nr?tt(nr.pointers,Oe):0,Ae.maxPointers=be.prevInput?Ae.pointers.length>be.prevInput.maxPointers?Ae.pointers.length:be.prevInput.maxPointers:Ae.pointers.length,je(be,Ae);var fi=re.element;w(Ae.srcEvent.target,fi)&&(fi=Ae.srcEvent.target),Ae.target=fi}function Ue(re,Ae){var be=Ae.center,Oe=re.offsetDelta||{},Je=re.prevDelta||{},ht=re.prevInput||{};(Ae.eventType===ie||ht.eventType===fe)&&(Je=re.prevDelta={x:ht.deltaX||0,y:ht.deltaY||0},Oe=re.offsetDelta={x:be.x,y:be.y}),Ae.deltaX=Je.x+(be.x-Oe.x),Ae.deltaY=Je.y+(be.y-Oe.y)}function je(re,Ae){var be=re.lastInterval||Ae,Oe=Ae.timeStamp-be.timeStamp,Je,ht,nr,on;if(Ae.eventType!=ve&&(Oe>de||be.velocity===s)){var Hr=Ae.deltaX-be.deltaX,hn=Ae.deltaY-be.deltaY,fi=ct(Oe,Hr,hn);ht=fi.x,nr=fi.y,Je=c(fi.x)>c(fi.y)?fi.x:fi.y,on=wt(Hr,hn),re.lastInterval=Ae}else Je=be.velocity,ht=be.velocityX,nr=be.velocityY,on=be.direction;Ae.velocity=Je,Ae.velocityX=ht,Ae.velocityY=nr,Ae.direction=on}function st(re){for(var Ae=[],be=0;be<re.pointers.length;)Ae[be]={clientX:l(re.pointers[be].clientX),clientY:l(re.pointers[be].clientY)},be++;return{timeStamp:A(),pointers:Ae,center:Ze(Ae),deltaX:re.deltaX,deltaY:re.deltaY}}function Ze(re){var Ae=re.length;if(Ae===1)return{x:l(re[0].clientX),y:l(re[0].clientY)};for(var be=0,Oe=0,Je=0;Je<Ae;)be+=re[Je].clientX,Oe+=re[Je].clientY,Je++;return{x:l(be/Ae),y:l(Oe/Ae)}}function ct(re,Ae,be){return{x:Ae/re||0,y:be/re||0}}function wt(re,Ae){return re===Ae?Ce:c(re)>=c(Ae)?re<0?Be:Qe:Ae<0?D:G}function it(re,Ae,be){be||(be=ee);var Oe=Ae[be[0]]-re[be[0]],Je=Ae[be[1]]-re[be[1]];return Math.sqrt(Oe*Oe+Je*Je)}function lt(re,Ae,be){be||(be=ee);var Oe=Ae[be[0]]-re[be[0]],Je=Ae[be[1]]-re[be[1]];return Math.atan2(Je,Oe)*180/Math.PI}function tt(re,Ae){return lt(Ae[1],Ae[0],ye)+lt(re[1],re[0],ye)}function rt(re,Ae){return it(Ae[0],Ae[1],ye)/it(re[0],re[1],ye)}var ft={mousedown:ie,mousemove:le,mouseup:fe},St="mousedown",yt="mousemove mouseup";function jt(){this.evEl=St,this.evWin=yt,this.pressed=!1,xe.apply(this,arguments)}x(jt,xe,{handler:function(Ae){var be=ft[Ae.type];be&ie&&Ae.button===0&&(this.pressed=!0),be&le&&Ae.which!==1&&(be=fe),this.pressed&&(be&fe&&(this.pressed=!1),this.callback(this.manager,be,{pointers:[Ae],changedPointers:[Ae],pointerType:H,srcEvent:Ae}))}});var Rt={pointerdown:ie,pointermove:le,pointerup:fe,pointercancel:ve,pointerout:ve},wr={2:M,3:O,4:H,5:J},Qr="pointerdown",Lt="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(Qr="MSPointerDown",Lt="MSPointerMove MSPointerUp MSPointerCancel");function Ut(){this.evEl=Qr,this.evWin=Lt,xe.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}x(Ut,xe,{handler:function(Ae){var be=this.store,Oe=!1,Je=Ae.type.toLowerCase().replace("ms",""),ht=Rt[Je],nr=wr[Ae.pointerType]||Ae.pointerType,on=nr==M,Hr=k(be,Ae.pointerId,"pointerId");ht&ie&&(Ae.button===0||on)?Hr<0&&(be.push(Ae),Hr=be.length-1):ht&(fe|ve)&&(Oe=!0),!(Hr<0)&&(be[Hr]=Ae,this.callback(this.manager,ht,{pointers:be,changedPointers:[Ae],pointerType:nr,srcEvent:Ae}),Oe&&be.splice(Hr,1))}});var mr={touchstart:ie,touchmove:le,touchend:fe,touchcancel:ve},gs="touchstart",Pn="touchstart touchmove touchend touchcancel";function hi(){this.evTarget=gs,this.evWin=Pn,this.started=!1,xe.apply(this,arguments)}x(hi,xe,{handler:function(Ae){var be=mr[Ae.type];if(be===ie&&(this.started=!0),!!this.started){var Oe=Bs.call(this,Ae,be);be&(fe|ve)&&Oe[0].length-Oe[1].length===0&&(this.started=!1),this.callback(this.manager,be,{pointers:Oe[0],changedPointers:Oe[1],pointerType:M,srcEvent:Ae})}}});function Bs(re,Ae){var be=_(re.touches),Oe=_(re.changedTouches);return Ae&(fe|ve)&&(be=T(be.concat(Oe),"identifier")),[be,Oe]}var Ht={touchstart:ie,touchmove:le,touchend:fe,touchcancel:ve},da="touchstart touchmove touchend touchcancel";function Cs(){this.evTarget=da,this.targetIds={},xe.apply(this,arguments)}x(Cs,xe,{handler:function(Ae){var be=Ht[Ae.type],Oe=Xs.call(this,Ae,be);Oe&&this.callback(this.manager,be,{pointers:Oe[0],changedPointers:Oe[1],pointerType:M,srcEvent:Ae})}});function Xs(re,Ae){var be=_(re.touches),Oe=this.targetIds;if(Ae&(ie|le)&&be.length===1)return Oe[be[0].identifier]=!0,[be,be];var Je,ht,nr=_(re.changedTouches),on=[],Hr=this.target;if(ht=be.filter(function(hn){return w(hn.target,Hr)}),Ae===ie)for(Je=0;Je<ht.length;)Oe[ht[Je].identifier]=!0,Je++;for(Je=0;Je<nr.length;)Oe[nr[Je].identifier]&&on.push(nr[Je]),Ae&(fe|ve)&&delete Oe[nr[Je].identifier],Je++;if(on.length)return[T(ht.concat(on),"identifier"),on]}var Js=2500,Jr=25;function sn(){xe.apply(this,arguments);var re=S(this.handler,this);this.touch=new Cs(this.manager,re),this.mouse=new jt(this.manager,re),this.primaryTouch=null,this.lastTouches=[]}x(sn,xe,{handler:function(Ae,be,Oe){var Je=Oe.pointerType==M,ht=Oe.pointerType==H;if(!(ht&&Oe.sourceCapabilities&&Oe.sourceCapabilities.firesTouchEvents)){if(Je)Xn.call(this,be,Oe);else if(ht&&ua.call(this,Oe))return;this.callback(Ae,be,Oe)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function Xn(re,Ae){re&ie?(this.primaryTouch=Ae.changedPointers[0].identifier,Ss.call(this,Ae)):re&(fe|ve)&&Ss.call(this,Ae)}function Ss(re){var Ae=re.changedPointers[0];if(Ae.identifier===this.primaryTouch){var be={x:Ae.clientX,y:Ae.clientY};this.lastTouches.push(be);var Oe=this.lastTouches,Je=function(){var ht=Oe.indexOf(be);ht>-1&&Oe.splice(ht,1)};setTimeout(Je,Js)}}function ua(re){for(var Ae=re.srcEvent.clientX,be=re.srcEvent.clientY,Oe=0;Oe<this.lastTouches.length;Oe++){var Je=this.lastTouches[Oe],ht=Math.abs(Ae-Je.x),nr=Math.abs(be-Je.y);if(ht<=Jr&&nr<=Jr)return!0}return!1}var Zs=L(a.style,"touchAction"),ei=Zs!==s,Ps="compute",ti="auto",Ds="manipulation",Rs="none",Os="pan-x",Qs="pan-y",ji=ha();function Vi(re,Ae){this.manager=re,this.set(Ae)}Vi.prototype={set:function(re){re==Ps&&(re=this.compute()),ei&&this.manager.element.style&&ji[re]&&(this.manager.element.style[Zs]=re),this.actions=re.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var re=[];return u(this.manager.recognizers,function(Ae){B(Ae.options.enable,[Ae])&&(re=re.concat(Ae.getTouchAction()))}),$i(re.join(" "))},preventDefaults:function(re){var Ae=re.srcEvent,be=re.offsetDirection;if(this.manager.session.prevented){Ae.preventDefault();return}var Oe=this.actions,Je=v(Oe,Rs)&&!ji[Rs],ht=v(Oe,Qs)&&!ji[Qs],nr=v(Oe,Os)&&!ji[Os];if(Je){var on=re.pointers.length===1,Hr=re.distance<2,hn=re.deltaTime<250;if(on&&Hr&&hn)return}if(!(nr&&ht)&&(Je||ht&&be&ce||nr&&be&Z))return this.preventSrc(Ae)},preventSrc:function(re){this.manager.session.prevented=!0,re.preventDefault()}};function $i(re){if(v(re,Rs))return Rs;var Ae=v(re,Os),be=v(re,Qs);return Ae&&be?Rs:Ae||be?Ae?Os:Qs:v(re,Ds)?Ds:ti}function ha(){if(!ei)return!1;var re={},Ae=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(be){re[be]=Ae?e.CSS.supports("touch-action",be):!0}),re}var Gi=1,ks=2,zi=4,Fn=8,Hs=Fn,Ki=16,ps=32;function ri(re){this.options=f({},this.defaults,re||{}),this.id=se(),this.manager=null,this.options.enable=F(this.options.enable,!0),this.state=Gi,this.simultaneous={},this.requireFail=[]}ri.prototype={defaults:{},set:function(re){return f(this.options,re),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(re){if(h(re,"recognizeWith",this))return this;var Ae=this.simultaneous;return re=fa(re,this),Ae[re.id]||(Ae[re.id]=re,re.recognizeWith(this)),this},dropRecognizeWith:function(re){return h(re,"dropRecognizeWith",this)?this:(re=fa(re,this),delete this.simultaneous[re.id],this)},requireFailure:function(re){if(h(re,"requireFailure",this))return this;var Ae=this.requireFail;return re=fa(re,this),k(Ae,re)===-1&&(Ae.push(re),re.requireFailure(this)),this},dropRequireFailure:function(re){if(h(re,"dropRequireFailure",this))return this;re=fa(re,this);var Ae=k(this.requireFail,re);return Ae>-1&&this.requireFail.splice(Ae,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(re){return!!this.simultaneous[re.id]},emit:function(re){var Ae=this,be=this.state;function Oe(Je){Ae.manager.emit(Je,re)}be<Fn&&Oe(Ae.options.event+ko(be)),Oe(Ae.options.event),re.ProgressEvent&&Oe(re.ProgressEvent),be>=Fn&&Oe(Ae.options.event+ko(be))},tryEmit:function(re){if(this.canEmit())return this.emit(re);this.state=ps},canEmit:function(){for(var re=0;re<this.requireFail.length;){if(!(this.requireFail[re].state&(ps|Gi)))return!1;re++}return!0},recognize:function(re){var Ae=f({},re);if(!B(this.options.enable,[this,Ae])){this.reset(),this.state=ps;return}this.state&(Hs|Ki|ps)&&(this.state=Gi),this.state=this.process(Ae),this.state&(ks|zi|Fn|Ki)&&this.tryEmit(Ae)},process:function(re){},getTouchAction:function(){},reset:function(){}};function ko(re){return re&Ki?"cancel":re&Fn?"end":re&zi?"move":re&ks?"start":""}function Eo(re){return re==G?"down":re==D?"up":re==Be?"left":re==Qe?"right":""}function fa(re,Ae){var be=Ae.manager;return be?be.get(re):re}function Ln(){ri.apply(this,arguments)}x(Ln,ri,{defaults:{pointers:1},attrTest:function(re){var Ae=this.options.pointers;return Ae===0||re.pointers.length===Ae},process:function(re){var Ae=this.state,be=re.eventType,Oe=Ae&(ks|zi),Je=this.attrTest(re);return Oe&&(be&ve||!Je)?Ae|Ki:Oe||Je?be&fe?Ae|Fn:Ae&ks?Ae|zi:ks:ps}});function Cr(){Ln.apply(this,arguments),this.pX=null,this.pY=null}x(Cr,Ln,{defaults:{event:"pan",threshold:10,pointers:1,direction:W},getTouchAction:function(){var re=this.options.direction,Ae=[];return re&ce&&Ae.push(Qs),re&Z&&Ae.push(Os),Ae},directionTest:function(re){var Ae=this.options,be=!0,Oe=re.distance,Je=re.direction,ht=re.deltaX,nr=re.deltaY;return Je&Ae.direction||(Ae.direction&ce?(Je=ht===0?Ce:ht<0?Be:Qe,be=ht!=this.pX,Oe=Math.abs(re.deltaX)):(Je=nr===0?Ce:nr<0?D:G,be=nr!=this.pY,Oe=Math.abs(re.deltaY))),re.direction=Je,be&&Oe>Ae.threshold&&Je&Ae.direction},attrTest:function(re){return Ln.prototype.attrTest.call(this,re)&&(this.state&ks||!(this.state&ks)&&this.directionTest(re))},emit:function(re){this.pX=re.deltaX,this.pY=re.deltaY;var Ae=Eo(re.direction);Ae&&(re.ProgressEvent=this.options.event+Ae),this._super.emit.call(this,re)}});function qi(){Ln.apply(this,arguments)}x(qi,Ln,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Rs]},attrTest:function(re){return this._super.attrTest.call(this,re)&&(Math.abs(re.scale-1)>this.options.threshold||this.state&ks)},emit:function(re){if(re.scale!==1){var Ae=re.scale<1?"in":"out";re.ProgressEvent=this.options.event+Ae}this._super.emit.call(this,re)}});function Wi(){ri.apply(this,arguments),this._timer=null,this._input=null}x(Wi,ri,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[ti]},process:function(re){var Ae=this.options,be=re.pointers.length===Ae.pointers,Oe=re.distance<Ae.threshold,Je=re.deltaTime>Ae.time;if(this._input=re,!Oe||!be||re.eventType&(fe|ve)&&!Je)this.reset();else if(re.eventType&ie)this.reset(),this._timer=d(function(){this.state=Hs,this.tryEmit()},Ae.time,this);else if(re.eventType&fe)return Hs;return ps},reset:function(){clearTimeout(this._timer)},emit:function(re){this.state===Hs&&(re&&re.eventType&fe?this.manager.emit(this.options.event+"up",re):(this._input.timeStamp=A(),this.manager.emit(this.options.event,this._input)))}});function ni(){Ln.apply(this,arguments)}x(ni,Ln,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Rs]},attrTest:function(re){return this._super.attrTest.call(this,re)&&(Math.abs(re.rotation)>this.options.threshold||this.state&ks)}});function _r(){Ln.apply(this,arguments)}x(_r,Ln,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:ce|Z,pointers:1},getTouchAction:function(){return Cr.prototype.getTouchAction.call(this)},attrTest:function(re){var Ae=this.options.direction,be;return Ae&(ce|Z)?be=re.overallVelocity:Ae&ce?be=re.overallVelocityX:Ae&Z&&(be=re.overallVelocityY),this._super.attrTest.call(this,re)&&Ae&re.offsetDirection&&re.distance>this.options.threshold&&re.maxPointers==this.options.pointers&&c(be)>this.options.velocity&&re.eventType&fe},emit:function(re){var Ae=Eo(re.offsetDirection);Ae&&this.manager.emit(this.options.event+Ae,re),this.manager.emit(this.options.event,re)}});function Jn(){ri.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}x(Jn,ri,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Ds]},process:function(re){var Ae=this.options,be=re.pointers.length===Ae.pointers,Oe=re.distance<Ae.threshold,Je=re.deltaTime<Ae.time;if(this.reset(),re.eventType&ie&&this.count===0)return this.failTimeout();if(Oe&&Je&&be){if(re.eventType!=fe)return this.failTimeout();var ht=this.pTime?re.timeStamp-this.pTime<Ae.interval:!0,nr=!this.pCenter||it(this.pCenter,re.center)<Ae.posThreshold;this.pTime=re.timeStamp,this.pCenter=re.center,!nr||!ht?this.count=1:this.count+=1,this._input=re;var on=this.count%Ae.taps;if(on===0)return this.hasRequireFailures()?(this._timer=d(function(){this.state=Hs,this.tryEmit()},Ae.interval,this),ks):Hs}return ps},failTimeout:function(){return this._timer=d(function(){this.state=ps},this.options.interval,this),ps},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Hs&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function Qn(re,Ae){return Ae=Ae||{},Ae.recognizers=F(Ae.recognizers,Qn.defaults.preset),new To(re,Ae)}Qn.VERSION="2.0.7",Qn.defaults={domEvents:!1,touchAction:Ps,enable:!0,inputTarget:null,inputClass:null,preset:[[ni,{enable:!1}],[qi,{enable:!1},["rotate"]],[_r,{direction:ce}],[Cr,{direction:ce},["swipe"]],[Jn],[Jn,{event:"doubletap",taps:2},["tap"]],[Wi]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Zr=1,Io=2;function To(re,Ae){this.options=f({},Qn.defaults,Ae||{}),this.options.inputTarget=this.options.inputTarget||re,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=re,this.input=we(this),this.touchAction=new Vi(this,this.options.touchAction),hc(this,!0),u(this.options.recognizers,function(be){var Oe=this.add(new be[0](be[1]));be[2]&&Oe.recognizeWith(be[2]),be[3]&&Oe.requireFailure(be[3])},this)}To.prototype={set:function(re){return f(this.options,re),re.touchAction&&this.touchAction.update(),re.inputTarget&&(this.input.destroy(),this.input.target=re.inputTarget,this.input.init()),this},stop:function(re){this.session.stopped=re?Io:Zr},recognize:function(re){var Ae=this.session;if(!Ae.stopped){this.touchAction.preventDefaults(re);var be,Oe=this.recognizers,Je=Ae.curRecognizer;(!Je||Je&&Je.state&Hs)&&(Je=Ae.curRecognizer=null);for(var ht=0;ht<Oe.length;)be=Oe[ht],Ae.stopped!==Io&&(!Je||be==Je||be.canRecognizeWith(Je))?be.recognize(re):be.reset(),!Je&&be.state&(ks|zi|Fn)&&(Je=Ae.curRecognizer=be),ht++}},get:function(re){if(re instanceof ri)return re;for(var Ae=this.recognizers,be=0;be<Ae.length;be++)if(Ae[be].options.event==re)return Ae[be];return null},add:function(re){if(h(re,"add",this))return this;var Ae=this.get(re.options.event);return Ae&&this.remove(Ae),this.recognizers.push(re),re.manager=this,this.touchAction.update(),re},remove:function(re){if(h(re,"remove",this))return this;if(re=this.get(re),re){var Ae=this.recognizers,be=k(Ae,re);be!==-1&&(Ae.splice(be,1),this.touchAction.update())}return this},on:function(re,Ae){if(re!==s&&Ae!==s){var be=this.handlers;return u(I(re),function(Oe){be[Oe]=be[Oe]||[],be[Oe].push(Ae)}),this}},off:function(re,Ae){if(re!==s){var be=this.handlers;return u(I(re),function(Oe){Ae?be[Oe]&&be[Oe].splice(k(be[Oe],Ae),1):delete be[Oe]}),this}},emit:function(re,Ae){this.options.domEvents&&OA(re,Ae);var be=this.handlers[re]&&this.handlers[re].slice();if(!(!be||!be.length)){Ae.type=re,Ae.preventDefault=function(){Ae.srcEvent.preventDefault()};for(var Oe=0;Oe<be.length;)be[Oe](Ae),Oe++}},destroy:function(){this.element&&hc(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function hc(re,Ae){var be=re.element;if(be.style){var Oe;u(re.options.cssProps,function(Je,ht){Oe=L(be.style,ht),Ae?(re.oldCssProps[Oe]=be.style[Oe],be.style[Oe]=Je):be.style[Oe]=re.oldCssProps[Oe]||""}),Ae||(re.oldCssProps={})}}function OA(re,Ae){var be=t.createEvent("Event");be.initEvent(re,!0,!0),be.gesture=Ae,Ae.target.dispatchEvent(be)}f(Qn,{INPUT_START:ie,INPUT_MOVE:le,INPUT_END:fe,INPUT_CANCEL:ve,STATE_POSSIBLE:Gi,STATE_BEGAN:ks,STATE_CHANGED:zi,STATE_ENDED:Fn,STATE_RECOGNIZED:Hs,STATE_CANCELLED:Ki,STATE_FAILED:ps,DIRECTION_NONE:Ce,DIRECTION_LEFT:Be,DIRECTION_RIGHT:Qe,DIRECTION_UP:D,DIRECTION_DOWN:G,DIRECTION_HORIZONTAL:ce,DIRECTION_VERTICAL:Z,DIRECTION_ALL:W,Manager:To,Input:xe,TouchAction:Vi,TouchInput:Cs,MouseInput:jt,PointerEventInput:Ut,TouchMouseInput:sn,SingleTouchInput:hi,Recognizer:ri,AttrRecognizer:Ln,Tap:Jn,Pan:Cr,Swipe:_r,Pinch:qi,Rotate:ni,Press:Wi,on:N,off:E,each:u,merge:m,extend:g,assign:f,inherit:x,bindFn:S,prefixed:L});var Yi=typeof e<"u"?e:typeof self<"u"?self:{};Yi.Hammer=Qn,r.exports?r.exports=Qn:e[n]=Qn})(window,document,"Hammer")})(sw)),sw.exports}var DH=PH();const Vf=jx(DH);/*!
* chartjs-plugin-zoom v2.2.0
* https://www.chartjs.org/chartjs-plugin-zoom/2.2.0/
 * (c) 2016-2024 chartjs-plugin-zoom Contributors
 * Released under the MIT License
 */const pg=r=>r&&r.enabled&&r.modifierKey,QT=(r,e)=>r&&e[r+"Key"],Vx=(r,e)=>r&&!e[r+"Key"];function bA(r,e,t){return r===void 0?!0:typeof r=="string"?r.indexOf(e)!==-1:typeof r=="function"?r({chart:t}).indexOf(e)!==-1:!1}function iw(r,e){return typeof r=="function"&&(r=r({chart:e})),typeof r=="string"?{x:r.indexOf("x")!==-1,y:r.indexOf("y")!==-1}:{x:!1,y:!1}}function RH(r,e){let t;return function(){return clearTimeout(t),t=setTimeout(r,e),e}}function OH({x:r,y:e},t){const n=t.scales,s=Object.keys(n);for(let i=0;i<s.length;i++){const a=n[s[i]];if(e>=a.top&&e<=a.bottom&&r>=a.left&&r<=a.right)return a}return null}function HT(r,e,t){const{mode:n="xy",scaleMode:s,overScaleMode:i}=r||{},a=OH(e,t),o=iw(n,t),l=iw(s,t);if(i){const A=iw(i,t);for(const d of["x","y"])A[d]&&(l[d]=o[d],o[d]=!1)}if(a&&l[a.axis])return[a];const c=[];return xr(t.scales,function(A){o[A.axis]&&c.push(A)}),c}const jv=new WeakMap;function Rn(r){let e=jv.get(r);return e||(e={originalScaleLimits:{},updatedScaleLimits:{},handlers:{},panDelta:{},dragging:!1,panning:!1},jv.set(r,e)),e}function QH(r){jv.delete(r)}function jT(r,e,t,n){const s=Math.max(0,Math.min(1,(r-e)/t||0)),i=1-s;return{min:n*s,max:n*i}}function VT(r,e){const t=r.isHorizontal()?e.x:e.y;return r.getValueForPixel(t)}function $T(r,e,t){const n=r.max-r.min,s=n*(e-1),i=VT(r,t);return jT(i,r.min,n,s)}function HH(r,e,t){const n=VT(r,t);if(n===void 0)return{min:r.min,max:r.max};const s=Math.log10(r.min),i=Math.log10(r.max),a=Math.log10(n),o=i-s,l=o*(e-1),c=jT(a,s,o,l);return{min:Math.pow(10,s+c.min),max:Math.pow(10,i-c.max)}}function jH(r,e){return e&&(e[r.id]||e[r.axis])||{}}function T5(r,e,t,n,s){let i=t[n];if(i==="original"){const a=r.originalScaleLimits[e.id][n];i=qt(a.options,a.scale)}return qt(i,s)}function VH(r,e,t){const n=r.getValueForPixel(e),s=r.getValueForPixel(t);return{min:Math.min(n,s),max:Math.max(n,s)}}function $H(r,{min:e,max:t,minLimit:n,maxLimit:s},i){const a=(r-t+e)/2;e-=a,t+=a;const o=i.min.options??i.min.scale,l=i.max.options??i.max.scale,c=r/1e6;return wd(e,o,c)&&(e=o),wd(t,l,c)&&(t=l),e<n?(e=n,t=Math.min(n+r,s)):t>s&&(t=s,e=Math.max(s-r,n)),{min:e,max:t}}function Wd(r,{min:e,max:t},n,s=!1){const i=Rn(r.chart),{options:a}=r,o=jH(r,n),{minRange:l=0}=o,c=T5(i,r,o,"min",-1/0),A=T5(i,r,o,"max",1/0);if(s==="pan"&&(e<c||t>A))return!0;const d=r.max-r.min,h=s?Math.max(t-e,l):d;if(s&&h===l&&d<=l)return!0;const u=$H(h,{min:e,max:t,minLimit:c,maxLimit:A},i.originalScaleLimits[r.id]);return a.min=u.min,a.max=u.max,i.updatedScaleLimits[r.id]=u,r.parse(u.min)!==r.min||r.parse(u.max)!==r.max}function GH(r,e,t,n){const s=$T(r,e,t),i={min:r.min+s.min,max:r.max-s.max};return Wd(r,i,n,!0)}function zH(r,e,t,n){const s=HH(r,e,t);return Wd(r,s,n,!0)}function KH(r,e,t,n){Wd(r,VH(r,e,t),n,!0)}const F5=r=>r===0||isNaN(r)?0:r<0?Math.min(Math.round(r),-1):Math.max(Math.round(r),1);function qH(r){const t=r.getLabels().length-1;r.min>0&&(r.min-=1),r.max<t&&(r.max+=1)}function WH(r,e,t,n){const s=$T(r,e,t);r.min===r.max&&e<1&&qH(r);const i={min:r.min+F5(s.min),max:r.max-F5(s.max)};return Wd(r,i,n,!0)}function YH(r){return r.isHorizontal()?r.width:r.height}function XH(r,e,t){const s=r.getLabels().length-1;let{min:i,max:a}=r;const o=Math.max(a-i,1),l=Math.round(YH(r)/Math.max(o,10)),c=Math.round(Math.abs(e/l));let A;return e<-l?(a=Math.min(a+c,s),i=o===1?a:a-o,A=a===s):e>l&&(i=Math.max(0,i-c),a=o===1?i:i+o,A=i===0),Wd(r,{min:i,max:a},t)||A}const JH={second:500,minute:30*1e3,hour:1800*1e3,day:720*60*1e3,week:3.5*24*60*60*1e3,month:360*60*60*1e3,quarter:1440*60*60*1e3,year:4368*60*60*1e3};function GT(r,e,t,n=!1){const{min:s,max:i,options:a}=r,o=a.time&&a.time.round,l=JH[o]||0,c=r.getValueForPixel(r.getPixelForValue(s+l)-e),A=r.getValueForPixel(r.getPixelForValue(i+l)-e);return isNaN(c)||isNaN(A)?!0:Wd(r,{min:c,max:A},t,n?"pan":!1)}function L5(r,e,t){return GT(r,e,t,!0)}const Vv={category:WH,default:GH,logarithmic:zH},$v={default:KH},Gv={category:XH,default:GT,logarithmic:L5,timeseries:L5};function ZH(r,e,t){const{id:n,options:{min:s,max:i}}=r;if(!e[n]||!t[n])return!0;const a=t[n];return a.min!==s||a.max!==i}function U5(r,e){xr(r,(t,n)=>{e[n]||delete r[n]})}function yh(r,e){const{scales:t}=r,{originalScaleLimits:n,updatedScaleLimits:s}=e;return xr(t,function(i){ZH(i,n,s)&&(n[i.id]={min:{scale:i.min,options:i.options.min},max:{scale:i.max,options:i.options.max}})}),U5(n,t),U5(s,t),n}function M5(r,e,t,n){const s=Vv[r.type]||Vv.default;zt(s,[r,e,t,n])}function N5(r,e,t,n){const s=$v[r.type]||$v.default;zt(s,[r,e,t,n])}function e9(r){const e=r.chartArea;return{x:(e.left+e.right)/2,y:(e.top+e.bottom)/2}}function $x(r,e,t="none",n="api"){const{x:s=1,y:i=1,focalPoint:a=e9(r)}=typeof e=="number"?{x:e,y:e}:e,o=Rn(r),{options:{limits:l,zoom:c}}=o;yh(r,o);const A=s!==1,d=i!==1,h=HT(c,a,r);xr(h||r.scales,function(u){u.isHorizontal()&&A?M5(u,s,a,l):!u.isHorizontal()&&d&&M5(u,i,a,l)}),r.update(t),zt(c.onZoom,[{chart:r,trigger:n}])}function zT(r,e,t,n="none",s="api"){const i=Rn(r),{options:{limits:a,zoom:o}}=i,{mode:l="xy"}=o;yh(r,i);const c=bA(l,"x",r),A=bA(l,"y",r);xr(r.scales,function(d){d.isHorizontal()&&c?N5(d,e.x,t.x,a):!d.isHorizontal()&&A&&N5(d,e.y,t.y,a)}),r.update(n),zt(o.onZoom,[{chart:r,trigger:s}])}function t9(r,e,t,n="none",s="api"){var o;const i=Rn(r);yh(r,i);const a=r.scales[e];Wd(a,t,void 0,!0),r.update(n),zt((o=i.options.zoom)==null?void 0:o.onZoom,[{chart:r,trigger:s}])}function r9(r,e="default"){const t=Rn(r),n=yh(r,t);xr(r.scales,function(s){const i=s.options;n[s.id]?(i.min=n[s.id].min.options,i.max=n[s.id].max.options):(delete i.min,delete i.max),delete t.updatedScaleLimits[s.id]}),r.update(e),zt(t.options.zoom.onZoomComplete,[{chart:r}])}function n9(r,e){const t=r.originalScaleLimits[e];if(!t)return;const{min:n,max:s}=t;return qt(s.options,s.scale)-qt(n.options,n.scale)}function s9(r){const e=Rn(r);let t=1,n=1;return xr(r.scales,function(s){const i=n9(e,s.id);if(i){const a=Math.round(i/(s.max-s.min)*100)/100;t=Math.min(t,a),n=Math.max(n,a)}}),t<1?t:n}function P5(r,e,t,n){const{panDelta:s}=n,i=s[r.id]||0;eo(i)===eo(e)&&(e+=i);const a=Gv[r.type]||Gv.default;zt(a,[r,e,t])?s[r.id]=0:s[r.id]=e}function KT(r,e,t,n="none"){const{x:s=0,y:i=0}=typeof e=="number"?{x:e,y:e}:e,a=Rn(r),{options:{pan:o,limits:l}}=a,{onPan:c}=o||{};yh(r,a);const A=s!==0,d=i!==0;xr(t||r.scales,function(h){h.isHorizontal()&&A?P5(h,s,l,a):!h.isHorizontal()&&d&&P5(h,i,l,a)}),r.update(n),zt(c,[{chart:r}])}function qT(r){const e=Rn(r);yh(r,e);const t={};for(const n of Object.keys(r.scales)){const{min:s,max:i}=e.originalScaleLimits[n]||{min:{},max:{}};t[n]={min:s.scale,max:i.scale}}return t}function i9(r){const e=Rn(r),t={};for(const n of Object.keys(r.scales))t[n]=e.updatedScaleLimits[n];return t}function a9(r){const e=qT(r);for(const t of Object.keys(r.scales)){const{min:n,max:s}=e[t];if(n!==void 0&&r.scales[t].min!==n||s!==void 0&&r.scales[t].max!==s)return!0}return!1}function D5(r){const e=Rn(r);return e.panning||e.dragging}const R5=(r,e,t)=>Math.min(t,Math.max(e,r));function oa(r,e){const{handlers:t}=Rn(r),n=t[e];n&&n.target&&(n.target.removeEventListener(e,n),delete t[e])}function $f(r,e,t,n){const{handlers:s,options:i}=Rn(r),a=s[t];if(a&&a.target===e)return;oa(r,t),s[t]=l=>n(r,l,i),s[t].target=e;const o=t==="wheel"?!1:void 0;e.addEventListener(t,s[t],{passive:o})}function o9(r,e){const t=Rn(r);t.dragStart&&(t.dragging=!0,t.dragEnd=e,r.update("none"))}function l9(r,e){const t=Rn(r);!t.dragStart||e.key!=="Escape"||(oa(r,"keydown"),t.dragging=!1,t.dragStart=t.dragEnd=null,r.update("none"))}function zv(r,e){if(r.target!==e.canvas){const t=e.canvas.getBoundingClientRect();return{x:r.clientX-t.left,y:r.clientY-t.top}}return Go(r,e)}function WT(r,e,t){const{onZoomStart:n,onZoomRejected:s}=t;if(n){const i=zv(e,r);if(zt(n,[{chart:r,event:e,point:i}])===!1)return zt(s,[{chart:r,event:e}]),!1}}function c9(r,e){if(r.legend){const i=Go(e,r);if(Yo(i,r.legend))return}const t=Rn(r),{pan:n,zoom:s={}}=t.options;if(e.button!==0||QT(pg(n),e)||Vx(pg(s.drag),e))return zt(s.onZoomRejected,[{chart:r,event:e}]);WT(r,e,s)!==!1&&(t.dragStart=e,$f(r,r.canvas.ownerDocument,"mousemove",o9),$f(r,window.document,"keydown",l9))}function A9({begin:r,end:e},t){let n=e.x-r.x,s=e.y-r.y;const i=Math.abs(n/s);i>t?n=Math.sign(n)*Math.abs(s*t):i<t&&(s=Math.sign(s)*Math.abs(n/t)),e.x=r.x+n,e.y=r.y+s}function O5(r,e,t,{min:n,max:s,prop:i}){r[n]=R5(Math.min(t.begin[i],t.end[i]),e[n],e[s]),r[s]=R5(Math.max(t.begin[i],t.end[i]),e[n],e[s])}function d9(r,e,t){const n={begin:zv(e.dragStart,r),end:zv(e.dragEnd,r)};if(t){const s=r.chartArea.width/r.chartArea.height;A9(n,s)}return n}function YT(r,e,t,n){const s=bA(e,"x",r),i=bA(e,"y",r),{top:a,left:o,right:l,bottom:c,width:A,height:d}=r.chartArea,h={top:a,left:o,right:l,bottom:c},u=d9(r,t,n&&s&&i);s&&O5(h,r.chartArea,u,{min:"left",max:"right",prop:"x"}),i&&O5(h,r.chartArea,u,{min:"top",max:"bottom",prop:"y"});const p=h.right-h.left,f=h.bottom-h.top;return{...h,width:p,height:f,zoomX:s&&p?1+(A-p)/A:1,zoomY:i&&f?1+(d-f)/d:1}}function u9(r,e){const t=Rn(r);if(!t.dragStart)return;oa(r,"mousemove");const{mode:n,onZoomComplete:s,drag:{threshold:i=0,maintainAspectRatio:a}}=t.options.zoom,o=YT(r,n,{dragStart:t.dragStart,dragEnd:e},a),l=bA(n,"x",r)?o.width:0,c=bA(n,"y",r)?o.height:0,A=Math.sqrt(l*l+c*c);if(t.dragStart=t.dragEnd=null,A<=i){t.dragging=!1,r.update("none");return}zT(r,{x:o.left,y:o.top},{x:o.right,y:o.bottom},"zoom","drag"),t.dragging=!1,t.filterNextClick=!0,zt(s,[{chart:r}])}function h9(r,e,t){if(Vx(pg(t.wheel),e)){zt(t.onZoomRejected,[{chart:r,event:e}]);return}if(WT(r,e,t)!==!1&&(e.cancelable&&e.preventDefault(),e.deltaY!==void 0))return!0}function f9(r,e){const{handlers:{onZoomComplete:t},options:{zoom:n}}=Rn(r);if(!h9(r,e,n))return;const s=e.target.getBoundingClientRect(),i=n.wheel.speed,a=e.deltaY>=0?2-1/(1-i):1+i,o={x:a,y:a,focalPoint:{x:e.clientX-s.left,y:e.clientY-s.top}};$x(r,o,"zoom","wheel"),zt(t,[{chart:r}])}function g9(r,e,t,n){t&&(Rn(r).handlers[e]=RH(()=>zt(t,[{chart:r}]),n))}function p9(r,e){const t=r.canvas,{wheel:n,drag:s,onZoomComplete:i}=e.zoom;n.enabled?($f(r,t,"wheel",f9),g9(r,"onZoomComplete",i,250)):oa(r,"wheel"),s.enabled?($f(r,t,"mousedown",c9),$f(r,t.ownerDocument,"mouseup",u9)):(oa(r,"mousedown"),oa(r,"mousemove"),oa(r,"mouseup"),oa(r,"keydown"))}function m9(r){oa(r,"mousedown"),oa(r,"mousemove"),oa(r,"mouseup"),oa(r,"wheel"),oa(r,"click"),oa(r,"keydown")}function b9(r,e){return function(t,n){const{pan:s,zoom:i={}}=e.options;if(!s||!s.enabled)return!1;const a=n&&n.srcEvent;return a&&!e.panning&&n.pointerType==="mouse"&&(Vx(pg(s),a)||QT(pg(i.drag),a))?(zt(s.onPanRejected,[{chart:r,event:n}]),!1):!0}}function y9(r,e){const t=Math.abs(r.clientX-e.clientX),n=Math.abs(r.clientY-e.clientY),s=t/n;let i,a;return s>.3&&s<1.7?i=a=!0:t>n?i=!0:a=!0,{x:i,y:a}}function XT(r,e,t){if(e.scale){const{center:n,pointers:s}=t,i=1/e.scale*t.scale,a=t.target.getBoundingClientRect(),o=y9(s[0],s[1]),l=e.options.zoom.mode,c={x:o.x&&bA(l,"x",r)?i:1,y:o.y&&bA(l,"y",r)?i:1,focalPoint:{x:n.x-a.left,y:n.y-a.top}};$x(r,c,"zoom","pinch"),e.scale=t.scale}}function w9(r,e,t){if(e.options.zoom.pinch.enabled){const n=Go(t,r);zt(e.options.zoom.onZoomStart,[{chart:r,event:t,point:n}])===!1?(e.scale=null,zt(e.options.zoom.onZoomRejected,[{chart:r,event:t}])):e.scale=1}}function v9(r,e,t){e.scale&&(XT(r,e,t),e.scale=null,zt(e.options.zoom.onZoomComplete,[{chart:r}]))}function JT(r,e,t){const n=e.delta;n&&(e.panning=!0,KT(r,{x:t.deltaX-n.x,y:t.deltaY-n.y},e.panScales),e.delta={x:t.deltaX,y:t.deltaY})}function x9(r,e,t){const{enabled:n,onPanStart:s,onPanRejected:i}=e.options.pan;if(!n)return;const a=t.target.getBoundingClientRect(),o={x:t.center.x-a.left,y:t.center.y-a.top};if(zt(s,[{chart:r,event:t,point:o}])===!1)return zt(i,[{chart:r,event:t}]);e.panScales=HT(e.options.pan,o,r),e.delta={x:0,y:0},JT(r,e,t)}function _9(r,e){e.delta=null,e.panning&&(e.panning=!1,e.filterNextClick=!0,zt(e.options.pan.onPanComplete,[{chart:r}]))}const Kv=new WeakMap;function Q5(r,e){const t=Rn(r),n=r.canvas,{pan:s,zoom:i}=e,a=new Vf.Manager(n);i&&i.pinch.enabled&&(a.add(new Vf.Pinch),a.on("pinchstart",o=>w9(r,t,o)),a.on("pinch",o=>XT(r,t,o)),a.on("pinchend",o=>v9(r,t,o))),s&&s.enabled&&(a.add(new Vf.Pan({threshold:s.threshold,enable:b9(r,t)})),a.on("panstart",o=>x9(r,t,o)),a.on("panmove",o=>JT(r,t,o)),a.on("panend",()=>_9(r,t))),Kv.set(r,a)}function H5(r){const e=Kv.get(r);e&&(e.remove("pinchstart"),e.remove("pinch"),e.remove("pinchend"),e.remove("panstart"),e.remove("pan"),e.remove("panend"),e.destroy(),Kv.delete(r))}function B9(r,e){var a,o,l,c;const{pan:t,zoom:n}=r,{pan:s,zoom:i}=e;return((o=(a=n==null?void 0:n.zoom)==null?void 0:a.pinch)==null?void 0:o.enabled)!==((c=(l=i==null?void 0:i.zoom)==null?void 0:l.pinch)==null?void 0:c.enabled)||(t==null?void 0:t.enabled)!==(s==null?void 0:s.enabled)||(t==null?void 0:t.threshold)!==(s==null?void 0:s.threshold)}var C9="2.2.0";function Zp(r,e,t){const n=t.zoom.drag,{dragStart:s,dragEnd:i}=Rn(r);if(n.drawTime!==e||!i)return;const{left:a,top:o,width:l,height:c}=YT(r,t.zoom.mode,{dragStart:s,dragEnd:i},n.maintainAspectRatio),A=r.ctx;A.save(),A.beginPath(),A.fillStyle=n.backgroundColor||"rgba(225,225,225,0.3)",A.fillRect(a,o,l,c),n.borderWidth>0&&(A.lineWidth=n.borderWidth,A.strokeStyle=n.borderColor||"rgba(225,225,225)",A.strokeRect(a,o,l,c)),A.restore()}var ZT={id:"zoom",version:C9,defaults:{pan:{enabled:!1,mode:"xy",threshold:10,modifierKey:null},zoom:{wheel:{enabled:!1,speed:.1,modifierKey:null},drag:{enabled:!1,drawTime:"beforeDatasetsDraw",modifierKey:null},pinch:{enabled:!1},mode:"xy"}},start:function(r,e,t){const n=Rn(r);n.options=t,Object.prototype.hasOwnProperty.call(t.zoom,"enabled")&&console.warn("The option `zoom.enabled` is no longer supported. Please use `zoom.wheel.enabled`, `zoom.drag.enabled`, or `zoom.pinch.enabled`."),(Object.prototype.hasOwnProperty.call(t.zoom,"overScaleMode")||Object.prototype.hasOwnProperty.call(t.pan,"overScaleMode"))&&console.warn("The option `overScaleMode` is deprecated. Please use `scaleMode` instead (and update `mode` as desired)."),Vf&&Q5(r,t),r.pan=(s,i,a)=>KT(r,s,i,a),r.zoom=(s,i)=>$x(r,s,i),r.zoomRect=(s,i,a)=>zT(r,s,i,a),r.zoomScale=(s,i,a)=>t9(r,s,i,a),r.resetZoom=s=>r9(r,s),r.getZoomLevel=()=>s9(r),r.getInitialScaleBounds=()=>qT(r),r.getZoomedScaleBounds=()=>i9(r),r.isZoomedOrPanned=()=>a9(r),r.isZoomingOrPanning=()=>D5(r)},beforeEvent(r,{event:e}){if(D5(r))return!1;if(e.type==="click"||e.type==="mouseup"){const t=Rn(r);if(t.filterNextClick)return t.filterNextClick=!1,!1}},beforeUpdate:function(r,e,t){const n=Rn(r),s=n.options;n.options=t,B9(s,t)&&(H5(r),Q5(r,t)),p9(r,t)},beforeDatasetsDraw(r,e,t){Zp(r,"beforeDatasetsDraw",t)},afterDatasetsDraw(r,e,t){Zp(r,"afterDatasetsDraw",t)},beforeDraw(r,e,t){Zp(r,"beforeDraw",t)},afterDraw(r,e,t){Zp(r,"afterDraw",t)},stop:function(r){m9(r),Vf&&H5(r),QH(r)},panFunctions:Gv,zoomFunctions:Vv,zoomRectFunctions:$v};/*!
 * html2canvas 1.4.1 <https://html2canvas.hertzen.com>
 * Copyright (c) 2022 Niklas von Hertzen <https://hertzen.com>
 * Released under MIT License
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var qv=function(r,e){return qv=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])},qv(r,e)};function _o(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");qv(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Wv=function(){return Wv=Object.assign||function(e){for(var t,n=1,s=arguments.length;n<s;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},Wv.apply(this,arguments)};function Qi(r,e,t,n){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(A){try{c(n.next(A))}catch(d){a(d)}}function l(A){try{c(n.throw(A))}catch(d){a(d)}}function c(A){A.done?i(A.value):s(A.value).then(o,l)}c((n=n.apply(r,[])).next())})}function xi(r,e){var t={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,a;return a={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function o(c){return function(A){return l([c,A])}}function l(c){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,s&&(i=c[0]&2?s.return:c[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,c[1])).done)return i;switch(s=0,i&&(c=[c[0]&2,i.value]),c[0]){case 0:case 1:i=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,s=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(i=t.trys,!(i=i.length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){t.label=c[1];break}if(c[0]===6&&t.label<i[1]){t.label=i[1],i=c;break}if(i&&t.label<i[2]){t.label=i[2],t.ops.push(c);break}i[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(r,t)}catch(A){c=[6,A],s=0}finally{n=i=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function e0(r,e,t){if(arguments.length===2)for(var n=0,s=e.length,i;n<s;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return r.concat(i||e)}var ec=(function(){function r(e,t,n,s){this.left=e,this.top=t,this.width=n,this.height=s}return r.prototype.add=function(e,t,n,s){return new r(this.left+e,this.top+t,this.width+n,this.height+s)},r.fromClientRect=function(e,t){return new r(t.left+e.windowBounds.left,t.top+e.windowBounds.top,t.width,t.height)},r.fromDOMRectList=function(e,t){var n=Array.from(t).find(function(s){return s.width!==0});return n?new r(n.left+e.windowBounds.left,n.top+e.windowBounds.top,n.width,n.height):r.EMPTY},r.EMPTY=new r(0,0,0,0),r})(),Pb=function(r,e){return ec.fromClientRect(r,e.getBoundingClientRect())},S9=function(r){var e=r.body,t=r.documentElement;if(!e||!t)throw new Error("Unable to get document size");var n=Math.max(Math.max(e.scrollWidth,t.scrollWidth),Math.max(e.offsetWidth,t.offsetWidth),Math.max(e.clientWidth,t.clientWidth)),s=Math.max(Math.max(e.scrollHeight,t.scrollHeight),Math.max(e.offsetHeight,t.offsetHeight),Math.max(e.clientHeight,t.clientHeight));return new ec(0,0,n,s)},Db=function(r){for(var e=[],t=0,n=r.length;t<n;){var s=r.charCodeAt(t++);if(s>=55296&&s<=56319&&t<n){var i=r.charCodeAt(t++);(i&64512)===56320?e.push(((s&1023)<<10)+(i&1023)+65536):(e.push(s),t--)}else e.push(s)}return e},ss=function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];if(String.fromCodePoint)return String.fromCodePoint.apply(String,r);var t=r.length;if(!t)return"";for(var n=[],s=-1,i="";++s<t;){var a=r[s];a<=65535?n.push(a):(a-=65536,n.push((a>>10)+55296,a%1024+56320)),(s+1===t||n.length>16384)&&(i+=String.fromCharCode.apply(String,n),n.length=0)}return i},j5="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",k9=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var t0=0;t0<j5.length;t0++)k9[j5.charCodeAt(t0)]=t0;var V5="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",mf=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var r0=0;r0<V5.length;r0++)mf[V5.charCodeAt(r0)]=r0;var E9=function(r){var e=r.length*.75,t=r.length,n,s=0,i,a,o,l;r[r.length-1]==="="&&(e--,r[r.length-2]==="="&&e--);var c=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(e):new Array(e),A=Array.isArray(c)?c:new Uint8Array(c);for(n=0;n<t;n+=4)i=mf[r.charCodeAt(n)],a=mf[r.charCodeAt(n+1)],o=mf[r.charCodeAt(n+2)],l=mf[r.charCodeAt(n+3)],A[s++]=i<<2|a>>4,A[s++]=(a&15)<<4|o>>2,A[s++]=(o&3)<<6|l&63;return c},I9=function(r){for(var e=r.length,t=[],n=0;n<e;n+=2)t.push(r[n+1]<<8|r[n]);return t},T9=function(r){for(var e=r.length,t=[],n=0;n<e;n+=4)t.push(r[n+3]<<24|r[n+2]<<16|r[n+1]<<8|r[n]);return t},_d=5,Gx=11,aw=2,F9=Gx-_d,e4=65536>>_d,L9=1<<_d,ow=L9-1,U9=1024>>_d,M9=e4+U9,N9=M9,P9=32,D9=N9+P9,R9=65536>>Gx,O9=1<<F9,Q9=O9-1,$5=function(r,e,t){return r.slice?r.slice(e,t):new Uint16Array(Array.prototype.slice.call(r,e,t))},H9=function(r,e,t){return r.slice?r.slice(e,t):new Uint32Array(Array.prototype.slice.call(r,e,t))},j9=function(r,e){var t=E9(r),n=Array.isArray(t)?T9(t):new Uint32Array(t),s=Array.isArray(t)?I9(t):new Uint16Array(t),i=24,a=$5(s,i/2,n[4]/2),o=n[5]===2?$5(s,(i+n[4])/2):H9(n,Math.ceil((i+n[4])/4));return new V9(n[0],n[1],n[2],n[3],a,o)},V9=(function(){function r(e,t,n,s,i,a){this.initialValue=e,this.errorValue=t,this.highStart=n,this.highValueIndex=s,this.index=i,this.data=a}return r.prototype.get=function(e){var t;if(e>=0){if(e<55296||e>56319&&e<=65535)return t=this.index[e>>_d],t=(t<<aw)+(e&ow),this.data[t];if(e<=65535)return t=this.index[e4+(e-55296>>_d)],t=(t<<aw)+(e&ow),this.data[t];if(e<this.highStart)return t=D9-R9+(e>>Gx),t=this.index[t],t+=e>>_d&Q9,t=this.index[t],t=(t<<aw)+(e&ow),this.data[t];if(e<=1114111)return this.data[this.highValueIndex]}return this.errorValue},r})(),G5="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",$9=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var n0=0;n0<G5.length;n0++)$9[G5.charCodeAt(n0)]=n0;var G9="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",z5=50,z9=1,t4=2,r4=3,K9=4,q9=5,K5=7,n4=8,q5=9,Xc=10,Yv=11,W5=12,Xv=13,W9=14,bf=15,Jv=16,s0=17,nf=18,Y9=19,Y5=20,Zv=21,sf=22,lw=23,hu=24,Ca=25,yf=26,wf=27,fu=28,X9=29,ad=30,J9=31,i0=32,a0=33,e1=34,t1=35,r1=36,mg=37,n1=38,tm=39,rm=40,cw=41,s4=42,Z9=43,ej=[9001,65288],i4="!",kr="",o0="",s1=j9(G9),Tl=[ad,r1],i1=[z9,t4,r4,q9],a4=[Xc,n4],X5=[wf,yf],tj=i1.concat(a4),J5=[n1,tm,rm,e1,t1],rj=[bf,Xv],nj=function(r,e){e===void 0&&(e="strict");var t=[],n=[],s=[];return r.forEach(function(i,a){var o=s1.get(i);if(o>z5?(s.push(!0),o-=z5):s.push(!1),["normal","auto","loose"].indexOf(e)!==-1&&[8208,8211,12316,12448].indexOf(i)!==-1)return n.push(a),t.push(Jv);if(o===K9||o===Yv){if(a===0)return n.push(a),t.push(ad);var l=t[a-1];return tj.indexOf(l)===-1?(n.push(n[a-1]),t.push(l)):(n.push(a),t.push(ad))}if(n.push(a),o===J9)return t.push(e==="strict"?Zv:mg);if(o===s4||o===X9)return t.push(ad);if(o===Z9)return i>=131072&&i<=196605||i>=196608&&i<=262141?t.push(mg):t.push(ad);t.push(o)}),[n,t,s]},Aw=function(r,e,t,n){var s=n[t];if(Array.isArray(r)?r.indexOf(s)!==-1:r===s)for(var i=t;i<=n.length;){i++;var a=n[i];if(a===e)return!0;if(a!==Xc)break}if(s===Xc)for(var i=t;i>0;){i--;var o=n[i];if(Array.isArray(r)?r.indexOf(o)!==-1:r===o)for(var l=t;l<=n.length;){l++;var a=n[l];if(a===e)return!0;if(a!==Xc)break}if(o!==Xc)break}return!1},Z5=function(r,e){for(var t=r;t>=0;){var n=e[t];if(n===Xc)t--;else return n}return 0},sj=function(r,e,t,n,s){if(t[n]===0)return kr;var i=n-1;if(Array.isArray(s)&&s[i]===!0)return kr;var a=i-1,o=i+1,l=e[i],c=a>=0?e[a]:0,A=e[o];if(l===t4&&A===r4)return kr;if(i1.indexOf(l)!==-1)return i4;if(i1.indexOf(A)!==-1||a4.indexOf(A)!==-1)return kr;if(Z5(i,e)===n4)return o0;if(s1.get(r[i])===Yv||(l===i0||l===a0)&&s1.get(r[o])===Yv||l===K5||A===K5||l===q5||[Xc,Xv,bf].indexOf(l)===-1&&A===q5||[s0,nf,Y9,hu,fu].indexOf(A)!==-1||Z5(i,e)===sf||Aw(lw,sf,i,e)||Aw([s0,nf],Zv,i,e)||Aw(W5,W5,i,e))return kr;if(l===Xc)return o0;if(l===lw||A===lw)return kr;if(A===Jv||l===Jv)return o0;if([Xv,bf,Zv].indexOf(A)!==-1||l===W9||c===r1&&rj.indexOf(l)!==-1||l===fu&&A===r1||A===Y5||Tl.indexOf(A)!==-1&&l===Ca||Tl.indexOf(l)!==-1&&A===Ca||l===wf&&[mg,i0,a0].indexOf(A)!==-1||[mg,i0,a0].indexOf(l)!==-1&&A===yf||Tl.indexOf(l)!==-1&&X5.indexOf(A)!==-1||X5.indexOf(l)!==-1&&Tl.indexOf(A)!==-1||[wf,yf].indexOf(l)!==-1&&(A===Ca||[sf,bf].indexOf(A)!==-1&&e[o+1]===Ca)||[sf,bf].indexOf(l)!==-1&&A===Ca||l===Ca&&[Ca,fu,hu].indexOf(A)!==-1)return kr;if([Ca,fu,hu,s0,nf].indexOf(A)!==-1)for(var d=i;d>=0;){var h=e[d];if(h===Ca)return kr;if([fu,hu].indexOf(h)!==-1)d--;else break}if([wf,yf].indexOf(A)!==-1)for(var d=[s0,nf].indexOf(l)!==-1?a:i;d>=0;){var h=e[d];if(h===Ca)return kr;if([fu,hu].indexOf(h)!==-1)d--;else break}if(n1===l&&[n1,tm,e1,t1].indexOf(A)!==-1||[tm,e1].indexOf(l)!==-1&&[tm,rm].indexOf(A)!==-1||[rm,t1].indexOf(l)!==-1&&A===rm||J5.indexOf(l)!==-1&&[Y5,yf].indexOf(A)!==-1||J5.indexOf(A)!==-1&&l===wf||Tl.indexOf(l)!==-1&&Tl.indexOf(A)!==-1||l===hu&&Tl.indexOf(A)!==-1||Tl.concat(Ca).indexOf(l)!==-1&&A===sf&&ej.indexOf(r[o])===-1||Tl.concat(Ca).indexOf(A)!==-1&&l===nf)return kr;if(l===cw&&A===cw){for(var u=t[i],p=1;u>0&&(u--,e[u]===cw);)p++;if(p%2!==0)return kr}return l===i0&&A===a0?kr:o0},ij=function(r,e){e||(e={lineBreak:"normal",wordBreak:"normal"});var t=nj(r,e.lineBreak),n=t[0],s=t[1],i=t[2];(e.wordBreak==="break-all"||e.wordBreak==="break-word")&&(s=s.map(function(o){return[Ca,ad,s4].indexOf(o)!==-1?mg:o}));var a=e.wordBreak==="keep-all"?i.map(function(o,l){return o&&r[l]>=19968&&r[l]<=40959}):void 0;return[n,s,a]},aj=(function(){function r(e,t,n,s){this.codePoints=e,this.required=t===i4,this.start=n,this.end=s}return r.prototype.slice=function(){return ss.apply(void 0,this.codePoints.slice(this.start,this.end))},r})(),oj=function(r,e){var t=Db(r),n=ij(t,e),s=n[0],i=n[1],a=n[2],o=t.length,l=0,c=0;return{next:function(){if(c>=o)return{done:!0,value:null};for(var A=kr;c<o&&(A=sj(t,i,s,++c,a))===kr;);if(A!==kr||c===o){var d=new aj(t,A,l,c);return l=c,{value:d,done:!1}}return{done:!0,value:null}}}},lj=1,cj=2,Qg=4,eC=8,Hm=10,tC=47,Gf=92,Aj=9,dj=32,l0=34,af=61,uj=35,hj=36,fj=37,c0=39,A0=40,of=41,gj=95,aa=45,pj=33,mj=60,bj=62,yj=64,wj=91,vj=93,xj=61,_j=123,d0=63,Bj=125,rC=124,Cj=126,Sj=128,nC=65533,dw=42,ud=43,kj=44,Ej=58,Ij=59,bg=46,Tj=0,Fj=8,Lj=11,Uj=14,Mj=31,Nj=127,Ro=-1,o4=48,l4=97,c4=101,Pj=102,Dj=117,Rj=122,A4=65,d4=69,u4=70,Oj=85,Qj=90,ki=function(r){return r>=o4&&r<=57},Hj=function(r){return r>=55296&&r<=57343},gu=function(r){return ki(r)||r>=A4&&r<=u4||r>=l4&&r<=Pj},jj=function(r){return r>=l4&&r<=Rj},Vj=function(r){return r>=A4&&r<=Qj},$j=function(r){return jj(r)||Vj(r)},Gj=function(r){return r>=Sj},u0=function(r){return r===Hm||r===Aj||r===dj},jm=function(r){return $j(r)||Gj(r)||r===gj},sC=function(r){return jm(r)||ki(r)||r===aa},zj=function(r){return r>=Tj&&r<=Fj||r===Lj||r>=Uj&&r<=Mj||r===Nj},Hc=function(r,e){return r!==Gf?!1:e!==Hm},h0=function(r,e,t){return r===aa?jm(e)||Hc(e,t):jm(r)?!0:!!(r===Gf&&Hc(r,e))},uw=function(r,e,t){return r===ud||r===aa?ki(e)?!0:e===bg&&ki(t):ki(r===bg?e:r)},Kj=function(r){var e=0,t=1;(r[e]===ud||r[e]===aa)&&(r[e]===aa&&(t=-1),e++);for(var n=[];ki(r[e]);)n.push(r[e++]);var s=n.length?parseInt(ss.apply(void 0,n),10):0;r[e]===bg&&e++;for(var i=[];ki(r[e]);)i.push(r[e++]);var a=i.length,o=a?parseInt(ss.apply(void 0,i),10):0;(r[e]===d4||r[e]===c4)&&e++;var l=1;(r[e]===ud||r[e]===aa)&&(r[e]===aa&&(l=-1),e++);for(var c=[];ki(r[e]);)c.push(r[e++]);var A=c.length?parseInt(ss.apply(void 0,c),10):0;return t*(s+o*Math.pow(10,-a))*Math.pow(10,l*A)},qj={type:2},Wj={type:3},Yj={type:4},Xj={type:13},Jj={type:8},Zj={type:21},eV={type:9},tV={type:10},rV={type:11},nV={type:12},sV={type:14},f0={type:23},iV={type:1},aV={type:25},oV={type:24},lV={type:26},cV={type:27},AV={type:28},dV={type:29},uV={type:31},a1={type:32},h4=(function(){function r(){this._value=[]}return r.prototype.write=function(e){this._value=this._value.concat(Db(e))},r.prototype.read=function(){for(var e=[],t=this.consumeToken();t!==a1;)e.push(t),t=this.consumeToken();return e},r.prototype.consumeToken=function(){var e=this.consumeCodePoint();switch(e){case l0:return this.consumeStringToken(l0);case uj:var t=this.peekCodePoint(0),n=this.peekCodePoint(1),s=this.peekCodePoint(2);if(sC(t)||Hc(n,s)){var i=h0(t,n,s)?cj:lj,a=this.consumeName();return{type:5,value:a,flags:i}}break;case hj:if(this.peekCodePoint(0)===af)return this.consumeCodePoint(),Xj;break;case c0:return this.consumeStringToken(c0);case A0:return qj;case of:return Wj;case dw:if(this.peekCodePoint(0)===af)return this.consumeCodePoint(),sV;break;case ud:if(uw(e,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(e),this.consumeNumericToken();break;case kj:return Yj;case aa:var o=e,l=this.peekCodePoint(0),c=this.peekCodePoint(1);if(uw(o,l,c))return this.reconsumeCodePoint(e),this.consumeNumericToken();if(h0(o,l,c))return this.reconsumeCodePoint(e),this.consumeIdentLikeToken();if(l===aa&&c===bj)return this.consumeCodePoint(),this.consumeCodePoint(),oV;break;case bg:if(uw(e,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(e),this.consumeNumericToken();break;case tC:if(this.peekCodePoint(0)===dw)for(this.consumeCodePoint();;){var A=this.consumeCodePoint();if(A===dw&&(A=this.consumeCodePoint(),A===tC))return this.consumeToken();if(A===Ro)return this.consumeToken()}break;case Ej:return lV;case Ij:return cV;case mj:if(this.peekCodePoint(0)===pj&&this.peekCodePoint(1)===aa&&this.peekCodePoint(2)===aa)return this.consumeCodePoint(),this.consumeCodePoint(),aV;break;case yj:var d=this.peekCodePoint(0),h=this.peekCodePoint(1),u=this.peekCodePoint(2);if(h0(d,h,u)){var a=this.consumeName();return{type:7,value:a}}break;case wj:return AV;case Gf:if(Hc(e,this.peekCodePoint(0)))return this.reconsumeCodePoint(e),this.consumeIdentLikeToken();break;case vj:return dV;case xj:if(this.peekCodePoint(0)===af)return this.consumeCodePoint(),Jj;break;case _j:return rV;case Bj:return nV;case Dj:case Oj:var p=this.peekCodePoint(0),f=this.peekCodePoint(1);return p===ud&&(gu(f)||f===d0)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(e),this.consumeIdentLikeToken();case rC:if(this.peekCodePoint(0)===af)return this.consumeCodePoint(),eV;if(this.peekCodePoint(0)===rC)return this.consumeCodePoint(),Zj;break;case Cj:if(this.peekCodePoint(0)===af)return this.consumeCodePoint(),tV;break;case Ro:return a1}return u0(e)?(this.consumeWhiteSpace(),uV):ki(e)?(this.reconsumeCodePoint(e),this.consumeNumericToken()):jm(e)?(this.reconsumeCodePoint(e),this.consumeIdentLikeToken()):{type:6,value:ss(e)}},r.prototype.consumeCodePoint=function(){var e=this._value.shift();return typeof e>"u"?-1:e},r.prototype.reconsumeCodePoint=function(e){this._value.unshift(e)},r.prototype.peekCodePoint=function(e){return e>=this._value.length?-1:this._value[e]},r.prototype.consumeUnicodeRangeToken=function(){for(var e=[],t=this.consumeCodePoint();gu(t)&&e.length<6;)e.push(t),t=this.consumeCodePoint();for(var n=!1;t===d0&&e.length<6;)e.push(t),t=this.consumeCodePoint(),n=!0;if(n){var s=parseInt(ss.apply(void 0,e.map(function(l){return l===d0?o4:l})),16),i=parseInt(ss.apply(void 0,e.map(function(l){return l===d0?u4:l})),16);return{type:30,start:s,end:i}}var a=parseInt(ss.apply(void 0,e),16);if(this.peekCodePoint(0)===aa&&gu(this.peekCodePoint(1))){this.consumeCodePoint(),t=this.consumeCodePoint();for(var o=[];gu(t)&&o.length<6;)o.push(t),t=this.consumeCodePoint();var i=parseInt(ss.apply(void 0,o),16);return{type:30,start:a,end:i}}else return{type:30,start:a,end:a}},r.prototype.consumeIdentLikeToken=function(){var e=this.consumeName();return e.toLowerCase()==="url"&&this.peekCodePoint(0)===A0?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===A0?(this.consumeCodePoint(),{type:19,value:e}):{type:20,value:e}},r.prototype.consumeUrlToken=function(){var e=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===Ro)return{type:22,value:""};var t=this.peekCodePoint(0);if(t===c0||t===l0){var n=this.consumeStringToken(this.consumeCodePoint());return n.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===Ro||this.peekCodePoint(0)===of)?(this.consumeCodePoint(),{type:22,value:n.value}):(this.consumeBadUrlRemnants(),f0)}for(;;){var s=this.consumeCodePoint();if(s===Ro||s===of)return{type:22,value:ss.apply(void 0,e)};if(u0(s))return this.consumeWhiteSpace(),this.peekCodePoint(0)===Ro||this.peekCodePoint(0)===of?(this.consumeCodePoint(),{type:22,value:ss.apply(void 0,e)}):(this.consumeBadUrlRemnants(),f0);if(s===l0||s===c0||s===A0||zj(s))return this.consumeBadUrlRemnants(),f0;if(s===Gf)if(Hc(s,this.peekCodePoint(0)))e.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),f0;else e.push(s)}},r.prototype.consumeWhiteSpace=function(){for(;u0(this.peekCodePoint(0));)this.consumeCodePoint()},r.prototype.consumeBadUrlRemnants=function(){for(;;){var e=this.consumeCodePoint();if(e===of||e===Ro)return;Hc(e,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},r.prototype.consumeStringSlice=function(e){for(var t=5e4,n="";e>0;){var s=Math.min(t,e);n+=ss.apply(void 0,this._value.splice(0,s)),e-=s}return this._value.shift(),n},r.prototype.consumeStringToken=function(e){var t="",n=0;do{var s=this._value[n];if(s===Ro||s===void 0||s===e)return t+=this.consumeStringSlice(n),{type:0,value:t};if(s===Hm)return this._value.splice(0,n),iV;if(s===Gf){var i=this._value[n+1];i!==Ro&&i!==void 0&&(i===Hm?(t+=this.consumeStringSlice(n),n=-1,this._value.shift()):Hc(s,i)&&(t+=this.consumeStringSlice(n),t+=ss(this.consumeEscapedCodePoint()),n=-1))}n++}while(!0)},r.prototype.consumeNumber=function(){var e=[],t=Qg,n=this.peekCodePoint(0);for((n===ud||n===aa)&&e.push(this.consumeCodePoint());ki(this.peekCodePoint(0));)e.push(this.consumeCodePoint());n=this.peekCodePoint(0);var s=this.peekCodePoint(1);if(n===bg&&ki(s))for(e.push(this.consumeCodePoint(),this.consumeCodePoint()),t=eC;ki(this.peekCodePoint(0));)e.push(this.consumeCodePoint());n=this.peekCodePoint(0),s=this.peekCodePoint(1);var i=this.peekCodePoint(2);if((n===d4||n===c4)&&((s===ud||s===aa)&&ki(i)||ki(s)))for(e.push(this.consumeCodePoint(),this.consumeCodePoint()),t=eC;ki(this.peekCodePoint(0));)e.push(this.consumeCodePoint());return[Kj(e),t]},r.prototype.consumeNumericToken=function(){var e=this.consumeNumber(),t=e[0],n=e[1],s=this.peekCodePoint(0),i=this.peekCodePoint(1),a=this.peekCodePoint(2);if(h0(s,i,a)){var o=this.consumeName();return{type:15,number:t,flags:n,unit:o}}return s===fj?(this.consumeCodePoint(),{type:16,number:t,flags:n}):{type:17,number:t,flags:n}},r.prototype.consumeEscapedCodePoint=function(){var e=this.consumeCodePoint();if(gu(e)){for(var t=ss(e);gu(this.peekCodePoint(0))&&t.length<6;)t+=ss(this.consumeCodePoint());u0(this.peekCodePoint(0))&&this.consumeCodePoint();var n=parseInt(t,16);return n===0||Hj(n)||n>1114111?nC:n}return e===Ro?nC:e},r.prototype.consumeName=function(){for(var e="";;){var t=this.consumeCodePoint();if(sC(t))e+=ss(t);else if(Hc(t,this.peekCodePoint(0)))e+=ss(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(t),e}},r})(),f4=(function(){function r(e){this._tokens=e}return r.create=function(e){var t=new h4;return t.write(e),new r(t.read())},r.parseValue=function(e){return r.create(e).parseComponentValue()},r.parseValues=function(e){return r.create(e).parseComponentValues()},r.prototype.parseComponentValue=function(){for(var e=this.consumeToken();e.type===31;)e=this.consumeToken();if(e.type===32)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(e);var t=this.consumeComponentValue();do e=this.consumeToken();while(e.type===31);if(e.type===32)return t;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},r.prototype.parseComponentValues=function(){for(var e=[];;){var t=this.consumeComponentValue();if(t.type===32)return e;e.push(t),e.push()}},r.prototype.consumeComponentValue=function(){var e=this.consumeToken();switch(e.type){case 11:case 28:case 2:return this.consumeSimpleBlock(e.type);case 19:return this.consumeFunction(e)}return e},r.prototype.consumeSimpleBlock=function(e){for(var t={type:e,values:[]},n=this.consumeToken();;){if(n.type===32||fV(n,e))return t;this.reconsumeToken(n),t.values.push(this.consumeComponentValue()),n=this.consumeToken()}},r.prototype.consumeFunction=function(e){for(var t={name:e.value,values:[],type:18};;){var n=this.consumeToken();if(n.type===32||n.type===3)return t;this.reconsumeToken(n),t.values.push(this.consumeComponentValue())}},r.prototype.consumeToken=function(){var e=this._tokens.shift();return typeof e>"u"?a1:e},r.prototype.reconsumeToken=function(e){this._tokens.unshift(e)},r})(),Hg=function(r){return r.type===15},wh=function(r){return r.type===17},an=function(r){return r.type===20},hV=function(r){return r.type===0},o1=function(r,e){return an(r)&&r.value===e},g4=function(r){return r.type!==31},ih=function(r){return r.type!==31&&r.type!==4},ul=function(r){var e=[],t=[];return r.forEach(function(n){if(n.type===4){if(t.length===0)throw new Error("Error parsing function args, zero tokens for arg");e.push(t),t=[];return}n.type!==31&&t.push(n)}),t.length&&e.push(t),e},fV=function(r,e){return e===11&&r.type===12||e===28&&r.type===29?!0:e===2&&r.type===3},yA=function(r){return r.type===17||r.type===15},bs=function(r){return r.type===16||yA(r)},p4=function(r){return r.length>1?[r[0],r[1]]:[r[0]]},di={type:17,number:0,flags:Qg},zx={type:16,number:50,flags:Qg},Jc={type:16,number:100,flags:Qg},vf=function(r,e,t){var n=r[0],s=r[1];return[wn(n,e),wn(typeof s<"u"?s:n,t)]},wn=function(r,e){if(r.type===16)return r.number/100*e;if(Hg(r))switch(r.unit){case"rem":case"em":return 16*r.number;case"px":default:return r.number}return r.number},m4="deg",b4="grad",y4="rad",w4="turn",Rb={name:"angle",parse:function(r,e){if(e.type===15)switch(e.unit){case m4:return Math.PI*e.number/180;case b4:return Math.PI/200*e.number;case y4:return e.number;case w4:return Math.PI*2*e.number}throw new Error("Unsupported angle type")}},v4=function(r){return r.type===15&&(r.unit===m4||r.unit===b4||r.unit===y4||r.unit===w4)},x4=function(r){var e=r.filter(an).map(function(t){return t.value}).join(" ");switch(e){case"to bottom right":case"to right bottom":case"left top":case"top left":return[di,di];case"to top":case"bottom":return Xa(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[di,Jc];case"to right":case"left":return Xa(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[Jc,Jc];case"to bottom":case"top":return Xa(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[Jc,di];case"to left":case"right":return Xa(270)}return 0},Xa=function(r){return Math.PI*r/180},iA={name:"color",parse:function(r,e){if(e.type===18){var t=gV[e.name];if(typeof t>"u")throw new Error('Attempting to parse an unsupported color function "'+e.name+'"');return t(r,e.values)}if(e.type===5){if(e.value.length===3){var n=e.value.substring(0,1),s=e.value.substring(1,2),i=e.value.substring(2,3);return Zc(parseInt(n+n,16),parseInt(s+s,16),parseInt(i+i,16),1)}if(e.value.length===4){var n=e.value.substring(0,1),s=e.value.substring(1,2),i=e.value.substring(2,3),a=e.value.substring(3,4);return Zc(parseInt(n+n,16),parseInt(s+s,16),parseInt(i+i,16),parseInt(a+a,16)/255)}if(e.value.length===6){var n=e.value.substring(0,2),s=e.value.substring(2,4),i=e.value.substring(4,6);return Zc(parseInt(n,16),parseInt(s,16),parseInt(i,16),1)}if(e.value.length===8){var n=e.value.substring(0,2),s=e.value.substring(2,4),i=e.value.substring(4,6),a=e.value.substring(6,8);return Zc(parseInt(n,16),parseInt(s,16),parseInt(i,16),parseInt(a,16)/255)}}if(e.type===20){var o=Wl[e.value.toUpperCase()];if(typeof o<"u")return o}return Wl.TRANSPARENT}},aA=function(r){return(255&r)===0},Vs=function(r){var e=255&r,t=255&r>>8,n=255&r>>16,s=255&r>>24;return e<255?"rgba("+s+","+n+","+t+","+e/255+")":"rgb("+s+","+n+","+t+")"},Zc=function(r,e,t,n){return(r<<24|e<<16|t<<8|Math.round(n*255)<<0)>>>0},iC=function(r,e){if(r.type===17)return r.number;if(r.type===16){var t=e===3?1:255;return e===3?r.number/100*t:Math.round(r.number/100*t)}return 0},aC=function(r,e){var t=e.filter(ih);if(t.length===3){var n=t.map(iC),s=n[0],i=n[1],a=n[2];return Zc(s,i,a,1)}if(t.length===4){var o=t.map(iC),s=o[0],i=o[1],a=o[2],l=o[3];return Zc(s,i,a,l)}return 0};function hw(r,e,t){return t<0&&(t+=1),t>=1&&(t-=1),t<1/6?(e-r)*t*6+r:t<1/2?e:t<2/3?(e-r)*6*(2/3-t)+r:r}var oC=function(r,e){var t=e.filter(ih),n=t[0],s=t[1],i=t[2],a=t[3],o=(n.type===17?Xa(n.number):Rb.parse(r,n))/(Math.PI*2),l=bs(s)?s.number/100:0,c=bs(i)?i.number/100:0,A=typeof a<"u"&&bs(a)?wn(a,1):1;if(l===0)return Zc(c*255,c*255,c*255,1);var d=c<=.5?c*(l+1):c+l-c*l,h=c*2-d,u=hw(h,d,o+1/3),p=hw(h,d,o),f=hw(h,d,o-1/3);return Zc(u*255,p*255,f*255,A)},gV={hsl:oC,hsla:oC,rgb:aC,rgba:aC},zf=function(r,e){return iA.parse(r,f4.create(e).parseComponentValue())},Wl={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},pV={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(r,e){return e.map(function(t){if(an(t))switch(t.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},mV={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Ob=function(r,e){var t=iA.parse(r,e[0]),n=e[1];return n&&bs(n)?{color:t,stop:n}:{color:t,stop:null}},lC=function(r,e){var t=r[0],n=r[r.length-1];t.stop===null&&(t.stop=di),n.stop===null&&(n.stop=Jc);for(var s=[],i=0,a=0;a<r.length;a++){var o=r[a].stop;if(o!==null){var l=wn(o,e);l>i?s.push(l):s.push(i),i=l}else s.push(null)}for(var c=null,a=0;a<s.length;a++){var A=s[a];if(A===null)c===null&&(c=a);else if(c!==null){for(var d=a-c,h=s[c-1],u=(A-h)/(d+1),p=1;p<=d;p++)s[c+p-1]=u*p;c=null}}return r.map(function(f,g){var m=f.color;return{color:m,stop:Math.max(Math.min(1,s[g]/e),0)}})},bV=function(r,e,t){var n=e/2,s=t/2,i=wn(r[0],e)-n,a=s-wn(r[1],t);return(Math.atan2(a,i)+Math.PI*2)%(Math.PI*2)},yV=function(r,e,t){var n=typeof r=="number"?r:bV(r,e,t),s=Math.abs(e*Math.sin(n))+Math.abs(t*Math.cos(n)),i=e/2,a=t/2,o=s/2,l=Math.sin(n-Math.PI/2)*o,c=Math.cos(n-Math.PI/2)*o;return[s,i-c,i+c,a-l,a+l]},Ao=function(r,e){return Math.sqrt(r*r+e*e)},cC=function(r,e,t,n,s){var i=[[0,0],[0,e],[r,0],[r,e]];return i.reduce(function(a,o){var l=o[0],c=o[1],A=Ao(t-l,n-c);return(s?A<a.optimumDistance:A>a.optimumDistance)?{optimumCorner:o,optimumDistance:A}:a},{optimumDistance:s?1/0:-1/0,optimumCorner:null}).optimumCorner},wV=function(r,e,t,n,s){var i=0,a=0;switch(r.size){case 0:r.shape===0?i=a=Math.min(Math.abs(e),Math.abs(e-n),Math.abs(t),Math.abs(t-s)):r.shape===1&&(i=Math.min(Math.abs(e),Math.abs(e-n)),a=Math.min(Math.abs(t),Math.abs(t-s)));break;case 2:if(r.shape===0)i=a=Math.min(Ao(e,t),Ao(e,t-s),Ao(e-n,t),Ao(e-n,t-s));else if(r.shape===1){var o=Math.min(Math.abs(t),Math.abs(t-s))/Math.min(Math.abs(e),Math.abs(e-n)),l=cC(n,s,e,t,!0),c=l[0],A=l[1];i=Ao(c-e,(A-t)/o),a=o*i}break;case 1:r.shape===0?i=a=Math.max(Math.abs(e),Math.abs(e-n),Math.abs(t),Math.abs(t-s)):r.shape===1&&(i=Math.max(Math.abs(e),Math.abs(e-n)),a=Math.max(Math.abs(t),Math.abs(t-s)));break;case 3:if(r.shape===0)i=a=Math.max(Ao(e,t),Ao(e,t-s),Ao(e-n,t),Ao(e-n,t-s));else if(r.shape===1){var o=Math.max(Math.abs(t),Math.abs(t-s))/Math.max(Math.abs(e),Math.abs(e-n)),d=cC(n,s,e,t,!1),c=d[0],A=d[1];i=Ao(c-e,(A-t)/o),a=o*i}break}return Array.isArray(r.size)&&(i=wn(r.size[0],n),a=r.size.length===2?wn(r.size[1],s):i),[i,a]},vV=function(r,e){var t=Xa(180),n=[];return ul(e).forEach(function(s,i){if(i===0){var a=s[0];if(a.type===20&&a.value==="to"){t=x4(s);return}else if(v4(a)){t=Rb.parse(r,a);return}}var o=Ob(r,s);n.push(o)}),{angle:t,stops:n,type:1}},g0=function(r,e){var t=Xa(180),n=[];return ul(e).forEach(function(s,i){if(i===0){var a=s[0];if(a.type===20&&["top","left","right","bottom"].indexOf(a.value)!==-1){t=x4(s);return}else if(v4(a)){t=(Rb.parse(r,a)+Xa(270))%Xa(360);return}}var o=Ob(r,s);n.push(o)}),{angle:t,stops:n,type:1}},xV=function(r,e){var t=Xa(180),n=[],s=1,i=0,a=3,o=[];return ul(e).forEach(function(l,c){var A=l[0];if(c===0){if(an(A)&&A.value==="linear"){s=1;return}else if(an(A)&&A.value==="radial"){s=2;return}}if(A.type===18){if(A.name==="from"){var d=iA.parse(r,A.values[0]);n.push({stop:di,color:d})}else if(A.name==="to"){var d=iA.parse(r,A.values[0]);n.push({stop:Jc,color:d})}else if(A.name==="color-stop"){var h=A.values.filter(ih);if(h.length===2){var d=iA.parse(r,h[1]),u=h[0];wh(u)&&n.push({stop:{type:16,number:u.number*100,flags:u.flags},color:d})}}}}),s===1?{angle:(t+Xa(180))%Xa(360),stops:n,type:s}:{size:a,shape:i,stops:n,position:o,type:s}},_4="closest-side",B4="farthest-side",C4="closest-corner",S4="farthest-corner",k4="circle",E4="ellipse",I4="cover",T4="contain",_V=function(r,e){var t=0,n=3,s=[],i=[];return ul(e).forEach(function(a,o){var l=!0;if(o===0){var c=!1;l=a.reduce(function(d,h){if(c)if(an(h))switch(h.value){case"center":return i.push(zx),d;case"top":case"left":return i.push(di),d;case"right":case"bottom":return i.push(Jc),d}else(bs(h)||yA(h))&&i.push(h);else if(an(h))switch(h.value){case k4:return t=0,!1;case E4:return t=1,!1;case"at":return c=!0,!1;case _4:return n=0,!1;case I4:case B4:return n=1,!1;case T4:case C4:return n=2,!1;case S4:return n=3,!1}else if(yA(h)||bs(h))return Array.isArray(n)||(n=[]),n.push(h),!1;return d},l)}if(l){var A=Ob(r,a);s.push(A)}}),{size:n,shape:t,stops:s,position:i,type:2}},p0=function(r,e){var t=0,n=3,s=[],i=[];return ul(e).forEach(function(a,o){var l=!0;if(o===0?l=a.reduce(function(A,d){if(an(d))switch(d.value){case"center":return i.push(zx),!1;case"top":case"left":return i.push(di),!1;case"right":case"bottom":return i.push(Jc),!1}else if(bs(d)||yA(d))return i.push(d),!1;return A},l):o===1&&(l=a.reduce(function(A,d){if(an(d))switch(d.value){case k4:return t=0,!1;case E4:return t=1,!1;case T4:case _4:return n=0,!1;case B4:return n=1,!1;case C4:return n=2,!1;case I4:case S4:return n=3,!1}else if(yA(d)||bs(d))return Array.isArray(n)||(n=[]),n.push(d),!1;return A},l)),l){var c=Ob(r,a);s.push(c)}}),{size:n,shape:t,stops:s,position:i,type:2}},BV=function(r){return r.type===1},CV=function(r){return r.type===2},Kx={name:"image",parse:function(r,e){if(e.type===22){var t={url:e.value,type:0};return r.cache.addImage(e.value),t}if(e.type===18){var n=F4[e.name];if(typeof n>"u")throw new Error('Attempting to parse an unsupported image function "'+e.name+'"');return n(r,e.values)}throw new Error("Unsupported image type "+e.type)}};function SV(r){return!(r.type===20&&r.value==="none")&&(r.type!==18||!!F4[r.name])}var F4={"linear-gradient":vV,"-moz-linear-gradient":g0,"-ms-linear-gradient":g0,"-o-linear-gradient":g0,"-webkit-linear-gradient":g0,"radial-gradient":_V,"-moz-radial-gradient":p0,"-ms-radial-gradient":p0,"-o-radial-gradient":p0,"-webkit-radial-gradient":p0,"-webkit-gradient":xV},kV={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(r,e){if(e.length===0)return[];var t=e[0];return t.type===20&&t.value==="none"?[]:e.filter(function(n){return ih(n)&&SV(n)}).map(function(n){return Kx.parse(r,n)})}},EV={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(r,e){return e.map(function(t){if(an(t))switch(t.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},IV={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(r,e){return ul(e).map(function(t){return t.filter(bs)}).map(p4)}},TV={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(r,e){return ul(e).map(function(t){return t.filter(an).map(function(n){return n.value}).join(" ")}).map(FV)}},FV=function(r){switch(r){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;case"repeat":default:return 0}},Hu;(function(r){r.AUTO="auto",r.CONTAIN="contain",r.COVER="cover"})(Hu||(Hu={}));var LV={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(r,e){return ul(e).map(function(t){return t.filter(UV)})}},UV=function(r){return an(r)||bs(r)},Qb=function(r){return{name:"border-"+r+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},MV=Qb("top"),NV=Qb("right"),PV=Qb("bottom"),DV=Qb("left"),Hb=function(r){return{name:"border-radius-"+r,initialValue:"0 0",prefix:!1,type:1,parse:function(e,t){return p4(t.filter(bs))}}},RV=Hb("top-left"),OV=Hb("top-right"),QV=Hb("bottom-right"),HV=Hb("bottom-left"),jb=function(r){return{name:"border-"+r+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(e,t){switch(t){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},jV=jb("top"),VV=jb("right"),$V=jb("bottom"),GV=jb("left"),Vb=function(r){return{name:"border-"+r+"-width",initialValue:"0",type:0,prefix:!1,parse:function(e,t){return Hg(t)?t.number:0}}},zV=Vb("top"),KV=Vb("right"),qV=Vb("bottom"),WV=Vb("left"),YV={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},XV={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(r,e){switch(e){case"rtl":return 1;case"ltr":default:return 0}}},JV={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(r,e){return e.filter(an).reduce(function(t,n){return t|ZV(n.value)},0)}},ZV=function(r){switch(r){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},e$={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(r,e){switch(e){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},t$={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(r,e){return e.type===20&&e.value==="normal"?0:e.type===17||e.type===15?e.number:0}},Vm;(function(r){r.NORMAL="normal",r.STRICT="strict"})(Vm||(Vm={}));var r$={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(r,e){switch(e){case"strict":return Vm.STRICT;case"normal":default:return Vm.NORMAL}}},n$={name:"line-height",initialValue:"normal",prefix:!1,type:4},AC=function(r,e){return an(r)&&r.value==="normal"?1.2*e:r.type===17?e*r.number:bs(r)?wn(r,e):e},s$={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(r,e){return e.type===20&&e.value==="none"?null:Kx.parse(r,e)}},i$={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(r,e){switch(e){case"inside":return 0;case"outside":default:return 1}}},l1={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(r,e){switch(e){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;case"none":default:return-1}}},$b=function(r){return{name:"margin-"+r,initialValue:"0",prefix:!1,type:4}},a$=$b("top"),o$=$b("right"),l$=$b("bottom"),c$=$b("left"),A$={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(r,e){return e.filter(an).map(function(t){switch(t.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;case"visible":default:return 0}})}},d$={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(r,e){switch(e){case"break-word":return"break-word";case"normal":default:return"normal"}}},Gb=function(r){return{name:"padding-"+r,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},u$=Gb("top"),h$=Gb("right"),f$=Gb("bottom"),g$=Gb("left"),p$={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(r,e){switch(e){case"right":return 2;case"center":case"justify":return 1;case"left":default:return 0}}},m$={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(r,e){switch(e){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},b$={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(r,e){return e.length===1&&o1(e[0],"none")?[]:ul(e).map(function(t){for(var n={color:Wl.TRANSPARENT,offsetX:di,offsetY:di,blur:di},s=0,i=0;i<t.length;i++){var a=t[i];yA(a)?(s===0?n.offsetX=a:s===1?n.offsetY=a:n.blur=a,s++):n.color=iA.parse(r,a)}return n})}},y$={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(r,e){switch(e){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},w$={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(r,e){if(e.type===20&&e.value==="none")return null;if(e.type===18){var t=_$[e.name];if(typeof t>"u")throw new Error('Attempting to parse an unsupported transform function "'+e.name+'"');return t(e.values)}return null}},v$=function(r){var e=r.filter(function(t){return t.type===17}).map(function(t){return t.number});return e.length===6?e:null},x$=function(r){var e=r.filter(function(l){return l.type===17}).map(function(l){return l.number}),t=e[0],n=e[1];e[2],e[3];var s=e[4],i=e[5];e[6],e[7],e[8],e[9],e[10],e[11];var a=e[12],o=e[13];return e[14],e[15],e.length===16?[t,n,s,i,a,o]:null},_$={matrix:v$,matrix3d:x$},dC={type:16,number:50,flags:Qg},B$=[dC,dC],C$={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(r,e){var t=e.filter(bs);return t.length!==2?B$:[t[0],t[1]]}},S$={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(r,e){switch(e){case"hidden":return 1;case"collapse":return 2;case"visible":default:return 0}}},Kf;(function(r){r.NORMAL="normal",r.BREAK_ALL="break-all",r.KEEP_ALL="keep-all"})(Kf||(Kf={}));var k$={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(r,e){switch(e){case"break-all":return Kf.BREAK_ALL;case"keep-all":return Kf.KEEP_ALL;case"normal":default:return Kf.NORMAL}}},E$={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(r,e){if(e.type===20)return{auto:!0,order:0};if(wh(e))return{auto:!1,order:e.number};throw new Error("Invalid z-index number parsed")}},L4={name:"time",parse:function(r,e){if(e.type===15)switch(e.unit.toLowerCase()){case"s":return 1e3*e.number;case"ms":return e.number}throw new Error("Unsupported time type")}},I$={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(r,e){return wh(e)?e.number:1}},T$={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},F$={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(r,e){return e.filter(an).map(function(t){switch(t.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(t){return t!==0})}},L$={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(r,e){var t=[],n=[];return e.forEach(function(s){switch(s.type){case 20:case 0:t.push(s.value);break;case 17:t.push(s.number.toString());break;case 4:n.push(t.join(" ")),t.length=0;break}}),t.length&&n.push(t.join(" ")),n.map(function(s){return s.indexOf(" ")===-1?s:"'"+s+"'"})}},U$={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},M$={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(r,e){if(wh(e))return e.number;if(an(e))switch(e.value){case"bold":return 700;case"normal":default:return 400}return 400}},N$={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(r,e){return e.filter(an).map(function(t){return t.value})}},P$={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(r,e){switch(e){case"oblique":return"oblique";case"italic":return"italic";case"normal":default:return"normal"}}},Us=function(r,e){return(r&e)!==0},D$={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(r,e){if(e.length===0)return[];var t=e[0];return t.type===20&&t.value==="none"?[]:e}},R$={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(r,e){if(e.length===0)return null;var t=e[0];if(t.type===20&&t.value==="none")return null;for(var n=[],s=e.filter(g4),i=0;i<s.length;i++){var a=s[i],o=s[i+1];if(a.type===20){var l=o&&wh(o)?o.number:1;n.push({counter:a.value,increment:l})}}return n}},O$={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(r,e){if(e.length===0)return[];for(var t=[],n=e.filter(g4),s=0;s<n.length;s++){var i=n[s],a=n[s+1];if(an(i)&&i.value!=="none"){var o=a&&wh(a)?a.number:0;t.push({counter:i.value,reset:o})}}return t}},Q$={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(r,e){return e.filter(Hg).map(function(t){return L4.parse(r,t)})}},H$={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(r,e){if(e.length===0)return null;var t=e[0];if(t.type===20&&t.value==="none")return null;var n=[],s=e.filter(hV);if(s.length%2!==0)return null;for(var i=0;i<s.length;i+=2){var a=s[i].value,o=s[i+1].value;n.push({open:a,close:o})}return n}},uC=function(r,e,t){if(!r)return"";var n=r[Math.min(e,r.length-1)];return n?t?n.open:n.close:""},j$={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(r,e){return e.length===1&&o1(e[0],"none")?[]:ul(e).map(function(t){for(var n={color:255,offsetX:di,offsetY:di,blur:di,spread:di,inset:!1},s=0,i=0;i<t.length;i++){var a=t[i];o1(a,"inset")?n.inset=!0:yA(a)?(s===0?n.offsetX=a:s===1?n.offsetY=a:s===2?n.blur=a:n.spread=a,s++):n.color=iA.parse(r,a)}return n})}},V$={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(r,e){var t=[0,1,2],n=[];return e.filter(an).forEach(function(s){switch(s.value){case"stroke":n.push(1);break;case"fill":n.push(0);break;case"markers":n.push(2);break}}),t.forEach(function(s){n.indexOf(s)===-1&&n.push(s)}),n}},$$={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},G$={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(r,e){return Hg(e)?e.number:0}},z$=(function(){function r(e,t){var n,s;this.animationDuration=mt(e,Q$,t.animationDuration),this.backgroundClip=mt(e,pV,t.backgroundClip),this.backgroundColor=mt(e,mV,t.backgroundColor),this.backgroundImage=mt(e,kV,t.backgroundImage),this.backgroundOrigin=mt(e,EV,t.backgroundOrigin),this.backgroundPosition=mt(e,IV,t.backgroundPosition),this.backgroundRepeat=mt(e,TV,t.backgroundRepeat),this.backgroundSize=mt(e,LV,t.backgroundSize),this.borderTopColor=mt(e,MV,t.borderTopColor),this.borderRightColor=mt(e,NV,t.borderRightColor),this.borderBottomColor=mt(e,PV,t.borderBottomColor),this.borderLeftColor=mt(e,DV,t.borderLeftColor),this.borderTopLeftRadius=mt(e,RV,t.borderTopLeftRadius),this.borderTopRightRadius=mt(e,OV,t.borderTopRightRadius),this.borderBottomRightRadius=mt(e,QV,t.borderBottomRightRadius),this.borderBottomLeftRadius=mt(e,HV,t.borderBottomLeftRadius),this.borderTopStyle=mt(e,jV,t.borderTopStyle),this.borderRightStyle=mt(e,VV,t.borderRightStyle),this.borderBottomStyle=mt(e,$V,t.borderBottomStyle),this.borderLeftStyle=mt(e,GV,t.borderLeftStyle),this.borderTopWidth=mt(e,zV,t.borderTopWidth),this.borderRightWidth=mt(e,KV,t.borderRightWidth),this.borderBottomWidth=mt(e,qV,t.borderBottomWidth),this.borderLeftWidth=mt(e,WV,t.borderLeftWidth),this.boxShadow=mt(e,j$,t.boxShadow),this.color=mt(e,YV,t.color),this.direction=mt(e,XV,t.direction),this.display=mt(e,JV,t.display),this.float=mt(e,e$,t.cssFloat),this.fontFamily=mt(e,L$,t.fontFamily),this.fontSize=mt(e,U$,t.fontSize),this.fontStyle=mt(e,P$,t.fontStyle),this.fontVariant=mt(e,N$,t.fontVariant),this.fontWeight=mt(e,M$,t.fontWeight),this.letterSpacing=mt(e,t$,t.letterSpacing),this.lineBreak=mt(e,r$,t.lineBreak),this.lineHeight=mt(e,n$,t.lineHeight),this.listStyleImage=mt(e,s$,t.listStyleImage),this.listStylePosition=mt(e,i$,t.listStylePosition),this.listStyleType=mt(e,l1,t.listStyleType),this.marginTop=mt(e,a$,t.marginTop),this.marginRight=mt(e,o$,t.marginRight),this.marginBottom=mt(e,l$,t.marginBottom),this.marginLeft=mt(e,c$,t.marginLeft),this.opacity=mt(e,I$,t.opacity);var i=mt(e,A$,t.overflow);this.overflowX=i[0],this.overflowY=i[i.length>1?1:0],this.overflowWrap=mt(e,d$,t.overflowWrap),this.paddingTop=mt(e,u$,t.paddingTop),this.paddingRight=mt(e,h$,t.paddingRight),this.paddingBottom=mt(e,f$,t.paddingBottom),this.paddingLeft=mt(e,g$,t.paddingLeft),this.paintOrder=mt(e,V$,t.paintOrder),this.position=mt(e,m$,t.position),this.textAlign=mt(e,p$,t.textAlign),this.textDecorationColor=mt(e,T$,(n=t.textDecorationColor)!==null&&n!==void 0?n:t.color),this.textDecorationLine=mt(e,F$,(s=t.textDecorationLine)!==null&&s!==void 0?s:t.textDecoration),this.textShadow=mt(e,b$,t.textShadow),this.textTransform=mt(e,y$,t.textTransform),this.transform=mt(e,w$,t.transform),this.transformOrigin=mt(e,C$,t.transformOrigin),this.visibility=mt(e,S$,t.visibility),this.webkitTextStrokeColor=mt(e,$$,t.webkitTextStrokeColor),this.webkitTextStrokeWidth=mt(e,G$,t.webkitTextStrokeWidth),this.wordBreak=mt(e,k$,t.wordBreak),this.zIndex=mt(e,E$,t.zIndex)}return r.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===0},r.prototype.isTransparent=function(){return aA(this.backgroundColor)},r.prototype.isTransformed=function(){return this.transform!==null},r.prototype.isPositioned=function(){return this.position!==0},r.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},r.prototype.isFloating=function(){return this.float!==0},r.prototype.isInlineLevel=function(){return Us(this.display,4)||Us(this.display,33554432)||Us(this.display,268435456)||Us(this.display,536870912)||Us(this.display,67108864)||Us(this.display,134217728)},r})(),K$=(function(){function r(e,t){this.content=mt(e,D$,t.content),this.quotes=mt(e,H$,t.quotes)}return r})(),hC=(function(){function r(e,t){this.counterIncrement=mt(e,R$,t.counterIncrement),this.counterReset=mt(e,O$,t.counterReset)}return r})(),mt=function(r,e,t){var n=new h4,s=t!==null&&typeof t<"u"?t.toString():e.initialValue;n.write(s);var i=new f4(n.read());switch(e.type){case 2:var a=i.parseComponentValue();return e.parse(r,an(a)?a.value:e.initialValue);case 0:return e.parse(r,i.parseComponentValue());case 1:return e.parse(r,i.parseComponentValues());case 4:return i.parseComponentValue();case 3:switch(e.format){case"angle":return Rb.parse(r,i.parseComponentValue());case"color":return iA.parse(r,i.parseComponentValue());case"image":return Kx.parse(r,i.parseComponentValue());case"length":var o=i.parseComponentValue();return yA(o)?o:di;case"length-percentage":var l=i.parseComponentValue();return bs(l)?l:di;case"time":return L4.parse(r,i.parseComponentValue())}break}},q$="data-html2canvas-debug",W$=function(r){var e=r.getAttribute(q$);switch(e){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},c1=function(r,e){var t=W$(r);return t===1||e===t},hl=(function(){function r(e,t){if(this.context=e,this.textNodes=[],this.elements=[],this.flags=0,c1(t,3))debugger;this.styles=new z$(e,window.getComputedStyle(t,null)),u1(t)&&(this.styles.animationDuration.some(function(n){return n>0})&&(t.style.animationDuration="0s"),this.styles.transform!==null&&(t.style.transform="none")),this.bounds=Pb(this.context,t),c1(t,4)&&(this.flags|=16)}return r})(),Y$="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",fC="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",xf=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var m0=0;m0<fC.length;m0++)xf[fC.charCodeAt(m0)]=m0;var X$=function(r){var e=r.length*.75,t=r.length,n,s=0,i,a,o,l;r[r.length-1]==="="&&(e--,r[r.length-2]==="="&&e--);var c=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(e):new Array(e),A=Array.isArray(c)?c:new Uint8Array(c);for(n=0;n<t;n+=4)i=xf[r.charCodeAt(n)],a=xf[r.charCodeAt(n+1)],o=xf[r.charCodeAt(n+2)],l=xf[r.charCodeAt(n+3)],A[s++]=i<<2|a>>4,A[s++]=(a&15)<<4|o>>2,A[s++]=(o&3)<<6|l&63;return c},J$=function(r){for(var e=r.length,t=[],n=0;n<e;n+=2)t.push(r[n+1]<<8|r[n]);return t},Z$=function(r){for(var e=r.length,t=[],n=0;n<e;n+=4)t.push(r[n+3]<<24|r[n+2]<<16|r[n+1]<<8|r[n]);return t},Bd=5,qx=11,fw=2,eG=qx-Bd,U4=65536>>Bd,tG=1<<Bd,gw=tG-1,rG=1024>>Bd,nG=U4+rG,sG=nG,iG=32,aG=sG+iG,oG=65536>>qx,lG=1<<eG,cG=lG-1,gC=function(r,e,t){return r.slice?r.slice(e,t):new Uint16Array(Array.prototype.slice.call(r,e,t))},AG=function(r,e,t){return r.slice?r.slice(e,t):new Uint32Array(Array.prototype.slice.call(r,e,t))},dG=function(r,e){var t=X$(r),n=Array.isArray(t)?Z$(t):new Uint32Array(t),s=Array.isArray(t)?J$(t):new Uint16Array(t),i=24,a=gC(s,i/2,n[4]/2),o=n[5]===2?gC(s,(i+n[4])/2):AG(n,Math.ceil((i+n[4])/4));return new uG(n[0],n[1],n[2],n[3],a,o)},uG=(function(){function r(e,t,n,s,i,a){this.initialValue=e,this.errorValue=t,this.highStart=n,this.highValueIndex=s,this.index=i,this.data=a}return r.prototype.get=function(e){var t;if(e>=0){if(e<55296||e>56319&&e<=65535)return t=this.index[e>>Bd],t=(t<<fw)+(e&gw),this.data[t];if(e<=65535)return t=this.index[U4+(e-55296>>Bd)],t=(t<<fw)+(e&gw),this.data[t];if(e<this.highStart)return t=aG-oG+(e>>qx),t=this.index[t],t+=e>>Bd&cG,t=this.index[t],t=(t<<fw)+(e&gw),this.data[t];if(e<=1114111)return this.data[this.highValueIndex]}return this.errorValue},r})(),pC="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",hG=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var b0=0;b0<pC.length;b0++)hG[pC.charCodeAt(b0)]=b0;var fG=1,pw=2,mw=3,mC=4,bC=5,gG=7,yC=8,bw=9,yw=10,wC=11,vC=12,xC=13,_C=14,ww=15,pG=function(r){for(var e=[],t=0,n=r.length;t<n;){var s=r.charCodeAt(t++);if(s>=55296&&s<=56319&&t<n){var i=r.charCodeAt(t++);(i&64512)===56320?e.push(((s&1023)<<10)+(i&1023)+65536):(e.push(s),t--)}else e.push(s)}return e},mG=function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];if(String.fromCodePoint)return String.fromCodePoint.apply(String,r);var t=r.length;if(!t)return"";for(var n=[],s=-1,i="";++s<t;){var a=r[s];a<=65535?n.push(a):(a-=65536,n.push((a>>10)+55296,a%1024+56320)),(s+1===t||n.length>16384)&&(i+=String.fromCharCode.apply(String,n),n.length=0)}return i},bG=dG(Y$),Ka="",vw="",yG=function(r){return bG.get(r)},wG=function(r,e,t){var n=t-2,s=e[n],i=e[t-1],a=e[t];if(i===pw&&a===mw)return Ka;if(i===pw||i===mw||i===mC||a===pw||a===mw||a===mC)return vw;if(i===yC&&[yC,bw,wC,vC].indexOf(a)!==-1||(i===wC||i===bw)&&(a===bw||a===yw)||(i===vC||i===yw)&&a===yw||a===xC||a===bC||a===gG||i===fG)return Ka;if(i===xC&&a===_C){for(;s===bC;)s=e[--n];if(s===_C)return Ka}if(i===ww&&a===ww){for(var o=0;s===ww;)o++,s=e[--n];if(o%2===0)return Ka}return vw},vG=function(r){var e=pG(r),t=e.length,n=0,s=0,i=e.map(yG);return{next:function(){if(n>=t)return{done:!0,value:null};for(var a=Ka;n<t&&(a=wG(e,i,++n))===Ka;);if(a!==Ka||n===t){var o=mG.apply(null,e.slice(s,n));return s=n,{value:o,done:!1}}return{done:!0,value:null}}}},xG=function(r){for(var e=vG(r),t=[],n;!(n=e.next()).done;)n.value&&t.push(n.value.slice());return t},_G=function(r){var e=123;if(r.createRange){var t=r.createRange();if(t.getBoundingClientRect){var n=r.createElement("boundtest");n.style.height=e+"px",n.style.display="block",r.body.appendChild(n),t.selectNode(n);var s=t.getBoundingClientRect(),i=Math.round(s.height);if(r.body.removeChild(n),i===e)return!0}}return!1},BG=function(r){var e=r.createElement("boundtest");e.style.width="50px",e.style.display="block",e.style.fontSize="12px",e.style.letterSpacing="0px",e.style.wordSpacing="0px",r.body.appendChild(e);var t=r.createRange();e.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";var n=e.firstChild,s=Db(n.data).map(function(l){return ss(l)}),i=0,a={},o=s.every(function(l,c){t.setStart(n,i),t.setEnd(n,i+l.length);var A=t.getBoundingClientRect();i+=l.length;var d=A.x>a.x||A.y>a.y;return a=A,c===0?!0:d});return r.body.removeChild(e),o},CG=function(){return typeof new Image().crossOrigin<"u"},SG=function(){return typeof new XMLHttpRequest().responseType=="string"},kG=function(r){var e=new Image,t=r.createElement("canvas"),n=t.getContext("2d");if(!n)return!1;e.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{n.drawImage(e,0,0),t.toDataURL()}catch{return!1}return!0},BC=function(r){return r[0]===0&&r[1]===255&&r[2]===0&&r[3]===255},EG=function(r){var e=r.createElement("canvas"),t=100;e.width=t,e.height=t;var n=e.getContext("2d");if(!n)return Promise.reject(!1);n.fillStyle="rgb(0, 255, 0)",n.fillRect(0,0,t,t);var s=new Image,i=e.toDataURL();s.src=i;var a=A1(t,t,0,0,s);return n.fillStyle="red",n.fillRect(0,0,t,t),CC(a).then(function(o){n.drawImage(o,0,0);var l=n.getImageData(0,0,t,t).data;n.fillStyle="red",n.fillRect(0,0,t,t);var c=r.createElement("div");return c.style.backgroundImage="url("+i+")",c.style.height=t+"px",BC(l)?CC(A1(t,t,0,0,c)):Promise.reject(!1)}).then(function(o){return n.drawImage(o,0,0),BC(n.getImageData(0,0,t,t).data)}).catch(function(){return!1})},A1=function(r,e,t,n,s){var i="http://www.w3.org/2000/svg",a=document.createElementNS(i,"svg"),o=document.createElementNS(i,"foreignObject");return a.setAttributeNS(null,"width",r.toString()),a.setAttributeNS(null,"height",e.toString()),o.setAttributeNS(null,"width","100%"),o.setAttributeNS(null,"height","100%"),o.setAttributeNS(null,"x",t.toString()),o.setAttributeNS(null,"y",n.toString()),o.setAttributeNS(null,"externalResourcesRequired","true"),a.appendChild(o),o.appendChild(s),a},CC=function(r){return new Promise(function(e,t){var n=new Image;n.onload=function(){return e(n)},n.onerror=t,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(r))})},oi={get SUPPORT_RANGE_BOUNDS(){var r=_G(document);return Object.defineProperty(oi,"SUPPORT_RANGE_BOUNDS",{value:r}),r},get SUPPORT_WORD_BREAKING(){var r=oi.SUPPORT_RANGE_BOUNDS&&BG(document);return Object.defineProperty(oi,"SUPPORT_WORD_BREAKING",{value:r}),r},get SUPPORT_SVG_DRAWING(){var r=kG(document);return Object.defineProperty(oi,"SUPPORT_SVG_DRAWING",{value:r}),r},get SUPPORT_FOREIGNOBJECT_DRAWING(){var r=typeof Array.from=="function"&&typeof window.fetch=="function"?EG(document):Promise.resolve(!1);return Object.defineProperty(oi,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:r}),r},get SUPPORT_CORS_IMAGES(){var r=CG();return Object.defineProperty(oi,"SUPPORT_CORS_IMAGES",{value:r}),r},get SUPPORT_RESPONSE_TYPE(){var r=SG();return Object.defineProperty(oi,"SUPPORT_RESPONSE_TYPE",{value:r}),r},get SUPPORT_CORS_XHR(){var r="withCredentials"in new XMLHttpRequest;return Object.defineProperty(oi,"SUPPORT_CORS_XHR",{value:r}),r},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var r=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty(oi,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:r}),r}},qf=(function(){function r(e,t){this.text=e,this.bounds=t}return r})(),IG=function(r,e,t,n){var s=LG(e,t),i=[],a=0;return s.forEach(function(o){if(t.textDecorationLine.length||o.trim().length>0)if(oi.SUPPORT_RANGE_BOUNDS){var l=SC(n,a,o.length).getClientRects();if(l.length>1){var c=Wx(o),A=0;c.forEach(function(h){i.push(new qf(h,ec.fromDOMRectList(r,SC(n,A+a,h.length).getClientRects()))),A+=h.length})}else i.push(new qf(o,ec.fromDOMRectList(r,l)))}else{var d=n.splitText(o.length);i.push(new qf(o,TG(r,n))),n=d}else oi.SUPPORT_RANGE_BOUNDS||(n=n.splitText(o.length));a+=o.length}),i},TG=function(r,e){var t=e.ownerDocument;if(t){var n=t.createElement("html2canvaswrapper");n.appendChild(e.cloneNode(!0));var s=e.parentNode;if(s){s.replaceChild(n,e);var i=Pb(r,n);return n.firstChild&&s.replaceChild(n.firstChild,n),i}}return ec.EMPTY},SC=function(r,e,t){var n=r.ownerDocument;if(!n)throw new Error("Node has no owner document");var s=n.createRange();return s.setStart(r,e),s.setEnd(r,e+t),s},Wx=function(r){if(oi.SUPPORT_NATIVE_TEXT_SEGMENTATION){var e=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(e.segment(r)).map(function(t){return t.segment})}return xG(r)},FG=function(r,e){if(oi.SUPPORT_NATIVE_TEXT_SEGMENTATION){var t=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(t.segment(r)).map(function(n){return n.segment})}return MG(r,e)},LG=function(r,e){return e.letterSpacing!==0?Wx(r):FG(r,e)},UG=[32,160,4961,65792,65793,4153,4241],MG=function(r,e){for(var t=oj(r,{lineBreak:e.lineBreak,wordBreak:e.overflowWrap==="break-word"?"break-word":e.wordBreak}),n=[],s,i=function(){if(s.value){var a=s.value.slice(),o=Db(a),l="";o.forEach(function(c){UG.indexOf(c)===-1?l+=ss(c):(l.length&&n.push(l),n.push(ss(c)),l="")}),l.length&&n.push(l)}};!(s=t.next()).done;)i();return n},NG=(function(){function r(e,t,n){this.text=PG(t.data,n.textTransform),this.textBounds=IG(e,this.text,n,t)}return r})(),PG=function(r,e){switch(e){case 1:return r.toLowerCase();case 3:return r.replace(DG,RG);case 2:return r.toUpperCase();default:return r}},DG=/(^|\s|:|-|\(|\))([a-z])/g,RG=function(r,e,t){return r.length>0?e+t.toUpperCase():r},M4=(function(r){_o(e,r);function e(t,n){var s=r.call(this,t,n)||this;return s.src=n.currentSrc||n.src,s.intrinsicWidth=n.naturalWidth,s.intrinsicHeight=n.naturalHeight,s.context.cache.addImage(s.src),s}return e})(hl),N4=(function(r){_o(e,r);function e(t,n){var s=r.call(this,t,n)||this;return s.canvas=n,s.intrinsicWidth=n.width,s.intrinsicHeight=n.height,s}return e})(hl),P4=(function(r){_o(e,r);function e(t,n){var s=r.call(this,t,n)||this,i=new XMLSerializer,a=Pb(t,n);return n.setAttribute("width",a.width+"px"),n.setAttribute("height",a.height+"px"),s.svg="data:image/svg+xml,"+encodeURIComponent(i.serializeToString(n)),s.intrinsicWidth=n.width.baseVal.value,s.intrinsicHeight=n.height.baseVal.value,s.context.cache.addImage(s.svg),s}return e})(hl),D4=(function(r){_o(e,r);function e(t,n){var s=r.call(this,t,n)||this;return s.value=n.value,s}return e})(hl),d1=(function(r){_o(e,r);function e(t,n){var s=r.call(this,t,n)||this;return s.start=n.start,s.reversed=typeof n.reversed=="boolean"&&n.reversed===!0,s}return e})(hl),OG=[{type:15,flags:0,unit:"px",number:3}],QG=[{type:16,flags:0,number:50}],HG=function(r){return r.width>r.height?new ec(r.left+(r.width-r.height)/2,r.top,r.height,r.height):r.width<r.height?new ec(r.left,r.top+(r.height-r.width)/2,r.width,r.width):r},jG=function(r){var e=r.type===VG?new Array(r.value.length+1).join(""):r.value;return e.length===0?r.placeholder||"":e},$m="checkbox",Gm="radio",VG="password",kC=707406591,Yx=(function(r){_o(e,r);function e(t,n){var s=r.call(this,t,n)||this;switch(s.type=n.type.toLowerCase(),s.checked=n.checked,s.value=jG(n),(s.type===$m||s.type===Gm)&&(s.styles.backgroundColor=3739148031,s.styles.borderTopColor=s.styles.borderRightColor=s.styles.borderBottomColor=s.styles.borderLeftColor=2779096575,s.styles.borderTopWidth=s.styles.borderRightWidth=s.styles.borderBottomWidth=s.styles.borderLeftWidth=1,s.styles.borderTopStyle=s.styles.borderRightStyle=s.styles.borderBottomStyle=s.styles.borderLeftStyle=1,s.styles.backgroundClip=[0],s.styles.backgroundOrigin=[0],s.bounds=HG(s.bounds)),s.type){case $m:s.styles.borderTopRightRadius=s.styles.borderTopLeftRadius=s.styles.borderBottomRightRadius=s.styles.borderBottomLeftRadius=OG;break;case Gm:s.styles.borderTopRightRadius=s.styles.borderTopLeftRadius=s.styles.borderBottomRightRadius=s.styles.borderBottomLeftRadius=QG;break}return s}return e})(hl),R4=(function(r){_o(e,r);function e(t,n){var s=r.call(this,t,n)||this,i=n.options[n.selectedIndex||0];return s.value=i&&i.text||"",s}return e})(hl),O4=(function(r){_o(e,r);function e(t,n){var s=r.call(this,t,n)||this;return s.value=n.value,s}return e})(hl),Q4=(function(r){_o(e,r);function e(t,n){var s=r.call(this,t,n)||this;s.src=n.src,s.width=parseInt(n.width,10)||0,s.height=parseInt(n.height,10)||0,s.backgroundColor=s.styles.backgroundColor;try{if(n.contentWindow&&n.contentWindow.document&&n.contentWindow.document.documentElement){s.tree=j4(t,n.contentWindow.document.documentElement);var i=n.contentWindow.document.documentElement?zf(t,getComputedStyle(n.contentWindow.document.documentElement).backgroundColor):Wl.TRANSPARENT,a=n.contentWindow.document.body?zf(t,getComputedStyle(n.contentWindow.document.body).backgroundColor):Wl.TRANSPARENT;s.backgroundColor=aA(i)?aA(a)?s.styles.backgroundColor:a:i}}catch{}return s}return e})(hl),$G=["OL","UL","MENU"],nm=function(r,e,t,n){for(var s=e.firstChild,i=void 0;s;s=i)if(i=s.nextSibling,V4(s)&&s.data.trim().length>0)t.textNodes.push(new NG(r,s,t.styles));else if(Uu(s))if(K4(s)&&s.assignedNodes)s.assignedNodes().forEach(function(o){return nm(r,o,t,n)});else{var a=H4(r,s);a.styles.isVisible()&&(GG(s,a,n)?a.flags|=4:zG(a.styles)&&(a.flags|=2),$G.indexOf(s.tagName)!==-1&&(a.flags|=8),t.elements.push(a),s.slot,s.shadowRoot?nm(r,s.shadowRoot,a,n):!zm(s)&&!$4(s)&&!Km(s)&&nm(r,s,a,n))}},H4=function(r,e){return h1(e)?new M4(r,e):G4(e)?new N4(r,e):$4(e)?new P4(r,e):KG(e)?new D4(r,e):qG(e)?new d1(r,e):WG(e)?new Yx(r,e):Km(e)?new R4(r,e):zm(e)?new O4(r,e):z4(e)?new Q4(r,e):new hl(r,e)},j4=function(r,e){var t=H4(r,e);return t.flags|=4,nm(r,e,t,t),t},GG=function(r,e,t){return e.styles.isPositionedWithZIndex()||e.styles.opacity<1||e.styles.isTransformed()||Xx(r)&&t.styles.isTransparent()},zG=function(r){return r.isPositioned()||r.isFloating()},V4=function(r){return r.nodeType===Node.TEXT_NODE},Uu=function(r){return r.nodeType===Node.ELEMENT_NODE},u1=function(r){return Uu(r)&&typeof r.style<"u"&&!sm(r)},sm=function(r){return typeof r.className=="object"},KG=function(r){return r.tagName==="LI"},qG=function(r){return r.tagName==="OL"},WG=function(r){return r.tagName==="INPUT"},YG=function(r){return r.tagName==="HTML"},$4=function(r){return r.tagName==="svg"},Xx=function(r){return r.tagName==="BODY"},G4=function(r){return r.tagName==="CANVAS"},EC=function(r){return r.tagName==="VIDEO"},h1=function(r){return r.tagName==="IMG"},z4=function(r){return r.tagName==="IFRAME"},IC=function(r){return r.tagName==="STYLE"},XG=function(r){return r.tagName==="SCRIPT"},zm=function(r){return r.tagName==="TEXTAREA"},Km=function(r){return r.tagName==="SELECT"},K4=function(r){return r.tagName==="SLOT"},TC=function(r){return r.tagName.indexOf("-")>0},JG=(function(){function r(){this.counters={}}return r.prototype.getCounterValue=function(e){var t=this.counters[e];return t&&t.length?t[t.length-1]:1},r.prototype.getCounterValues=function(e){var t=this.counters[e];return t||[]},r.prototype.pop=function(e){var t=this;e.forEach(function(n){return t.counters[n].pop()})},r.prototype.parse=function(e){var t=this,n=e.counterIncrement,s=e.counterReset,i=!0;n!==null&&n.forEach(function(o){var l=t.counters[o.counter];l&&o.increment!==0&&(i=!1,l.length||l.push(1),l[Math.max(0,l.length-1)]+=o.increment)});var a=[];return i&&s.forEach(function(o){var l=t.counters[o.counter];a.push(o.counter),l||(l=t.counters[o.counter]=[]),l.push(o.reset)}),a},r})(),FC={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},LC={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},ZG={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},ez={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},pu=function(r,e,t,n,s,i){return r<e||r>t?yg(r,s,i.length>0):n.integers.reduce(function(a,o,l){for(;r>=o;)r-=o,a+=n.values[l];return a},"")+i},q4=function(r,e,t,n){var s="";do t||r--,s=n(r)+s,r/=e;while(r*e>=e);return s},ns=function(r,e,t,n,s){var i=t-e+1;return(r<0?"-":"")+(q4(Math.abs(r),i,n,function(a){return ss(Math.floor(a%i)+e)})+s)},ed=function(r,e,t){t===void 0&&(t=". ");var n=e.length;return q4(Math.abs(r),n,!1,function(s){return e[Math.floor(s%n)]})+t},_u=1,Oc=2,Qc=4,_f=8,Fl=function(r,e,t,n,s,i){if(r<-9999||r>9999)return yg(r,4,s.length>0);var a=Math.abs(r),o=s;if(a===0)return e[0]+o;for(var l=0;a>0&&l<=4;l++){var c=a%10;c===0&&Us(i,_u)&&o!==""?o=e[c]+o:c>1||c===1&&l===0||c===1&&l===1&&Us(i,Oc)||c===1&&l===1&&Us(i,Qc)&&r>100||c===1&&l>1&&Us(i,_f)?o=e[c]+(l>0?t[l-1]:"")+o:c===1&&l>0&&(o=t[l-1]+o),a=Math.floor(a/10)}return(r<0?n:"")+o},UC="",MC="",NC="",xw="",yg=function(r,e,t){var n=t?". ":"",s=t?"":"",i=t?", ":"",a=t?" ":"";switch(e){case 0:return""+a;case 1:return""+a;case 2:return""+a;case 5:var o=ns(r,48,57,!0,n);return o.length<4?"0"+o:o;case 4:return ed(r,"",s);case 6:return pu(r,1,3999,FC,3,n).toLowerCase();case 7:return pu(r,1,3999,FC,3,n);case 8:return ns(r,945,969,!1,n);case 9:return ns(r,97,122,!1,n);case 10:return ns(r,65,90,!1,n);case 11:return ns(r,1632,1641,!0,n);case 12:case 49:return pu(r,1,9999,LC,3,n);case 35:return pu(r,1,9999,LC,3,n).toLowerCase();case 13:return ns(r,2534,2543,!0,n);case 14:case 30:return ns(r,6112,6121,!0,n);case 15:return ed(r,"",s);case 16:return ed(r,"",s);case 17:case 48:return Fl(r,"",UC,"",s,Oc|Qc|_f);case 47:return Fl(r,"",MC,"",s,_u|Oc|Qc|_f);case 42:return Fl(r,"",UC,"",s,Oc|Qc|_f);case 41:return Fl(r,"",MC,"",s,_u|Oc|Qc|_f);case 26:return Fl(r,"","",NC,s,0);case 25:return Fl(r,"","",NC,s,_u|Oc|Qc);case 31:return Fl(r,"","",xw,i,_u|Oc|Qc);case 33:return Fl(r,"","",xw,i,0);case 32:return Fl(r,"","",xw,i,_u|Oc|Qc);case 18:return ns(r,2406,2415,!0,n);case 20:return pu(r,1,19999,ez,3,n);case 21:return ns(r,2790,2799,!0,n);case 22:return ns(r,2662,2671,!0,n);case 22:return pu(r,1,10999,ZG,3,n);case 23:return ed(r,"");case 24:return ed(r,"");case 27:return ns(r,3302,3311,!0,n);case 28:return ed(r,"",s);case 29:return ed(r,"",s);case 34:return ns(r,3792,3801,!0,n);case 37:return ns(r,6160,6169,!0,n);case 38:return ns(r,4160,4169,!0,n);case 39:return ns(r,2918,2927,!0,n);case 40:return ns(r,1776,1785,!0,n);case 43:return ns(r,3046,3055,!0,n);case 44:return ns(r,3174,3183,!0,n);case 45:return ns(r,3664,3673,!0,n);case 46:return ns(r,3872,3881,!0,n);case 3:default:return ns(r,48,57,!0,n)}},W4="data-html2canvas-ignore",PC=(function(){function r(e,t,n){if(this.context=e,this.options=n,this.scrolledElements=[],this.referenceElement=t,this.counters=new JG,this.quoteDepth=0,!t.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(t.ownerDocument.documentElement,!1)}return r.prototype.toIFrame=function(e,t){var n=this,s=tz(e,t);if(!s.contentWindow)return Promise.reject("Unable to find iframe window");var i=e.defaultView.pageXOffset,a=e.defaultView.pageYOffset,o=s.contentWindow,l=o.document,c=sz(s).then(function(){return Qi(n,void 0,void 0,function(){var A,d;return xi(this,function(h){switch(h.label){case 0:return this.scrolledElements.forEach(lz),o&&(o.scrollTo(t.left,t.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(o.scrollY!==t.top||o.scrollX!==t.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(o.scrollX-t.left,o.scrollY-t.top,0,0))),A=this.options.onclone,d=this.clonedReferenceElement,typeof d>"u"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:l.fonts&&l.fonts.ready?[4,l.fonts.ready]:[3,2];case 1:h.sent(),h.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,nz(l)]:[3,4];case 3:h.sent(),h.label=4;case 4:return typeof A=="function"?[2,Promise.resolve().then(function(){return A(l,d)}).then(function(){return s})]:[2,s]}})})});return l.open(),l.write(az(document.doctype)+"<html></html>"),oz(this.referenceElement.ownerDocument,i,a),l.replaceChild(l.adoptNode(this.documentElement),l.documentElement),l.close(),c},r.prototype.createElementClone=function(e){if(c1(e,2))debugger;if(G4(e))return this.createCanvasClone(e);if(EC(e))return this.createVideoClone(e);if(IC(e))return this.createStyleClone(e);var t=e.cloneNode(!1);return h1(t)&&(h1(e)&&e.currentSrc&&e.currentSrc!==e.src&&(t.src=e.currentSrc,t.srcset=""),t.loading==="lazy"&&(t.loading="eager")),TC(t)?this.createCustomElementClone(t):t},r.prototype.createCustomElementClone=function(e){var t=document.createElement("html2canvascustomelement");return _w(e.style,t),t},r.prototype.createStyleClone=function(e){try{var t=e.sheet;if(t&&t.cssRules){var n=[].slice.call(t.cssRules,0).reduce(function(i,a){return a&&typeof a.cssText=="string"?i+a.cssText:i},""),s=e.cloneNode(!1);return s.textContent=n,s}}catch(i){if(this.context.logger.error("Unable to access cssRules property",i),i.name!=="SecurityError")throw i}return e.cloneNode(!1)},r.prototype.createCanvasClone=function(e){var t;if(this.options.inlineImages&&e.ownerDocument){var n=e.ownerDocument.createElement("img");try{return n.src=e.toDataURL(),n}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",e)}}var s=e.cloneNode(!1);try{s.width=e.width,s.height=e.height;var i=e.getContext("2d"),a=s.getContext("2d");if(a)if(!this.options.allowTaint&&i)a.putImageData(i.getImageData(0,0,e.width,e.height),0,0);else{var o=(t=e.getContext("webgl2"))!==null&&t!==void 0?t:e.getContext("webgl");if(o){var l=o.getContextAttributes();(l==null?void 0:l.preserveDrawingBuffer)===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",e)}a.drawImage(e,0,0)}return s}catch{this.context.logger.info("Unable to clone canvas as it is tainted",e)}return s},r.prototype.createVideoClone=function(e){var t=e.ownerDocument.createElement("canvas");t.width=e.offsetWidth,t.height=e.offsetHeight;var n=t.getContext("2d");try{return n&&(n.drawImage(e,0,0,t.width,t.height),this.options.allowTaint||n.getImageData(0,0,t.width,t.height)),t}catch{this.context.logger.info("Unable to clone video as it is tainted",e)}var s=e.ownerDocument.createElement("canvas");return s.width=e.offsetWidth,s.height=e.offsetHeight,s},r.prototype.appendChildNode=function(e,t,n){(!Uu(t)||!XG(t)&&!t.hasAttribute(W4)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(t)))&&(!this.options.copyStyles||!Uu(t)||!IC(t))&&e.appendChild(this.cloneNode(t,n))},r.prototype.cloneChildNodes=function(e,t,n){for(var s=this,i=e.shadowRoot?e.shadowRoot.firstChild:e.firstChild;i;i=i.nextSibling)if(Uu(i)&&K4(i)&&typeof i.assignedNodes=="function"){var a=i.assignedNodes();a.length&&a.forEach(function(o){return s.appendChildNode(t,o,n)})}else this.appendChildNode(t,i,n)},r.prototype.cloneNode=function(e,t){if(V4(e))return document.createTextNode(e.data);if(!e.ownerDocument)return e.cloneNode(!1);var n=e.ownerDocument.defaultView;if(n&&Uu(e)&&(u1(e)||sm(e))){var s=this.createElementClone(e);s.style.transitionProperty="none";var i=n.getComputedStyle(e),a=n.getComputedStyle(e,":before"),o=n.getComputedStyle(e,":after");this.referenceElement===e&&u1(s)&&(this.clonedReferenceElement=s),Xx(s)&&dz(s);var l=this.counters.parse(new hC(this.context,i)),c=this.resolvePseudoContent(e,s,a,Wf.BEFORE);TC(e)&&(t=!0),EC(e)||this.cloneChildNodes(e,s,t),c&&s.insertBefore(c,s.firstChild);var A=this.resolvePseudoContent(e,s,o,Wf.AFTER);return A&&s.appendChild(A),this.counters.pop(l),(i&&(this.options.copyStyles||sm(e))&&!z4(e)||t)&&_w(i,s),(e.scrollTop!==0||e.scrollLeft!==0)&&this.scrolledElements.push([s,e.scrollLeft,e.scrollTop]),(zm(e)||Km(e))&&(zm(s)||Km(s))&&(s.value=e.value),s}return e.cloneNode(!1)},r.prototype.resolvePseudoContent=function(e,t,n,s){var i=this;if(n){var a=n.content,o=t.ownerDocument;if(!(!o||!a||a==="none"||a==="-moz-alt-content"||n.display==="none")){this.counters.parse(new hC(this.context,n));var l=new K$(this.context,n),c=o.createElement("html2canvaspseudoelement");_w(n,c),l.content.forEach(function(d){if(d.type===0)c.appendChild(o.createTextNode(d.value));else if(d.type===22){var h=o.createElement("img");h.src=d.value,h.style.opacity="1",c.appendChild(h)}else if(d.type===18){if(d.name==="attr"){var u=d.values.filter(an);u.length&&c.appendChild(o.createTextNode(e.getAttribute(u[0].value)||""))}else if(d.name==="counter"){var p=d.values.filter(ih),f=p[0],g=p[1];if(f&&an(f)){var m=i.counters.getCounterValue(f.value),x=g&&an(g)?l1.parse(i.context,g.value):3;c.appendChild(o.createTextNode(yg(m,x,!1)))}}else if(d.name==="counters"){var S=d.values.filter(ih),f=S[0],B=S[1],g=S[2];if(f&&an(f)){var F=i.counters.getCounterValues(f.value),N=g&&an(g)?l1.parse(i.context,g.value):3,E=B&&B.type===0?B.value:"",w=F.map(function(k){return yg(k,N,!1)}).join(E);c.appendChild(o.createTextNode(w))}}}else if(d.type===20)switch(d.value){case"open-quote":c.appendChild(o.createTextNode(uC(l.quotes,i.quoteDepth++,!0)));break;case"close-quote":c.appendChild(o.createTextNode(uC(l.quotes,--i.quoteDepth,!1)));break;default:c.appendChild(o.createTextNode(d.value))}}),c.className=f1+" "+g1;var A=s===Wf.BEFORE?" "+f1:" "+g1;return sm(t)?t.className.baseValue+=A:t.className+=A,c}}},r.destroy=function(e){return e.parentNode?(e.parentNode.removeChild(e),!0):!1},r})(),Wf;(function(r){r[r.BEFORE=0]="BEFORE",r[r.AFTER=1]="AFTER"})(Wf||(Wf={}));var tz=function(r,e){var t=r.createElement("iframe");return t.className="html2canvas-container",t.style.visibility="hidden",t.style.position="fixed",t.style.left="-10000px",t.style.top="0px",t.style.border="0",t.width=e.width.toString(),t.height=e.height.toString(),t.scrolling="no",t.setAttribute(W4,"true"),r.body.appendChild(t),t},rz=function(r){return new Promise(function(e){if(r.complete){e();return}if(!r.src){e();return}r.onload=e,r.onerror=e})},nz=function(r){return Promise.all([].slice.call(r.images,0).map(rz))},sz=function(r){return new Promise(function(e,t){var n=r.contentWindow;if(!n)return t("No window assigned for iframe");var s=n.document;n.onload=r.onload=function(){n.onload=r.onload=null;var i=setInterval(function(){s.body.childNodes.length>0&&s.readyState==="complete"&&(clearInterval(i),e(r))},50)}})},iz=["all","d","content"],_w=function(r,e){for(var t=r.length-1;t>=0;t--){var n=r.item(t);iz.indexOf(n)===-1&&e.style.setProperty(n,r.getPropertyValue(n))}return e},az=function(r){var e="";return r&&(e+="<!DOCTYPE ",r.name&&(e+=r.name),r.internalSubset&&(e+=r.internalSubset),r.publicId&&(e+='"'+r.publicId+'"'),r.systemId&&(e+='"'+r.systemId+'"'),e+=">"),e},oz=function(r,e,t){r&&r.defaultView&&(e!==r.defaultView.pageXOffset||t!==r.defaultView.pageYOffset)&&r.defaultView.scrollTo(e,t)},lz=function(r){var e=r[0],t=r[1],n=r[2];e.scrollLeft=t,e.scrollTop=n},cz=":before",Az=":after",f1="___html2canvas___pseudoelement_before",g1="___html2canvas___pseudoelement_after",DC=`{
    content: "" !important;
    display: none !important;
}`,dz=function(r){uz(r,"."+f1+cz+DC+`
         .`+g1+Az+DC)},uz=function(r,e){var t=r.ownerDocument;if(t){var n=t.createElement("style");n.textContent=e,r.appendChild(n)}},Y4=(function(){function r(){}return r.getOrigin=function(e){var t=r._link;return t?(t.href=e,t.href=t.href,t.protocol+t.hostname+t.port):"about:blank"},r.isSameOrigin=function(e){return r.getOrigin(e)===r._origin},r.setContext=function(e){r._link=e.document.createElement("a"),r._origin=r.getOrigin(e.location.href)},r._origin="about:blank",r})(),hz=(function(){function r(e,t){this.context=e,this._options=t,this._cache={}}return r.prototype.addImage=function(e){var t=Promise.resolve();return this.has(e)||(Cw(e)||mz(e))&&(this._cache[e]=this.loadImage(e)).catch(function(){}),t},r.prototype.match=function(e){return this._cache[e]},r.prototype.loadImage=function(e){return Qi(this,void 0,void 0,function(){var t,n,s,i,a=this;return xi(this,function(o){switch(o.label){case 0:return t=Y4.isSameOrigin(e),n=!Bw(e)&&this._options.useCORS===!0&&oi.SUPPORT_CORS_IMAGES&&!t,s=!Bw(e)&&!t&&!Cw(e)&&typeof this._options.proxy=="string"&&oi.SUPPORT_CORS_XHR&&!n,!t&&this._options.allowTaint===!1&&!Bw(e)&&!Cw(e)&&!s&&!n?[2]:(i=e,s?[4,this.proxy(i)]:[3,2]);case 1:i=o.sent(),o.label=2;case 2:return this.context.logger.debug("Added image "+e.substring(0,256)),[4,new Promise(function(l,c){var A=new Image;A.onload=function(){return l(A)},A.onerror=c,(bz(i)||n)&&(A.crossOrigin="anonymous"),A.src=i,A.complete===!0&&setTimeout(function(){return l(A)},500),a._options.imageTimeout>0&&setTimeout(function(){return c("Timed out ("+a._options.imageTimeout+"ms) loading image")},a._options.imageTimeout)})];case 3:return[2,o.sent()]}})})},r.prototype.has=function(e){return typeof this._cache[e]<"u"},r.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},r.prototype.proxy=function(e){var t=this,n=this._options.proxy;if(!n)throw new Error("No proxy defined");var s=e.substring(0,256);return new Promise(function(i,a){var o=oi.SUPPORT_RESPONSE_TYPE?"blob":"text",l=new XMLHttpRequest;l.onload=function(){if(l.status===200)if(o==="text")i(l.response);else{var d=new FileReader;d.addEventListener("load",function(){return i(d.result)},!1),d.addEventListener("error",function(h){return a(h)},!1),d.readAsDataURL(l.response)}else a("Failed to proxy resource "+s+" with status code "+l.status)},l.onerror=a;var c=n.indexOf("?")>-1?"&":"?";if(l.open("GET",""+n+c+"url="+encodeURIComponent(e)+"&responseType="+o),o!=="text"&&l instanceof XMLHttpRequest&&(l.responseType=o),t._options.imageTimeout){var A=t._options.imageTimeout;l.timeout=A,l.ontimeout=function(){return a("Timed out ("+A+"ms) proxying "+s)}}l.send()})},r})(),fz=/^data:image\/svg\+xml/i,gz=/^data:image\/.*;base64,/i,pz=/^data:image\/.*/i,mz=function(r){return oi.SUPPORT_SVG_DRAWING||!yz(r)},Bw=function(r){return pz.test(r)},bz=function(r){return gz.test(r)},Cw=function(r){return r.substr(0,4)==="blob"},yz=function(r){return r.substr(-3).toLowerCase()==="svg"||fz.test(r)},gt=(function(){function r(e,t){this.type=0,this.x=e,this.y=t}return r.prototype.add=function(e,t){return new r(this.x+e,this.y+t)},r})(),mu=function(r,e,t){return new gt(r.x+(e.x-r.x)*t,r.y+(e.y-r.y)*t)},y0=(function(){function r(e,t,n,s){this.type=1,this.start=e,this.startControl=t,this.endControl=n,this.end=s}return r.prototype.subdivide=function(e,t){var n=mu(this.start,this.startControl,e),s=mu(this.startControl,this.endControl,e),i=mu(this.endControl,this.end,e),a=mu(n,s,e),o=mu(s,i,e),l=mu(a,o,e);return t?new r(this.start,n,a,l):new r(l,o,i,this.end)},r.prototype.add=function(e,t){return new r(this.start.add(e,t),this.startControl.add(e,t),this.endControl.add(e,t),this.end.add(e,t))},r.prototype.reverse=function(){return new r(this.end,this.endControl,this.startControl,this.start)},r})(),qa=function(r){return r.type===1},wz=(function(){function r(e){var t=e.styles,n=e.bounds,s=vf(t.borderTopLeftRadius,n.width,n.height),i=s[0],a=s[1],o=vf(t.borderTopRightRadius,n.width,n.height),l=o[0],c=o[1],A=vf(t.borderBottomRightRadius,n.width,n.height),d=A[0],h=A[1],u=vf(t.borderBottomLeftRadius,n.width,n.height),p=u[0],f=u[1],g=[];g.push((i+l)/n.width),g.push((p+d)/n.width),g.push((a+f)/n.height),g.push((c+h)/n.height);var m=Math.max.apply(Math,g);m>1&&(i/=m,a/=m,l/=m,c/=m,d/=m,h/=m,p/=m,f/=m);var x=n.width-l,S=n.height-h,B=n.width-d,F=n.height-f,N=t.borderTopWidth,E=t.borderRightWidth,w=t.borderBottomWidth,v=t.borderLeftWidth,I=wn(t.paddingTop,e.bounds.width),k=wn(t.paddingRight,e.bounds.width),_=wn(t.paddingBottom,e.bounds.width),T=wn(t.paddingLeft,e.bounds.width);this.topLeftBorderDoubleOuterBox=i>0||a>0?Un(n.left+v/3,n.top+N/3,i-v/3,a-N/3,Wr.TOP_LEFT):new gt(n.left+v/3,n.top+N/3),this.topRightBorderDoubleOuterBox=i>0||a>0?Un(n.left+x,n.top+N/3,l-E/3,c-N/3,Wr.TOP_RIGHT):new gt(n.left+n.width-E/3,n.top+N/3),this.bottomRightBorderDoubleOuterBox=d>0||h>0?Un(n.left+B,n.top+S,d-E/3,h-w/3,Wr.BOTTOM_RIGHT):new gt(n.left+n.width-E/3,n.top+n.height-w/3),this.bottomLeftBorderDoubleOuterBox=p>0||f>0?Un(n.left+v/3,n.top+F,p-v/3,f-w/3,Wr.BOTTOM_LEFT):new gt(n.left+v/3,n.top+n.height-w/3),this.topLeftBorderDoubleInnerBox=i>0||a>0?Un(n.left+v*2/3,n.top+N*2/3,i-v*2/3,a-N*2/3,Wr.TOP_LEFT):new gt(n.left+v*2/3,n.top+N*2/3),this.topRightBorderDoubleInnerBox=i>0||a>0?Un(n.left+x,n.top+N*2/3,l-E*2/3,c-N*2/3,Wr.TOP_RIGHT):new gt(n.left+n.width-E*2/3,n.top+N*2/3),this.bottomRightBorderDoubleInnerBox=d>0||h>0?Un(n.left+B,n.top+S,d-E*2/3,h-w*2/3,Wr.BOTTOM_RIGHT):new gt(n.left+n.width-E*2/3,n.top+n.height-w*2/3),this.bottomLeftBorderDoubleInnerBox=p>0||f>0?Un(n.left+v*2/3,n.top+F,p-v*2/3,f-w*2/3,Wr.BOTTOM_LEFT):new gt(n.left+v*2/3,n.top+n.height-w*2/3),this.topLeftBorderStroke=i>0||a>0?Un(n.left+v/2,n.top+N/2,i-v/2,a-N/2,Wr.TOP_LEFT):new gt(n.left+v/2,n.top+N/2),this.topRightBorderStroke=i>0||a>0?Un(n.left+x,n.top+N/2,l-E/2,c-N/2,Wr.TOP_RIGHT):new gt(n.left+n.width-E/2,n.top+N/2),this.bottomRightBorderStroke=d>0||h>0?Un(n.left+B,n.top+S,d-E/2,h-w/2,Wr.BOTTOM_RIGHT):new gt(n.left+n.width-E/2,n.top+n.height-w/2),this.bottomLeftBorderStroke=p>0||f>0?Un(n.left+v/2,n.top+F,p-v/2,f-w/2,Wr.BOTTOM_LEFT):new gt(n.left+v/2,n.top+n.height-w/2),this.topLeftBorderBox=i>0||a>0?Un(n.left,n.top,i,a,Wr.TOP_LEFT):new gt(n.left,n.top),this.topRightBorderBox=l>0||c>0?Un(n.left+x,n.top,l,c,Wr.TOP_RIGHT):new gt(n.left+n.width,n.top),this.bottomRightBorderBox=d>0||h>0?Un(n.left+B,n.top+S,d,h,Wr.BOTTOM_RIGHT):new gt(n.left+n.width,n.top+n.height),this.bottomLeftBorderBox=p>0||f>0?Un(n.left,n.top+F,p,f,Wr.BOTTOM_LEFT):new gt(n.left,n.top+n.height),this.topLeftPaddingBox=i>0||a>0?Un(n.left+v,n.top+N,Math.max(0,i-v),Math.max(0,a-N),Wr.TOP_LEFT):new gt(n.left+v,n.top+N),this.topRightPaddingBox=l>0||c>0?Un(n.left+Math.min(x,n.width-E),n.top+N,x>n.width+E?0:Math.max(0,l-E),Math.max(0,c-N),Wr.TOP_RIGHT):new gt(n.left+n.width-E,n.top+N),this.bottomRightPaddingBox=d>0||h>0?Un(n.left+Math.min(B,n.width-v),n.top+Math.min(S,n.height-w),Math.max(0,d-E),Math.max(0,h-w),Wr.BOTTOM_RIGHT):new gt(n.left+n.width-E,n.top+n.height-w),this.bottomLeftPaddingBox=p>0||f>0?Un(n.left+v,n.top+Math.min(F,n.height-w),Math.max(0,p-v),Math.max(0,f-w),Wr.BOTTOM_LEFT):new gt(n.left+v,n.top+n.height-w),this.topLeftContentBox=i>0||a>0?Un(n.left+v+T,n.top+N+I,Math.max(0,i-(v+T)),Math.max(0,a-(N+I)),Wr.TOP_LEFT):new gt(n.left+v+T,n.top+N+I),this.topRightContentBox=l>0||c>0?Un(n.left+Math.min(x,n.width+v+T),n.top+N+I,x>n.width+v+T?0:l-v+T,c-(N+I),Wr.TOP_RIGHT):new gt(n.left+n.width-(E+k),n.top+N+I),this.bottomRightContentBox=d>0||h>0?Un(n.left+Math.min(B,n.width-(v+T)),n.top+Math.min(S,n.height+N+I),Math.max(0,d-(E+k)),h-(w+_),Wr.BOTTOM_RIGHT):new gt(n.left+n.width-(E+k),n.top+n.height-(w+_)),this.bottomLeftContentBox=p>0||f>0?Un(n.left+v+T,n.top+F,Math.max(0,p-(v+T)),f-(w+_),Wr.BOTTOM_LEFT):new gt(n.left+v+T,n.top+n.height-(w+_))}return r})(),Wr;(function(r){r[r.TOP_LEFT=0]="TOP_LEFT",r[r.TOP_RIGHT=1]="TOP_RIGHT",r[r.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",r[r.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(Wr||(Wr={}));var Un=function(r,e,t,n,s){var i=4*((Math.sqrt(2)-1)/3),a=t*i,o=n*i,l=r+t,c=e+n;switch(s){case Wr.TOP_LEFT:return new y0(new gt(r,c),new gt(r,c-o),new gt(l-a,e),new gt(l,e));case Wr.TOP_RIGHT:return new y0(new gt(r,e),new gt(r+a,e),new gt(l,c-o),new gt(l,c));case Wr.BOTTOM_RIGHT:return new y0(new gt(l,e),new gt(l,e+o),new gt(r+a,c),new gt(r,c));case Wr.BOTTOM_LEFT:default:return new y0(new gt(l,c),new gt(l-a,c),new gt(r,e+o),new gt(r,e))}},qm=function(r){return[r.topLeftBorderBox,r.topRightBorderBox,r.bottomRightBorderBox,r.bottomLeftBorderBox]},vz=function(r){return[r.topLeftContentBox,r.topRightContentBox,r.bottomRightContentBox,r.bottomLeftContentBox]},Wm=function(r){return[r.topLeftPaddingBox,r.topRightPaddingBox,r.bottomRightPaddingBox,r.bottomLeftPaddingBox]},xz=(function(){function r(e,t,n){this.offsetX=e,this.offsetY=t,this.matrix=n,this.type=0,this.target=6}return r})(),w0=(function(){function r(e,t){this.path=e,this.target=t,this.type=1}return r})(),_z=(function(){function r(e){this.opacity=e,this.type=2,this.target=6}return r})(),Bz=function(r){return r.type===0},X4=function(r){return r.type===1},Cz=function(r){return r.type===2},RC=function(r,e){return r.length===e.length?r.some(function(t,n){return t===e[n]}):!1},Sz=function(r,e,t,n,s){return r.map(function(i,a){switch(a){case 0:return i.add(e,t);case 1:return i.add(e+n,t);case 2:return i.add(e+n,t+s);case 3:return i.add(e,t+s)}return i})},J4=(function(){function r(e){this.element=e,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return r})(),Z4=(function(){function r(e,t){if(this.container=e,this.parent=t,this.effects=[],this.curves=new wz(this.container),this.container.styles.opacity<1&&this.effects.push(new _z(this.container.styles.opacity)),this.container.styles.transform!==null){var n=this.container.bounds.left+this.container.styles.transformOrigin[0].number,s=this.container.bounds.top+this.container.styles.transformOrigin[1].number,i=this.container.styles.transform;this.effects.push(new xz(n,s,i))}if(this.container.styles.overflowX!==0){var a=qm(this.curves),o=Wm(this.curves);RC(a,o)?this.effects.push(new w0(a,6)):(this.effects.push(new w0(a,2)),this.effects.push(new w0(o,4)))}}return r.prototype.getEffects=function(e){for(var t=[2,3].indexOf(this.container.styles.position)===-1,n=this.parent,s=this.effects.slice(0);n;){var i=n.effects.filter(function(l){return!X4(l)});if(t||n.container.styles.position!==0||!n.parent){if(s.unshift.apply(s,i),t=[2,3].indexOf(n.container.styles.position)===-1,n.container.styles.overflowX!==0){var a=qm(n.curves),o=Wm(n.curves);RC(a,o)||s.unshift(new w0(o,6))}}else s.unshift.apply(s,i);n=n.parent}return s.filter(function(l){return Us(l.target,e)})},r})(),p1=function(r,e,t,n){r.container.elements.forEach(function(s){var i=Us(s.flags,4),a=Us(s.flags,2),o=new Z4(s,r);Us(s.styles.display,2048)&&n.push(o);var l=Us(s.flags,8)?[]:n;if(i||a){var c=i||s.styles.isPositioned()?t:e,A=new J4(o);if(s.styles.isPositioned()||s.styles.opacity<1||s.styles.isTransformed()){var d=s.styles.zIndex.order;if(d<0){var h=0;c.negativeZIndex.some(function(p,f){return d>p.element.container.styles.zIndex.order?(h=f,!1):h>0}),c.negativeZIndex.splice(h,0,A)}else if(d>0){var u=0;c.positiveZIndex.some(function(p,f){return d>=p.element.container.styles.zIndex.order?(u=f+1,!1):u>0}),c.positiveZIndex.splice(u,0,A)}else c.zeroOrAutoZIndexOrTransformedOrOpacity.push(A)}else s.styles.isFloating()?c.nonPositionedFloats.push(A):c.nonPositionedInlineLevel.push(A);p1(o,A,i?A:t,l)}else s.styles.isInlineLevel()?e.inlineLevel.push(o):e.nonInlineLevel.push(o),p1(o,e,t,l);Us(s.flags,8)&&eF(s,l)})},eF=function(r,e){for(var t=r instanceof d1?r.start:1,n=r instanceof d1?r.reversed:!1,s=0;s<e.length;s++){var i=e[s];i.container instanceof D4&&typeof i.container.value=="number"&&i.container.value!==0&&(t=i.container.value),i.listValue=yg(t,i.container.styles.listStyleType,!0),t+=n?-1:1}},kz=function(r){var e=new Z4(r,null),t=new J4(e),n=[];return p1(e,t,t,n),eF(e.container,n),t},OC=function(r,e){switch(e){case 0:return Ja(r.topLeftBorderBox,r.topLeftPaddingBox,r.topRightBorderBox,r.topRightPaddingBox);case 1:return Ja(r.topRightBorderBox,r.topRightPaddingBox,r.bottomRightBorderBox,r.bottomRightPaddingBox);case 2:return Ja(r.bottomRightBorderBox,r.bottomRightPaddingBox,r.bottomLeftBorderBox,r.bottomLeftPaddingBox);case 3:default:return Ja(r.bottomLeftBorderBox,r.bottomLeftPaddingBox,r.topLeftBorderBox,r.topLeftPaddingBox)}},Ez=function(r,e){switch(e){case 0:return Ja(r.topLeftBorderBox,r.topLeftBorderDoubleOuterBox,r.topRightBorderBox,r.topRightBorderDoubleOuterBox);case 1:return Ja(r.topRightBorderBox,r.topRightBorderDoubleOuterBox,r.bottomRightBorderBox,r.bottomRightBorderDoubleOuterBox);case 2:return Ja(r.bottomRightBorderBox,r.bottomRightBorderDoubleOuterBox,r.bottomLeftBorderBox,r.bottomLeftBorderDoubleOuterBox);case 3:default:return Ja(r.bottomLeftBorderBox,r.bottomLeftBorderDoubleOuterBox,r.topLeftBorderBox,r.topLeftBorderDoubleOuterBox)}},Iz=function(r,e){switch(e){case 0:return Ja(r.topLeftBorderDoubleInnerBox,r.topLeftPaddingBox,r.topRightBorderDoubleInnerBox,r.topRightPaddingBox);case 1:return Ja(r.topRightBorderDoubleInnerBox,r.topRightPaddingBox,r.bottomRightBorderDoubleInnerBox,r.bottomRightPaddingBox);case 2:return Ja(r.bottomRightBorderDoubleInnerBox,r.bottomRightPaddingBox,r.bottomLeftBorderDoubleInnerBox,r.bottomLeftPaddingBox);case 3:default:return Ja(r.bottomLeftBorderDoubleInnerBox,r.bottomLeftPaddingBox,r.topLeftBorderDoubleInnerBox,r.topLeftPaddingBox)}},Tz=function(r,e){switch(e){case 0:return v0(r.topLeftBorderStroke,r.topRightBorderStroke);case 1:return v0(r.topRightBorderStroke,r.bottomRightBorderStroke);case 2:return v0(r.bottomRightBorderStroke,r.bottomLeftBorderStroke);case 3:default:return v0(r.bottomLeftBorderStroke,r.topLeftBorderStroke)}},v0=function(r,e){var t=[];return qa(r)?t.push(r.subdivide(.5,!1)):t.push(r),qa(e)?t.push(e.subdivide(.5,!0)):t.push(e),t},Ja=function(r,e,t,n){var s=[];return qa(r)?s.push(r.subdivide(.5,!1)):s.push(r),qa(t)?s.push(t.subdivide(.5,!0)):s.push(t),qa(n)?s.push(n.subdivide(.5,!0).reverse()):s.push(n),qa(e)?s.push(e.subdivide(.5,!1).reverse()):s.push(e),s},tF=function(r){var e=r.bounds,t=r.styles;return e.add(t.borderLeftWidth,t.borderTopWidth,-(t.borderRightWidth+t.borderLeftWidth),-(t.borderTopWidth+t.borderBottomWidth))},Ym=function(r){var e=r.styles,t=r.bounds,n=wn(e.paddingLeft,t.width),s=wn(e.paddingRight,t.width),i=wn(e.paddingTop,t.width),a=wn(e.paddingBottom,t.width);return t.add(n+e.borderLeftWidth,i+e.borderTopWidth,-(e.borderRightWidth+e.borderLeftWidth+n+s),-(e.borderTopWidth+e.borderBottomWidth+i+a))},Fz=function(r,e){return r===0?e.bounds:r===2?Ym(e):tF(e)},Lz=function(r,e){return r===0?e.bounds:r===2?Ym(e):tF(e)},Sw=function(r,e,t){var n=Fz(Bu(r.styles.backgroundOrigin,e),r),s=Lz(Bu(r.styles.backgroundClip,e),r),i=Uz(Bu(r.styles.backgroundSize,e),t,n),a=i[0],o=i[1],l=vf(Bu(r.styles.backgroundPosition,e),n.width-a,n.height-o),c=Mz(Bu(r.styles.backgroundRepeat,e),l,i,n,s),A=Math.round(n.left+l[0]),d=Math.round(n.top+l[1]);return[c,A,d,a,o]},bu=function(r){return an(r)&&r.value===Hu.AUTO},x0=function(r){return typeof r=="number"},Uz=function(r,e,t){var n=e[0],s=e[1],i=e[2],a=r[0],o=r[1];if(!a)return[0,0];if(bs(a)&&o&&bs(o))return[wn(a,t.width),wn(o,t.height)];var l=x0(i);if(an(a)&&(a.value===Hu.CONTAIN||a.value===Hu.COVER)){if(x0(i)){var c=t.width/t.height;return c<i!=(a.value===Hu.COVER)?[t.width,t.width/i]:[t.height*i,t.height]}return[t.width,t.height]}var A=x0(n),d=x0(s),h=A||d;if(bu(a)&&(!o||bu(o))){if(A&&d)return[n,s];if(!l&&!h)return[t.width,t.height];if(h&&l){var u=A?n:s*i,p=d?s:n/i;return[u,p]}var f=A?n:t.width,g=d?s:t.height;return[f,g]}if(l){var m=0,x=0;return bs(a)?m=wn(a,t.width):bs(o)&&(x=wn(o,t.height)),bu(a)?m=x*i:(!o||bu(o))&&(x=m/i),[m,x]}var S=null,B=null;if(bs(a)?S=wn(a,t.width):o&&bs(o)&&(B=wn(o,t.height)),S!==null&&(!o||bu(o))&&(B=A&&d?S/n*s:t.height),B!==null&&bu(a)&&(S=A&&d?B/s*n:t.width),S!==null&&B!==null)return[S,B];throw new Error("Unable to calculate background-size for element")},Bu=function(r,e){var t=r[e];return typeof t>"u"?r[0]:t},Mz=function(r,e,t,n,s){var i=e[0],a=e[1],o=t[0],l=t[1];switch(r){case 2:return[new gt(Math.round(n.left),Math.round(n.top+a)),new gt(Math.round(n.left+n.width),Math.round(n.top+a)),new gt(Math.round(n.left+n.width),Math.round(l+n.top+a)),new gt(Math.round(n.left),Math.round(l+n.top+a))];case 3:return[new gt(Math.round(n.left+i),Math.round(n.top)),new gt(Math.round(n.left+i+o),Math.round(n.top)),new gt(Math.round(n.left+i+o),Math.round(n.height+n.top)),new gt(Math.round(n.left+i),Math.round(n.height+n.top))];case 1:return[new gt(Math.round(n.left+i),Math.round(n.top+a)),new gt(Math.round(n.left+i+o),Math.round(n.top+a)),new gt(Math.round(n.left+i+o),Math.round(n.top+a+l)),new gt(Math.round(n.left+i),Math.round(n.top+a+l))];default:return[new gt(Math.round(s.left),Math.round(s.top)),new gt(Math.round(s.left+s.width),Math.round(s.top)),new gt(Math.round(s.left+s.width),Math.round(s.height+s.top)),new gt(Math.round(s.left),Math.round(s.height+s.top))]}},Nz="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",QC="Hidden Text",Pz=(function(){function r(e){this._data={},this._document=e}return r.prototype.parseMetrics=function(e,t){var n=this._document.createElement("div"),s=this._document.createElement("img"),i=this._document.createElement("span"),a=this._document.body;n.style.visibility="hidden",n.style.fontFamily=e,n.style.fontSize=t,n.style.margin="0",n.style.padding="0",n.style.whiteSpace="nowrap",a.appendChild(n),s.src=Nz,s.width=1,s.height=1,s.style.margin="0",s.style.padding="0",s.style.verticalAlign="baseline",i.style.fontFamily=e,i.style.fontSize=t,i.style.margin="0",i.style.padding="0",i.appendChild(this._document.createTextNode(QC)),n.appendChild(i),n.appendChild(s);var o=s.offsetTop-i.offsetTop+2;n.removeChild(i),n.appendChild(this._document.createTextNode(QC)),n.style.lineHeight="normal",s.style.verticalAlign="super";var l=s.offsetTop-n.offsetTop+2;return a.removeChild(n),{baseline:o,middle:l}},r.prototype.getMetrics=function(e,t){var n=e+" "+t;return typeof this._data[n]>"u"&&(this._data[n]=this.parseMetrics(e,t)),this._data[n]},r})(),rF=(function(){function r(e,t){this.context=e,this.options=t}return r})(),Dz=1e4,Rz=(function(r){_o(e,r);function e(t,n){var s=r.call(this,t,n)||this;return s._activeEffects=[],s.canvas=n.canvas?n.canvas:document.createElement("canvas"),s.ctx=s.canvas.getContext("2d"),n.canvas||(s.canvas.width=Math.floor(n.width*n.scale),s.canvas.height=Math.floor(n.height*n.scale),s.canvas.style.width=n.width+"px",s.canvas.style.height=n.height+"px"),s.fontMetrics=new Pz(document),s.ctx.scale(s.options.scale,s.options.scale),s.ctx.translate(-n.x,-n.y),s.ctx.textBaseline="bottom",s._activeEffects=[],s.context.logger.debug("Canvas renderer initialized ("+n.width+"x"+n.height+") with scale "+n.scale),s}return e.prototype.applyEffects=function(t){for(var n=this;this._activeEffects.length;)this.popEffect();t.forEach(function(s){return n.applyEffect(s)})},e.prototype.applyEffect=function(t){this.ctx.save(),Cz(t)&&(this.ctx.globalAlpha=t.opacity),Bz(t)&&(this.ctx.translate(t.offsetX,t.offsetY),this.ctx.transform(t.matrix[0],t.matrix[1],t.matrix[2],t.matrix[3],t.matrix[4],t.matrix[5]),this.ctx.translate(-t.offsetX,-t.offsetY)),X4(t)&&(this.path(t.path),this.ctx.clip()),this._activeEffects.push(t)},e.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},e.prototype.renderStack=function(t){return Qi(this,void 0,void 0,function(){var n;return xi(this,function(s){switch(s.label){case 0:return n=t.element.container.styles,n.isVisible()?[4,this.renderStackContent(t)]:[3,2];case 1:s.sent(),s.label=2;case 2:return[2]}})})},e.prototype.renderNode=function(t){return Qi(this,void 0,void 0,function(){return xi(this,function(n){switch(n.label){case 0:if(Us(t.container.flags,16))debugger;return t.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(t)]:[3,3];case 1:return n.sent(),[4,this.renderNodeContent(t)];case 2:n.sent(),n.label=3;case 3:return[2]}})})},e.prototype.renderTextWithLetterSpacing=function(t,n,s){var i=this;if(n===0)this.ctx.fillText(t.text,t.bounds.left,t.bounds.top+s);else{var a=Wx(t.text);a.reduce(function(o,l){return i.ctx.fillText(l,o,t.bounds.top+s),o+i.ctx.measureText(l).width},t.bounds.left)}},e.prototype.createFontStyle=function(t){var n=t.fontVariant.filter(function(a){return a==="normal"||a==="small-caps"}).join(""),s=Vz(t.fontFamily).join(", "),i=Hg(t.fontSize)?""+t.fontSize.number+t.fontSize.unit:t.fontSize.number+"px";return[[t.fontStyle,n,t.fontWeight,i,s].join(" "),s,i]},e.prototype.renderTextNode=function(t,n){return Qi(this,void 0,void 0,function(){var s,i,a,o,l,c,A,d,h=this;return xi(this,function(u){return s=this.createFontStyle(n),i=s[0],a=s[1],o=s[2],this.ctx.font=i,this.ctx.direction=n.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",l=this.fontMetrics.getMetrics(a,o),c=l.baseline,A=l.middle,d=n.paintOrder,t.textBounds.forEach(function(p){d.forEach(function(f){switch(f){case 0:h.ctx.fillStyle=Vs(n.color),h.renderTextWithLetterSpacing(p,n.letterSpacing,c);var g=n.textShadow;g.length&&p.text.trim().length&&(g.slice(0).reverse().forEach(function(m){h.ctx.shadowColor=Vs(m.color),h.ctx.shadowOffsetX=m.offsetX.number*h.options.scale,h.ctx.shadowOffsetY=m.offsetY.number*h.options.scale,h.ctx.shadowBlur=m.blur.number,h.renderTextWithLetterSpacing(p,n.letterSpacing,c)}),h.ctx.shadowColor="",h.ctx.shadowOffsetX=0,h.ctx.shadowOffsetY=0,h.ctx.shadowBlur=0),n.textDecorationLine.length&&(h.ctx.fillStyle=Vs(n.textDecorationColor||n.color),n.textDecorationLine.forEach(function(m){switch(m){case 1:h.ctx.fillRect(p.bounds.left,Math.round(p.bounds.top+c),p.bounds.width,1);break;case 2:h.ctx.fillRect(p.bounds.left,Math.round(p.bounds.top),p.bounds.width,1);break;case 3:h.ctx.fillRect(p.bounds.left,Math.ceil(p.bounds.top+A),p.bounds.width,1);break}}));break;case 1:n.webkitTextStrokeWidth&&p.text.trim().length&&(h.ctx.strokeStyle=Vs(n.webkitTextStrokeColor),h.ctx.lineWidth=n.webkitTextStrokeWidth,h.ctx.lineJoin=window.chrome?"miter":"round",h.ctx.strokeText(p.text,p.bounds.left,p.bounds.top+c)),h.ctx.strokeStyle="",h.ctx.lineWidth=0,h.ctx.lineJoin="miter";break}})}),[2]})})},e.prototype.renderReplacedElement=function(t,n,s){if(s&&t.intrinsicWidth>0&&t.intrinsicHeight>0){var i=Ym(t),a=Wm(n);this.path(a),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(s,0,0,t.intrinsicWidth,t.intrinsicHeight,i.left,i.top,i.width,i.height),this.ctx.restore()}},e.prototype.renderNodeContent=function(t){return Qi(this,void 0,void 0,function(){var n,s,i,a,o,l,x,x,c,A,d,h,B,u,p,F,f,g,m,x,S,B,F;return xi(this,function(N){switch(N.label){case 0:this.applyEffects(t.getEffects(4)),n=t.container,s=t.curves,i=n.styles,a=0,o=n.textNodes,N.label=1;case 1:return a<o.length?(l=o[a],[4,this.renderTextNode(l,i)]):[3,4];case 2:N.sent(),N.label=3;case 3:return a++,[3,1];case 4:if(!(n instanceof M4))return[3,8];N.label=5;case 5:return N.trys.push([5,7,,8]),[4,this.context.cache.match(n.src)];case 6:return x=N.sent(),this.renderReplacedElement(n,s,x),[3,8];case 7:return N.sent(),this.context.logger.error("Error loading image "+n.src),[3,8];case 8:if(n instanceof N4&&this.renderReplacedElement(n,s,n.canvas),!(n instanceof P4))return[3,12];N.label=9;case 9:return N.trys.push([9,11,,12]),[4,this.context.cache.match(n.svg)];case 10:return x=N.sent(),this.renderReplacedElement(n,s,x),[3,12];case 11:return N.sent(),this.context.logger.error("Error loading svg "+n.svg.substring(0,255)),[3,12];case 12:return n instanceof Q4&&n.tree?(c=new e(this.context,{scale:this.options.scale,backgroundColor:n.backgroundColor,x:0,y:0,width:n.width,height:n.height}),[4,c.render(n.tree)]):[3,14];case 13:A=N.sent(),n.width&&n.height&&this.ctx.drawImage(A,0,0,n.width,n.height,n.bounds.left,n.bounds.top,n.bounds.width,n.bounds.height),N.label=14;case 14:if(n instanceof Yx&&(d=Math.min(n.bounds.width,n.bounds.height),n.type===$m?n.checked&&(this.ctx.save(),this.path([new gt(n.bounds.left+d*.39363,n.bounds.top+d*.79),new gt(n.bounds.left+d*.16,n.bounds.top+d*.5549),new gt(n.bounds.left+d*.27347,n.bounds.top+d*.44071),new gt(n.bounds.left+d*.39694,n.bounds.top+d*.5649),new gt(n.bounds.left+d*.72983,n.bounds.top+d*.23),new gt(n.bounds.left+d*.84,n.bounds.top+d*.34085),new gt(n.bounds.left+d*.39363,n.bounds.top+d*.79)]),this.ctx.fillStyle=Vs(kC),this.ctx.fill(),this.ctx.restore()):n.type===Gm&&n.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(n.bounds.left+d/2,n.bounds.top+d/2,d/4,0,Math.PI*2,!0),this.ctx.fillStyle=Vs(kC),this.ctx.fill(),this.ctx.restore())),Oz(n)&&n.value.length){switch(h=this.createFontStyle(i),B=h[0],u=h[1],p=this.fontMetrics.getMetrics(B,u).baseline,this.ctx.font=B,this.ctx.fillStyle=Vs(i.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=Hz(n.styles.textAlign),F=Ym(n),f=0,n.styles.textAlign){case 1:f+=F.width/2;break;case 2:f+=F.width;break}g=F.add(f,0,0,-F.height/2+1),this.ctx.save(),this.path([new gt(F.left,F.top),new gt(F.left+F.width,F.top),new gt(F.left+F.width,F.top+F.height),new gt(F.left,F.top+F.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new qf(n.value,g),i.letterSpacing,p),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!Us(n.styles.display,2048))return[3,20];if(n.styles.listStyleImage===null)return[3,19];if(m=n.styles.listStyleImage,m.type!==0)return[3,18];x=void 0,S=m.url,N.label=15;case 15:return N.trys.push([15,17,,18]),[4,this.context.cache.match(S)];case 16:return x=N.sent(),this.ctx.drawImage(x,n.bounds.left-(x.width+10),n.bounds.top),[3,18];case 17:return N.sent(),this.context.logger.error("Error loading list-style-image "+S),[3,18];case 18:return[3,20];case 19:t.listValue&&n.styles.listStyleType!==-1&&(B=this.createFontStyle(i)[0],this.ctx.font=B,this.ctx.fillStyle=Vs(i.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",F=new ec(n.bounds.left,n.bounds.top+wn(n.styles.paddingTop,n.bounds.width),n.bounds.width,AC(i.lineHeight,i.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new qf(t.listValue,F),i.letterSpacing,AC(i.lineHeight,i.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),N.label=20;case 20:return[2]}})})},e.prototype.renderStackContent=function(t){return Qi(this,void 0,void 0,function(){var n,s,m,i,a,m,o,l,m,c,A,m,d,h,m,u,p,m,f,g,m;return xi(this,function(x){switch(x.label){case 0:if(Us(t.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(t.element)];case 1:x.sent(),n=0,s=t.negativeZIndex,x.label=2;case 2:return n<s.length?(m=s[n],[4,this.renderStack(m)]):[3,5];case 3:x.sent(),x.label=4;case 4:return n++,[3,2];case 5:return[4,this.renderNodeContent(t.element)];case 6:x.sent(),i=0,a=t.nonInlineLevel,x.label=7;case 7:return i<a.length?(m=a[i],[4,this.renderNode(m)]):[3,10];case 8:x.sent(),x.label=9;case 9:return i++,[3,7];case 10:o=0,l=t.nonPositionedFloats,x.label=11;case 11:return o<l.length?(m=l[o],[4,this.renderStack(m)]):[3,14];case 12:x.sent(),x.label=13;case 13:return o++,[3,11];case 14:c=0,A=t.nonPositionedInlineLevel,x.label=15;case 15:return c<A.length?(m=A[c],[4,this.renderStack(m)]):[3,18];case 16:x.sent(),x.label=17;case 17:return c++,[3,15];case 18:d=0,h=t.inlineLevel,x.label=19;case 19:return d<h.length?(m=h[d],[4,this.renderNode(m)]):[3,22];case 20:x.sent(),x.label=21;case 21:return d++,[3,19];case 22:u=0,p=t.zeroOrAutoZIndexOrTransformedOrOpacity,x.label=23;case 23:return u<p.length?(m=p[u],[4,this.renderStack(m)]):[3,26];case 24:x.sent(),x.label=25;case 25:return u++,[3,23];case 26:f=0,g=t.positiveZIndex,x.label=27;case 27:return f<g.length?(m=g[f],[4,this.renderStack(m)]):[3,30];case 28:x.sent(),x.label=29;case 29:return f++,[3,27];case 30:return[2]}})})},e.prototype.mask=function(t){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(t.slice(0).reverse()),this.ctx.closePath()},e.prototype.path=function(t){this.ctx.beginPath(),this.formatPath(t),this.ctx.closePath()},e.prototype.formatPath=function(t){var n=this;t.forEach(function(s,i){var a=qa(s)?s.start:s;i===0?n.ctx.moveTo(a.x,a.y):n.ctx.lineTo(a.x,a.y),qa(s)&&n.ctx.bezierCurveTo(s.startControl.x,s.startControl.y,s.endControl.x,s.endControl.y,s.end.x,s.end.y)})},e.prototype.renderRepeat=function(t,n,s,i){this.path(t),this.ctx.fillStyle=n,this.ctx.translate(s,i),this.ctx.fill(),this.ctx.translate(-s,-i)},e.prototype.resizeImage=function(t,n,s){var i;if(t.width===n&&t.height===s)return t;var a=(i=this.canvas.ownerDocument)!==null&&i!==void 0?i:document,o=a.createElement("canvas");o.width=Math.max(1,n),o.height=Math.max(1,s);var l=o.getContext("2d");return l.drawImage(t,0,0,t.width,t.height,0,0,n,s),o},e.prototype.renderBackgroundImage=function(t){return Qi(this,void 0,void 0,function(){var n,s,i,a,o,l;return xi(this,function(c){switch(c.label){case 0:n=t.styles.backgroundImage.length-1,s=function(A){var d,h,u,I,se,X,T,L,w,p,I,se,X,T,L,f,g,m,x,S,B,F,N,E,w,v,I,k,_,T,L,K,se,X,$,V,he,z,M,O,H,J;return xi(this,function(de){switch(de.label){case 0:if(A.type!==0)return[3,5];d=void 0,h=A.url,de.label=1;case 1:return de.trys.push([1,3,,4]),[4,i.context.cache.match(h)];case 2:return d=de.sent(),[3,4];case 3:return de.sent(),i.context.logger.error("Error loading background-image "+h),[3,4];case 4:return d&&(u=Sw(t,n,[d.width,d.height,d.width/d.height]),I=u[0],se=u[1],X=u[2],T=u[3],L=u[4],w=i.ctx.createPattern(i.resizeImage(d,T,L),"repeat"),i.renderRepeat(I,w,se,X)),[3,6];case 5:BV(A)?(p=Sw(t,n,[null,null,null]),I=p[0],se=p[1],X=p[2],T=p[3],L=p[4],f=yV(A.angle,T,L),g=f[0],m=f[1],x=f[2],S=f[3],B=f[4],F=document.createElement("canvas"),F.width=T,F.height=L,N=F.getContext("2d"),E=N.createLinearGradient(m,S,x,B),lC(A.stops,g).forEach(function(ie){return E.addColorStop(ie.stop,Vs(ie.color))}),N.fillStyle=E,N.fillRect(0,0,T,L),T>0&&L>0&&(w=i.ctx.createPattern(F,"repeat"),i.renderRepeat(I,w,se,X))):CV(A)&&(v=Sw(t,n,[null,null,null]),I=v[0],k=v[1],_=v[2],T=v[3],L=v[4],K=A.position.length===0?[zx]:A.position,se=wn(K[0],T),X=wn(K[K.length-1],L),$=wV(A,se,X,T,L),V=$[0],he=$[1],V>0&&he>0&&(z=i.ctx.createRadialGradient(k+se,_+X,0,k+se,_+X,V),lC(A.stops,V*2).forEach(function(ie){return z.addColorStop(ie.stop,Vs(ie.color))}),i.path(I),i.ctx.fillStyle=z,V!==he?(M=t.bounds.left+.5*t.bounds.width,O=t.bounds.top+.5*t.bounds.height,H=he/V,J=1/H,i.ctx.save(),i.ctx.translate(M,O),i.ctx.transform(1,0,0,H,0,0),i.ctx.translate(-M,-O),i.ctx.fillRect(k,J*(_-O)+O,T,L*J),i.ctx.restore()):i.ctx.fill())),de.label=6;case 6:return n--,[2]}})},i=this,a=0,o=t.styles.backgroundImage.slice(0).reverse(),c.label=1;case 1:return a<o.length?(l=o[a],[5,s(l)]):[3,4];case 2:c.sent(),c.label=3;case 3:return a++,[3,1];case 4:return[2]}})})},e.prototype.renderSolidBorder=function(t,n,s){return Qi(this,void 0,void 0,function(){return xi(this,function(i){return this.path(OC(s,n)),this.ctx.fillStyle=Vs(t),this.ctx.fill(),[2]})})},e.prototype.renderDoubleBorder=function(t,n,s,i){return Qi(this,void 0,void 0,function(){var a,o;return xi(this,function(l){switch(l.label){case 0:return n<3?[4,this.renderSolidBorder(t,s,i)]:[3,2];case 1:return l.sent(),[2];case 2:return a=Ez(i,s),this.path(a),this.ctx.fillStyle=Vs(t),this.ctx.fill(),o=Iz(i,s),this.path(o),this.ctx.fill(),[2]}})})},e.prototype.renderNodeBackgroundAndBorders=function(t){return Qi(this,void 0,void 0,function(){var n,s,i,a,o,l,c,A,d=this;return xi(this,function(h){switch(h.label){case 0:return this.applyEffects(t.getEffects(2)),n=t.container.styles,s=!aA(n.backgroundColor)||n.backgroundImage.length,i=[{style:n.borderTopStyle,color:n.borderTopColor,width:n.borderTopWidth},{style:n.borderRightStyle,color:n.borderRightColor,width:n.borderRightWidth},{style:n.borderBottomStyle,color:n.borderBottomColor,width:n.borderBottomWidth},{style:n.borderLeftStyle,color:n.borderLeftColor,width:n.borderLeftWidth}],a=Qz(Bu(n.backgroundClip,0),t.curves),s||n.boxShadow.length?(this.ctx.save(),this.path(a),this.ctx.clip(),aA(n.backgroundColor)||(this.ctx.fillStyle=Vs(n.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(t.container)]):[3,2];case 1:h.sent(),this.ctx.restore(),n.boxShadow.slice(0).reverse().forEach(function(u){d.ctx.save();var p=qm(t.curves),f=u.inset?0:Dz,g=Sz(p,-f+(u.inset?1:-1)*u.spread.number,(u.inset?1:-1)*u.spread.number,u.spread.number*(u.inset?-2:2),u.spread.number*(u.inset?-2:2));u.inset?(d.path(p),d.ctx.clip(),d.mask(g)):(d.mask(p),d.ctx.clip(),d.path(g)),d.ctx.shadowOffsetX=u.offsetX.number+f,d.ctx.shadowOffsetY=u.offsetY.number,d.ctx.shadowColor=Vs(u.color),d.ctx.shadowBlur=u.blur.number,d.ctx.fillStyle=u.inset?Vs(u.color):"rgba(0,0,0,1)",d.ctx.fill(),d.ctx.restore()}),h.label=2;case 2:o=0,l=0,c=i,h.label=3;case 3:return l<c.length?(A=c[l],A.style!==0&&!aA(A.color)&&A.width>0?A.style!==2?[3,5]:[4,this.renderDashedDottedBorder(A.color,A.width,o,t.curves,2)]:[3,11]):[3,13];case 4:return h.sent(),[3,11];case 5:return A.style!==3?[3,7]:[4,this.renderDashedDottedBorder(A.color,A.width,o,t.curves,3)];case 6:return h.sent(),[3,11];case 7:return A.style!==4?[3,9]:[4,this.renderDoubleBorder(A.color,A.width,o,t.curves)];case 8:return h.sent(),[3,11];case 9:return[4,this.renderSolidBorder(A.color,o,t.curves)];case 10:h.sent(),h.label=11;case 11:o++,h.label=12;case 12:return l++,[3,3];case 13:return[2]}})})},e.prototype.renderDashedDottedBorder=function(t,n,s,i,a){return Qi(this,void 0,void 0,function(){var o,l,c,A,d,h,u,p,f,g,m,x,S,B,F,N,F,N;return xi(this,function(E){return this.ctx.save(),o=Tz(i,s),l=OC(i,s),a===2&&(this.path(l),this.ctx.clip()),qa(l[0])?(c=l[0].start.x,A=l[0].start.y):(c=l[0].x,A=l[0].y),qa(l[1])?(d=l[1].end.x,h=l[1].end.y):(d=l[1].x,h=l[1].y),s===0||s===2?u=Math.abs(c-d):u=Math.abs(A-h),this.ctx.beginPath(),a===3?this.formatPath(o):this.formatPath(l.slice(0,2)),p=n<3?n*3:n*2,f=n<3?n*2:n,a===3&&(p=n,f=n),g=!0,u<=p*2?g=!1:u<=p*2+f?(m=u/(2*p+f),p*=m,f*=m):(x=Math.floor((u+f)/(p+f)),S=(u-x*p)/(x-1),B=(u-(x+1)*p)/x,f=B<=0||Math.abs(f-S)<Math.abs(f-B)?S:B),g&&(a===3?this.ctx.setLineDash([0,p+f]):this.ctx.setLineDash([p,f])),a===3?(this.ctx.lineCap="round",this.ctx.lineWidth=n):this.ctx.lineWidth=n*2+1.1,this.ctx.strokeStyle=Vs(t),this.ctx.stroke(),this.ctx.setLineDash([]),a===2&&(qa(l[0])&&(F=l[3],N=l[0],this.ctx.beginPath(),this.formatPath([new gt(F.end.x,F.end.y),new gt(N.start.x,N.start.y)]),this.ctx.stroke()),qa(l[1])&&(F=l[1],N=l[2],this.ctx.beginPath(),this.formatPath([new gt(F.end.x,F.end.y),new gt(N.start.x,N.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},e.prototype.render=function(t){return Qi(this,void 0,void 0,function(){var n;return xi(this,function(s){switch(s.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=Vs(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),n=kz(t),[4,this.renderStack(n)];case 1:return s.sent(),this.applyEffects([]),[2,this.canvas]}})})},e})(rF),Oz=function(r){return r instanceof O4||r instanceof R4?!0:r instanceof Yx&&r.type!==Gm&&r.type!==$m},Qz=function(r,e){switch(r){case 0:return qm(e);case 2:return vz(e);case 1:default:return Wm(e)}},Hz=function(r){switch(r){case 1:return"center";case 2:return"right";case 0:default:return"left"}},jz=["-apple-system","system-ui"],Vz=function(r){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?r.filter(function(e){return jz.indexOf(e)===-1}):r},$z=(function(r){_o(e,r);function e(t,n){var s=r.call(this,t,n)||this;return s.canvas=n.canvas?n.canvas:document.createElement("canvas"),s.ctx=s.canvas.getContext("2d"),s.options=n,s.canvas.width=Math.floor(n.width*n.scale),s.canvas.height=Math.floor(n.height*n.scale),s.canvas.style.width=n.width+"px",s.canvas.style.height=n.height+"px",s.ctx.scale(s.options.scale,s.options.scale),s.ctx.translate(-n.x,-n.y),s.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+n.width+"x"+n.height+" at "+n.x+","+n.y+") with scale "+n.scale),s}return e.prototype.render=function(t){return Qi(this,void 0,void 0,function(){var n,s;return xi(this,function(i){switch(i.label){case 0:return n=A1(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,t),[4,Gz(n)];case 1:return s=i.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=Vs(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(s,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},e})(rF),Gz=function(r){return new Promise(function(e,t){var n=new Image;n.onload=function(){e(n)},n.onerror=t,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(r))})},zz=(function(){function r(e){var t=e.id,n=e.enabled;this.id=t,this.enabled=n,this.start=Date.now()}return r.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,e0([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},r.prototype.getTime=function(){return Date.now()-this.start},r.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info.apply(console,e0([this.id,this.getTime()+"ms"],e))},r.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,e0([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},r.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error.apply(console,e0([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},r.instances={},r})(),Kz=(function(){function r(e,t){var n;this.windowBounds=t,this.instanceName="#"+r.instanceCount++,this.logger=new zz({id:this.instanceName,enabled:e.logging}),this.cache=(n=e.cache)!==null&&n!==void 0?n:new hz(this,e)}return r.instanceCount=1,r})(),nF=function(r,e){return e===void 0&&(e={}),qz(r,e)};typeof window<"u"&&Y4.setContext(window);var qz=function(r,e){return Qi(void 0,void 0,void 0,function(){var t,n,s,i,a,o,l,c,A,d,h,u,p,f,g,m,x,S,B,F,E,N,E,w,v,I,k,_,T,L,K,se,X,$,V,he,z,M,O,H;return xi(this,function(J){switch(J.label){case 0:if(!r||typeof r!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(t=r.ownerDocument,!t)throw new Error("Element is not attached to a Document");if(n=t.defaultView,!n)throw new Error("Document is not attached to a Window");return s={allowTaint:(w=e.allowTaint)!==null&&w!==void 0?w:!1,imageTimeout:(v=e.imageTimeout)!==null&&v!==void 0?v:15e3,proxy:e.proxy,useCORS:(I=e.useCORS)!==null&&I!==void 0?I:!1},i=Wv({logging:(k=e.logging)!==null&&k!==void 0?k:!0,cache:e.cache},s),a={windowWidth:(_=e.windowWidth)!==null&&_!==void 0?_:n.innerWidth,windowHeight:(T=e.windowHeight)!==null&&T!==void 0?T:n.innerHeight,scrollX:(L=e.scrollX)!==null&&L!==void 0?L:n.pageXOffset,scrollY:(K=e.scrollY)!==null&&K!==void 0?K:n.pageYOffset},o=new ec(a.scrollX,a.scrollY,a.windowWidth,a.windowHeight),l=new Kz(i,o),c=(se=e.foreignObjectRendering)!==null&&se!==void 0?se:!1,A={allowTaint:(X=e.allowTaint)!==null&&X!==void 0?X:!1,onclone:e.onclone,ignoreElements:e.ignoreElements,inlineImages:c,copyStyles:c},l.logger.debug("Starting document clone with size "+o.width+"x"+o.height+" scrolled to "+-o.left+","+-o.top),d=new PC(l,r,A),h=d.clonedReferenceElement,h?[4,d.toIFrame(t,o)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return u=J.sent(),p=Xx(h)||YG(h)?S9(h.ownerDocument):Pb(l,h),f=p.width,g=p.height,m=p.left,x=p.top,S=Wz(l,h,e.backgroundColor),B={canvas:e.canvas,backgroundColor:S,scale:(V=($=e.scale)!==null&&$!==void 0?$:n.devicePixelRatio)!==null&&V!==void 0?V:1,x:((he=e.x)!==null&&he!==void 0?he:0)+m,y:((z=e.y)!==null&&z!==void 0?z:0)+x,width:(M=e.width)!==null&&M!==void 0?M:Math.ceil(f),height:(O=e.height)!==null&&O!==void 0?O:Math.ceil(g)},c?(l.logger.debug("Document cloned, using foreign object rendering"),E=new $z(l,B),[4,E.render(h)]):[3,3];case 2:return F=J.sent(),[3,5];case 3:return l.logger.debug("Document cloned, element located at "+m+","+x+" with size "+f+"x"+g+" using computed rendering"),l.logger.debug("Starting DOM parsing"),N=j4(l,h),S===N.styles.backgroundColor&&(N.styles.backgroundColor=Wl.TRANSPARENT),l.logger.debug("Starting renderer for element at "+B.x+","+B.y+" with size "+B.width+"x"+B.height),E=new Rz(l,B),[4,E.render(N)];case 4:F=J.sent(),J.label=5;case 5:return(!((H=e.removeContainer)!==null&&H!==void 0)||H)&&(PC.destroy(u)||l.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),l.logger.debug("Finished rendering"),[2,F]}})})},Wz=function(r,e,t){var n=e.ownerDocument,s=n.documentElement?zf(r,getComputedStyle(n.documentElement).backgroundColor):Wl.TRANSPARENT,i=n.body?zf(r,getComputedStyle(n.body).backgroundColor):Wl.TRANSPARENT,a=typeof t=="string"?zf(r,t):t===null?Wl.TRANSPARENT:4294967295;return e===n.documentElement?aA(s)?aA(i)?a:i:s:a};const Yz=Object.freeze(Object.defineProperty({__proto__:null,default:nF},Symbol.toStringTag,{value:"Module"})),Xz="modulepreload",Jz=function(r){return"/"+r},HC={},Yf=function(e,t,n){let s=Promise.resolve();if(t&&t.length>0){let a=function(c){return Promise.all(c.map(A=>Promise.resolve(A).then(d=>({status:"fulfilled",value:d}),d=>({status:"rejected",reason:d}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=a(t.map(c=>{if(c=Jz(c),c in HC)return;HC[c]=!0;const A=c.endsWith(".css"),d=A?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const h=document.createElement("link");if(h.rel=A?"stylesheet":Xz,A||(h.as="script"),h.crossOrigin="",h.href=c,l&&h.setAttribute("nonce",l),document.head.appendChild(h),A)return new Promise((u,p)=>{h.addEventListener("load",u),h.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return s.then(a=>{for(const o of a||[])o.status==="rejected"&&i(o.reason);return e().catch(i)})};function nn(r){"@babel/helpers - typeof";return nn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nn(r)}var wo=Uint8Array,Ta=Uint16Array,Jx=Int32Array,Zx=new wo([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),e2=new wo([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),jC=new wo([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),sF=function(r,e){for(var t=new Ta(31),n=0;n<31;++n)t[n]=e+=1<<r[n-1];for(var s=new Jx(t[30]),n=1;n<30;++n)for(var i=t[n];i<t[n+1];++i)s[i]=i-t[n]<<5|n;return{b:t,r:s}},iF=sF(Zx,2),Zz=iF.b,m1=iF.r;Zz[28]=258,m1[258]=28;var eK=sF(e2,0),VC=eK.r,b1=new Ta(32768);for(var kn=0;kn<32768;++kn){var Mc=(kn&43690)>>1|(kn&21845)<<1;Mc=(Mc&52428)>>2|(Mc&13107)<<2,Mc=(Mc&61680)>>4|(Mc&3855)<<4,b1[kn]=((Mc&65280)>>8|(Mc&255)<<8)>>1}var Xf=(function(r,e,t){for(var n=r.length,s=0,i=new Ta(e);s<n;++s)r[s]&&++i[r[s]-1];var a=new Ta(e);for(s=1;s<e;++s)a[s]=a[s-1]+i[s-1]<<1;var o;if(t){o=new Ta(1<<e);var l=15-e;for(s=0;s<n;++s)if(r[s])for(var c=s<<4|r[s],A=e-r[s],d=a[r[s]-1]++<<A,h=d|(1<<A)-1;d<=h;++d)o[b1[d]>>l]=c}else for(o=new Ta(n),s=0;s<n;++s)r[s]&&(o[s]=b1[a[r[s]-1]++]>>15-r[s]);return o}),Ud=new wo(288);for(var kn=0;kn<144;++kn)Ud[kn]=8;for(var kn=144;kn<256;++kn)Ud[kn]=9;for(var kn=256;kn<280;++kn)Ud[kn]=7;for(var kn=280;kn<288;++kn)Ud[kn]=8;var Xm=new wo(32);for(var kn=0;kn<32;++kn)Xm[kn]=5;var tK=Xf(Ud,9,0),rK=Xf(Xm,5,0),aF=function(r){return(r+7)/8|0},nK=function(r,e,t){return(t==null||t>r.length)&&(t=r.length),new wo(r.subarray(e,t))},Ll=function(r,e,t){t<<=e&7;var n=e/8|0;r[n]|=t,r[n+1]|=t>>8},lf=function(r,e,t){t<<=e&7;var n=e/8|0;r[n]|=t,r[n+1]|=t>>8,r[n+2]|=t>>16},kw=function(r,e){for(var t=[],n=0;n<r.length;++n)r[n]&&t.push({s:n,f:r[n]});var s=t.length,i=t.slice();if(!s)return{t:lF,l:0};if(s==1){var a=new wo(t[0].s+1);return a[t[0].s]=1,{t:a,l:1}}t.sort(function(F,N){return F.f-N.f}),t.push({s:-1,f:25001});var o=t[0],l=t[1],c=0,A=1,d=2;for(t[0]={s:-1,f:o.f+l.f,l:o,r:l};A!=s-1;)o=t[t[c].f<t[d].f?c++:d++],l=t[c!=A&&t[c].f<t[d].f?c++:d++],t[A++]={s:-1,f:o.f+l.f,l:o,r:l};for(var h=i[0].s,n=1;n<s;++n)i[n].s>h&&(h=i[n].s);var u=new Ta(h+1),p=y1(t[A-1],u,0);if(p>e){var n=0,f=0,g=p-e,m=1<<g;for(i.sort(function(N,E){return u[E.s]-u[N.s]||N.f-E.f});n<s;++n){var x=i[n].s;if(u[x]>e)f+=m-(1<<p-u[x]),u[x]=e;else break}for(f>>=g;f>0;){var S=i[n].s;u[S]<e?f-=1<<e-u[S]++-1:++n}for(;n>=0&&f;--n){var B=i[n].s;u[B]==e&&(--u[B],++f)}p=e}return{t:new wo(u),l:p}},y1=function(r,e,t){return r.s==-1?Math.max(y1(r.l,e,t+1),y1(r.r,e,t+1)):e[r.s]=t},$C=function(r){for(var e=r.length;e&&!r[--e];);for(var t=new Ta(++e),n=0,s=r[0],i=1,a=function(l){t[n++]=l},o=1;o<=e;++o)if(r[o]==s&&o!=e)++i;else{if(!s&&i>2){for(;i>138;i-=138)a(32754);i>2&&(a(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(a(s),--i;i>6;i-=6)a(8304);i>2&&(a(i-3<<5|8208),i=0)}for(;i--;)a(s);i=1,s=r[o]}return{c:t.subarray(0,n),n:e}},cf=function(r,e){for(var t=0,n=0;n<e.length;++n)t+=r[n]*e[n];return t},oF=function(r,e,t){var n=t.length,s=aF(e+2);r[s]=n&255,r[s+1]=n>>8,r[s+2]=r[s]^255,r[s+3]=r[s+1]^255;for(var i=0;i<n;++i)r[s+i+4]=t[i];return(s+4+n)*8},GC=function(r,e,t,n,s,i,a,o,l,c,A){Ll(e,A++,t),++s[256];for(var d=kw(s,15),h=d.t,u=d.l,p=kw(i,15),f=p.t,g=p.l,m=$C(h),x=m.c,S=m.n,B=$C(f),F=B.c,N=B.n,E=new Ta(19),w=0;w<x.length;++w)++E[x[w]&31];for(var w=0;w<F.length;++w)++E[F[w]&31];for(var v=kw(E,7),I=v.t,k=v.l,_=19;_>4&&!I[jC[_-1]];--_);var T=c+5<<3,L=cf(s,Ud)+cf(i,Xm)+a,K=cf(s,h)+cf(i,f)+a+14+3*_+cf(E,I)+2*E[16]+3*E[17]+7*E[18];if(l>=0&&T<=L&&T<=K)return oF(e,A,r.subarray(l,l+c));var se,X,$,V;if(Ll(e,A,1+(K<L)),A+=2,K<L){se=Xf(h,u,0),X=h,$=Xf(f,g,0),V=f;var he=Xf(I,k,0);Ll(e,A,S-257),Ll(e,A+5,N-1),Ll(e,A+10,_-4),A+=14;for(var w=0;w<_;++w)Ll(e,A+3*w,I[jC[w]]);A+=3*_;for(var z=[x,F],M=0;M<2;++M)for(var O=z[M],w=0;w<O.length;++w){var H=O[w]&31;Ll(e,A,he[H]),A+=I[H],H>15&&(Ll(e,A,O[w]>>5&127),A+=O[w]>>12)}}else se=tK,X=Ud,$=rK,V=Xm;for(var w=0;w<o;++w){var J=n[w];if(J>255){var H=J>>18&31;lf(e,A,se[H+257]),A+=X[H+257],H>7&&(Ll(e,A,J>>23&31),A+=Zx[H]);var de=J&31;lf(e,A,$[de]),A+=V[de],de>3&&(lf(e,A,J>>5&8191),A+=e2[de])}else lf(e,A,se[J]),A+=X[J]}return lf(e,A,se[256]),A+X[256]},sK=new Jx([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),lF=new wo(0),iK=function(r,e,t,n,s,i){var a=i.z||r.length,o=new wo(n+a+5*(1+Math.ceil(a/7e3))+s),l=o.subarray(n,o.length-s),c=i.l,A=(i.r||0)&7;if(e){A&&(l[0]=i.r>>3);for(var d=sK[e-1],h=d>>13,u=d&8191,p=(1<<t)-1,f=i.p||new Ta(32768),g=i.h||new Ta(p+1),m=Math.ceil(t/3),x=2*m,S=function(D){return(r[D]^r[D+1]<<m^r[D+2]<<x)&p},B=new Jx(25e3),F=new Ta(288),N=new Ta(32),E=0,w=0,v=i.i||0,I=0,k=i.w||0,_=0;v+2<a;++v){var T=S(v),L=v&32767,K=g[T];if(f[L]=K,g[T]=L,k<=v){var se=a-v;if((E>7e3||I>24576)&&(se>423||!c)){A=GC(r,l,0,B,F,N,w,I,_,v-_,A),I=E=w=0,_=v;for(var X=0;X<286;++X)F[X]=0;for(var X=0;X<30;++X)N[X]=0}var $=2,V=0,he=u,z=L-K&32767;if(se>2&&T==S(v-z))for(var M=Math.min(h,se)-1,O=Math.min(32767,v),H=Math.min(258,se);z<=O&&--he&&L!=K;){if(r[v+$]==r[v+$-z]){for(var J=0;J<H&&r[v+J]==r[v+J-z];++J);if(J>$){if($=J,V=z,J>M)break;for(var de=Math.min(z,J-2),ie=0,X=0;X<de;++X){var le=v-z+X&32767,fe=f[le],ve=le-fe&32767;ve>ie&&(ie=ve,K=le)}}}L=K,K=f[L],z+=L-K&32767}if(V){B[I++]=268435456|m1[$]<<18|VC[V];var Ce=m1[$]&31,Be=VC[V]&31;w+=Zx[Ce]+e2[Be],++F[257+Ce],++N[Be],k=v+$,++E}else B[I++]=r[v],++F[r[v]]}}for(v=Math.max(v,k);v<a;++v)B[I++]=r[v],++F[r[v]];A=GC(r,l,c,B,F,N,w,I,_,v-_,A),c||(i.r=A&7|l[A/8|0]<<3,A-=7,i.h=g,i.p=f,i.i=v,i.w=k)}else{for(var v=i.w||0;v<a+c;v+=65535){var Qe=v+65535;Qe>=a&&(l[A/8|0]=c,Qe=a),A=oF(l,A+1,r.subarray(v,Qe))}i.i=a}return nK(o,0,n+aF(A)+s)},cF=function(){var r=1,e=0;return{p:function(t){for(var n=r,s=e,i=t.length|0,a=0;a!=i;){for(var o=Math.min(a+2655,i);a<o;++a)s+=n+=t[a];n=(n&65535)+15*(n>>16),s=(s&65535)+15*(s>>16)}r=n,e=s},d:function(){return r%=65521,e%=65521,(r&255)<<24|(r&65280)<<8|(e&255)<<8|e>>8}}},aK=function(r,e,t,n,s){if(!s&&(s={l:1},e.dictionary)){var i=e.dictionary.subarray(-32768),a=new wo(i.length+r.length);a.set(i),a.set(r,i.length),r=a,s.w=i.length}return iK(r,e.level==null?6:e.level,e.mem==null?s.l?Math.ceil(Math.max(8,Math.min(13,Math.log(r.length)))*1.5):20:12+e.mem,t,n,s)},AF=function(r,e,t){for(;t;++e)r[e]=t,t>>>=8},oK=function(r,e){var t=e.level,n=t==0?0:t<6?1:t==9?3:2;if(r[0]=120,r[1]=n<<6|(e.dictionary&&32),r[1]|=31-(r[0]<<8|r[1])%31,e.dictionary){var s=cF();s.p(e.dictionary),AF(r,2,s.d())}};function w1(r,e){e||(e={});var t=cF();t.p(r);var n=aK(r,e,e.dictionary?6:2,4);return oK(n,e),AF(n,n.length-4,t.d()),n}var lK=typeof TextDecoder<"u"&&new TextDecoder,cK=0;try{lK.decode(lF,{stream:!0}),cK=1}catch{}function AK(r){if(Array.isArray(r))return r}function dK(r,e){var t=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(t!=null){var n,s,i,a,o=[],l=!0,c=!1;try{if(i=(t=t.call(r)).next,e!==0)for(;!(l=(n=i.call(t)).done)&&(o.push(n.value),o.length!==e);l=!0);}catch(A){c=!0,s=A}finally{try{if(!l&&t.return!=null&&(a=t.return(),Object(a)!==a))return}finally{if(c)throw s}}return o}}function zC(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}function uK(r,e){if(r){if(typeof r=="string")return zC(r,e);var t={}.toString.call(r).slice(8,-1);return t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set"?Array.from(r):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?zC(r,e):void 0}}function hK(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function KC(r,e){return AK(r)||dK(r,e)||uK(r,e)||hK()}function qC(r,e="utf8"){return new TextDecoder(e).decode(r)}const fK=new TextEncoder;function gK(r){return fK.encode(r)}const pK=1024*8,mK=(()=>{const r=new Uint8Array(4),e=new Uint32Array(r.buffer);return!((e[0]=1)&r[0])})(),Ew={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class t2{constructor(e=pK,t={}){Fe(this,"buffer");Fe(this,"byteLength");Fe(this,"byteOffset");Fe(this,"length");Fe(this,"offset");Fe(this,"lastWrittenByte");Fe(this,"littleEndian");Fe(this,"_data");Fe(this,"_mark");Fe(this,"_marks");let n=!1;typeof e=="number"?e=new ArrayBuffer(e):(n=!0,this.lastWrittenByte=e.byteLength);const s=t.offset?t.offset>>>0:0,i=e.byteLength-s;let a=s;(ArrayBuffer.isView(e)||e instanceof t2)&&(e.byteLength!==e.buffer.byteLength&&(a=e.byteOffset+s),e=e.buffer),n?this.lastWrittenByte=i:this.lastWrittenByte=0,this.buffer=e,this.length=i,this.byteLength=i,this.byteOffset=a,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,a,i),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(e===void 0)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const n=(this.offset+e)*2,s=new Uint8Array(n);s.set(new Uint8Array(this.buffer)),this.buffer=s.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,t){const n=Ew[t].BYTES_PER_ELEMENT*e,s=this.byteOffset+this.offset,i=this.buffer.slice(s,s+n);if(this.littleEndian===mK&&t!=="uint8"&&t!=="int8"){const o=new Uint8Array(this.buffer.slice(s,s+n));o.reverse();const l=new Ew[t](o.buffer);return this.offset+=n,l.reverse(),l}const a=new Ew[t](i);return this.offset+=n,a}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let t="";for(let n=0;n<e;n++)t+=this.readChar();return t}readUtf8(e=1){return qC(this.readBytes(e))}decodeText(e=1,t="utf8"){return qC(this.readBytes(e),t)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let t=0;t<e.length;t++)this._data.setUint8(this.offset++,e[t]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let t=0;t<e.length;t++)this.writeUint8(e.charCodeAt(t));return this}writeUtf8(e){return this.writeBytes(gK(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function vh(r){let e=r.length;for(;--e>=0;)r[e]=0}const bK=3,yK=258,dF=29,wK=256,vK=wK+1+dF,uF=30,xK=512,_K=new Array((vK+2)*2);vh(_K);const BK=new Array(uF*2);vh(BK);const CK=new Array(xK);vh(CK);const SK=new Array(yK-bK+1);vh(SK);const kK=new Array(dF);vh(kK);const EK=new Array(uF);vh(EK);const IK=(r,e,t,n)=>{let s=r&65535|0,i=r>>>16&65535|0,a=0;for(;t!==0;){a=t>2e3?2e3:t,t-=a;do s=s+e[n++]|0,i=i+s|0;while(--a);s%=65521,i%=65521}return s|i<<16|0};var v1=IK;const TK=()=>{let r,e=[];for(var t=0;t<256;t++){r=t;for(var n=0;n<8;n++)r=r&1?3988292384^r>>>1:r>>>1;e[t]=r}return e},FK=new Uint32Array(TK()),LK=(r,e,t,n)=>{const s=FK,i=n+t;r^=-1;for(let a=n;a<i;a++)r=r>>>8^s[(r^e[a])&255];return r^-1};var Oo=LK,x1={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},hF={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const UK=(r,e)=>Object.prototype.hasOwnProperty.call(r,e);var MK=function(r){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const t=e.shift();if(t){if(typeof t!="object")throw new TypeError(t+"must be non-object");for(const n in t)UK(t,n)&&(r[n]=t[n])}}return r},NK=r=>{let e=0;for(let n=0,s=r.length;n<s;n++)e+=r[n].length;const t=new Uint8Array(e);for(let n=0,s=0,i=r.length;n<i;n++){let a=r[n];t.set(a,s),s+=a.length}return t},fF={assign:MK,flattenChunks:NK};let gF=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{gF=!1}const wg=new Uint8Array(256);for(let r=0;r<256;r++)wg[r]=r>=252?6:r>=248?5:r>=240?4:r>=224?3:r>=192?2:1;wg[254]=wg[254]=1;var PK=r=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(r);let e,t,n,s,i,a=r.length,o=0;for(s=0;s<a;s++)t=r.charCodeAt(s),(t&64512)===55296&&s+1<a&&(n=r.charCodeAt(s+1),(n&64512)===56320&&(t=65536+(t-55296<<10)+(n-56320),s++)),o+=t<128?1:t<2048?2:t<65536?3:4;for(e=new Uint8Array(o),i=0,s=0;i<o;s++)t=r.charCodeAt(s),(t&64512)===55296&&s+1<a&&(n=r.charCodeAt(s+1),(n&64512)===56320&&(t=65536+(t-55296<<10)+(n-56320),s++)),t<128?e[i++]=t:t<2048?(e[i++]=192|t>>>6,e[i++]=128|t&63):t<65536?(e[i++]=224|t>>>12,e[i++]=128|t>>>6&63,e[i++]=128|t&63):(e[i++]=240|t>>>18,e[i++]=128|t>>>12&63,e[i++]=128|t>>>6&63,e[i++]=128|t&63);return e};const DK=(r,e)=>{if(e<65534&&r.subarray&&gF)return String.fromCharCode.apply(null,r.length===e?r:r.subarray(0,e));let t="";for(let n=0;n<e;n++)t+=String.fromCharCode(r[n]);return t};var RK=(r,e)=>{const t=e||r.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(r.subarray(0,e));let n,s;const i=new Array(t*2);for(s=0,n=0;n<t;){let a=r[n++];if(a<128){i[s++]=a;continue}let o=wg[a];if(o>4){i[s++]=65533,n+=o-1;continue}for(a&=o===2?31:o===3?15:7;o>1&&n<t;)a=a<<6|r[n++]&63,o--;if(o>1){i[s++]=65533;continue}a<65536?i[s++]=a:(a-=65536,i[s++]=55296|a>>10&1023,i[s++]=56320|a&1023)}return DK(i,s)},OK=(r,e)=>{e=e||r.length,e>r.length&&(e=r.length);let t=e-1;for(;t>=0&&(r[t]&192)===128;)t--;return t<0||t===0?e:t+wg[r[t]]>e?t:e},_1={string2buf:PK,buf2string:RK,utf8border:OK};function QK(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var HK=QK;const _0=16209,jK=16191;var VK=function(e,t){let n,s,i,a,o,l,c,A,d,h,u,p,f,g,m,x,S,B,F,N,E,w,v,I;const k=e.state;n=e.next_in,v=e.input,s=n+(e.avail_in-5),i=e.next_out,I=e.output,a=i-(t-e.avail_out),o=i+(e.avail_out-257),l=k.dmax,c=k.wsize,A=k.whave,d=k.wnext,h=k.window,u=k.hold,p=k.bits,f=k.lencode,g=k.distcode,m=(1<<k.lenbits)-1,x=(1<<k.distbits)-1;e:do{p<15&&(u+=v[n++]<<p,p+=8,u+=v[n++]<<p,p+=8),S=f[u&m];t:for(;;){if(B=S>>>24,u>>>=B,p-=B,B=S>>>16&255,B===0)I[i++]=S&65535;else if(B&16){F=S&65535,B&=15,B&&(p<B&&(u+=v[n++]<<p,p+=8),F+=u&(1<<B)-1,u>>>=B,p-=B),p<15&&(u+=v[n++]<<p,p+=8,u+=v[n++]<<p,p+=8),S=g[u&x];r:for(;;){if(B=S>>>24,u>>>=B,p-=B,B=S>>>16&255,B&16){if(N=S&65535,B&=15,p<B&&(u+=v[n++]<<p,p+=8,p<B&&(u+=v[n++]<<p,p+=8)),N+=u&(1<<B)-1,N>l){e.msg="invalid distance too far back",k.mode=_0;break e}if(u>>>=B,p-=B,B=i-a,N>B){if(B=N-B,B>A&&k.sane){e.msg="invalid distance too far back",k.mode=_0;break e}if(E=0,w=h,d===0){if(E+=c-B,B<F){F-=B;do I[i++]=h[E++];while(--B);E=i-N,w=I}}else if(d<B){if(E+=c+d-B,B-=d,B<F){F-=B;do I[i++]=h[E++];while(--B);if(E=0,d<F){B=d,F-=B;do I[i++]=h[E++];while(--B);E=i-N,w=I}}}else if(E+=d-B,B<F){F-=B;do I[i++]=h[E++];while(--B);E=i-N,w=I}for(;F>2;)I[i++]=w[E++],I[i++]=w[E++],I[i++]=w[E++],F-=3;F&&(I[i++]=w[E++],F>1&&(I[i++]=w[E++]))}else{E=i-N;do I[i++]=I[E++],I[i++]=I[E++],I[i++]=I[E++],F-=3;while(F>2);F&&(I[i++]=I[E++],F>1&&(I[i++]=I[E++]))}}else if((B&64)===0){S=g[(S&65535)+(u&(1<<B)-1)];continue r}else{e.msg="invalid distance code",k.mode=_0;break e}break}}else if((B&64)===0){S=f[(S&65535)+(u&(1<<B)-1)];continue t}else if(B&32){k.mode=jK;break e}else{e.msg="invalid literal/length code",k.mode=_0;break e}break}}while(n<s&&i<o);F=p>>3,n-=F,p-=F<<3,u&=(1<<p)-1,e.next_in=n,e.next_out=i,e.avail_in=n<s?5+(s-n):5-(n-s),e.avail_out=i<o?257+(o-i):257-(i-o),k.hold=u,k.bits=p};const yu=15,WC=852,YC=592,XC=0,Iw=1,JC=2,$K=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),GK=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),zK=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),KK=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),qK=(r,e,t,n,s,i,a,o)=>{const l=o.bits;let c=0,A=0,d=0,h=0,u=0,p=0,f=0,g=0,m=0,x=0,S,B,F,N,E,w=null,v;const I=new Uint16Array(yu+1),k=new Uint16Array(yu+1);let _=null,T,L,K;for(c=0;c<=yu;c++)I[c]=0;for(A=0;A<n;A++)I[e[t+A]]++;for(u=l,h=yu;h>=1&&I[h]===0;h--);if(u>h&&(u=h),h===0)return s[i++]=1<<24|64<<16|0,s[i++]=1<<24|64<<16|0,o.bits=1,0;for(d=1;d<h&&I[d]===0;d++);for(u<d&&(u=d),g=1,c=1;c<=yu;c++)if(g<<=1,g-=I[c],g<0)return-1;if(g>0&&(r===XC||h!==1))return-1;for(k[1]=0,c=1;c<yu;c++)k[c+1]=k[c]+I[c];for(A=0;A<n;A++)e[t+A]!==0&&(a[k[e[t+A]]++]=A);if(r===XC?(w=_=a,v=20):r===Iw?(w=$K,_=GK,v=257):(w=zK,_=KK,v=0),x=0,A=0,c=d,E=i,p=u,f=0,F=-1,m=1<<u,N=m-1,r===Iw&&m>WC||r===JC&&m>YC)return 1;for(;;){T=c-f,a[A]+1<v?(L=0,K=a[A]):a[A]>=v?(L=_[a[A]-v],K=w[a[A]-v]):(L=96,K=0),S=1<<c-f,B=1<<p,d=B;do B-=S,s[E+(x>>f)+B]=T<<24|L<<16|K|0;while(B!==0);for(S=1<<c-1;x&S;)S>>=1;if(S!==0?(x&=S-1,x+=S):x=0,A++,--I[c]===0){if(c===h)break;c=e[t+a[A]]}if(c>u&&(x&N)!==F){for(f===0&&(f=u),E+=d,p=c-f,g=1<<p;p+f<h&&(g-=I[p+f],!(g<=0));)p++,g<<=1;if(m+=1<<p,r===Iw&&m>WC||r===JC&&m>YC)return 1;F=x&N,s[F]=u<<24|p<<16|E-i|0}}return x!==0&&(s[E+x]=c-f<<24|64<<16|0),o.bits=u,0};var Jf=qK;const WK=0,pF=1,mF=2,{Z_FINISH:ZC,Z_BLOCK:YK,Z_TREES:B0,Z_OK:Md,Z_STREAM_END:XK,Z_NEED_DICT:JK,Z_STREAM_ERROR:ro,Z_DATA_ERROR:bF,Z_MEM_ERROR:yF,Z_BUF_ERROR:ZK,Z_DEFLATED:eS}=hF,zb=16180,tS=16181,rS=16182,nS=16183,sS=16184,iS=16185,aS=16186,oS=16187,lS=16188,cS=16189,Jm=16190,Ul=16191,Tw=16192,AS=16193,Fw=16194,dS=16195,uS=16196,hS=16197,fS=16198,C0=16199,S0=16200,gS=16201,pS=16202,mS=16203,bS=16204,yS=16205,Lw=16206,wS=16207,vS=16208,Mn=16209,wF=16210,vF=16211,eq=852,tq=592,rq=15,nq=rq,xS=r=>(r>>>24&255)+(r>>>8&65280)+((r&65280)<<8)+((r&255)<<24);function sq(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Yd=r=>{if(!r)return 1;const e=r.state;return!e||e.strm!==r||e.mode<zb||e.mode>vF?1:0},xF=r=>{if(Yd(r))return ro;const e=r.state;return r.total_in=r.total_out=e.total=0,r.msg="",e.wrap&&(r.adler=e.wrap&1),e.mode=zb,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(eq),e.distcode=e.distdyn=new Int32Array(tq),e.sane=1,e.back=-1,Md},_F=r=>{if(Yd(r))return ro;const e=r.state;return e.wsize=0,e.whave=0,e.wnext=0,xF(r)},BF=(r,e)=>{let t;if(Yd(r))return ro;const n=r.state;return e<0?(t=0,e=-e):(t=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?ro:(n.window!==null&&n.wbits!==e&&(n.window=null),n.wrap=t,n.wbits=e,_F(r))},CF=(r,e)=>{if(!r)return ro;const t=new sq;r.state=t,t.strm=r,t.window=null,t.mode=zb;const n=BF(r,e);return n!==Md&&(r.state=null),n},iq=r=>CF(r,nq);let _S=!0,Uw,Mw;const aq=r=>{if(_S){Uw=new Int32Array(512),Mw=new Int32Array(32);let e=0;for(;e<144;)r.lens[e++]=8;for(;e<256;)r.lens[e++]=9;for(;e<280;)r.lens[e++]=7;for(;e<288;)r.lens[e++]=8;for(Jf(pF,r.lens,0,288,Uw,0,r.work,{bits:9}),e=0;e<32;)r.lens[e++]=5;Jf(mF,r.lens,0,32,Mw,0,r.work,{bits:5}),_S=!1}r.lencode=Uw,r.lenbits=9,r.distcode=Mw,r.distbits=5},SF=(r,e,t,n)=>{let s;const i=r.state;return i.window===null&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new Uint8Array(i.wsize)),n>=i.wsize?(i.window.set(e.subarray(t-i.wsize,t),0),i.wnext=0,i.whave=i.wsize):(s=i.wsize-i.wnext,s>n&&(s=n),i.window.set(e.subarray(t-n,t-n+s),i.wnext),n-=s,n?(i.window.set(e.subarray(t-n,t),0),i.wnext=n,i.whave=i.wsize):(i.wnext+=s,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=s))),0},oq=(r,e)=>{let t,n,s,i,a,o,l,c,A,d,h,u,p,f,g=0,m,x,S,B,F,N,E,w;const v=new Uint8Array(4);let I,k;const _=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Yd(r)||!r.output||!r.input&&r.avail_in!==0)return ro;t=r.state,t.mode===Ul&&(t.mode=Tw),a=r.next_out,s=r.output,l=r.avail_out,i=r.next_in,n=r.input,o=r.avail_in,c=t.hold,A=t.bits,d=o,h=l,w=Md;e:for(;;)switch(t.mode){case zb:if(t.wrap===0){t.mode=Tw;break}for(;A<16;){if(o===0)break e;o--,c+=n[i++]<<A,A+=8}if(t.wrap&2&&c===35615){t.wbits===0&&(t.wbits=15),t.check=0,v[0]=c&255,v[1]=c>>>8&255,t.check=Oo(t.check,v,2,0),c=0,A=0,t.mode=tS;break}if(t.head&&(t.head.done=!1),!(t.wrap&1)||(((c&255)<<8)+(c>>8))%31){r.msg="incorrect header check",t.mode=Mn;break}if((c&15)!==eS){r.msg="unknown compression method",t.mode=Mn;break}if(c>>>=4,A-=4,E=(c&15)+8,t.wbits===0&&(t.wbits=E),E>15||E>t.wbits){r.msg="invalid window size",t.mode=Mn;break}t.dmax=1<<t.wbits,t.flags=0,r.adler=t.check=1,t.mode=c&512?cS:Ul,c=0,A=0;break;case tS:for(;A<16;){if(o===0)break e;o--,c+=n[i++]<<A,A+=8}if(t.flags=c,(t.flags&255)!==eS){r.msg="unknown compression method",t.mode=Mn;break}if(t.flags&57344){r.msg="unknown header flags set",t.mode=Mn;break}t.head&&(t.head.text=c>>8&1),t.flags&512&&t.wrap&4&&(v[0]=c&255,v[1]=c>>>8&255,t.check=Oo(t.check,v,2,0)),c=0,A=0,t.mode=rS;case rS:for(;A<32;){if(o===0)break e;o--,c+=n[i++]<<A,A+=8}t.head&&(t.head.time=c),t.flags&512&&t.wrap&4&&(v[0]=c&255,v[1]=c>>>8&255,v[2]=c>>>16&255,v[3]=c>>>24&255,t.check=Oo(t.check,v,4,0)),c=0,A=0,t.mode=nS;case nS:for(;A<16;){if(o===0)break e;o--,c+=n[i++]<<A,A+=8}t.head&&(t.head.xflags=c&255,t.head.os=c>>8),t.flags&512&&t.wrap&4&&(v[0]=c&255,v[1]=c>>>8&255,t.check=Oo(t.check,v,2,0)),c=0,A=0,t.mode=sS;case sS:if(t.flags&1024){for(;A<16;){if(o===0)break e;o--,c+=n[i++]<<A,A+=8}t.length=c,t.head&&(t.head.extra_len=c),t.flags&512&&t.wrap&4&&(v[0]=c&255,v[1]=c>>>8&255,t.check=Oo(t.check,v,2,0)),c=0,A=0}else t.head&&(t.head.extra=null);t.mode=iS;case iS:if(t.flags&1024&&(u=t.length,u>o&&(u=o),u&&(t.head&&(E=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Uint8Array(t.head.extra_len)),t.head.extra.set(n.subarray(i,i+u),E)),t.flags&512&&t.wrap&4&&(t.check=Oo(t.check,n,u,i)),o-=u,i+=u,t.length-=u),t.length))break e;t.length=0,t.mode=aS;case aS:if(t.flags&2048){if(o===0)break e;u=0;do E=n[i+u++],t.head&&E&&t.length<65536&&(t.head.name+=String.fromCharCode(E));while(E&&u<o);if(t.flags&512&&t.wrap&4&&(t.check=Oo(t.check,n,u,i)),o-=u,i+=u,E)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=oS;case oS:if(t.flags&4096){if(o===0)break e;u=0;do E=n[i+u++],t.head&&E&&t.length<65536&&(t.head.comment+=String.fromCharCode(E));while(E&&u<o);if(t.flags&512&&t.wrap&4&&(t.check=Oo(t.check,n,u,i)),o-=u,i+=u,E)break e}else t.head&&(t.head.comment=null);t.mode=lS;case lS:if(t.flags&512){for(;A<16;){if(o===0)break e;o--,c+=n[i++]<<A,A+=8}if(t.wrap&4&&c!==(t.check&65535)){r.msg="header crc mismatch",t.mode=Mn;break}c=0,A=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),r.adler=t.check=0,t.mode=Ul;break;case cS:for(;A<32;){if(o===0)break e;o--,c+=n[i++]<<A,A+=8}r.adler=t.check=xS(c),c=0,A=0,t.mode=Jm;case Jm:if(t.havedict===0)return r.next_out=a,r.avail_out=l,r.next_in=i,r.avail_in=o,t.hold=c,t.bits=A,JK;r.adler=t.check=1,t.mode=Ul;case Ul:if(e===YK||e===B0)break e;case Tw:if(t.last){c>>>=A&7,A-=A&7,t.mode=Lw;break}for(;A<3;){if(o===0)break e;o--,c+=n[i++]<<A,A+=8}switch(t.last=c&1,c>>>=1,A-=1,c&3){case 0:t.mode=AS;break;case 1:if(aq(t),t.mode=C0,e===B0){c>>>=2,A-=2;break e}break;case 2:t.mode=uS;break;case 3:r.msg="invalid block type",t.mode=Mn}c>>>=2,A-=2;break;case AS:for(c>>>=A&7,A-=A&7;A<32;){if(o===0)break e;o--,c+=n[i++]<<A,A+=8}if((c&65535)!==(c>>>16^65535)){r.msg="invalid stored block lengths",t.mode=Mn;break}if(t.length=c&65535,c=0,A=0,t.mode=Fw,e===B0)break e;case Fw:t.mode=dS;case dS:if(u=t.length,u){if(u>o&&(u=o),u>l&&(u=l),u===0)break e;s.set(n.subarray(i,i+u),a),o-=u,i+=u,l-=u,a+=u,t.length-=u;break}t.mode=Ul;break;case uS:for(;A<14;){if(o===0)break e;o--,c+=n[i++]<<A,A+=8}if(t.nlen=(c&31)+257,c>>>=5,A-=5,t.ndist=(c&31)+1,c>>>=5,A-=5,t.ncode=(c&15)+4,c>>>=4,A-=4,t.nlen>286||t.ndist>30){r.msg="too many length or distance symbols",t.mode=Mn;break}t.have=0,t.mode=hS;case hS:for(;t.have<t.ncode;){for(;A<3;){if(o===0)break e;o--,c+=n[i++]<<A,A+=8}t.lens[_[t.have++]]=c&7,c>>>=3,A-=3}for(;t.have<19;)t.lens[_[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,I={bits:t.lenbits},w=Jf(WK,t.lens,0,19,t.lencode,0,t.work,I),t.lenbits=I.bits,w){r.msg="invalid code lengths set",t.mode=Mn;break}t.have=0,t.mode=fS;case fS:for(;t.have<t.nlen+t.ndist;){for(;g=t.lencode[c&(1<<t.lenbits)-1],m=g>>>24,x=g>>>16&255,S=g&65535,!(m<=A);){if(o===0)break e;o--,c+=n[i++]<<A,A+=8}if(S<16)c>>>=m,A-=m,t.lens[t.have++]=S;else{if(S===16){for(k=m+2;A<k;){if(o===0)break e;o--,c+=n[i++]<<A,A+=8}if(c>>>=m,A-=m,t.have===0){r.msg="invalid bit length repeat",t.mode=Mn;break}E=t.lens[t.have-1],u=3+(c&3),c>>>=2,A-=2}else if(S===17){for(k=m+3;A<k;){if(o===0)break e;o--,c+=n[i++]<<A,A+=8}c>>>=m,A-=m,E=0,u=3+(c&7),c>>>=3,A-=3}else{for(k=m+7;A<k;){if(o===0)break e;o--,c+=n[i++]<<A,A+=8}c>>>=m,A-=m,E=0,u=11+(c&127),c>>>=7,A-=7}if(t.have+u>t.nlen+t.ndist){r.msg="invalid bit length repeat",t.mode=Mn;break}for(;u--;)t.lens[t.have++]=E}}if(t.mode===Mn)break;if(t.lens[256]===0){r.msg="invalid code -- missing end-of-block",t.mode=Mn;break}if(t.lenbits=9,I={bits:t.lenbits},w=Jf(pF,t.lens,0,t.nlen,t.lencode,0,t.work,I),t.lenbits=I.bits,w){r.msg="invalid literal/lengths set",t.mode=Mn;break}if(t.distbits=6,t.distcode=t.distdyn,I={bits:t.distbits},w=Jf(mF,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,I),t.distbits=I.bits,w){r.msg="invalid distances set",t.mode=Mn;break}if(t.mode=C0,e===B0)break e;case C0:t.mode=S0;case S0:if(o>=6&&l>=258){r.next_out=a,r.avail_out=l,r.next_in=i,r.avail_in=o,t.hold=c,t.bits=A,VK(r,h),a=r.next_out,s=r.output,l=r.avail_out,i=r.next_in,n=r.input,o=r.avail_in,c=t.hold,A=t.bits,t.mode===Ul&&(t.back=-1);break}for(t.back=0;g=t.lencode[c&(1<<t.lenbits)-1],m=g>>>24,x=g>>>16&255,S=g&65535,!(m<=A);){if(o===0)break e;o--,c+=n[i++]<<A,A+=8}if(x&&(x&240)===0){for(B=m,F=x,N=S;g=t.lencode[N+((c&(1<<B+F)-1)>>B)],m=g>>>24,x=g>>>16&255,S=g&65535,!(B+m<=A);){if(o===0)break e;o--,c+=n[i++]<<A,A+=8}c>>>=B,A-=B,t.back+=B}if(c>>>=m,A-=m,t.back+=m,t.length=S,x===0){t.mode=yS;break}if(x&32){t.back=-1,t.mode=Ul;break}if(x&64){r.msg="invalid literal/length code",t.mode=Mn;break}t.extra=x&15,t.mode=gS;case gS:if(t.extra){for(k=t.extra;A<k;){if(o===0)break e;o--,c+=n[i++]<<A,A+=8}t.length+=c&(1<<t.extra)-1,c>>>=t.extra,A-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=pS;case pS:for(;g=t.distcode[c&(1<<t.distbits)-1],m=g>>>24,x=g>>>16&255,S=g&65535,!(m<=A);){if(o===0)break e;o--,c+=n[i++]<<A,A+=8}if((x&240)===0){for(B=m,F=x,N=S;g=t.distcode[N+((c&(1<<B+F)-1)>>B)],m=g>>>24,x=g>>>16&255,S=g&65535,!(B+m<=A);){if(o===0)break e;o--,c+=n[i++]<<A,A+=8}c>>>=B,A-=B,t.back+=B}if(c>>>=m,A-=m,t.back+=m,x&64){r.msg="invalid distance code",t.mode=Mn;break}t.offset=S,t.extra=x&15,t.mode=mS;case mS:if(t.extra){for(k=t.extra;A<k;){if(o===0)break e;o--,c+=n[i++]<<A,A+=8}t.offset+=c&(1<<t.extra)-1,c>>>=t.extra,A-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){r.msg="invalid distance too far back",t.mode=Mn;break}t.mode=bS;case bS:if(l===0)break e;if(u=h-l,t.offset>u){if(u=t.offset-u,u>t.whave&&t.sane){r.msg="invalid distance too far back",t.mode=Mn;break}u>t.wnext?(u-=t.wnext,p=t.wsize-u):p=t.wnext-u,u>t.length&&(u=t.length),f=t.window}else f=s,p=a-t.offset,u=t.length;u>l&&(u=l),l-=u,t.length-=u;do s[a++]=f[p++];while(--u);t.length===0&&(t.mode=S0);break;case yS:if(l===0)break e;s[a++]=t.length,l--,t.mode=S0;break;case Lw:if(t.wrap){for(;A<32;){if(o===0)break e;o--,c|=n[i++]<<A,A+=8}if(h-=l,r.total_out+=h,t.total+=h,t.wrap&4&&h&&(r.adler=t.check=t.flags?Oo(t.check,s,h,a-h):v1(t.check,s,h,a-h)),h=l,t.wrap&4&&(t.flags?c:xS(c))!==t.check){r.msg="incorrect data check",t.mode=Mn;break}c=0,A=0}t.mode=wS;case wS:if(t.wrap&&t.flags){for(;A<32;){if(o===0)break e;o--,c+=n[i++]<<A,A+=8}if(t.wrap&4&&c!==(t.total&4294967295)){r.msg="incorrect length check",t.mode=Mn;break}c=0,A=0}t.mode=vS;case vS:w=XK;break e;case Mn:w=bF;break e;case wF:return yF;case vF:default:return ro}return r.next_out=a,r.avail_out=l,r.next_in=i,r.avail_in=o,t.hold=c,t.bits=A,(t.wsize||h!==r.avail_out&&t.mode<Mn&&(t.mode<Lw||e!==ZC))&&SF(r,r.output,r.next_out,h-r.avail_out),d-=r.avail_in,h-=r.avail_out,r.total_in+=d,r.total_out+=h,t.total+=h,t.wrap&4&&h&&(r.adler=t.check=t.flags?Oo(t.check,s,h,r.next_out-h):v1(t.check,s,h,r.next_out-h)),r.data_type=t.bits+(t.last?64:0)+(t.mode===Ul?128:0)+(t.mode===C0||t.mode===Fw?256:0),(d===0&&h===0||e===ZC)&&w===Md&&(w=ZK),w},lq=r=>{if(Yd(r))return ro;let e=r.state;return e.window&&(e.window=null),r.state=null,Md},cq=(r,e)=>{if(Yd(r))return ro;const t=r.state;return(t.wrap&2)===0?ro:(t.head=e,e.done=!1,Md)},Aq=(r,e)=>{const t=e.length;let n,s,i;return Yd(r)||(n=r.state,n.wrap!==0&&n.mode!==Jm)?ro:n.mode===Jm&&(s=1,s=v1(s,e,t,0),s!==n.check)?bF:(i=SF(r,e,t,t),i?(n.mode=wF,yF):(n.havedict=1,Md))};var dq=_F,uq=BF,hq=xF,fq=iq,gq=CF,pq=oq,mq=lq,bq=cq,yq=Aq,wq="pako inflate (from Nodeca project)",Dl={inflateReset:dq,inflateReset2:uq,inflateResetKeep:hq,inflateInit:fq,inflateInit2:gq,inflate:pq,inflateEnd:mq,inflateGetHeader:bq,inflateSetDictionary:yq,inflateInfo:wq};function vq(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var xq=vq;const kF=Object.prototype.toString,{Z_NO_FLUSH:_q,Z_FINISH:Bq,Z_OK:vg,Z_STREAM_END:Nw,Z_NEED_DICT:Pw,Z_STREAM_ERROR:Cq,Z_DATA_ERROR:BS,Z_MEM_ERROR:Sq}=hF;function jg(r){this.options=fF.assign({chunkSize:1024*64,windowBits:15,to:""},r||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(r&&r.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)===0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new HK,this.strm.avail_out=0;let t=Dl.inflateInit2(this.strm,e.windowBits);if(t!==vg)throw new Error(x1[t]);if(this.header=new xq,Dl.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=_1.string2buf(e.dictionary):kF.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(t=Dl.inflateSetDictionary(this.strm,e.dictionary),t!==vg)))throw new Error(x1[t])}jg.prototype.push=function(r,e){const t=this.strm,n=this.options.chunkSize,s=this.options.dictionary;let i,a,o;if(this.ended)return!1;for(e===~~e?a=e:a=e===!0?Bq:_q,kF.call(r)==="[object ArrayBuffer]"?t.input=new Uint8Array(r):t.input=r,t.next_in=0,t.avail_in=t.input.length;;){for(t.avail_out===0&&(t.output=new Uint8Array(n),t.next_out=0,t.avail_out=n),i=Dl.inflate(t,a),i===Pw&&s&&(i=Dl.inflateSetDictionary(t,s),i===vg?i=Dl.inflate(t,a):i===BS&&(i=Pw));t.avail_in>0&&i===Nw&&t.state.wrap>0&&r[t.next_in]!==0;)Dl.inflateReset(t),i=Dl.inflate(t,a);switch(i){case Cq:case BS:case Pw:case Sq:return this.onEnd(i),this.ended=!0,!1}if(o=t.avail_out,t.next_out&&(t.avail_out===0||i===Nw))if(this.options.to==="string"){let l=_1.utf8border(t.output,t.next_out),c=t.next_out-l,A=_1.buf2string(t.output,l);t.next_out=c,t.avail_out=n-c,c&&t.output.set(t.output.subarray(l,l+c),0),this.onData(A)}else this.onData(t.output.length===t.next_out?t.output:t.output.subarray(0,t.next_out));if(!(i===vg&&o===0)){if(i===Nw)return i=Dl.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,!0;if(t.avail_in===0)break}}return!0};jg.prototype.onData=function(r){this.chunks.push(r)};jg.prototype.onEnd=function(r){r===vg&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=fF.flattenChunks(this.chunks)),this.chunks=[],this.err=r,this.msg=this.strm.msg};function kq(r,e){const t=new jg(e);if(t.push(r),t.err)throw t.msg||x1[t.err];return t.result}var Eq=jg,Iq=kq,Tq={Inflate:Eq,inflate:Iq};const{Inflate:Fq,inflate:Lq}=Tq;var CS=Fq,Uq=Lq;const EF=[];for(let r=0;r<256;r++){let e=r;for(let t=0;t<8;t++)e&1?e=3988292384^e>>>1:e=e>>>1;EF[r]=e}const SS=4294967295;function Mq(r,e,t){let n=r;for(let s=0;s<t;s++)n=EF[(n^e[s])&255]^n>>>8;return n}function Nq(r,e){return(Mq(SS,r,e)^SS)>>>0}function kS(r,e,t){const n=r.readUint32(),s=Nq(new Uint8Array(r.buffer,r.byteOffset+r.offset-e-4,e),e);if(s!==n)throw new Error(`CRC mismatch for chunk ${t}. Expected ${n}, found ${s}`)}function IF(r,e,t){for(let n=0;n<t;n++)e[n]=r[n]}function TF(r,e,t,n){let s=0;for(;s<n;s++)e[s]=r[s];for(;s<t;s++)e[s]=r[s]+e[s-n]&255}function FF(r,e,t,n){let s=0;if(t.length===0)for(;s<n;s++)e[s]=r[s];else for(;s<n;s++)e[s]=r[s]+t[s]&255}function LF(r,e,t,n,s){let i=0;if(t.length===0){for(;i<s;i++)e[i]=r[i];for(;i<n;i++)e[i]=r[i]+(e[i-s]>>1)&255}else{for(;i<s;i++)e[i]=r[i]+(t[i]>>1)&255;for(;i<n;i++)e[i]=r[i]+(e[i-s]+t[i]>>1)&255}}function UF(r,e,t,n,s){let i=0;if(t.length===0){for(;i<s;i++)e[i]=r[i];for(;i<n;i++)e[i]=r[i]+e[i-s]&255}else{for(;i<s;i++)e[i]=r[i]+t[i]&255;for(;i<n;i++)e[i]=r[i]+Pq(e[i-s],t[i],t[i-s])&255}}function Pq(r,e,t){const n=r+e-t,s=Math.abs(n-r),i=Math.abs(n-e),a=Math.abs(n-t);return s<=i&&s<=a?r:i<=a?e:t}function Dq(r,e,t,n,s,i){switch(r){case 0:IF(e,t,s);break;case 1:TF(e,t,s,i);break;case 2:FF(e,t,n,s);break;case 3:LF(e,t,n,s,i);break;case 4:UF(e,t,n,s,i);break;default:throw new Error(`Unsupported filter: ${r}`)}}const Rq=new Uint16Array([255]),Oq=new Uint8Array(Rq.buffer),Qq=Oq[0]===255;function Hq(r){const{data:e,width:t,height:n,channels:s,depth:i}=r,a=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],o=Math.ceil(i/8)*s,l=new Uint8Array(n*t*o);let c=0;for(let A=0;A<7;A++){const d=a[A],h=Math.ceil((t-d.x)/d.xStep),u=Math.ceil((n-d.y)/d.yStep);if(h<=0||u<=0)continue;const p=h*o,f=new Uint8Array(p);for(let g=0;g<u;g++){const m=e[c++],x=e.subarray(c,c+p);c+=p;const S=new Uint8Array(p);Dq(m,x,S,f,p,o),f.set(S);for(let B=0;B<h;B++){const F=d.x+B*d.xStep,N=d.y+g*d.yStep;if(!(F>=t||N>=n))for(let E=0;E<o;E++)l[(N*t+F)*o+E]=S[B*o+E]}}}if(i===16){const A=new Uint16Array(l.buffer);if(Qq)for(let d=0;d<A.length;d++)A[d]=jq(A[d]);return A}else return l}function jq(r){return(r&255)<<8|r>>8&255}const Vq=new Uint16Array([255]),$q=new Uint8Array(Vq.buffer),Gq=$q[0]===255,zq=new Uint8Array(0);function ES(r){const{data:e,width:t,height:n,channels:s,depth:i}=r,a=Math.ceil(i/8)*s,o=Math.ceil(i/8*s*t),l=new Uint8Array(n*o);let c=zq,A=0,d,h;for(let u=0;u<n;u++){switch(d=e.subarray(A+1,A+1+o),h=l.subarray(u*o,(u+1)*o),e[A]){case 0:IF(d,h,o);break;case 1:TF(d,h,o,a);break;case 2:FF(d,h,c,o);break;case 3:LF(d,h,c,o,a);break;case 4:UF(d,h,c,o,a);break;default:throw new Error(`Unsupported filter: ${e[A]}`)}c=h,A+=o+1}if(i===16){const u=new Uint16Array(l.buffer);if(Gq)for(let p=0;p<u.length;p++)u[p]=Kq(u[p]);return u}else return l}function Kq(r){return(r&255)<<8|r>>8&255}const im=Uint8Array.of(137,80,78,71,13,10,26,10);function IS(r){if(!qq(r.readBytes(im.length)))throw new Error("wrong PNG signature")}function qq(r){if(r.length<im.length)return!1;for(let e=0;e<im.length;e++)if(r[e]!==im[e])return!1;return!0}const Wq="tEXt",Yq=0,MF=new TextDecoder("latin1");function Xq(r){if(Zq(r),r.length===0||r.length>79)throw new Error("keyword length must be between 1 and 79")}const Jq=/^[\u0000-\u00FF]*$/;function Zq(r){if(!Jq.test(r))throw new Error("invalid latin1 text")}function eW(r,e,t){const n=NF(e);r[n]=tW(e,t-n.length-1)}function NF(r){for(r.mark();r.readByte()!==Yq;);const e=r.offset;r.reset();const t=MF.decode(r.readBytes(e-r.offset-1));return r.skip(1),Xq(t),t}function tW(r,e){return MF.decode(r.readBytes(e))}const Ba={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},Dw={UNKNOWN:-1,DEFLATE:0},TS={UNKNOWN:-1,ADAPTIVE:0},Rw={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},k0={NONE:0,BACKGROUND:1,PREVIOUS:2},Ow={SOURCE:0,OVER:1};class rW extends t2{constructor(t,n={}){super(t);Fe(this,"_checkCrc");Fe(this,"_inflator");Fe(this,"_png");Fe(this,"_apng");Fe(this,"_end");Fe(this,"_hasPalette");Fe(this,"_palette");Fe(this,"_hasTransparency");Fe(this,"_transparency");Fe(this,"_compressionMethod");Fe(this,"_filterMethod");Fe(this,"_interlaceMethod");Fe(this,"_colorType");Fe(this,"_isAnimated");Fe(this,"_numberOfFrames");Fe(this,"_numberOfPlays");Fe(this,"_frames");Fe(this,"_writingDataChunks");const{checkCrc:s=!1}=n;this._checkCrc=s,this._inflator=new CS,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=Dw.UNKNOWN,this._filterMethod=TS.UNKNOWN,this._interlaceMethod=Rw.UNKNOWN,this._colorType=Ba.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(IS(this);!this._end;){const t=this.readUint32(),n=this.readChars(4);this.decodeChunk(t,n)}return this.decodeImage(),this._png}decodeApng(){for(IS(this);!this._end;){const t=this.readUint32(),n=this.readChars(4);this.decodeApngChunk(t,n)}return this.decodeApngImage(),this._apng}decodeChunk(t,n){const s=this.offset;switch(n){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(t);break;case"IDAT":this.decodeIDAT(t);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(t);break;case"iCCP":this.decodeiCCP(t);break;case Wq:eW(this._png.text,this,t);break;case"pHYs":this.decodepHYs();break;default:this.skip(t);break}if(this.offset-s!==t)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?kS(this,t+4,n):this.skip(4)}decodeApngChunk(t,n){const s=this.offset;switch(n!=="fdAT"&&n!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),n){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(t);break;default:this.decodeChunk(t,n),this.offset=s+t;break}if(this.offset-s!==t)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?kS(this,t+4,n):this.skip(4)}decodeIHDR(){const t=this._png;t.width=this.readUint32(),t.height=this.readUint32(),t.depth=nW(this.readUint8());const n=this.readUint8();this._colorType=n;let s;switch(n){case Ba.GREYSCALE:s=1;break;case Ba.TRUECOLOUR:s=3;break;case Ba.INDEXED_COLOUR:s=1;break;case Ba.GREYSCALE_ALPHA:s=2;break;case Ba.TRUECOLOUR_ALPHA:s=4;break;case Ba.UNKNOWN:default:throw new Error(`Unknown color type: ${n}`)}if(this._png.channels=s,this._compressionMethod=this.readUint8(),this._compressionMethod!==Dw.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const t={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(t)}decodePLTE(t){if(t%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${t}`);const n=t/3;this._hasPalette=!0;const s=[];this._palette=s;for(let i=0;i<n;i++)s.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(t){this._writingDataChunks=!0;const n=t,s=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,s,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(t)}decodeFDAT(t){this._writingDataChunks=!0;let n=t,s=this.offset+this.byteOffset;if(s+=4,n-=4,this._inflator.push(new Uint8Array(this.buffer,s,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(t)}decodetRNS(t){switch(this._colorType){case Ba.GREYSCALE:case Ba.TRUECOLOUR:{if(t%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${t}`);if(t/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${t/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(t/2);for(let n=0;n<t/2;n++)this._transparency[n]=this.readUint16();break}case Ba.INDEXED_COLOUR:{if(t>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${t} vs ${this._palette.length})`);let n=0;for(;n<t;n++){const s=this.readByte();this._palette[n].push(s)}for(;n<this._palette.length;n++)this._palette[n].push(255);break}case Ba.UNKNOWN:case Ba.GREYSCALE_ALPHA:case Ba.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(t){const n=NF(this),s=this.readUint8();if(s!==Dw.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${s}`);const i=this.readBytes(t-n.length-2);this._png.iccEmbeddedProfile={name:n,profile:Uq(i)}}decodepHYs(){const t=this.readUint32(),n=this.readUint32(),s=this.readByte();this._png.resolution={x:t,y:n,unit:s}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let t=0;t<this._numberOfFrames;t++){const n={sequenceNumber:this._frames[t].sequenceNumber,delayNumber:this._frames[t].delayNumber,delayDenominator:this._frames[t].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},s=this._frames.at(t);if(s){if(s.data=ES({data:s.data,width:s.width,height:s.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),t===0||s.xOffset===0&&s.yOffset===0&&s.width===this._png.width&&s.height===this._png.height)n.data=s.data;else{const i=this._apng.frames.at(t-1);this.disposeFrame(s,i,n),this.addFrameDataToCanvas(n,s)}this._apng.frames.push(n)}}return this._apng}disposeFrame(t,n,s){switch(t.disposeOp){case k0.NONE:break;case k0.BACKGROUND:for(let i=0;i<this._png.height;i++)for(let a=0;a<this._png.width;a++){const o=(i*t.width+a)*this._png.channels;for(let l=0;l<this._png.channels;l++)s.data[o+l]=0}break;case k0.PREVIOUS:s.data.set(n.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(t,n){const s=1<<this._png.depth,i=(a,o)=>{const l=((a+n.yOffset)*this._png.width+n.xOffset+o)*this._png.channels,c=(a*n.width+o)*this._png.channels;return{index:l,frameIndex:c}};switch(n.blendOp){case Ow.SOURCE:for(let a=0;a<n.height;a++)for(let o=0;o<n.width;o++){const{index:l,frameIndex:c}=i(a,o);for(let A=0;A<this._png.channels;A++)t.data[l+A]=n.data[c+A]}break;case Ow.OVER:for(let a=0;a<n.height;a++)for(let o=0;o<n.width;o++){const{index:l,frameIndex:c}=i(a,o);for(let A=0;A<this._png.channels;A++){const d=n.data[c+this._png.channels-1]/s,h=A%(this._png.channels-1)===0?1:n.data[c+A],u=Math.floor(d*h+(1-d)*t.data[l+A]);t.data[l+A]+=u}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var n;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const t=this._isAnimated?((n=this._frames)==null?void 0:n.at(0)).data:this._inflator.result;if(this._filterMethod!==TS.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===Rw.NO_INTERLACE)this._png.data=ES({data:t,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===Rw.ADAM7)this._png.data=Hq({data:t,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const t=this._inflator.result,n=this._frames.at(-1);n?n.data=t:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:k0.NONE,blendOp:Ow.SOURCE,data:t}),this._inflator=new CS,this._writingDataChunks=!1}}function nW(r){if(r!==1&&r!==2&&r!==4&&r!==8&&r!==16)throw new Error(`invalid bit depth: ${r}`);return r}var FS;(function(r){r[r.UNKNOWN=0]="UNKNOWN",r[r.METRE=1]="METRE"})(FS||(FS={}));function sW(r,e){return new rW(r,e).decode()}var Zt=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function Qw(){Zt.console&&typeof Zt.console.log=="function"&&Zt.console.log.apply(Zt.console,arguments)}var un={log:Qw,warn:function(r){Zt.console&&(typeof Zt.console.warn=="function"?Zt.console.warn.apply(Zt.console,arguments):Qw.call(null,arguments))},error:function(r){Zt.console&&(typeof Zt.console.error=="function"?Zt.console.error.apply(Zt.console,arguments):Qw(r))}};function Hw(r,e,t){var n=new XMLHttpRequest;n.open("GET",r),n.responseType="blob",n.onload=function(){nd(n.response,e,t)},n.onerror=function(){un.error("could not download file")},n.send()}function LS(r){var e=new XMLHttpRequest;e.open("HEAD",r,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function E0(r){try{r.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),r.dispatchEvent(e)}}var nd=Zt.saveAs||((typeof window>"u"?"undefined":nn(window))!=="object"||window!==Zt?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(r,e,t){var n=Zt.URL||Zt.webkitURL,s=document.createElement("a");e=e||r.name||"download",s.download=e,s.rel="noopener",typeof r=="string"?(s.href=r,s.origin!==location.origin?LS(s.href)?Hw(r,e,t):E0(s,s.target="_blank"):E0(s)):(s.href=n.createObjectURL(r),setTimeout(function(){n.revokeObjectURL(s.href)},4e4),setTimeout(function(){E0(s)},0))}:"msSaveOrOpenBlob"in navigator?function(r,e,t){if(e=e||r.name||"download",typeof r=="string")if(LS(r))Hw(r,e,t);else{var n=document.createElement("a");n.href=r,n.target="_blank",setTimeout(function(){E0(n)})}else navigator.msSaveOrOpenBlob((function(s,i){return i===void 0?i={autoBom:!1}:nn(i)!=="object"&&(un.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(s.type)?new Blob(["\uFEFF",s],{type:s.type}):s})(r,t),e)}:function(r,e,t,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof r=="string")return Hw(r,e,t);var s=r.type==="application/octet-stream",i=/constructor/i.test(Zt.HTMLElement)||Zt.safari,a=/CriOS\/[\d]+/.test(navigator.userAgent);if((a||s&&i)&&(typeof FileReader>"u"?"undefined":nn(FileReader))==="object"){var o=new FileReader;o.onloadend=function(){var A=o.result;A=a?A:A.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=A:location=A,n=null},o.readAsDataURL(r)}else{var l=Zt.URL||Zt.webkitURL,c=l.createObjectURL(r);n?n.location=c:location.href=c,n=null,setTimeout(function(){l.revokeObjectURL(c)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function PF(r){var e;r=r||"",this.ok=!1,r.charAt(0)=="#"&&(r=r.substr(1,6)),r={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[r=(r=r.replace(/ /g,"")).toLowerCase()]||r;for(var t=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}],n=0;n<t.length;n++){var s=t[n].re,i=t[n].process,a=s.exec(r);a&&(e=i(a),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var o=this.r.toString(16),l=this.g.toString(16),c=this.b.toString(16);return o.length==1&&(o="0"+o),l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),"#"+o+l+c}}var am=Zt.atob.bind(Zt),US=Zt.btoa.bind(Zt);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function jw(r,e){var t=r[0],n=r[1],s=r[2],i=r[3];t=mi(t,n,s,i,e[0],7,-680876936),i=mi(i,t,n,s,e[1],12,-389564586),s=mi(s,i,t,n,e[2],17,606105819),n=mi(n,s,i,t,e[3],22,-1044525330),t=mi(t,n,s,i,e[4],7,-176418897),i=mi(i,t,n,s,e[5],12,1200080426),s=mi(s,i,t,n,e[6],17,-1473231341),n=mi(n,s,i,t,e[7],22,-45705983),t=mi(t,n,s,i,e[8],7,1770035416),i=mi(i,t,n,s,e[9],12,-1958414417),s=mi(s,i,t,n,e[10],17,-42063),n=mi(n,s,i,t,e[11],22,-1990404162),t=mi(t,n,s,i,e[12],7,1804603682),i=mi(i,t,n,s,e[13],12,-40341101),s=mi(s,i,t,n,e[14],17,-1502002290),t=bi(t,n=mi(n,s,i,t,e[15],22,1236535329),s,i,e[1],5,-165796510),i=bi(i,t,n,s,e[6],9,-1069501632),s=bi(s,i,t,n,e[11],14,643717713),n=bi(n,s,i,t,e[0],20,-373897302),t=bi(t,n,s,i,e[5],5,-701558691),i=bi(i,t,n,s,e[10],9,38016083),s=bi(s,i,t,n,e[15],14,-660478335),n=bi(n,s,i,t,e[4],20,-405537848),t=bi(t,n,s,i,e[9],5,568446438),i=bi(i,t,n,s,e[14],9,-1019803690),s=bi(s,i,t,n,e[3],14,-187363961),n=bi(n,s,i,t,e[8],20,1163531501),t=bi(t,n,s,i,e[13],5,-1444681467),i=bi(i,t,n,s,e[2],9,-51403784),s=bi(s,i,t,n,e[7],14,1735328473),t=yi(t,n=bi(n,s,i,t,e[12],20,-1926607734),s,i,e[5],4,-378558),i=yi(i,t,n,s,e[8],11,-2022574463),s=yi(s,i,t,n,e[11],16,1839030562),n=yi(n,s,i,t,e[14],23,-35309556),t=yi(t,n,s,i,e[1],4,-1530992060),i=yi(i,t,n,s,e[4],11,1272893353),s=yi(s,i,t,n,e[7],16,-155497632),n=yi(n,s,i,t,e[10],23,-1094730640),t=yi(t,n,s,i,e[13],4,681279174),i=yi(i,t,n,s,e[0],11,-358537222),s=yi(s,i,t,n,e[3],16,-722521979),n=yi(n,s,i,t,e[6],23,76029189),t=yi(t,n,s,i,e[9],4,-640364487),i=yi(i,t,n,s,e[12],11,-421815835),s=yi(s,i,t,n,e[15],16,530742520),t=wi(t,n=yi(n,s,i,t,e[2],23,-995338651),s,i,e[0],6,-198630844),i=wi(i,t,n,s,e[7],10,1126891415),s=wi(s,i,t,n,e[14],15,-1416354905),n=wi(n,s,i,t,e[5],21,-57434055),t=wi(t,n,s,i,e[12],6,1700485571),i=wi(i,t,n,s,e[3],10,-1894986606),s=wi(s,i,t,n,e[10],15,-1051523),n=wi(n,s,i,t,e[1],21,-2054922799),t=wi(t,n,s,i,e[8],6,1873313359),i=wi(i,t,n,s,e[15],10,-30611744),s=wi(s,i,t,n,e[6],15,-1560198380),n=wi(n,s,i,t,e[13],21,1309151649),t=wi(t,n,s,i,e[4],6,-145523070),i=wi(i,t,n,s,e[11],10,-1120210379),s=wi(s,i,t,n,e[2],15,718787259),n=wi(n,s,i,t,e[9],21,-343485551),r[0]=eA(t,r[0]),r[1]=eA(n,r[1]),r[2]=eA(s,r[2]),r[3]=eA(i,r[3])}function Kb(r,e,t,n,s,i){return e=eA(eA(e,r),eA(n,i)),eA(e<<s|e>>>32-s,t)}function mi(r,e,t,n,s,i,a){return Kb(e&t|~e&n,r,e,s,i,a)}function bi(r,e,t,n,s,i,a){return Kb(e&n|t&~n,r,e,s,i,a)}function yi(r,e,t,n,s,i,a){return Kb(e^t^n,r,e,s,i,a)}function wi(r,e,t,n,s,i,a){return Kb(t^(e|~n),r,e,s,i,a)}function DF(r){var e,t=r.length,n=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=r.length;e+=64)jw(n,iW(r.substring(e-64,e)));r=r.substring(e-64);var s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<r.length;e++)s[e>>2]|=r.charCodeAt(e)<<(e%4<<3);if(s[e>>2]|=128<<(e%4<<3),e>55)for(jw(n,s),e=0;e<16;e++)s[e]=0;return s[14]=8*t,jw(n,s),n}function iW(r){var e,t=[];for(e=0;e<64;e+=4)t[e>>2]=r.charCodeAt(e)+(r.charCodeAt(e+1)<<8)+(r.charCodeAt(e+2)<<16)+(r.charCodeAt(e+3)<<24);return t}var MS="0123456789abcdef".split("");function aW(r){for(var e="",t=0;t<4;t++)e+=MS[r>>8*t+4&15]+MS[r>>8*t&15];return e}function oW(r){return String.fromCharCode(255&r,(65280&r)>>8,(16711680&r)>>16,(4278190080&r)>>24)}function B1(r){return DF(r).map(oW).join("")}var lW=(function(r){for(var e=0;e<r.length;e++)r[e]=aW(r[e]);return r.join("")})(DF("hello"))!="5d41402abc4b2a76b9719d911017c592";function eA(r,e){if(lW){var t=(65535&r)+(65535&e);return(r>>16)+(e>>16)+(t>>16)<<16|65535&t}return r+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function C1(r,e){var t,n,s,i;if(r!==t){for(var a=(s=r,i=1+(256/r.length|0),new Array(i+1).join(s)),o=[],l=0;l<256;l++)o[l]=l;var c=0;for(l=0;l<256;l++){var A=o[l];c=(c+A+a.charCodeAt(l))%256,o[l]=o[c],o[c]=A}t=r,n=o}else o=n;var d=e.length,h=0,u=0,p="";for(l=0;l<d;l++)u=(u+(A=o[h=(h+1)%256]))%256,o[h]=o[u],o[u]=A,a=o[(o[h]+o[u])%256],p+=String.fromCharCode(e.charCodeAt(l)^a);return p}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var NS={print:4,modify:8,copy:16,"annot-forms":32};function Cu(r,e,t,n){this.v=1,this.r=2;var s=192;r.forEach(function(o){if(NS.perm!==void 0)throw new Error("Invalid permission: "+o);s+=NS[o]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var i=(e+this.padding).substr(0,32),a=(t+this.padding).substr(0,32);this.O=this.processOwnerPassword(i,a),this.P=-(1+(255^s)),this.encryptionKey=B1(i+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=C1(this.encryptionKey,this.padding)}function Su(r){if(/[^\u0000-\u00ff]/.test(r))throw new Error("Invalid PDF Name Object: "+r+", Only accept ASCII characters.");for(var e="",t=r.length,n=0;n<t;n++){var s=r.charCodeAt(n);e+=s<33||s===35||s===37||s===40||s===41||s===47||s===60||s===62||s===91||s===93||s===123||s===125||s>126?"#"+("0"+s.toString(16)).slice(-2):r[n]}return e}function PS(r){if(nn(r)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(t,n,s){if(s=s||!1,typeof t!="string"||typeof n!="function"||typeof s!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(t)||(e[t]={});var i=Math.random().toString(35);return e[t][i]=[n,!!s],i},this.unsubscribe=function(t){for(var n in e)if(e[n][t])return delete e[n][t],Object.keys(e[n]).length===0&&delete e[n],!0;return!1},this.publish=function(t){if(e.hasOwnProperty(t)){var n=Array.prototype.slice.call(arguments,1),s=[];for(var i in e[t]){var a=e[t][i];try{a[0].apply(r,n)}catch(o){Zt.console&&un.error("jsPDF PubSub Error",o.message,o)}a[1]&&s.push(i)}s.length&&s.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function Zm(r){if(!(this instanceof Zm))return new Zm(r);var e="opacity,stroke-opacity".split(",");for(var t in r)r.hasOwnProperty(t)&&e.indexOf(t)>=0&&(this[t]=r[t]);this.id="",this.objectNumber=-1}function RF(r,e){this.gState=r,this.matrix=e,this.id="",this.objectNumber=-1}function od(r,e,t,n,s){if(!(this instanceof od))return new od(r,e,t,n,s);this.type=r==="axial"?2:3,this.coords=e,this.colors=t,RF.call(this,n,s)}function Mu(r,e,t,n,s){if(!(this instanceof Mu))return new Mu(r,e,t,n,s);this.boundingBox=r,this.xStep=e,this.yStep=t,this.stream="",this.cloneIndex=0,RF.call(this,n,s)}function kt(r){var e,t=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],s=arguments[2],i=arguments[3],a=[],o=1,l=16,c="S",A=null;nn(r=r||{})==="object"&&(t=r.orientation,n=r.unit||n,s=r.format||s,i=r.compress||r.compressPdf||i,(A=r.encryption||null)!==null&&(A.userPassword=A.userPassword||"",A.ownerPassword=A.ownerPassword||"",A.userPermissions=A.userPermissions||[]),o=typeof r.userUnit=="number"?Math.abs(r.userUnit):1,r.precision!==void 0&&(e=r.precision),r.floatPrecision!==void 0&&(l=r.floatPrecision),c=r.defaultPathOperation||"S"),a=r.filters||(i===!0?["FlateEncode"]:a),n=n||"mm",t=(""+(t||"P")).toLowerCase();var d=r.putOnlyUsedFonts||!1,h={},u={internal:{},__private__:{}};u.__private__.PubSub=PS;var p="1.3",f=u.__private__.getPdfVersion=function(){return p};u.__private__.setPdfVersion=function(U){p=U};var g={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};u.__private__.getPageFormats=function(){return g};var m=u.__private__.getPageFormat=function(U){return g[U]};s=s||"a4";var x="compat",S="advanced",B=x;function F(){this.saveGraphicsState(),G(new Ht(wt,0,0,-wt,0,so()*wt).toString()+" cm"),this.setFontSize(this.getFontSize()/wt),c="n",B=S}function N(){this.restoreGraphicsState(),c="S",B=x}var E=u.__private__.combineFontStyleAndFontWeight=function(U,q){if(U=="bold"&&q=="normal"||U=="bold"&&q==400||U=="normal"&&q=="italic"||U=="bold"&&q=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return q&&(U=q==400||q==="normal"?U==="italic"?"italic":"normal":q!=700&&q!=="bold"||U!=="normal"?(q==700?"bold":q)+""+U:"bold"),U};u.advancedAPI=function(U){var q=B===x;return q&&F.call(this),typeof U!="function"||(U(this),q&&N.call(this)),this},u.compatAPI=function(U){var q=B===S;return q&&N.call(this),typeof U!="function"||(U(this),q&&F.call(this)),this},u.isAdvancedAPI=function(){return B===S};var w,v=function(U){if(B!==S)throw new Error(U+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},I=u.roundToPrecision=u.__private__.roundToPrecision=function(U,q){var ge=e||q;if(isNaN(U)||isNaN(ge))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return U.toFixed(ge).replace(/0+$/,"")};w=u.hpf=u.__private__.hpf=typeof l=="number"?function(U){if(isNaN(U))throw new Error("Invalid argument passed to jsPDF.hpf");return I(U,l)}:l==="smart"?function(U){if(isNaN(U))throw new Error("Invalid argument passed to jsPDF.hpf");return I(U,U>-1&&U<1?16:5)}:function(U){if(isNaN(U))throw new Error("Invalid argument passed to jsPDF.hpf");return I(U,16)};var k=u.f2=u.__private__.f2=function(U){if(isNaN(U))throw new Error("Invalid argument passed to jsPDF.f2");return I(U,2)},_=u.__private__.f3=function(U){if(isNaN(U))throw new Error("Invalid argument passed to jsPDF.f3");return I(U,3)},T=u.scale=u.__private__.scale=function(U){if(isNaN(U))throw new Error("Invalid argument passed to jsPDF.scale");return B===x?U*wt:B===S?U:void 0},L=function(U){return T((function(q){return B===x?so()-q:B===S?q:void 0})(U))};u.__private__.setPrecision=u.setPrecision=function(U){typeof parseInt(U,10)=="number"&&(e=parseInt(U,10))};var K,se="00000000000000000000000000000000",X=u.__private__.getFileId=function(){return se},$=u.__private__.setFileId=function(U){return se=U!==void 0&&/^[a-fA-F0-9]{32}$/.test(U)?U.toUpperCase():se.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),A!==null&&(Zr=new Cu(A.userPermissions,A.userPassword,A.ownerPassword,se)),se};u.setFileId=function(U){return $(U),this},u.getFileId=function(){return X()};var V=u.__private__.convertDateToPDFDate=function(U){var q=U.getTimezoneOffset(),ge=q<0?"+":"-",_e=Math.floor(Math.abs(q/60)),Te=Math.abs(q%60),$e=[ge,H(_e),"'",H(Te),"'"].join("");return["D:",U.getFullYear(),H(U.getMonth()+1),H(U.getDate()),H(U.getHours()),H(U.getMinutes()),H(U.getSeconds()),$e].join("")},he=u.__private__.convertPDFDateToDate=function(U){var q=parseInt(U.substr(2,4),10),ge=parseInt(U.substr(6,2),10)-1,_e=parseInt(U.substr(8,2),10),Te=parseInt(U.substr(10,2),10),$e=parseInt(U.substr(12,2),10),Ye=parseInt(U.substr(14,2),10);return new Date(q,ge,_e,Te,$e,Ye,0)},z=u.__private__.setCreationDate=function(U){var q;if(U===void 0&&(U=new Date),U instanceof Date)q=V(U);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(U))throw new Error("Invalid argument passed to jsPDF.setCreationDate");q=U}return K=q},M=u.__private__.getCreationDate=function(U){var q=K;return U==="jsDate"&&(q=he(K)),q};u.setCreationDate=function(U){return z(U),this},u.getCreationDate=function(U){return M(U)};var O,H=u.__private__.padd2=function(U){return("0"+parseInt(U)).slice(-2)},J=u.__private__.padd2Hex=function(U){return("00"+(U=U.toString())).substr(U.length)},de=0,ie=[],le=[],fe=0,ve=[],Ce=[],Be=!1,Qe=le;u.__private__.setCustomOutputDestination=function(U){Be=!0,Qe=U};var D=function(U){Be||(Qe=U)};u.__private__.resetCustomOutputDestination=function(){Be=!1,Qe=le};var G=u.__private__.out=function(U){return U=U.toString(),fe+=U.length+1,Qe.push(U),Qe},ce=u.__private__.write=function(U){return G(arguments.length===1?U.toString():Array.prototype.join.call(arguments," "))},Z=u.__private__.getArrayBuffer=function(U){for(var q=U.length,ge=new ArrayBuffer(q),_e=new Uint8Array(ge);q--;)_e[q]=U.charCodeAt(q);return ge},W=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];u.__private__.getStandardFonts=function(){return W};var ee=r.fontSize||16;u.__private__.setFontSize=u.setFontSize=function(U){return ee=B===S?U/wt:U,this};var ye,xe=u.__private__.getFontSize=u.getFontSize=function(){return B===x?ee:ee*wt},we=r.R2L||!1;u.__private__.setR2L=u.setR2L=function(U){return we=U,this},u.__private__.getR2L=u.getR2L=function(){return we};var Ee,Ne=u.__private__.setZoomMode=function(U){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(U))ye=U;else if(isNaN(U)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(U)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+U+'" is not recognized.');ye=U}else ye=parseInt(U,10)};u.__private__.getZoomMode=function(){return ye};var Ue,je=u.__private__.setPageMode=function(U){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(U)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+U+'" is not recognized.');Ee=U};u.__private__.getPageMode=function(){return Ee};var st=u.__private__.setLayoutMode=function(U){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(U)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+U+'" is not recognized.');Ue=U};u.__private__.getLayoutMode=function(){return Ue},u.__private__.setDisplayMode=u.setDisplayMode=function(U,q,ge){return Ne(U),st(q),je(ge),this};var Ze={title:"",subject:"",author:"",keywords:"",creator:""};u.__private__.getDocumentProperty=function(U){if(Object.keys(Ze).indexOf(U)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Ze[U]},u.__private__.getDocumentProperties=function(){return Ze},u.__private__.setDocumentProperties=u.setProperties=u.setDocumentProperties=function(U){for(var q in Ze)Ze.hasOwnProperty(q)&&U[q]&&(Ze[q]=U[q]);return this},u.__private__.setDocumentProperty=function(U,q){if(Object.keys(Ze).indexOf(U)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Ze[U]=q};var ct,wt,it,lt,tt,rt={},ft={},St=[],yt={},jt={},Rt={},wr={},Qr=null,Lt=0,Ut=[],mr=new PS(u),gs=r.hotfixes||[],Pn={},hi={},Bs=[],Ht=function U(q,ge,_e,Te,$e,Ye){if(!(this instanceof U))return new U(q,ge,_e,Te,$e,Ye);isNaN(q)&&(q=1),isNaN(ge)&&(ge=0),isNaN(_e)&&(_e=0),isNaN(Te)&&(Te=1),isNaN($e)&&($e=0),isNaN(Ye)&&(Ye=0),this._matrix=[q,ge,_e,Te,$e,Ye]};Object.defineProperty(Ht.prototype,"sx",{get:function(){return this._matrix[0]},set:function(U){this._matrix[0]=U}}),Object.defineProperty(Ht.prototype,"shy",{get:function(){return this._matrix[1]},set:function(U){this._matrix[1]=U}}),Object.defineProperty(Ht.prototype,"shx",{get:function(){return this._matrix[2]},set:function(U){this._matrix[2]=U}}),Object.defineProperty(Ht.prototype,"sy",{get:function(){return this._matrix[3]},set:function(U){this._matrix[3]=U}}),Object.defineProperty(Ht.prototype,"tx",{get:function(){return this._matrix[4]},set:function(U){this._matrix[4]=U}}),Object.defineProperty(Ht.prototype,"ty",{get:function(){return this._matrix[5]},set:function(U){this._matrix[5]=U}}),Object.defineProperty(Ht.prototype,"a",{get:function(){return this._matrix[0]},set:function(U){this._matrix[0]=U}}),Object.defineProperty(Ht.prototype,"b",{get:function(){return this._matrix[1]},set:function(U){this._matrix[1]=U}}),Object.defineProperty(Ht.prototype,"c",{get:function(){return this._matrix[2]},set:function(U){this._matrix[2]=U}}),Object.defineProperty(Ht.prototype,"d",{get:function(){return this._matrix[3]},set:function(U){this._matrix[3]=U}}),Object.defineProperty(Ht.prototype,"e",{get:function(){return this._matrix[4]},set:function(U){this._matrix[4]=U}}),Object.defineProperty(Ht.prototype,"f",{get:function(){return this._matrix[5]},set:function(U){this._matrix[5]=U}}),Object.defineProperty(Ht.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Ht.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Ht.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Ht.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Ht.prototype.join=function(U){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(w).join(U)},Ht.prototype.multiply=function(U){var q=U.sx*this.sx+U.shy*this.shx,ge=U.sx*this.shy+U.shy*this.sy,_e=U.shx*this.sx+U.sy*this.shx,Te=U.shx*this.shy+U.sy*this.sy,$e=U.tx*this.sx+U.ty*this.shx+this.tx,Ye=U.tx*this.shy+U.ty*this.sy+this.ty;return new Ht(q,ge,_e,Te,$e,Ye)},Ht.prototype.decompose=function(){var U=this.sx,q=this.shy,ge=this.shx,_e=this.sy,Te=this.tx,$e=this.ty,Ye=Math.sqrt(U*U+q*q),vt=(U/=Ye)*ge+(q/=Ye)*_e;ge-=U*vt,_e-=q*vt;var Et=Math.sqrt(ge*ge+_e*_e);return vt/=Et,U*(_e/=Et)<q*(ge/=Et)&&(U=-U,q=-q,vt=-vt,Ye=-Ye),{scale:new Ht(Ye,0,0,Et,0,0),translate:new Ht(1,0,0,1,Te,$e),rotate:new Ht(U,q,-q,U,0,0),skew:new Ht(1,0,vt,1,0,0)}},Ht.prototype.toString=function(U){return this.join(" ")},Ht.prototype.inversed=function(){var U=this.sx,q=this.shy,ge=this.shx,_e=this.sy,Te=this.tx,$e=this.ty,Ye=1/(U*_e-q*ge),vt=_e*Ye,Et=-q*Ye,$t=-ge*Ye,Mt=U*Ye;return new Ht(vt,Et,$t,Mt,-vt*Te-$t*$e,-Et*Te-Mt*$e)},Ht.prototype.applyToPoint=function(U){var q=U.x*this.sx+U.y*this.shx+this.tx,ge=U.x*this.shy+U.y*this.sy+this.ty;return new ga(q,ge)},Ht.prototype.applyToRectangle=function(U){var q=this.applyToPoint(U),ge=this.applyToPoint(new ga(U.x+U.w,U.y+U.h));return new bc(q.x,q.y,ge.x-q.x,ge.y-q.y)},Ht.prototype.clone=function(){var U=this.sx,q=this.shy,ge=this.shx,_e=this.sy,Te=this.tx,$e=this.ty;return new Ht(U,q,ge,_e,Te,$e)},u.Matrix=Ht;var da=u.matrixMult=function(U,q){return q.multiply(U)},Cs=new Ht(1,0,0,1,0,0);u.unitMatrix=u.identityMatrix=Cs;var Xs=function(U,q){if(!jt[U]){var ge=(q instanceof od?"Sh":"P")+(Object.keys(yt).length+1).toString(10);q.id=ge,jt[U]=ge,yt[ge]=q,mr.publish("addPattern",q)}};u.ShadingPattern=od,u.TilingPattern=Mu,u.addShadingPattern=function(U,q){return v("addShadingPattern()"),Xs(U,q),this},u.beginTilingPattern=function(U){v("beginTilingPattern()"),Uo(U.boundingBox[0],U.boundingBox[1],U.boundingBox[2]-U.boundingBox[0],U.boundingBox[3]-U.boundingBox[1],U.matrix)},u.endTilingPattern=function(U,q){v("endTilingPattern()"),q.stream=Ce[O].join(`
`),Xs(U,q),mr.publish("endTilingPattern",q),Bs.pop().restore()};var Js,Jr=u.__private__.newObject=function(){var U=sn();return Xn(U,!0),U},sn=u.__private__.newObjectDeferred=function(){return de++,ie[de]=function(){return fe},de},Xn=function(U,q){return q=typeof q=="boolean"&&q,ie[U]=fe,q&&G(U+" 0 obj"),U},Ss=u.__private__.newProgressObject=function(){var U={objId:sn(),content:""};return ve.push(U),U},ua=sn(),Zs=sn(),ei=u.__private__.decodeColorString=function(U){var q=U.split(" ");if(q.length!==2||q[1]!=="g"&&q[1]!=="G")q.length!==5||q[4]!=="k"&&q[4]!=="K"||(q=[(1-q[0])*(1-q[3]),(1-q[1])*(1-q[3]),(1-q[2])*(1-q[3]),"r"]);else{var ge=parseFloat(q[0]);q=[ge,ge,ge,"r"]}for(var _e="#",Te=0;Te<3;Te++)_e+=("0"+Math.floor(255*parseFloat(q[Te])).toString(16)).slice(-2);return _e},Ps=u.__private__.encodeColorString=function(U){var q;typeof U=="string"&&(U={ch1:U});var ge=U.ch1,_e=U.ch2,Te=U.ch3,$e=U.ch4,Ye=U.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof ge=="string"&&ge.charAt(0)!=="#"){var vt=new PF(ge);if(vt.ok)ge=vt.toHex();else if(!/^\d*\.?\d*$/.test(ge))throw new Error('Invalid color "'+ge+'" passed to jsPDF.encodeColorString.')}if(typeof ge=="string"&&/^#[0-9A-Fa-f]{3}$/.test(ge)&&(ge="#"+ge[1]+ge[1]+ge[2]+ge[2]+ge[3]+ge[3]),typeof ge=="string"&&/^#[0-9A-Fa-f]{6}$/.test(ge)){var Et=parseInt(ge.substr(1),16);ge=Et>>16&255,_e=Et>>8&255,Te=255&Et}if(_e===void 0||$e===void 0&&ge===_e&&_e===Te)q=typeof ge=="string"?ge+" "+Ye[0]:U.precision===2?k(ge/255)+" "+Ye[0]:_(ge/255)+" "+Ye[0];else if($e===void 0||nn($e)==="object"){if($e&&!isNaN($e.a)&&$e.a===0)return["1.","1.","1.",Ye[1]].join(" ");q=typeof ge=="string"?[ge,_e,Te,Ye[1]].join(" "):U.precision===2?[k(ge/255),k(_e/255),k(Te/255),Ye[1]].join(" "):[_(ge/255),_(_e/255),_(Te/255),Ye[1]].join(" ")}else q=typeof ge=="string"?[ge,_e,Te,$e,Ye[2]].join(" "):U.precision===2?[k(ge),k(_e),k(Te),k($e),Ye[2]].join(" "):[_(ge),_(_e),_(Te),_($e),Ye[2]].join(" ");return q},ti=u.__private__.getFilters=function(){return a},Ds=u.__private__.putStream=function(U){var q=(U=U||{}).data||"",ge=U.filters||ti(),_e=U.alreadyAppliedFilters||[],Te=U.addLength1||!1,$e=q.length,Ye=U.objectId,vt=function(R){return R};if(A!==null&&Ye===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");A!==null&&(vt=Zr.encryptor(Ye,0));var Et={};ge===!0&&(ge=["FlateEncode"]);var $t=U.ProgressKeyValues||[],Mt=(Et=kt.API.processDataByFilters!==void 0?kt.API.processDataByFilters(q,ge):{data:q,reverseChain:[]}).reverseChain+(Array.isArray(_e)?_e.join(" "):_e.toString());if(Et.data.length!==0&&($t.push({key:"Length",value:Et.data.length}),Te===!0&&$t.push({key:"Length1",value:$e})),Mt.length!=0)if(Mt.split("/").length-1==1)$t.push({key:"Filter",value:Mt});else{$t.push({key:"Filter",value:"["+Mt+"]"});for(var Ur=0;Ur<$t.length;Ur+=1)if($t[Ur].key==="DecodeParms"){for(var gn=[],ln=0;ln<Et.reverseChain.split("/").length-1;ln+=1)gn.push("null");gn.push($t[Ur].value),$t[Ur].value="["+gn.join(" ")+"]"}}G("<<");for(var y=0;y<$t.length;y++)G("/"+$t[y].key+" "+$t[y].value);G(">>"),Et.data.length!==0&&(G("stream"),G(vt(Et.data)),G("endstream"))},Rs=u.__private__.putPage=function(U){var q=U.number,ge=U.data,_e=U.objId,Te=U.contentsObjId;Xn(_e,!0),G("<</Type /Page"),G("/Parent "+U.rootDictionaryObjId+" 0 R"),G("/Resources "+U.resourceDictionaryObjId+" 0 R"),G("/MediaBox ["+parseFloat(w(U.mediaBox.bottomLeftX))+" "+parseFloat(w(U.mediaBox.bottomLeftY))+" "+w(U.mediaBox.topRightX)+" "+w(U.mediaBox.topRightY)+"]"),U.cropBox!==null&&G("/CropBox ["+w(U.cropBox.bottomLeftX)+" "+w(U.cropBox.bottomLeftY)+" "+w(U.cropBox.topRightX)+" "+w(U.cropBox.topRightY)+"]"),U.bleedBox!==null&&G("/BleedBox ["+w(U.bleedBox.bottomLeftX)+" "+w(U.bleedBox.bottomLeftY)+" "+w(U.bleedBox.topRightX)+" "+w(U.bleedBox.topRightY)+"]"),U.trimBox!==null&&G("/TrimBox ["+w(U.trimBox.bottomLeftX)+" "+w(U.trimBox.bottomLeftY)+" "+w(U.trimBox.topRightX)+" "+w(U.trimBox.topRightY)+"]"),U.artBox!==null&&G("/ArtBox ["+w(U.artBox.bottomLeftX)+" "+w(U.artBox.bottomLeftY)+" "+w(U.artBox.topRightX)+" "+w(U.artBox.topRightY)+"]"),typeof U.userUnit=="number"&&U.userUnit!==1&&G("/UserUnit "+U.userUnit),mr.publish("putPage",{objId:_e,pageContext:Ut[q],pageNumber:q,page:ge}),G("/Contents "+Te+" 0 R"),G(">>"),G("endobj");var $e=ge.join(`
`);return B===S&&($e+=`
Q`),Xn(Te,!0),Ds({data:$e,filters:ti(),objectId:Te}),G("endobj"),_e},Os=u.__private__.putPages=function(){var U,q,ge=[];for(U=1;U<=Lt;U++)Ut[U].objId=sn(),Ut[U].contentsObjId=sn();for(U=1;U<=Lt;U++)ge.push(Rs({number:U,data:Ce[U],objId:Ut[U].objId,contentsObjId:Ut[U].contentsObjId,mediaBox:Ut[U].mediaBox,cropBox:Ut[U].cropBox,bleedBox:Ut[U].bleedBox,trimBox:Ut[U].trimBox,artBox:Ut[U].artBox,userUnit:Ut[U].userUnit,rootDictionaryObjId:ua,resourceDictionaryObjId:Zs}));Xn(ua,!0),G("<</Type /Pages");var _e="/Kids [";for(q=0;q<Lt;q++)_e+=ge[q]+" 0 R ";G(_e+"]"),G("/Count "+Lt),G(">>"),G("endobj"),mr.publish("postPutPages")},Qs=function(U){mr.publish("putFont",{font:U,out:G,newObject:Jr,putStream:Ds}),U.isAlreadyPutted!==!0&&(U.objectNumber=Jr(),G("<<"),G("/Type /Font"),G("/BaseFont /"+Su(U.postScriptName)),G("/Subtype /Type1"),typeof U.encoding=="string"&&G("/Encoding /"+U.encoding),G("/FirstChar 32"),G("/LastChar 255"),G(">>"),G("endobj"))},ji=function(U){U.objectNumber=Jr();var q=[];q.push({key:"Type",value:"/XObject"}),q.push({key:"Subtype",value:"/Form"}),q.push({key:"BBox",value:"["+[w(U.x),w(U.y),w(U.x+U.width),w(U.y+U.height)].join(" ")+"]"}),q.push({key:"Matrix",value:"["+U.matrix.toString()+"]"});var ge=U.pages[1].join(`
`);Ds({data:ge,ProgressKeyValues:q,objectId:U.objectNumber}),G("endobj")},Vi=function(U,q){q||(q=21);var ge=Jr(),_e=(function(Ye,vt){var Et,$t=[],Mt=1/(vt-1);for(Et=0;Et<1;Et+=Mt)$t.push(Et);if($t.push(1),Ye[0].offset!=0){var Ur={offset:0,color:Ye[0].color};Ye.unshift(Ur)}if(Ye[Ye.length-1].offset!=1){var gn={offset:1,color:Ye[Ye.length-1].color};Ye.push(gn)}for(var ln="",y=0,R=0;R<$t.length;R++){for(Et=$t[R];Et>Ye[y+1].offset;)y++;var j=Ye[y].offset,oe=(Et-j)/(Ye[y+1].offset-j),Le=Ye[y].color,Re=Ye[y+1].color;ln+=J(Math.round((1-oe)*Le[0]+oe*Re[0]).toString(16))+J(Math.round((1-oe)*Le[1]+oe*Re[1]).toString(16))+J(Math.round((1-oe)*Le[2]+oe*Re[2]).toString(16))}return ln.trim()})(U.colors,q),Te=[];Te.push({key:"FunctionType",value:"0"}),Te.push({key:"Domain",value:"[0.0 1.0]"}),Te.push({key:"Size",value:"["+q+"]"}),Te.push({key:"BitsPerSample",value:"8"}),Te.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Te.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ds({data:_e,ProgressKeyValues:Te,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:ge}),G("endobj"),U.objectNumber=Jr(),G("<< /ShadingType "+U.type),G("/ColorSpace /DeviceRGB");var $e="/Coords ["+w(parseFloat(U.coords[0]))+" "+w(parseFloat(U.coords[1]))+" ";U.type===2?$e+=w(parseFloat(U.coords[2]))+" "+w(parseFloat(U.coords[3])):$e+=w(parseFloat(U.coords[2]))+" "+w(parseFloat(U.coords[3]))+" "+w(parseFloat(U.coords[4]))+" "+w(parseFloat(U.coords[5])),G($e+="]"),U.matrix&&G("/Matrix ["+U.matrix.toString()+"]"),G("/Function "+ge+" 0 R"),G("/Extend [true true]"),G(">>"),G("endobj")},$i=function(U,q){var ge=sn(),_e=Jr();q.push({resourcesOid:ge,objectOid:_e}),U.objectNumber=_e;var Te=[];Te.push({key:"Type",value:"/Pattern"}),Te.push({key:"PatternType",value:"1"}),Te.push({key:"PaintType",value:"1"}),Te.push({key:"TilingType",value:"1"}),Te.push({key:"BBox",value:"["+U.boundingBox.map(w).join(" ")+"]"}),Te.push({key:"XStep",value:w(U.xStep)}),Te.push({key:"YStep",value:w(U.yStep)}),Te.push({key:"Resources",value:ge+" 0 R"}),U.matrix&&Te.push({key:"Matrix",value:"["+U.matrix.toString()+"]"}),Ds({data:U.stream,ProgressKeyValues:Te,objectId:U.objectNumber}),G("endobj")},ha=function(U){for(var q in U.objectNumber=Jr(),G("<<"),U)switch(q){case"opacity":G("/ca "+k(U[q]));break;case"stroke-opacity":G("/CA "+k(U[q]))}G(">>"),G("endobj")},Gi=function(U){Xn(U.resourcesOid,!0),G("<<"),G("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var q in G("/Font <<"),rt)rt.hasOwnProperty(q)&&(d===!1||d===!0&&h.hasOwnProperty(q))&&G("/"+q+" "+rt[q].objectNumber+" 0 R");G(">>")})(),(function(){if(Object.keys(yt).length>0){for(var q in G("/Shading <<"),yt)yt.hasOwnProperty(q)&&yt[q]instanceof od&&yt[q].objectNumber>=0&&G("/"+q+" "+yt[q].objectNumber+" 0 R");mr.publish("putShadingPatternDict"),G(">>")}})(),(function(q){if(Object.keys(yt).length>0){for(var ge in G("/Pattern <<"),yt)yt.hasOwnProperty(ge)&&yt[ge]instanceof u.TilingPattern&&yt[ge].objectNumber>=0&&yt[ge].objectNumber<q&&G("/"+ge+" "+yt[ge].objectNumber+" 0 R");mr.publish("putTilingPatternDict"),G(">>")}})(U.objectOid),(function(){if(Object.keys(Rt).length>0){var q;for(q in G("/ExtGState <<"),Rt)Rt.hasOwnProperty(q)&&Rt[q].objectNumber>=0&&G("/"+q+" "+Rt[q].objectNumber+" 0 R");mr.publish("putGStateDict"),G(">>")}})(),(function(){for(var q in G("/XObject <<"),Pn)Pn.hasOwnProperty(q)&&Pn[q].objectNumber>=0&&G("/"+q+" "+Pn[q].objectNumber+" 0 R");mr.publish("putXobjectDict"),G(">>")})(),G(">>"),G("endobj")},ks=function(U){ft[U.fontName]=ft[U.fontName]||{},ft[U.fontName][U.fontStyle]=U.id},zi=function(U,q,ge,_e,Te){var $e={id:"F"+(Object.keys(rt).length+1).toString(10),postScriptName:U,fontName:q,fontStyle:ge,encoding:_e,isStandardFont:Te||!1,metadata:{}};return mr.publish("addFont",{font:$e,instance:this}),rt[$e.id]=$e,ks($e),$e.id},Fn=u.__private__.pdfEscape=u.pdfEscape=function(U,q){return(function(ge,_e){var Te,$e,Ye,vt,Et,$t,Mt,Ur,gn;if(Ye=(_e=_e||{}).sourceEncoding||"Unicode",Et=_e.outputEncoding,(_e.autoencode||Et)&&rt[ct].metadata&&rt[ct].metadata[Ye]&&rt[ct].metadata[Ye].encoding&&(vt=rt[ct].metadata[Ye].encoding,!Et&&rt[ct].encoding&&(Et=rt[ct].encoding),!Et&&vt.codePages&&(Et=vt.codePages[0]),typeof Et=="string"&&(Et=vt[Et]),Et)){for(Mt=!1,$t=[],Te=0,$e=ge.length;Te<$e;Te++)(Ur=Et[ge.charCodeAt(Te)])?$t.push(String.fromCharCode(Ur)):$t.push(ge[Te]),$t[Te].charCodeAt(0)>>8&&(Mt=!0);ge=$t.join("")}for(Te=ge.length;Mt===void 0&&Te!==0;)ge.charCodeAt(Te-1)>>8&&(Mt=!0),Te--;if(!Mt)return ge;for($t=_e.noBOM?[]:[254,255],Te=0,$e=ge.length;Te<$e;Te++){if((gn=(Ur=ge.charCodeAt(Te))>>8)>>8)throw new Error("Character at position "+Te+" of string '"+ge+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");$t.push(gn),$t.push(Ur-(gn<<8))}return String.fromCharCode.apply(void 0,$t)})(U,q).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Hs=u.__private__.beginPage=function(U){Ce[++Lt]=[],Ut[Lt]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(U[0]),topRightY:Number(U[1])}},ri(Lt),D(Ce[O])},Ki=function(U,q){var ge,_e,Te;switch(t=q||t,typeof U=="string"&&(ge=m(U.toLowerCase()),Array.isArray(ge)&&(_e=ge[0],Te=ge[1])),Array.isArray(U)&&(_e=U[0]*wt,Te=U[1]*wt),isNaN(_e)&&(_e=s[0],Te=s[1]),(_e>14400||Te>14400)&&(un.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),_e=Math.min(14400,_e),Te=Math.min(14400,Te)),s=[_e,Te],t.substr(0,1)){case"l":Te>_e&&(s=[Te,_e]);break;case"p":_e>Te&&(s=[Te,_e])}Hs(s),QA(Xi),G(gc),Ji!==0&&G(Ji+" J"),mc!==0&&G(mc+" j"),mr.publish("addPage",{pageNumber:Lt})},ps=function(U){U>0&&U<=Lt&&(Ce.splice(U,1),Ut.splice(U,1),Lt--,O>Lt&&(O=Lt),this.setPage(O))},ri=function(U){U>0&&U<=Lt&&(O=U)},ko=u.__private__.getNumberOfPages=u.getNumberOfPages=function(){return Ce.length-1},Eo=function(U,q,ge){var _e,Te=void 0;return ge=ge||{},U=U!==void 0?U:rt[ct].fontName,q=q!==void 0?q:rt[ct].fontStyle,_e=U.toLowerCase(),ft[_e]!==void 0&&ft[_e][q]!==void 0?Te=ft[_e][q]:ft[U]!==void 0&&ft[U][q]!==void 0?Te=ft[U][q]:ge.disableWarning===!1&&un.warn("Unable to look up font label for font '"+U+"', '"+q+"'. Refer to getFontList() for available fonts."),Te||ge.noFallback||(Te=ft.times[q])==null&&(Te=ft.times.normal),Te},fa=u.__private__.putInfo=function(){var U=Jr(),q=function(_e){return _e};for(var ge in A!==null&&(q=Zr.encryptor(U,0)),G("<<"),G("/Producer ("+Fn(q("jsPDF "+kt.version))+")"),Ze)Ze.hasOwnProperty(ge)&&Ze[ge]&&G("/"+ge.substr(0,1).toUpperCase()+ge.substr(1)+" ("+Fn(q(Ze[ge]))+")");G("/CreationDate ("+Fn(q(K))+")"),G(">>"),G("endobj")},Ln=u.__private__.putCatalog=function(U){var q=(U=U||{}).rootDictionaryObjId||ua;switch(Jr(),G("<<"),G("/Type /Catalog"),G("/Pages "+q+" 0 R"),ye||(ye="fullwidth"),ye){case"fullwidth":G("/OpenAction [3 0 R /FitH null]");break;case"fullheight":G("/OpenAction [3 0 R /FitV null]");break;case"fullpage":G("/OpenAction [3 0 R /Fit]");break;case"original":G("/OpenAction [3 0 R /XYZ null null 1]");break;default:var ge=""+ye;ge.substr(ge.length-1)==="%"&&(ye=parseInt(ye)/100),typeof ye=="number"&&G("/OpenAction [3 0 R /XYZ null null "+k(ye)+"]")}switch(Ue||(Ue="continuous"),Ue){case"continuous":G("/PageLayout /OneColumn");break;case"single":G("/PageLayout /SinglePage");break;case"two":case"twoleft":G("/PageLayout /TwoColumnLeft");break;case"tworight":G("/PageLayout /TwoColumnRight")}Ee&&G("/PageMode /"+Ee),mr.publish("putCatalog"),G(">>"),G("endobj")},Cr=u.__private__.putTrailer=function(){G("trailer"),G("<<"),G("/Size "+(de+1)),G("/Root "+de+" 0 R"),G("/Info "+(de-1)+" 0 R"),A!==null&&G("/Encrypt "+Zr.oid+" 0 R"),G("/ID [ <"+se+"> <"+se+"> ]"),G(">>")},qi=u.__private__.putHeader=function(){G("%PDF-"+p),G("%")},Wi=u.__private__.putXRef=function(){var U="0000000000";G("xref"),G("0 "+(de+1)),G("0000000000 65535 f ");for(var q=1;q<=de;q++)typeof ie[q]=="function"?G((U+ie[q]()).slice(-10)+" 00000 n "):ie[q]!==void 0?G((U+ie[q]).slice(-10)+" 00000 n "):G("0000000000 00000 n ")},ni=u.__private__.buildDocument=function(){var U;de=0,fe=0,le=[],ie=[],ve=[],ua=sn(),Zs=sn(),D(le),mr.publish("buildDocument"),qi(),Os(),(function(){mr.publish("putProgressObjects");for(var ge=0;ge<ve.length;ge++){var _e=ve[ge];Xn(_e.objId,!0),G(_e.content),G("endobj")}mr.publish("postPutProgressObjects")})(),U=[],(function(){for(var ge in rt)rt.hasOwnProperty(ge)&&(d===!1||d===!0&&h.hasOwnProperty(ge))&&Qs(rt[ge])})(),(function(){var ge;for(ge in Rt)Rt.hasOwnProperty(ge)&&ha(Rt[ge])})(),(function(){for(var ge in Pn)Pn.hasOwnProperty(ge)&&ji(Pn[ge])})(),(function(ge){var _e;for(_e in yt)yt.hasOwnProperty(_e)&&(yt[_e]instanceof od?Vi(yt[_e]):yt[_e]instanceof Mu&&$i(yt[_e],ge))})(U),mr.publish("putResources"),U.forEach(Gi),Gi({resourcesOid:Zs,objectOid:Number.MAX_SAFE_INTEGER}),mr.publish("postPutResources"),A!==null&&(Zr.oid=Jr(),G("<<"),G("/Filter /Standard"),G("/V "+Zr.v),G("/R "+Zr.r),G("/U <"+Zr.toHexString(Zr.U)+">"),G("/O <"+Zr.toHexString(Zr.O)+">"),G("/P "+Zr.P),G(">>"),G("endobj")),fa(),Ln();var q=fe;return Wi(),Cr(),G("startxref"),G(""+q),G("%%EOF"),D(Ce[O]),le.join(`
`)},_r=u.__private__.getBlob=function(U){return new Blob([Z(U)],{type:"application/pdf"})},Jn=u.output=u.__private__.output=(Js=function(U,q){switch(typeof(q=q||{})=="string"?q={filename:q}:q.filename=q.filename||"generated.pdf",U){case void 0:return ni();case"save":u.save(q.filename);break;case"arraybuffer":return Z(ni());case"blob":return _r(ni());case"bloburi":case"bloburl":if(Zt.URL!==void 0&&typeof Zt.URL.createObjectURL=="function")return Zt.URL&&Zt.URL.createObjectURL(_r(ni()))||void 0;un.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var ge="",_e=ni();try{ge=US(_e)}catch{ge=US(unescape(encodeURIComponent(_e)))}return"data:application/pdf;filename="+q.filename+";base64,"+ge;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Zt)==="[object Window]"){var Te="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",$e=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';q.pdfObjectUrl&&(Te=q.pdfObjectUrl,$e="");var Ye='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Te+'"'+$e+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(q)+");<\/script></body></html>",vt=Zt.open();return vt!==null&&vt.document.write(Ye),vt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Zt)==="[object Window]"){var Et='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(q.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+q.filename+'" width="500px" height="400px" /></body></html>',$t=Zt.open();if($t!==null){$t.document.write(Et);var Mt=this;$t.document.documentElement.querySelector("#pdfViewer").onload=function(){$t.document.title=q.filename,$t.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Mt.output("bloburl"))}}return $t}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Zt)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Ur='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",q)+'"></iframe></body></html>',gn=Zt.open();if(gn!==null&&(gn.document.write(Ur),gn.document.title=q.filename),gn||typeof safari>"u")return gn;break;case"datauri":case"dataurl":return Zt.document.location.href=this.output("datauristring",q);default:return null}},Js.foo=function(){try{return Js.apply(this,arguments)}catch(ge){var U=ge.stack||"";~U.indexOf(" at ")&&(U=U.split(" at ")[1]);var q="Error in function "+U.split(`
`)[0].split("<")[0]+": "+ge.message;if(!Zt.console)throw new Error(q);Zt.console.error(q,ge),Zt.alert&&alert(q)}},Js.foo.bar=Js,Js.foo),Qn=function(U){return Array.isArray(gs)===!0&&gs.indexOf(U)>-1};switch(n){case"pt":wt=1;break;case"mm":wt=72/25.4;break;case"cm":wt=72/2.54;break;case"in":wt=72;break;case"px":wt=Qn("px_scaling")==1?.75:96/72;break;case"pc":case"em":wt=12;break;case"ex":wt=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);wt=n}var Zr=null;z(),$();var Io=u.__private__.getPageInfo=u.getPageInfo=function(U){if(isNaN(U)||U%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Ut[U].objId,pageNumber:U,pageContext:Ut[U]}},To=u.__private__.getPageInfoByObjId=function(U){if(isNaN(U)||U%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var q in Ut)if(Ut[q].objId===U)break;return Io(q)},hc=u.__private__.getCurrentPageInfo=u.getCurrentPageInfo=function(){return{objId:Ut[O].objId,pageNumber:O,pageContext:Ut[O]}};u.addPage=function(){return Ki.apply(this,arguments),this},u.setPage=function(){return ri.apply(this,arguments),D.call(this,Ce[O]),this},u.insertPage=function(U){return this.addPage(),this.movePage(O,U),this},u.movePage=function(U,q){var ge,_e;if(U>q){ge=Ce[U],_e=Ut[U];for(var Te=U;Te>q;Te--)Ce[Te]=Ce[Te-1],Ut[Te]=Ut[Te-1];Ce[q]=ge,Ut[q]=_e,this.setPage(q)}else if(U<q){ge=Ce[U],_e=Ut[U];for(var $e=U;$e<q;$e++)Ce[$e]=Ce[$e+1],Ut[$e]=Ut[$e+1];Ce[q]=ge,Ut[q]=_e,this.setPage(q)}return this},u.deletePage=function(){return ps.apply(this,arguments),this},u.__private__.text=u.text=function(U,q,ge,_e,Te){var $e,Ye,vt,Et,$t,Mt,Ur,gn,ln,y=(_e=_e||{}).scope||this;if(typeof U=="number"&&typeof q=="number"&&(typeof ge=="string"||Array.isArray(ge))){var R=ge;ge=q,q=U,U=R}if(arguments[3]instanceof Ht==0?(vt=arguments[4],Et=arguments[5],nn(Ur=arguments[3])==="object"&&Ur!==null||(typeof vt=="string"&&(Et=vt,vt=null),typeof Ur=="string"&&(Et=Ur,Ur=null),typeof Ur=="number"&&(vt=Ur,Ur=null),_e={flags:Ur,angle:vt,align:Et})):(v("The transform parameter of text() with a Matrix value"),ln=Te),isNaN(q)||isNaN(ge)||U==null)throw new Error("Invalid arguments passed to jsPDF.text");if(U.length===0)return y;var j,oe="",Le=typeof _e.lineHeightFactor=="number"?_e.lineHeightFactor:pl,Re=y.internal.scaleFactor;function at(qr){return qr=qr.split("	").join(Array(_e.TabLen||9).join(" ")),Fn(qr,Ur)}function Jt(qr){for(var An,es=qr.concat(),Es=[],Cl=es.length;Cl--;)typeof(An=es.shift())=="string"?Es.push(An):Array.isArray(qr)&&(An.length===1||An[1]===void 0&&An[2]===void 0)?Es.push(An[0]):Es.push([An[0],An[1],An[2]]);return Es}function cn(qr,An){var es;if(typeof qr=="string")es=An(qr)[0];else if(Array.isArray(qr)){for(var Es,Cl,Hh=qr.concat(),lu=[],mp=Hh.length;mp--;)typeof(Es=Hh.shift())=="string"?lu.push(An(Es)[0]):Array.isArray(Es)&&typeof Es[0]=="string"&&(Cl=An(Es[0],Es[1],Es[2]),lu.push([Cl[0],Cl[1],Cl[2]]));es=lu}return es}var Sr=!1,pn=!0;if(typeof U=="string")Sr=!0;else if(Array.isArray(U)){var js=U.concat();Ye=[];for(var Pi,_n=js.length;_n--;)(typeof(Pi=js.shift())!="string"||Array.isArray(Pi)&&typeof Pi[0]!="string")&&(pn=!1);Sr=pn}if(Sr===!1)throw new Error('Type of text must be string or Array. "'+U+'" is not recognized.');typeof U=="string"&&(U=U.match(/[\r?\n]/)?U.split(/\r\n|\r|\n/g):[U]);var gi=ee/y.internal.scaleFactor,Ra=gi*(Le-1);switch(_e.baseline){case"bottom":ge-=Ra;break;case"top":ge+=gi-Ra;break;case"hanging":ge+=gi-2*Ra;break;case"middle":ge+=gi/2-Ra}if((Mt=_e.maxWidth||0)>0&&(typeof U=="string"?U=y.splitTextToSize(U,Mt):Object.prototype.toString.call(U)==="[object Array]"&&(U=U.reduce(function(qr,An){return qr.concat(y.splitTextToSize(An,Mt))},[]))),$e={text:U,x:q,y:ge,options:_e,mutex:{pdfEscape:Fn,activeFontKey:ct,fonts:rt,activeFontSize:ee}},mr.publish("preProcessText",$e),U=$e.text,vt=(_e=$e.options).angle,ln instanceof Ht==0&&vt&&typeof vt=="number"){vt*=Math.PI/180,_e.rotationDirection===0&&(vt=-vt),B===S&&(vt=-vt);var xl=Math.cos(vt),Uh=Math.sin(vt);ln=new Ht(xl,Uh,-Uh,xl,0,0)}else vt&&vt instanceof Ht&&(ln=vt);B!==S||ln||(ln=Cs),($t=_e.charSpace||yl)!==void 0&&(oe+=w(T($t))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(gn=_e.horizontalScale)!==void 0&&(oe+=w(100*gn)+` Tz
`),_e.lang;var Hn=-1,_l=_e.renderingMode!==void 0?_e.renderingMode:_e.stroke,au=y.internal.getCurrentPageInfo().pageContext;switch(_l){case 0:case!1:case"fill":Hn=0;break;case 1:case!0:case"stroke":Hn=1;break;case 2:case"fillThenStroke":Hn=2;break;case 3:case"invisible":Hn=3;break;case 4:case"fillAndAddForClipping":Hn=4;break;case 5:case"strokeAndAddPathForClipping":Hn=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Hn=6;break;case 7:case"addToPathForClipping":Hn=7}var gp=au.usedRenderingMode!==void 0?au.usedRenderingMode:-1;Hn!==-1?oe+=Hn+` Tr
`:gp!==-1&&(oe+=`0 Tr
`),Hn!==-1&&(au.usedRenderingMode=Hn),Et=_e.align||"left";var Oa,GA=ee*Le,Mh=y.internal.pageSize.getWidth(),Nh=rt[ct];$t=_e.charSpace||yl,Mt=_e.maxWidth||0,Ur=Object.assign({autoencode:!0,noBOM:!0},_e.flags);var wc=[],zA=function(qr){return y.getStringUnitWidth(qr,{font:Nh,charSpace:$t,fontSize:ee,doKerning:!1})*ee/Re};if(Object.prototype.toString.call(U)==="[object Array]"){var pa;Ye=Jt(U),Et!=="left"&&(Oa=Ye.map(zA));var ma,vc=0;if(Et==="right"){q-=Oa[0],U=[],_n=Ye.length;for(var Bl=0;Bl<_n;Bl++)Bl===0?(ma=Mi(q),pa=Pa(ge)):(ma=T(vc-Oa[Bl]),pa=-GA),U.push([Ye[Bl],ma,pa]),vc=Oa[Bl]}else if(Et==="center"){q-=Oa[0]/2,U=[],_n=Ye.length;for(var xc=0;xc<_n;xc++)xc===0?(ma=Mi(q),pa=Pa(ge)):(ma=T((vc-Oa[xc])/2),pa=-GA),U.push([Ye[xc],ma,pa]),vc=Oa[xc]}else if(Et==="left"){U=[],_n=Ye.length;for(var Ph=0;Ph<_n;Ph++)U.push(Ye[Ph])}else if(Et==="justify"&&Nh.encoding==="Identity-H"){U=[],_n=Ye.length,Mt=Mt!==0?Mt:Mh;for(var ou=0,Zn=0;Zn<_n;Zn++)if(pa=Zn===0?Pa(ge):-GA,ma=Zn===0?Mi(q):ou,Zn<_n-1){var pp=T((Mt-Oa[Zn])/(Ye[Zn].split(" ").length-1)),No=Ye[Zn].split(" ");U.push([No[0]+" ",ma,pa]),ou=0;for(var Po=1;Po<No.length;Po++){var Dh=(zA(No[Po-1]+" "+No[Po])-zA(No[Po]))*Re+pp;Po==No.length-1?U.push([No[Po],Dh,0]):U.push([No[Po]+" ",Dh,0]),ou-=Dh}}else U.push([Ye[Zn],ma,pa]);U.push(["",ou,0])}else{if(Et!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(U=[],_n=Ye.length,Mt=Mt!==0?Mt:Mh,Zn=0;Zn<_n;Zn++){pa=Zn===0?Pa(ge):-GA,ma=Zn===0?Mi(q):0;var Rh=Ye[Zn].split(" ").length-1,Oh=Rh>0?(Mt-Oa[Zn])/Rh:0;Zn<_n-1?wc.push(w(T(Oh))):wc.push(0),U.push([Ye[Zn],ma,pa])}}}(typeof _e.R2L=="boolean"?_e.R2L:we)===!0&&(U=cn(U,function(qr,An,es){return[qr.split("").reverse().join(""),An,es]})),$e={text:U,x:q,y:ge,options:_e,mutex:{pdfEscape:Fn,activeFontKey:ct,fonts:rt,activeFontSize:ee}},mr.publish("postProcessText",$e),U=$e.text,j=$e.mutex.isHex||!1;var Qh=rt[ct].encoding;Qh!=="WinAnsiEncoding"&&Qh!=="StandardEncoding"||(U=cn(U,function(qr,An,es){return[at(qr),An,es]})),Ye=Jt(U),U=[];for(var _c,Bc,Cc,KA=Array.isArray(Ye[0])?1:0,Sc="",qA=function(qr,An,es){var Es="";return es instanceof Ht?(es=typeof _e.angle=="number"?da(es,new Ht(1,0,0,1,qr,An)):da(new Ht(1,0,0,1,qr,An),es),B===S&&(es=da(new Ht(1,0,0,-1,0,0),es)),Es=es.join(" ")+` Tm
`):Es=w(qr)+" "+w(An)+` Td
`,Es},Qa=0;Qa<Ye.length;Qa++){switch(Sc="",KA){case 1:Cc=(j?"<":"(")+Ye[Qa][0]+(j?">":")"),_c=parseFloat(Ye[Qa][1]),Bc=parseFloat(Ye[Qa][2]);break;case 0:Cc=(j?"<":"(")+Ye[Qa]+(j?">":")"),_c=Mi(q),Bc=Pa(ge)}wc!==void 0&&wc[Qa]!==void 0&&(Sc=wc[Qa]+` Tw
`),Qa===0?U.push(Sc+qA(_c,Bc,ln)+Cc):KA===0?U.push(Sc+Cc):KA===1&&U.push(Sc+qA(_c,Bc,ln)+Cc)}U=KA===0?U.join(` Tj
T* `):U.join(` Tj
`),U+=` Tj
`;var Do=`BT
/`;return Do+=ct+" "+ee+` Tf
`,Do+=w(ee*Le)+` TL
`,Do+=Fo+`
`,Do+=oe,Do+=U,G(Do+="ET"),h[ct]=!0,y};var OA=u.__private__.clip=u.clip=function(U){return G(U==="evenodd"?"W*":"W"),this};u.clipEvenOdd=function(){return OA("evenodd")},u.__private__.discardPath=u.discardPath=function(){return G("n"),this};var Yi=u.__private__.isValidStyle=function(U){var q=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(U)!==-1&&(q=!0),q};u.__private__.setDefaultPathOperation=u.setDefaultPathOperation=function(U){return Yi(U)&&(c=U),this};var re=u.__private__.getStyle=u.getStyle=function(U){var q=c;switch(U){case"D":case"S":q="S";break;case"F":q="f";break;case"FD":case"DF":q="B";break;case"f":case"f*":case"B":case"B*":q=U}return q},Ae=u.close=function(){return G("h"),this};u.stroke=function(){return G("S"),this},u.fill=function(U){return be("f",U),this},u.fillEvenOdd=function(U){return be("f*",U),this},u.fillStroke=function(U){return be("B",U),this},u.fillStrokeEvenOdd=function(U){return be("B*",U),this};var be=function(U,q){nn(q)==="object"?ht(q,U):G(U)},Oe=function(U){U===null||B===S&&U===void 0||(U=re(U),G(U))};function Je(U,q,ge,_e,Te){var $e=new Mu(q||this.boundingBox,ge||this.xStep,_e||this.yStep,this.gState,Te||this.matrix);$e.stream=this.stream;var Ye=U+"$$"+this.cloneIndex+++"$$";return Xs(Ye,$e),$e}var ht=function(U,q){var ge=jt[U.key],_e=yt[ge];if(_e instanceof od)G("q"),G(nr(q)),_e.gState&&u.setGState(_e.gState),G(U.matrix.toString()+" cm"),G("/"+ge+" sh"),G("Q");else if(_e instanceof Mu){var Te=new Ht(1,0,0,-1,0,so());U.matrix&&(Te=Te.multiply(U.matrix||Cs),ge=Je.call(_e,U.key,U.boundingBox,U.xStep,U.yStep,Te).id),G("q"),G("/Pattern cs"),G("/"+ge+" scn"),_e.gState&&u.setGState(_e.gState),G(q),G("Q")}},nr=function(U){switch(U){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},on=u.moveTo=function(U,q){return G(w(T(U))+" "+w(L(q))+" m"),this},Hr=u.lineTo=function(U,q){return G(w(T(U))+" "+w(L(q))+" l"),this},hn=u.curveTo=function(U,q,ge,_e,Te,$e){return G([w(T(U)),w(L(q)),w(T(ge)),w(L(_e)),w(T(Te)),w(L($e)),"c"].join(" ")),this};u.__private__.line=u.line=function(U,q,ge,_e,Te){if(isNaN(U)||isNaN(q)||isNaN(ge)||isNaN(_e)||!Yi(Te))throw new Error("Invalid arguments passed to jsPDF.line");return B===x?this.lines([[ge-U,_e-q]],U,q,[1,1],Te||"S"):this.lines([[ge-U,_e-q]],U,q,[1,1]).stroke()},u.__private__.lines=u.lines=function(U,q,ge,_e,Te,$e){var Ye,vt,Et,$t,Mt,Ur,gn,ln,y,R,j,oe;if(typeof U=="number"&&(oe=ge,ge=q,q=U,U=oe),_e=_e||[1,1],$e=$e||!1,isNaN(q)||isNaN(ge)||!Array.isArray(U)||!Array.isArray(_e)||!Yi(Te)||typeof $e!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(on(q,ge),Ye=_e[0],vt=_e[1],$t=U.length,R=q,j=ge,Et=0;Et<$t;Et++)(Mt=U[Et]).length===2?(R=Mt[0]*Ye+R,j=Mt[1]*vt+j,Hr(R,j)):(Ur=Mt[0]*Ye+R,gn=Mt[1]*vt+j,ln=Mt[2]*Ye+R,y=Mt[3]*vt+j,R=Mt[4]*Ye+R,j=Mt[5]*vt+j,hn(Ur,gn,ln,y,R,j));return $e&&Ae(),Oe(Te),this},u.path=function(U){for(var q=0;q<U.length;q++){var ge=U[q],_e=ge.c;switch(ge.op){case"m":on(_e[0],_e[1]);break;case"l":Hr(_e[0],_e[1]);break;case"c":hn.apply(this,_e);break;case"h":Ae()}}return this},u.__private__.rect=u.rect=function(U,q,ge,_e,Te){if(isNaN(U)||isNaN(q)||isNaN(ge)||isNaN(_e)||!Yi(Te))throw new Error("Invalid arguments passed to jsPDF.rect");return B===x&&(_e=-_e),G([w(T(U)),w(L(q)),w(T(ge)),w(T(_e)),"re"].join(" ")),Oe(Te),this},u.__private__.triangle=u.triangle=function(U,q,ge,_e,Te,$e,Ye){if(isNaN(U)||isNaN(q)||isNaN(ge)||isNaN(_e)||isNaN(Te)||isNaN($e)||!Yi(Ye))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[ge-U,_e-q],[Te-ge,$e-_e],[U-Te,q-$e]],U,q,[1,1],Ye,!0),this},u.__private__.roundedRect=u.roundedRect=function(U,q,ge,_e,Te,$e,Ye){if(isNaN(U)||isNaN(q)||isNaN(ge)||isNaN(_e)||isNaN(Te)||isNaN($e)||!Yi(Ye))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var vt=4/3*(Math.SQRT2-1);return Te=Math.min(Te,.5*ge),$e=Math.min($e,.5*_e),this.lines([[ge-2*Te,0],[Te*vt,0,Te,$e-$e*vt,Te,$e],[0,_e-2*$e],[0,$e*vt,-Te*vt,$e,-Te,$e],[2*Te-ge,0],[-Te*vt,0,-Te,-$e*vt,-Te,-$e],[0,2*$e-_e],[0,-$e*vt,Te*vt,-$e,Te,-$e]],U+Te,q,[1,1],Ye,!0),this},u.__private__.ellipse=u.ellipse=function(U,q,ge,_e,Te){if(isNaN(U)||isNaN(q)||isNaN(ge)||isNaN(_e)||!Yi(Te))throw new Error("Invalid arguments passed to jsPDF.ellipse");var $e=4/3*(Math.SQRT2-1)*ge,Ye=4/3*(Math.SQRT2-1)*_e;return on(U+ge,q),hn(U+ge,q-Ye,U+$e,q-_e,U,q-_e),hn(U-$e,q-_e,U-ge,q-Ye,U-ge,q),hn(U-ge,q+Ye,U-$e,q+_e,U,q+_e),hn(U+$e,q+_e,U+ge,q+Ye,U+ge,q),Oe(Te),this},u.__private__.circle=u.circle=function(U,q,ge,_e){if(isNaN(U)||isNaN(q)||isNaN(ge)||!Yi(_e))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(U,q,ge,ge,_e)},u.setFont=function(U,q,ge){return ge&&(q=E(q,ge)),ct=Eo(U,q,{disableWarning:!1}),this};var fi=u.__private__.getFont=u.getFont=function(){return rt[Eo.apply(u,arguments)]};u.__private__.getFontList=u.getFontList=function(){var U,q,ge={};for(U in ft)if(ft.hasOwnProperty(U))for(q in ge[U]=[],ft[U])ft[U].hasOwnProperty(q)&&ge[U].push(q);return ge},u.addFont=function(U,q,ge,_e,Te){var $e=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&$e.indexOf(arguments[3])!==-1?Te=arguments[3]:arguments[3]&&$e.indexOf(arguments[3])==-1&&(ge=E(ge,_e)),zi.call(this,U,q,ge,Te=Te||"Identity-H")};var pl,Xi=r.lineWidth||.200025,Xt=u.__private__.getLineWidth=u.getLineWidth=function(){return Xi},QA=u.__private__.setLineWidth=u.setLineWidth=function(U){return Xi=U,G(w(T(U))+" w"),this};u.__private__.setLineDash=kt.API.setLineDash=kt.API.setLineDashPattern=function(U,q){if(U=U||[],q=q||0,isNaN(q)||!Array.isArray(U))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return U=U.map(function(ge){return w(T(ge))}).join(" "),q=w(T(q)),G("["+U+"] "+q+" d"),this};var fc=u.__private__.getLineHeight=u.getLineHeight=function(){return ee*pl};u.__private__.getLineHeight=u.getLineHeight=function(){return ee*pl};var su=u.__private__.setLineHeightFactor=u.setLineHeightFactor=function(U){return typeof(U=U||1.15)=="number"&&(pl=U),this},ml=u.__private__.getLineHeightFactor=u.getLineHeightFactor=function(){return pl};su(r.lineHeight);var Mi=u.__private__.getHorizontalCoordinate=function(U){return T(U)},Pa=u.__private__.getVerticalCoordinate=function(U){return B===S?U:Ut[O].mediaBox.topRightY-Ut[O].mediaBox.bottomLeftY-T(U)},HA=u.__private__.getHorizontalCoordinateString=u.getHorizontalCoordinateString=function(U){return w(Mi(U))},fn=u.__private__.getVerticalCoordinateString=u.getVerticalCoordinateString=function(U){return w(Pa(U))},gc=r.strokeColor||"0 G";u.__private__.getStrokeColor=u.getDrawColor=function(){return ei(gc)},u.__private__.setStrokeColor=u.setDrawColor=function(U,q,ge,_e){return gc=Ps({ch1:U,ch2:q,ch3:ge,ch4:_e,pdfColorType:"draw",precision:2}),G(gc),this};var jA=r.fillColor||"0 g";u.__private__.getFillColor=u.getFillColor=function(){return ei(jA)},u.__private__.setFillColor=u.setFillColor=function(U,q,ge,_e){return jA=Ps({ch1:U,ch2:q,ch3:ge,ch4:_e,pdfColorType:"fill",precision:2}),G(jA),this};var Fo=r.textColor||"0 g",bl=u.__private__.getTextColor=u.getTextColor=function(){return ei(Fo)};u.__private__.setTextColor=u.setTextColor=function(U,q,ge,_e){return Fo=Ps({ch1:U,ch2:q,ch3:ge,ch4:_e,pdfColorType:"text",precision:3}),this};var yl=r.charSpace,pc=u.__private__.getCharSpace=u.getCharSpace=function(){return parseFloat(yl||0)};u.__private__.setCharSpace=u.setCharSpace=function(U){if(isNaN(U))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return yl=U,this};var Ji=0;u.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},u.__private__.setLineCap=u.setLineCap=function(U){var q=u.CapJoinStyles[U];if(q===void 0)throw new Error("Line cap style of '"+U+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Ji=q,G(q+" J"),this};var mc=0;u.__private__.setLineJoin=u.setLineJoin=function(U){var q=u.CapJoinStyles[U];if(q===void 0)throw new Error("Line join style of '"+U+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return mc=q,G(q+" j"),this},u.__private__.setLineMiterLimit=u.__private__.setMiterLimit=u.setLineMiterLimit=u.setMiterLimit=function(U){if(U=U||0,isNaN(U))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return G(w(T(U))+" M"),this},u.GState=Zm,u.setGState=function(U){(U=typeof U=="string"?Rt[wr[U]]:wl(null,U)).equals(Qr)||(G("/"+U.id+" gs"),Qr=U)};var wl=function(U,q){if(!U||!wr[U]){var ge=!1;for(var _e in Rt)if(Rt.hasOwnProperty(_e)&&Rt[_e].equals(q)){ge=!0;break}if(ge)q=Rt[_e];else{var Te="GS"+(Object.keys(Rt).length+1).toString(10);Rt[Te]=q,q.id=Te}return U&&(wr[U]=q.id),mr.publish("addGState",q),q}};u.addGState=function(U,q){return wl(U,q),this},u.saveGraphicsState=function(){return G("q"),St.push({key:ct,size:ee,color:Fo}),this},u.restoreGraphicsState=function(){G("Q");var U=St.pop();return ct=U.key,ee=U.size,Fo=U.color,Qr=null,this},u.setCurrentTransformationMatrix=function(U){return G(U.toString()+" cm"),this},u.comment=function(U){return G("#"+U),this};var ga=function(U,q){var ge=U||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return ge},set:function($e){isNaN($e)||(ge=parseFloat($e))}});var _e=q||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return _e},set:function($e){isNaN($e)||(_e=parseFloat($e))}});var Te="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Te},set:function($e){Te=$e.toString()}}),this},bc=function(U,q,ge,_e){ga.call(this,U,q),this.type="rect";var Te=ge||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Te},set:function(Ye){isNaN(Ye)||(Te=parseFloat(Ye))}});var $e=_e||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return $e},set:function(Ye){isNaN(Ye)||($e=parseFloat(Ye))}}),this},Lo=function(){this.page=Lt,this.currentPage=O,this.pages=Ce.slice(0),this.pagesContext=Ut.slice(0),this.x=it,this.y=lt,this.matrix=tt,this.width=vl(O),this.height=Da(O),this.outputDestination=Qe,this.id="",this.objectNumber=-1};Lo.prototype.restore=function(){Lt=this.page,O=this.currentPage,Ut=this.pagesContext,Ce=this.pages,it=this.x,lt=this.y,tt=this.matrix,iu(O,this.width),Ni(O,this.height),Qe=this.outputDestination};var Uo=function(U,q,ge,_e,Te){Bs.push(new Lo),Lt=O=0,Ce=[],it=U,lt=q,tt=Te,Hs([ge,_e])};for(var Mo in u.beginFormObject=function(U,q,ge,_e,Te){return Uo(U,q,ge,_e,Te),this},u.endFormObject=function(U){return(function(q){if(hi[q])Bs.pop().restore();else{var ge=new Lo,_e="Xo"+(Object.keys(Pn).length+1).toString(10);ge.id=_e,hi[q]=_e,Pn[_e]=ge,mr.publish("addFormObject",ge),Bs.pop().restore()}})(U),this},u.doFormObject=function(U,q){var ge=Pn[hi[U]];return G("q"),G(q.toString()+" cm"),G("/"+ge.id+" Do"),G("Q"),this},u.getFormObject=function(U){var q=Pn[hi[U]];return{x:q.x,y:q.y,width:q.width,height:q.height,matrix:q.matrix}},u.save=function(U,q){return U=U||"generated.pdf",(q=q||{}).returnPromise=q.returnPromise||!1,q.returnPromise===!1?(nd(_r(ni()),U),typeof nd.unload=="function"&&Zt.setTimeout&&setTimeout(nd.unload,911),this):new Promise(function(ge,_e){try{var Te=nd(_r(ni()),U);typeof nd.unload=="function"&&Zt.setTimeout&&setTimeout(nd.unload,911),ge(Te)}catch($e){_e($e.message)}})},kt.API)kt.API.hasOwnProperty(Mo)&&(Mo==="events"&&kt.API.events.length?(function(U,q){var ge,_e,Te;for(Te=q.length-1;Te!==-1;Te--)ge=q[Te][0],_e=q[Te][1],U.subscribe.apply(U,[ge].concat(typeof _e=="function"?[_e]:_e))})(mr,kt.API.events):u[Mo]=kt.API[Mo]);function vl(U){return Ut[U].mediaBox.topRightX-Ut[U].mediaBox.bottomLeftX}function iu(U,q){Ut[U].mediaBox.topRightX=q+Ut[U].mediaBox.bottomLeftX}function Da(U){return Ut[U].mediaBox.topRightY-Ut[U].mediaBox.bottomLeftY}function Ni(U,q){Ut[U].mediaBox.topRightY=q+Ut[U].mediaBox.bottomLeftY}var VA=u.getPageWidth=function(U){return vl(U=U||O)/wt},$A=u.setPageWidth=function(U,q){iu(U,q*wt)},so=u.getPageHeight=function(U){return Da(U=U||O)/wt},yc=u.setPageHeight=function(U,q){Ni(U,q*wt)};return u.internal={pdfEscape:Fn,getStyle:re,getFont:fi,getFontSize:xe,getCharSpace:pc,getTextColor:bl,getLineHeight:fc,getLineHeightFactor:ml,getLineWidth:Xt,write:ce,getHorizontalCoordinate:Mi,getVerticalCoordinate:Pa,getCoordinateString:HA,getVerticalCoordinateString:fn,collections:{},newObject:Jr,newProgressObject:Ss,newObjectDeferred:sn,newObjectDeferredBegin:Xn,getFilters:ti,putStream:Ds,events:mr,scaleFactor:wt,pageSize:{getWidth:function(){return VA(O)},setWidth:function(U){$A(O,U)},getHeight:function(){return so(O)},setHeight:function(U){yc(O,U)}},encryptionOptions:A,encryption:Zr,getEncryptor:function(U){return A!==null?Zr.encryptor(U,0):function(q){return q}},output:Jn,getNumberOfPages:ko,pages:Ce,out:G,f2:k,f3:_,getPageInfo:Io,getPageInfoByObjId:To,getCurrentPageInfo:hc,getPDFVersion:f,Point:ga,Rectangle:bc,Matrix:Ht,hasHotfix:Qn},Object.defineProperty(u.internal.pageSize,"width",{get:function(){return VA(O)},set:function(U){$A(O,U)},enumerable:!0,configurable:!0}),Object.defineProperty(u.internal.pageSize,"height",{get:function(){return so(O)},set:function(U){yc(O,U)},enumerable:!0,configurable:!0}),(function(U){for(var q=0,ge=W.length;q<ge;q++){var _e=zi.call(this,U[q][0],U[q][1],U[q][2],W[q][3],!0);d===!1&&(h[_e]=!0);var Te=U[q][0].split("-");ks({id:_e,fontName:Te[0],fontStyle:Te[1]||""})}mr.publish("addFonts",{fonts:rt,dictionary:ft})}).call(u,W),ct="F1",Ki(s,t),mr.publish("initialized"),u}Cu.prototype.lsbFirstWord=function(r){return String.fromCharCode(255&r,r>>8&255,r>>16&255,r>>24&255)},Cu.prototype.toHexString=function(r){return r.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Cu.prototype.hexToBytes=function(r){for(var e=[],t=0;t<r.length;t+=2)e.push(String.fromCharCode(parseInt(r.substr(t,2),16)));return e.join("")},Cu.prototype.processOwnerPassword=function(r,e){return C1(B1(e).substr(0,5),r)},Cu.prototype.encryptor=function(r,e){var t=B1(this.encryptionKey+String.fromCharCode(255&r,r>>8&255,r>>16&255,255&e,e>>8&255)).substr(0,10);return function(n){return C1(t,n)}},Zm.prototype.equals=function(r){var e,t="id,objectNumber,equals";if(!r||nn(r)!==nn(this))return!1;var n=0;for(e in this)if(!(t.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!r.hasOwnProperty(e)||this[e]!==r[e])return!1;n++}for(e in r)r.hasOwnProperty(e)&&t.indexOf(e)<0&&n--;return n===0},kt.API={events:[]},kt.version="3.0.3";var $n=kt.API,r2=1,Xd=function(r){return r.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},wu=function(r){return r.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},sr=function(r){return r.toFixed(2)},Nc=function(r){return r.toFixed(5)};$n.__acroform__={};var Aa=function(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r},DS=function(r){return r*r2},Ho=function(r){var e=new QF,t=_t.internal.getHeight(r)||0,n=_t.internal.getWidth(r)||0;return e.BBox=[0,0,Number(sr(n)),Number(sr(t))],e},cW=$n.__acroform__.setBit=function(r,e){if(r=r||0,e=e||0,isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return r|1<<e},AW=$n.__acroform__.clearBit=function(r,e){if(r=r||0,e=e||0,isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return r&~(1<<e)},dW=$n.__acroform__.getBit=function(r,e){if(isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return r&1<<e?1:0},as=$n.__acroform__.getBitForPdf=function(r,e){if(isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return dW(r,e-1)},os=$n.__acroform__.setBitForPdf=function(r,e){if(isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return cW(r,e-1)},ls=$n.__acroform__.clearBitForPdf=function(r,e){if(isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return AW(r,e-1)},uW=$n.__acroform__.calculateCoordinates=function(r,e){var t=e.internal.getHorizontalCoordinate,n=e.internal.getVerticalCoordinate,s=r[0],i=r[1],a=r[2],o=r[3],l={};return l.lowerLeft_X=t(s)||0,l.lowerLeft_Y=n(i+o)||0,l.upperRight_X=t(s+a)||0,l.upperRight_Y=n(i)||0,[Number(sr(l.lowerLeft_X)),Number(sr(l.lowerLeft_Y)),Number(sr(l.upperRight_X)),Number(sr(l.upperRight_Y))]},hW=function(r){if(r.appearanceStreamContent)return r.appearanceStreamContent;if(r.V||r.DV){var e=[],t=r._V||r.DV,n=S1(r,t),s=r.scope.internal.getFont(r.fontName,r.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(r.scope.__private__.encodeColorString(r.color)),e.push("/"+s+" "+sr(n.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(n.text),e.push("ET"),e.push("Q"),e.push("EMC");var i=Ho(r);return i.scope=r.scope,i.stream=e.join(`
`),i}},S1=function(r,e){var t=r.fontSize===0?r.maxFontSize:r.fontSize,n={text:"",fontSize:""},s=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");s=r.multiline?s.map(function(k){return k.split(`
`)}):s.map(function(k){return[k]});var i=t,a=_t.internal.getHeight(r)||0;a=a<0?-a:a;var o=_t.internal.getWidth(r)||0;o=o<0?-o:o;var l=function(k,_,T){if(k+1<s.length){var L=_+" "+s[k+1][0];return I0(L,r,T).width<=o-4}return!1};i++;e:for(;i>0;){e="",i--;var c,A,d=I0("3",r,i).height,h=r.multiline?a-i:(a-d)/2,u=h+=2,p=0,f=0,g=0;if(i<=0){e=`(...) Tj
`,e+="% Width of Text: "+I0(e,r,i=12).width+", FieldWidth:"+o+`
`;break}for(var m="",x=0,S=0;S<s.length;S++)if(s.hasOwnProperty(S)){var B=!1;if(s[S].length!==1&&g!==s[S].length-1){if((d+2)*(x+2)+2>a)continue e;m+=s[S][g],B=!0,f=S,S--}else{m=(m+=s[S][g]+" ").substr(m.length-1)==" "?m.substr(0,m.length-1):m;var F=parseInt(S),N=l(F,m,i),E=S>=s.length-1;if(N&&!E){m+=" ",g=0;continue}if(N||E){if(E)f=F;else if(r.multiline&&(d+2)*(x+2)+2>a)continue e}else{if(!r.multiline||(d+2)*(x+2)+2>a)continue e;f=F}}for(var w="",v=p;v<=f;v++){var I=s[v];if(r.multiline){if(v===f){w+=I[g]+" ",g=(g+1)%I.length;continue}if(v===p){w+=I[I.length-1]+" ";continue}}w+=I[0]+" "}switch(w=w.substr(w.length-1)==" "?w.substr(0,w.length-1):w,A=I0(w,r,i).width,r.textAlign){case"right":c=o-A-2;break;case"center":c=(o-A)/2;break;default:c=2}e+=sr(c)+" "+sr(u)+` Td
`,e+="("+Xd(w)+`) Tj
`,e+=-sr(c)+` 0 Td
`,u=-(i+2),A=0,p=B?f:f+1,x++,m=""}break}return n.text=e,n.fontSize=i,n},I0=function(r,e,t){var n=e.scope.internal.getFont(e.fontName,e.fontStyle),s=e.scope.getStringUnitWidth(r,{font:n,fontSize:parseFloat(t),charSpace:0})*parseFloat(t);return{height:e.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(t),charSpace:0})*parseFloat(t)*1.5,width:s}},fW={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},gW=function(r,e){var t={type:"reference",object:r};e.internal.getPageInfo(r.page).pageContext.annotations.find(function(n){return n.type===t.type&&n.object===t.object})===void 0&&e.internal.getPageInfo(r.page).pageContext.annotations.push(t)},pW=function(r,e){if(e.scope=r,r.internal!==void 0&&(r.internal.acroformPlugin===void 0||r.internal.acroformPlugin.isInitialized===!1)){if(Bo.FieldNum=0,r.internal.acroformPlugin=JSON.parse(JSON.stringify(fW)),r.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");r2=r.internal.scaleFactor,r.internal.acroformPlugin.acroFormDictionaryRoot=new HF,r.internal.acroformPlugin.acroFormDictionaryRoot.scope=r,r.internal.acroformPlugin.acroFormDictionaryRoot._eventID=r.internal.events.subscribe("postPutResources",function(){(function(t){t.internal.events.unsubscribe(t.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t.internal.acroformPlugin.printedOut=!0})(r)}),r.internal.events.subscribe("buildDocument",function(){(function(t){t.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=t.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var s in n)if(n.hasOwnProperty(s)){var i=n[s];i.objId=void 0,i.hasAnnotation&&gW(i,t)}})(r)}),r.internal.events.subscribe("putCatalog",function(){(function(t){if(t.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");t.internal.write("/AcroForm "+t.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(r)}),r.internal.events.subscribe("postPutPages",function(t){(function(n,s){var i=!n;for(var a in n||(s.internal.newObjectDeferredBegin(s.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),s.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||s.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(a)){var o=n[a],l=[],c=o.Rect;if(o.Rect&&(o.Rect=uW(o.Rect,s)),s.internal.newObjectDeferredBegin(o.objId,!0),o.DA=_t.createDefaultAppearanceStream(o),nn(o)==="object"&&typeof o.getKeyValueListForStream=="function"&&(l=o.getKeyValueListForStream()),o.Rect=c,o.hasAppearanceStream&&!o.appearanceStreamContent){var A=hW(o);l.push({key:"AP",value:"<</N "+A+">>"}),s.internal.acroformPlugin.xForms.push(A)}if(o.appearanceStreamContent){var d="";for(var h in o.appearanceStreamContent)if(o.appearanceStreamContent.hasOwnProperty(h)){var u=o.appearanceStreamContent[h];if(d+="/"+h+" ",d+="<<",Object.keys(u).length>=1||Array.isArray(u)){for(var a in u)if(u.hasOwnProperty(a)){var p=u[a];typeof p=="function"&&(p=p.call(s,o)),d+="/"+a+" "+p+" ",s.internal.acroformPlugin.xForms.indexOf(p)>=0||s.internal.acroformPlugin.xForms.push(p)}}else typeof(p=u)=="function"&&(p=p.call(s,o)),d+="/"+a+" "+p,s.internal.acroformPlugin.xForms.indexOf(p)>=0||s.internal.acroformPlugin.xForms.push(p);d+=">>"}l.push({key:"AP",value:`<<
`+d+">>"})}s.internal.putStream({ProgressKeyValues:l,objectId:o.objId}),s.internal.out("endobj")}i&&(function(f,g){for(var m in f)if(f.hasOwnProperty(m)){var x=m,S=f[m];g.internal.newObjectDeferredBegin(S.objId,!0),nn(S)==="object"&&typeof S.putStream=="function"&&S.putStream(),delete f[x]}})(s.internal.acroformPlugin.xForms,s)})(t,r)}),r.internal.acroformPlugin.isInitialized=!0}},OF=$n.__acroform__.arrayToPdfArray=function(r,e,t){var n=function(a){return a};if(Array.isArray(r)){for(var s="[",i=0;i<r.length;i++)switch(i!==0&&(s+=" "),nn(r[i])){case"boolean":case"number":case"object":s+=r[i].toString();break;case"string":r[i].substr(0,1)!=="/"?(e!==void 0&&t&&(n=t.internal.getEncryptor(e)),s+="("+Xd(n(r[i].toString()))+")"):s+=r[i].toString()}return s+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Vw=function(r,e,t){var n=function(s){return s};return e!==void 0&&t&&(n=t.internal.getEncryptor(e)),(r=r||"").toString(),"("+Xd(n(r))+")"},Xo=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(r){this._objId=r}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Xo.prototype.toString=function(){return this.objId+" 0 R"},Xo.prototype.putStream=function(){var r=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,ProgressKeyValues:r,objectId:this.objId}),this.scope.internal.out("endobj")},Xo.prototype.getKeyValueListForStream=function(){var r=[],e=Object.getOwnPropertyNames(this).filter(function(i){return i!="content"&&i!="appearanceStreamContent"&&i!="scope"&&i!="objId"&&i.substring(0,1)!="_"});for(var t in e)if(Object.getOwnPropertyDescriptor(this,e[t]).configurable===!1){var n=e[t],s=this[n];s&&(Array.isArray(s)?r.push({key:n,value:OF(s,this.objId,this.scope)}):s instanceof Xo?(s.scope=this.scope,r.push({key:n,value:s.objId+" 0 R"})):typeof s!="function"&&r.push({key:n,value:s}))}return r};var QF=function(){Xo.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var r,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(t){r=t.trim()},get:function(){return r||null}})};Aa(QF,Xo);var HF=function(){Xo.call(this);var r,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(r){var t=function(n){return n};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+Xd(t(r))+")"}},set:function(t){r=t}})};Aa(HF,Xo);var Bo=function r(){Xo.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(m){if(isNaN(m))throw new Error('Invalid value "'+m+'" for attribute F supplied.');e=m}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!as(e,3)},set:function(m){m?this.F=os(e,3):this.F=ls(e,3)}});var t=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return t},set:function(m){if(isNaN(m))throw new Error('Invalid value "'+m+'" for attribute Ff supplied.');t=m}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(m){n=m!==void 0?m:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(m){n[0]=m}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(m){n[1]=m}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(m){n[2]=m}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(m){n[3]=m}});var s="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return s},set:function(m){switch(m){case"/Btn":case"/Tx":case"/Ch":case"/Sig":s=m;break;default:throw new Error('Invalid value "'+m+'" for attribute FT supplied.')}}});var i=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!i||i.length<1){if(this instanceof eb)return;i="FieldObject"+r.FieldNum++}var m=function(x){return x};return this.scope&&(m=this.scope.internal.getEncryptor(this.objId)),"("+Xd(m(i))+")"},set:function(m){i=m.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return i},set:function(m){i=m}});var a="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return a},set:function(m){a=m}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(m){o=m}});var l=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return l},set:function(m){l=m}});var c=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return c===void 0?50/r2:c},set:function(m){c=m}});var A="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return A},set:function(m){A=m}});var d="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!d||this instanceof eb||this instanceof Cd))return Vw(d,this.objId,this.scope)},set:function(m){m=m.toString(),d=m}});var h=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof Gs==0?Vw(h,this.objId,this.scope):h},set:function(m){m=m.toString(),h=this instanceof Gs==0?m.substr(0,1)==="("?wu(m.substr(1,m.length-2)):wu(m):m}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Gs==1?wu(h.substr(1,h.length-1)):h},set:function(m){m=m.toString(),h=this instanceof Gs==1?"/"+m:m}});var u=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(u)return u},set:function(m){this.V=m}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(u)return this instanceof Gs==0?Vw(u,this.objId,this.scope):u},set:function(m){m=m.toString(),u=this instanceof Gs==0?m.substr(0,1)==="("?wu(m.substr(1,m.length-2)):wu(m):m}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Gs==1?wu(u.substr(1,u.length-1)):u},set:function(m){m=m.toString(),u=this instanceof Gs==1?"/"+m:m}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var p,f=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return f},set:function(m){m=!!m,f=m}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(p)return p},set:function(m){p=m}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!as(this.Ff,1)},set:function(m){m?this.Ff=os(this.Ff,1):this.Ff=ls(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!as(this.Ff,2)},set:function(m){m?this.Ff=os(this.Ff,2):this.Ff=ls(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!as(this.Ff,3)},set:function(m){m?this.Ff=os(this.Ff,3):this.Ff=ls(this.Ff,3)}});var g=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(g!==null)return g},set:function(m){if([0,1,2].indexOf(m)===-1)throw new Error('Invalid value "'+m+'" for attribute Q supplied.');g=m}}),Object.defineProperty(this,"textAlign",{get:function(){var m;switch(g){case 0:default:m="left";break;case 1:m="center";break;case 2:m="right"}return m},configurable:!0,enumerable:!0,set:function(m){switch(m){case"right":case 2:g=2;break;case"center":case 1:g=1;break;default:g=0}}})};Aa(Bo,Xo);var ju=function(){Bo.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var r=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return r},set:function(t){r=t}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return r},set:function(t){r=t}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return OF(e,this.objId,this.scope)},set:function(t){var n,s;s=[],typeof(n=t)=="string"&&(s=(function(i,a,o){o||(o=1);for(var l,c=[];l=a.exec(i);)c.push(l[o]);return c})(n,/\((.*?)\)/g)),e=s}}),this.getOptions=function(){return e},this.setOptions=function(t){e=t,this.sort&&e.sort()},this.addOption=function(t){t=(t=t||"").toString(),e.push(t),this.sort&&e.sort()},this.removeOption=function(t,n){for(n=n||!1,t=(t=t||"").toString();e.indexOf(t)!==-1&&(e.splice(e.indexOf(t),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!as(this.Ff,18)},set:function(t){t?this.Ff=os(this.Ff,18):this.Ff=ls(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!as(this.Ff,19)},set:function(t){this.combo===!0&&(t?this.Ff=os(this.Ff,19):this.Ff=ls(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!as(this.Ff,20)},set:function(t){t?(this.Ff=os(this.Ff,20),e.sort()):this.Ff=ls(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!as(this.Ff,22)},set:function(t){t?this.Ff=os(this.Ff,22):this.Ff=ls(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!as(this.Ff,23)},set:function(t){t?this.Ff=os(this.Ff,23):this.Ff=ls(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!as(this.Ff,27)},set:function(t){t?this.Ff=os(this.Ff,27):this.Ff=ls(this.Ff,27)}}),this.hasAppearanceStream=!1};Aa(ju,Bo);var Vu=function(){ju.call(this),this.fontName="helvetica",this.combo=!1};Aa(Vu,ju);var $u=function(){Vu.call(this),this.combo=!0};Aa($u,Vu);var om=function(){$u.call(this),this.edit=!0};Aa(om,$u);var Gs=function(){Bo.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!as(this.Ff,15)},set:function(t){t?this.Ff=os(this.Ff,15):this.Ff=ls(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!as(this.Ff,16)},set:function(t){t?this.Ff=os(this.Ff,16):this.Ff=ls(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!as(this.Ff,17)},set:function(t){t?this.Ff=os(this.Ff,17):this.Ff=ls(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!as(this.Ff,26)},set:function(t){t?this.Ff=os(this.Ff,26):this.Ff=ls(this.Ff,26)}});var r,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var t=function(i){return i};if(this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var n,s=[];for(n in s.push("<<"),e)s.push("/"+n+" ("+Xd(t(e[n]))+")");return s.push(">>"),s.join(`
`)}},set:function(t){nn(t)==="object"&&(e=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(t){typeof t=="string"&&(e.CA=t)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(t){r=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(t){r="/"+t}})};Aa(Gs,Bo);var lm=function(){Gs.call(this),this.pushButton=!0};Aa(lm,Gs);var Gu=function(){Gs.call(this),this.radio=!0,this.pushButton=!1;var r=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return r},set:function(e){r=e!==void 0?e:[]}})};Aa(Gu,Gs);var eb=function(){var r,e;Bo.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return r},set:function(s){r=s}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(s){e=s}});var t,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var s=function(o){return o};this.scope&&(s=this.scope.internal.getEncryptor(this.objId));var i,a=[];for(i in a.push("<<"),n)a.push("/"+i+" ("+Xd(s(n[i]))+")");return a.push(">>"),a.join(`
`)},set:function(s){nn(s)==="object"&&(n=s)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(s){typeof s=="string"&&(n.CA=s)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(s){t=s}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(s){t="/"+s}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=_t.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Aa(eb,Bo),Gu.prototype.setAppearance=function(r){if(!("createAppearanceStream"in r)||!("getCA"in r))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var t=this.Kids[e];t.appearanceStreamContent=r.createAppearanceStream(t.optionName),t.caption=r.getCA()}},Gu.prototype.createOption=function(r){var e=new eb;return e.Parent=this,e.optionName=r,this.Kids.push(e),mW.call(this.scope,e),e};var cm=function(){Gs.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=_t.CheckBox.createAppearanceStream()};Aa(cm,Gs);var Cd=function(){Bo.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!as(this.Ff,13)},set:function(e){e?this.Ff=os(this.Ff,13):this.Ff=ls(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!as(this.Ff,21)},set:function(e){e?this.Ff=os(this.Ff,21):this.Ff=ls(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!as(this.Ff,23)},set:function(e){e?this.Ff=os(this.Ff,23):this.Ff=ls(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!as(this.Ff,24)},set:function(e){e?this.Ff=os(this.Ff,24):this.Ff=ls(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!as(this.Ff,25)},set:function(e){e?this.Ff=os(this.Ff,25):this.Ff=ls(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!as(this.Ff,26)},set:function(e){e?this.Ff=os(this.Ff,26):this.Ff=ls(this.Ff,26)}});var r=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return r},set:function(e){r=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return r},set:function(e){Number.isInteger(e)&&(r=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Aa(Cd,Bo);var Am=function(){Cd.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!as(this.Ff,14)},set:function(r){r?this.Ff=os(this.Ff,14):this.Ff=ls(this.Ff,14)}}),this.password=!0};Aa(Am,Cd);var _t={CheckBox:{createAppearanceStream:function(){return{N:{On:_t.CheckBox.YesNormal},D:{On:_t.CheckBox.YesPushDown,Off:_t.CheckBox.OffPushDown}}},YesPushDown:function(r){var e=Ho(r);e.scope=r.scope;var t=[],n=r.scope.internal.getFont(r.fontName,r.fontStyle).id,s=r.scope.__private__.encodeColorString(r.color),i=S1(r,r.caption);return t.push("0.749023 g"),t.push("0 0 "+sr(_t.internal.getWidth(r))+" "+sr(_t.internal.getHeight(r))+" re"),t.push("f"),t.push("BMC"),t.push("q"),t.push("0 0 1 rg"),t.push("/"+n+" "+sr(i.fontSize)+" Tf "+s),t.push("BT"),t.push(i.text),t.push("ET"),t.push("Q"),t.push("EMC"),e.stream=t.join(`
`),e},YesNormal:function(r){var e=Ho(r);e.scope=r.scope;var t=r.scope.internal.getFont(r.fontName,r.fontStyle).id,n=r.scope.__private__.encodeColorString(r.color),s=[],i=_t.internal.getHeight(r),a=_t.internal.getWidth(r),o=S1(r,r.caption);return s.push("1 g"),s.push("0 0 "+sr(a)+" "+sr(i)+" re"),s.push("f"),s.push("q"),s.push("0 0 1 rg"),s.push("0 0 "+sr(a-1)+" "+sr(i-1)+" re"),s.push("W"),s.push("n"),s.push("0 g"),s.push("BT"),s.push("/"+t+" "+sr(o.fontSize)+" Tf "+n),s.push(o.text),s.push("ET"),s.push("Q"),e.stream=s.join(`
`),e},OffPushDown:function(r){var e=Ho(r);e.scope=r.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+sr(_t.internal.getWidth(r))+" "+sr(_t.internal.getHeight(r))+" re"),t.push("f"),e.stream=t.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(r){var e={D:{Off:_t.RadioButton.Circle.OffPushDown},N:{}};return e.N[r]=_t.RadioButton.Circle.YesNormal,e.D[r]=_t.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(r){var e=Ho(r);e.scope=r.scope;var t=[],n=_t.internal.getWidth(r)<=_t.internal.getHeight(r)?_t.internal.getWidth(r)/4:_t.internal.getHeight(r)/4;n=Number((.9*n).toFixed(5));var s=_t.internal.Bezier_C,i=Number((n*s).toFixed(5));return t.push("q"),t.push("1 0 0 1 "+Nc(_t.internal.getWidth(r)/2)+" "+Nc(_t.internal.getHeight(r)/2)+" cm"),t.push(n+" 0 m"),t.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),t.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),t.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),t.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(r){var e=Ho(r);e.scope=r.scope;var t=[],n=_t.internal.getWidth(r)<=_t.internal.getHeight(r)?_t.internal.getWidth(r)/4:_t.internal.getHeight(r)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),i=Number((s*_t.internal.Bezier_C).toFixed(5)),a=Number((n*_t.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+Nc(_t.internal.getWidth(r)/2)+" "+Nc(_t.internal.getHeight(r)/2)+" cm"),t.push(s+" 0 m"),t.push(s+" "+i+" "+i+" "+s+" 0 "+s+" c"),t.push("-"+i+" "+s+" -"+s+" "+i+" -"+s+" 0 c"),t.push("-"+s+" -"+i+" -"+i+" -"+s+" 0 -"+s+" c"),t.push(i+" -"+s+" "+s+" -"+i+" "+s+" 0 c"),t.push("f"),t.push("Q"),t.push("0 g"),t.push("q"),t.push("1 0 0 1 "+Nc(_t.internal.getWidth(r)/2)+" "+Nc(_t.internal.getHeight(r)/2)+" cm"),t.push(n+" 0 m"),t.push(n+" "+a+" "+a+" "+n+" 0 "+n+" c"),t.push("-"+a+" "+n+" -"+n+" "+a+" -"+n+" 0 c"),t.push("-"+n+" -"+a+" -"+a+" -"+n+" 0 -"+n+" c"),t.push(a+" -"+n+" "+n+" -"+a+" "+n+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},OffPushDown:function(r){var e=Ho(r);e.scope=r.scope;var t=[],n=_t.internal.getWidth(r)<=_t.internal.getHeight(r)?_t.internal.getWidth(r)/4:_t.internal.getHeight(r)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),i=Number((s*_t.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+Nc(_t.internal.getWidth(r)/2)+" "+Nc(_t.internal.getHeight(r)/2)+" cm"),t.push(s+" 0 m"),t.push(s+" "+i+" "+i+" "+s+" 0 "+s+" c"),t.push("-"+i+" "+s+" -"+s+" "+i+" -"+s+" 0 c"),t.push("-"+s+" -"+i+" -"+i+" -"+s+" 0 -"+s+" c"),t.push(i+" -"+s+" "+s+" -"+i+" "+s+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e}},Cross:{createAppearanceStream:function(r){var e={D:{Off:_t.RadioButton.Cross.OffPushDown},N:{}};return e.N[r]=_t.RadioButton.Cross.YesNormal,e.D[r]=_t.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(r){var e=Ho(r);e.scope=r.scope;var t=[],n=_t.internal.calculateCross(r);return t.push("q"),t.push("1 1 "+sr(_t.internal.getWidth(r)-2)+" "+sr(_t.internal.getHeight(r)-2)+" re"),t.push("W"),t.push("n"),t.push(sr(n.x1.x)+" "+sr(n.x1.y)+" m"),t.push(sr(n.x2.x)+" "+sr(n.x2.y)+" l"),t.push(sr(n.x4.x)+" "+sr(n.x4.y)+" m"),t.push(sr(n.x3.x)+" "+sr(n.x3.y)+" l"),t.push("s"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(r){var e=Ho(r);e.scope=r.scope;var t=_t.internal.calculateCross(r),n=[];return n.push("0.749023 g"),n.push("0 0 "+sr(_t.internal.getWidth(r))+" "+sr(_t.internal.getHeight(r))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+sr(_t.internal.getWidth(r)-2)+" "+sr(_t.internal.getHeight(r)-2)+" re"),n.push("W"),n.push("n"),n.push(sr(t.x1.x)+" "+sr(t.x1.y)+" m"),n.push(sr(t.x2.x)+" "+sr(t.x2.y)+" l"),n.push(sr(t.x4.x)+" "+sr(t.x4.y)+" m"),n.push(sr(t.x3.x)+" "+sr(t.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(r){var e=Ho(r);e.scope=r.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+sr(_t.internal.getWidth(r))+" "+sr(_t.internal.getHeight(r))+" re"),t.push("f"),e.stream=t.join(`
`),e}}},createDefaultAppearanceStream:function(r){var e=r.scope.internal.getFont(r.fontName,r.fontStyle).id,t=r.scope.__private__.encodeColorString(r.color);return"/"+e+" "+r.fontSize+" Tf "+t}};_t.internal={Bezier_C:.551915024494,calculateCross:function(r){var e=_t.internal.getWidth(r),t=_t.internal.getHeight(r),n=Math.min(e,t);return{x1:{x:(e-n)/2,y:(t-n)/2+n},x2:{x:(e-n)/2+n,y:(t-n)/2},x3:{x:(e-n)/2,y:(t-n)/2},x4:{x:(e-n)/2+n,y:(t-n)/2+n}}}},_t.internal.getWidth=function(r){var e=0;return nn(r)==="object"&&(e=DS(r.Rect[2])),e},_t.internal.getHeight=function(r){var e=0;return nn(r)==="object"&&(e=DS(r.Rect[3])),e};var mW=$n.addField=function(r){if(pW(this,r),!(r instanceof Bo))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=r).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),r.page=r.scope.internal.getCurrentPageInfo().pageNumber,this};$n.AcroFormChoiceField=ju,$n.AcroFormListBox=Vu,$n.AcroFormComboBox=$u,$n.AcroFormEditBox=om,$n.AcroFormButton=Gs,$n.AcroFormPushButton=lm,$n.AcroFormRadioButton=Gu,$n.AcroFormCheckBox=cm,$n.AcroFormTextField=Cd,$n.AcroFormPasswordField=Am,$n.AcroFormAppearance=_t,$n.AcroForm={ChoiceField:ju,ListBox:Vu,ComboBox:$u,EditBox:om,Button:Gs,PushButton:lm,RadioButton:Gu,CheckBox:cm,TextField:Cd,PasswordField:Am,Appearance:_t},kt.AcroForm={ChoiceField:ju,ListBox:Vu,ComboBox:$u,EditBox:om,Button:Gs,PushButton:lm,RadioButton:Gu,CheckBox:cm,TextField:Cd,PasswordField:Am,Appearance:_t};kt.AcroForm;function jF(r){return r.reduce(function(e,t,n){return e[t]=n,e},{})}(function(r){var e="addImage_";r.__addimage__={};var t="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},s=r.__addimage__.getImageFileTypeByImageData=function(k,_){var T,L,K,se,X,$=t;if((_=_||t)==="RGBA"||k.data!==void 0&&k.data instanceof Uint8ClampedArray&&"height"in k&&"width"in k)return"RGBA";if(N(k))for(X in n)for(K=n[X],T=0;T<K.length;T+=1){for(se=!0,L=0;L<K[T].length;L+=1)if(K[T][L]!==void 0&&K[T][L]!==k[L]){se=!1;break}if(se===!0){$=X;break}}else for(X in n)for(K=n[X],T=0;T<K.length;T+=1){for(se=!0,L=0;L<K[T].length;L+=1)if(K[T][L]!==void 0&&K[T][L]!==k.charCodeAt(L)){se=!1;break}if(se===!0){$=X;break}}return $===t&&_!==t&&($=_),$},i=function k(_){for(var T=this.internal.write,L=this.internal.putStream,K=(0,this.internal.getFilters)();K.indexOf("FlateEncode")!==-1;)K.splice(K.indexOf("FlateEncode"),1);_.objectId=this.internal.newObject();var se=[];if(se.push({key:"Type",value:"/XObject"}),se.push({key:"Subtype",value:"/Image"}),se.push({key:"Width",value:_.width}),se.push({key:"Height",value:_.height}),_.colorSpace===m.INDEXED?se.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(_.palette.length/3-1)+" "+("sMask"in _&&_.sMask!==void 0?_.objectId+2:_.objectId+1)+" 0 R]"}):(se.push({key:"ColorSpace",value:"/"+_.colorSpace}),_.colorSpace===m.DEVICE_CMYK&&se.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),se.push({key:"BitsPerComponent",value:_.bitsPerComponent}),"decodeParameters"in _&&_.decodeParameters!==void 0&&se.push({key:"DecodeParms",value:"<<"+_.decodeParameters+">>"}),"transparency"in _&&Array.isArray(_.transparency)&&_.transparency.length>0){for(var X="",$=0,V=_.transparency.length;$<V;$++)X+=_.transparency[$]+" "+_.transparency[$]+" ";se.push({key:"Mask",value:"["+X+"]"})}_.sMask!==void 0&&se.push({key:"SMask",value:_.objectId+1+" 0 R"});var he=_.filter!==void 0?["/"+_.filter]:void 0;if(L({data:_.data,ProgressKeyValues:se,alreadyAppliedFilters:he,objectId:_.objectId}),T("endobj"),"sMask"in _&&_.sMask!==void 0){var z,M=(z=_.sMaskBitsPerComponent)!==null&&z!==void 0?z:_.bitsPerComponent,O={width:_.width,height:_.height,colorSpace:"DeviceGray",bitsPerComponent:M,data:_.sMask};"filter"in _&&(O.decodeParameters="/Predictor ".concat(_.predictor," /Colors 1 /BitsPerComponent ").concat(M," /Columns ").concat(_.width),O.filter=_.filter),k.call(this,O)}if(_.colorSpace===m.INDEXED){var H=this.internal.newObject();L({data:w(new Uint8Array(_.palette)),objectId:H}),T("endobj")}},a=function(){var k=this.internal.collections[e+"images"];for(var _ in k)i.call(this,k[_])},o=function(){var k,_=this.internal.collections[e+"images"],T=this.internal.write;for(var L in _)T("/I"+(k=_[L]).index,k.objectId,"0","R")},l=function(){this.internal.collections[e+"images"]||(this.internal.collections[e+"images"]={},this.internal.events.subscribe("putResources",a),this.internal.events.subscribe("putXobjectDict",o))},c=function(){var k=this.internal.collections[e+"images"];return l.call(this),k},A=function(){return Object.keys(this.internal.collections[e+"images"]).length},d=function(k){return typeof r["process"+k.toUpperCase()]=="function"},h=function(k){return nn(k)==="object"&&k.nodeType===1},u=function(k,_){if(k.nodeName==="IMG"&&k.hasAttribute("src")){var T=""+k.getAttribute("src");if(T.indexOf("data:image/")===0)return am(unescape(T).split("base64,").pop());var L=r.loadFile(T,!0);if(L!==void 0)return L}if(k.nodeName==="CANVAS"){if(k.width===0||k.height===0)throw new Error("Given canvas must have data. Canvas width: "+k.width+", height: "+k.height);var K;switch(_){case"PNG":K="image/png";break;case"WEBP":K="image/webp";break;default:K="image/jpeg"}return am(k.toDataURL(K,1).split("base64,").pop())}},p=function(k){var _=this.internal.collections[e+"images"];if(_){for(var T in _)if(k===_[T].alias)return _[T]}},f=function(k,_,T){return k||_||(k=-96,_=-96),k<0&&(k=-1*T.width*72/k/this.internal.scaleFactor),_<0&&(_=-1*T.height*72/_/this.internal.scaleFactor),k===0&&(k=_*T.width/T.height),_===0&&(_=k*T.height/T.width),[k,_]},g=function(k,_,T,L,K,se){var X=f.call(this,T,L,K),$=this.internal.getCoordinateString,V=this.internal.getVerticalCoordinateString,he=c.call(this);if(T=X[0],L=X[1],he[K.index]=K,se){se*=Math.PI/180;var z=Math.cos(se),M=Math.sin(se),O=function(J){return J.toFixed(4)},H=[O(z),O(M),O(-1*M),O(z),0,0,"cm"]}this.internal.write("q"),se?(this.internal.write([1,"0","0",1,$(k),V(_+L),"cm"].join(" ")),this.internal.write(H.join(" ")),this.internal.write([$(T),"0","0",$(L),"0","0","cm"].join(" "))):this.internal.write([$(T),"0","0",$(L),$(k),V(_+L),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+K.index+" Do"),this.internal.write("Q")},m=r.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};r.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var x=r.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},S=r.__addimage__.sHashCode=function(k){var _,T,L=0;if(typeof k=="string")for(T=k.length,_=0;_<T;_++)L=(L<<5)-L+k.charCodeAt(_),L|=0;else if(N(k))for(T=k.byteLength/2,_=0;_<T;_++)L=(L<<5)-L+k[_],L|=0;return L},B=r.__addimage__.validateStringAsBase64=function(k){(k=k||"").toString().trim();var _=!0;return k.length===0&&(_=!1),k.length%4!=0&&(_=!1),/^[A-Za-z0-9+/]+$/.test(k.substr(0,k.length-2))===!1&&(_=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(k.substr(-2))===!1&&(_=!1),_},F=r.__addimage__.extractImageFromDataUrl=function(k){if(k==null||!(k=k.trim()).startsWith("data:"))return null;var _=k.indexOf(",");return _<0?null:k.substring(0,_).trim().endsWith("base64")?k.substring(_+1):null};r.__addimage__.isArrayBuffer=function(k){return k instanceof ArrayBuffer};var N=r.__addimage__.isArrayBufferView=function(k){return k instanceof Int8Array||k instanceof Uint8Array||k instanceof Uint8ClampedArray||k instanceof Int16Array||k instanceof Uint16Array||k instanceof Int32Array||k instanceof Uint32Array||k instanceof Float32Array||k instanceof Float64Array},E=r.__addimage__.binaryStringToUint8Array=function(k){for(var _=k.length,T=new Uint8Array(_),L=0;L<_;L++)T[L]=k.charCodeAt(L);return T},w=r.__addimage__.arrayBufferToBinaryString=function(k){for(var _="",T=N(k)?k:new Uint8Array(k),L=0;L<T.length;L+=8192)_+=String.fromCharCode.apply(null,T.subarray(L,L+8192));return _};r.addImage=function(){var k,_,T,L,K,se,X,$,V;if(typeof arguments[1]=="number"?(_=t,T=arguments[1],L=arguments[2],K=arguments[3],se=arguments[4],X=arguments[5],$=arguments[6],V=arguments[7]):(_=arguments[1],T=arguments[2],L=arguments[3],K=arguments[4],se=arguments[5],X=arguments[6],$=arguments[7],V=arguments[8]),nn(k=arguments[0])==="object"&&!h(k)&&"imageData"in k){var he=k;k=he.imageData,_=he.format||_||t,T=he.x||T||0,L=he.y||L||0,K=he.w||he.width||K,se=he.h||he.height||se,X=he.alias||X,$=he.compression||$,V=he.rotation||he.angle||V}var z=this.internal.getFilters();if($===void 0&&z.indexOf("FlateEncode")!==-1&&($="SLOW"),isNaN(T)||isNaN(L))throw new Error("Invalid coordinates passed to jsPDF.addImage");l.call(this);var M=v.call(this,k,_,X,$);return g.call(this,T,L,K,se,M,V),this};var v=function(k,_,T,L){var K,se,X;if(typeof k=="string"&&s(k)===t){k=unescape(k);var $=I(k,!1);($!==""||($=r.loadFile(k,!0))!==void 0)&&(k=$)}if(h(k)&&(k=u(k,_)),_=s(k,_),!d(_))throw new Error("addImage does not support files of type '"+_+"', please ensure that a plugin for '"+_+"' support is added.");if(((X=T)==null||X.length===0)&&(T=(function(V){return typeof V=="string"||N(V)?S(V):N(V.data)?S(V.data):null})(k)),(K=p.call(this,T))||(k instanceof Uint8Array||_==="RGBA"||(se=k,k=E(k)),K=this["process"+_.toUpperCase()](k,A.call(this),T,(function(V){return V&&typeof V=="string"&&(V=V.toUpperCase()),V in r.image_compression?V:x.NONE})(L),se)),!K)throw new Error("An unknown error occurred whilst processing the image.");return K},I=r.__addimage__.convertBase64ToBinaryString=function(k,_){_=typeof _!="boolean"||_;var T,L="";if(typeof k=="string"){var K;T=(K=F(k))!==null&&K!==void 0?K:k;try{L=am(T)}catch(se){if(_)throw B(T)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+se.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return L};r.getImageProperties=function(k){var _,T,L="";if(h(k)&&(k=u(k)),typeof k=="string"&&s(k)===t&&((L=I(k,!1))===""&&(L=r.loadFile(k)||""),k=L),T=s(k),!d(T))throw new Error("addImage does not support files of type '"+T+"', please ensure that a plugin for '"+T+"' support is added.");if(k instanceof Uint8Array||(k=E(k)),!(_=this["process"+T.toUpperCase()](k)))throw new Error("An unknown error occurred whilst processing the image");return _.fileType=T,_}})(kt.API),(function(r){var e=function(t){if(t!==void 0&&t!="")return!0};kt.API.events.push(["addPage",function(t){this.internal.getPageInfo(t.pageNumber).pageContext.annotations=[]}]),r.events.push(["putPage",function(t){for(var n,s,i,a=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,l=this.internal.getPageInfoByObjId(t.objId),c=t.pageContext.annotations,A=!1,d=0;d<c.length&&!A;d++)switch((n=c[d]).type){case"link":(e(n.options.url)||e(n.options.pageNumber))&&(A=!0);break;case"reference":case"text":case"freetext":A=!0}if(A!=0){this.internal.write("/Annots [");for(var h=0;h<c.length;h++){n=c[h];var u=this.internal.pdfEscape,p=this.internal.getEncryptor(t.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var f=this.internal.newProgressObject(),g=this.internal.newProgressObject(),m=this.internal.getEncryptor(f.objId),x=n.title||"Note";i="<</Type /Annot /Subtype /Text "+(s="/Rect ["+a(n.bounds.x)+" "+o(n.bounds.y+n.bounds.h)+" "+a(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y)+"] ")+"/Contents ("+u(m(n.contents))+")",i+=" /Popup "+g.objId+" 0 R",i+=" /P "+l.objId+" 0 R",i+=" /T ("+u(m(x))+") >>",f.content=i;var S=f.objId+" 0 R";i="<</Type /Annot /Subtype /Popup "+(s="/Rect ["+a(n.bounds.x+30)+" "+o(n.bounds.y+n.bounds.h)+" "+a(n.bounds.x+n.bounds.w+30)+" "+o(n.bounds.y)+"] ")+" /Parent "+S,n.open&&(i+=" /Open true"),i+=" >>",g.content=i,this.internal.write(f.objId,"0 R",g.objId,"0 R");break;case"freetext":s="/Rect ["+a(n.bounds.x)+" "+o(n.bounds.y)+" "+a(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y+n.bounds.h)+"] ";var B=n.color||"#000000";i="<</Type /Annot /Subtype /FreeText "+s+"/Contents ("+u(p(n.contents))+")",i+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+B+")",i+=" /Border [0 0 0]",i+=" >>",this.internal.write(i);break;case"link":if(n.options.name){var F=this.annotations._nameMap[n.options.name];n.options.pageNumber=F.page,n.options.top=F.y}else n.options.top||(n.options.top=0);if(s="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",i="",n.options.url)i="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /A <</S /URI /URI ("+u(p(n.options.url))+") >>";else if(n.options.pageNumber)switch(i="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":i+=" /Fit]";break;case"FitH":i+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,i+=" /FitV "+n.options.left+"]";break;default:var N=o(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),i+=" /XYZ "+n.options.left+" "+N+" "+n.options.zoom+"]"}i!=""&&(i+=" >>",this.internal.write(i))}}this.internal.write("]")}}]),r.createAnnotation=function(t){var n=this.internal.getCurrentPageInfo();switch(t.type){case"link":this.link(t.bounds.x,t.bounds.y,t.bounds.w,t.bounds.h,t);break;case"text":case"freetext":n.pageContext.annotations.push(t)}},r.link=function(t,n,s,i,a){var o=this.internal.getCurrentPageInfo(),l=this.internal.getCoordinateString,c=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:l(t),y:c(n),w:l(t+s),h:c(n+i)},options:a,type:"link"})},r.textWithLink=function(t,n,s,i){var a,o,l=this.getTextWidth(t),c=this.internal.getLineHeight()/this.internal.scaleFactor;if(i.maxWidth!==void 0){o=i.maxWidth;var A=this.splitTextToSize(t,o).length;a=Math.ceil(c*A)}else o=l,a=c;return this.text(t,n,s,i),s+=.2*c,i.align==="center"&&(n-=l/2),i.align==="right"&&(n-=l),this.link(n,s-c,o,a,i),l},r.getTextWidth=function(t){var n=this.internal.getFontSize();return this.getStringUnitWidth(t)*n/this.internal.scaleFactor}})(kt.API),(function(r){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},t={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},s=[1570,1571,1573,1575];r.__arabicParser__={};var i=r.__arabicParser__.isInArabicSubstitutionA=function(f){return e[f.charCodeAt(0)]!==void 0},a=r.__arabicParser__.isArabicLetter=function(f){return typeof f=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(f)},o=r.__arabicParser__.isArabicEndLetter=function(f){return a(f)&&i(f)&&e[f.charCodeAt(0)].length<=2},l=r.__arabicParser__.isArabicAlfLetter=function(f){return a(f)&&s.indexOf(f.charCodeAt(0))>=0};r.__arabicParser__.arabicLetterHasIsolatedForm=function(f){return a(f)&&i(f)&&e[f.charCodeAt(0)].length>=1};var c=r.__arabicParser__.arabicLetterHasFinalForm=function(f){return a(f)&&i(f)&&e[f.charCodeAt(0)].length>=2};r.__arabicParser__.arabicLetterHasInitialForm=function(f){return a(f)&&i(f)&&e[f.charCodeAt(0)].length>=3};var A=r.__arabicParser__.arabicLetterHasMedialForm=function(f){return a(f)&&i(f)&&e[f.charCodeAt(0)].length==4},d=r.__arabicParser__.resolveLigatures=function(f){var g=0,m=t,x="",S=0;for(g=0;g<f.length;g+=1)m[f.charCodeAt(g)]!==void 0?(S++,typeof(m=m[f.charCodeAt(g)])=="number"&&(x+=String.fromCharCode(m),m=t,S=0),g===f.length-1&&(m=t,x+=f.charAt(g-(S-1)),g-=S-1,S=0)):(m=t,x+=f.charAt(g-S),g-=S,S=0);return x};r.__arabicParser__.isArabicDiacritic=function(f){return f!==void 0&&n[f.charCodeAt(0)]!==void 0};var h=r.__arabicParser__.getCorrectForm=function(f,g,m){return a(f)?i(f)===!1?-1:!c(f)||!a(g)&&!a(m)||!a(m)&&o(g)||o(f)&&!a(g)||o(f)&&l(g)||o(f)&&o(g)?0:A(f)&&a(g)&&!o(g)&&a(m)&&c(m)?3:o(f)||!a(m)?1:2:-1},u=function(f){var g=0,m=0,x=0,S="",B="",F="",N=(f=f||"").split("\\s+"),E=[];for(g=0;g<N.length;g+=1){for(E.push(""),m=0;m<N[g].length;m+=1)S=N[g][m],B=N[g][m-1],F=N[g][m+1],a(S)?(x=h(S,B,F),E[g]+=x!==-1?String.fromCharCode(e[S.charCodeAt(0)][x]):S):E[g]+=S;E[g]=d(E[g])}return E.join(" ")},p=r.__arabicParser__.processArabic=r.processArabic=function(){var f,g=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,m=[];if(Array.isArray(g)){var x=0;for(m=[],x=0;x<g.length;x+=1)Array.isArray(g[x])?m.push([u(g[x][0]),g[x][1],g[x][2]]):m.push([u(g[x])]);f=m}else f=u(g);return typeof arguments[0]=="string"?f:(arguments[0].text=f,arguments[0])};r.events.push(["preProcessText",p])})(kt.API),kt.API.autoPrint=function(r){var e;return(r=r||{}).variant=r.variant||"non-conform",r.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},(function(r){var e=function(){var t=void 0;Object.defineProperty(this,"pdf",{get:function(){return t},set:function(o){t=o}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(o){n=isNaN(o)||Number.isInteger(o)===!1||o<0?150:o,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var s=300;Object.defineProperty(this,"height",{get:function(){return s},set:function(o){s=isNaN(o)||Number.isInteger(o)===!1||o<0?300:o,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=s+1)}});var i=[];Object.defineProperty(this,"childNodes",{get:function(){return i},set:function(o){i=o}});var a={};Object.defineProperty(this,"style",{get:function(){return a},set:function(o){a=o}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(t,n){var s;if((t=t||"2d")!=="2d")return null;for(s in n)this.pdf.context2d.hasOwnProperty(s)&&(this.pdf.context2d[s]=n[s]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},r.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])})(kt.API),(function(r){var e={left:0,top:0,bottom:0,right:0},t=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),s.call(this))},s=function(){this.internal.__cell__.lastCell=new i,this.internal.__cell__.pages=1},i=function(){var l=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return l},set:function(f){l=f}});var c=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return c},set:function(f){c=f}});var A=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return A},set:function(f){A=f}});var d=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return d},set:function(f){d=f}});var h=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return h},set:function(f){h=f}});var u=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return u},set:function(f){u=f}});var p=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return p},set:function(f){p=f}}),this};i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},i.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},r.setHeaderFunction=function(l){return n.call(this),this.internal.__cell__.headerFunction=typeof l=="function"?l:void 0,this},r.getTextDimensions=function(l,c){n.call(this);var A=(c=c||{}).fontSize||this.getFontSize(),d=c.font||this.getFont(),h=c.scaleFactor||this.internal.scaleFactor,u=0,p=0,f=0,g=this;if(!Array.isArray(l)&&typeof l!="string"){if(typeof l!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");l=String(l)}var m=c.maxWidth;m>0?typeof l=="string"?l=this.splitTextToSize(l,m):Object.prototype.toString.call(l)==="[object Array]"&&(l=l.reduce(function(S,B){return S.concat(g.splitTextToSize(B,m))},[])):l=Array.isArray(l)?l:[l];for(var x=0;x<l.length;x++)u<(f=this.getStringUnitWidth(l[x],{font:d})*A)&&(u=f);return u!==0&&(p=l.length),{w:u/=h,h:Math.max((p*A*this.getLineHeightFactor()-A*(this.getLineHeightFactor()-1))/h,0)}},r.cellAddPage=function(){n.call(this),this.addPage();var l=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new i(l.left,l.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var a=r.cell=function(){var l;l=arguments[0]instanceof i?arguments[0]:new i(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var c=this.internal.__cell__.lastCell,A=this.internal.__cell__.padding,d=this.internal.__cell__.margins||e,h=this.internal.__cell__.tableHeaderRow,u=this.internal.__cell__.printHeaders;return c.lineNumber!==void 0&&(c.lineNumber===l.lineNumber?(l.x=(c.x||0)+(c.width||0),l.y=c.y||0):c.y+c.height+l.height+d.bottom>this.getPageHeight()?(this.cellAddPage(),l.y=d.top,u&&h&&(this.printHeaderRow(l.lineNumber,!0),l.y+=h[0].height)):l.y=c.y+c.height||l.y),l.text[0]!==void 0&&(this.rect(l.x,l.y,l.width,l.height,t===!0?"FD":void 0),l.align==="right"?this.text(l.text,l.x+l.width-A,l.y+A,{align:"right",baseline:"top"}):l.align==="center"?this.text(l.text,l.x+l.width/2,l.y+A,{align:"center",baseline:"top",maxWidth:l.width-A-A}):this.text(l.text,l.x+A,l.y+A,{align:"left",baseline:"top",maxWidth:l.width-A-A})),this.internal.__cell__.lastCell=l,this};r.table=function(l,c,A,d,h){if(n.call(this),!A)throw new Error("No data for PDF table.");var u,p,f,g,m=[],x=[],S=[],B={},F={},N=[],E=[],w=(h=h||{}).autoSize||!1,v=h.printHeaders!==!1,I=h.css&&h.css["font-size"]!==void 0?16*h.css["font-size"]:h.fontSize||12,k=h.margins||Object.assign({width:this.getPageWidth()},e),_=typeof h.padding=="number"?h.padding:3,T=h.headerBackgroundColor||"#c8c8c8",L=h.headerTextColor||"#000";if(s.call(this),this.internal.__cell__.printHeaders=v,this.internal.__cell__.margins=k,this.internal.__cell__.table_font_size=I,this.internal.__cell__.padding=_,this.internal.__cell__.headerBackgroundColor=T,this.internal.__cell__.headerTextColor=L,this.setFontSize(I),d==null)x=m=Object.keys(A[0]),S=m.map(function(){return"left"});else if(Array.isArray(d)&&nn(d[0])==="object")for(m=d.map(function(he){return he.name}),x=d.map(function(he){return he.prompt||he.name||""}),S=d.map(function(he){return he.align||"left"}),u=0;u<d.length;u+=1)F[d[u].name]=.7499990551181103*d[u].width;else Array.isArray(d)&&typeof d[0]=="string"&&(x=m=d,S=m.map(function(){return"left"}));if(w||Array.isArray(d)&&typeof d[0]=="string")for(u=0;u<m.length;u+=1){for(B[g=m[u]]=A.map(function(he){return he[g]}),this.setFont(void 0,"bold"),N.push(this.getTextDimensions(x[u],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),p=B[g],this.setFont(void 0,"normal"),f=0;f<p.length;f+=1)N.push(this.getTextDimensions(p[f],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);F[g]=Math.max.apply(null,N)+_+_,N=[]}if(v){var K={};for(u=0;u<m.length;u+=1)K[m[u]]={},K[m[u]].text=x[u],K[m[u]].align=S[u];var se=o.call(this,K,F);E=m.map(function(he){return new i(l,c,F[he],se,K[he].text,void 0,K[he].align)}),this.setTableHeaderRow(E),this.printHeaderRow(1,!1)}var X=d.reduce(function(he,z){return he[z.name]=z.align,he},{});for(u=0;u<A.length;u+=1){"rowStart"in h&&h.rowStart instanceof Function&&h.rowStart({row:u,data:A[u]},this);var $=o.call(this,A[u],F);for(f=0;f<m.length;f+=1){var V=A[u][m[f]];"cellStart"in h&&h.cellStart instanceof Function&&h.cellStart({row:u,col:f,data:V},this),a.call(this,new i(l,c,F[m[f]],$,V,u+2,X[m[f]]))}}return this.internal.__cell__.table_x=l,this.internal.__cell__.table_y=c,this};var o=function(l,c){var A=this.internal.__cell__.padding,d=this.internal.__cell__.table_font_size,h=this.internal.scaleFactor;return Object.keys(l).map(function(u){var p=l[u];return this.splitTextToSize(p.hasOwnProperty("text")?p.text:p,c[u]-A-A)},this).map(function(u){return this.getLineHeightFactor()*u.length*d/h+A+A},this).reduce(function(u,p){return Math.max(u,p)},0)};r.setTableHeaderRow=function(l){n.call(this),this.internal.__cell__.tableHeaderRow=l},r.printHeaderRow=function(l,c){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var A;if(t=!0,typeof this.internal.__cell__.headerFunction=="function"){var d=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new i(d[0],d[1],d[2],d[3],void 0,-1)}this.setFont(void 0,"bold");for(var h=[],u=0;u<this.internal.__cell__.tableHeaderRow.length;u+=1){A=this.internal.__cell__.tableHeaderRow[u].clone(),c&&(A.y=this.internal.__cell__.margins.top||0,h.push(A)),A.lineNumber=l;var p=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),a.call(this,A),this.setTextColor(p)}h.length>0&&this.setTableHeaderRow(h),this.setFont(void 0,"normal"),t=!1}})(kt.API);var VF={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},$F=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],k1=jF($F),GF=[100,200,300,400,500,600,700,800,900],bW=jF(GF);function $w(r){var e=r.family.replace(/"|'/g,"").toLowerCase(),t=(function(i){return VF[i=i||"normal"]?i:"normal"})(r.style),n=(function(i){return i?typeof i=="number"?i>=100&&i<=900&&i%100==0?i:400:/^\d00$/.test(i)?parseInt(i):i==="bold"?700:400:400})(r.weight),s=(function(i){return typeof k1[i=i||"normal"]=="number"?i:"normal"})(r.stretch);return{family:e,style:t,weight:n,stretch:s,src:r.src||[],ref:r.ref||{name:e,style:[s,t,n].join(" ")}}}function RS(r,e,t,n){var s;for(s=t;s>=0&&s<e.length;s+=n)if(r[e[s]])return r[e[s]];for(s=t;s>=0&&s<e.length;s-=n)if(r[e[s]])return r[e[s]]}var yW={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},OS={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function QS(r){return[r.stretch,r.style,r.weight,r.family].join(" ")}function HS(r){return r.trimLeft()}function wW(r,e){for(var t=0;t<r.length;){if(r.charAt(t)===e)return[r.substring(0,t),r.substring(t+1)];t+=1}return null}function vW(r){var e=r.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],r.substring(e[0].length)]}var T0,jS,VS,vu,F0,$S,GS,zS,Gw=["times"];function KS(r,e,t,n,s){var i=4,a=WS;switch(s){case kt.API.image_compression.FAST:i=1,a=qS;break;case kt.API.image_compression.MEDIUM:i=6,a=YS;break;case kt.API.image_compression.SLOW:i=9,a=XS}r=(function(l,c,A,d){for(var h,u=l.length/c,p=new Uint8Array(l.length+u),f=[xW,qS,WS,YS,XS],g=0;g<u;g+=1){var m=g*c,x=l.subarray(m,m+c);if(d)p.set(d(x,A,h),m+g);else{for(var S=f.length,B=[],F=0;F<S;F+=1)B[F]=f[F](x,A,h);var N=BW(B.concat());p.set(B[N],m+g)}h=x}return p})(r,e,Math.ceil(t*n/8),a);var o=w1(r,{level:i});return kt.API.__addimage__.arrayBufferToBinaryString(o)}function xW(r){var e=Array.apply([],r);return e.unshift(0),e}function qS(r,e){var t=r.length,n=[];n[0]=1;for(var s=0;s<t;s+=1){var i=r[s-e]||0;n[s+1]=r[s]-i+256&255}return n}function WS(r,e,t){var n=r.length,s=[];s[0]=2;for(var i=0;i<n;i+=1){var a=t&&t[i]||0;s[i+1]=r[i]-a+256&255}return s}function YS(r,e,t){var n=r.length,s=[];s[0]=3;for(var i=0;i<n;i+=1){var a=r[i-e]||0,o=t&&t[i]||0;s[i+1]=r[i]+256-(a+o>>>1)&255}return s}function XS(r,e,t){var n=r.length,s=[];s[0]=4;for(var i=0;i<n;i+=1){var a=_W(r[i-e]||0,t&&t[i]||0,t&&t[i-e]||0);s[i+1]=r[i]-a+256&255}return s}function _W(r,e,t){if(r===e&&e===t)return r;var n=Math.abs(e-t),s=Math.abs(r-t),i=Math.abs(r+e-t-t);return n<=s&&n<=i?r:s<=i?e:t}function BW(r){var e=r.map(function(t){return t.reduce(function(n,s){return n+Math.abs(s)},0)});return e.indexOf(Math.min.apply(null,e))}function zw(r,e,t){var n=e*t,s=Math.floor(n/8),i=16-(n-8*s+t),a=(1<<t)-1;return zF(r,s)>>i&a}function JS(r,e,t,n){var s=t*n,i=Math.floor(s/8),a=16-(s-8*i+n),o=(1<<n)-1,l=(e&o)<<a;(function(c,A,d){if(A+1<c.byteLength)c.setUint16(A,d,!1);else{var h=d>>8&255;c.setUint8(A,h)}})(r,i,zF(r,i)&~(o<<a)&65535|l)}function zF(r,e){return e+1<r.byteLength?r.getUint16(e,!1):r.getUint8(e)<<8}function CW(r){var e=0;if(r[e++]!==71||r[e++]!==73||r[e++]!==70||r[e++]!==56||(r[e++]+1&253)!=56||r[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var t=r[e++]|r[e++]<<8,n=r[e++]|r[e++]<<8,s=r[e++],i=s>>7,a=1<<1+(7&s);r[e++],r[e++];var o=null,l=null;i&&(o=e,l=a,e+=3*a);var c=!0,A=[],d=0,h=null,u=0,p=null;for(this.width=t,this.height=n;c&&e<r.length;)switch(r[e++]){case 33:switch(r[e++]){case 255:if(r[e]!==11||r[e+1]==78&&r[e+2]==69&&r[e+3]==84&&r[e+4]==83&&r[e+5]==67&&r[e+6]==65&&r[e+7]==80&&r[e+8]==69&&r[e+9]==50&&r[e+10]==46&&r[e+11]==48&&r[e+12]==3&&r[e+13]==1&&r[e+16]==0)e+=14,p=r[e++]|r[e++]<<8,e++;else for(e+=12;;){if(!((k=r[e++])>=0))throw Error("Invalid block size");if(k===0)break;e+=k}break;case 249:if(r[e++]!==4||r[e+4]!==0)throw new Error("Invalid graphics extension block.");var f=r[e++];d=r[e++]|r[e++]<<8,h=r[e++],1&f||(h=null),u=f>>2&7,e++;break;case 254:for(;;){if(!((k=r[e++])>=0))throw Error("Invalid block size");if(k===0)break;e+=k}break;default:throw new Error("Unknown graphic control label: 0x"+r[e-1].toString(16))}break;case 44:var g=r[e++]|r[e++]<<8,m=r[e++]|r[e++]<<8,x=r[e++]|r[e++]<<8,S=r[e++]|r[e++]<<8,B=r[e++],F=B>>6&1,N=1<<1+(7&B),E=o,w=l,v=!1;B>>7&&(v=!0,E=e,w=N,e+=3*N);var I=e;for(e++;;){var k;if(!((k=r[e++])>=0))throw Error("Invalid block size");if(k===0)break;e+=k}A.push({x:g,y:m,width:x,height:S,has_local_palette:v,palette_offset:E,palette_size:w,data_offset:I,data_length:e-I,transparent_index:h,interlaced:!!F,delay:d,disposal:u});break;case 59:c=!1;break;default:throw new Error("Unknown gif block: 0x"+r[e-1].toString(16))}this.numFrames=function(){return A.length},this.loopCount=function(){return p},this.frameInfo=function(_){if(_<0||_>=A.length)throw new Error("Frame index out of range.");return A[_]},this.decodeAndBlitFrameBGRA=function(_,T){var L=this.frameInfo(_),K=L.width*L.height,se=new Uint8Array(K);ZS(r,L.data_offset,se,K);var X=L.palette_offset,$=L.transparent_index;$===null&&($=256);var V=L.width,he=t-V,z=V,M=4*(L.y*t+L.x),O=4*((L.y+L.height)*t+L.x),H=M,J=4*he;L.interlaced===!0&&(J+=4*t*7);for(var de=8,ie=0,le=se.length;ie<le;++ie){var fe=se[ie];if(z===0&&(z=V,(H+=J)>=O&&(J=4*he+4*t*(de-1),H=M+(V+he)*(de<<1),de>>=1)),fe===$)H+=4;else{var ve=r[X+3*fe],Ce=r[X+3*fe+1],Be=r[X+3*fe+2];T[H++]=Be,T[H++]=Ce,T[H++]=ve,T[H++]=255}--z}},this.decodeAndBlitFrameRGBA=function(_,T){var L=this.frameInfo(_),K=L.width*L.height,se=new Uint8Array(K);ZS(r,L.data_offset,se,K);var X=L.palette_offset,$=L.transparent_index;$===null&&($=256);var V=L.width,he=t-V,z=V,M=4*(L.y*t+L.x),O=4*((L.y+L.height)*t+L.x),H=M,J=4*he;L.interlaced===!0&&(J+=4*t*7);for(var de=8,ie=0,le=se.length;ie<le;++ie){var fe=se[ie];if(z===0&&(z=V,(H+=J)>=O&&(J=4*he+4*t*(de-1),H=M+(V+he)*(de<<1),de>>=1)),fe===$)H+=4;else{var ve=r[X+3*fe],Ce=r[X+3*fe+1],Be=r[X+3*fe+2];T[H++]=ve,T[H++]=Ce,T[H++]=Be,T[H++]=255}--z}}}function ZS(r,e,t,n){for(var s=r[e++],i=1<<s,a=i+1,o=a+1,l=s+1,c=(1<<l)-1,A=0,d=0,h=0,u=r[e++],p=new Int32Array(4096),f=null;;){for(;A<16&&u!==0;)d|=r[e++]<<A,A+=8,u===1?u=r[e++]:--u;if(A<l)break;var g=d&c;if(d>>=l,A-=l,g!==i){if(g===a)break;for(var m=g<o?g:f,x=0,S=m;S>i;)S=p[S]>>8,++x;var B=S;if(h+x+(m!==g?1:0)>n)return void un.log("Warning, gif stream longer than expected.");t[h++]=B;var F=h+=x;for(m!==g&&(t[h++]=B),S=m;x--;)S=p[S],t[--F]=255&S,S>>=8;f!==null&&o<4096&&(p[o++]=f<<8|B,o>=c+1&&l<12&&(++l,c=c<<1|1)),f=g}else o=a+1,c=(1<<(l=s+1))-1,f=null}return h!==n&&un.log("Warning, gif stream shorter than expected."),t}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function Kw(r){var e,t,n,s,i,a=Math.floor,o=new Array(64),l=new Array(64),c=new Array(64),A=new Array(64),d=new Array(65535),h=new Array(65535),u=new Array(64),p=new Array(64),f=[],g=0,m=7,x=new Array(64),S=new Array(64),B=new Array(64),F=new Array(256),N=new Array(2048),E=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],w=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],v=[0,1,2,3,4,5,6,7,8,9,10,11],I=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],k=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],_=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],T=[0,1,2,3,4,5,6,7,8,9,10,11],L=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],K=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function se(M,O){for(var H=0,J=0,de=new Array,ie=1;ie<=16;ie++){for(var le=1;le<=M[ie];le++)de[O[J]]=[],de[O[J]][0]=H,de[O[J]][1]=ie,J++,H++;H*=2}return de}function X(M){for(var O=M[0],H=M[1]-1;H>=0;)O&1<<H&&(g|=1<<m),H--,--m<0&&(g==255?($(255),$(0)):$(g),m=7,g=0)}function $(M){f.push(M)}function V(M){$(M>>8&255),$(255&M)}function he(M,O,H,J,de){for(var ie,le=de[0],fe=de[240],ve=(function(ee,ye){var xe,we,Ee,Ne,Ue,je,st,Ze,ct,wt,it=0;for(ct=0;ct<8;++ct){xe=ee[it],we=ee[it+1],Ee=ee[it+2],Ne=ee[it+3],Ue=ee[it+4],je=ee[it+5],st=ee[it+6];var lt=xe+(Ze=ee[it+7]),tt=xe-Ze,rt=we+st,ft=we-st,St=Ee+je,yt=Ee-je,jt=Ne+Ue,Rt=Ne-Ue,wr=lt+jt,Qr=lt-jt,Lt=rt+St,Ut=rt-St;ee[it]=wr+Lt,ee[it+4]=wr-Lt;var mr=.707106781*(Ut+Qr);ee[it+2]=Qr+mr,ee[it+6]=Qr-mr;var gs=.382683433*((wr=Rt+yt)-(Ut=ft+tt)),Pn=.5411961*wr+gs,hi=1.306562965*Ut+gs,Bs=.707106781*(Lt=yt+ft),Ht=tt+Bs,da=tt-Bs;ee[it+5]=da+Pn,ee[it+3]=da-Pn,ee[it+1]=Ht+hi,ee[it+7]=Ht-hi,it+=8}for(it=0,ct=0;ct<8;++ct){xe=ee[it],we=ee[it+8],Ee=ee[it+16],Ne=ee[it+24],Ue=ee[it+32],je=ee[it+40],st=ee[it+48];var Cs=xe+(Ze=ee[it+56]),Xs=xe-Ze,Js=we+st,Jr=we-st,sn=Ee+je,Xn=Ee-je,Ss=Ne+Ue,ua=Ne-Ue,Zs=Cs+Ss,ei=Cs-Ss,Ps=Js+sn,ti=Js-sn;ee[it]=Zs+Ps,ee[it+32]=Zs-Ps;var Ds=.707106781*(ti+ei);ee[it+16]=ei+Ds,ee[it+48]=ei-Ds;var Rs=.382683433*((Zs=ua+Xn)-(ti=Jr+Xs)),Os=.5411961*Zs+Rs,Qs=1.306562965*ti+Rs,ji=.707106781*(Ps=Xn+Jr),Vi=Xs+ji,$i=Xs-ji;ee[it+40]=$i+Os,ee[it+24]=$i-Os,ee[it+8]=Vi+Qs,ee[it+56]=Vi-Qs,it++}for(ct=0;ct<64;++ct)wt=ee[ct]*ye[ct],u[ct]=wt>0?wt+.5|0:wt-.5|0;return u})(M,O),Ce=0;Ce<64;++Ce)p[E[Ce]]=ve[Ce];var Be=p[0]-H;H=p[0],Be==0?X(J[0]):(X(J[h[ie=32767+Be]]),X(d[ie]));for(var Qe=63;Qe>0&&p[Qe]==0;)Qe--;if(Qe==0)return X(le),H;for(var D,G=1;G<=Qe;){for(var ce=G;p[G]==0&&G<=Qe;)++G;var Z=G-ce;if(Z>=16){D=Z>>4;for(var W=1;W<=D;++W)X(fe);Z&=15}ie=32767+p[G],X(de[(Z<<4)+h[ie]]),X(d[ie]),G++}return Qe!=63&&X(le),H}function z(M){M=Math.min(Math.max(M,1),100),i!=M&&((function(O){for(var H=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],J=0;J<64;J++){var de=a((H[J]*O+50)/100);de=Math.min(Math.max(de,1),255),o[E[J]]=de}for(var ie=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],le=0;le<64;le++){var fe=a((ie[le]*O+50)/100);fe=Math.min(Math.max(fe,1),255),l[E[le]]=fe}for(var ve=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Ce=0,Be=0;Be<8;Be++)for(var Qe=0;Qe<8;Qe++)c[Ce]=1/(o[E[Ce]]*ve[Be]*ve[Qe]*8),A[Ce]=1/(l[E[Ce]]*ve[Be]*ve[Qe]*8),Ce++})(M<50?Math.floor(5e3/M):Math.floor(200-2*M)),i=M)}this.encode=function(M,O){O&&z(O),f=new Array,g=0,m=7,V(65496),V(65504),V(16),$(74),$(70),$(73),$(70),$(0),$(1),$(1),$(0),V(1),V(1),$(0),$(0),(function(){V(65499),V(132),$(0);for(var we=0;we<64;we++)$(o[we]);$(1);for(var Ee=0;Ee<64;Ee++)$(l[Ee])})(),(function(we,Ee){V(65472),V(17),$(8),V(Ee),V(we),$(3),$(1),$(17),$(0),$(2),$(17),$(1),$(3),$(17),$(1)})(M.width,M.height),(function(){V(65476),V(418),$(0);for(var we=0;we<16;we++)$(w[we+1]);for(var Ee=0;Ee<=11;Ee++)$(v[Ee]);$(16);for(var Ne=0;Ne<16;Ne++)$(I[Ne+1]);for(var Ue=0;Ue<=161;Ue++)$(k[Ue]);$(1);for(var je=0;je<16;je++)$(_[je+1]);for(var st=0;st<=11;st++)$(T[st]);$(17);for(var Ze=0;Ze<16;Ze++)$(L[Ze+1]);for(var ct=0;ct<=161;ct++)$(K[ct])})(),V(65498),V(12),$(3),$(1),$(0),$(2),$(17),$(3),$(17),$(0),$(63),$(0);var H=0,J=0,de=0;g=0,m=7,this.encode.displayName="_encode_";for(var ie,le,fe,ve,Ce,Be,Qe,D,G,ce=M.data,Z=M.width,W=M.height,ee=4*Z,ye=0;ye<W;){for(ie=0;ie<ee;){for(Ce=ee*ye+ie,Qe=-1,D=0,G=0;G<64;G++)Be=Ce+(D=G>>3)*ee+(Qe=4*(7&G)),ye+D>=W&&(Be-=ee*(ye+1+D-W)),ie+Qe>=ee&&(Be-=ie+Qe-ee+4),le=ce[Be++],fe=ce[Be++],ve=ce[Be++],x[G]=(N[le]+N[fe+256|0]+N[ve+512|0]>>16)-128,S[G]=(N[le+768|0]+N[fe+1024|0]+N[ve+1280|0]>>16)-128,B[G]=(N[le+1280|0]+N[fe+1536|0]+N[ve+1792|0]>>16)-128;H=he(x,c,H,e,n),J=he(S,A,J,t,s),de=he(B,A,de,t,s),ie+=32}ye+=8}if(m>=0){var xe=[];xe[1]=m+1,xe[0]=(1<<m+1)-1,X(xe)}return V(65497),new Uint8Array(f)},r=r||50,(function(){for(var M=String.fromCharCode,O=0;O<256;O++)F[O]=M(O)})(),e=se(w,v),t=se(_,T),n=se(I,k),s=se(L,K),(function(){for(var M=1,O=2,H=1;H<=15;H++){for(var J=M;J<O;J++)h[32767+J]=H,d[32767+J]=[],d[32767+J][1]=H,d[32767+J][0]=J;for(var de=-(O-1);de<=-M;de++)h[32767+de]=H,d[32767+de]=[],d[32767+de][1]=H,d[32767+de][0]=O-1+de;M<<=1,O<<=1}})(),(function(){for(var M=0;M<256;M++)N[M]=19595*M,N[M+256|0]=38470*M,N[M+512|0]=7471*M+32768,N[M+768|0]=-11059*M,N[M+1024|0]=-21709*M,N[M+1280|0]=32768*M+8421375,N[M+1536|0]=-27439*M,N[M+1792|0]=-5329*M})(),z(r)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function lo(r,e){if(this.pos=0,this.buffer=r,this.datav=new DataView(r.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function ek(r){function e(v){if(!v)throw Error("assert :P")}function t(v,I,k){for(var _=0;4>_;_++)if(v[I+_]!=k.charCodeAt(_))return!0;return!1}function n(v,I,k,_,T){for(var L=0;L<T;L++)v[I+L]=k[_+L]}function s(v,I,k,_){for(var T=0;T<_;T++)v[I+T]=k}function i(v){return new Int32Array(v)}function a(v,I){for(var k=[],_=0;_<v;_++)k.push(new I);return k}function o(v,I){var k=[];return(function _(T,L,K){for(var se=K[L],X=0;X<se&&(T.push(K.length>L+1?[]:new I),!(K.length<L+1));X++)_(T[X],L+1,K)})(k,0,v),k}var l=function(){var v=this;function I(b,C){for(var P=1<<C-1>>>0;b&P;)P>>>=1;return P?(b&P-1)+P:b}function k(b,C,P,Q,Y){e(!(Q%P));do b[C+(Q-=P)]=Y;while(0<Q)}function _(b,C,P,Q,Y){if(e(2328>=Y),512>=Y)var te=i(512);else if((te=i(Y))==null)return 0;return(function(ne,ae,ue,pe,Se,De){var me,ke,Me=ae,Ve=1<<ue,Pe=i(16),Ge=i(16);for(e(Se!=0),e(pe!=null),e(ne!=null),e(0<ue),ke=0;ke<Se;++ke){if(15<pe[ke])return 0;++Pe[pe[ke]]}if(Pe[0]==Se)return 0;for(Ge[1]=0,me=1;15>me;++me){if(Pe[me]>1<<me)return 0;Ge[me+1]=Ge[me]+Pe[me]}for(ke=0;ke<Se;++ke)me=pe[ke],0<pe[ke]&&(De[Ge[me]++]=ke);if(Ge[15]==1)return(pe=new T).g=0,pe.value=De[0],k(ne,Me,1,Ve,pe),Ve;var ze,et=-1,Xe=Ve-1,Nt=0,xt=1,br=1,It=1<<ue;for(ke=0,me=1,Se=2;me<=ue;++me,Se<<=1){if(xt+=br<<=1,0>(br-=Pe[me]))return 0;for(;0<Pe[me];--Pe[me])(pe=new T).g=me,pe.value=De[ke++],k(ne,Me+Nt,Se,It,pe),Nt=I(Nt,me)}for(me=ue+1,Se=2;15>=me;++me,Se<<=1){if(xt+=br<<=1,0>(br-=Pe[me]))return 0;for(;0<Pe[me];--Pe[me]){if(pe=new T,(Nt&Xe)!=et){for(Me+=It,ze=1<<(et=me)-ue;15>et&&!(0>=(ze-=Pe[et]));)++et,ze<<=1;Ve+=It=1<<(ze=et-ue),ne[ae+(et=Nt&Xe)].g=ze+ue,ne[ae+et].value=Me-ae-et}pe.g=me-ue,pe.value=De[ke++],k(ne,Me+(Nt>>ue),Se,It,pe),Nt=I(Nt,me)}}return xt!=2*Ge[15]-1?0:Ve})(b,C,P,Q,Y,te)}function T(){this.value=this.g=0}function L(){this.value=this.g=0}function K(){this.G=a(5,T),this.H=i(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=a(zA,L)}function se(b,C,P,Q){e(b!=null),e(C!=null),e(2147483648>Q),b.Ca=254,b.I=0,b.b=-8,b.Ka=0,b.oa=C,b.pa=P,b.Jd=C,b.Yc=P+Q,b.Zc=4<=Q?P+Q-4+1:P,le(b)}function X(b,C){for(var P=0;0<C--;)P|=ve(b,128)<<C;return P}function $(b,C){var P=X(b,C);return fe(b)?-P:P}function V(b,C,P,Q){var Y,te=0;for(e(b!=null),e(C!=null),e(4294967288>Q),b.Sb=Q,b.Ra=0,b.u=0,b.h=0,4<Q&&(Q=4),Y=0;Y<Q;++Y)te+=C[P+Y]<<8*Y;b.Ra=te,b.bb=Q,b.oa=C,b.pa=P}function he(b){for(;8<=b.u&&b.bb<b.Sb;)b.Ra>>>=8,b.Ra+=b.oa[b.pa+b.bb]<<vc-8>>>0,++b.bb,b.u-=8;J(b)&&(b.h=1,b.u=0)}function z(b,C){if(e(0<=C),!b.h&&C<=ma){var P=H(b)&pa[C];return b.u+=C,he(b),P}return b.h=1,b.u=0}function M(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function O(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function H(b){return b.Ra>>>(b.u&vc-1)>>>0}function J(b){return e(b.bb<=b.Sb),b.h||b.bb==b.Sb&&b.u>vc}function de(b,C){b.u=C,b.h=J(b)}function ie(b){b.u>=Bl&&(e(b.u>=Bl),he(b))}function le(b){e(b!=null&&b.oa!=null),b.pa<b.Zc?(b.I=(b.oa[b.pa++]|b.I<<8)>>>0,b.b+=8):(e(b!=null&&b.oa!=null),b.pa<b.Yc?(b.b+=8,b.I=b.oa[b.pa++]|b.I<<8):b.Ka?b.b=0:(b.I<<=8,b.b+=8,b.Ka=1))}function fe(b){return X(b,1)}function ve(b,C){var P=b.Ca;0>b.b&&le(b);var Q=b.b,Y=P*C>>>8,te=(b.I>>>Q>Y)+0;for(te?(P-=Y,b.I-=Y+1<<Q>>>0):P=Y+1,Q=P,Y=0;256<=Q;)Y+=8,Q>>=8;return Q=7^Y+xc[Q],b.b-=Q,b.Ca=(P<<Q)-1,te}function Ce(b,C,P){b[C+0]=P>>24&255,b[C+1]=P>>16&255,b[C+2]=P>>8&255,b[C+3]=255&P}function Be(b,C){return b[C+0]|b[C+1]<<8}function Qe(b,C){return Be(b,C)|b[C+2]<<16}function D(b,C){return Be(b,C)|Be(b,C+2)<<16}function G(b,C){var P=1<<C;return e(b!=null),e(0<C),b.X=i(P),b.X==null?0:(b.Mb=32-C,b.Xa=C,1)}function ce(b,C){e(b!=null),e(C!=null),e(b.Xa==C.Xa),n(C.X,0,b.X,0,1<<C.Xa)}function Z(){this.X=[],this.Xa=this.Mb=0}function W(b,C,P,Q){e(P!=null),e(Q!=null);var Y=P[0],te=Q[0];return Y==0&&(Y=(b*te+C/2)/C),te==0&&(te=(C*Y+b/2)/b),0>=Y||0>=te?0:(P[0]=Y,Q[0]=te,1)}function ee(b,C){return b+(1<<C)-1>>>C}function ye(b,C){return((4278255360&b)+(4278255360&C)>>>0&4278255360)+((16711935&b)+(16711935&C)>>>0&16711935)>>>0}function xe(b,C){v[C]=function(P,Q,Y,te,ne,ae,ue){var pe;for(pe=0;pe<ne;++pe){var Se=v[b](ae[ue+pe-1],Y,te+pe);ae[ue+pe]=ye(P[Q+pe],Se)}}}function we(){this.ud=this.hd=this.jd=0}function Ee(b,C){return((4278124286&(b^C))>>>1)+(b&C)>>>0}function Ne(b){return 0<=b&&256>b?b:0>b?0:255<b?255:void 0}function Ue(b,C){return Ne(b+(b-C+.5>>1))}function je(b,C,P){return Math.abs(C-P)-Math.abs(b-P)}function st(b,C,P,Q,Y,te,ne){for(Q=te[ne-1],P=0;P<Y;++P)te[ne+P]=Q=ye(b[C+P],Q)}function Ze(b,C,P,Q,Y){var te;for(te=0;te<P;++te){var ne=b[C+te],ae=ne>>8&255,ue=16711935&(ue=(ue=16711935&ne)+((ae<<16)+ae));Q[Y+te]=(4278255360&ne)+ue>>>0}}function ct(b,C){C.jd=255&b,C.hd=b>>8&255,C.ud=b>>16&255}function wt(b,C,P,Q,Y,te){var ne;for(ne=0;ne<Q;++ne){var ae=C[P+ne],ue=ae>>>8,pe=ae,Se=255&(Se=(Se=ae>>>16)+((b.jd<<24>>24)*(ue<<24>>24)>>>5));pe=255&(pe=(pe+=(b.hd<<24>>24)*(ue<<24>>24)>>>5)+((b.ud<<24>>24)*(Se<<24>>24)>>>5)),Y[te+ne]=(4278255360&ae)+(Se<<16)+pe}}function it(b,C,P,Q,Y){v[C]=function(te,ne,ae,ue,pe,Se,De,me,ke){for(ue=De;ue<me;++ue)for(De=0;De<ke;++De)pe[Se++]=Y(ae[Q(te[ne++])])},v[b]=function(te,ne,ae,ue,pe,Se,De){var me=8>>te.b,ke=te.Ea,Me=te.K[0],Ve=te.w;if(8>me)for(te=(1<<te.b)-1,Ve=(1<<me)-1;ne<ae;++ne){var Pe,Ge=0;for(Pe=0;Pe<ke;++Pe)Pe&te||(Ge=Q(ue[pe++])),Se[De++]=Y(Me[Ge&Ve]),Ge>>=me}else v["VP8LMapColor"+P](ue,pe,Me,Ve,Se,De,ne,ae,ke)}}function lt(b,C,P,Q,Y){for(P=C+P;C<P;){var te=b[C++];Q[Y++]=te>>16&255,Q[Y++]=te>>8&255,Q[Y++]=255&te}}function tt(b,C,P,Q,Y){for(P=C+P;C<P;){var te=b[C++];Q[Y++]=te>>16&255,Q[Y++]=te>>8&255,Q[Y++]=255&te,Q[Y++]=te>>24&255}}function rt(b,C,P,Q,Y){for(P=C+P;C<P;){var te=(ne=b[C++])>>16&240|ne>>12&15,ne=240&ne|ne>>28&15;Q[Y++]=te,Q[Y++]=ne}}function ft(b,C,P,Q,Y){for(P=C+P;C<P;){var te=(ne=b[C++])>>16&248|ne>>13&7,ne=ne>>5&224|ne>>3&31;Q[Y++]=te,Q[Y++]=ne}}function St(b,C,P,Q,Y){for(P=C+P;C<P;){var te=b[C++];Q[Y++]=255&te,Q[Y++]=te>>8&255,Q[Y++]=te>>16&255}}function yt(b,C,P,Q,Y,te){if(te==0)for(P=C+P;C<P;)Ce(Q,((te=b[C++])[0]>>24|te[1]>>8&65280|te[2]<<8&16711680|te[3]<<24)>>>0),Y+=32;else n(Q,Y,b,C,P)}function jt(b,C){v[C][0]=v[b+"0"],v[C][1]=v[b+"1"],v[C][2]=v[b+"2"],v[C][3]=v[b+"3"],v[C][4]=v[b+"4"],v[C][5]=v[b+"5"],v[C][6]=v[b+"6"],v[C][7]=v[b+"7"],v[C][8]=v[b+"8"],v[C][9]=v[b+"9"],v[C][10]=v[b+"10"],v[C][11]=v[b+"11"],v[C][12]=v[b+"12"],v[C][13]=v[b+"13"],v[C][14]=v[b+"0"],v[C][15]=v[b+"0"]}function Rt(b){return b==ky||b==Ey||b==_p||b==Iy}function wr(){this.eb=[],this.size=this.A=this.fb=0}function Qr(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Lt(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new wr,this.f.kb=new Qr,this.sd=null}function Ut(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function mr(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function gs(b){return alert("todo:WebPSamplerProcessPlane"),b.T}function Pn(b,C){var P=b.T,Q=C.ba.f.RGBA,Y=Q.eb,te=Q.fb+b.ka*Q.A,ne=ja[C.ba.S],ae=b.y,ue=b.O,pe=b.f,Se=b.N,De=b.ea,me=b.W,ke=C.cc,Me=C.dc,Ve=C.Mc,Pe=C.Nc,Ge=b.ka,ze=b.ka+b.T,et=b.U,Xe=et+1>>1;for(Ge==0?ne(ae,ue,null,null,pe,Se,De,me,pe,Se,De,me,Y,te,null,null,et):(ne(C.ec,C.fc,ae,ue,ke,Me,Ve,Pe,pe,Se,De,me,Y,te-Q.A,Y,te,et),++P);Ge+2<ze;Ge+=2)ke=pe,Me=Se,Ve=De,Pe=me,Se+=b.Rc,me+=b.Rc,te+=2*Q.A,ne(ae,(ue+=2*b.fa)-b.fa,ae,ue,ke,Me,Ve,Pe,pe,Se,De,me,Y,te-Q.A,Y,te,et);return ue+=b.fa,b.j+ze<b.o?(n(C.ec,C.fc,ae,ue,et),n(C.cc,C.dc,pe,Se,Xe),n(C.Mc,C.Nc,De,me,Xe),P--):1&ze||ne(ae,ue,null,null,pe,Se,De,me,pe,Se,De,me,Y,te+Q.A,null,null,et),P}function hi(b,C,P){var Q=b.F,Y=[b.J];if(Q!=null){var te=b.U,ne=C.ba.S,ae=ne==xp||ne==_p;C=C.ba.f.RGBA;var ue=[0],pe=b.ka;ue[0]=b.T,b.Kb&&(pe==0?--ue[0]:(--pe,Y[0]-=b.width),b.j+b.ka+b.T==b.o&&(ue[0]=b.o-b.j-pe));var Se=C.eb;pe=C.fb+pe*C.A,b=__(Q,Y[0],b.width,te,ue,Se,pe+(ae?0:3),C.A),e(P==ue),b&&Rt(ne)&&jh(Se,pe,ae,te,ue,C.A)}return 0}function Bs(b){var C=b.ma,P=C.ba.S,Q=11>P,Y=P==wp||P==vp||P==xp||P==Sy||P==12||Rt(P);if(C.memory=null,C.Ib=null,C.Jb=null,C.Nd=null,!Mh(C.Oa,b,Y?11:12))return 0;if(Y&&Rt(P)&&at(),b.da)alert("todo:use_scaling");else{if(Q){if(C.Ib=gs,b.Kb){if(P=b.U+1>>1,C.memory=i(b.U+2*P),C.memory==null)return 0;C.ec=C.memory,C.fc=0,C.cc=C.ec,C.dc=C.fc+b.U,C.Mc=C.cc,C.Nc=C.dc+P,C.Ib=Pn,at()}}else alert("todo:EmitYUV");Y&&(C.Jb=hi,Q&&Le())}if(Q&&!O_){for(b=0;256>b;++b)sP[b]=89858*(b-128)+Cp>>Bp,oP[b]=-22014*(b-128)+Cp,aP[b]=-45773*(b-128),iP[b]=113618*(b-128)+Cp>>Bp;for(b=$h;b<Ly;++b)C=76283*(b-16)+Cp>>Bp,lP[b-$h]=Hn(C,255),cP[b-$h]=Hn(C+8>>4,15);O_=1}return 1}function Ht(b){var C=b.ma,P=b.U,Q=b.T;return e(!(1&b.ka)),0>=P||0>=Q?0:(P=C.Ib(b,C),C.Jb!=null&&C.Jb(b,C,P),C.Dc+=P,1)}function da(b){b.ma.memory=null}function Cs(b,C,P,Q){return z(b,8)!=47?0:(C[0]=z(b,14)+1,P[0]=z(b,14)+1,Q[0]=z(b,1),z(b,3)!=0?0:!b.h)}function Xs(b,C){if(4>b)return b+1;var P=b-2>>1;return(2+(1&b)<<P)+z(C,P)+1}function Js(b,C){return 120<C?C-120:1<=(P=((P=$N[C-1])>>4)*b+(8-(15&P)))?P:1;var P}function Jr(b,C,P){var Q=H(P),Y=b[C+=255&Q].g-8;return 0<Y&&(de(P,P.u+8),Q=H(P),C+=b[C].value,C+=Q&(1<<Y)-1),de(P,P.u+b[C].g),b[C].value}function sn(b,C,P){return P.g+=b.g,P.value+=b.value<<C>>>0,e(8>=P.g),b.g}function Xn(b,C,P){var Q=b.xc;return e((C=Q==0?0:b.vc[b.md*(P>>Q)+(C>>Q)])<b.Wb),b.Ya[C]}function Ss(b,C,P,Q){var Y=b.ab,te=b.c*C,ne=b.C;C=ne+C;var ae=P,ue=Q;for(Q=b.Ta,P=b.Ua;0<Y--;){var pe=b.gc[Y],Se=ne,De=C,me=ae,ke=ue,Me=(ue=Q,ae=P,pe.Ea);switch(e(Se<De),e(De<=pe.nc),pe.hc){case 2:Zn(me,ke,(De-Se)*Me,ue,ae);break;case 0:var Ve=Se,Pe=De,Ge=ue,ze=ae,et=(It=pe).Ea;Ve==0&&(Ph(me,ke,null,null,1,Ge,ze),st(me,ke+1,0,0,et-1,Ge,ze+1),ke+=et,ze+=et,++Ve);for(var Xe=1<<It.b,Nt=Xe-1,xt=ee(et,It.b),br=It.K,It=It.w+(Ve>>It.b)*xt;Ve<Pe;){var Fr=br,Is=It,yr=1;for(ou(me,ke,Ge,ze-et,1,Ge,ze);yr<et;){var Tt=(yr&~Nt)+Xe;Tt>et&&(Tt=et),(0,Rh[Fr[Is++]>>8&15])(me,ke+ +yr,Ge,ze+yr-et,Tt-yr,Ge,ze+yr),yr=Tt}ke+=et,ze+=et,++Ve&Nt||(It+=xt)}De!=pe.nc&&n(ue,ae-Me,ue,ae+(De-Se-1)*Me,Me);break;case 1:for(Me=me,Pe=ke,et=(me=pe.Ea)-(ze=me&~(Ge=(ke=1<<pe.b)-1)),Ve=ee(me,pe.b),Xe=pe.K,pe=pe.w+(Se>>pe.b)*Ve;Se<De;){for(Nt=Xe,xt=pe,br=new we,It=Pe+ze,Fr=Pe+me;Pe<It;)ct(Nt[xt++],br),Oh(br,Me,Pe,ke,ue,ae),Pe+=ke,ae+=ke;Pe<Fr&&(ct(Nt[xt++],br),Oh(br,Me,Pe,et,ue,ae),Pe+=et,ae+=et),++Se&Ge||(pe+=Ve)}break;case 3:if(me==ue&&ke==ae&&0<pe.b){for(Pe=ue,me=Me=ae+(De-Se)*Me-(ze=(De-Se)*ee(pe.Ea,pe.b)),ke=ue,Ge=ae,Ve=[],ze=(et=ze)-1;0<=ze;--ze)Ve[ze]=ke[Ge+ze];for(ze=et-1;0<=ze;--ze)Pe[me+ze]=Ve[ze];pp(pe,Se,De,ue,Me,ue,ae)}else pp(pe,Se,De,me,ke,ue,ae)}ae=Q,ue=P}ue!=P&&n(Q,P,ae,ue,te)}function ua(b,C){var P=b.V,Q=b.Ba+b.c*b.C,Y=C-b.C;if(e(C<=b.l.o),e(16>=Y),0<Y){var te=b.l,ne=b.Ta,ae=b.Ua,ue=te.width;if(Ss(b,Y,P,Q),Y=ae=[ae],e((P=b.C)<(Q=C)),e(te.v<te.va),Q>te.o&&(Q=te.o),P<te.j){var pe=te.j-P;P=te.j,Y[0]+=pe*ue}if(P>=Q?P=0:(Y[0]+=4*te.v,te.ka=P-te.j,te.U=te.va-te.v,te.T=Q-P,P=1),P){if(ae=ae[0],11>(P=b.ca).S){var Se=P.f.RGBA,De=(Q=P.S,Y=te.U,te=te.T,pe=Se.eb,Se.A),me=te;for(Se=Se.fb+b.Ma*Se.A;0<me--;){var ke=ne,Me=ae,Ve=Y,Pe=pe,Ge=Se;switch(Q){case yp:Qh(ke,Me,Ve,Pe,Ge);break;case wp:_c(ke,Me,Ve,Pe,Ge);break;case ky:_c(ke,Me,Ve,Pe,Ge),jh(Pe,Ge,0,Ve,1,0);break;case T_:KA(ke,Me,Ve,Pe,Ge);break;case vp:yt(ke,Me,Ve,Pe,Ge,1);break;case Ey:yt(ke,Me,Ve,Pe,Ge,1),jh(Pe,Ge,0,Ve,1,0);break;case xp:yt(ke,Me,Ve,Pe,Ge,0);break;case _p:yt(ke,Me,Ve,Pe,Ge,0),jh(Pe,Ge,1,Ve,1,0);break;case Sy:Bc(ke,Me,Ve,Pe,Ge);break;case Iy:Bc(ke,Me,Ve,Pe,Ge),x_(Pe,Ge,Ve,1,0);break;case F_:Cc(ke,Me,Ve,Pe,Ge);break;default:e(0)}ae+=ue,Se+=De}b.Ma+=te}else alert("todo:EmitRescaledRowsYUVA");e(b.Ma<=P.height)}}b.C=C,e(b.C<=b.i)}function Zs(b){var C;if(0<b.ua)return 0;for(C=0;C<b.Wb;++C){var P=b.Ya[C].G,Q=b.Ya[C].H;if(0<P[1][Q[1]+0].g||0<P[2][Q[2]+0].g||0<P[3][Q[3]+0].g)return 0}return 1}function ei(b,C,P,Q,Y,te){if(b.Z!=0){var ne=b.qd,ae=b.rd;for(e(Ec[b.Z]!=null);C<P;++C)Ec[b.Z](ne,ae,Q,Y,Q,Y,te),ne=Q,ae=Y,Y+=te;b.qd=ne,b.rd=ae}}function Ps(b,C){var P=b.l.ma,Q=P.Z==0||P.Z==1?b.l.j:b.C;if(Q=b.C<Q?Q:b.C,e(C<=b.l.o),C>Q){var Y=b.l.width,te=P.ca,ne=P.tb+Y*Q,ae=b.V,ue=b.Ba+b.c*Q,pe=b.gc;e(b.ab==1),e(pe[0].hc==3),Po(pe[0],Q,C,ae,ue,te,ne),ei(P,Q,C,te,ne,Y)}b.C=b.Ma=C}function ti(b,C,P,Q,Y,te,ne){var ae=b.$/Q,ue=b.$%Q,pe=b.m,Se=b.s,De=P+b.$,me=De;Y=P+Q*Y;var ke=P+Q*te,Me=280+Se.ua,Ve=b.Pb?ae:16777216,Pe=0<Se.ua?Se.Wa:null,Ge=Se.wc,ze=De<ke?Xn(Se,ue,ae):null;e(b.C<te),e(ke<=Y);var et=!1;e:for(;;){for(;et||De<ke;){var Xe=0;if(ae>=Ve){var Nt=De-P;e((Ve=b).Pb),Ve.wd=Ve.m,Ve.xd=Nt,0<Ve.s.ua&&ce(Ve.s.Wa,Ve.s.vb),Ve=ae+zN}if(ue&Ge||(ze=Xn(Se,ue,ae)),e(ze!=null),ze.Qb&&(C[De]=ze.qb,et=!0),!et)if(ie(pe),ze.jc){Xe=pe,Nt=C;var xt=De,br=ze.pd[H(Xe)&zA-1];e(ze.jc),256>br.g?(de(Xe,Xe.u+br.g),Nt[xt]=br.value,Xe=0):(de(Xe,Xe.u+br.g-256),e(256<=br.value),Xe=br.value),Xe==0&&(et=!0)}else Xe=Jr(ze.G[0],ze.H[0],pe);if(pe.h)break;if(et||256>Xe){if(!et)if(ze.nd)C[De]=(ze.qb|Xe<<8)>>>0;else{if(ie(pe),et=Jr(ze.G[1],ze.H[1],pe),ie(pe),Nt=Jr(ze.G[2],ze.H[2],pe),xt=Jr(ze.G[3],ze.H[3],pe),pe.h)break;C[De]=(xt<<24|et<<16|Xe<<8|Nt)>>>0}if(et=!1,++De,++ue>=Q&&(ue=0,++ae,ne!=null&&ae<=te&&!(ae%16)&&ne(b,ae),Pe!=null))for(;me<De;)Xe=C[me++],Pe.X[(506832829*Xe&4294967295)>>>Pe.Mb]=Xe}else if(280>Xe){if(Xe=Xs(Xe-256,pe),Nt=Jr(ze.G[4],ze.H[4],pe),ie(pe),Nt=Js(Q,Nt=Xs(Nt,pe)),pe.h)break;if(De-P<Nt||Y-De<Xe)break e;for(xt=0;xt<Xe;++xt)C[De+xt]=C[De+xt-Nt];for(De+=Xe,ue+=Xe;ue>=Q;)ue-=Q,++ae,ne!=null&&ae<=te&&!(ae%16)&&ne(b,ae);if(e(De<=Y),ue&Ge&&(ze=Xn(Se,ue,ae)),Pe!=null)for(;me<De;)Xe=C[me++],Pe.X[(506832829*Xe&4294967295)>>>Pe.Mb]=Xe}else{if(!(Xe<Me))break e;for(et=Xe-280,e(Pe!=null);me<De;)Xe=C[me++],Pe.X[(506832829*Xe&4294967295)>>>Pe.Mb]=Xe;Xe=De,e(!(et>>>(Nt=Pe).Xa)),C[Xe]=Nt.X[et],et=!0}et||e(pe.h==J(pe))}if(b.Pb&&pe.h&&De<Y)e(b.m.h),b.a=5,b.m=b.wd,b.$=b.xd,0<b.s.ua&&ce(b.s.vb,b.s.Wa);else{if(pe.h)break e;ne!=null&&ne(b,ae>te?te:ae),b.a=0,b.$=De-P}return 1}return b.a=3,0}function Ds(b){e(b!=null),b.vc=null,b.yc=null,b.Ya=null;var C=b.Wa;C!=null&&(C.X=null),b.vb=null,e(b!=null)}function Rs(){var b=new Et;return b==null?null:(b.a=0,b.xb=M_,jt("Predictor","VP8LPredictors"),jt("Predictor","VP8LPredictors_C"),jt("PredictorAdd","VP8LPredictorsAdd"),jt("PredictorAdd","VP8LPredictorsAdd_C"),Zn=Ze,Oh=wt,Qh=lt,_c=tt,Bc=rt,Cc=ft,KA=St,v.VP8LMapColor32b=No,v.VP8LMapColor8b=Dh,b)}function Os(b,C,P,Q,Y){var te=1,ne=[b],ae=[C],ue=Q.m,pe=Q.s,Se=null,De=0;e:for(;;){if(P)for(;te&&z(ue,1);){var me=ne,ke=ae,Me=Q,Ve=1,Pe=Me.m,Ge=Me.gc[Me.ab],ze=z(Pe,2);if(Me.Oc&1<<ze)te=0;else{switch(Me.Oc|=1<<ze,Ge.hc=ze,Ge.Ea=me[0],Ge.nc=ke[0],Ge.K=[null],++Me.ab,e(4>=Me.ab),ze){case 0:case 1:Ge.b=z(Pe,3)+2,Ve=Os(ee(Ge.Ea,Ge.b),ee(Ge.nc,Ge.b),0,Me,Ge.K),Ge.K=Ge.K[0];break;case 3:var et,Xe=z(Pe,8)+1,Nt=16<Xe?0:4<Xe?1:2<Xe?2:3;if(me[0]=ee(Ge.Ea,Nt),Ge.b=Nt,et=Ve=Os(Xe,1,0,Me,Ge.K)){var xt,br=Xe,It=Ge,Fr=1<<(8>>It.b),Is=i(Fr);if(Is==null)et=0;else{var yr=It.K[0],Tt=It.w;for(Is[0]=It.K[0][0],xt=1;xt<1*br;++xt)Is[xt]=ye(yr[Tt+xt],Is[xt-1]);for(;xt<4*Fr;++xt)Is[xt]=0;It.K[0]=null,It.K[0]=Is,et=1}}Ve=et;break;case 2:break;default:e(0)}te=Ve}}if(ne=ne[0],ae=ae[0],te&&z(ue,1)&&!(te=1<=(De=z(ue,4))&&11>=De)){Q.a=3;break e}var At;if(At=te)t:{var ts,Ar,Mr,Bn=Q,si=ne,Di=ae,jn=De,pi=P,Ri=Bn.m,Ts=Bn.s,Rr=[null],en=1,Vn=0,tn=GN[jn];r:for(;;){if(pi&&z(Ri,1)){var ii=z(Ri,3)+2,ao=ee(si,ii),rs=ee(Di,ii),Zi=ao*rs;if(!Os(ao,rs,0,Bn,Rr))break r;for(Rr=Rr[0],Ts.xc=ii,ts=0;ts<Zi;++ts){var dn=Rr[ts]>>8&65535;Rr[ts]=dn,dn>=en&&(en=dn+1)}}if(Ri.h)break r;for(Ar=0;5>Ar;++Ar){var Fs=L_[Ar];!Ar&&0<jn&&(Fs+=1<<jn),Vn<Fs&&(Vn=Fs)}var ya=a(en*tn,T),Oi=en,wa=a(Oi,K);if(wa==null)var va=null;else e(65536>=Oi),va=wa;var ea=i(Vn);if(va==null||ea==null||ya==null){Bn.a=1;break r}var xa=ya;for(ts=Mr=0;ts<en;++ts){var mn=va[ts],_a=mn.G,oo=mn.H,WA=0,kl=1,ai=0;for(Ar=0;5>Ar;++Ar){Fs=L_[Ar],_a[Ar]=xa,oo[Ar]=Mr,!Ar&&0<jn&&(Fs+=1<<jn);s:{var kp,Uy=Fs,Ep=Bn,Gh=ea,uP=xa,hP=Mr,My=0,Ic=Ep.m,fP=z(Ic,1);if(s(Gh,0,0,Uy),fP){var gP=z(Ic,1)+1,pP=z(Ic,1),j_=z(Ic,pP==0?1:8);Gh[j_]=1,gP==2&&(Gh[j_=z(Ic,8)]=1);var Ip=1}else{var V_=i(19),$_=z(Ic,4)+4;if(19<$_){Ep.a=3;var Tp=0;break s}for(kp=0;kp<$_;++kp)V_[VN[kp]]=z(Ic,3);var Ny=void 0,zh=void 0,G_=Ep,mP=V_,Fp=Uy,z_=Gh,Py=0,Tc=G_.m,K_=8,q_=a(128,T);n:for(;_(q_,0,7,mP,19);){if(z(Tc,1)){var bP=2+2*z(Tc,3);if((Ny=2+z(Tc,bP))>Fp)break n}else Ny=Fp;for(zh=0;zh<Fp&&Ny--;){ie(Tc);var W_=q_[0+(127&H(Tc))];de(Tc,Tc.u+W_.g);var cu=W_.value;if(16>cu)z_[zh++]=cu,cu!=0&&(K_=cu);else{var yP=cu==16,Y_=cu-16,wP=HN[Y_],X_=z(Tc,QN[Y_])+wP;if(zh+X_>Fp)break n;for(var vP=yP?K_:0;0<X_--;)z_[zh++]=vP}}Py=1;break n}Py||(G_.a=3),Ip=Py}(Ip=Ip&&!Ic.h)&&(My=_(uP,hP,8,Gh,Uy)),Ip&&My!=0?Tp=My:(Ep.a=3,Tp=0)}if(Tp==0)break r;if(kl&&jN[Ar]==1&&(kl=xa[Mr].g==0),WA+=xa[Mr].g,Mr+=Tp,3>=Ar){var Kh,Dy=ea[0];for(Kh=1;Kh<Fs;++Kh)ea[Kh]>Dy&&(Dy=ea[Kh]);ai+=Dy}}if(mn.nd=kl,mn.Qb=0,kl&&(mn.qb=(_a[3][oo[3]+0].value<<24|_a[1][oo[1]+0].value<<16|_a[2][oo[2]+0].value)>>>0,WA==0&&256>_a[0][oo[0]+0].value&&(mn.Qb=1,mn.qb+=_a[0][oo[0]+0].value<<8)),mn.jc=!mn.Qb&&6>ai,mn.jc){var Lp,El=mn;for(Lp=0;Lp<zA;++Lp){var Fc=Lp,Lc=El.pd[Fc],Up=El.G[0][El.H[0]+Fc];256<=Up.value?(Lc.g=Up.g+256,Lc.value=Up.value):(Lc.g=0,Lc.value=0,Fc>>=sn(Up,8,Lc),Fc>>=sn(El.G[1][El.H[1]+Fc],16,Lc),Fc>>=sn(El.G[2][El.H[2]+Fc],0,Lc),sn(El.G[3][El.H[3]+Fc],24,Lc))}}}Ts.vc=Rr,Ts.Wb=en,Ts.Ya=va,Ts.yc=ya,At=1;break t}At=0}if(!(te=At)){Q.a=3;break e}if(0<De){if(pe.ua=1<<De,!G(pe.Wa,De)){Q.a=1,te=0;break e}}else pe.ua=0;var Ry=Q,J_=ne,xP=ae,Oy=Ry.s,Qy=Oy.xc;if(Ry.c=J_,Ry.i=xP,Oy.md=ee(J_,Qy),Oy.wc=Qy==0?-1:(1<<Qy)-1,P){Q.xb=ZN;break e}if((Se=i(ne*ae))==null){Q.a=1,te=0;break e}te=(te=ti(Q,Se,0,ne,ae,ae,null))&&!ue.h;break e}return te?(Y!=null?Y[0]=Se:(e(Se==null),e(P)),Q.$=0,P||Ds(pe)):Ds(pe),te}function Qs(b,C){var P=b.c*b.i,Q=P+C+16*C;return e(b.c<=C),b.V=i(Q),b.V==null?(b.Ta=null,b.Ua=0,b.a=1,0):(b.Ta=b.V,b.Ua=b.Ba+P+C,1)}function ji(b,C){var P=b.C,Q=C-P,Y=b.V,te=b.Ba+b.c*P;for(e(C<=b.l.o);0<Q;){var ne=16<Q?16:Q,ae=b.l.ma,ue=b.l.width,pe=ue*ne,Se=ae.ca,De=ae.tb+ue*P,me=b.Ta,ke=b.Ua;Ss(b,ne,Y,te),B_(me,ke,Se,De,pe),ei(ae,P,P+ne,Se,De,ue),Q-=ne,Y+=ne*b.c,P+=ne}e(P==C),b.C=b.Ma=C}function Vi(){this.ub=this.yd=this.td=this.Rb=0}function $i(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function ha(){this.Fb=this.Bb=this.Cb=0,this.Zb=i(4),this.Lb=i(4)}function Gi(){this.Yb=(function(){var b=[];return(function C(P,Q,Y){for(var te=Y[Q],ne=0;ne<te&&(P.push(Y.length>Q+1?[]:0),!(Y.length<Q+1));ne++)C(P[ne],Q+1,Y)})(b,0,[3,11]),b})()}function ks(){this.jb=i(3),this.Wc=o([4,8],Gi),this.Xc=o([4,17],Gi)}function zi(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new i(4),this.od=new i(4)}function Fn(){this.ld=this.La=this.dd=this.tc=0}function Hs(){this.Na=this.la=0}function Ki(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function ps(){this.ad=i(384),this.Za=0,this.Ob=i(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function ri(){this.uc=this.M=this.Nb=0,this.wa=Array(new Fn),this.Y=0,this.ya=Array(new ps),this.aa=0,this.l=new fa}function ko(){this.y=i(16),this.f=i(8),this.ea=i(8)}function Eo(){this.cb=this.a=0,this.sc="",this.m=new M,this.Od=new Vi,this.Kc=new $i,this.ed=new zi,this.Qa=new ha,this.Ic=this.$c=this.Aa=0,this.D=new ri,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=a(8,M),this.ia=0,this.pb=a(4,Ki),this.Pa=new ks,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new ko),this.Hd=0,this.rb=Array(new Hs),this.sb=0,this.wa=Array(new Fn),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new ps),this.L=this.aa=0,this.gd=o([4,2],Fn),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function fa(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Ln(){var b=new Eo;return b!=null&&(b.a=0,b.sc="OK",b.cb=0,b.Xb=0,Vh||(Vh=ni)),b}function Cr(b,C,P){return b.a==0&&(b.a=C,b.sc=P,b.cb=0),0}function qi(b,C,P){return 3<=P&&b[C+0]==157&&b[C+1]==1&&b[C+2]==42}function Wi(b,C){if(b==null)return 0;if(b.a=0,b.sc="OK",C==null)return Cr(b,2,"null VP8Io passed to VP8GetHeaders()");var P=C.data,Q=C.w,Y=C.ha;if(4>Y)return Cr(b,7,"Truncated header.");var te=P[Q+0]|P[Q+1]<<8|P[Q+2]<<16,ne=b.Od;if(ne.Rb=!(1&te),ne.td=te>>1&7,ne.yd=te>>4&1,ne.ub=te>>5,3<ne.td)return Cr(b,3,"Incorrect keyframe parameters.");if(!ne.yd)return Cr(b,4,"Frame not displayable.");Q+=3,Y-=3;var ae=b.Kc;if(ne.Rb){if(7>Y)return Cr(b,7,"cannot parse picture header");if(!qi(P,Q,Y))return Cr(b,3,"Bad code word");ae.c=16383&(P[Q+4]<<8|P[Q+3]),ae.Td=P[Q+4]>>6,ae.i=16383&(P[Q+6]<<8|P[Q+5]),ae.Ud=P[Q+6]>>6,Q+=7,Y-=7,b.za=ae.c+15>>4,b.Ub=ae.i+15>>4,C.width=ae.c,C.height=ae.i,C.Da=0,C.j=0,C.v=0,C.va=C.width,C.o=C.height,C.da=0,C.ib=C.width,C.hb=C.height,C.U=C.width,C.T=C.height,s((te=b.Pa).jb,0,255,te.jb.length),e((te=b.Qa)!=null),te.Cb=0,te.Bb=0,te.Fb=1,s(te.Zb,0,0,te.Zb.length),s(te.Lb,0,0,te.Lb)}if(ne.ub>Y)return Cr(b,7,"bad partition length");se(te=b.m,P,Q,ne.ub),Q+=ne.ub,Y-=ne.ub,ne.Rb&&(ae.Ld=fe(te),ae.Kd=fe(te)),ae=b.Qa;var ue,pe=b.Pa;if(e(te!=null),e(ae!=null),ae.Cb=fe(te),ae.Cb){if(ae.Bb=fe(te),fe(te)){for(ae.Fb=fe(te),ue=0;4>ue;++ue)ae.Zb[ue]=fe(te)?$(te,7):0;for(ue=0;4>ue;++ue)ae.Lb[ue]=fe(te)?$(te,6):0}if(ae.Bb)for(ue=0;3>ue;++ue)pe.jb[ue]=fe(te)?X(te,8):255}else ae.Bb=0;if(te.Ka)return Cr(b,3,"cannot parse segment header");if((ae=b.ed).zd=fe(te),ae.Tb=X(te,6),ae.wb=X(te,3),ae.Pc=fe(te),ae.Pc&&fe(te)){for(pe=0;4>pe;++pe)fe(te)&&(ae.vd[pe]=$(te,6));for(pe=0;4>pe;++pe)fe(te)&&(ae.od[pe]=$(te,6))}if(b.L=ae.Tb==0?0:ae.zd?1:2,te.Ka)return Cr(b,3,"cannot parse filter header");var Se=Y;if(Y=ue=Q,Q=ue+Se,ae=Se,b.Xb=(1<<X(b.m,2))-1,Se<3*(pe=b.Xb))P=7;else{for(ue+=3*pe,ae-=3*pe,Se=0;Se<pe;++Se){var De=P[Y+0]|P[Y+1]<<8|P[Y+2]<<16;De>ae&&(De=ae),se(b.Jc[+Se],P,ue,De),ue+=De,ae-=De,Y+=3}se(b.Jc[+pe],P,ue,ae),P=ue<Q?0:5}if(P!=0)return Cr(b,P,"cannot parse partitions");for(P=X(ue=b.m,7),Y=fe(ue)?$(ue,4):0,Q=fe(ue)?$(ue,4):0,ae=fe(ue)?$(ue,4):0,pe=fe(ue)?$(ue,4):0,ue=fe(ue)?$(ue,4):0,Se=b.Qa,De=0;4>De;++De){if(Se.Cb){var me=Se.Zb[De];Se.Fb||(me+=P)}else{if(0<De){b.pb[De]=b.pb[0];continue}me=P}var ke=b.pb[De];ke.Sc[0]=Ty[Hn(me+Y,127)],ke.Sc[1]=Fy[Hn(me+0,127)],ke.Eb[0]=2*Ty[Hn(me+Q,127)],ke.Eb[1]=101581*Fy[Hn(me+ae,127)]>>16,8>ke.Eb[1]&&(ke.Eb[1]=8),ke.Qc[0]=Ty[Hn(me+pe,117)],ke.Qc[1]=Fy[Hn(me+ue,127)],ke.lc=me+ue}if(!ne.Rb)return Cr(b,4,"Not a key frame.");for(fe(te),ne=b.Pa,P=0;4>P;++P){for(Y=0;8>Y;++Y)for(Q=0;3>Q;++Q)for(ae=0;11>ae;++ae)pe=ve(te,XN[P][Y][Q][ae])?X(te,8):WN[P][Y][Q][ae],ne.Wc[P][Y].Yb[Q][ae]=pe;for(Y=0;17>Y;++Y)ne.Xc[P][Y]=ne.Wc[P][JN[Y]]}return b.kc=fe(te),b.kc&&(b.Bd=X(te,8)),b.cb=1}function ni(b,C,P,Q,Y,te,ne){var ae=C[Y].Yb[P];for(P=0;16>Y;++Y){if(!ve(b,ae[P+0]))return Y;for(;!ve(b,ae[P+1]);)if(ae=C[++Y].Yb[0],P=0,Y==16)return 16;var ue=C[Y+1].Yb;if(ve(b,ae[P+2])){var pe=b,Se=0;if(ve(pe,(me=ae)[(De=P)+3]))if(ve(pe,me[De+6])){for(ae=0,De=2*(Se=ve(pe,me[De+8]))+(me=ve(pe,me[De+9+Se])),Se=0,me=KN[De];me[ae];++ae)Se+=Se+ve(pe,me[ae]);Se+=3+(8<<De)}else ve(pe,me[De+7])?(Se=7+2*ve(pe,165),Se+=ve(pe,145)):Se=5+ve(pe,159);else Se=ve(pe,me[De+4])?3+ve(pe,me[De+5]):2;ae=ue[2]}else Se=1,ae=ue[1];ue=ne+qN[Y],0>(pe=b).b&&le(pe);var De,me=pe.b,ke=(De=pe.Ca>>1)-(pe.I>>me)>>31;--pe.b,pe.Ca+=ke,pe.Ca|=1,pe.I-=(De+1&ke)<<me,te[ue]=((Se^ke)-ke)*Q[(0<Y)+0]}return 16}function _r(b){var C=b.rb[b.sb-1];C.la=0,C.Na=0,s(b.zc,0,0,b.zc.length),b.ja=0}function Jn(b,C,P,Q,Y){Y=b[C+P+32*Q]+(Y>>3),b[C+P+32*Q]=-256&Y?0>Y?0:255:Y}function Qn(b,C,P,Q,Y,te){Jn(b,C,0,P,Q+Y),Jn(b,C,1,P,Q+te),Jn(b,C,2,P,Q-te),Jn(b,C,3,P,Q-Y)}function Zr(b){return(20091*b>>16)+b}function Io(b,C,P,Q){var Y,te=0,ne=i(16);for(Y=0;4>Y;++Y){var ae=b[C+0]+b[C+8],ue=b[C+0]-b[C+8],pe=(35468*b[C+4]>>16)-Zr(b[C+12]),Se=Zr(b[C+4])+(35468*b[C+12]>>16);ne[te+0]=ae+Se,ne[te+1]=ue+pe,ne[te+2]=ue-pe,ne[te+3]=ae-Se,te+=4,C++}for(Y=te=0;4>Y;++Y)ae=(b=ne[te+0]+4)+ne[te+8],ue=b-ne[te+8],pe=(35468*ne[te+4]>>16)-Zr(ne[te+12]),Jn(P,Q,0,0,ae+(Se=Zr(ne[te+4])+(35468*ne[te+12]>>16))),Jn(P,Q,1,0,ue+pe),Jn(P,Q,2,0,ue-pe),Jn(P,Q,3,0,ae-Se),te++,Q+=32}function To(b,C,P,Q){var Y=b[C+0]+4,te=35468*b[C+4]>>16,ne=Zr(b[C+4]),ae=35468*b[C+1]>>16;Qn(P,Q,0,Y+ne,b=Zr(b[C+1]),ae),Qn(P,Q,1,Y+te,b,ae),Qn(P,Q,2,Y-te,b,ae),Qn(P,Q,3,Y-ne,b,ae)}function hc(b,C,P,Q,Y){Io(b,C,P,Q),Y&&Io(b,C+16,P,Q+4)}function OA(b,C,P,Q){qA(b,C+0,P,Q,1),qA(b,C+32,P,Q+128,1)}function Yi(b,C,P,Q){var Y;for(b=b[C+0]+4,Y=0;4>Y;++Y)for(C=0;4>C;++C)Jn(P,Q,C,Y,b)}function re(b,C,P,Q){b[C+0]&&qr(b,C+0,P,Q),b[C+16]&&qr(b,C+16,P,Q+4),b[C+32]&&qr(b,C+32,P,Q+128),b[C+48]&&qr(b,C+48,P,Q+128+4)}function Ae(b,C,P,Q){var Y,te=i(16);for(Y=0;4>Y;++Y){var ne=b[C+0+Y]+b[C+12+Y],ae=b[C+4+Y]+b[C+8+Y],ue=b[C+4+Y]-b[C+8+Y],pe=b[C+0+Y]-b[C+12+Y];te[0+Y]=ne+ae,te[8+Y]=ne-ae,te[4+Y]=pe+ue,te[12+Y]=pe-ue}for(Y=0;4>Y;++Y)ne=(b=te[0+4*Y]+3)+te[3+4*Y],ae=te[1+4*Y]+te[2+4*Y],ue=te[1+4*Y]-te[2+4*Y],pe=b-te[3+4*Y],P[Q+0]=ne+ae>>3,P[Q+16]=pe+ue>>3,P[Q+32]=ne-ae>>3,P[Q+48]=pe-ue>>3,Q+=64}function be(b,C,P){var Q,Y=C-32,te=ba,ne=255-b[Y-1];for(Q=0;Q<P;++Q){var ae,ue=te,pe=ne+b[C-1];for(ae=0;ae<P;++ae)b[C+ae]=ue[pe+b[Y+ae]];C+=32}}function Oe(b,C){be(b,C,4)}function Je(b,C){be(b,C,8)}function ht(b,C){be(b,C,16)}function nr(b,C){var P;for(P=0;16>P;++P)n(b,C+32*P,b,C-32,16)}function on(b,C){var P;for(P=16;0<P;--P)s(b,C,b[C-1],16),C+=32}function Hr(b,C,P){var Q;for(Q=0;16>Q;++Q)s(C,P+32*Q,b,16)}function hn(b,C){var P,Q=16;for(P=0;16>P;++P)Q+=b[C-1+32*P]+b[C+P-32];Hr(Q>>5,b,C)}function fi(b,C){var P,Q=8;for(P=0;16>P;++P)Q+=b[C-1+32*P];Hr(Q>>4,b,C)}function pl(b,C){var P,Q=8;for(P=0;16>P;++P)Q+=b[C+P-32];Hr(Q>>4,b,C)}function Xi(b,C){Hr(128,b,C)}function Xt(b,C,P){return b+2*C+P+2>>2}function QA(b,C){var P,Q=C-32;for(Q=new Uint8Array([Xt(b[Q-1],b[Q+0],b[Q+1]),Xt(b[Q+0],b[Q+1],b[Q+2]),Xt(b[Q+1],b[Q+2],b[Q+3]),Xt(b[Q+2],b[Q+3],b[Q+4])]),P=0;4>P;++P)n(b,C+32*P,Q,0,Q.length)}function fc(b,C){var P=b[C-1],Q=b[C-1+32],Y=b[C-1+64],te=b[C-1+96];Ce(b,C+0,16843009*Xt(b[C-1-32],P,Q)),Ce(b,C+32,16843009*Xt(P,Q,Y)),Ce(b,C+64,16843009*Xt(Q,Y,te)),Ce(b,C+96,16843009*Xt(Y,te,te))}function su(b,C){var P,Q=4;for(P=0;4>P;++P)Q+=b[C+P-32]+b[C-1+32*P];for(Q>>=3,P=0;4>P;++P)s(b,C+32*P,Q,4)}function ml(b,C){var P=b[C-1+0],Q=b[C-1+32],Y=b[C-1+64],te=b[C-1-32],ne=b[C+0-32],ae=b[C+1-32],ue=b[C+2-32],pe=b[C+3-32];b[C+0+96]=Xt(Q,Y,b[C-1+96]),b[C+1+96]=b[C+0+64]=Xt(P,Q,Y),b[C+2+96]=b[C+1+64]=b[C+0+32]=Xt(te,P,Q),b[C+3+96]=b[C+2+64]=b[C+1+32]=b[C+0+0]=Xt(ne,te,P),b[C+3+64]=b[C+2+32]=b[C+1+0]=Xt(ae,ne,te),b[C+3+32]=b[C+2+0]=Xt(ue,ae,ne),b[C+3+0]=Xt(pe,ue,ae)}function Mi(b,C){var P=b[C+1-32],Q=b[C+2-32],Y=b[C+3-32],te=b[C+4-32],ne=b[C+5-32],ae=b[C+6-32],ue=b[C+7-32];b[C+0+0]=Xt(b[C+0-32],P,Q),b[C+1+0]=b[C+0+32]=Xt(P,Q,Y),b[C+2+0]=b[C+1+32]=b[C+0+64]=Xt(Q,Y,te),b[C+3+0]=b[C+2+32]=b[C+1+64]=b[C+0+96]=Xt(Y,te,ne),b[C+3+32]=b[C+2+64]=b[C+1+96]=Xt(te,ne,ae),b[C+3+64]=b[C+2+96]=Xt(ne,ae,ue),b[C+3+96]=Xt(ae,ue,ue)}function Pa(b,C){var P=b[C-1+0],Q=b[C-1+32],Y=b[C-1+64],te=b[C-1-32],ne=b[C+0-32],ae=b[C+1-32],ue=b[C+2-32],pe=b[C+3-32];b[C+0+0]=b[C+1+64]=te+ne+1>>1,b[C+1+0]=b[C+2+64]=ne+ae+1>>1,b[C+2+0]=b[C+3+64]=ae+ue+1>>1,b[C+3+0]=ue+pe+1>>1,b[C+0+96]=Xt(Y,Q,P),b[C+0+64]=Xt(Q,P,te),b[C+0+32]=b[C+1+96]=Xt(P,te,ne),b[C+1+32]=b[C+2+96]=Xt(te,ne,ae),b[C+2+32]=b[C+3+96]=Xt(ne,ae,ue),b[C+3+32]=Xt(ae,ue,pe)}function HA(b,C){var P=b[C+0-32],Q=b[C+1-32],Y=b[C+2-32],te=b[C+3-32],ne=b[C+4-32],ae=b[C+5-32],ue=b[C+6-32],pe=b[C+7-32];b[C+0+0]=P+Q+1>>1,b[C+1+0]=b[C+0+64]=Q+Y+1>>1,b[C+2+0]=b[C+1+64]=Y+te+1>>1,b[C+3+0]=b[C+2+64]=te+ne+1>>1,b[C+0+32]=Xt(P,Q,Y),b[C+1+32]=b[C+0+96]=Xt(Q,Y,te),b[C+2+32]=b[C+1+96]=Xt(Y,te,ne),b[C+3+32]=b[C+2+96]=Xt(te,ne,ae),b[C+3+64]=Xt(ne,ae,ue),b[C+3+96]=Xt(ae,ue,pe)}function fn(b,C){var P=b[C-1+0],Q=b[C-1+32],Y=b[C-1+64],te=b[C-1+96];b[C+0+0]=P+Q+1>>1,b[C+2+0]=b[C+0+32]=Q+Y+1>>1,b[C+2+32]=b[C+0+64]=Y+te+1>>1,b[C+1+0]=Xt(P,Q,Y),b[C+3+0]=b[C+1+32]=Xt(Q,Y,te),b[C+3+32]=b[C+1+64]=Xt(Y,te,te),b[C+3+64]=b[C+2+64]=b[C+0+96]=b[C+1+96]=b[C+2+96]=b[C+3+96]=te}function gc(b,C){var P=b[C-1+0],Q=b[C-1+32],Y=b[C-1+64],te=b[C-1+96],ne=b[C-1-32],ae=b[C+0-32],ue=b[C+1-32],pe=b[C+2-32];b[C+0+0]=b[C+2+32]=P+ne+1>>1,b[C+0+32]=b[C+2+64]=Q+P+1>>1,b[C+0+64]=b[C+2+96]=Y+Q+1>>1,b[C+0+96]=te+Y+1>>1,b[C+3+0]=Xt(ae,ue,pe),b[C+2+0]=Xt(ne,ae,ue),b[C+1+0]=b[C+3+32]=Xt(P,ne,ae),b[C+1+32]=b[C+3+64]=Xt(Q,P,ne),b[C+1+64]=b[C+3+96]=Xt(Y,Q,P),b[C+1+96]=Xt(te,Y,Q)}function jA(b,C){var P;for(P=0;8>P;++P)n(b,C+32*P,b,C-32,8)}function Fo(b,C){var P;for(P=0;8>P;++P)s(b,C,b[C-1],8),C+=32}function bl(b,C,P){var Q;for(Q=0;8>Q;++Q)s(C,P+32*Q,b,8)}function yl(b,C){var P,Q=8;for(P=0;8>P;++P)Q+=b[C+P-32]+b[C-1+32*P];bl(Q>>4,b,C)}function pc(b,C){var P,Q=4;for(P=0;8>P;++P)Q+=b[C+P-32];bl(Q>>3,b,C)}function Ji(b,C){var P,Q=4;for(P=0;8>P;++P)Q+=b[C-1+32*P];bl(Q>>3,b,C)}function mc(b,C){bl(128,b,C)}function wl(b,C,P){var Q=b[C-P],Y=b[C+0],te=3*(Y-Q)+Cy[1020+b[C-2*P]-b[C+P]],ne=bp[112+(te+4>>3)];b[C-P]=ba[255+Q+bp[112+(te+3>>3)]],b[C+0]=ba[255+Y-ne]}function ga(b,C,P,Q){var Y=b[C+0],te=b[C+P];return Ha[255+b[C-2*P]-b[C-P]]>Q||Ha[255+te-Y]>Q}function bc(b,C,P,Q){return 4*Ha[255+b[C-P]-b[C+0]]+Ha[255+b[C-2*P]-b[C+P]]<=Q}function Lo(b,C,P,Q,Y){var te=b[C-3*P],ne=b[C-2*P],ae=b[C-P],ue=b[C+0],pe=b[C+P],Se=b[C+2*P],De=b[C+3*P];return 4*Ha[255+ae-ue]+Ha[255+ne-pe]>Q?0:Ha[255+b[C-4*P]-te]<=Y&&Ha[255+te-ne]<=Y&&Ha[255+ne-ae]<=Y&&Ha[255+De-Se]<=Y&&Ha[255+Se-pe]<=Y&&Ha[255+pe-ue]<=Y}function Uo(b,C,P,Q){var Y=2*Q+1;for(Q=0;16>Q;++Q)bc(b,C+Q,P,Y)&&wl(b,C+Q,P)}function Mo(b,C,P,Q){var Y=2*Q+1;for(Q=0;16>Q;++Q)bc(b,C+Q*P,1,Y)&&wl(b,C+Q*P,1)}function vl(b,C,P,Q){var Y;for(Y=3;0<Y;--Y)Uo(b,C+=4*P,P,Q)}function iu(b,C,P,Q){var Y;for(Y=3;0<Y;--Y)Mo(b,C+=4,P,Q)}function Da(b,C,P,Q,Y,te,ne,ae){for(te=2*te+1;0<Y--;){if(Lo(b,C,P,te,ne))if(ga(b,C,P,ae))wl(b,C,P);else{var ue=b,pe=C,Se=P,De=ue[pe-2*Se],me=ue[pe-Se],ke=ue[pe+0],Me=ue[pe+Se],Ve=ue[pe+2*Se],Pe=27*(ze=Cy[1020+3*(ke-me)+Cy[1020+De-Me]])+63>>7,Ge=18*ze+63>>7,ze=9*ze+63>>7;ue[pe-3*Se]=ba[255+ue[pe-3*Se]+ze],ue[pe-2*Se]=ba[255+De+Ge],ue[pe-Se]=ba[255+me+Pe],ue[pe+0]=ba[255+ke-Pe],ue[pe+Se]=ba[255+Me-Ge],ue[pe+2*Se]=ba[255+Ve-ze]}C+=Q}}function Ni(b,C,P,Q,Y,te,ne,ae){for(te=2*te+1;0<Y--;){if(Lo(b,C,P,te,ne))if(ga(b,C,P,ae))wl(b,C,P);else{var ue=b,pe=C,Se=P,De=ue[pe-Se],me=ue[pe+0],ke=ue[pe+Se],Me=bp[112+(4+(Ve=3*(me-De))>>3)],Ve=bp[112+(Ve+3>>3)],Pe=Me+1>>1;ue[pe-2*Se]=ba[255+ue[pe-2*Se]+Pe],ue[pe-Se]=ba[255+De+Ve],ue[pe+0]=ba[255+me-Me],ue[pe+Se]=ba[255+ke-Pe]}C+=Q}}function VA(b,C,P,Q,Y,te){Da(b,C,P,1,16,Q,Y,te)}function $A(b,C,P,Q,Y,te){Da(b,C,1,P,16,Q,Y,te)}function so(b,C,P,Q,Y,te){var ne;for(ne=3;0<ne;--ne)Ni(b,C+=4*P,P,1,16,Q,Y,te)}function yc(b,C,P,Q,Y,te){var ne;for(ne=3;0<ne;--ne)Ni(b,C+=4,1,P,16,Q,Y,te)}function U(b,C,P,Q,Y,te,ne,ae){Da(b,C,Y,1,8,te,ne,ae),Da(P,Q,Y,1,8,te,ne,ae)}function q(b,C,P,Q,Y,te,ne,ae){Da(b,C,1,Y,8,te,ne,ae),Da(P,Q,1,Y,8,te,ne,ae)}function ge(b,C,P,Q,Y,te,ne,ae){Ni(b,C+4*Y,Y,1,8,te,ne,ae),Ni(P,Q+4*Y,Y,1,8,te,ne,ae)}function _e(b,C,P,Q,Y,te,ne,ae){Ni(b,C+4,1,Y,8,te,ne,ae),Ni(P,Q+4,1,Y,8,te,ne,ae)}function Te(){this.ba=new Lt,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new mr,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function $e(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Ye(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function vt(){this.ua=0,this.Wa=new Z,this.vb=new Z,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new K,this.yc=new T}function Et(){this.xb=this.a=0,this.l=new fa,this.ca=new Lt,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new O,this.Pb=0,this.wd=new O,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new vt,this.ab=0,this.gc=a(4,Ye),this.Oc=0}function $t(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new fa,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Mt(b,C,P,Q,Y,te,ne){for(b=b==null?0:b[C+0],C=0;C<ne;++C)Y[te+C]=b+P[Q+C]&255,b=Y[te+C]}function Ur(b,C,P,Q,Y,te,ne){var ae;if(b==null)Mt(null,null,P,Q,Y,te,ne);else for(ae=0;ae<ne;++ae)Y[te+ae]=b[C+ae]+P[Q+ae]&255}function gn(b,C,P,Q,Y,te,ne){if(b==null)Mt(null,null,P,Q,Y,te,ne);else{var ae,ue=b[C+0],pe=ue,Se=ue;for(ae=0;ae<ne;++ae)pe=Se+(ue=b[C+ae])-pe,Se=P[Q+ae]+(-256&pe?0>pe?0:255:pe)&255,pe=ue,Y[te+ae]=Se}}function ln(b,C,P,Q){var Y=C.width,te=C.o;if(e(b!=null&&C!=null),0>P||0>=Q||P+Q>te)return null;if(!b.Cc){if(b.ga==null){var ne;if(b.ga=new $t,(ne=b.ga==null)||(ne=C.width*C.o,e(b.Gb.length==0),b.Gb=i(ne),b.Uc=0,b.Gb==null?ne=0:(b.mb=b.Gb,b.nb=b.Uc,b.rc=null,ne=1),ne=!ne),!ne){ne=b.ga;var ae=b.Fa,ue=b.P,pe=b.qc,Se=b.mb,De=b.nb,me=ue+1,ke=pe-1,Me=ne.l;if(e(ae!=null&&Se!=null&&C!=null),Ec[0]=null,Ec[1]=Mt,Ec[2]=Ur,Ec[3]=gn,ne.ca=Se,ne.tb=De,ne.c=C.width,ne.i=C.height,e(0<ne.c&&0<ne.i),1>=pe)C=0;else if(ne.$a=3&ae[ue+0],ne.Z=ae[ue+0]>>2&3,ne.Lc=ae[ue+0]>>4&3,ue=ae[ue+0]>>6&3,0>ne.$a||1<ne.$a||4<=ne.Z||1<ne.Lc||ue)C=0;else if(Me.put=Ht,Me.ac=Bs,Me.bc=da,Me.ma=ne,Me.width=C.width,Me.height=C.height,Me.Da=C.Da,Me.v=C.v,Me.va=C.va,Me.j=C.j,Me.o=C.o,ne.$a)e:{e(ne.$a==1),C=Rs();t:for(;;){if(C==null){C=0;break e}if(e(ne!=null),ne.mc=C,C.c=ne.c,C.i=ne.i,C.l=ne.l,C.l.ma=ne,C.l.width=ne.c,C.l.height=ne.i,C.a=0,V(C.m,ae,me,ke),!Os(ne.c,ne.i,1,C,null)||(C.ab==1&&C.gc[0].hc==3&&Zs(C.s)?(ne.ic=1,ae=C.c*C.i,C.Ta=null,C.Ua=0,C.V=i(ae),C.Ba=0,C.V==null?(C.a=1,C=0):C=1):(ne.ic=0,C=Qs(C,ne.c)),!C))break t;C=1;break e}ne.mc=null,C=0}else C=ke>=ne.c*ne.i;ne=!C}if(ne)return null;b.ga.Lc!=1?b.Ga=0:Q=te-P}e(b.ga!=null),e(P+Q<=te);e:{if(C=(ae=b.ga).c,te=ae.l.o,ae.$a==0){if(me=b.rc,ke=b.Vc,Me=b.Fa,ue=b.P+1+P*C,pe=b.mb,Se=b.nb+P*C,e(ue<=b.P+b.qc),ae.Z!=0)for(e(Ec[ae.Z]!=null),ne=0;ne<Q;++ne)Ec[ae.Z](me,ke,Me,ue,pe,Se,C),me=pe,ke=Se,Se+=C,ue+=C;else for(ne=0;ne<Q;++ne)n(pe,Se,Me,ue,C),me=pe,ke=Se,Se+=C,ue+=C;b.rc=me,b.Vc=ke}else{if(e(ae.mc!=null),C=P+Q,e((ne=ae.mc)!=null),e(C<=ne.i),ne.C>=C)C=1;else if(ae.ic||Le(),ae.ic){ae=ne.V,me=ne.Ba,ke=ne.c;var Ve=ne.i,Pe=(Me=1,ue=ne.$/ke,pe=ne.$%ke,Se=ne.m,De=ne.s,ne.$),Ge=ke*Ve,ze=ke*C,et=De.wc,Xe=Pe<ze?Xn(De,pe,ue):null;e(Pe<=Ge),e(C<=Ve),e(Zs(De));t:for(;;){for(;!Se.h&&Pe<ze;){if(pe&et||(Xe=Xn(De,pe,ue)),e(Xe!=null),ie(Se),256>(Ve=Jr(Xe.G[0],Xe.H[0],Se)))ae[me+Pe]=Ve,++Pe,++pe>=ke&&(pe=0,++ue<=C&&!(ue%16)&&Ps(ne,ue));else{if(!(280>Ve)){Me=0;break t}Ve=Xs(Ve-256,Se);var Nt,xt=Jr(Xe.G[4],Xe.H[4],Se);if(ie(Se),!(Pe>=(xt=Js(ke,xt=Xs(xt,Se)))&&Ge-Pe>=Ve)){Me=0;break t}for(Nt=0;Nt<Ve;++Nt)ae[me+Pe+Nt]=ae[me+Pe+Nt-xt];for(Pe+=Ve,pe+=Ve;pe>=ke;)pe-=ke,++ue<=C&&!(ue%16)&&Ps(ne,ue);Pe<ze&&pe&et&&(Xe=Xn(De,pe,ue))}e(Se.h==J(Se))}Ps(ne,ue>C?C:ue);break t}!Me||Se.h&&Pe<Ge?(Me=0,ne.a=Se.h?5:3):ne.$=Pe,C=Me}else C=ti(ne,ne.V,ne.Ba,ne.c,ne.i,C,ji);if(!C){Q=0;break e}}P+Q>=te&&(b.Cc=1),Q=1}if(!Q)return null;if(b.Cc&&((Q=b.ga)!=null&&(Q.mc=null),b.ga=null,0<b.Ga))return alert("todo:WebPDequantizeLevels"),null}return b.nb+P*Y}function y(b,C,P,Q,Y,te){for(;0<Y--;){var ne,ae=b,ue=C+(P?1:0),pe=b,Se=C+(P?0:3);for(ne=0;ne<Q;++ne){var De=pe[Se+4*ne];De!=255&&(De*=32897,ae[ue+4*ne+0]=ae[ue+4*ne+0]*De>>23,ae[ue+4*ne+1]=ae[ue+4*ne+1]*De>>23,ae[ue+4*ne+2]=ae[ue+4*ne+2]*De>>23)}C+=te}}function R(b,C,P,Q,Y){for(;0<Q--;){var te;for(te=0;te<P;++te){var ne=b[C+2*te+0],ae=15&(pe=b[C+2*te+1]),ue=4369*ae,pe=(240&pe|pe>>4)*ue>>16;b[C+2*te+0]=(240&ne|ne>>4)*ue>>16&240|(15&ne|ne<<4)*ue>>16>>4&15,b[C+2*te+1]=240&pe|ae}C+=Y}}function j(b,C,P,Q,Y,te,ne,ae){var ue,pe,Se=255;for(pe=0;pe<Y;++pe){for(ue=0;ue<Q;++ue){var De=b[C+ue];te[ne+4*ue]=De,Se&=De}C+=P,ne+=ae}return Se!=255}function oe(b,C,P,Q,Y){var te;for(te=0;te<Y;++te)P[Q+te]=b[C+te]>>8}function Le(){jh=y,x_=R,__=j,B_=oe}function Re(b,C,P){v[b]=function(Q,Y,te,ne,ae,ue,pe,Se,De,me,ke,Me,Ve,Pe,Ge,ze,et){var Xe,Nt=et-1>>1,xt=ae[ue+0]|pe[Se+0]<<16,br=De[me+0]|ke[Me+0]<<16;e(Q!=null);var It=3*xt+br+131074>>2;for(C(Q[Y+0],255&It,It>>16,Ve,Pe),te!=null&&(It=3*br+xt+131074>>2,C(te[ne+0],255&It,It>>16,Ge,ze)),Xe=1;Xe<=Nt;++Xe){var Fr=ae[ue+Xe]|pe[Se+Xe]<<16,Is=De[me+Xe]|ke[Me+Xe]<<16,yr=xt+Fr+br+Is+524296,Tt=yr+2*(Fr+br)>>3;It=Tt+xt>>1,xt=(yr=yr+2*(xt+Is)>>3)+Fr>>1,C(Q[Y+2*Xe-1],255&It,It>>16,Ve,Pe+(2*Xe-1)*P),C(Q[Y+2*Xe-0],255&xt,xt>>16,Ve,Pe+(2*Xe-0)*P),te!=null&&(It=yr+br>>1,xt=Tt+Is>>1,C(te[ne+2*Xe-1],255&It,It>>16,Ge,ze+(2*Xe-1)*P),C(te[ne+2*Xe+0],255&xt,xt>>16,Ge,ze+(2*Xe+0)*P)),xt=Fr,br=Is}1&et||(It=3*xt+br+131074>>2,C(Q[Y+et-1],255&It,It>>16,Ve,Pe+(et-1)*P),te!=null&&(It=3*br+xt+131074>>2,C(te[ne+et-1],255&It,It>>16,Ge,ze+(et-1)*P)))}}function at(){ja[yp]=eP,ja[wp]=N_,ja[T_]=tP,ja[vp]=P_,ja[xp]=D_,ja[Sy]=R_,ja[F_]=rP,ja[ky]=N_,ja[Ey]=P_,ja[_p]=D_,ja[Iy]=R_}function Jt(b){return b&-16384?0>b?0:255:b>>nP}function cn(b,C){return Jt((19077*b>>8)+(26149*C>>8)-14234)}function Sr(b,C,P){return Jt((19077*b>>8)-(6419*C>>8)-(13320*P>>8)+8708)}function pn(b,C){return Jt((19077*b>>8)+(33050*C>>8)-17685)}function js(b,C,P,Q,Y){Q[Y+0]=cn(b,P),Q[Y+1]=Sr(b,C,P),Q[Y+2]=pn(b,C)}function Pi(b,C,P,Q,Y){Q[Y+0]=pn(b,C),Q[Y+1]=Sr(b,C,P),Q[Y+2]=cn(b,P)}function _n(b,C,P,Q,Y){var te=Sr(b,C,P);C=te<<3&224|pn(b,C)>>3,Q[Y+0]=248&cn(b,P)|te>>5,Q[Y+1]=C}function gi(b,C,P,Q,Y){var te=240&pn(b,C)|15;Q[Y+0]=240&cn(b,P)|Sr(b,C,P)>>4,Q[Y+1]=te}function Ra(b,C,P,Q,Y){Q[Y+0]=255,js(b,C,P,Q,Y+1)}function xl(b,C,P,Q,Y){Pi(b,C,P,Q,Y),Q[Y+3]=255}function Uh(b,C,P,Q,Y){js(b,C,P,Q,Y),Q[Y+3]=255}function Hn(b,C){return 0>b?0:b>C?C:b}function _l(b,C,P){v[b]=function(Q,Y,te,ne,ae,ue,pe,Se,De){for(var me=Se+(-2&De)*P;Se!=me;)C(Q[Y+0],te[ne+0],ae[ue+0],pe,Se),C(Q[Y+1],te[ne+0],ae[ue+0],pe,Se+P),Y+=2,++ne,++ue,Se+=2*P;1&De&&C(Q[Y+0],te[ne+0],ae[ue+0],pe,Se)}}function au(b,C,P){return P==0?b==0?C==0?6:5:C==0?4:0:P}function gp(b,C,P,Q,Y){switch(b>>>30){case 3:qA(C,P,Q,Y,0);break;case 2:Qa(C,P,Q,Y);break;case 1:qr(C,P,Q,Y)}}function Oa(b,C){var P,Q,Y=C.M,te=C.Nb,ne=b.oc,ae=b.pc+40,ue=b.oc,pe=b.pc+584,Se=b.oc,De=b.pc+600;for(P=0;16>P;++P)ne[ae+32*P-1]=129;for(P=0;8>P;++P)ue[pe+32*P-1]=129,Se[De+32*P-1]=129;for(0<Y?ne[ae-1-32]=ue[pe-1-32]=Se[De-1-32]=129:(s(ne,ae-32-1,127,21),s(ue,pe-32-1,127,9),s(Se,De-32-1,127,9)),Q=0;Q<b.za;++Q){var me=C.ya[C.aa+Q];if(0<Q){for(P=-1;16>P;++P)n(ne,ae+32*P-4,ne,ae+32*P+12,4);for(P=-1;8>P;++P)n(ue,pe+32*P-4,ue,pe+32*P+4,4),n(Se,De+32*P-4,Se,De+32*P+4,4)}var ke=b.Gd,Me=b.Hd+Q,Ve=me.ad,Pe=me.Hc;if(0<Y&&(n(ne,ae-32,ke[Me].y,0,16),n(ue,pe-32,ke[Me].f,0,8),n(Se,De-32,ke[Me].ea,0,8)),me.Za){var Ge=ne,ze=ae-32+16;for(0<Y&&(Q>=b.za-1?s(Ge,ze,ke[Me].y[15],4):n(Ge,ze,ke[Me+1].y,0,4)),P=0;4>P;P++)Ge[ze+128+P]=Ge[ze+256+P]=Ge[ze+384+P]=Ge[ze+0+P];for(P=0;16>P;++P,Pe<<=2)Ge=ne,ze=ae+Q_[P],io[me.Ob[P]](Ge,ze),gp(Pe,Ve,16*+P,Ge,ze)}else if(Ge=au(Q,Y,me.Ob[0]),kc[Ge](ne,ae),Pe!=0)for(P=0;16>P;++P,Pe<<=2)gp(Pe,Ve,16*+P,ne,ae+Q_[P]);for(P=me.Gc,Ge=au(Q,Y,me.Dd),Sl[Ge](ue,pe),Sl[Ge](Se,De),Pe=Ve,Ge=ue,ze=pe,255&(me=0|P)&&(170&me?Do(Pe,256,Ge,ze):An(Pe,256,Ge,ze)),me=Se,Pe=De,255&(P>>=8)&&(170&P?Do(Ve,320,me,Pe):An(Ve,320,me,Pe)),Y<b.Ub-1&&(n(ke[Me].y,0,ne,ae+480,16),n(ke[Me].f,0,ue,pe+224,8),n(ke[Me].ea,0,Se,De+224,8)),P=8*te*b.B,ke=b.sa,Me=b.ta+16*Q+16*te*b.R,Ve=b.qa,me=b.ra+8*Q+P,Pe=b.Ha,Ge=b.Ia+8*Q+P,P=0;16>P;++P)n(ke,Me+P*b.R,ne,ae+32*P,16);for(P=0;8>P;++P)n(Ve,me+P*b.B,ue,pe+32*P,8),n(Pe,Ge+P*b.B,Se,De+32*P,8)}}function GA(b,C,P,Q,Y,te,ne,ae,ue){var pe=[0],Se=[0],De=0,me=ue!=null?ue.kd:0,ke=ue??new $e;if(b==null||12>P)return 7;ke.data=b,ke.w=C,ke.ha=P,C=[C],P=[P],ke.gb=[ke.gb];e:{var Me=C,Ve=P,Pe=ke.gb;if(e(b!=null),e(Ve!=null),e(Pe!=null),Pe[0]=0,12<=Ve[0]&&!t(b,Me[0],"RIFF")){if(t(b,Me[0]+8,"WEBP")){Pe=3;break e}var Ge=D(b,Me[0]+4);if(12>Ge||4294967286<Ge){Pe=3;break e}if(me&&Ge>Ve[0]-8){Pe=7;break e}Pe[0]=Ge,Me[0]+=12,Ve[0]-=12}Pe=0}if(Pe!=0)return Pe;for(Ge=0<ke.gb[0],P=P[0];;){e:{var ze=b;Ve=C,Pe=P;var et=pe,Xe=Se,Nt=Me=[0];if((It=De=[De])[0]=0,8>Pe[0])Pe=7;else{if(!t(ze,Ve[0],"VP8X")){if(D(ze,Ve[0]+4)!=10){Pe=3;break e}if(18>Pe[0]){Pe=7;break e}var xt=D(ze,Ve[0]+8),br=1+Qe(ze,Ve[0]+12);if(2147483648<=br*(ze=1+Qe(ze,Ve[0]+15))){Pe=3;break e}Nt!=null&&(Nt[0]=xt),et!=null&&(et[0]=br),Xe!=null&&(Xe[0]=ze),Ve[0]+=18,Pe[0]-=18,It[0]=1}Pe=0}}if(De=De[0],Me=Me[0],Pe!=0)return Pe;if(Ve=!!(2&Me),!Ge&&De)return 3;if(te!=null&&(te[0]=!!(16&Me)),ne!=null&&(ne[0]=Ve),ae!=null&&(ae[0]=0),ne=pe[0],Me=Se[0],De&&Ve&&ue==null){Pe=0;break}if(4>P){Pe=7;break}if(Ge&&De||!Ge&&!De&&!t(b,C[0],"ALPH")){P=[P],ke.na=[ke.na],ke.P=[ke.P],ke.Sa=[ke.Sa];e:{xt=b,Pe=C,Ge=P;var It=ke.gb;et=ke.na,Xe=ke.P,Nt=ke.Sa,br=22,e(xt!=null),e(Ge!=null),ze=Pe[0];var Fr=Ge[0];for(e(et!=null),e(Nt!=null),et[0]=null,Xe[0]=null,Nt[0]=0;;){if(Pe[0]=ze,Ge[0]=Fr,8>Fr){Pe=7;break e}var Is=D(xt,ze+4);if(4294967286<Is){Pe=3;break e}var yr=8+Is+1&-2;if(br+=yr,0<It&&br>It){Pe=3;break e}if(!t(xt,ze,"VP8 ")||!t(xt,ze,"VP8L")){Pe=0;break e}if(Fr[0]<yr){Pe=7;break e}t(xt,ze,"ALPH")||(et[0]=xt,Xe[0]=ze+8,Nt[0]=Is),ze+=yr,Fr-=yr}}if(P=P[0],ke.na=ke.na[0],ke.P=ke.P[0],ke.Sa=ke.Sa[0],Pe!=0)break}P=[P],ke.Ja=[ke.Ja],ke.xa=[ke.xa];e:if(It=b,Pe=C,Ge=P,et=ke.gb[0],Xe=ke.Ja,Nt=ke.xa,xt=Pe[0],ze=!t(It,xt,"VP8 "),br=!t(It,xt,"VP8L"),e(It!=null),e(Ge!=null),e(Xe!=null),e(Nt!=null),8>Ge[0])Pe=7;else{if(ze||br){if(It=D(It,xt+4),12<=et&&It>et-12){Pe=3;break e}if(me&&It>Ge[0]-8){Pe=7;break e}Xe[0]=It,Pe[0]+=8,Ge[0]-=8,Nt[0]=br}else Nt[0]=5<=Ge[0]&&It[xt+0]==47&&!(It[xt+4]>>5),Xe[0]=Ge[0];Pe=0}if(P=P[0],ke.Ja=ke.Ja[0],ke.xa=ke.xa[0],C=C[0],Pe!=0)break;if(4294967286<ke.Ja)return 3;if(ae==null||Ve||(ae[0]=ke.xa?2:1),ne=[ne],Me=[Me],ke.xa){if(5>P){Pe=7;break}ae=ne,me=Me,Ve=te,b==null||5>P?b=0:5<=P&&b[C+0]==47&&!(b[C+4]>>5)?(Ge=[0],It=[0],et=[0],V(Xe=new O,b,C,P),Cs(Xe,Ge,It,et)?(ae!=null&&(ae[0]=Ge[0]),me!=null&&(me[0]=It[0]),Ve!=null&&(Ve[0]=et[0]),b=1):b=0):b=0}else{if(10>P){Pe=7;break}ae=Me,b==null||10>P||!qi(b,C+3,P-3)?b=0:(me=b[C+0]|b[C+1]<<8|b[C+2]<<16,Ve=16383&(b[C+7]<<8|b[C+6]),b=16383&(b[C+9]<<8|b[C+8]),1&me||3<(me>>1&7)||!(me>>4&1)||me>>5>=ke.Ja||!Ve||!b?b=0:(ne&&(ne[0]=Ve),ae&&(ae[0]=b),b=1))}if(!b||(ne=ne[0],Me=Me[0],De&&(pe[0]!=ne||Se[0]!=Me)))return 3;ue!=null&&(ue[0]=ke,ue.offset=C-ue.w,e(4294967286>C-ue.w),e(ue.offset==ue.ha-P));break}return Pe==0||Pe==7&&De&&ue==null?(te!=null&&(te[0]|=ke.na!=null&&0<ke.na.length),Q!=null&&(Q[0]=ne),Y!=null&&(Y[0]=Me),0):Pe}function Mh(b,C,P){var Q=C.width,Y=C.height,te=0,ne=0,ae=Q,ue=Y;if(C.Da=b!=null&&0<b.Da,C.Da&&(ae=b.cd,ue=b.bd,te=b.v,ne=b.j,11>P||(te&=-2,ne&=-2),0>te||0>ne||0>=ae||0>=ue||te+ae>Q||ne+ue>Y))return 0;if(C.v=te,C.j=ne,C.va=te+ae,C.o=ne+ue,C.U=ae,C.T=ue,C.da=b!=null&&0<b.da,C.da){if(!W(ae,ue,P=[b.ib],te=[b.hb]))return 0;C.ib=P[0],C.hb=te[0]}return C.ob=b!=null&&b.ob,C.Kb=b==null||!b.Sd,C.da&&(C.ob=C.ib<3*Q/4&&C.hb<3*Y/4,C.Kb=0),1}function Nh(b){if(b==null)return 2;if(11>b.S){var C=b.f.RGBA;C.fb+=(b.height-1)*C.A,C.A=-C.A}else C=b.f.kb,b=b.height,C.O+=(b-1)*C.fa,C.fa=-C.fa,C.N+=(b-1>>1)*C.Ab,C.Ab=-C.Ab,C.W+=(b-1>>1)*C.Db,C.Db=-C.Db,C.F!=null&&(C.J+=(b-1)*C.lb,C.lb=-C.lb);return 0}function wc(b,C,P,Q){if(Q==null||0>=b||0>=C)return 2;if(P!=null){if(P.Da){var Y=P.cd,te=P.bd,ne=-2&P.v,ae=-2&P.j;if(0>ne||0>ae||0>=Y||0>=te||ne+Y>b||ae+te>C)return 2;b=Y,C=te}if(P.da){if(!W(b,C,Y=[P.ib],te=[P.hb]))return 2;b=Y[0],C=te[0]}}Q.width=b,Q.height=C;e:{var ue=Q.width,pe=Q.height;if(b=Q.S,0>=ue||0>=pe||!(b>=yp&&13>b))b=2;else{if(0>=Q.Rd&&Q.sd==null){ne=te=Y=C=0;var Se=(ae=ue*H_[b])*pe;if(11>b||(te=(pe+1)/2*(C=(ue+1)/2),b==12&&(ne=(Y=ue)*pe)),(pe=i(Se+2*te+ne))==null){b=1;break e}Q.sd=pe,11>b?((ue=Q.f.RGBA).eb=pe,ue.fb=0,ue.A=ae,ue.size=Se):((ue=Q.f.kb).y=pe,ue.O=0,ue.fa=ae,ue.Fd=Se,ue.f=pe,ue.N=0+Se,ue.Ab=C,ue.Cd=te,ue.ea=pe,ue.W=0+Se+te,ue.Db=C,ue.Ed=te,b==12&&(ue.F=pe,ue.J=0+Se+2*te),ue.Tc=ne,ue.lb=Y)}if(C=1,Y=Q.S,te=Q.width,ne=Q.height,Y>=yp&&13>Y)if(11>Y)b=Q.f.RGBA,C&=(ae=Math.abs(b.A))*(ne-1)+te<=b.size,C&=ae>=te*H_[Y],C&=b.eb!=null;else{b=Q.f.kb,ae=(te+1)/2,Se=(ne+1)/2,ue=Math.abs(b.fa),pe=Math.abs(b.Ab);var De=Math.abs(b.Db),me=Math.abs(b.lb),ke=me*(ne-1)+te;C&=ue*(ne-1)+te<=b.Fd,C&=pe*(Se-1)+ae<=b.Cd,C=(C&=De*(Se-1)+ae<=b.Ed)&ue>=te&pe>=ae&De>=ae,C&=b.y!=null,C&=b.f!=null,C&=b.ea!=null,Y==12&&(C&=me>=te,C&=ke<=b.Tc,C&=b.F!=null)}else C=0;b=C?0:2}}return b!=0||P!=null&&P.fd&&(b=Nh(Q)),b}var zA=64,pa=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],ma=24,vc=32,Bl=8,xc=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];xe("Predictor0","PredictorAdd0"),v.Predictor0=function(){return 4278190080},v.Predictor1=function(b){return b},v.Predictor2=function(b,C,P){return C[P+0]},v.Predictor3=function(b,C,P){return C[P+1]},v.Predictor4=function(b,C,P){return C[P-1]},v.Predictor5=function(b,C,P){return Ee(Ee(b,C[P+1]),C[P+0])},v.Predictor6=function(b,C,P){return Ee(b,C[P-1])},v.Predictor7=function(b,C,P){return Ee(b,C[P+0])},v.Predictor8=function(b,C,P){return Ee(C[P-1],C[P+0])},v.Predictor9=function(b,C,P){return Ee(C[P+0],C[P+1])},v.Predictor10=function(b,C,P){return Ee(Ee(b,C[P-1]),Ee(C[P+0],C[P+1]))},v.Predictor11=function(b,C,P){var Q=C[P+0];return 0>=je(Q>>24&255,b>>24&255,(C=C[P-1])>>24&255)+je(Q>>16&255,b>>16&255,C>>16&255)+je(Q>>8&255,b>>8&255,C>>8&255)+je(255&Q,255&b,255&C)?Q:b},v.Predictor12=function(b,C,P){var Q=C[P+0];return(Ne((b>>24&255)+(Q>>24&255)-((C=C[P-1])>>24&255))<<24|Ne((b>>16&255)+(Q>>16&255)-(C>>16&255))<<16|Ne((b>>8&255)+(Q>>8&255)-(C>>8&255))<<8|Ne((255&b)+(255&Q)-(255&C)))>>>0},v.Predictor13=function(b,C,P){var Q=C[P-1];return(Ue((b=Ee(b,C[P+0]))>>24&255,Q>>24&255)<<24|Ue(b>>16&255,Q>>16&255)<<16|Ue(b>>8&255,Q>>8&255)<<8|Ue(255&b,255&Q))>>>0};var Ph=v.PredictorAdd0;v.PredictorAdd1=st,xe("Predictor2","PredictorAdd2"),xe("Predictor3","PredictorAdd3"),xe("Predictor4","PredictorAdd4"),xe("Predictor5","PredictorAdd5"),xe("Predictor6","PredictorAdd6"),xe("Predictor7","PredictorAdd7"),xe("Predictor8","PredictorAdd8"),xe("Predictor9","PredictorAdd9"),xe("Predictor10","PredictorAdd10"),xe("Predictor11","PredictorAdd11"),xe("Predictor12","PredictorAdd12"),xe("Predictor13","PredictorAdd13");var ou=v.PredictorAdd2;it("ColorIndexInverseTransform","MapARGB","32b",function(b){return b>>8&255},function(b){return b}),it("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(b){return b},function(b){return b>>8&255});var Zn,pp=v.ColorIndexInverseTransform,No=v.MapARGB,Po=v.VP8LColorIndexInverseTransformAlpha,Dh=v.MapAlpha,Rh=v.VP8LPredictorsAdd=[];Rh.length=16,(v.VP8LPredictors=[]).length=16,(v.VP8LPredictorsAdd_C=[]).length=16,(v.VP8LPredictors_C=[]).length=16;var Oh,Qh,_c,Bc,Cc,KA,Sc,qA,Qa,Do,qr,An,es,Es,Cl,Hh,lu,mp,p_,m_,b_,y_,w_,v_,jh,x_,__,B_,C_=i(511),S_=i(2041),k_=i(225),E_=i(767),I_=0,Cy=S_,bp=k_,ba=E_,Ha=C_,yp=0,wp=1,T_=2,vp=3,xp=4,Sy=5,F_=6,ky=7,Ey=8,_p=9,Iy=10,QN=[2,3,7],HN=[3,3,11],L_=[280,256,256,256,40],jN=[0,1,1,1,0],VN=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],$N=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],GN=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],zN=8,Ty=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Fy=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Vh=null,KN=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],qN=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],U_=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],WN=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],YN=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],XN=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],JN=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],kc=[],io=[],Sl=[],ZN=1,M_=2,Ec=[],ja=[];Re("UpsampleRgbLinePair",js,3),Re("UpsampleBgrLinePair",Pi,3),Re("UpsampleRgbaLinePair",Uh,4),Re("UpsampleBgraLinePair",xl,4),Re("UpsampleArgbLinePair",Ra,4),Re("UpsampleRgba4444LinePair",gi,2),Re("UpsampleRgb565LinePair",_n,2);var eP=v.UpsampleRgbLinePair,tP=v.UpsampleBgrLinePair,N_=v.UpsampleRgbaLinePair,P_=v.UpsampleBgraLinePair,D_=v.UpsampleArgbLinePair,R_=v.UpsampleRgba4444LinePair,rP=v.UpsampleRgb565LinePair,Bp=16,Cp=1<<Bp-1,$h=-227,Ly=482,nP=6,O_=0,sP=i(256),iP=i(256),aP=i(256),oP=i(256),lP=i(Ly-$h),cP=i(Ly-$h);_l("YuvToRgbRow",js,3),_l("YuvToBgrRow",Pi,3),_l("YuvToRgbaRow",Uh,4),_l("YuvToBgraRow",xl,4),_l("YuvToArgbRow",Ra,4),_l("YuvToRgba4444Row",gi,2),_l("YuvToRgb565Row",_n,2);var Q_=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Sp=[0,2,8],AP=[8,7,6,4,4,2,2,2,1,1,1,1],dP=1;this.WebPDecodeRGBA=function(b,C,P,Q,Y){var te=wp,ne=new Te,ae=new Lt;ne.ba=ae,ae.S=te,ae.width=[ae.width],ae.height=[ae.height];var ue=ae.width,pe=ae.height,Se=new Ut;if(Se==null||b==null)var De=2;else e(Se!=null),De=GA(b,C,P,Se.width,Se.height,Se.Pd,Se.Qd,Se.format,null);if(De!=0?ue=0:(ue!=null&&(ue[0]=Se.width[0]),pe!=null&&(pe[0]=Se.height[0]),ue=1),ue){ae.width=ae.width[0],ae.height=ae.height[0],Q!=null&&(Q[0]=ae.width),Y!=null&&(Y[0]=ae.height);e:{if(Q=new fa,(Y=new $e).data=b,Y.w=C,Y.ha=P,Y.kd=1,C=[0],e(Y!=null),((b=GA(Y.data,Y.w,Y.ha,null,null,null,C,null,Y))==0||b==7)&&C[0]&&(b=4),(C=b)==0){if(e(ne!=null),Q.data=Y.data,Q.w=Y.w+Y.offset,Q.ha=Y.ha-Y.offset,Q.put=Ht,Q.ac=Bs,Q.bc=da,Q.ma=ne,Y.xa){if((b=Rs())==null){ne=1;break e}if((function(me,ke){var Me=[0],Ve=[0],Pe=[0];t:for(;;){if(me==null)return 0;if(ke==null)return me.a=2,0;if(me.l=ke,me.a=0,V(me.m,ke.data,ke.w,ke.ha),!Cs(me.m,Me,Ve,Pe)){me.a=3;break t}if(me.xb=M_,ke.width=Me[0],ke.height=Ve[0],!Os(Me[0],Ve[0],1,me,null))break t;return 1}return e(me.a!=0),0})(b,Q)){if(Q=(C=wc(Q.width,Q.height,ne.Oa,ne.ba))==0){t:{Q=b;r:for(;;){if(Q==null){Q=0;break t}if(e(Q.s.yc!=null),e(Q.s.Ya!=null),e(0<Q.s.Wb),e((P=Q.l)!=null),e((Y=P.ma)!=null),Q.xb!=0){if(Q.ca=Y.ba,Q.tb=Y.tb,e(Q.ca!=null),!Mh(Y.Oa,P,vp)){Q.a=2;break r}if(!Qs(Q,P.width)||P.da)break r;if((P.da||Rt(Q.ca.S))&&Le(),11>Q.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),Q.ca.f.kb.F!=null&&Le()),Q.Pb&&0<Q.s.ua&&Q.s.vb.X==null&&!G(Q.s.vb,Q.s.Wa.Xa)){Q.a=1;break r}Q.xb=0}if(!ti(Q,Q.V,Q.Ba,Q.c,Q.i,P.o,ua))break r;Y.Dc=Q.Ma,Q=1;break t}e(Q.a!=0),Q=0}Q=!Q}Q&&(C=b.a)}else C=b.a}else{if((b=new Ln)==null){ne=1;break e}if(b.Fa=Y.na,b.P=Y.P,b.qc=Y.Sa,Wi(b,Q)){if((C=wc(Q.width,Q.height,ne.Oa,ne.ba))==0){if(b.Aa=0,P=ne.Oa,e((Y=b)!=null),P!=null){if(0<(ue=0>(ue=P.Md)?0:100<ue?255:255*ue/100)){for(pe=Se=0;4>pe;++pe)12>(De=Y.pb[pe]).lc&&(De.ia=ue*AP[0>De.lc?0:De.lc]>>3),Se|=De.ia;Se&&(alert("todo:VP8InitRandom"),Y.ia=1)}Y.Ga=P.Id,100<Y.Ga?Y.Ga=100:0>Y.Ga&&(Y.Ga=0)}(function(me,ke){if(me==null)return 0;if(ke==null)return Cr(me,2,"NULL VP8Io parameter in VP8Decode().");if(!me.cb&&!Wi(me,ke))return 0;if(e(me.cb),ke.ac==null||ke.ac(ke)){ke.ob&&(me.L=0);var Me=Sp[me.L];if(me.L==2?(me.yb=0,me.zb=0):(me.yb=ke.v-Me>>4,me.zb=ke.j-Me>>4,0>me.yb&&(me.yb=0),0>me.zb&&(me.zb=0)),me.Va=ke.o+15+Me>>4,me.Hb=ke.va+15+Me>>4,me.Hb>me.za&&(me.Hb=me.za),me.Va>me.Ub&&(me.Va=me.Ub),0<me.L){var Ve=me.ed;for(Me=0;4>Me;++Me){var Pe;if(me.Qa.Cb){var Ge=me.Qa.Lb[Me];me.Qa.Fb||(Ge+=Ve.Tb)}else Ge=Ve.Tb;for(Pe=0;1>=Pe;++Pe){var ze=me.gd[Me][Pe],et=Ge;if(Ve.Pc&&(et+=Ve.vd[0],Pe&&(et+=Ve.od[0])),0<(et=0>et?0:63<et?63:et)){var Xe=et;0<Ve.wb&&(Xe=4<Ve.wb?Xe>>2:Xe>>1)>9-Ve.wb&&(Xe=9-Ve.wb),1>Xe&&(Xe=1),ze.dd=Xe,ze.tc=2*et+Xe,ze.ld=40<=et?2:15<=et?1:0}else ze.tc=0;ze.La=Pe}}}Me=0}else Cr(me,6,"Frame setup failed"),Me=me.a;if(Me=Me==0){if(Me){me.$c=0,0<me.Aa||(me.Ic=dP);t:{Me=me.Ic,Ve=4*(Xe=me.za);var Nt=32*Xe,xt=Xe+1,br=0<me.L?Xe*(0<me.Aa?2:1):0,It=(me.Aa==2?2:1)*Xe;if((ze=Ve+832+(Pe=3*(16*Me+Sp[me.L])/2*Nt)+(Ge=me.Fa!=null&&0<me.Fa.length?me.Kc.c*me.Kc.i:0))!=ze)Me=0;else{if(ze>me.Vb){if(me.Vb=0,me.Ec=i(ze),me.Fc=0,me.Ec==null){Me=Cr(me,1,"no memory during frame initialization.");break t}me.Vb=ze}ze=me.Ec,et=me.Fc,me.Ac=ze,me.Bc=et,et+=Ve,me.Gd=a(Nt,ko),me.Hd=0,me.rb=a(xt+1,Hs),me.sb=1,me.wa=br?a(br,Fn):null,me.Y=0,me.D.Nb=0,me.D.wa=me.wa,me.D.Y=me.Y,0<me.Aa&&(me.D.Y+=Xe),e(!0),me.oc=ze,me.pc=et,et+=832,me.ya=a(It,ps),me.aa=0,me.D.ya=me.ya,me.D.aa=me.aa,me.Aa==2&&(me.D.aa+=Xe),me.R=16*Xe,me.B=8*Xe,Xe=(Nt=Sp[me.L])*me.R,Nt=Nt/2*me.B,me.sa=ze,me.ta=et+Xe,me.qa=me.sa,me.ra=me.ta+16*Me*me.R+Nt,me.Ha=me.qa,me.Ia=me.ra+8*Me*me.B+Nt,me.$c=0,et+=Pe,me.mb=Ge?ze:null,me.nb=Ge?et:null,e(et+Ge<=me.Fc+me.Vb),_r(me),s(me.Ac,me.Bc,0,Ve),Me=1}}if(Me){if(ke.ka=0,ke.y=me.sa,ke.O=me.ta,ke.f=me.qa,ke.N=me.ra,ke.ea=me.Ha,ke.Vd=me.Ia,ke.fa=me.R,ke.Rc=me.B,ke.F=null,ke.J=0,!I_){for(Me=-255;255>=Me;++Me)C_[255+Me]=0>Me?-Me:Me;for(Me=-1020;1020>=Me;++Me)S_[1020+Me]=-128>Me?-128:127<Me?127:Me;for(Me=-112;112>=Me;++Me)k_[112+Me]=-16>Me?-16:15<Me?15:Me;for(Me=-255;510>=Me;++Me)E_[255+Me]=0>Me?0:255<Me?255:Me;I_=1}Sc=Ae,qA=hc,Do=OA,qr=Yi,An=re,Qa=To,es=VA,Es=$A,Cl=U,Hh=q,lu=so,mp=yc,p_=ge,m_=_e,b_=Uo,y_=Mo,w_=vl,v_=iu,io[0]=su,io[1]=Oe,io[2]=QA,io[3]=fc,io[4]=ml,io[5]=Pa,io[6]=Mi,io[7]=HA,io[8]=gc,io[9]=fn,kc[0]=hn,kc[1]=ht,kc[2]=nr,kc[3]=on,kc[4]=fi,kc[5]=pl,kc[6]=Xi,Sl[0]=yl,Sl[1]=Je,Sl[2]=jA,Sl[3]=Fo,Sl[4]=Ji,Sl[5]=pc,Sl[6]=mc,Me=1}else Me=0}Me&&(Me=(function(Fr,Is){for(Fr.M=0;Fr.M<Fr.Va;++Fr.M){var yr,Tt=Fr.Jc[Fr.M&Fr.Xb],At=Fr.m,ts=Fr;for(yr=0;yr<ts.za;++yr){var Ar=At,Mr=ts,Bn=Mr.Ac,si=Mr.Bc+4*yr,Di=Mr.zc,jn=Mr.ya[Mr.aa+yr];if(Mr.Qa.Bb?jn.$b=ve(Ar,Mr.Pa.jb[0])?2+ve(Ar,Mr.Pa.jb[2]):ve(Ar,Mr.Pa.jb[1]):jn.$b=0,Mr.kc&&(jn.Ad=ve(Ar,Mr.Bd)),jn.Za=!ve(Ar,145)+0,jn.Za){var pi=jn.Ob,Ri=0;for(Mr=0;4>Mr;++Mr){var Ts,Rr=Di[0+Mr];for(Ts=0;4>Ts;++Ts){Rr=YN[Bn[si+Ts]][Rr];for(var en=U_[ve(Ar,Rr[0])];0<en;)en=U_[2*en+ve(Ar,Rr[en])];Rr=-en,Bn[si+Ts]=Rr}n(pi,Ri,Bn,si,4),Ri+=4,Di[0+Mr]=Rr}}else Rr=ve(Ar,156)?ve(Ar,128)?1:3:ve(Ar,163)?2:0,jn.Ob[0]=Rr,s(Bn,si,Rr,4),s(Di,0,Rr,4);jn.Dd=ve(Ar,142)?ve(Ar,114)?ve(Ar,183)?1:3:2:0}if(ts.m.Ka)return Cr(Fr,7,"Premature end-of-partition0 encountered.");for(;Fr.ja<Fr.za;++Fr.ja){if(ts=Tt,Ar=(At=Fr).rb[At.sb-1],Bn=At.rb[At.sb+At.ja],yr=At.ya[At.aa+At.ja],si=At.kc?yr.Ad:0)Ar.la=Bn.la=0,yr.Za||(Ar.Na=Bn.Na=0),yr.Hc=0,yr.Gc=0,yr.ia=0;else{var Vn,tn;if(Ar=Bn,Bn=ts,si=At.Pa.Xc,Di=At.ya[At.aa+At.ja],jn=At.pb[Di.$b],Mr=Di.ad,pi=0,Ri=At.rb[At.sb-1],Rr=Ts=0,s(Mr,pi,0,384),Di.Za)var ii=0,ao=si[3];else{en=i(16);var rs=Ar.Na+Ri.Na;if(rs=Vh(Bn,si[1],rs,jn.Eb,0,en,0),Ar.Na=Ri.Na=(0<rs)+0,1<rs)Sc(en,0,Mr,pi);else{var Zi=en[0]+3>>3;for(en=0;256>en;en+=16)Mr[pi+en]=Zi}ii=1,ao=si[0]}var dn=15&Ar.la,Fs=15&Ri.la;for(en=0;4>en;++en){var ya=1&Fs;for(Zi=tn=0;4>Zi;++Zi)dn=dn>>1|(ya=(rs=Vh(Bn,ao,rs=ya+(1&dn),jn.Sc,ii,Mr,pi))>ii)<<7,tn=tn<<2|(3<rs?3:1<rs?2:Mr[pi+0]!=0),pi+=16;dn>>=4,Fs=Fs>>1|ya<<7,Ts=(Ts<<8|tn)>>>0}for(ao=dn,ii=Fs>>4,Vn=0;4>Vn;Vn+=2){for(tn=0,dn=Ar.la>>4+Vn,Fs=Ri.la>>4+Vn,en=0;2>en;++en){for(ya=1&Fs,Zi=0;2>Zi;++Zi)rs=ya+(1&dn),dn=dn>>1|(ya=0<(rs=Vh(Bn,si[2],rs,jn.Qc,0,Mr,pi)))<<3,tn=tn<<2|(3<rs?3:1<rs?2:Mr[pi+0]!=0),pi+=16;dn>>=2,Fs=Fs>>1|ya<<5}Rr|=tn<<4*Vn,ao|=dn<<4<<Vn,ii|=(240&Fs)<<Vn}Ar.la=ao,Ri.la=ii,Di.Hc=Ts,Di.Gc=Rr,Di.ia=43690&Rr?0:jn.ia,si=!(Ts|Rr)}if(0<At.L&&(At.wa[At.Y+At.ja]=At.gd[yr.$b][yr.Za],At.wa[At.Y+At.ja].La|=!si),ts.Ka)return Cr(Fr,7,"Premature end-of-file encountered.")}if(_r(Fr),At=Is,ts=1,yr=(Tt=Fr).D,Ar=0<Tt.L&&Tt.M>=Tt.zb&&Tt.M<=Tt.Va,Tt.Aa==0)t:{if(yr.M=Tt.M,yr.uc=Ar,Oa(Tt,yr),ts=1,yr=(tn=Tt.D).Nb,Ar=(Rr=Sp[Tt.L])*Tt.R,Bn=Rr/2*Tt.B,en=16*yr*Tt.R,Zi=8*yr*Tt.B,si=Tt.sa,Di=Tt.ta-Ar+en,jn=Tt.qa,Mr=Tt.ra-Bn+Zi,pi=Tt.Ha,Ri=Tt.Ia-Bn+Zi,Fs=(dn=tn.M)==0,Ts=dn>=Tt.Va-1,Tt.Aa==2&&Oa(Tt,tn),tn.uc)for(ya=(rs=Tt).D.M,e(rs.D.uc),tn=rs.yb;tn<rs.Hb;++tn){ii=tn,ao=ya;var Oi=(wa=(ai=rs).D).Nb;Vn=ai.R;var wa=wa.wa[wa.Y+ii],va=ai.sa,ea=ai.ta+16*Oi*Vn+16*ii,xa=wa.dd,mn=wa.tc;if(mn!=0)if(e(3<=mn),ai.L==1)0<ii&&y_(va,ea,Vn,mn+4),wa.La&&v_(va,ea,Vn,mn),0<ao&&b_(va,ea,Vn,mn+4),wa.La&&w_(va,ea,Vn,mn);else{var _a=ai.B,oo=ai.qa,WA=ai.ra+8*Oi*_a+8*ii,kl=ai.Ha,ai=ai.Ia+8*Oi*_a+8*ii;Oi=wa.ld,0<ii&&(Es(va,ea,Vn,mn+4,xa,Oi),Hh(oo,WA,kl,ai,_a,mn+4,xa,Oi)),wa.La&&(mp(va,ea,Vn,mn,xa,Oi),m_(oo,WA,kl,ai,_a,mn,xa,Oi)),0<ao&&(es(va,ea,Vn,mn+4,xa,Oi),Cl(oo,WA,kl,ai,_a,mn+4,xa,Oi)),wa.La&&(lu(va,ea,Vn,mn,xa,Oi),p_(oo,WA,kl,ai,_a,mn,xa,Oi))}}if(Tt.ia&&alert("todo:DitherRow"),At.put!=null){if(tn=16*dn,dn=16*(dn+1),Fs?(At.y=Tt.sa,At.O=Tt.ta+en,At.f=Tt.qa,At.N=Tt.ra+Zi,At.ea=Tt.Ha,At.W=Tt.Ia+Zi):(tn-=Rr,At.y=si,At.O=Di,At.f=jn,At.N=Mr,At.ea=pi,At.W=Ri),Ts||(dn-=Rr),dn>At.o&&(dn=At.o),At.F=null,At.J=null,Tt.Fa!=null&&0<Tt.Fa.length&&tn<dn&&(At.J=ln(Tt,At,tn,dn-tn),At.F=Tt.mb,At.F==null&&At.F.length==0)){ts=Cr(Tt,3,"Could not decode alpha data.");break t}tn<At.j&&(Rr=At.j-tn,tn=At.j,e(!(1&Rr)),At.O+=Tt.R*Rr,At.N+=Tt.B*(Rr>>1),At.W+=Tt.B*(Rr>>1),At.F!=null&&(At.J+=At.width*Rr)),tn<dn&&(At.O+=At.v,At.N+=At.v>>1,At.W+=At.v>>1,At.F!=null&&(At.J+=At.v),At.ka=tn-At.j,At.U=At.va-At.v,At.T=dn-tn,ts=At.put(At))}yr+1!=Tt.Ic||Ts||(n(Tt.sa,Tt.ta-Ar,si,Di+16*Tt.R,Ar),n(Tt.qa,Tt.ra-Bn,jn,Mr+8*Tt.B,Bn),n(Tt.Ha,Tt.Ia-Bn,pi,Ri+8*Tt.B,Bn))}if(!ts)return Cr(Fr,6,"Output aborted.")}return 1})(me,ke)),ke.bc!=null&&ke.bc(ke),Me&=1}return Me?(me.cb=0,Me):0})(b,Q)||(C=b.a)}}else C=b.a}C==0&&ne.Oa!=null&&ne.Oa.fd&&(C=Nh(ne.ba))}ne=C}te=ne!=0?null:11>te?ae.f.RGBA.eb:ae.f.kb.y}else te=null;return te};var H_=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function c(v,I){for(var k="",_=0;_<4;_++)k+=String.fromCharCode(v[I++]);return k}function A(v,I){return v[I+0]|v[I+1]<<8}function d(v,I){return(v[I+0]|v[I+1]<<8|v[I+2]<<16)>>>0}function h(v,I){return(v[I+0]|v[I+1]<<8|v[I+2]<<16|v[I+3]<<24)>>>0}new l;var u=[0],p=[0],f=[],g=new l,m=r,x=(function(v,I){var k={},_=0,T=!1,L=0,K=0;if(k.frames=[],!(function(M,O){for(var H=0;H<4;H++)if(M[O+H]!="RIFF".charCodeAt(H))return!0;return!1})(v,I)){for(h(v,I+=4),I+=8;I<v.length;){var se=c(v,I),X=h(v,I+=4);I+=4;var $=X+(1&X);switch(se){case"VP8 ":case"VP8L":k.frames[_]===void 0&&(k.frames[_]={}),(z=k.frames[_]).src_off=T?K:I-8,z.src_size=L+X+8,_++,T&&(T=!1,L=0,K=0);break;case"VP8X":(z=k.header={}).feature_flags=v[I];var V=I+4;z.canvas_width=1+d(v,V),V+=3,z.canvas_height=1+d(v,V),V+=3;break;case"ALPH":T=!0,L=$+8,K=I-8;break;case"ANIM":(z=k.header).bgcolor=h(v,I),V=I+4,z.loop_count=A(v,V),V+=2;break;case"ANMF":var he,z;(z=k.frames[_]={}).offset_x=2*d(v,I),I+=3,z.offset_y=2*d(v,I),I+=3,z.width=1+d(v,I),I+=3,z.height=1+d(v,I),I+=3,z.duration=d(v,I),I+=3,he=v[I++],z.dispose=1&he,z.blend=he>>1&1}se!="ANMF"&&(I+=$)}return k}})(m,0);x.response=m,x.rgbaoutput=!0,x.dataurl=!1;var S=x.header?x.header:null,B=x.frames?x.frames:null;if(S){S.loop_counter=S.loop_count,u=[S.canvas_height],p=[S.canvas_width];for(var F=0;F<B.length&&B[F].blend!=0;F++);}var N=B[0],E=g.WebPDecodeRGBA(m,N.src_off,N.src_size,p,u);N.rgba=E,N.imgwidth=p[0],N.imgheight=u[0];for(var w=0;w<p[0]*u[0]*4;w++)f[w]=E[w];return this.width=p,this.height=u,this.data=f,this}(function(r){var e,t,n,s,i,a,o,l,c,A=function(M){return M=M||{},this.isStrokeTransparent=M.isStrokeTransparent||!1,this.strokeOpacity=M.strokeOpacity||1,this.strokeStyle=M.strokeStyle||"#000000",this.fillStyle=M.fillStyle||"#000000",this.isFillTransparent=M.isFillTransparent||!1,this.fillOpacity=M.fillOpacity||1,this.font=M.font||"10px sans-serif",this.textBaseline=M.textBaseline||"alphabetic",this.textAlign=M.textAlign||"left",this.lineWidth=M.lineWidth||1,this.lineJoin=M.lineJoin||"miter",this.lineCap=M.lineCap||"butt",this.path=M.path||[],this.transform=M.transform!==void 0?M.transform.clone():new l,this.globalCompositeOperation=M.globalCompositeOperation||"normal",this.globalAlpha=M.globalAlpha||1,this.clip_path=M.clip_path||[],this.currentPoint=M.currentPoint||new a,this.miterLimit=M.miterLimit||10,this.lastPoint=M.lastPoint||new a,this.lineDashOffset=M.lineDashOffset||0,this.lineDash=M.lineDash||[],this.margin=M.margin||[0,0,0,0],this.prevPageLastElemOffset=M.prevPageLastElemOffset||0,this.ignoreClearRect=typeof M.ignoreClearRect!="boolean"||M.ignoreClearRect,this};r.events.push(["initialized",function(){this.context2d=new d(this),e=this.internal.f2,t=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,s=this.internal.getHorizontalCoordinate,i=this.internal.getVerticalCoordinate,a=this.internal.Point,o=this.internal.Rectangle,l=this.internal.Matrix,c=new A}]);var d=function(M){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var O=M;Object.defineProperty(this,"pdf",{get:function(){return O}});var H=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return H},set:function(D){H=!!D}});var J=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return J},set:function(D){J=!!D}});var de=0;Object.defineProperty(this,"posX",{get:function(){return de},set:function(D){isNaN(D)||(de=D)}});var ie=0;Object.defineProperty(this,"posY",{get:function(){return ie},set:function(D){isNaN(D)||(ie=D)}}),Object.defineProperty(this,"margin",{get:function(){return c.margin},set:function(D){var G;typeof D=="number"?G=[D,D,D,D]:((G=new Array(4))[0]=D[0],G[1]=D.length>=2?D[1]:G[0],G[2]=D.length>=3?D[2]:G[0],G[3]=D.length>=4?D[3]:G[1]),c.margin=G}});var le=!1;Object.defineProperty(this,"autoPaging",{get:function(){return le},set:function(D){le=D}});var fe=0;Object.defineProperty(this,"lastBreak",{get:function(){return fe},set:function(D){fe=D}});var ve=[];Object.defineProperty(this,"pageBreaks",{get:function(){return ve},set:function(D){ve=D}}),Object.defineProperty(this,"ctx",{get:function(){return c},set:function(D){D instanceof A&&(c=D)}}),Object.defineProperty(this,"path",{get:function(){return c.path},set:function(D){c.path=D}});var Ce=[];Object.defineProperty(this,"ctxStack",{get:function(){return Ce},set:function(D){Ce=D}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(D){var G;G=h(D),this.ctx.fillStyle=G.style,this.ctx.isFillTransparent=G.a===0,this.ctx.fillOpacity=G.a,this.pdf.setFillColor(G.r,G.g,G.b,{a:G.a}),this.pdf.setTextColor(G.r,G.g,G.b,{a:G.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(D){var G=h(D);this.ctx.strokeStyle=G.style,this.ctx.isStrokeTransparent=G.a===0,this.ctx.strokeOpacity=G.a,G.a===0?this.pdf.setDrawColor(255,255,255):(G.a,this.pdf.setDrawColor(G.r,G.g,G.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(D){["butt","round","square"].indexOf(D)!==-1&&(this.ctx.lineCap=D,this.pdf.setLineCap(D))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(D){isNaN(D)||(this.ctx.lineWidth=D,this.pdf.setLineWidth(D))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(D){["bevel","round","miter"].indexOf(D)!==-1&&(this.ctx.lineJoin=D,this.pdf.setLineJoin(D))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(D){isNaN(D)||(this.ctx.miterLimit=D,this.pdf.setMiterLimit(D))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(D){this.ctx.textBaseline=D}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(D){["right","end","center","left","start"].indexOf(D)!==-1&&(this.ctx.textAlign=D)}});var Be=null,Qe=null;Object.defineProperty(this,"fontFaces",{get:function(){return Qe},set:function(D){Be=null,Qe=D}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(D){var G;if(this.ctx.font=D,(G=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(D))!==null){var ce=G[1];G[2];var Z=G[3],W=G[4];G[5];var ee=G[6],ye=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(W)[2];W=Math.floor(ye==="px"?parseFloat(W)*this.pdf.internal.scaleFactor:ye==="em"?parseFloat(W)*this.pdf.getFontSize():parseFloat(W)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(W);var xe=(function(wt){var it,lt,tt=[],rt=wt.trim();if(rt==="")return Gw;if(rt in OS)return[OS[rt]];for(;rt!=="";){switch(lt=null,it=(rt=HS(rt)).charAt(0)){case'"':case"'":lt=wW(rt.substring(1),it);break;default:lt=vW(rt)}if(lt===null||(tt.push(lt[0]),(rt=HS(lt[1]))!==""&&rt.charAt(0)!==","))return Gw;rt=rt.replace(/^,/,"")}return tt})(ee);if(this.fontFaces){var we=(function(wt,it){if(Be===null){var lt=(function(tt){var rt=[];return Object.keys(tt).forEach(function(ft){tt[ft].forEach(function(St){var yt=null;switch(St){case"bold":yt={family:ft,weight:"bold"};break;case"italic":yt={family:ft,style:"italic"};break;case"bolditalic":yt={family:ft,weight:"bold",style:"italic"};break;case"":case"normal":yt={family:ft}}yt!==null&&(yt.ref={name:ft,style:St},rt.push(yt))})}),rt})(wt.getFontList());Be=(function(tt){for(var rt={},ft=0;ft<tt.length;++ft){var St=$w(tt[ft]),yt=St.family,jt=St.stretch,Rt=St.style,wr=St.weight;rt[yt]=rt[yt]||{},rt[yt][jt]=rt[yt][jt]||{},rt[yt][jt][Rt]=rt[yt][jt][Rt]||{},rt[yt][jt][Rt][wr]=St}return rt})(lt.concat(it))}return Be})(this.pdf,this.fontFaces),Ee=xe.map(function(wt){return{family:wt,stretch:"normal",weight:Z,style:ce}}),Ne=(function(wt,it,lt){for(var tt=(lt=lt||{}).defaultFontFamily||"times",rt=Object.assign({},yW,lt.genericFontFamilies||{}),ft=null,St=null,yt=0;yt<it.length;++yt)if(rt[(ft=$w(it[yt])).family]&&(ft.family=rt[ft.family]),wt.hasOwnProperty(ft.family)){St=wt[ft.family];break}if(!(St=St||wt[tt]))throw new Error("Could not find a font-family for the rule '"+QS(ft)+"' and default family '"+tt+"'.");if(St=(function(jt,Rt){if(Rt[jt])return Rt[jt];var wr=k1[jt],Qr=wr<=k1.normal?-1:1,Lt=RS(Rt,$F,wr,Qr);if(!Lt)throw new Error("Could not find a matching font-stretch value for "+jt);return Lt})(ft.stretch,St),St=(function(jt,Rt){if(Rt[jt])return Rt[jt];for(var wr=VF[jt],Qr=0;Qr<wr.length;++Qr)if(Rt[wr[Qr]])return Rt[wr[Qr]];throw new Error("Could not find a matching font-style for "+jt)})(ft.style,St),!(St=(function(jt,Rt){if(Rt[jt])return Rt[jt];if(jt===400&&Rt[500])return Rt[500];if(jt===500&&Rt[400])return Rt[400];var wr=bW[jt],Qr=RS(Rt,GF,wr,jt<400?-1:1);if(!Qr)throw new Error("Could not find a matching font-weight for value "+jt);return Qr})(ft.weight,St)))throw new Error("Failed to resolve a font for the rule '"+QS(ft)+"'.");return St})(we,Ee);this.pdf.setFont(Ne.ref.name,Ne.ref.style)}else{var Ue="";(Z==="bold"||parseInt(Z,10)>=700||ce==="bold")&&(Ue="bold"),ce==="italic"&&(Ue+="italic"),Ue.length===0&&(Ue="normal");for(var je="",st={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Ze=0;Ze<xe.length;Ze++){if(this.pdf.internal.getFont(xe[Ze],Ue,{noFallback:!0,disableWarning:!0})!==void 0){je=xe[Ze];break}if(Ue==="bolditalic"&&this.pdf.internal.getFont(xe[Ze],"bold",{noFallback:!0,disableWarning:!0})!==void 0)je=xe[Ze],Ue="bold";else if(this.pdf.internal.getFont(xe[Ze],"normal",{noFallback:!0,disableWarning:!0})!==void 0){je=xe[Ze],Ue="normal";break}}if(je===""){for(var ct=0;ct<xe.length;ct++)if(st[xe[ct]]){je=st[xe[ct]];break}}je=je===""?"Times":je,this.pdf.setFont(je,Ue)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(D){this.ctx.globalCompositeOperation=D}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(D){this.ctx.globalAlpha=D}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(D){this.ctx.lineDashOffset=D,z.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(D){this.ctx.lineDash=D,z.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(D){this.ctx.ignoreClearRect=!!D}})};d.prototype.setLineDash=function(M){this.lineDash=M},d.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},d.prototype.fill=function(){B.call(this,"fill",!1)},d.prototype.stroke=function(){B.call(this,"stroke",!1)},d.prototype.beginPath=function(){this.path=[{type:"begin"}]},d.prototype.moveTo=function(M,O){if(isNaN(M)||isNaN(O))throw un.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var H=this.ctx.transform.applyToPoint(new a(M,O));this.path.push({type:"mt",x:H.x,y:H.y}),this.ctx.lastPoint=new a(M,O)},d.prototype.closePath=function(){var M=new a(0,0),O=0;for(O=this.path.length-1;O!==-1;O--)if(this.path[O].type==="begin"&&nn(this.path[O+1])==="object"&&typeof this.path[O+1].x=="number"){M=new a(this.path[O+1].x,this.path[O+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new a(M.x,M.y)},d.prototype.lineTo=function(M,O){if(isNaN(M)||isNaN(O))throw un.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var H=this.ctx.transform.applyToPoint(new a(M,O));this.path.push({type:"lt",x:H.x,y:H.y}),this.ctx.lastPoint=new a(H.x,H.y)},d.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),B.call(this,null,!0)},d.prototype.quadraticCurveTo=function(M,O,H,J){if(isNaN(H)||isNaN(J)||isNaN(M)||isNaN(O))throw un.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var de=this.ctx.transform.applyToPoint(new a(H,J)),ie=this.ctx.transform.applyToPoint(new a(M,O));this.path.push({type:"qct",x1:ie.x,y1:ie.y,x:de.x,y:de.y}),this.ctx.lastPoint=new a(de.x,de.y)},d.prototype.bezierCurveTo=function(M,O,H,J,de,ie){if(isNaN(de)||isNaN(ie)||isNaN(M)||isNaN(O)||isNaN(H)||isNaN(J))throw un.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var le=this.ctx.transform.applyToPoint(new a(de,ie)),fe=this.ctx.transform.applyToPoint(new a(M,O)),ve=this.ctx.transform.applyToPoint(new a(H,J));this.path.push({type:"bct",x1:fe.x,y1:fe.y,x2:ve.x,y2:ve.y,x:le.x,y:le.y}),this.ctx.lastPoint=new a(le.x,le.y)},d.prototype.arc=function(M,O,H,J,de,ie){if(isNaN(M)||isNaN(O)||isNaN(H)||isNaN(J)||isNaN(de))throw un.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(ie=!!ie,!this.ctx.transform.isIdentity){var le=this.ctx.transform.applyToPoint(new a(M,O));M=le.x,O=le.y;var fe=this.ctx.transform.applyToPoint(new a(0,H)),ve=this.ctx.transform.applyToPoint(new a(0,0));H=Math.sqrt(Math.pow(fe.x-ve.x,2)+Math.pow(fe.y-ve.y,2))}Math.abs(de-J)>=2*Math.PI&&(J=0,de=2*Math.PI),this.path.push({type:"arc",x:M,y:O,radius:H,startAngle:J,endAngle:de,counterclockwise:ie})},d.prototype.arcTo=function(M,O,H,J,de){throw new Error("arcTo not implemented.")},d.prototype.rect=function(M,O,H,J){if(isNaN(M)||isNaN(O)||isNaN(H)||isNaN(J))throw un.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(M,O),this.lineTo(M+H,O),this.lineTo(M+H,O+J),this.lineTo(M,O+J),this.lineTo(M,O),this.lineTo(M+H,O),this.lineTo(M,O)},d.prototype.fillRect=function(M,O,H,J){if(isNaN(M)||isNaN(O)||isNaN(H)||isNaN(J))throw un.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!u.call(this)){var de={};this.lineCap!=="butt"&&(de.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(de.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(M,O,H,J),this.fill(),de.hasOwnProperty("lineCap")&&(this.lineCap=de.lineCap),de.hasOwnProperty("lineJoin")&&(this.lineJoin=de.lineJoin)}},d.prototype.strokeRect=function(M,O,H,J){if(isNaN(M)||isNaN(O)||isNaN(H)||isNaN(J))throw un.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");p.call(this)||(this.beginPath(),this.rect(M,O,H,J),this.stroke())},d.prototype.clearRect=function(M,O,H,J){if(isNaN(M)||isNaN(O)||isNaN(H)||isNaN(J))throw un.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(M,O,H,J))},d.prototype.save=function(M){M=typeof M!="boolean"||M;for(var O=this.pdf.internal.getCurrentPageInfo().pageNumber,H=0;H<this.pdf.internal.getNumberOfPages();H++)this.pdf.setPage(H+1),this.pdf.internal.out("q");if(this.pdf.setPage(O),M){this.ctx.fontSize=this.pdf.internal.getFontSize();var J=new A(this.ctx);this.ctxStack.push(this.ctx),this.ctx=J}},d.prototype.restore=function(M){M=typeof M!="boolean"||M;for(var O=this.pdf.internal.getCurrentPageInfo().pageNumber,H=0;H<this.pdf.internal.getNumberOfPages();H++)this.pdf.setPage(H+1),this.pdf.internal.out("Q");this.pdf.setPage(O),M&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},d.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var h=function(M){var O,H,J,de;if(M.isCanvasGradient===!0&&(M=M.getColor()),!M)return{r:0,g:0,b:0,a:0,style:M};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(M))O=0,H=0,J=0,de=0;else{var ie=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(M);if(ie!==null)O=parseInt(ie[1]),H=parseInt(ie[2]),J=parseInt(ie[3]),de=1;else if((ie=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(M))!==null)O=parseInt(ie[1]),H=parseInt(ie[2]),J=parseInt(ie[3]),de=parseFloat(ie[4]);else{if(de=1,typeof M=="string"&&M.charAt(0)!=="#"){var le=new PF(M);M=le.ok?le.toHex():"#000000"}M.length===4?(O=M.substring(1,2),O+=O,H=M.substring(2,3),H+=H,J=M.substring(3,4),J+=J):(O=M.substring(1,3),H=M.substring(3,5),J=M.substring(5,7)),O=parseInt(O,16),H=parseInt(H,16),J=parseInt(J,16)}}return{r:O,g:H,b:J,a:de,style:M}},u=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},p=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};d.prototype.fillText=function(M,O,H,J){if(isNaN(O)||isNaN(H)||typeof M!="string")throw un.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(J=isNaN(J)?void 0:J,!u.call(this)){var de=$(this.ctx.transform.rotation),ie=this.ctx.transform.scaleX;_.call(this,{text:M,x:O,y:H,scale:ie,angle:de,align:this.textAlign,maxWidth:J})}},d.prototype.strokeText=function(M,O,H,J){if(isNaN(O)||isNaN(H)||typeof M!="string")throw un.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!p.call(this)){J=isNaN(J)?void 0:J;var de=$(this.ctx.transform.rotation),ie=this.ctx.transform.scaleX;_.call(this,{text:M,x:O,y:H,scale:ie,renderingMode:"stroke",angle:de,align:this.textAlign,maxWidth:J})}},d.prototype.measureText=function(M){if(typeof M!="string")throw un.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var O=this.pdf,H=this.pdf.internal.scaleFactor,J=O.internal.getFontSize(),de=O.getStringUnitWidth(M)*J/O.internal.scaleFactor;return new function(ie){var le=(ie=ie||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return le}}),this}({width:de*=Math.round(96*H/72*1e4)/1e4})},d.prototype.scale=function(M,O){if(isNaN(M)||isNaN(O))throw un.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var H=new l(M,0,0,O,0,0);this.ctx.transform=this.ctx.transform.multiply(H)},d.prototype.rotate=function(M){if(isNaN(M))throw un.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var O=new l(Math.cos(M),Math.sin(M),-Math.sin(M),Math.cos(M),0,0);this.ctx.transform=this.ctx.transform.multiply(O)},d.prototype.translate=function(M,O){if(isNaN(M)||isNaN(O))throw un.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var H=new l(1,0,0,1,M,O);this.ctx.transform=this.ctx.transform.multiply(H)},d.prototype.transform=function(M,O,H,J,de,ie){if(isNaN(M)||isNaN(O)||isNaN(H)||isNaN(J)||isNaN(de)||isNaN(ie))throw un.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var le=new l(M,O,H,J,de,ie);this.ctx.transform=this.ctx.transform.multiply(le)},d.prototype.setTransform=function(M,O,H,J,de,ie){M=isNaN(M)?1:M,O=isNaN(O)?0:O,H=isNaN(H)?0:H,J=isNaN(J)?1:J,de=isNaN(de)?0:de,ie=isNaN(ie)?0:ie,this.ctx.transform=new l(M,O,H,J,de,ie)};var f=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};d.prototype.drawImage=function(M,O,H,J,de,ie,le,fe,ve){var Ce=this.pdf.getImageProperties(M),Be=1,Qe=1,D=1,G=1;J!==void 0&&fe!==void 0&&(D=fe/J,G=ve/de,Be=Ce.width/J*fe/J,Qe=Ce.height/de*ve/de),ie===void 0&&(ie=O,le=H,O=0,H=0),J!==void 0&&fe===void 0&&(fe=J,ve=de),J===void 0&&fe===void 0&&(fe=Ce.width,ve=Ce.height);for(var ce,Z=this.ctx.transform.decompose(),W=$(Z.rotate.shx),ee=new l,ye=(ee=(ee=(ee=ee.multiply(Z.translate)).multiply(Z.skew)).multiply(Z.scale)).applyToRectangle(new o(ie-O*D,le-H*G,J*Be,de*Qe)),xe=g.call(this,ye),we=[],Ee=0;Ee<xe.length;Ee+=1)we.indexOf(xe[Ee])===-1&&we.push(xe[Ee]);if(S(we),this.autoPaging)for(var Ne=we[0],Ue=we[we.length-1],je=Ne;je<Ue+1;je++){this.pdf.setPage(je);var st=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Ze=je===1?this.posY+this.margin[0]:this.margin[0],ct=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],wt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],it=je===1?0:ct+(je-2)*wt;if(this.ctx.clip_path.length!==0){var lt=this.path;ce=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=x(ce,this.posX+this.margin[3],-it+Ze+this.ctx.prevPageLastElemOffset),F.call(this,"fill",!0),this.path=lt}var tt=JSON.parse(JSON.stringify(ye));tt=x([tt],this.posX+this.margin[3],-it+Ze+this.ctx.prevPageLastElemOffset)[0];var rt=(je>Ne||je<Ue)&&f.call(this);rt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],st,wt,null).clip().discardPath()),this.pdf.addImage(M,"JPEG",tt.x,tt.y,tt.w,tt.h,null,null,W),rt&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(M,"JPEG",ye.x,ye.y,ye.w,ye.h,null,null,W)};var g=function(M,O,H){var J=[];O=O||this.pdf.internal.pageSize.width,H=H||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var de=this.posY+this.ctx.prevPageLastElemOffset;switch(M.type){default:case"mt":case"lt":J.push(Math.floor((M.y+de)/H)+1);break;case"arc":J.push(Math.floor((M.y+de-M.radius)/H)+1),J.push(Math.floor((M.y+de+M.radius)/H)+1);break;case"qct":var ie=V(this.ctx.lastPoint.x,this.ctx.lastPoint.y,M.x1,M.y1,M.x,M.y);J.push(Math.floor((ie.y+de)/H)+1),J.push(Math.floor((ie.y+ie.h+de)/H)+1);break;case"bct":var le=he(this.ctx.lastPoint.x,this.ctx.lastPoint.y,M.x1,M.y1,M.x2,M.y2,M.x,M.y);J.push(Math.floor((le.y+de)/H)+1),J.push(Math.floor((le.y+le.h+de)/H)+1);break;case"rect":J.push(Math.floor((M.y+de)/H)+1),J.push(Math.floor((M.y+M.h+de)/H)+1)}for(var fe=0;fe<J.length;fe+=1)for(;this.pdf.internal.getNumberOfPages()<J[fe];)m.call(this);return J},m=function(){var M=this.fillStyle,O=this.strokeStyle,H=this.font,J=this.lineCap,de=this.lineWidth,ie=this.lineJoin;this.pdf.addPage(),this.fillStyle=M,this.strokeStyle=O,this.font=H,this.lineCap=J,this.lineWidth=de,this.lineJoin=ie},x=function(M,O,H){for(var J=0;J<M.length;J++)switch(M[J].type){case"bct":M[J].x2+=O,M[J].y2+=H;case"qct":M[J].x1+=O,M[J].y1+=H;default:M[J].x+=O,M[J].y+=H}return M},S=function(M){return M.sort(function(O,H){return O-H})},B=function(M,O){for(var H,J,de=this.fillStyle,ie=this.strokeStyle,le=this.lineCap,fe=this.lineWidth,ve=Math.abs(fe*this.ctx.transform.scaleX),Ce=this.lineJoin,Be=JSON.parse(JSON.stringify(this.path)),Qe=JSON.parse(JSON.stringify(this.path)),D=[],G=0;G<Qe.length;G++)if(Qe[G].x!==void 0)for(var ce=g.call(this,Qe[G]),Z=0;Z<ce.length;Z+=1)D.indexOf(ce[Z])===-1&&D.push(ce[Z]);for(var W=0;W<D.length;W++)for(;this.pdf.internal.getNumberOfPages()<D[W];)m.call(this);if(S(D),this.autoPaging)for(var ee=D[0],ye=D[D.length-1],xe=ee;xe<ye+1;xe++){this.pdf.setPage(xe),this.fillStyle=de,this.strokeStyle=ie,this.lineCap=le,this.lineWidth=ve,this.lineJoin=Ce;var we=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Ee=xe===1?this.posY+this.margin[0]:this.margin[0],Ne=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ue=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],je=xe===1?0:Ne+(xe-2)*Ue;if(this.ctx.clip_path.length!==0){var st=this.path;H=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=x(H,this.posX+this.margin[3],-je+Ee+this.ctx.prevPageLastElemOffset),F.call(this,M,!0),this.path=st}if(J=JSON.parse(JSON.stringify(Be)),this.path=x(J,this.posX+this.margin[3],-je+Ee+this.ctx.prevPageLastElemOffset),O===!1||xe===0){var Ze=(xe>ee||xe<ye)&&f.call(this);Ze&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],we,Ue,null).clip().discardPath()),F.call(this,M,O),Ze&&this.pdf.restoreGraphicsState()}this.lineWidth=fe}else this.lineWidth=ve,F.call(this,M,O),this.lineWidth=fe;this.path=Be},F=function(M,O){if((M!=="stroke"||O||!p.call(this))&&(M==="stroke"||O||!u.call(this))){for(var H,J,de=[],ie=this.path,le=0;le<ie.length;le++){var fe=ie[le];switch(fe.type){case"begin":de.push({begin:!0});break;case"close":de.push({close:!0});break;case"mt":de.push({start:fe,deltas:[],abs:[]});break;case"lt":var ve=de.length;if(ie[le-1]&&!isNaN(ie[le-1].x)&&(H=[fe.x-ie[le-1].x,fe.y-ie[le-1].y],ve>0)){for(;ve>=0;ve--)if(de[ve-1].close!==!0&&de[ve-1].begin!==!0){de[ve-1].deltas.push(H),de[ve-1].abs.push(fe);break}}break;case"bct":H=[fe.x1-ie[le-1].x,fe.y1-ie[le-1].y,fe.x2-ie[le-1].x,fe.y2-ie[le-1].y,fe.x-ie[le-1].x,fe.y-ie[le-1].y],de[de.length-1].deltas.push(H);break;case"qct":var Ce=ie[le-1].x+2/3*(fe.x1-ie[le-1].x),Be=ie[le-1].y+2/3*(fe.y1-ie[le-1].y),Qe=fe.x+2/3*(fe.x1-fe.x),D=fe.y+2/3*(fe.y1-fe.y),G=fe.x,ce=fe.y;H=[Ce-ie[le-1].x,Be-ie[le-1].y,Qe-ie[le-1].x,D-ie[le-1].y,G-ie[le-1].x,ce-ie[le-1].y],de[de.length-1].deltas.push(H);break;case"arc":de.push({deltas:[],abs:[],arc:!0}),Array.isArray(de[de.length-1].abs)&&de[de.length-1].abs.push(fe)}}J=O?null:M==="stroke"?"stroke":"fill";for(var Z=!1,W=0;W<de.length;W++)if(de[W].arc)for(var ee=de[W].abs,ye=0;ye<ee.length;ye++){var xe=ee[ye];xe.type==="arc"?w.call(this,xe.x,xe.y,xe.radius,xe.startAngle,xe.endAngle,xe.counterclockwise,void 0,O,!Z):T.call(this,xe.x,xe.y),Z=!0}else if(de[W].close===!0)this.pdf.internal.out("h"),Z=!1;else if(de[W].begin!==!0){var we=de[W].start.x,Ee=de[W].start.y;L.call(this,de[W].deltas,we,Ee),Z=!0}J&&v.call(this,J),O&&I.call(this)}},N=function(M){var O=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,H=O*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return M-H;case"top":return M+O-H;case"hanging":return M+O-2*H;case"middle":return M+O/2-H;default:return M}},E=function(M){return M+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};d.prototype.createLinearGradient=function(){var M=function(){};return M.colorStops=[],M.addColorStop=function(O,H){this.colorStops.push([O,H])},M.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},M.isCanvasGradient=!0,M},d.prototype.createPattern=function(){return this.createLinearGradient()},d.prototype.createRadialGradient=function(){return this.createLinearGradient()};var w=function(M,O,H,J,de,ie,le,fe,ve){for(var Ce=se.call(this,H,J,de,ie),Be=0;Be<Ce.length;Be++){var Qe=Ce[Be];Be===0&&(ve?k.call(this,Qe.x1+M,Qe.y1+O):T.call(this,Qe.x1+M,Qe.y1+O)),K.call(this,M,O,Qe.x2,Qe.y2,Qe.x3,Qe.y3,Qe.x4,Qe.y4)}fe?I.call(this):v.call(this,le)},v=function(M){switch(M){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},I=function(){this.pdf.clip(),this.pdf.discardPath()},k=function(M,O){this.pdf.internal.out(t(M)+" "+n(O)+" m")},_=function(M){var O;switch(M.align){case"right":case"end":O="right";break;case"center":O="center";break;default:O="left"}var H=this.pdf.getTextDimensions(M.text),J=N.call(this,M.y),de=E.call(this,J)-H.h,ie=this.ctx.transform.applyToPoint(new a(M.x,J)),le=this.ctx.transform.decompose(),fe=new l;fe=(fe=(fe=fe.multiply(le.translate)).multiply(le.skew)).multiply(le.scale);for(var ve,Ce,Be,Qe=this.ctx.transform.applyToRectangle(new o(M.x,J,H.w,H.h)),D=fe.applyToRectangle(new o(M.x,de,H.w,H.h)),G=g.call(this,D),ce=[],Z=0;Z<G.length;Z+=1)ce.indexOf(G[Z])===-1&&ce.push(G[Z]);if(S(ce),this.autoPaging)for(var W=ce[0],ee=ce[ce.length-1],ye=W;ye<ee+1;ye++){this.pdf.setPage(ye);var xe=ye===1?this.posY+this.margin[0]:this.margin[0],we=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ee=this.pdf.internal.pageSize.height-this.margin[2],Ne=Ee-this.margin[0],Ue=this.pdf.internal.pageSize.width-this.margin[1],je=Ue-this.margin[3],st=ye===1?0:we+(ye-2)*Ne;if(this.ctx.clip_path.length!==0){var Ze=this.path;ve=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=x(ve,this.posX+this.margin[3],-1*st+xe),F.call(this,"fill",!0),this.path=Ze}var ct=x([JSON.parse(JSON.stringify(D))],this.posX+this.margin[3],-st+xe+this.ctx.prevPageLastElemOffset)[0];M.scale>=.01&&(Ce=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ce*M.scale),Be=this.lineWidth,this.lineWidth=Be*M.scale);var wt=this.autoPaging!=="text";if(wt||ct.y+ct.h<=Ee){if(wt||ct.y>=xe&&ct.x<=Ue){var it=wt?M.text:this.pdf.splitTextToSize(M.text,M.maxWidth||Ue-ct.x)[0],lt=x([JSON.parse(JSON.stringify(Qe))],this.posX+this.margin[3],-st+xe+this.ctx.prevPageLastElemOffset)[0],tt=wt&&(ye>W||ye<ee)&&f.call(this);tt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],je,Ne,null).clip().discardPath()),this.pdf.text(it,lt.x,lt.y,{angle:M.angle,align:O,renderingMode:M.renderingMode}),tt&&this.pdf.restoreGraphicsState()}}else ct.y<Ee&&(this.ctx.prevPageLastElemOffset+=Ee-ct.y);M.scale>=.01&&(this.pdf.setFontSize(Ce),this.lineWidth=Be)}else M.scale>=.01&&(Ce=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ce*M.scale),Be=this.lineWidth,this.lineWidth=Be*M.scale),this.pdf.text(M.text,ie.x+this.posX,ie.y+this.posY,{angle:M.angle,align:O,renderingMode:M.renderingMode,maxWidth:M.maxWidth}),M.scale>=.01&&(this.pdf.setFontSize(Ce),this.lineWidth=Be)},T=function(M,O,H,J){H=H||0,J=J||0,this.pdf.internal.out(t(M+H)+" "+n(O+J)+" l")},L=function(M,O,H){return this.pdf.lines(M,O,H,null,null)},K=function(M,O,H,J,de,ie,le,fe){this.pdf.internal.out([e(s(H+M)),e(i(J+O)),e(s(de+M)),e(i(ie+O)),e(s(le+M)),e(i(fe+O)),"c"].join(" "))},se=function(M,O,H,J){for(var de=2*Math.PI,ie=Math.PI/2;O>H;)O-=de;var le=Math.abs(H-O);le<de&&J&&(le=de-le);for(var fe=[],ve=J?-1:1,Ce=O;le>1e-5;){var Be=Ce+ve*Math.min(le,ie);fe.push(X.call(this,M,Ce,Be)),le-=Math.abs(Be-Ce),Ce=Be}return fe},X=function(M,O,H){var J=(H-O)/2,de=M*Math.cos(J),ie=M*Math.sin(J),le=de,fe=-ie,ve=le*le+fe*fe,Ce=ve+le*de+fe*ie,Be=4/3*(Math.sqrt(2*ve*Ce)-Ce)/(le*ie-fe*de),Qe=le-Be*fe,D=fe+Be*le,G=Qe,ce=-D,Z=J+O,W=Math.cos(Z),ee=Math.sin(Z);return{x1:M*Math.cos(O),y1:M*Math.sin(O),x2:Qe*W-D*ee,y2:Qe*ee+D*W,x3:G*W-ce*ee,y3:G*ee+ce*W,x4:M*Math.cos(H),y4:M*Math.sin(H)}},$=function(M){return 180*M/Math.PI},V=function(M,O,H,J,de,ie){var le=M+.5*(H-M),fe=O+.5*(J-O),ve=de+.5*(H-de),Ce=ie+.5*(J-ie),Be=Math.min(M,de,le,ve),Qe=Math.max(M,de,le,ve),D=Math.min(O,ie,fe,Ce),G=Math.max(O,ie,fe,Ce);return new o(Be,D,Qe-Be,G-D)},he=function(M,O,H,J,de,ie,le,fe){var ve,Ce,Be,Qe,D,G,ce,Z,W,ee,ye,xe,we,Ee,Ne=H-M,Ue=J-O,je=de-H,st=ie-J,Ze=le-de,ct=fe-ie;for(Ce=0;Ce<41;Ce++)W=(ce=(Be=M+(ve=Ce/40)*Ne)+ve*((D=H+ve*je)-Be))+ve*(D+ve*(de+ve*Ze-D)-ce),ee=(Z=(Qe=O+ve*Ue)+ve*((G=J+ve*st)-Qe))+ve*(G+ve*(ie+ve*ct-G)-Z),Ce==0?(ye=W,xe=ee,we=W,Ee=ee):(ye=Math.min(ye,W),xe=Math.min(xe,ee),we=Math.max(we,W),Ee=Math.max(Ee,ee));return new o(Math.round(ye),Math.round(xe),Math.round(we-ye),Math.round(Ee-xe))},z=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var M,O,H=(M=this.ctx.lineDash,O=this.ctx.lineDashOffset,JSON.stringify({lineDash:M,lineDashOffset:O}));this.prevLineDash!==H&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=H)}}})(kt.API),(function(r){var e=function(a){var o,l,c,A,d,h,u,p,f,g;for(l=[],c=0,A=(a+=o="\0\0\0\0".slice(a.length%4||4)).length;A>c;c+=4)(d=(a.charCodeAt(c)<<24)+(a.charCodeAt(c+1)<<16)+(a.charCodeAt(c+2)<<8)+a.charCodeAt(c+3))!==0?(h=(d=((d=((d=((d=(d-(g=d%85))/85)-(f=d%85))/85)-(p=d%85))/85)-(u=d%85))/85)%85,l.push(h+33,u+33,p+33,f+33,g+33)):l.push(122);return(function(m,x){for(var S=x;S>0;S--)m.pop()})(l,o.length),String.fromCharCode.apply(String,l)+"~>"},t=function(a){var o,l,c,A,d,h=String,u="length",p=255,f="charCodeAt",g="slice",m="replace";for(a[g](-2),a=a[g](0,-2)[m](/\s/g,"")[m]("z","!!!!!"),c=[],A=0,d=(a+=o="uuuuu"[g](a[u]%5||5))[u];d>A;A+=5)l=52200625*(a[f](A)-33)+614125*(a[f](A+1)-33)+7225*(a[f](A+2)-33)+85*(a[f](A+3)-33)+(a[f](A+4)-33),c.push(p&l>>24,p&l>>16,p&l>>8,p&l);return(function(x,S){for(var B=S;B>0;B--)x.pop()})(c,o[u]),h.fromCharCode.apply(h,c)},n=function(a){return a.split("").map(function(o){return("0"+o.charCodeAt().toString(16)).slice(-2)}).join("")+">"},s=function(a){var o=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((a=a.replace(/\s/g,"")).indexOf(">")!==-1&&(a=a.substr(0,a.indexOf(">"))),a.length%2&&(a+="0"),o.test(a)===!1)return"";for(var l="",c=0;c<a.length;c+=2)l+=String.fromCharCode("0x"+(a[c]+a[c+1]));return l},i=function(a){for(var o=new Uint8Array(a.length),l=a.length;l--;)o[l]=a.charCodeAt(l);return(o=w1(o)).reduce(function(c,A){return c+String.fromCharCode(A)},"")};r.processDataByFilters=function(a,o){var l=0,c=a||"",A=[];for(typeof(o=o||[])=="string"&&(o=[o]),l=0;l<o.length;l+=1)switch(o[l]){case"ASCII85Decode":case"/ASCII85Decode":c=t(c),A.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":c=e(c),A.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":c=s(c),A.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":c=n(c),A.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":c=i(c),A.push("/FlateDecode");break;default:throw new Error('The filter: "'+o[l]+'" is not implemented')}return{data:c,reverseChain:A.reverse().join(" ")}}})(kt.API),(function(r){r.loadFile=function(e,t,n){return(function(s,i,a){i=i!==!1,a=typeof a=="function"?a:function(){};var o=void 0;try{o=(function(l,c,A){var d=new XMLHttpRequest,h=0,u=function(p){var f=p.length,g=[],m=String.fromCharCode;for(h=0;h<f;h+=1)g.push(m(255&p.charCodeAt(h)));return g.join("")};if(d.open("GET",l,!c),d.overrideMimeType("text/plain; charset=x-user-defined"),c===!1&&(d.onload=function(){d.status===200?A(u(this.responseText)):A(void 0)}),d.send(null),c&&d.status===200)return u(d.responseText)})(s,i,a)}catch{}return o})(e,t,n)},r.loadImageFile=r.loadFile})(kt.API),(function(r){function e(){return(Zt.html2canvas?Promise.resolve(Zt.html2canvas):Yf(()=>Promise.resolve().then(()=>Yz),void 0)).catch(function(o){return Promise.reject(new Error("Could not load html2canvas: "+o))}).then(function(o){return o.default?o.default:o})}function t(){return(Zt.DOMPurify?Promise.resolve(Zt.DOMPurify):Yf(()=>import("./purify.es-B6FQ9oRL.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load dompurify: "+o))}).then(function(o){return o.default?o.default:o})}var n=function(o){var l=nn(o);return l==="undefined"?"undefined":l==="string"||o instanceof String?"string":l==="number"||o instanceof Number?"number":l==="function"||o instanceof Function?"function":o&&o.constructor===Array?"array":o&&o.nodeType===1?"element":l==="object"?"object":"unknown"},s=function(o,l){var c=document.createElement(o);for(var A in l.className&&(c.className=l.className),l.innerHTML&&l.dompurify&&(c.innerHTML=l.dompurify.sanitize(l.innerHTML)),l.style)c.style[A]=l.style[A];return c},i=function o(l,c){for(var A=l.nodeType===3?document.createTextNode(l.nodeValue):l.cloneNode(!1),d=l.firstChild;d;d=d.nextSibling)c!==!0&&d.nodeType===1&&d.nodeName==="SCRIPT"||A.appendChild(o(d,c));return l.nodeType===1&&(l.nodeName==="CANVAS"?(A.width=l.width,A.height=l.height,A.getContext("2d").drawImage(l,0,0)):l.nodeName!=="TEXTAREA"&&l.nodeName!=="SELECT"||(A.value=l.value),A.addEventListener("load",function(){A.scrollTop=l.scrollTop,A.scrollLeft=l.scrollLeft},!0)),A},a=function o(l){var c=Object.assign(o.convert(Promise.resolve()),JSON.parse(JSON.stringify(o.template))),A=o.convert(Promise.resolve(),c);return(A=A.setProgress(1,o,1,[o])).set(l)};(a.prototype=Object.create(Promise.prototype)).constructor=a,a.convert=function(o,l){return o.__proto__=l||a.prototype,o},a.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},a.prototype.from=function(o,l){return this.then(function(){switch(l=l||(function(c){switch(n(c)){case"string":return"string";case"element":return c.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(o),l){case"string":return this.then(t).then(function(c){return this.set({src:s("div",{innerHTML:o,dompurify:c})})});case"element":return this.set({src:o});case"canvas":return this.set({canvas:o});case"img":return this.set({img:o});default:return this.error("Unknown source type.")}})},a.prototype.to=function(o){switch(o){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},a.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var o={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},l=i(this.prop.src,this.opt.html2canvas.javascriptEnabled);l.tagName==="BODY"&&(o.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=s("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=s("div",{className:"html2pdf__container",style:o}),this.prop.container.appendChild(l),this.prop.container.firstChild.appendChild(s("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},a.prototype.toCanvas=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(e).then(function(l){var c=Object.assign({},this.opt.html2canvas);return delete c.onrendered,l(this.prop.container,c)}).then(function(l){(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},a.prototype.toContext2d=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(e).then(function(l){var c=this.opt.jsPDF,A=this.opt.fontFaces,d=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,h=Object.assign({async:!0,allowTaint:!0,scale:d,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete h.onrendered,c.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,c.context2d.posX=this.opt.x,c.context2d.posY=this.opt.y,c.context2d.margin=this.opt.margin,c.context2d.fontFaces=A,A)for(var u=0;u<A.length;++u){var p=A[u],f=p.src.find(function(g){return g.format==="truetype"});f&&c.addFont(f.url,p.ref.name,p.ref.style)}return h.windowHeight=h.windowHeight||0,h.windowHeight=h.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):h.windowHeight,c.context2d.save(!0),l(this.prop.container,h)}).then(function(l){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},a.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var o=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=o})},a.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},a.prototype.output=function(o,l,c){return(c=c||"pdf").toLowerCase()==="img"||c.toLowerCase()==="image"?this.outputImg(o,l):this.outputPdf(o,l)},a.prototype.outputPdf=function(o,l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(o,l)})},a.prototype.outputImg=function(o){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(o){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+o+'" is not supported.'}})},a.prototype.save=function(o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(o?{filename:o}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},a.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},a.prototype.set=function(o){if(n(o)!=="object")return this;var l=Object.keys(o||{}).map(function(c){if(c in a.template.prop)return function(){this.prop[c]=o[c]};switch(c){case"margin":return this.setMargin.bind(this,o.margin);case"jsPDF":return function(){return this.opt.jsPDF=o.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,o.pageSize);default:return function(){this.opt[c]=o[c]}}},this);return this.then(function(){return this.thenList(l)})},a.prototype.get=function(o,l){return this.then(function(){var c=o in a.template.prop?this.prop[o]:this.opt[o];return l?l(c):c})},a.prototype.setMargin=function(o){return this.then(function(){switch(n(o)){case"number":o=[o,o,o,o];case"array":if(o.length===2&&(o=[o[0],o[1],o[0],o[1]]),o.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=o}).then(this.setPageSize)},a.prototype.setPageSize=function(o){function l(c,A){return Math.floor(c*A/72*96)}return this.then(function(){(o=o||kt.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(o.inner={width:o.width-this.opt.margin[1]-this.opt.margin[3],height:o.height-this.opt.margin[0]-this.opt.margin[2]},o.inner.px={width:l(o.inner.width,o.k),height:l(o.inner.height,o.k)},o.inner.ratio=o.inner.height/o.inner.width),this.prop.pageSize=o})},a.prototype.setProgress=function(o,l,c,A){return o!=null&&(this.progress.val=o),l!=null&&(this.progress.state=l),c!=null&&(this.progress.n=c),A!=null&&(this.progress.stack=A),this.progress.ratio=this.progress.val/this.progress.state,this},a.prototype.updateProgress=function(o,l,c,A){return this.setProgress(o?this.progress.val+o:null,l||null,c?this.progress.n+c:null,A?this.progress.stack.concat(A):null)},a.prototype.then=function(o,l){var c=this;return this.thenCore(o,l,function(A,d){return c.updateProgress(null,null,1,[A]),Promise.prototype.then.call(this,function(h){return c.updateProgress(null,A),h}).then(A,d).then(function(h){return c.updateProgress(1),h})})},a.prototype.thenCore=function(o,l,c){c=c||Promise.prototype.then;var A=this;o&&(o=o.bind(A)),l&&(l=l.bind(A));var d=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?A:a.convert(Object.assign({},A),Promise.prototype),h=c.call(d,o,l);return a.convert(h,A.__proto__)},a.prototype.thenExternal=function(o,l){return Promise.prototype.then.call(this,o,l)},a.prototype.thenList=function(o){var l=this;return o.forEach(function(c){l=l.thenCore(c)}),l},a.prototype.catch=function(o){o&&(o=o.bind(this));var l=Promise.prototype.catch.call(this,o);return a.convert(l,this)},a.prototype.catchExternal=function(o){return Promise.prototype.catch.call(this,o)},a.prototype.error=function(o){return this.then(function(){throw new Error(o)})},a.prototype.using=a.prototype.set,a.prototype.saveAs=a.prototype.save,a.prototype.export=a.prototype.output,a.prototype.run=a.prototype.then,kt.getPageSize=function(o,l,c){if(nn(o)==="object"){var A=o;o=A.orientation,l=A.unit||l,c=A.format||c}l=l||"mm",c=c||"a4",o=(""+(o||"P")).toLowerCase();var d,h=(""+c).toLowerCase(),u={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(l){case"pt":d=1;break;case"mm":d=72/25.4;break;case"cm":d=72/2.54;break;case"in":d=72;break;case"px":d=.75;break;case"pc":case"em":d=12;break;case"ex":d=6;break;default:throw"Invalid unit: "+l}var p,f=0,g=0;if(u.hasOwnProperty(h))f=u[h][1]/d,g=u[h][0]/d;else try{f=c[1],g=c[0]}catch{throw new Error("Invalid format: "+c)}if(o==="p"||o==="portrait")o="p",g>f&&(p=g,g=f,f=p);else{if(o!=="l"&&o!=="landscape")throw"Invalid orientation: "+o;o="l",f>g&&(p=g,g=f,f=p)}return{width:g,height:f,unit:l,k:d,orientation:o}},r.html=function(o,l){(l=l||{}).callback=l.callback||function(){},l.html2canvas=l.html2canvas||{},l.html2canvas.canvas=l.html2canvas.canvas||this.canvas,l.jsPDF=l.jsPDF||this,l.fontFaces=l.fontFaces?l.fontFaces.map($w):null;var c=new a(l);return l.worker?c:c.from(o).doCallback()}})(kt.API),kt.API.addJS=function(r){return VS=r,this.internal.events.subscribe("postPutResources",function(){T0=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(T0+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),jS=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+VS+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){T0!==void 0&&jS!==void 0&&this.internal.out("/Names <</JavaScript "+T0+" 0 R>>")}),this},(function(r){var e;r.events.push(["postPutResources",function(){var t=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var s=t.outline.render().split(/\r\n/),i=0;i<s.length;i++){var a=s[i],o=n.exec(a);if(o!=null){var l=o[1];t.internal.newObjectDeferredBegin(l,!1)}t.internal.write(a)}if(this.outline.createNamedDestinations){var c=this.internal.pages.length,A=[];for(i=0;i<c;i++){var d=t.internal.newObject();A.push(d);var h=t.internal.getPageInfo(i+1);t.internal.write("<< /D["+h.objId+" 0 R /XYZ null null null]>> endobj")}var u=t.internal.newObject();for(t.internal.write("<< /Names [ "),i=0;i<A.length;i++)t.internal.write("(page_"+(i+1)+")"+A[i]+" 0 R");t.internal.write(" ] >>","endobj"),e=t.internal.newObject(),t.internal.write("<< /Dests "+u+" 0 R"),t.internal.write(">>","endobj")}}]),r.events.push(["putCatalog",function(){var t=this;t.outline.root.children.length>0&&(t.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&t.internal.write("/Names "+e+" 0 R"))}]),r.events.push(["initialized",function(){var t=this;t.outline={createNamedDestinations:!1,root:{children:[]}},t.outline.add=function(n,s,i){var a={title:s,options:i,children:[]};return n==null&&(n=this.root),n.children.push(a),a},t.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=t,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},t.outline.genIds_r=function(n){n.id=t.internal.newObjectDeferred();for(var s=0;s<n.children.length;s++)this.genIds_r(n.children[s])},t.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},t.outline.renderItems=function(n){for(var s=this.ctx.pdf.internal.getVerticalCoordinateString,i=0;i<n.children.length;i++){var a=n.children[i];this.objStart(a),this.line("/Title "+this.makeString(a.title)),this.line("/Parent "+this.makeRef(n)),i>0&&this.line("/Prev "+this.makeRef(n.children[i-1])),i<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[i+1])),a.children.length>0&&(this.line("/First "+this.makeRef(a.children[0])),this.line("/Last "+this.makeRef(a.children[a.children.length-1])));var o=this.count=this.count_r({count:0},a);if(o>0&&this.line("/Count "+o),a.options&&a.options.pageNumber){var l=t.internal.getPageInfo(a.options.pageNumber);this.line("/Dest ["+l.objId+" 0 R /XYZ 0 "+s(0)+" 0]")}this.objEnd()}for(var c=0;c<n.children.length;c++)this.renderItems(n.children[c])},t.outline.line=function(n){this.ctx.val+=n+`\r
`},t.outline.makeRef=function(n){return n.id+" 0 R"},t.outline.makeString=function(n){return"("+t.internal.pdfEscape(n)+")"},t.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},t.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},t.outline.count_r=function(n,s){for(var i=0;i<s.children.length;i++)n.count++,this.count_r(n,s.children[i]);return n.count}}])})(kt.API),(function(r){var e=[192,193,194,195,196,197,198,199];r.processJPEG=function(t,n,s,i,a,o){var l,c=this.decode.DCT_DECODE,A=null;if(typeof t=="string"||this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t)){switch(t=a||t,t=this.__addimage__.isArrayBuffer(t)?new Uint8Array(t):t,l=(function(d){for(var h,u=256*d.charCodeAt(4)+d.charCodeAt(5),p=d.length,f={width:0,height:0,numcomponents:1},g=4;g<p;g+=2){if(g+=u,e.indexOf(d.charCodeAt(g+1))!==-1){h=256*d.charCodeAt(g+5)+d.charCodeAt(g+6),f={width:256*d.charCodeAt(g+7)+d.charCodeAt(g+8),height:h,numcomponents:d.charCodeAt(g+9)};break}u=256*d.charCodeAt(g+2)+d.charCodeAt(g+3)}return f})(t=this.__addimage__.isArrayBufferView(t)?this.__addimage__.arrayBufferToBinaryString(t):t),l.numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}A={data:t,width:l.width,height:l.height,colorSpace:o,bitsPerComponent:8,filter:c,index:n,alias:s}}return A}})(kt.API),kt.API.processPNG=function(r,e,t,n){if(this.__addimage__.isArrayBuffer(r)&&(r=new Uint8Array(r)),this.__addimage__.isArrayBufferView(r)){var s,i=sW(r,{checkCrc:!0}),a=i.width,o=i.height,l=i.channels,c=i.palette,A=i.depth;s=c&&l===1?(function(w){for(var v=w.width,I=w.height,k=w.data,_=w.palette,T=w.depth,L=!1,K=[],se=[],X=void 0,$=!1,V=0,he=0;he<_.length;he++){var z=KC(_[he],4),M=z[0],O=z[1],H=z[2],J=z[3];K.push(M,O,H),J!=null&&(J===0?(V++,se.length<1&&se.push(he)):J<255&&($=!0))}if($||V>1){L=!0,se=void 0;var de=v*I;X=new Uint8Array(de);for(var ie=new DataView(k.buffer),le=0;le<de;le++){var fe=zw(ie,le,T),ve=KC(_[fe],4)[3];X[le]=ve}}else V===0&&(se=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:L?8:void 0,colorBytes:k,alphaBytes:X,needSMask:L,palette:K,mask:se}})(i):l===2||l===4?(function(w){for(var v=w.data,I=w.width,k=w.height,_=w.channels,T=w.depth,L=_===2?"DeviceGray":"DeviceRGB",K=_-1,se=I*k,X=K,$=se*X,V=1*se,he=Math.ceil($*T/8),z=Math.ceil(V*T/8),M=new Uint8Array(he),O=new Uint8Array(z),H=new DataView(v.buffer),J=new DataView(M.buffer),de=new DataView(O.buffer),ie=!1,le=0;le<se;le++){for(var fe=le*_,ve=0;ve<X;ve++)JS(J,zw(H,fe+ve,T),le*X+ve,T);var Ce=zw(H,fe+X,T);Ce<(1<<T)-1&&(ie=!0),JS(de,Ce,1*le,T)}return{colorSpace:L,colorsPerPixel:K,sMaskBitsPerComponent:ie?T:void 0,colorBytes:M,alphaBytes:O,needSMask:ie}})(i):(function(w){var v=w.data,I=w.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:I,colorsPerPixel:I==="DeviceGray"?1:3,colorBytes:v instanceof Uint16Array?(function(k){for(var _=k.length,T=new Uint8Array(2*_),L=new DataView(T.buffer,T.byteOffset,T.byteLength),K=0;K<_;K++)L.setUint16(2*K,k[K],!1);return T})(v):v,needSMask:!1}})(i);var d,h,u,p=s,f=p.colorSpace,g=p.colorsPerPixel,m=p.sMaskBitsPerComponent,x=p.colorBytes,S=p.alphaBytes,B=p.needSMask,F=p.palette,N=p.mask,E=null;return n!==kt.API.image_compression.NONE&&typeof w1=="function"?(E=(function(w){var v;switch(w){case kt.API.image_compression.FAST:v=11;break;case kt.API.image_compression.MEDIUM:v=13;break;case kt.API.image_compression.SLOW:v=14;break;default:v=12}return v})(n),d=this.decode.FLATE_DECODE,h="/Predictor ".concat(E," /Colors ").concat(g," /BitsPerComponent ").concat(A," /Columns ").concat(a),r=KS(x,Math.ceil(a*g*A/8),g,A,n),B&&(u=KS(S,Math.ceil(a*m/8),1,m,n))):(d=void 0,h=void 0,r=x,B&&(u=S)),(this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r))&&(r=this.__addimage__.arrayBufferToBinaryString(r)),(u&&this.__addimage__.isArrayBuffer(u)||this.__addimage__.isArrayBufferView(u))&&(u=this.__addimage__.arrayBufferToBinaryString(u)),{alias:t,data:r,index:e,filter:d,decodeParameters:h,transparency:N,palette:F,sMask:u,predictor:E,width:a,height:o,bitsPerComponent:A,sMaskBitsPerComponent:m,colorSpace:f}}},(function(r){r.processGIF89A=function(e,t,n,s){var i=new CW(e),a=i.width,o=i.height,l=[];i.decodeAndBlitFrameRGBA(0,l);var c={data:l,width:a,height:o},A=new Kw(100).encode(c,100);return r.processJPEG.call(this,A,t,n,s)},r.processGIF87A=r.processGIF89A})(kt.API),lo.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var r=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(r);for(var e=0;e<r;e++){var t=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:s,green:n,blue:t,quad:i}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},lo.prototype.parseBGR=function(){this.pos=this.offset;try{var r="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[r]()}catch(t){un.log("bit decode error:"+t)}},lo.prototype.bit1=function(){var r,e=Math.ceil(this.width/8),t=e%4;for(r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,s=0;s<e;s++)for(var i=this.datav.getUint8(this.pos++,!0),a=n*this.width*4+8*s*4,o=0;o<8&&8*s+o<this.width;o++){var l=this.palette[i>>7-o&1];this.data[a+4*o]=l.blue,this.data[a+4*o+1]=l.green,this.data[a+4*o+2]=l.red,this.data[a+4*o+3]=255}t!==0&&(this.pos+=4-t)}},lo.prototype.bit4=function(){for(var r=Math.ceil(this.width/2),e=r%4,t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,s=0;s<r;s++){var i=this.datav.getUint8(this.pos++,!0),a=n*this.width*4+2*s*4,o=i>>4,l=15&i,c=this.palette[o];if(this.data[a]=c.blue,this.data[a+1]=c.green,this.data[a+2]=c.red,this.data[a+3]=255,2*s+1>=this.width)break;c=this.palette[l],this.data[a+4]=c.blue,this.data[a+4+1]=c.green,this.data[a+4+2]=c.red,this.data[a+4+3]=255}e!==0&&(this.pos+=4-e)}},lo.prototype.bit8=function(){for(var r=this.width%4,e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var s=this.datav.getUint8(this.pos++,!0),i=t*this.width*4+4*n;if(s<this.palette.length){var a=this.palette[s];this.data[i]=a.red,this.data[i+1]=a.green,this.data[i+2]=a.blue,this.data[i+3]=255}else this.data[i]=255,this.data[i+1]=255,this.data[i+2]=255,this.data[i+3]=255}r!==0&&(this.pos+=4-r)}},lo.prototype.bit15=function(){for(var r=this.width%3,e=parseInt("11111",2),t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,s=0;s<this.width;s++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var a=(i&e)/e*255|0,o=(i>>5&e)/e*255|0,l=(i>>10&e)/e*255|0,c=i>>15?255:0,A=n*this.width*4+4*s;this.data[A]=l,this.data[A+1]=o,this.data[A+2]=a,this.data[A+3]=c}this.pos+=r}},lo.prototype.bit16=function(){for(var r=this.width%3,e=parseInt("11111",2),t=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var s=this.bottom_up?n:this.height-1-n,i=0;i<this.width;i++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(a&e)/e*255|0,l=(a>>5&t)/t*255|0,c=(a>>11)/e*255|0,A=s*this.width*4+4*i;this.data[A]=c,this.data[A+1]=l,this.data[A+2]=o,this.data[A+3]=255}this.pos+=r}},lo.prototype.bit24=function(){for(var r=this.height-1;r>=0;r--){for(var e=this.bottom_up?r:this.height-1-r,t=0;t<this.width;t++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=e*this.width*4+4*t;this.data[a]=i,this.data[a+1]=s,this.data[a+2]=n,this.data[a+3]=255}this.pos+=this.width%4}},lo.prototype.bit32=function(){for(var r=this.height-1;r>=0;r--)for(var e=this.bottom_up?r:this.height-1-r,t=0;t<this.width;t++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*t;this.data[o]=i,this.data[o+1]=s,this.data[o+2]=n,this.data[o+3]=a}},lo.prototype.getData=function(){return this.data},(function(r){r.processBMP=function(e,t,n,s){var i=new lo(e,!1),a=i.width,o=i.height,l={data:i.getData(),width:a,height:o},c=new Kw(100).encode(l,100);return r.processJPEG.call(this,c,t,n,s)}})(kt.API),ek.prototype.getData=function(){return this.data},(function(r){r.processWEBP=function(e,t,n,s){var i=new ek(e),a=i.width,o=i.height,l={data:i.getData(),width:a,height:o},c=new Kw(100).encode(l,100);return r.processJPEG.call(this,c,t,n,s)}})(kt.API),kt.API.processRGBA=function(r,e,t){for(var n=r.data,s=n.length,i=new Uint8Array(s/4*3),a=new Uint8Array(s/4),o=0,l=0,c=0;c<s;c+=4){var A=n[c],d=n[c+1],h=n[c+2],u=n[c+3];i[o++]=A,i[o++]=d,i[o++]=h,a[l++]=u}var p=this.__addimage__.arrayBufferToBinaryString(i);return{alpha:this.__addimage__.arrayBufferToBinaryString(a),data:p,index:e,alias:t,colorSpace:"DeviceRGB",bitsPerComponent:8,width:r.width,height:r.height}},kt.API.setLanguage=function(r){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[r]!==void 0&&(this.internal.languageSettings.languageCode=r,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},vu=kt.API,F0=vu.getCharWidthsArray=function(r,e){var t,n,s=(e=e||{}).font||this.internal.getFont(),i=e.fontSize||this.internal.getFontSize(),a=e.charSpace||this.internal.getCharSpace(),o=e.widths?e.widths:s.metadata.Unicode.widths,l=o.fof?o.fof:1,c=e.kerning?e.kerning:s.metadata.Unicode.kerning,A=c.fof?c.fof:1,d=e.doKerning!==!1,h=0,u=r.length,p=0,f=o[0]||l,g=[];for(t=0;t<u;t++)n=r.charCodeAt(t),typeof s.metadata.widthOfString=="function"?g.push((s.metadata.widthOfGlyph(s.metadata.characterToGlyph(n))+a*(1e3/i)||0)/1e3):(h=d&&nn(c[n])==="object"&&!isNaN(parseInt(c[n][p],10))?c[n][p]/A:0,g.push((o[n]||f)/l+h)),p=n;return g},$S=vu.getStringUnitWidth=function(r,e){var t=(e=e||{}).fontSize||this.internal.getFontSize(),n=e.font||this.internal.getFont(),s=e.charSpace||this.internal.getCharSpace();return vu.processArabic&&(r=vu.processArabic(r)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(r,t,s)/t:F0.apply(this,arguments).reduce(function(i,a){return i+a},0)},GS=function(r,e,t,n){for(var s=[],i=0,a=r.length,o=0;i!==a&&o+e[i]<t;)o+=e[i],i++;s.push(r.slice(0,i));var l=i;for(o=0;i!==a;)o+e[i]>n&&(s.push(r.slice(l,i)),o=0,l=i),o+=e[i],i++;return l!==i&&s.push(r.slice(l,i)),s},zS=function(r,e,t){t||(t={});var n,s,i,a,o,l,c,A=[],d=[A],h=t.textIndent||0,u=0,p=0,f=r.split(" "),g=F0.apply(this,[" ",t])[0];if(l=t.lineIndent===-1?f[0].length+2:t.lineIndent||0){var m=Array(l).join(" "),x=[];f.map(function(B){(B=B.split(/\s*\n/)).length>1?x=x.concat(B.map(function(F,N){return(N&&F.length?`
`:"")+F})):x.push(B[0])}),f=x,l=$S.apply(this,[m,t])}for(i=0,a=f.length;i<a;i++){var S=0;if(n=f[i],l&&n[0]==`
`&&(n=n.substr(1),S=1),h+u+(p=(s=F0.apply(this,[n,t])).reduce(function(B,F){return B+F},0))>e||S){if(p>e){for(o=GS.apply(this,[n,s,e-(h+u),e]),A.push(o.shift()),A=[o.pop()];o.length;)d.push([o.shift()]);p=s.slice(n.length-(A[0]?A[0].length:0)).reduce(function(B,F){return B+F},0)}else A=[n];d.push(A),h=p+l,u=g}else A.push(n),h+=u+p,u=g}return c=l?function(B,F){return(F?m:"")+B.join(" ")}:function(B){return B.join(" ")},d.map(c)},vu.splitTextToSize=function(r,e,t){var n,s=(t=t||{}).fontSize||this.internal.getFontSize(),i=(function(A){if(A.widths&&A.kerning)return{widths:A.widths,kerning:A.kerning};var d=this.internal.getFont(A.fontName,A.fontStyle),h="Unicode";return d.metadata[h]?{widths:d.metadata[h].widths||{0:1},kerning:d.metadata[h].kerning||{}}:{font:d.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,t);n=Array.isArray(r)?r:String(r).split(/\r?\n/);var a=1*this.internal.scaleFactor*e/s;i.textIndent=t.textIndent?1*t.textIndent*this.internal.scaleFactor/s:0,i.lineIndent=t.lineIndent;var o,l,c=[];for(o=0,l=n.length;o<l;o++)c=c.concat(zS.apply(this,[n[o],a,i]));return c},(function(r){r.__fontmetrics__=r.__fontmetrics__||{};for(var e="0123456789abcdef",t="klmnopqrstuvwxyz",n={},s={},i=0;i<16;i++)n[t[i]]=e[i],s[e[i]]=t[i];var a=function(h){return"0x"+parseInt(h,10).toString(16)},o=r.__fontmetrics__.compress=function(h){var u,p,f,g,m=["{"];for(var x in h){if(u=h[x],isNaN(parseInt(x,10))?p="'"+x+"'":(x=parseInt(x,10),p=(p=a(x).slice(2)).slice(0,-1)+s[p.slice(-1)]),typeof u=="number")u<0?(f=a(u).slice(3),g="-"):(f=a(u).slice(2),g=""),f=g+f.slice(0,-1)+s[f.slice(-1)];else{if(nn(u)!=="object")throw new Error("Don't know what to do with value type "+nn(u)+".");f=o(u)}m.push(p+f)}return m.push("}"),m.join("")},l=r.__fontmetrics__.uncompress=function(h){if(typeof h!="string")throw new Error("Invalid argument passed to uncompress.");for(var u,p,f,g,m={},x=1,S=m,B=[],F="",N="",E=h.length-1,w=1;w<E;w+=1)(g=h[w])=="'"?u?(f=u.join(""),u=void 0):u=[]:u?u.push(g):g=="{"?(B.push([S,f]),S={},f=void 0):g=="}"?((p=B.pop())[0][p[1]]=S,f=void 0,S=p[0]):g=="-"?x=-1:f===void 0?n.hasOwnProperty(g)?(F+=n[g],f=parseInt(F,16)*x,x=1,F=""):F+=g:n.hasOwnProperty(g)?(N+=n[g],S[f]=parseInt(N,16)*x,x=1,f=void 0,N=""):N+=g;return m},c={codePages:["WinAnsiEncoding"],WinAnsiEncoding:l("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},A={Unicode:{Courier:c,"Courier-Bold":c,"Courier-BoldOblique":c,"Courier-Oblique":c,Helvetica:c,"Helvetica-Bold":c,"Helvetica-BoldOblique":c,"Helvetica-Oblique":c,"Times-Roman":c,"Times-Bold":c,"Times-BoldItalic":c,"Times-Italic":c}},d={Unicode:{"Courier-Oblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":l("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":l("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:l("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:l("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":l("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":l("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};r.events.push(["addFont",function(h){var u=h.font,p=d.Unicode[u.postScriptName];p&&(u.metadata.Unicode={},u.metadata.Unicode.widths=p.widths,u.metadata.Unicode.kerning=p.kerning);var f=A.Unicode[u.postScriptName];f&&(u.metadata.Unicode.encoding=f,u.encoding=f.codePages[0])}])})(kt.API),(function(r){var e=function(t){for(var n=t.length,s=new Uint8Array(n),i=0;i<n;i++)s[i]=t.charCodeAt(i);return s};r.API.events.push(["addFont",function(t){var n=void 0,s=t.font,i=t.instance;if(!s.isStandardFont){if(i===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");if(typeof(n=i.existsFileInVFS(s.postScriptName)===!1?i.loadFile(s.postScriptName):i.getFileFromVFS(s.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");(function(a,o){o=/^\x00\x01\x00\x00/.test(o)?e(o):e(am(o)),a.metadata=r.API.TTFFont.open(o),a.metadata.Unicode=a.metadata.Unicode||{encoding:{},kerning:{},widths:[]},a.metadata.glyIdsUsed=[0]})(s,n)}}])})(kt),kt.API.addSvgAsImage=function(r,e,t,n,s,i,a,o){if(isNaN(e)||isNaN(t))throw un.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(s))throw un.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var l=document.createElement("canvas");l.width=n,l.height=s;var c=l.getContext("2d");c.fillStyle="#fff",c.fillRect(0,0,l.width,l.height);var A={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},d=this;return(Zt.canvg?Promise.resolve(Zt.canvg):Yf(()=>import("./index.es-Dm3pucrB.js"),[])).catch(function(h){return Promise.reject(new Error("Could not load canvg: "+h))}).then(function(h){return h.default?h.default:h}).then(function(h){return h.fromString(c,r,A)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(h){return h.render(A)}).then(function(){d.addImage(l.toDataURL("image/jpeg",1),e,t,n,s,a,o)})},kt.API.putTotalPages=function(r){var e,t=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(r,"g"),t=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(r,this.internal.getFont()),"g"),t=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var s=0;s<this.internal.pages[n].length;s++)this.internal.pages[n][s]=this.internal.pages[n][s].replace(e,t);return this},kt.API.viewerPreferences=function(r,e){var t;r=r||{},e=e||!1;var n,s,i,a={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(a),l=[],c=0,A=0,d=0;function h(p,f){var g,m=!1;for(g=0;g<p.length;g+=1)p[g]===f&&(m=!0);return m}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(a)),this.internal.viewerpreferences.isSubscribed=!1),t=this.internal.viewerpreferences.configuration,r==="reset"||e===!0){var u=o.length;for(d=0;d<u;d+=1)t[o[d]].value=t[o[d]].defaultValue,t[o[d]].explicitSet=!1}if(nn(r)==="object"){for(s in r)if(i=r[s],h(o,s)&&i!==void 0){if(t[s].type==="boolean"&&typeof i=="boolean")t[s].value=i;else if(t[s].type==="name"&&h(t[s].valueSet,i))t[s].value=i;else if(t[s].type==="integer"&&Number.isInteger(i))t[s].value=i;else if(t[s].type==="array"){for(c=0;c<i.length;c+=1)if(n=!0,i[c].length===1&&typeof i[c][0]=="number")l.push(String(i[c]-1));else if(i[c].length>1){for(A=0;A<i[c].length;A+=1)typeof i[c][A]!="number"&&(n=!1);n===!0&&l.push([i[c][0]-1,i[c][1]-1].join(" "))}t[s].value="["+l.join(" ")+"]"}else t[s].value=t[s].defaultValue;t[s].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var p,f=[];for(p in t)t[p].explicitSet===!0&&(t[p].type==="name"?f.push("/"+p+" /"+t[p].value):f.push("/"+p+" "+t[p].value));f.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+f.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=t,this},(function(r){var e=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',s=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),i=unescape(encodeURIComponent(n)),a=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),o=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),l=unescape(encodeURIComponent("</x:xmpmeta>")),c=i.length+a.length+o.length+s.length+l.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+c+" >>"),this.internal.write("stream"),this.internal.write(s+i+a+o+l),this.internal.write("endstream"),this.internal.write("endobj")},t=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};r.addMetadata=function(n,s){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:s||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",t),this.internal.events.subscribe("postPutResources",e)),this}})(kt.API),(function(r){var e=r.API,t=e.pdfEscape16=function(i,a){for(var o,l=a.metadata.Unicode.widths,c=["","0","00","000","0000"],A=[""],d=0,h=i.length;d<h;++d){if(o=a.metadata.characterToGlyph(i.charCodeAt(d)),a.metadata.glyIdsUsed.push(o),a.metadata.toUnicode[o]=i.charCodeAt(d),l.indexOf(o)==-1&&(l.push(o),l.push([parseInt(a.metadata.widthOfGlyph(o),10)])),o=="0")return A.join("");o=o.toString(16),A.push(c[4-o.length],o)}return A.join("")},n=function(i){var a,o,l,c,A,d,h;for(A=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,l=[],d=0,h=(o=Object.keys(i).sort(function(u,p){return u-p})).length;d<h;d++)a=o[d],l.length>=100&&(A+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar`,l=[]),i[a]!==void 0&&i[a]!==null&&typeof i[a].toString=="function"&&(c=("0000"+i[a].toString(16)).slice(-4),a=("0000"+(+a).toString(16)).slice(-4),l.push("<"+a+"><"+c+">"));return l.length&&(A+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar
`),A+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(i){(function(a){var o=a.font,l=a.out,c=a.newObject,A=a.putStream;if(o.metadata instanceof r.API.TTFFont&&o.encoding==="Identity-H"){for(var d=o.metadata.Unicode.widths,h=o.metadata.subset.encode(o.metadata.glyIdsUsed,1),u="",p=0;p<h.length;p++)u+=String.fromCharCode(h[p]);var f=c();A({data:u,addLength1:!0,objectId:f}),l("endobj");var g=c();A({data:n(o.metadata.toUnicode),addLength1:!0,objectId:g}),l("endobj");var m=c();l("<<"),l("/Type /FontDescriptor"),l("/FontName /"+Su(o.fontName)),l("/FontFile2 "+f+" 0 R"),l("/FontBBox "+r.API.PDFObject.convert(o.metadata.bbox)),l("/Flags "+o.metadata.flags),l("/StemV "+o.metadata.stemV),l("/ItalicAngle "+o.metadata.italicAngle),l("/Ascent "+o.metadata.ascender),l("/Descent "+o.metadata.decender),l("/CapHeight "+o.metadata.capHeight),l(">>"),l("endobj");var x=c();l("<<"),l("/Type /Font"),l("/BaseFont /"+Su(o.fontName)),l("/FontDescriptor "+m+" 0 R"),l("/W "+r.API.PDFObject.convert(d)),l("/CIDToGIDMap /Identity"),l("/DW 1000"),l("/Subtype /CIDFontType2"),l("/CIDSystemInfo"),l("<<"),l("/Supplement 0"),l("/Registry (Adobe)"),l("/Ordering ("+o.encoding+")"),l(">>"),l(">>"),l("endobj"),o.objectNumber=c(),l("<<"),l("/Type /Font"),l("/Subtype /Type0"),l("/ToUnicode "+g+" 0 R"),l("/BaseFont /"+Su(o.fontName)),l("/Encoding /"+o.encoding),l("/DescendantFonts ["+x+" 0 R]"),l(">>"),l("endobj"),o.isAlreadyPutted=!0}})(i)}]),e.events.push(["putFont",function(i){(function(a){var o=a.font,l=a.out,c=a.newObject,A=a.putStream;if(o.metadata instanceof r.API.TTFFont&&o.encoding==="WinAnsiEncoding"){for(var d=o.metadata.rawData,h="",u=0;u<d.length;u++)h+=String.fromCharCode(d[u]);var p=c();A({data:h,addLength1:!0,objectId:p}),l("endobj");var f=c();A({data:n(o.metadata.toUnicode),addLength1:!0,objectId:f}),l("endobj");var g=c();l("<<"),l("/Descent "+o.metadata.decender),l("/CapHeight "+o.metadata.capHeight),l("/StemV "+o.metadata.stemV),l("/Type /FontDescriptor"),l("/FontFile2 "+p+" 0 R"),l("/Flags 96"),l("/FontBBox "+r.API.PDFObject.convert(o.metadata.bbox)),l("/FontName /"+Su(o.fontName)),l("/ItalicAngle "+o.metadata.italicAngle),l("/Ascent "+o.metadata.ascender),l(">>"),l("endobj"),o.objectNumber=c();for(var m=0;m<o.metadata.hmtx.widths.length;m++)o.metadata.hmtx.widths[m]=parseInt(o.metadata.hmtx.widths[m]*(1e3/o.metadata.head.unitsPerEm));l("<</Subtype/TrueType/Type/Font/ToUnicode "+f+" 0 R/BaseFont/"+Su(o.fontName)+"/FontDescriptor "+g+" 0 R/Encoding/"+o.encoding+" /FirstChar 29 /LastChar 255 /Widths "+r.API.PDFObject.convert(o.metadata.hmtx.widths)+">>"),l("endobj"),o.isAlreadyPutted=!0}})(i)}]);var s=function(i){var a,o=i.text||"",l=i.x,c=i.y,A=i.options||{},d=i.mutex||{},h=d.pdfEscape,u=d.activeFontKey,p=d.fonts,f=u,g="",m=0,x="",S=p[f].encoding;if(p[f].encoding!=="Identity-H")return{text:o,x:l,y:c,options:A,mutex:d};for(x=o,f=u,Array.isArray(o)&&(x=o[0]),m=0;m<x.length;m+=1)p[f].metadata.hasOwnProperty("cmap")&&(a=p[f].metadata.cmap.unicode.codeMap[x[m].charCodeAt(0)]),a||x[m].charCodeAt(0)<256&&p[f].metadata.hasOwnProperty("Unicode")?g+=x[m]:g+="";var B="";return parseInt(f.slice(1))<14||S==="WinAnsiEncoding"?B=h(g,f).split("").map(function(F){return F.charCodeAt(0).toString(16)}).join(""):S==="Identity-H"&&(B=t(g,p[f])),d.isHex=!0,{text:B,x:l,y:c,options:A,mutex:d}};e.events.push(["postProcessText",function(i){var a=i.text||"",o=[],l={text:a,x:i.x,y:i.y,options:i.options,mutex:i.mutex};if(Array.isArray(a)){var c=0;for(c=0;c<a.length;c+=1)Array.isArray(a[c])&&a[c].length===3?o.push([s(Object.assign({},l,{text:a[c][0]})).text,a[c][1],a[c][2]]):o.push(s(Object.assign({},l,{text:a[c]})).text);i.text=o}else i.text=s(Object.assign({},l,{text:a})).text}])})(kt),(function(r){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};r.existsFileInVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0},r.addFileToVFS=function(t,n){return e.call(this),this.internal.vFS[t]=n,this},r.getFileFromVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0?this.internal.vFS[t]:null}})(kt.API),(function(r){r.__bidiEngine__=r.prototype.__bidiEngine__=function(n){var s,i,a,o,l,c,A,d=e,h=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],u=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],p={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},f={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},g=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],m=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),x=!1,S=0;this.__bidiEngine__={};var B=function(k){var _=k.charCodeAt(),T=_>>8,L=f[T];return L!==void 0?d[256*L+(255&_)]:T===252||T===253?"AL":m.test(T)?"L":T===8?"R":"N"},F=function(k){for(var _,T=0;T<k.length;T++){if((_=B(k.charAt(T)))==="L")return!1;if(_==="R")return!0}return!1},N=function(k,_,T,L){var K,se,X,$,V=_[L];switch(V){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":x=!1;break;case"N":case"AN":break;case"EN":x&&(V="AN");break;case"AL":x=!0,V="R";break;case"WS":case"BN":V="N";break;case"CS":L<1||L+1>=_.length||(K=T[L-1])!=="EN"&&K!=="AN"||(se=_[L+1])!=="EN"&&se!=="AN"?V="N":x&&(se="AN"),V=se===K?se:"N";break;case"ES":V=(K=L>0?T[L-1]:"B")==="EN"&&L+1<_.length&&_[L+1]==="EN"?"EN":"N";break;case"ET":if(L>0&&T[L-1]==="EN"){V="EN";break}if(x){V="N";break}for(X=L+1,$=_.length;X<$&&_[X]==="ET";)X++;V=X<$&&_[X]==="EN"?"EN":"N";break;case"NSM":if(a&&!o){for($=_.length,X=L+1;X<$&&_[X]==="NSM";)X++;if(X<$){var he=k[L],z=he>=1425&&he<=2303||he===64286;if(K=_[X],z&&(K==="R"||K==="AL")){V="R";break}}}V=L<1||(K=_[L-1])==="B"?"N":T[L-1];break;case"B":x=!1,s=!0,V=S;break;case"S":i=!0,V="N"}return V},E=function(k,_,T){var L=k.split("");return T&&w(L,T,{hiLevel:S}),L.reverse(),_&&_.reverse(),L.join("")},w=function(k,_,T){var L,K,se,X,$,V=-1,he=k.length,z=0,M=[],O=S?u:h,H=[];for(x=!1,s=!1,i=!1,K=0;K<he;K++)H[K]=B(k[K]);for(se=0;se<he;se++){if($=z,M[se]=N(k,H,M,se),L=240&(z=O[$][p[M[se]]]),z&=15,_[se]=X=O[z][5],L>0)if(L===16){for(K=V;K<se;K++)_[K]=1;V=-1}else V=-1;if(O[z][6])V===-1&&(V=se);else if(V>-1){for(K=V;K<se;K++)_[K]=X;V=-1}H[se]==="B"&&(_[se]=0),T.hiLevel|=X}i&&(function(J,de,ie){for(var le=0;le<ie;le++)if(J[le]==="S"){de[le]=S;for(var fe=le-1;fe>=0&&J[fe]==="WS";fe--)de[fe]=S}})(H,_,he)},v=function(k,_,T,L,K){if(!(K.hiLevel<k)){if(k===1&&S===1&&!s)return _.reverse(),void(T&&T.reverse());for(var se,X,$,V,he=_.length,z=0;z<he;){if(L[z]>=k){for($=z+1;$<he&&L[$]>=k;)$++;for(V=z,X=$-1;V<X;V++,X--)se=_[V],_[V]=_[X],_[X]=se,T&&(se=T[V],T[V]=T[X],T[X]=se);z=$}z++}}},I=function(k,_,T){var L=k.split(""),K={hiLevel:S};return T||(T=[]),w(L,T,K),(function(se,X,$){if($.hiLevel!==0&&A)for(var V,he=0;he<se.length;he++)X[he]===1&&(V=g.indexOf(se[he]))>=0&&(se[he]=g[V+1])})(L,T,K),v(2,L,_,T,K),v(1,L,_,T,K),L.join("")};return this.__bidiEngine__.doBidiReorder=function(k,_,T){if((function(K,se){if(se)for(var X=0;X<K.length;X++)se[X]=X;o===void 0&&(o=F(K)),c===void 0&&(c=F(K))})(k,_),a||!l||c)if(a&&l&&o^c)S=o?1:0,k=E(k,_,T);else if(!a&&l&&c)S=o?1:0,k=I(k,_,T),k=E(k,_);else if(!a||o||l||c){if(a&&!l&&o^c)k=E(k,_),o?(S=0,k=I(k,_,T)):(S=1,k=I(k,_,T),k=E(k,_));else if(a&&o&&!l&&c)S=1,k=I(k,_,T),k=E(k,_);else if(!a&&!l&&o^c){var L=A;o?(S=1,k=I(k,_,T),S=0,A=!1,k=I(k,_,T),A=L):(S=0,k=I(k,_,T),k=E(k,_),S=1,A=!1,k=I(k,_,T),A=L,k=E(k,_))}}else S=0,k=I(k,_,T);else S=o?1:0,k=I(k,_,T);return k},this.__bidiEngine__.setOptions=function(k){k&&(a=k.isInputVisual,l=k.isOutputVisual,o=k.isInputRtl,c=k.isOutputRtl,A=k.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],t=new r.__bidiEngine__({isInputVisual:!0});r.API.events.push(["postProcessText",function(n){var s=n.text;n.x,n.y;var i=n.options||{};n.mutex,i.lang;var a=[];if(i.isInputVisual=typeof i.isInputVisual!="boolean"||i.isInputVisual,t.setOptions(i),Object.prototype.toString.call(s)==="[object Array]"){var o=0;for(a=[],o=0;o<s.length;o+=1)Object.prototype.toString.call(s[o])==="[object Array]"?a.push([t.doBidiReorder(s[o][0]),s[o][1],s[o][2]]):a.push([t.doBidiReorder(s[o])]);n.text=a}else n.text=t.doBidiReorder(s);t.setOptions({isInputVisual:!0})}])})(kt),kt.API.TTFFont=(function(){function r(e){var t;if(this.rawData=e,t=this.contents=new wA(e),this.contents.pos=4,t.readString(4)==="ttcf")throw new Error("TTCF not supported.");t.pos=0,this.parse(),this.subset=new QW(this),this.registerTTF()}return r.open=function(e){return new r(e)},r.prototype.parse=function(){return this.directory=new SW(this.contents),this.head=new EW(this),this.name=new UW(this),this.cmap=new KF(this),this.toUnicode={},this.hhea=new IW(this),this.maxp=new MW(this),this.hmtx=new NW(this),this.post=new FW(this),this.os2=new TW(this),this.loca=new OW(this),this.glyf=new PW(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},r.prototype.registerTTF=function(){var e,t,n,s,i;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var a,o,l,c;for(c=[],a=0,o=(l=this.bbox).length;a<o;a++)e=l[a],c.push(Math.round(e*this.scaleFactor));return c}).call(this),this.stemV=0,this.post.exists?(n=255&(s=this.post.italic_angle),32768&(t=s>>16)&&(t=-(1+(65535^t))),this.italicAngle=+(t+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(i=this.familyClass)===1||i===2||i===3||i===4||i===5||i===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},r.prototype.characterToGlyph=function(e){var t;return((t=this.cmap.unicode)!=null?t.codeMap[e]:void 0)||0},r.prototype.widthOfGlyph=function(e){var t;return t=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*t},r.prototype.widthOfString=function(e,t,n){var s,i,a,o;for(a=0,i=0,o=(e=""+e).length;0<=o?i<o:i>o;i=0<=o?++i:--i)s=e.charCodeAt(i),a+=this.widthOfGlyph(this.characterToGlyph(s))+n*(1e3/t)||0;return a*(t/1e3)},r.prototype.lineHeight=function(e,t){var n;return t==null&&(t=!1),n=t?this.lineGap:0,(this.ascender+n-this.decender)/1e3*e},r})();var Co,wA=(function(){function r(e){this.data=e??[],this.pos=0,this.length=this.data.length}return r.prototype.readByte=function(){return this.data[this.pos++]},r.prototype.writeByte=function(e){return this.data[this.pos++]=e},r.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},r.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},r.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},r.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},r.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},r.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},r.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},r.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},r.prototype.readString=function(e){var t,n;for(n=[],t=0;0<=e?t<e:t>e;t=0<=e?++t:--t)n[t]=String.fromCharCode(this.readByte());return n.join("")},r.prototype.writeString=function(e){var t,n,s;for(s=[],t=0,n=e.length;0<=n?t<n:t>n;t=0<=n?++t:--t)s.push(this.writeByte(e.charCodeAt(t)));return s},r.prototype.readShort=function(){return this.readInt16()},r.prototype.writeShort=function(e){return this.writeInt16(e)},r.prototype.readLongLong=function(){var e,t,n,s,i,a,o,l;return e=this.readByte(),t=this.readByte(),n=this.readByte(),s=this.readByte(),i=this.readByte(),a=this.readByte(),o=this.readByte(),l=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^t)+1099511627776*(255^n)+4294967296*(255^s)+16777216*(255^i)+65536*(255^a)+256*(255^o)+(255^l)+1):72057594037927940*e+281474976710656*t+1099511627776*n+4294967296*s+16777216*i+65536*a+256*o+l},r.prototype.writeLongLong=function(e){var t,n;return t=Math.floor(e/4294967296),n=4294967295&e,this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},r.prototype.readInt=function(){return this.readInt32()},r.prototype.writeInt=function(e){return this.writeInt32(e)},r.prototype.read=function(e){var t,n;for(t=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)t.push(this.readByte());return t},r.prototype.write=function(e){var t,n,s,i;for(i=[],n=0,s=e.length;n<s;n++)t=e[n],i.push(this.writeByte(t));return i},r})(),SW=(function(){var r;function e(t){var n,s,i;for(this.scalarType=t.readInt(),this.tableCount=t.readShort(),this.searchRange=t.readShort(),this.entrySelector=t.readShort(),this.rangeShift=t.readShort(),this.tables={},s=0,i=this.tableCount;0<=i?s<i:s>i;s=0<=i?++s:--s)n={tag:t.readString(4),checksum:t.readInt(),offset:t.readInt(),length:t.readInt()},this.tables[n.tag]=n}return e.prototype.encode=function(t){var n,s,i,a,o,l,c,A,d,h,u,p,f;for(f in u=Object.keys(t).length,l=Math.log(2),d=16*Math.floor(Math.log(u)/l),a=Math.floor(d/l),A=16*u-d,(s=new wA).writeInt(this.scalarType),s.writeShort(u),s.writeShort(d),s.writeShort(a),s.writeShort(A),i=16*u,c=s.pos+i,o=null,p=[],t)for(h=t[f],s.writeString(f),s.writeInt(r(h)),s.writeInt(c),s.writeInt(h.length),p=p.concat(h),f==="head"&&(o=c),c+=h.length;c%4;)p.push(0),c++;return s.write(p),n=2981146554-r(s.data),s.pos=o+8,s.writeUInt32(n),s.data},r=function(t){var n,s,i,a;for(t=qF.call(t);t.length%4;)t.push(0);for(i=new wA(t),s=0,n=0,a=t.length;n<a;n=n+=4)s+=i.readUInt32();return 4294967295&s},e})(),kW={}.hasOwnProperty,fl=function(r,e){for(var t in e)kW.call(e,t)&&(r[t]=e[t]);function n(){this.constructor=r}return n.prototype=e.prototype,r.prototype=new n,r.__super__=e.prototype,r};Co=(function(){function r(e){var t;this.file=e,t=this.file.directory.tables[this.tag],this.exists=!!t,t&&(this.offset=t.offset,this.length=t.length,this.parse(this.file.contents))}return r.prototype.parse=function(){},r.prototype.encode=function(){},r.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},r})();var EW=(function(){function r(){return r.__super__.constructor.apply(this,arguments)}return fl(r,Co),r.prototype.tag="head",r.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},r.prototype.encode=function(e){var t;return(t=new wA).writeInt(this.version),t.writeInt(this.revision),t.writeInt(this.checkSumAdjustment),t.writeInt(this.magicNumber),t.writeShort(this.flags),t.writeShort(this.unitsPerEm),t.writeLongLong(this.created),t.writeLongLong(this.modified),t.writeShort(this.xMin),t.writeShort(this.yMin),t.writeShort(this.xMax),t.writeShort(this.yMax),t.writeShort(this.macStyle),t.writeShort(this.lowestRecPPEM),t.writeShort(this.fontDirectionHint),t.writeShort(e),t.writeShort(this.glyphDataFormat),t.data},r})(),tk=(function(){function r(e,t){var n,s,i,a,o,l,c,A,d,h,u,p,f,g,m,x,S;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=t+e.readInt(),d=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(l=0;l<256;++l)this.codeMap[l]=e.readByte();break;case 4:for(u=e.readUInt16(),h=u/2,e.pos+=6,i=(function(){var B,F;for(F=[],l=B=0;0<=h?B<h:B>h;l=0<=h?++B:--B)F.push(e.readUInt16());return F})(),e.pos+=2,f=(function(){var B,F;for(F=[],l=B=0;0<=h?B<h:B>h;l=0<=h?++B:--B)F.push(e.readUInt16());return F})(),c=(function(){var B,F;for(F=[],l=B=0;0<=h?B<h:B>h;l=0<=h?++B:--B)F.push(e.readUInt16());return F})(),A=(function(){var B,F;for(F=[],l=B=0;0<=h?B<h:B>h;l=0<=h?++B:--B)F.push(e.readUInt16());return F})(),s=(this.length-e.pos+this.offset)/2,o=(function(){var B,F;for(F=[],l=B=0;0<=s?B<s:B>s;l=0<=s?++B:--B)F.push(e.readUInt16());return F})(),l=m=0,S=i.length;m<S;l=++m)for(g=i[l],n=x=p=f[l];p<=g?x<=g:x>=g;n=p<=g?++x:--x)A[l]===0?a=n+c[l]:(a=o[A[l]/2+(n-p)-(h-l)]||0)!==0&&(a+=c[l]),this.codeMap[n]=65535&a}e.pos=d}return r.encode=function(e,t){var n,s,i,a,o,l,c,A,d,h,u,p,f,g,m,x,S,B,F,N,E,w,v,I,k,_,T,L,K,se,X,$,V,he,z,M,O,H,J,de,ie,le,fe,ve,Ce,Be;switch(L=new wA,a=Object.keys(e).sort(function(Qe,D){return Qe-D}),t){case"macroman":for(f=0,g=(function(){var Qe=[];for(p=0;p<256;++p)Qe.push(0);return Qe})(),x={0:0},i={},K=0,V=a.length;K<V;K++)x[fe=e[s=a[K]]]==null&&(x[fe]=++f),i[s]={old:e[s],new:x[e[s]]},g[s]=x[e[s]];return L.writeUInt16(1),L.writeUInt16(0),L.writeUInt32(12),L.writeUInt16(0),L.writeUInt16(262),L.writeUInt16(0),L.write(g),{charMap:i,subtable:L.data,maxGlyphID:f+1};case"unicode":for(_=[],d=[],S=0,x={},n={},m=c=null,se=0,he=a.length;se<he;se++)x[F=e[s=a[se]]]==null&&(x[F]=++S),n[s]={old:F,new:x[F]},o=x[F]-s,m!=null&&o===c||(m&&d.push(m),_.push(s),c=o),m=s;for(m&&d.push(m),d.push(65535),_.push(65535),I=2*(v=_.length),w=2*Math.pow(Math.log(v)/Math.LN2,2),h=Math.log(w/2)/Math.LN2,E=2*v-w,l=[],N=[],u=[],p=X=0,z=_.length;X<z;p=++X){if(k=_[p],A=d[p],k===65535){l.push(0),N.push(0);break}if(k-(T=n[k].new)>=32768)for(l.push(0),N.push(2*(u.length+v-p)),s=$=k;k<=A?$<=A:$>=A;s=k<=A?++$:--$)u.push(n[s].new);else l.push(T-k),N.push(0)}for(L.writeUInt16(3),L.writeUInt16(1),L.writeUInt32(12),L.writeUInt16(4),L.writeUInt16(16+8*v+2*u.length),L.writeUInt16(0),L.writeUInt16(I),L.writeUInt16(w),L.writeUInt16(h),L.writeUInt16(E),ie=0,M=d.length;ie<M;ie++)s=d[ie],L.writeUInt16(s);for(L.writeUInt16(0),le=0,O=_.length;le<O;le++)s=_[le],L.writeUInt16(s);for(ve=0,H=l.length;ve<H;ve++)o=l[ve],L.writeUInt16(o);for(Ce=0,J=N.length;Ce<J;Ce++)B=N[Ce],L.writeUInt16(B);for(Be=0,de=u.length;Be<de;Be++)f=u[Be],L.writeUInt16(f);return{charMap:n,subtable:L.data,maxGlyphID:S+1}}},r})(),KF=(function(){function r(){return r.__super__.constructor.apply(this,arguments)}return fl(r,Co),r.prototype.tag="cmap",r.prototype.parse=function(e){var t,n,s;for(e.pos=this.offset,this.version=e.readUInt16(),s=e.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=s?n<s:n>s;n=0<=s?++n:--n)t=new tk(e,this.offset),this.tables.push(t),t.isUnicode&&this.unicode==null&&(this.unicode=t);return!0},r.encode=function(e,t){var n,s;return t==null&&(t="macroman"),n=tk.encode(e,t),(s=new wA).writeUInt16(0),s.writeUInt16(1),n.table=s.data.concat(n.subtable),n},r})(),IW=(function(){function r(){return r.__super__.constructor.apply(this,arguments)}return fl(r,Co),r.prototype.tag="hhea",r.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},r})(),TW=(function(){function r(){return r.__super__.constructor.apply(this,arguments)}return fl(r,Co),r.prototype.tag="OS/2",r.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=(function(){var t,n;for(n=[],t=0;t<10;++t)n.push(e.readByte());return n})(),this.charRange=(function(){var t,n;for(n=[],t=0;t<4;++t)n.push(e.readInt());return n})(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=(function(){var t,n;for(n=[],t=0;t<2;t=++t)n.push(e.readInt());return n})(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},r})(),FW=(function(){function r(){return r.__super__.constructor.apply(this,arguments)}return fl(r,Co),r.prototype.tag="post",r.prototype.parse=function(e){var t,n,s;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var i;for(n=e.readUInt16(),this.glyphNameIndex=[],i=0;0<=n?i<n:i>n;i=0<=n?++i:--i)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],s=[];e.pos<this.offset+this.length;)t=e.readByte(),s.push(this.names.push(e.readString(t)));return s;case 151552:return n=e.readUInt16(),this.offsets=e.read(n);case 262144:return this.map=(function(){var a,o,l;for(l=[],i=a=0,o=this.file.maxp.numGlyphs;0<=o?a<o:a>o;i=0<=o?++a:--a)l.push(e.readUInt32());return l}).call(this)}},r})(),LW=function(r,e){this.raw=r,this.length=r.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},UW=(function(){function r(){return r.__super__.constructor.apply(this,arguments)}return fl(r,Co),r.prototype.tag="name",r.prototype.parse=function(e){var t,n,s,i,a,o,l,c,A,d,h;for(e.pos=this.offset,e.readShort(),t=e.readShort(),o=e.readShort(),n=[],i=0;0<=t?i<t:i>t;i=0<=t?++i:--i)n.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+o+e.readShort()});for(l={},i=A=0,d=n.length;A<d;i=++A)s=n[i],e.pos=s.offset,c=e.readString(s.length),a=new LW(c,s),l[h=s.nameID]==null&&(l[h]=[]),l[s.nameID].push(a);this.strings=l,this.copyright=l[0],this.fontFamily=l[1],this.fontSubfamily=l[2],this.uniqueSubfamily=l[3],this.fontName=l[4],this.version=l[5];try{this.postscriptName=l[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=l[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=l[7],this.manufacturer=l[8],this.designer=l[9],this.description=l[10],this.vendorUrl=l[11],this.designerUrl=l[12],this.license=l[13],this.licenseUrl=l[14],this.preferredFamily=l[15],this.preferredSubfamily=l[17],this.compatibleFull=l[18],this.sampleText=l[19]},r})(),MW=(function(){function r(){return r.__super__.constructor.apply(this,arguments)}return fl(r,Co),r.prototype.tag="maxp",r.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},r})(),NW=(function(){function r(){return r.__super__.constructor.apply(this,arguments)}return fl(r,Co),r.prototype.tag="hmtx",r.prototype.parse=function(e){var t,n,s,i,a,o,l;for(e.pos=this.offset,this.metrics=[],t=0,o=this.file.hhea.numberOfMetrics;0<=o?t<o:t>o;t=0<=o?++t:--t)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(s=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var c,A;for(A=[],t=c=0;0<=s?c<s:c>s;t=0<=s?++c:--c)A.push(e.readInt16());return A})(),this.widths=(function(){var c,A,d,h;for(h=[],c=0,A=(d=this.metrics).length;c<A;c++)i=d[c],h.push(i.advance);return h}).call(this),n=this.widths[this.widths.length-1],l=[],t=a=0;0<=s?a<s:a>s;t=0<=s?++a:--a)l.push(this.widths.push(n));return l},r.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},r})(),qF=[].slice,PW=(function(){function r(){return r.__super__.constructor.apply(this,arguments)}return fl(r,Co),r.prototype.tag="glyf",r.prototype.parse=function(){return this.cache={}},r.prototype.glyphFor=function(e){var t,n,s,i,a,o,l,c,A,d;return e in this.cache?this.cache[e]:(i=this.file.loca,t=this.file.contents,n=i.indexOf(e),(s=i.lengthOf(e))===0?this.cache[e]=null:(t.pos=this.offset+n,a=(o=new wA(t.read(s))).readShort(),c=o.readShort(),d=o.readShort(),l=o.readShort(),A=o.readShort(),this.cache[e]=a===-1?new RW(o,c,d,l,A):new DW(o,a,c,d,l,A),this.cache[e]))},r.prototype.encode=function(e,t,n){var s,i,a,o,l;for(a=[],i=[],o=0,l=t.length;o<l;o++)s=e[t[o]],i.push(a.length),s&&(a=a.concat(s.encode(n)));return i.push(a.length),{table:a,offsets:i}},r})(),DW=(function(){function r(e,t,n,s,i,a){this.raw=e,this.numberOfContours=t,this.xMin=n,this.yMin=s,this.xMax=i,this.yMax=a,this.compound=!1}return r.prototype.encode=function(){return this.raw.data},r})(),RW=(function(){function r(e,t,n,s,i){var a,o;for(this.raw=e,this.xMin=t,this.yMin=n,this.xMax=s,this.yMax=i,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],a=this.raw;o=a.readShort(),this.glyphOffsets.push(a.pos),this.glyphIDs.push(a.readUInt16()),32&o;)a.pos+=1&o?4:2,128&o?a.pos+=8:64&o?a.pos+=4:8&o&&(a.pos+=2)}return r.prototype.encode=function(){var e,t,n;for(t=new wA(qF.call(this.raw.data)),e=0,n=this.glyphIDs.length;e<n;++e)t.pos=this.glyphOffsets[e];return t.data},r})(),OW=(function(){function r(){return r.__super__.constructor.apply(this,arguments)}return fl(r,Co),r.prototype.tag="loca",r.prototype.parse=function(e){var t,n;return e.pos=this.offset,t=this.file.head.indexToLocFormat,this.offsets=t===0?(function(){var s,i;for(i=[],n=0,s=this.length;n<s;n+=2)i.push(2*e.readUInt16());return i}).call(this):(function(){var s,i;for(i=[],n=0,s=this.length;n<s;n+=4)i.push(e.readUInt32());return i}).call(this)},r.prototype.indexOf=function(e){return this.offsets[e]},r.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},r.prototype.encode=function(e,t){for(var n=new Uint32Array(this.offsets.length),s=0,i=0,a=0;a<n.length;++a)if(n[a]=s,i<t.length&&t[i]==a){++i,n[a]=s;var o=this.offsets[a],l=this.offsets[a+1]-o;l>0&&(s+=l)}for(var c=new Array(4*n.length),A=0;A<n.length;++A)c[4*A+3]=255&n[A],c[4*A+2]=(65280&n[A])>>8,c[4*A+1]=(16711680&n[A])>>16,c[4*A]=(4278190080&n[A])>>24;return c},r})(),QW=(function(){function r(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return r.prototype.generateCmap=function(){var e,t,n,s,i;for(t in s=this.font.cmap.tables[0].codeMap,e={},i=this.subset)n=i[t],e[t]=s[n];return e},r.prototype.glyphsFor=function(e){var t,n,s,i,a,o,l;for(s={},a=0,o=e.length;a<o;a++)s[i=e[a]]=this.font.glyf.glyphFor(i);for(i in t=[],s)(n=s[i])!=null&&n.compound&&t.push.apply(t,n.glyphIDs);if(t.length>0)for(i in l=this.glyphsFor(t))n=l[i],s[i]=n;return s},r.prototype.encode=function(e,t){var n,s,i,a,o,l,c,A,d,h,u,p,f,g,m;for(s in n=KF.encode(this.generateCmap(),"unicode"),a=this.glyphsFor(e),u={0:0},m=n.charMap)u[(l=m[s]).old]=l.new;for(p in h=n.maxGlyphID,a)p in u||(u[p]=h++);return A=(function(x){var S,B;for(S in B={},x)B[x[S]]=S;return B})(u),d=Object.keys(A).sort(function(x,S){return x-S}),f=(function(){var x,S,B;for(B=[],x=0,S=d.length;x<S;x++)o=d[x],B.push(A[o]);return B})(),i=this.font.glyf.encode(a,f,u),c=this.font.loca.encode(i.offsets,f),g={cmap:this.font.cmap.raw(),glyf:i.table,loca:c,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(t)},this.font.os2.exists&&(g["OS/2"]=this.font.os2.raw()),this.font.directory.encode(g)},r})();kt.API.PDFObject=(function(){var r;function e(){}return r=function(t,n){return(Array(n+1).join("0")+t).slice(-n)},e.convert=function(t){var n,s,i,a;if(Array.isArray(t))return"["+(function(){var o,l,c;for(c=[],o=0,l=t.length;o<l;o++)n=t[o],c.push(e.convert(n));return c})().join(" ")+"]";if(typeof t=="string")return"/"+t;if(t!=null&&t.isString)return"("+t+")";if(t instanceof Date)return"(D:"+r(t.getUTCFullYear(),4)+r(t.getUTCMonth(),2)+r(t.getUTCDate(),2)+r(t.getUTCHours(),2)+r(t.getUTCMinutes(),2)+r(t.getUTCSeconds(),2)+"Z)";if({}.toString.call(t)==="[object Object]"){for(s in i=["<<"],t)a=t[s],i.push("/"+s+" "+e.convert(a));return i.push(">>"),i.join(`
`)}return""+t},e})();function WF(r,e,t,n,s){n=n||{};var i=1.15,a=s.internal.scaleFactor,o=s.internal.getFontSize()/a,l=s.getLineHeightFactor?s.getLineHeightFactor():i,c=o*l,A=/\r\n|\r|\n/g,d="",h=1;if((n.valign==="middle"||n.valign==="bottom"||n.halign==="center"||n.halign==="right")&&(d=typeof r=="string"?r.split(A):r,h=d.length||1),t+=o*(2-i),n.valign==="middle"?t-=h/2*c:n.valign==="bottom"&&(t-=h*c),n.halign==="center"||n.halign==="right"){var u=o;if(n.halign==="center"&&(u*=.5),d&&h>=1){for(var p=0;p<d.length;p++)s.text(d[p],e-s.getStringUnitWidth(d[p])*u,t),t+=c;return s}e-=s.getStringUnitWidth(r)*u}return n.halign==="justify"?s.text(r,e,t,{maxWidth:n.maxWidth||100,align:"justify"}):s.text(r,e,t),s}var rk={},zu=(function(){function r(e){this.jsPDFDocument=e,this.userStyles={textColor:e.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:e.internal.getFontSize(),fontStyle:e.internal.getFont().fontStyle,font:e.internal.getFont().fontName,lineWidth:e.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:e.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return r.setDefaults=function(e,t){t===void 0&&(t=null),t?t.__autoTableDocumentDefaults=e:rk=e},r.unifyColor=function(e){return Array.isArray(e)?e:typeof e=="number"?[e,e,e]:typeof e=="string"?[e]:null},r.prototype.applyStyles=function(e,t){var n,s,i;t===void 0&&(t=!1),e.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(e.fontStyle);var a=this.jsPDFDocument.internal.getFont(),o=a.fontStyle,l=a.fontName;if(e.font&&(l=e.font),e.fontStyle){o=e.fontStyle;var c=this.getFontList()[l];c&&c.indexOf(o)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(c[0]),o=c[0])}if(this.jsPDFDocument.setFont(l,o),e.fontSize&&this.jsPDFDocument.setFontSize(e.fontSize),!t){var A=r.unifyColor(e.fillColor);A&&(n=this.jsPDFDocument).setFillColor.apply(n,A),A=r.unifyColor(e.textColor),A&&(s=this.jsPDFDocument).setTextColor.apply(s,A),A=r.unifyColor(e.lineColor),A&&(i=this.jsPDFDocument).setDrawColor.apply(i,A),typeof e.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(e.lineWidth)}},r.prototype.splitTextToSize=function(e,t,n){return this.jsPDFDocument.splitTextToSize(e,t,n)},r.prototype.rect=function(e,t,n,s,i){return this.jsPDFDocument.rect(e,t,n,s,i)},r.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},r.prototype.getTextWidth=function(e){return this.jsPDFDocument.getTextWidth(e)},r.prototype.getDocument=function(){return this.jsPDFDocument},r.prototype.setPage=function(e){this.jsPDFDocument.setPage(e)},r.prototype.addPage=function(){return this.jsPDFDocument.addPage()},r.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},r.prototype.getGlobalOptions=function(){return rk||{}},r.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},r.prototype.pageSize=function(){var e=this.jsPDFDocument.internal.pageSize;return e.width==null&&(e={width:e.getWidth(),height:e.getHeight()}),e},r.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},r.prototype.getLineHeightFactor=function(){var e=this.jsPDFDocument;return e.getLineHeightFactor?e.getLineHeightFactor():1.15},r.prototype.getLineHeight=function(e){return e/this.scaleFactor()*this.getLineHeightFactor()},r.prototype.pageNumber=function(){var e=this.jsPDFDocument.internal.getCurrentPageInfo();return e?e.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},r})(),E1=function(r,e){return E1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])},E1(r,e)};function YF(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");E1(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var XF=(function(r){YF(e,r);function e(t){var n=r.call(this)||this;return n._element=t,n}return e})(Array);function HW(r){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/r,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function jW(r){var e={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return e[r]}function tb(r,e,t){t.applyStyles(e,!0);var n=Array.isArray(r)?r:[r],s=n.map(function(i){return t.getTextWidth(i)}).reduce(function(i,a){return Math.max(i,a)},0);return s}function JF(r,e,t,n){var s=e.settings.tableLineWidth,i=e.settings.tableLineColor;r.applyStyles({lineWidth:s,lineColor:i});var a=ZF(s,!1);a&&r.rect(t.x,t.y,e.getWidth(r.pageSize().width),n.y-t.y,a)}function ZF(r,e){var t=r>0,n=e||e===0;return t&&n?"DF":t?"S":n?"F":null}function qb(r,e){var t,n,s,i;if(r=r||e,Array.isArray(r)){if(r.length>=4)return{top:r[0],right:r[1],bottom:r[2],left:r[3]};if(r.length===3)return{top:r[0],right:r[1],bottom:r[2],left:r[1]};if(r.length===2)return{top:r[0],right:r[1],bottom:r[0],left:r[1]};r.length===1?r=r[0]:r=e}return typeof r=="object"?(typeof r.vertical=="number"&&(r.top=r.vertical,r.bottom=r.vertical),typeof r.horizontal=="number"&&(r.right=r.horizontal,r.left=r.horizontal),{left:(t=r.left)!==null&&t!==void 0?t:e,top:(n=r.top)!==null&&n!==void 0?n:e,right:(s=r.right)!==null&&s!==void 0?s:e,bottom:(i=r.bottom)!==null&&i!==void 0?i:e}):(typeof r!="number"&&(r=e),{top:r,right:r,bottom:r,left:r})}function e3(r,e){var t=qb(e.settings.margin,0);return r.pageSize().width-(t.left+t.right)}function VW(r,e,t,n,s){var i={},a=1.3333333333333333,o=qw(e,function(S){return s.getComputedStyle(S).backgroundColor});o!=null&&(i.fillColor=o);var l=qw(e,function(S){return s.getComputedStyle(S).color});l!=null&&(i.textColor=l);var c=GW(n,t);c&&(i.cellPadding=c);var A="borderTopColor",d=a*t,h=n.borderTopWidth;if(n.borderBottomWidth===h&&n.borderRightWidth===h&&n.borderLeftWidth===h){var u=(parseFloat(h)||0)/d;u&&(i.lineWidth=u)}else i.lineWidth={top:(parseFloat(n.borderTopWidth)||0)/d,right:(parseFloat(n.borderRightWidth)||0)/d,bottom:(parseFloat(n.borderBottomWidth)||0)/d,left:(parseFloat(n.borderLeftWidth)||0)/d},i.lineWidth.top||(i.lineWidth.right?A="borderRightColor":i.lineWidth.bottom?A="borderBottomColor":i.lineWidth.left&&(A="borderLeftColor"));var p=qw(e,function(S){return s.getComputedStyle(S)[A]});p!=null&&(i.lineColor=p);var f=["left","right","center","justify"];f.indexOf(n.textAlign)!==-1&&(i.halign=n.textAlign),f=["middle","bottom","top"],f.indexOf(n.verticalAlign)!==-1&&(i.valign=n.verticalAlign);var g=parseInt(n.fontSize||"");isNaN(g)||(i.fontSize=g/a);var m=$W(n);m&&(i.fontStyle=m);var x=(n.fontFamily||"").toLowerCase();return r.indexOf(x)!==-1&&(i.font=x),i}function $W(r){var e="";return(r.fontWeight==="bold"||r.fontWeight==="bolder"||parseInt(r.fontWeight)>=700)&&(e="bold"),(r.fontStyle==="italic"||r.fontStyle==="oblique")&&(e+="italic"),e}function qw(r,e){var t=t3(r,e);if(!t)return null;var n=t.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!n||!Array.isArray(n))return null;var s=[parseInt(n[1]),parseInt(n[2]),parseInt(n[3])],i=parseInt(n[4]);return i===0||isNaN(s[0])||isNaN(s[1])||isNaN(s[2])?null:s}function t3(r,e){var t=e(r);return t==="rgba(0, 0, 0, 0)"||t==="transparent"||t==="initial"||t==="inherit"?r.parentElement==null?null:t3(r.parentElement,e):t}function GW(r,e){var t=[r.paddingTop,r.paddingRight,r.paddingBottom,r.paddingLeft],n=96/(72/e),s=(parseInt(r.lineHeight)-parseInt(r.fontSize))/e/2,i=t.map(function(o){return parseInt(o||"0")/n}),a=qb(i,0);return s>a.top&&(a.top=s),s>a.bottom&&(a.bottom=s),a}function r3(r,e,t,n,s){var i,a;n===void 0&&(n=!1),s===void 0&&(s=!1);var o;typeof e=="string"?o=t.document.querySelector(e):o=e;var l=Object.keys(r.getFontList()),c=r.scaleFactor(),A=[],d=[],h=[];if(!o)return console.error("Html table could not be found with input: ",e),{head:A,body:d,foot:h};for(var u=0;u<o.rows.length;u++){var p=o.rows[u],f=(a=(i=p==null?void 0:p.parentElement)===null||i===void 0?void 0:i.tagName)===null||a===void 0?void 0:a.toLowerCase(),g=zW(l,c,t,p,n,s);g&&(f==="thead"?A.push(g):f==="tfoot"?h.push(g):d.push(g))}return{head:A,body:d,foot:h}}function zW(r,e,t,n,s,i){for(var a=new XF(n),o=0;o<n.cells.length;o++){var l=n.cells[o],c=t.getComputedStyle(l);if(s||c.display!=="none"){var A=void 0;i&&(A=VW(r,l,e,c,t)),a.push({rowSpan:l.rowSpan,colSpan:l.colSpan,styles:A,_element:l,content:KW(l)})}}var d=t.getComputedStyle(n);if(a.length>0&&(s||d.display!=="none"))return a}function KW(r){var e=r.cloneNode(!0);return e.innerHTML=e.innerHTML.replace(/\n/g,"").replace(/ +/g," "),e.innerHTML=e.innerHTML.split(/<br.*?>/).map(function(t){return t.trim()}).join(`
`),e.innerText||e.textContent||""}function qW(r,e,t){for(var n=0,s=[r,e,t];n<s.length;n++){var i=s[n];i&&typeof i!="object"&&console.error("The options parameter should be of type object, is: "+typeof i),i.startY&&typeof i.startY!="number"&&(console.error("Invalid value for startY option",i.startY),delete i.startY)}}function Vl(r,e,t,n,s){if(r==null)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(r),a=1;a<arguments.length;a++){var o=arguments[a];if(o!=null)for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(i[l]=o[l])}return i}function n3(r,e){var t=new zu(r),n=t.getDocumentOptions(),s=t.getGlobalOptions();qW(s,n,e);var i=Vl({},s,n,e),a;typeof window<"u"&&(a=window);var o=WW(s,n,e),l=YW(s,n,e),c=XW(t,i),A=ZW(t,i,a);return{id:e.tableId,content:A,hooks:l,styles:o,settings:c}}function WW(r,e,t){for(var n={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},s=function(l){if(l==="columnStyles"){var c=r[l],A=e[l],d=t[l];n.columnStyles=Vl({},c,A,d)}else{var h=[r,e,t],u=h.map(function(p){return p[l]||{}});n[l]=Vl({},u[0],u[1],u[2])}},i=0,a=Object.keys(n);i<a.length;i++){var o=a[i];s(o)}return n}function YW(r,e,t){for(var n=[r,e,t],s={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},i=0,a=n;i<a.length;i++){var o=a[i];o.didParseCell&&s.didParseCell.push(o.didParseCell),o.willDrawCell&&s.willDrawCell.push(o.willDrawCell),o.didDrawCell&&s.didDrawCell.push(o.didDrawCell),o.willDrawPage&&s.willDrawPage.push(o.willDrawPage),o.didDrawPage&&s.didDrawPage.push(o.didDrawPage)}return s}function XW(r,e){var t,n,s,i,a,o,l,c,A,d,h,u,p=qb(e.margin,40/r.scaleFactor()),f=(t=JW(r,e.startY))!==null&&t!==void 0?t:p.top,g;e.showFoot===!0?g="everyPage":e.showFoot===!1?g="never":g=(n=e.showFoot)!==null&&n!==void 0?n:"everyPage";var m;e.showHead===!0?m="everyPage":e.showHead===!1?m="never":m=(s=e.showHead)!==null&&s!==void 0?s:"everyPage";var x=(i=e.useCss)!==null&&i!==void 0?i:!1,S=e.theme||(x?"plain":"striped"),B=!!e.horizontalPageBreak,F=(a=e.horizontalPageBreakRepeat)!==null&&a!==void 0?a:null;return{includeHiddenHtml:(o=e.includeHiddenHtml)!==null&&o!==void 0?o:!1,useCss:x,theme:S,startY:f,margin:p,pageBreak:(l=e.pageBreak)!==null&&l!==void 0?l:"auto",rowPageBreak:(c=e.rowPageBreak)!==null&&c!==void 0?c:"auto",tableWidth:(A=e.tableWidth)!==null&&A!==void 0?A:"auto",showHead:m,showFoot:g,tableLineWidth:(d=e.tableLineWidth)!==null&&d!==void 0?d:0,tableLineColor:(h=e.tableLineColor)!==null&&h!==void 0?h:200,horizontalPageBreak:B,horizontalPageBreakRepeat:F,horizontalPageBreakBehaviour:(u=e.horizontalPageBreakBehaviour)!==null&&u!==void 0?u:"afterAllRows"}}function JW(r,e){var t=r.getLastAutoTable(),n=r.scaleFactor(),s=r.pageNumber(),i=!1;if(t&&t.startPageNumber){var a=t.startPageNumber+t.pageNumber-1;i=a===s}return typeof e=="number"?e:(e==null||e===!1)&&i&&(t==null?void 0:t.finalY)!=null?t.finalY+20/n:null}function ZW(r,e,t){var n=e.head||[],s=e.body||[],i=e.foot||[];if(e.html){var a=e.includeHiddenHtml;if(t){var o=r3(r,e.html,t,a,e.useCss)||{};n=o.head||n,s=o.body||n,i=o.foot||n}else console.error("Cannot parse html in non browser environment")}var l=e.columns||eY(n,s,i);return{columns:l,head:n,body:s,foot:i}}function eY(r,e,t){var n=r[0]||e[0]||t[0]||[],s=[];return Object.keys(n).filter(function(i){return i!=="_element"}).forEach(function(i){var a=1,o;Array.isArray(n)?o=n[parseInt(i)]:o=n[i],typeof o=="object"&&!Array.isArray(o)&&(a=(o==null?void 0:o.colSpan)||1);for(var l=0;l<a;l++){var c=void 0;Array.isArray(n)?c=s.length:c=i+(l>0?"_".concat(l):"");var A={dataKey:c};s.push(A)}}),s}var I1=(function(){function r(e,t,n){this.table=t,this.pageNumber=t.pageNumber,this.settings=t.settings,this.cursor=n,this.doc=e.getDocument()}return r})(),tY=(function(r){YF(e,r);function e(t,n,s,i,a,o){var l=r.call(this,t,n,o)||this;return l.cell=s,l.row=i,l.column=a,l.section=i.section,l}return e})(I1),rY=(function(){function r(e,t){this.pageNumber=1,this.id=e.id,this.settings=e.settings,this.styles=e.styles,this.hooks=e.hooks,this.columns=t.columns,this.head=t.head,this.body=t.body,this.foot=t.foot}return r.prototype.getHeadHeight=function(e){return this.head.reduce(function(t,n){return t+n.getMaxCellHeight(e)},0)},r.prototype.getFootHeight=function(e){return this.foot.reduce(function(t,n){return t+n.getMaxCellHeight(e)},0)},r.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},r.prototype.callCellHooks=function(e,t,n,s,i,a){for(var o=0,l=t;o<l.length;o++){var c=l[o],A=new tY(e,this,n,s,i,a),d=c(A)===!1;if(n.text=Array.isArray(n.text)?n.text:[n.text],d)return!1}return!0},r.prototype.callEndPageHooks=function(e,t){e.applyStyles(e.userStyles);for(var n=0,s=this.hooks.didDrawPage;n<s.length;n++){var i=s[n];i(new I1(e,this,t))}},r.prototype.callWillDrawPageHooks=function(e,t){for(var n=0,s=this.hooks.willDrawPage;n<s.length;n++){var i=s[n];i(new I1(e,this,t))}},r.prototype.getWidth=function(e){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var t=this.columns.reduce(function(s,i){return s+i.wrappedWidth},0);return t}else{var n=this.settings.margin;return e-n.left-n.right}},r})(),s3=(function(){function r(e,t,n,s,i){i===void 0&&(i=!1),this.height=0,this.raw=e,e instanceof XF&&(this.raw=e._element,this.element=e._element),this.index=t,this.section=n,this.cells=s,this.spansMultiplePages=i}return r.prototype.getMaxCellHeight=function(e){var t=this;return e.reduce(function(n,s){var i;return Math.max(n,((i=t.cells[s.index])===null||i===void 0?void 0:i.height)||0)},0)},r.prototype.hasRowSpan=function(e){var t=this;return e.filter(function(n){var s=t.cells[n.index];return s?s.rowSpan>1:!1}).length>0},r.prototype.canEntireRowFit=function(e,t){return this.getMaxCellHeight(t)<=e},r.prototype.getMinimumRowHeight=function(e,t){var n=this;return e.reduce(function(s,i){var a=n.cells[i.index];if(!a)return 0;var o=t.getLineHeight(a.styles.fontSize),l=a.padding("vertical"),c=l+o;return c>s?c:s},0)},r})(),i3=(function(){function r(e,t,n){var s;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=t,this.section=n,this.raw=e;var i=e;e!=null&&typeof e=="object"&&!Array.isArray(e)?(this.rowSpan=e.rowSpan||1,this.colSpan=e.colSpan||1,i=(s=e.content)!==null&&s!==void 0?s:e,e._element&&(this.raw=e._element)):(this.rowSpan=1,this.colSpan=1);var a=i!=null?""+i:"",o=/\r\n|\r|\n/g;this.text=a.split(o)}return r.prototype.getTextPos=function(){var e;if(this.styles.valign==="top")e=this.y+this.padding("top");else if(this.styles.valign==="bottom")e=this.y+this.height-this.padding("bottom");else{var t=this.height-this.padding("vertical");e=this.y+t/2+this.padding("top")}var n;if(this.styles.halign==="right")n=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var s=this.width-this.padding("horizontal");n=this.x+s/2+this.padding("left")}else n=this.x+this.padding("left");return{x:n,y:e}},r.prototype.getContentHeight=function(e,t){t===void 0&&(t=1.15);var n=Array.isArray(this.text)?this.text.length:1,s=this.styles.fontSize/e*t,i=n*s+this.padding("vertical");return Math.max(i,this.styles.minCellHeight)},r.prototype.padding=function(e){var t=qb(this.styles.cellPadding,0);return e==="vertical"?t.top+t.bottom:e==="horizontal"?t.left+t.right:t[e]},r})(),nY=(function(){function r(e,t,n){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=e,this.raw=t,this.index=n}return r.prototype.getMaxCustomCellWidth=function(e){for(var t=0,n=0,s=e.allRows();n<s.length;n++){var i=s[n],a=i.cells[this.index];a&&typeof a.styles.cellWidth=="number"&&(t=Math.max(t,a.styles.cellWidth))}return t},r})();function sY(r,e){iY(r,e);var t=[],n=0;e.columns.forEach(function(i){var a=i.getMaxCustomCellWidth(e);a?i.width=a:(i.width=i.wrappedWidth,t.push(i)),n+=i.width});var s=e.getWidth(r.pageSize().width)-n;s&&(s=T1(t,s,function(i){return Math.max(i.minReadableWidth,i.minWidth)})),s&&(s=T1(t,s,function(i){return i.minWidth})),s=Math.abs(s),!e.settings.horizontalPageBreak&&s>.1/r.scaleFactor()&&(s=s<1?s:Math.round(s),console.warn("Of the table content, ".concat(s," units width could not fit page"))),oY(e),lY(e,r),aY(e)}function iY(r,e){var t=r.scaleFactor(),n=e.settings.horizontalPageBreak,s=e3(r,e);e.allRows().forEach(function(i){for(var a=0,o=e.columns;a<o.length;a++){var l=o[a],c=i.cells[l.index];if(c){var A=e.hooks.didParseCell;e.callCellHooks(r,A,c,i,l,null);var d=c.padding("horizontal");c.contentWidth=tb(c.text,c.styles,r)+d;var h=tb(c.text.join(" ").split(/[^\S\u00A0]+/),c.styles,r);if(c.minReadableWidth=h+c.padding("horizontal"),typeof c.styles.cellWidth=="number")c.minWidth=c.styles.cellWidth,c.wrappedWidth=c.styles.cellWidth;else if(c.styles.cellWidth==="wrap"||n===!0)c.contentWidth>s?(c.minWidth=s,c.wrappedWidth=s):(c.minWidth=c.contentWidth,c.wrappedWidth=c.contentWidth);else{var u=10/t;c.minWidth=c.styles.minCellWidth||u,c.wrappedWidth=c.contentWidth,c.minWidth>c.wrappedWidth&&(c.wrappedWidth=c.minWidth)}}}}),e.allRows().forEach(function(i){for(var a=0,o=e.columns;a<o.length;a++){var l=o[a],c=i.cells[l.index];if(c&&c.colSpan===1)l.wrappedWidth=Math.max(l.wrappedWidth,c.wrappedWidth),l.minWidth=Math.max(l.minWidth,c.minWidth),l.minReadableWidth=Math.max(l.minReadableWidth,c.minReadableWidth);else{var A=e.styles.columnStyles[l.dataKey]||e.styles.columnStyles[l.index]||{},d=A.cellWidth||A.minCellWidth;d&&typeof d=="number"&&(l.minWidth=d,l.wrappedWidth=d)}c&&(c.colSpan>1&&!l.minWidth&&(l.minWidth=c.minWidth),c.colSpan>1&&!l.wrappedWidth&&(l.wrappedWidth=c.minWidth))}})}function T1(r,e,t){for(var n=e,s=r.reduce(function(u,p){return u+p.wrappedWidth},0),i=0;i<r.length;i++){var a=r[i],o=a.wrappedWidth/s,l=n*o,c=a.width+l,A=t(a),d=c<A?A:c;e-=d-a.width,a.width=d}if(e=Math.round(e*1e10)/1e10,e){var h=r.filter(function(u){return e<0?u.width>t(u):!0});h.length&&(e=T1(h,e,t))}return e}function aY(r){for(var e={},t=1,n=r.allRows(),s=0;s<n.length;s++)for(var i=n[s],a=0,o=r.columns;a<o.length;a++){var l=o[a],c=e[l.index];if(t>1)t--,delete i.cells[l.index];else if(c)c.cell.height+=i.height,t=c.cell.colSpan,delete i.cells[l.index],c.left--,c.left<=1&&delete e[l.index];else{var A=i.cells[l.index];if(!A)continue;if(A.height=i.height,A.rowSpan>1){var d=n.length-s,h=A.rowSpan>d?d:A.rowSpan;e[l.index]={cell:A,left:h,row:i}}}}}function oY(r){for(var e=r.allRows(),t=0;t<e.length;t++)for(var n=e[t],s=null,i=0,a=0,o=0;o<r.columns.length;o++){var l=r.columns[o];if(a-=1,a>1&&r.columns[o+1])i+=l.width,delete n.cells[l.index];else if(s){var c=s;delete n.cells[l.index],s=null,c.width=l.width+i}else{var c=n.cells[l.index];if(!c)continue;if(a=c.colSpan,i=0,c.colSpan>1){s=c,i+=l.width;continue}c.width=l.width+i}}}function lY(r,e){for(var t={count:0,height:0},n=0,s=r.allRows();n<s.length;n++){for(var i=s[n],a=0,o=r.columns;a<o.length;a++){var l=o[a],c=i.cells[l.index];if(c){e.applyStyles(c.styles,!0);var A=c.width-c.padding("horizontal");if(c.styles.overflow==="linebreak")c.text=e.splitTextToSize(c.text,A+1/e.scaleFactor(),{fontSize:c.styles.fontSize});else if(c.styles.overflow==="ellipsize")c.text=nk(c.text,A,c.styles,e,"...");else if(c.styles.overflow==="hidden")c.text=nk(c.text,A,c.styles,e,"");else if(typeof c.styles.overflow=="function"){var d=c.styles.overflow(c.text,A);typeof d=="string"?c.text=[d]:c.text=d}c.contentHeight=c.getContentHeight(e.scaleFactor(),e.getLineHeightFactor());var h=c.contentHeight/c.rowSpan;c.rowSpan>1&&t.count*t.height<h*c.rowSpan?t={height:h,count:c.rowSpan}:t&&t.count>0&&t.height>h&&(h=t.height),h>i.height&&(i.height=h)}}t.count--}}function nk(r,e,t,n,s){return r.map(function(i){return cY(i,e,t,n,s)})}function cY(r,e,t,n,s){var i=1e4*n.scaleFactor();if(e=Math.ceil(e*i)/i,e>=tb(r,t,n))return r;for(;e<tb(r+s,t,n)&&!(r.length<=1);)r=r.substring(0,r.length-1);return r.trim()+s}function a3(r,e){var t=new zu(r),n=AY(e,t.scaleFactor()),s=new rY(e,n);return sY(t,s),t.applyStyles(t.userStyles),s}function AY(r,e){var t=r.content,n=uY(t.columns);if(t.head.length===0){var s=sk(n,"head");s&&t.head.push(s)}if(t.foot.length===0){var s=sk(n,"foot");s&&t.foot.push(s)}var i=r.settings.theme,a=r.styles;return{columns:n,head:Ww("head",t.head,n,a,i,e),body:Ww("body",t.body,n,a,i,e),foot:Ww("foot",t.foot,n,a,i,e)}}function Ww(r,e,t,n,s,i){var a={},o=e.map(function(l,c){for(var A=0,d={},h=0,u=0,p=0,f=t;p<f.length;p++){var g=f[p];if(a[g.index]==null||a[g.index].left===0)if(u===0){var m=void 0;Array.isArray(l)?m=l[g.index-h-A]:m=l[g.dataKey];var x={};typeof m=="object"&&!Array.isArray(m)&&(x=(m==null?void 0:m.styles)||{});var S=hY(r,g,c,s,n,i,x),B=new i3(m,S,r);d[g.dataKey]=B,d[g.index]=B,u=B.colSpan-1,a[g.index]={left:B.rowSpan-1,times:u}}else u--,h++;else a[g.index].left--,u=a[g.index].times,A++}return new s3(l,c,r,d)});return o}function sk(r,e){var t={};return r.forEach(function(n){if(n.raw!=null){var s=dY(e,n.raw);s!=null&&(t[n.dataKey]=s)}}),Object.keys(t).length>0?t:null}function dY(r,e){if(r==="head"){if(typeof e=="object")return e.header||null;if(typeof e=="string"||typeof e=="number")return e}else if(r==="foot"&&typeof e=="object")return e.footer;return null}function uY(r){return r.map(function(e,t){var n,s;return typeof e=="object"?s=(n=e.dataKey)!==null&&n!==void 0?n:t:s=t,new nY(s,e,t)})}function hY(r,e,t,n,s,i,a){var o=jW(n),l;r==="head"?l=s.headStyles:r==="body"?l=s.bodyStyles:r==="foot"&&(l=s.footStyles);var c=Vl({},o.table,o[r],s.styles,l),A=s.columnStyles[e.dataKey]||s.columnStyles[e.index]||{},d=r==="body"?A:{},h=r==="body"&&t%2===0?Vl({},o.alternateRow,s.alternateRowStyles):{},u=HW(i),p=Vl({},u,c,h,d);return Vl(p,a)}function fY(r,e,t){var n;t===void 0&&(t={});var s=e3(r,e),i=new Map,a=[],o=[],l=[];Array.isArray(e.settings.horizontalPageBreakRepeat)?l=e.settings.horizontalPageBreakRepeat:(typeof e.settings.horizontalPageBreakRepeat=="string"||typeof e.settings.horizontalPageBreakRepeat=="number")&&(l=[e.settings.horizontalPageBreakRepeat]),l.forEach(function(h){var u=e.columns.find(function(p){return p.dataKey===h||p.index===h});u&&!i.has(u.index)&&(i.set(u.index,!0),a.push(u.index),o.push(e.columns[u.index]),s-=u.wrappedWidth)});for(var c=!0,A=(n=t==null?void 0:t.start)!==null&&n!==void 0?n:0;A<e.columns.length;){if(i.has(A)){A++;continue}var d=e.columns[A].wrappedWidth;if(c||s>=d)c=!1,a.push(A),o.push(e.columns[A]),s-=d;else break;A++}return{colIndexes:a,columns:o,lastIndex:A-1}}function gY(r,e){for(var t=[],n=0;n<e.columns.length;n++){var s=fY(r,e,{start:n});s.columns.length&&(t.push(s),n=s.lastIndex)}return t}function o3(r,e){var t=e.settings,n=t.startY,s=t.margin,i={x:s.left,y:n},a=e.getHeadHeight(e.columns)+e.getFootHeight(e.columns),o=n+s.bottom+a;if(t.pageBreak==="avoid"){var l=e.body,c=l.reduce(function(h,u){return h+u.height},0);o+=c}var A=new zu(r);(t.pageBreak==="always"||t.startY!=null&&o>A.pageSize().height)&&(c3(A),i.y=s.top),e.callWillDrawPageHooks(A,i);var d=Vl({},i);e.startPageNumber=A.pageNumber(),t.horizontalPageBreak?pY(A,e,d,i):(A.applyStyles(A.userStyles),(t.showHead==="firstPage"||t.showHead==="everyPage")&&e.head.forEach(function(h){return tc(A,e,h,i,e.columns)}),A.applyStyles(A.userStyles),e.body.forEach(function(h,u){var p=u===e.body.length-1;rb(A,e,h,p,d,i,e.columns)}),A.applyStyles(A.userStyles),(t.showFoot==="lastPage"||t.showFoot==="everyPage")&&e.foot.forEach(function(h){return tc(A,e,h,i,e.columns)})),JF(A,e,d,i),e.callEndPageHooks(A,i),e.finalY=i.y,r.lastAutoTable=e,A.applyStyles(A.userStyles)}function pY(r,e,t,n){var s=gY(r,e),i=e.settings;if(i.horizontalPageBreakBehaviour==="afterAllRows")s.forEach(function(c,A){r.applyStyles(r.userStyles),A>0?Zf(r,e,t,n,c.columns,!0):ik(r,e,n,c.columns),mY(r,e,t,n,c.columns),Yw(r,e,n,c.columns)});else for(var a=-1,o=s[0],l=function(){var c=a;if(o){r.applyStyles(r.userStyles);var A=o.columns;a>=0?Zf(r,e,t,n,A,!0):ik(r,e,n,A),c=ak(r,e,a+1,n,A),Yw(r,e,n,A)}var d=c-a;s.slice(1).forEach(function(h){r.applyStyles(r.userStyles),Zf(r,e,t,n,h.columns,!0),ak(r,e,a+1,n,h.columns,d),Yw(r,e,n,h.columns)}),a=c};a<e.body.length-1;)l()}function ik(r,e,t,n){var s=e.settings;r.applyStyles(r.userStyles),(s.showHead==="firstPage"||s.showHead==="everyPage")&&e.head.forEach(function(i){return tc(r,e,i,t,n)})}function mY(r,e,t,n,s){r.applyStyles(r.userStyles),e.body.forEach(function(i,a){var o=a===e.body.length-1;rb(r,e,i,o,t,n,s)})}function ak(r,e,t,n,s,i){r.applyStyles(r.userStyles),i=i??e.body.length;var a=Math.min(t+i,e.body.length),o=-1;return e.body.slice(t,a).forEach(function(l,c){var A=t+c===e.body.length-1,d=l3(r,e,A,n);l.canEntireRowFit(d,s)&&(tc(r,e,l,n,s),o=t+c)}),o}function Yw(r,e,t,n){var s=e.settings;r.applyStyles(r.userStyles),(s.showFoot==="lastPage"||s.showFoot==="everyPage")&&e.foot.forEach(function(i){return tc(r,e,i,t,n)})}function bY(r,e,t){var n=t.getLineHeight(r.styles.fontSize),s=r.padding("vertical"),i=Math.floor((e-s)/n);return Math.max(0,i)}function yY(r,e,t,n){var s={};r.spansMultiplePages=!0,r.height=0;for(var i=0,a=0,o=t.columns;a<o.length;a++){var l=o[a],c=r.cells[l.index];if(c){Array.isArray(c.text)||(c.text=[c.text]);var A=new i3(c.raw,c.styles,c.section);A=Vl(A,c),A.text=[];var d=bY(c,e,n);c.text.length>d&&(A.text=c.text.splice(d,c.text.length));var h=n.scaleFactor(),u=n.getLineHeightFactor();c.contentHeight=c.getContentHeight(h,u),c.contentHeight>=e&&(c.contentHeight=e,A.styles.minCellHeight-=e),c.contentHeight>r.height&&(r.height=c.contentHeight),A.contentHeight=A.getContentHeight(h,u),A.contentHeight>i&&(i=A.contentHeight),s[l.index]=A}}var p=new s3(r.raw,-1,r.section,s,!0);p.height=i;for(var f=0,g=t.columns;f<g.length;f++){var l=g[f],A=p.cells[l.index];A&&(A.height=p.height);var c=r.cells[l.index];c&&(c.height=r.height)}return p}function wY(r,e,t,n){var s=r.pageSize().height,i=n.settings.margin,a=i.top+i.bottom,o=s-a;e.section==="body"&&(o-=n.getHeadHeight(n.columns)+n.getFootHeight(n.columns));var l=e.getMinimumRowHeight(n.columns,r),c=l<t;if(l>o)return console.error("Will not be able to print row ".concat(e.index," correctly since it's minimum height is larger than page height")),!0;if(!c)return!1;var A=e.hasRowSpan(n.columns),d=e.getMaxCellHeight(n.columns)>o;return d?(A&&console.error("The content of row ".concat(e.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(A||n.settings.rowPageBreak==="avoid")}function rb(r,e,t,n,s,i,a){var o=l3(r,e,n,i);if(t.canEntireRowFit(o,a))tc(r,e,t,i,a);else if(wY(r,t,o,e)){var l=yY(t,o,e,r);tc(r,e,t,i,a),Zf(r,e,s,i,a),rb(r,e,l,n,s,i,a)}else Zf(r,e,s,i,a),rb(r,e,t,n,s,i,a)}function tc(r,e,t,n,s){n.x=e.settings.margin.left;for(var i=0,a=s;i<a.length;i++){var o=a[i],l=t.cells[o.index];if(!l){n.x+=o.width;continue}r.applyStyles(l.styles),l.x=n.x,l.y=n.y;var c=e.callCellHooks(r,e.hooks.willDrawCell,l,t,o,n);if(c===!1){n.x+=o.width;continue}vY(r,l,n);var A=l.getTextPos();WF(l.text,A.x,A.y,{halign:l.styles.halign,valign:l.styles.valign,maxWidth:Math.ceil(l.width-l.padding("left")-l.padding("right"))},r.getDocument()),e.callCellHooks(r,e.hooks.didDrawCell,l,t,o,n),n.x+=o.width}n.y+=t.height}function vY(r,e,t){var n=e.styles;if(r.getDocument().setFillColor(r.getDocument().getFillColor()),typeof n.lineWidth=="number"){var s=ZF(n.lineWidth,n.fillColor);s&&r.rect(e.x,t.y,e.width,e.height,s)}else typeof n.lineWidth=="object"&&(n.fillColor&&r.rect(e.x,t.y,e.width,e.height,"F"),xY(r,e,t,n.lineWidth))}function xY(r,e,t,n){var s,i,a,o;n.top&&(s=t.x,i=t.y,a=t.x+e.width,o=t.y,n.right&&(a+=.5*n.right),n.left&&(s-=.5*n.left),l(n.top,s,i,a,o)),n.bottom&&(s=t.x,i=t.y+e.height,a=t.x+e.width,o=t.y+e.height,n.right&&(a+=.5*n.right),n.left&&(s-=.5*n.left),l(n.bottom,s,i,a,o)),n.left&&(s=t.x,i=t.y,a=t.x,o=t.y+e.height,n.top&&(i-=.5*n.top),n.bottom&&(o+=.5*n.bottom),l(n.left,s,i,a,o)),n.right&&(s=t.x+e.width,i=t.y,a=t.x+e.width,o=t.y+e.height,n.top&&(i-=.5*n.top),n.bottom&&(o+=.5*n.bottom),l(n.right,s,i,a,o));function l(c,A,d,h,u){r.getDocument().setLineWidth(c),r.getDocument().line(A,d,h,u,"S")}}function l3(r,e,t,n){var s=e.settings.margin.bottom,i=e.settings.showFoot;return(i==="everyPage"||i==="lastPage"&&t)&&(s+=e.getFootHeight(e.columns)),r.pageSize().height-n.y-s}function Zf(r,e,t,n,s,i){s===void 0&&(s=[]),i===void 0&&(i=!1),r.applyStyles(r.userStyles),e.settings.showFoot==="everyPage"&&!i&&e.foot.forEach(function(o){return tc(r,e,o,n,s)}),e.callEndPageHooks(r,n);var a=e.settings.margin;JF(r,e,t,n),c3(r),e.pageNumber++,n.x=a.left,n.y=a.top,t.y=a.top,e.callWillDrawPageHooks(r,n),e.settings.showHead==="everyPage"&&(e.head.forEach(function(o){return tc(r,e,o,n,s)}),r.applyStyles(r.userStyles))}function c3(r){var e=r.pageNumber();r.setPage(e+1);var t=r.pageNumber();return t===e?(r.addPage(),!0):!1}function _Y(r){r.API.autoTable=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e[0],s=n3(this,n),i=a3(this,s);return o3(this,i),this},r.API.lastAutoTable=!1,r.API.autoTableText=function(e,t,n,s){WF(e,t,n,s,this)},r.API.autoTableSetDefaults=function(e){return zu.setDefaults(e,this),this},r.autoTableSetDefaults=function(e,t){zu.setDefaults(e,t)},r.API.autoTableHtmlToJson=function(e,t){var n;if(t===void 0&&(t=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var s=new zu(this),i=r3(s,e,window,t,!1),a=i.head,o=i.body,l=((n=a[0])===null||n===void 0?void 0:n.map(function(c){return c.content}))||[];return{columns:l,rows:o,data:o}}}var Xw;function n2(r,e){var t=n3(r,e),n=a3(r,t);o3(r,n)}try{if(typeof window<"u"&&window){var ok=window,lk=ok.jsPDF||((Xw=ok.jspdf)===null||Xw===void 0?void 0:Xw.jsPDF);lk&&_Y(lk)}}catch(r){console.error("Could not apply autoTable plugin",r)}function L0(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Jw={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var ck;function BY(){return ck||(ck=1,(function(r,e){(function(t){r.exports=t()})(function(){return(function t(n,s,i){function a(c,A){if(!s[c]){if(!n[c]){var d=typeof L0=="function"&&L0;if(!A&&d)return d(c,!0);if(o)return o(c,!0);var h=new Error("Cannot find module '"+c+"'");throw h.code="MODULE_NOT_FOUND",h}var u=s[c]={exports:{}};n[c][0].call(u.exports,function(p){var f=n[c][1][p];return a(f||p)},u,u.exports,t,n,s,i)}return s[c].exports}for(var o=typeof L0=="function"&&L0,l=0;l<i.length;l++)a(i[l]);return a})({1:[function(t,n,s){var i=t("./utils"),a=t("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";s.encode=function(l){for(var c,A,d,h,u,p,f,g=[],m=0,x=l.length,S=x,B=i.getTypeOf(l)!=="string";m<l.length;)S=x-m,d=B?(c=l[m++],A=m<x?l[m++]:0,m<x?l[m++]:0):(c=l.charCodeAt(m++),A=m<x?l.charCodeAt(m++):0,m<x?l.charCodeAt(m++):0),h=c>>2,u=(3&c)<<4|A>>4,p=1<S?(15&A)<<2|d>>6:64,f=2<S?63&d:64,g.push(o.charAt(h)+o.charAt(u)+o.charAt(p)+o.charAt(f));return g.join("")},s.decode=function(l){var c,A,d,h,u,p,f=0,g=0,m="data:";if(l.substr(0,m.length)===m)throw new Error("Invalid base64 input, it looks like a data url.");var x,S=3*(l=l.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(l.charAt(l.length-1)===o.charAt(64)&&S--,l.charAt(l.length-2)===o.charAt(64)&&S--,S%1!=0)throw new Error("Invalid base64 input, bad content length.");for(x=a.uint8array?new Uint8Array(0|S):new Array(0|S);f<l.length;)c=o.indexOf(l.charAt(f++))<<2|(h=o.indexOf(l.charAt(f++)))>>4,A=(15&h)<<4|(u=o.indexOf(l.charAt(f++)))>>2,d=(3&u)<<6|(p=o.indexOf(l.charAt(f++))),x[g++]=c,u!==64&&(x[g++]=A),p!==64&&(x[g++]=d);return x}},{"./support":30,"./utils":32}],2:[function(t,n,s){var i=t("./external"),a=t("./stream/DataWorker"),o=t("./stream/Crc32Probe"),l=t("./stream/DataLengthProbe");function c(A,d,h,u,p){this.compressedSize=A,this.uncompressedSize=d,this.crc32=h,this.compression=u,this.compressedContent=p}c.prototype={getContentWorker:function(){var A=new a(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),d=this;return A.on("end",function(){if(this.streamInfo.data_length!==d.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),A},getCompressedWorker:function(){return new a(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},c.createWorkerFrom=function(A,d,h){return A.pipe(new o).pipe(new l("uncompressedSize")).pipe(d.compressWorker(h)).pipe(new l("compressedSize")).withStreamInfo("compression",d)},n.exports=c},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,n,s){var i=t("./stream/GenericWorker");s.STORE={magic:"\0\0",compressWorker:function(){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},s.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,n,s){var i=t("./utils"),a=(function(){for(var o,l=[],c=0;c<256;c++){o=c;for(var A=0;A<8;A++)o=1&o?3988292384^o>>>1:o>>>1;l[c]=o}return l})();n.exports=function(o,l){return o!==void 0&&o.length?i.getTypeOf(o)!=="string"?(function(c,A,d,h){var u=a,p=h+d;c^=-1;for(var f=h;f<p;f++)c=c>>>8^u[255&(c^A[f])];return-1^c})(0|l,o,o.length,0):(function(c,A,d,h){var u=a,p=h+d;c^=-1;for(var f=h;f<p;f++)c=c>>>8^u[255&(c^A.charCodeAt(f))];return-1^c})(0|l,o,o.length,0):0}},{"./utils":32}],5:[function(t,n,s){s.base64=!1,s.binary=!1,s.dir=!1,s.createFolders=!0,s.date=null,s.compression=null,s.compressionOptions=null,s.comment=null,s.unixPermissions=null,s.dosPermissions=null},{}],6:[function(t,n,s){var i=null;i=typeof Promise<"u"?Promise:t("lie"),n.exports={Promise:i}},{lie:37}],7:[function(t,n,s){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",a=t("pako"),o=t("./utils"),l=t("./stream/GenericWorker"),c=i?"uint8array":"array";function A(d,h){l.call(this,"FlateWorker/"+d),this._pako=null,this._pakoAction=d,this._pakoOptions=h,this.meta={}}s.magic="\b\0",o.inherits(A,l),A.prototype.processChunk=function(d){this.meta=d.meta,this._pako===null&&this._createPako(),this._pako.push(o.transformTo(c,d.data),!1)},A.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},A.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},A.prototype._createPako=function(){this._pako=new a[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var d=this;this._pako.onData=function(h){d.push({data:h,meta:d.meta})}},s.compressWorker=function(d){return new A("Deflate",d)},s.uncompressWorker=function(){return new A("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,n,s){function i(u,p){var f,g="";for(f=0;f<p;f++)g+=String.fromCharCode(255&u),u>>>=8;return g}function a(u,p,f,g,m,x){var S,B,F=u.file,N=u.compression,E=x!==c.utf8encode,w=o.transformTo("string",x(F.name)),v=o.transformTo("string",c.utf8encode(F.name)),I=F.comment,k=o.transformTo("string",x(I)),_=o.transformTo("string",c.utf8encode(I)),T=v.length!==F.name.length,L=_.length!==I.length,K="",se="",X="",$=F.dir,V=F.date,he={crc32:0,compressedSize:0,uncompressedSize:0};p&&!f||(he.crc32=u.crc32,he.compressedSize=u.compressedSize,he.uncompressedSize=u.uncompressedSize);var z=0;p&&(z|=8),E||!T&&!L||(z|=2048);var M=0,O=0;$&&(M|=16),m==="UNIX"?(O=798,M|=(function(J,de){var ie=J;return J||(ie=de?16893:33204),(65535&ie)<<16})(F.unixPermissions,$)):(O=20,M|=(function(J){return 63&(J||0)})(F.dosPermissions)),S=V.getUTCHours(),S<<=6,S|=V.getUTCMinutes(),S<<=5,S|=V.getUTCSeconds()/2,B=V.getUTCFullYear()-1980,B<<=4,B|=V.getUTCMonth()+1,B<<=5,B|=V.getUTCDate(),T&&(se=i(1,1)+i(A(w),4)+v,K+="up"+i(se.length,2)+se),L&&(X=i(1,1)+i(A(k),4)+_,K+="uc"+i(X.length,2)+X);var H="";return H+=`
\0`,H+=i(z,2),H+=N.magic,H+=i(S,2),H+=i(B,2),H+=i(he.crc32,4),H+=i(he.compressedSize,4),H+=i(he.uncompressedSize,4),H+=i(w.length,2),H+=i(K.length,2),{fileRecord:d.LOCAL_FILE_HEADER+H+w+K,dirRecord:d.CENTRAL_FILE_HEADER+i(O,2)+H+i(k.length,2)+"\0\0\0\0"+i(M,4)+i(g,4)+w+K+k}}var o=t("../utils"),l=t("../stream/GenericWorker"),c=t("../utf8"),A=t("../crc32"),d=t("../signature");function h(u,p,f,g){l.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=p,this.zipPlatform=f,this.encodeFileName=g,this.streamFiles=u,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}o.inherits(h,l),h.prototype.push=function(u){var p=u.meta.percent||0,f=this.entriesCount,g=this._sources.length;this.accumulate?this.contentBuffer.push(u):(this.bytesWritten+=u.data.length,l.prototype.push.call(this,{data:u.data,meta:{currentFile:this.currentFile,percent:f?(p+100*(f-g-1))/f:100}}))},h.prototype.openedSource=function(u){this.currentSourceOffset=this.bytesWritten,this.currentFile=u.file.name;var p=this.streamFiles&&!u.file.dir;if(p){var f=a(u,p,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:f.fileRecord,meta:{percent:0}})}else this.accumulate=!0},h.prototype.closedSource=function(u){this.accumulate=!1;var p=this.streamFiles&&!u.file.dir,f=a(u,p,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(f.dirRecord),p)this.push({data:(function(g){return d.DATA_DESCRIPTOR+i(g.crc32,4)+i(g.compressedSize,4)+i(g.uncompressedSize,4)})(u),meta:{percent:100}});else for(this.push({data:f.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},h.prototype.flush=function(){for(var u=this.bytesWritten,p=0;p<this.dirRecords.length;p++)this.push({data:this.dirRecords[p],meta:{percent:100}});var f=this.bytesWritten-u,g=(function(m,x,S,B,F){var N=o.transformTo("string",F(B));return d.CENTRAL_DIRECTORY_END+"\0\0\0\0"+i(m,2)+i(m,2)+i(x,4)+i(S,4)+i(N.length,2)+N})(this.dirRecords.length,f,u,this.zipComment,this.encodeFileName);this.push({data:g,meta:{percent:100}})},h.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},h.prototype.registerPrevious=function(u){this._sources.push(u);var p=this;return u.on("data",function(f){p.processChunk(f)}),u.on("end",function(){p.closedSource(p.previous.streamInfo),p._sources.length?p.prepareNextSource():p.end()}),u.on("error",function(f){p.error(f)}),this},h.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},h.prototype.error=function(u){var p=this._sources;if(!l.prototype.error.call(this,u))return!1;for(var f=0;f<p.length;f++)try{p[f].error(u)}catch{}return!0},h.prototype.lock=function(){l.prototype.lock.call(this);for(var u=this._sources,p=0;p<u.length;p++)u[p].lock()},n.exports=h},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,n,s){var i=t("../compressions"),a=t("./ZipFileWorker");s.generateWorker=function(o,l,c){var A=new a(l.streamFiles,c,l.platform,l.encodeFileName),d=0;try{o.forEach(function(h,u){d++;var p=(function(x,S){var B=x||S,F=i[B];if(!F)throw new Error(B+" is not a valid compression method !");return F})(u.options.compression,l.compression),f=u.options.compressionOptions||l.compressionOptions||{},g=u.dir,m=u.date;u._compressWorker(p,f).withStreamInfo("file",{name:h,dir:g,date:m,comment:u.comment||"",unixPermissions:u.unixPermissions,dosPermissions:u.dosPermissions}).pipe(A)}),A.entriesCount=d}catch(h){A.error(h)}return A}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,n,s){function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var a=new i;for(var o in this)typeof this[o]!="function"&&(a[o]=this[o]);return a}}(i.prototype=t("./object")).loadAsync=t("./load"),i.support=t("./support"),i.defaults=t("./defaults"),i.version="3.10.1",i.loadAsync=function(a,o){return new i().loadAsync(a,o)},i.external=t("./external"),n.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,n,s){var i=t("./utils"),a=t("./external"),o=t("./utf8"),l=t("./zipEntries"),c=t("./stream/Crc32Probe"),A=t("./nodejsUtils");function d(h){return new a.Promise(function(u,p){var f=h.decompressed.getContentWorker().pipe(new c);f.on("error",function(g){p(g)}).on("end",function(){f.streamInfo.crc32!==h.decompressed.crc32?p(new Error("Corrupted zip : CRC32 mismatch")):u()}).resume()})}n.exports=function(h,u){var p=this;return u=i.extend(u||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),A.isNode&&A.isStream(h)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",h,!0,u.optimizedBinaryString,u.base64).then(function(f){var g=new l(u);return g.load(f),g}).then(function(f){var g=[a.Promise.resolve(f)],m=f.files;if(u.checkCRC32)for(var x=0;x<m.length;x++)g.push(d(m[x]));return a.Promise.all(g)}).then(function(f){for(var g=f.shift(),m=g.files,x=0;x<m.length;x++){var S=m[x],B=S.fileNameStr,F=i.resolve(S.fileNameStr);p.file(F,S.decompressed,{binary:!0,optimizedBinaryString:!0,date:S.date,dir:S.dir,comment:S.fileCommentStr.length?S.fileCommentStr:null,unixPermissions:S.unixPermissions,dosPermissions:S.dosPermissions,createFolders:u.createFolders}),S.dir||(p.file(F).unsafeOriginalName=B)}return g.zipComment.length&&(p.comment=g.zipComment),p})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,n,s){var i=t("../utils"),a=t("../stream/GenericWorker");function o(l,c){a.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(c)}i.inherits(o,a),o.prototype._bindStream=function(l){var c=this;(this._stream=l).pause(),l.on("data",function(A){c.push({data:A,meta:{percent:0}})}).on("error",function(A){c.isPaused?this.generatedError=A:c.error(A)}).on("end",function(){c.isPaused?c._upstreamEnded=!0:c.end()})},o.prototype.pause=function(){return!!a.prototype.pause.call(this)&&(this._stream.pause(),!0)},o.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},n.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,n,s){var i=t("readable-stream").Readable;function a(o,l,c){i.call(this,l),this._helper=o;var A=this;o.on("data",function(d,h){A.push(d)||A._helper.pause(),c&&c(h)}).on("error",function(d){A.emit("error",d)}).on("end",function(){A.push(null)})}t("../utils").inherits(a,i),a.prototype._read=function(){this._helper.resume()},n.exports=a},{"../utils":32,"readable-stream":16}],14:[function(t,n,s){n.exports={isNode:typeof Buffer<"u",newBufferFrom:function(i,a){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(i,a);if(typeof i=="number")throw new Error('The "data" argument must not be a number');return new Buffer(i,a)},allocBuffer:function(i){if(Buffer.alloc)return Buffer.alloc(i);var a=new Buffer(i);return a.fill(0),a},isBuffer:function(i){return Buffer.isBuffer(i)},isStream:function(i){return i&&typeof i.on=="function"&&typeof i.pause=="function"&&typeof i.resume=="function"}}},{}],15:[function(t,n,s){function i(F,N,E){var w,v=o.getTypeOf(N),I=o.extend(E||{},A);I.date=I.date||new Date,I.compression!==null&&(I.compression=I.compression.toUpperCase()),typeof I.unixPermissions=="string"&&(I.unixPermissions=parseInt(I.unixPermissions,8)),I.unixPermissions&&16384&I.unixPermissions&&(I.dir=!0),I.dosPermissions&&16&I.dosPermissions&&(I.dir=!0),I.dir&&(F=m(F)),I.createFolders&&(w=g(F))&&x.call(this,w,!0);var k=v==="string"&&I.binary===!1&&I.base64===!1;E&&E.binary!==void 0||(I.binary=!k),(N instanceof d&&N.uncompressedSize===0||I.dir||!N||N.length===0)&&(I.base64=!1,I.binary=!0,N="",I.compression="STORE",v="string");var _=null;_=N instanceof d||N instanceof l?N:p.isNode&&p.isStream(N)?new f(F,N):o.prepareContent(F,N,I.binary,I.optimizedBinaryString,I.base64);var T=new h(F,_,I);this.files[F]=T}var a=t("./utf8"),o=t("./utils"),l=t("./stream/GenericWorker"),c=t("./stream/StreamHelper"),A=t("./defaults"),d=t("./compressedObject"),h=t("./zipObject"),u=t("./generate"),p=t("./nodejsUtils"),f=t("./nodejs/NodejsStreamInputAdapter"),g=function(F){F.slice(-1)==="/"&&(F=F.substring(0,F.length-1));var N=F.lastIndexOf("/");return 0<N?F.substring(0,N):""},m=function(F){return F.slice(-1)!=="/"&&(F+="/"),F},x=function(F,N){return N=N!==void 0?N:A.createFolders,F=m(F),this.files[F]||i.call(this,F,null,{dir:!0,createFolders:N}),this.files[F]};function S(F){return Object.prototype.toString.call(F)==="[object RegExp]"}var B={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(F){var N,E,w;for(N in this.files)w=this.files[N],(E=N.slice(this.root.length,N.length))&&N.slice(0,this.root.length)===this.root&&F(E,w)},filter:function(F){var N=[];return this.forEach(function(E,w){F(E,w)&&N.push(w)}),N},file:function(F,N,E){if(arguments.length!==1)return F=this.root+F,i.call(this,F,N,E),this;if(S(F)){var w=F;return this.filter(function(I,k){return!k.dir&&w.test(I)})}var v=this.files[this.root+F];return v&&!v.dir?v:null},folder:function(F){if(!F)return this;if(S(F))return this.filter(function(v,I){return I.dir&&F.test(v)});var N=this.root+F,E=x.call(this,N),w=this.clone();return w.root=E.name,w},remove:function(F){F=this.root+F;var N=this.files[F];if(N||(F.slice(-1)!=="/"&&(F+="/"),N=this.files[F]),N&&!N.dir)delete this.files[F];else for(var E=this.filter(function(v,I){return I.name.slice(0,F.length)===F}),w=0;w<E.length;w++)delete this.files[E[w].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(F){var N,E={};try{if((E=o.extend(F||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:a.utf8encode})).type=E.type.toLowerCase(),E.compression=E.compression.toUpperCase(),E.type==="binarystring"&&(E.type="string"),!E.type)throw new Error("No output type specified.");o.checkSupport(E.type),E.platform!=="darwin"&&E.platform!=="freebsd"&&E.platform!=="linux"&&E.platform!=="sunos"||(E.platform="UNIX"),E.platform==="win32"&&(E.platform="DOS");var w=E.comment||this.comment||"";N=u.generateWorker(this,E,w)}catch(v){(N=new l("error")).error(v)}return new c(N,E.type||"string",E.mimeType)},generateAsync:function(F,N){return this.generateInternalStream(F).accumulate(N)},generateNodeStream:function(F,N){return(F=F||{}).type||(F.type="nodebuffer"),this.generateInternalStream(F).toNodejsStream(N)}};n.exports=B},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,n,s){n.exports=t("stream")},{stream:void 0}],17:[function(t,n,s){var i=t("./DataReader");function a(o){i.call(this,o);for(var l=0;l<this.data.length;l++)o[l]=255&o[l]}t("../utils").inherits(a,i),a.prototype.byteAt=function(o){return this.data[this.zero+o]},a.prototype.lastIndexOfSignature=function(o){for(var l=o.charCodeAt(0),c=o.charCodeAt(1),A=o.charCodeAt(2),d=o.charCodeAt(3),h=this.length-4;0<=h;--h)if(this.data[h]===l&&this.data[h+1]===c&&this.data[h+2]===A&&this.data[h+3]===d)return h-this.zero;return-1},a.prototype.readAndCheckSignature=function(o){var l=o.charCodeAt(0),c=o.charCodeAt(1),A=o.charCodeAt(2),d=o.charCodeAt(3),h=this.readData(4);return l===h[0]&&c===h[1]&&A===h[2]&&d===h[3]},a.prototype.readData=function(o){if(this.checkOffset(o),o===0)return[];var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},n.exports=a},{"../utils":32,"./DataReader":18}],18:[function(t,n,s){var i=t("../utils");function a(o){this.data=o,this.length=o.length,this.index=0,this.zero=0}a.prototype={checkOffset:function(o){this.checkIndex(this.index+o)},checkIndex:function(o){if(this.length<this.zero+o||o<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+o+"). Corrupted zip ?")},setIndex:function(o){this.checkIndex(o),this.index=o},skip:function(o){this.setIndex(this.index+o)},byteAt:function(){},readInt:function(o){var l,c=0;for(this.checkOffset(o),l=this.index+o-1;l>=this.index;l--)c=(c<<8)+this.byteAt(l);return this.index+=o,c},readString:function(o){return i.transformTo("string",this.readData(o))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var o=this.readInt(4);return new Date(Date.UTC(1980+(o>>25&127),(o>>21&15)-1,o>>16&31,o>>11&31,o>>5&63,(31&o)<<1))}},n.exports=a},{"../utils":32}],19:[function(t,n,s){var i=t("./Uint8ArrayReader");function a(o){i.call(this,o)}t("../utils").inherits(a,i),a.prototype.readData=function(o){this.checkOffset(o);var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},n.exports=a},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,n,s){var i=t("./DataReader");function a(o){i.call(this,o)}t("../utils").inherits(a,i),a.prototype.byteAt=function(o){return this.data.charCodeAt(this.zero+o)},a.prototype.lastIndexOfSignature=function(o){return this.data.lastIndexOf(o)-this.zero},a.prototype.readAndCheckSignature=function(o){return o===this.readData(4)},a.prototype.readData=function(o){this.checkOffset(o);var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},n.exports=a},{"../utils":32,"./DataReader":18}],21:[function(t,n,s){var i=t("./ArrayReader");function a(o){i.call(this,o)}t("../utils").inherits(a,i),a.prototype.readData=function(o){if(this.checkOffset(o),o===0)return new Uint8Array(0);var l=this.data.subarray(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},n.exports=a},{"../utils":32,"./ArrayReader":17}],22:[function(t,n,s){var i=t("../utils"),a=t("../support"),o=t("./ArrayReader"),l=t("./StringReader"),c=t("./NodeBufferReader"),A=t("./Uint8ArrayReader");n.exports=function(d){var h=i.getTypeOf(d);return i.checkSupport(h),h!=="string"||a.uint8array?h==="nodebuffer"?new c(d):a.uint8array?new A(i.transformTo("uint8array",d)):new o(i.transformTo("array",d)):new l(d)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,n,s){s.LOCAL_FILE_HEADER="PK",s.CENTRAL_FILE_HEADER="PK",s.CENTRAL_DIRECTORY_END="PK",s.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",s.ZIP64_CENTRAL_DIRECTORY_END="PK",s.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,n,s){var i=t("./GenericWorker"),a=t("../utils");function o(l){i.call(this,"ConvertWorker to "+l),this.destType=l}a.inherits(o,i),o.prototype.processChunk=function(l){this.push({data:a.transformTo(this.destType,l.data),meta:l.meta})},n.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(t,n,s){var i=t("./GenericWorker"),a=t("../crc32");function o(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(o,i),o.prototype.processChunk=function(l){this.streamInfo.crc32=a(l.data,this.streamInfo.crc32||0),this.push(l)},n.exports=o},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,n,s){var i=t("../utils"),a=t("./GenericWorker");function o(l){a.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}i.inherits(o,a),o.prototype.processChunk=function(l){if(l){var c=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=c+l.data.length}a.prototype.processChunk.call(this,l)},n.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(t,n,s){var i=t("../utils"),a=t("./GenericWorker");function o(l){a.call(this,"DataWorker");var c=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,l.then(function(A){c.dataIsReady=!0,c.data=A,c.max=A&&A.length||0,c.type=i.getTypeOf(A),c.isPaused||c._tickAndRepeat()},function(A){c.error(A)})}i.inherits(o,a),o.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},o.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},o.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},o.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var l=null,c=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":l=this.data.substring(this.index,c);break;case"uint8array":l=this.data.subarray(this.index,c);break;case"array":case"nodebuffer":l=this.data.slice(this.index,c)}return this.index=c,this.push({data:l,meta:{percent:this.max?this.index/this.max*100:0}})},n.exports=o},{"../utils":32,"./GenericWorker":28}],28:[function(t,n,s){function i(a){this.name=a||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(a){this.emit("data",a)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(a){this.emit("error",a)}return!0},error:function(a){return!this.isFinished&&(this.isPaused?this.generatedError=a:(this.isFinished=!0,this.emit("error",a),this.previous&&this.previous.error(a),this.cleanUp()),!0)},on:function(a,o){return this._listeners[a].push(o),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(a,o){if(this._listeners[a])for(var l=0;l<this._listeners[a].length;l++)this._listeners[a][l].call(this,o)},pipe:function(a){return a.registerPrevious(this)},registerPrevious:function(a){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=a.streamInfo,this.mergeStreamInfo(),this.previous=a;var o=this;return a.on("data",function(l){o.processChunk(l)}),a.on("end",function(){o.end()}),a.on("error",function(l){o.error(l)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var a=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),a=!0),this.previous&&this.previous.resume(),!a},flush:function(){},processChunk:function(a){this.push(a)},withStreamInfo:function(a,o){return this.extraStreamInfo[a]=o,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var a in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,a)&&(this.streamInfo[a]=this.extraStreamInfo[a])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var a="Worker "+this.name;return this.previous?this.previous+" -> "+a:a}},n.exports=i},{}],29:[function(t,n,s){var i=t("../utils"),a=t("./ConvertWorker"),o=t("./GenericWorker"),l=t("../base64"),c=t("../support"),A=t("../external"),d=null;if(c.nodestream)try{d=t("../nodejs/NodejsStreamOutputAdapter")}catch{}function h(p,f){return new A.Promise(function(g,m){var x=[],S=p._internalType,B=p._outputType,F=p._mimeType;p.on("data",function(N,E){x.push(N),f&&f(E)}).on("error",function(N){x=[],m(N)}).on("end",function(){try{var N=(function(E,w,v){switch(E){case"blob":return i.newBlob(i.transformTo("arraybuffer",w),v);case"base64":return l.encode(w);default:return i.transformTo(E,w)}})(B,(function(E,w){var v,I=0,k=null,_=0;for(v=0;v<w.length;v++)_+=w[v].length;switch(E){case"string":return w.join("");case"array":return Array.prototype.concat.apply([],w);case"uint8array":for(k=new Uint8Array(_),v=0;v<w.length;v++)k.set(w[v],I),I+=w[v].length;return k;case"nodebuffer":return Buffer.concat(w);default:throw new Error("concat : unsupported type '"+E+"'")}})(S,x),F);g(N)}catch(E){m(E)}x=[]}).resume()})}function u(p,f,g){var m=f;switch(f){case"blob":case"arraybuffer":m="uint8array";break;case"base64":m="string"}try{this._internalType=m,this._outputType=f,this._mimeType=g,i.checkSupport(m),this._worker=p.pipe(new a(m)),p.lock()}catch(x){this._worker=new o("error"),this._worker.error(x)}}u.prototype={accumulate:function(p){return h(this,p)},on:function(p,f){var g=this;return p==="data"?this._worker.on(p,function(m){f.call(g,m.data,m.meta)}):this._worker.on(p,function(){i.delay(f,arguments,g)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(p){if(i.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new d(this,{objectMode:this._outputType!=="nodebuffer"},p)}},n.exports=u},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,n,s){if(s.base64=!0,s.array=!0,s.string=!0,s.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",s.nodebuffer=typeof Buffer<"u",s.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")s.blob=!1;else{var i=new ArrayBuffer(0);try{s.blob=new Blob([i],{type:"application/zip"}).size===0}catch{try{var a=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);a.append(i),s.blob=a.getBlob("application/zip").size===0}catch{s.blob=!1}}}try{s.nodestream=!!t("readable-stream").Readable}catch{s.nodestream=!1}},{"readable-stream":16}],31:[function(t,n,s){for(var i=t("./utils"),a=t("./support"),o=t("./nodejsUtils"),l=t("./stream/GenericWorker"),c=new Array(256),A=0;A<256;A++)c[A]=252<=A?6:248<=A?5:240<=A?4:224<=A?3:192<=A?2:1;c[254]=c[254]=1;function d(){l.call(this,"utf-8 decode"),this.leftOver=null}function h(){l.call(this,"utf-8 encode")}s.utf8encode=function(u){return a.nodebuffer?o.newBufferFrom(u,"utf-8"):(function(p){var f,g,m,x,S,B=p.length,F=0;for(x=0;x<B;x++)(64512&(g=p.charCodeAt(x)))==55296&&x+1<B&&(64512&(m=p.charCodeAt(x+1)))==56320&&(g=65536+(g-55296<<10)+(m-56320),x++),F+=g<128?1:g<2048?2:g<65536?3:4;for(f=a.uint8array?new Uint8Array(F):new Array(F),x=S=0;S<F;x++)(64512&(g=p.charCodeAt(x)))==55296&&x+1<B&&(64512&(m=p.charCodeAt(x+1)))==56320&&(g=65536+(g-55296<<10)+(m-56320),x++),g<128?f[S++]=g:(g<2048?f[S++]=192|g>>>6:(g<65536?f[S++]=224|g>>>12:(f[S++]=240|g>>>18,f[S++]=128|g>>>12&63),f[S++]=128|g>>>6&63),f[S++]=128|63&g);return f})(u)},s.utf8decode=function(u){return a.nodebuffer?i.transformTo("nodebuffer",u).toString("utf-8"):(function(p){var f,g,m,x,S=p.length,B=new Array(2*S);for(f=g=0;f<S;)if((m=p[f++])<128)B[g++]=m;else if(4<(x=c[m]))B[g++]=65533,f+=x-1;else{for(m&=x===2?31:x===3?15:7;1<x&&f<S;)m=m<<6|63&p[f++],x--;1<x?B[g++]=65533:m<65536?B[g++]=m:(m-=65536,B[g++]=55296|m>>10&1023,B[g++]=56320|1023&m)}return B.length!==g&&(B.subarray?B=B.subarray(0,g):B.length=g),i.applyFromCharCode(B)})(u=i.transformTo(a.uint8array?"uint8array":"array",u))},i.inherits(d,l),d.prototype.processChunk=function(u){var p=i.transformTo(a.uint8array?"uint8array":"array",u.data);if(this.leftOver&&this.leftOver.length){if(a.uint8array){var f=p;(p=new Uint8Array(f.length+this.leftOver.length)).set(this.leftOver,0),p.set(f,this.leftOver.length)}else p=this.leftOver.concat(p);this.leftOver=null}var g=(function(x,S){var B;for((S=S||x.length)>x.length&&(S=x.length),B=S-1;0<=B&&(192&x[B])==128;)B--;return B<0||B===0?S:B+c[x[B]]>S?B:S})(p),m=p;g!==p.length&&(a.uint8array?(m=p.subarray(0,g),this.leftOver=p.subarray(g,p.length)):(m=p.slice(0,g),this.leftOver=p.slice(g,p.length))),this.push({data:s.utf8decode(m),meta:u.meta})},d.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:s.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},s.Utf8DecodeWorker=d,i.inherits(h,l),h.prototype.processChunk=function(u){this.push({data:s.utf8encode(u.data),meta:u.meta})},s.Utf8EncodeWorker=h},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,n,s){var i=t("./support"),a=t("./base64"),o=t("./nodejsUtils"),l=t("./external");function c(f){return f}function A(f,g){for(var m=0;m<f.length;++m)g[m]=255&f.charCodeAt(m);return g}t("setimmediate"),s.newBlob=function(f,g){s.checkSupport("blob");try{return new Blob([f],{type:g})}catch{try{var m=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return m.append(f),m.getBlob(g)}catch{throw new Error("Bug : can't construct the Blob.")}}};var d={stringifyByChunk:function(f,g,m){var x=[],S=0,B=f.length;if(B<=m)return String.fromCharCode.apply(null,f);for(;S<B;)g==="array"||g==="nodebuffer"?x.push(String.fromCharCode.apply(null,f.slice(S,Math.min(S+m,B)))):x.push(String.fromCharCode.apply(null,f.subarray(S,Math.min(S+m,B)))),S+=m;return x.join("")},stringifyByChar:function(f){for(var g="",m=0;m<f.length;m++)g+=String.fromCharCode(f[m]);return g},applyCanBeUsed:{uint8array:(function(){try{return i.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return i.nodebuffer&&String.fromCharCode.apply(null,o.allocBuffer(1)).length===1}catch{return!1}})()}};function h(f){var g=65536,m=s.getTypeOf(f),x=!0;if(m==="uint8array"?x=d.applyCanBeUsed.uint8array:m==="nodebuffer"&&(x=d.applyCanBeUsed.nodebuffer),x)for(;1<g;)try{return d.stringifyByChunk(f,m,g)}catch{g=Math.floor(g/2)}return d.stringifyByChar(f)}function u(f,g){for(var m=0;m<f.length;m++)g[m]=f[m];return g}s.applyFromCharCode=h;var p={};p.string={string:c,array:function(f){return A(f,new Array(f.length))},arraybuffer:function(f){return p.string.uint8array(f).buffer},uint8array:function(f){return A(f,new Uint8Array(f.length))},nodebuffer:function(f){return A(f,o.allocBuffer(f.length))}},p.array={string:h,array:c,arraybuffer:function(f){return new Uint8Array(f).buffer},uint8array:function(f){return new Uint8Array(f)},nodebuffer:function(f){return o.newBufferFrom(f)}},p.arraybuffer={string:function(f){return h(new Uint8Array(f))},array:function(f){return u(new Uint8Array(f),new Array(f.byteLength))},arraybuffer:c,uint8array:function(f){return new Uint8Array(f)},nodebuffer:function(f){return o.newBufferFrom(new Uint8Array(f))}},p.uint8array={string:h,array:function(f){return u(f,new Array(f.length))},arraybuffer:function(f){return f.buffer},uint8array:c,nodebuffer:function(f){return o.newBufferFrom(f)}},p.nodebuffer={string:h,array:function(f){return u(f,new Array(f.length))},arraybuffer:function(f){return p.nodebuffer.uint8array(f).buffer},uint8array:function(f){return u(f,new Uint8Array(f.length))},nodebuffer:c},s.transformTo=function(f,g){if(g=g||"",!f)return g;s.checkSupport(f);var m=s.getTypeOf(g);return p[m][f](g)},s.resolve=function(f){for(var g=f.split("/"),m=[],x=0;x<g.length;x++){var S=g[x];S==="."||S===""&&x!==0&&x!==g.length-1||(S===".."?m.pop():m.push(S))}return m.join("/")},s.getTypeOf=function(f){return typeof f=="string"?"string":Object.prototype.toString.call(f)==="[object Array]"?"array":i.nodebuffer&&o.isBuffer(f)?"nodebuffer":i.uint8array&&f instanceof Uint8Array?"uint8array":i.arraybuffer&&f instanceof ArrayBuffer?"arraybuffer":void 0},s.checkSupport=function(f){if(!i[f.toLowerCase()])throw new Error(f+" is not supported by this platform")},s.MAX_VALUE_16BITS=65535,s.MAX_VALUE_32BITS=-1,s.pretty=function(f){var g,m,x="";for(m=0;m<(f||"").length;m++)x+="\\x"+((g=f.charCodeAt(m))<16?"0":"")+g.toString(16).toUpperCase();return x},s.delay=function(f,g,m){setImmediate(function(){f.apply(m||null,g||[])})},s.inherits=function(f,g){function m(){}m.prototype=g.prototype,f.prototype=new m},s.extend=function(){var f,g,m={};for(f=0;f<arguments.length;f++)for(g in arguments[f])Object.prototype.hasOwnProperty.call(arguments[f],g)&&m[g]===void 0&&(m[g]=arguments[f][g]);return m},s.prepareContent=function(f,g,m,x,S){return l.Promise.resolve(g).then(function(B){return i.blob&&(B instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(B))!==-1)&&typeof FileReader<"u"?new l.Promise(function(F,N){var E=new FileReader;E.onload=function(w){F(w.target.result)},E.onerror=function(w){N(w.target.error)},E.readAsArrayBuffer(B)}):B}).then(function(B){var F=s.getTypeOf(B);return F?(F==="arraybuffer"?B=s.transformTo("uint8array",B):F==="string"&&(S?B=a.decode(B):m&&x!==!0&&(B=(function(N){return A(N,i.uint8array?new Uint8Array(N.length):new Array(N.length))})(B))),B):l.Promise.reject(new Error("Can't read the data of '"+f+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,n,s){var i=t("./reader/readerFor"),a=t("./utils"),o=t("./signature"),l=t("./zipEntry"),c=t("./support");function A(d){this.files=[],this.loadOptions=d}A.prototype={checkSignature:function(d){if(!this.reader.readAndCheckSignature(d)){this.reader.index-=4;var h=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+a.pretty(h)+", expected "+a.pretty(d)+")")}},isSignature:function(d,h){var u=this.reader.index;this.reader.setIndex(d);var p=this.reader.readString(4)===h;return this.reader.setIndex(u),p},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var d=this.reader.readData(this.zipCommentLength),h=c.uint8array?"uint8array":"array",u=a.transformTo(h,d);this.zipComment=this.loadOptions.decodeFileName(u)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var d,h,u,p=this.zip64EndOfCentralSize-44;0<p;)d=this.reader.readInt(2),h=this.reader.readInt(4),u=this.reader.readData(h),this.zip64ExtensibleData[d]={id:d,length:h,value:u}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var d,h;for(d=0;d<this.files.length;d++)h=this.files[d],this.reader.setIndex(h.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),h.readLocalPart(this.reader),h.handleUTF8(),h.processAttributes()},readCentralDir:function(){var d;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)(d=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(d);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var d=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(d<0)throw this.isSignature(0,o.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(d);var h=d;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,(d=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(d),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var u=this.centralDirOffset+this.centralDirSize;this.zip64&&(u+=20,u+=12+this.zip64EndOfCentralSize);var p=h-u;if(0<p)this.isSignature(h,o.CENTRAL_FILE_HEADER)||(this.reader.zero=p);else if(p<0)throw new Error("Corrupted zip: missing "+Math.abs(p)+" bytes.")},prepareReader:function(d){this.reader=i(d)},load:function(d){this.prepareReader(d),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},n.exports=A},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,n,s){var i=t("./reader/readerFor"),a=t("./utils"),o=t("./compressedObject"),l=t("./crc32"),c=t("./utf8"),A=t("./compressions"),d=t("./support");function h(u,p){this.options=u,this.loadOptions=p}h.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(u){var p,f;if(u.skip(22),this.fileNameLength=u.readInt(2),f=u.readInt(2),this.fileName=u.readData(this.fileNameLength),u.skip(f),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((p=(function(g){for(var m in A)if(Object.prototype.hasOwnProperty.call(A,m)&&A[m].magic===g)return A[m];return null})(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,p,u.readData(this.compressedSize))},readCentralPart:function(u){this.versionMadeBy=u.readInt(2),u.skip(2),this.bitFlag=u.readInt(2),this.compressionMethod=u.readString(2),this.date=u.readDate(),this.crc32=u.readInt(4),this.compressedSize=u.readInt(4),this.uncompressedSize=u.readInt(4);var p=u.readInt(2);if(this.extraFieldsLength=u.readInt(2),this.fileCommentLength=u.readInt(2),this.diskNumberStart=u.readInt(2),this.internalFileAttributes=u.readInt(2),this.externalFileAttributes=u.readInt(4),this.localHeaderOffset=u.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");u.skip(p),this.readExtraFields(u),this.parseZIP64ExtraField(u),this.fileComment=u.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var u=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),u==0&&(this.dosPermissions=63&this.externalFileAttributes),u==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var u=i(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=u.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=u.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=u.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=u.readInt(4))}},readExtraFields:function(u){var p,f,g,m=u.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});u.index+4<m;)p=u.readInt(2),f=u.readInt(2),g=u.readData(f),this.extraFields[p]={id:p,length:f,value:g};u.setIndex(m)},handleUTF8:function(){var u=d.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=c.utf8decode(this.fileName),this.fileCommentStr=c.utf8decode(this.fileComment);else{var p=this.findExtraFieldUnicodePath();if(p!==null)this.fileNameStr=p;else{var f=a.transformTo(u,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(f)}var g=this.findExtraFieldUnicodeComment();if(g!==null)this.fileCommentStr=g;else{var m=a.transformTo(u,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(m)}}},findExtraFieldUnicodePath:function(){var u=this.extraFields[28789];if(u){var p=i(u.value);return p.readInt(1)!==1||l(this.fileName)!==p.readInt(4)?null:c.utf8decode(p.readData(u.length-5))}return null},findExtraFieldUnicodeComment:function(){var u=this.extraFields[25461];if(u){var p=i(u.value);return p.readInt(1)!==1||l(this.fileComment)!==p.readInt(4)?null:c.utf8decode(p.readData(u.length-5))}return null}},n.exports=h},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,n,s){function i(p,f,g){this.name=p,this.dir=g.dir,this.date=g.date,this.comment=g.comment,this.unixPermissions=g.unixPermissions,this.dosPermissions=g.dosPermissions,this._data=f,this._dataBinary=g.binary,this.options={compression:g.compression,compressionOptions:g.compressionOptions}}var a=t("./stream/StreamHelper"),o=t("./stream/DataWorker"),l=t("./utf8"),c=t("./compressedObject"),A=t("./stream/GenericWorker");i.prototype={internalStream:function(p){var f=null,g="string";try{if(!p)throw new Error("No output type specified.");var m=(g=p.toLowerCase())==="string"||g==="text";g!=="binarystring"&&g!=="text"||(g="string"),f=this._decompressWorker();var x=!this._dataBinary;x&&!m&&(f=f.pipe(new l.Utf8EncodeWorker)),!x&&m&&(f=f.pipe(new l.Utf8DecodeWorker))}catch(S){(f=new A("error")).error(S)}return new a(f,g,"")},async:function(p,f){return this.internalStream(p).accumulate(f)},nodeStream:function(p,f){return this.internalStream(p||"nodebuffer").toNodejsStream(f)},_compressWorker:function(p,f){if(this._data instanceof c&&this._data.compression.magic===p.magic)return this._data.getCompressedWorker();var g=this._decompressWorker();return this._dataBinary||(g=g.pipe(new l.Utf8EncodeWorker)),c.createWorkerFrom(g,p,f)},_decompressWorker:function(){return this._data instanceof c?this._data.getContentWorker():this._data instanceof A?this._data:new o(this._data)}};for(var d=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],h=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},u=0;u<d.length;u++)i.prototype[d[u]]=h;n.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,n,s){(function(i){var a,o,l=i.MutationObserver||i.WebKitMutationObserver;if(l){var c=0,A=new l(p),d=i.document.createTextNode("");A.observe(d,{characterData:!0}),a=function(){d.data=c=++c%2}}else if(i.setImmediate||i.MessageChannel===void 0)a="document"in i&&"onreadystatechange"in i.document.createElement("script")?function(){var f=i.document.createElement("script");f.onreadystatechange=function(){p(),f.onreadystatechange=null,f.parentNode.removeChild(f),f=null},i.document.documentElement.appendChild(f)}:function(){setTimeout(p,0)};else{var h=new i.MessageChannel;h.port1.onmessage=p,a=function(){h.port2.postMessage(0)}}var u=[];function p(){var f,g;o=!0;for(var m=u.length;m;){for(g=u,u=[],f=-1;++f<m;)g[f]();m=u.length}o=!1}n.exports=function(f){u.push(f)!==1||o||a()}}).call(this,typeof Jp<"u"?Jp:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(t,n,s){var i=t("immediate");function a(){}var o={},l=["REJECTED"],c=["FULFILLED"],A=["PENDING"];function d(m){if(typeof m!="function")throw new TypeError("resolver must be a function");this.state=A,this.queue=[],this.outcome=void 0,m!==a&&f(this,m)}function h(m,x,S){this.promise=m,typeof x=="function"&&(this.onFulfilled=x,this.callFulfilled=this.otherCallFulfilled),typeof S=="function"&&(this.onRejected=S,this.callRejected=this.otherCallRejected)}function u(m,x,S){i(function(){var B;try{B=x(S)}catch(F){return o.reject(m,F)}B===m?o.reject(m,new TypeError("Cannot resolve promise with itself")):o.resolve(m,B)})}function p(m){var x=m&&m.then;if(m&&(typeof m=="object"||typeof m=="function")&&typeof x=="function")return function(){x.apply(m,arguments)}}function f(m,x){var S=!1;function B(E){S||(S=!0,o.reject(m,E))}function F(E){S||(S=!0,o.resolve(m,E))}var N=g(function(){x(F,B)});N.status==="error"&&B(N.value)}function g(m,x){var S={};try{S.value=m(x),S.status="success"}catch(B){S.status="error",S.value=B}return S}(n.exports=d).prototype.finally=function(m){if(typeof m!="function")return this;var x=this.constructor;return this.then(function(S){return x.resolve(m()).then(function(){return S})},function(S){return x.resolve(m()).then(function(){throw S})})},d.prototype.catch=function(m){return this.then(null,m)},d.prototype.then=function(m,x){if(typeof m!="function"&&this.state===c||typeof x!="function"&&this.state===l)return this;var S=new this.constructor(a);return this.state!==A?u(S,this.state===c?m:x,this.outcome):this.queue.push(new h(S,m,x)),S},h.prototype.callFulfilled=function(m){o.resolve(this.promise,m)},h.prototype.otherCallFulfilled=function(m){u(this.promise,this.onFulfilled,m)},h.prototype.callRejected=function(m){o.reject(this.promise,m)},h.prototype.otherCallRejected=function(m){u(this.promise,this.onRejected,m)},o.resolve=function(m,x){var S=g(p,x);if(S.status==="error")return o.reject(m,S.value);var B=S.value;if(B)f(m,B);else{m.state=c,m.outcome=x;for(var F=-1,N=m.queue.length;++F<N;)m.queue[F].callFulfilled(x)}return m},o.reject=function(m,x){m.state=l,m.outcome=x;for(var S=-1,B=m.queue.length;++S<B;)m.queue[S].callRejected(x);return m},d.resolve=function(m){return m instanceof this?m:o.resolve(new this(a),m)},d.reject=function(m){var x=new this(a);return o.reject(x,m)},d.all=function(m){var x=this;if(Object.prototype.toString.call(m)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=m.length,B=!1;if(!S)return this.resolve([]);for(var F=new Array(S),N=0,E=-1,w=new this(a);++E<S;)v(m[E],E);return w;function v(I,k){x.resolve(I).then(function(_){F[k]=_,++N!==S||B||(B=!0,o.resolve(w,F))},function(_){B||(B=!0,o.reject(w,_))})}},d.race=function(m){var x=this;if(Object.prototype.toString.call(m)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=m.length,B=!1;if(!S)return this.resolve([]);for(var F=-1,N=new this(a);++F<S;)E=m[F],x.resolve(E).then(function(w){B||(B=!0,o.resolve(N,w))},function(w){B||(B=!0,o.reject(N,w))});var E;return N}},{immediate:36}],38:[function(t,n,s){var i={};(0,t("./lib/utils/common").assign)(i,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),n.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,n,s){var i=t("./zlib/deflate"),a=t("./utils/common"),o=t("./utils/strings"),l=t("./zlib/messages"),c=t("./zlib/zstream"),A=Object.prototype.toString,d=0,h=-1,u=0,p=8;function f(m){if(!(this instanceof f))return new f(m);this.options=a.assign({level:h,method:p,chunkSize:16384,windowBits:15,memLevel:8,strategy:u,to:""},m||{});var x=this.options;x.raw&&0<x.windowBits?x.windowBits=-x.windowBits:x.gzip&&0<x.windowBits&&x.windowBits<16&&(x.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var S=i.deflateInit2(this.strm,x.level,x.method,x.windowBits,x.memLevel,x.strategy);if(S!==d)throw new Error(l[S]);if(x.header&&i.deflateSetHeader(this.strm,x.header),x.dictionary){var B;if(B=typeof x.dictionary=="string"?o.string2buf(x.dictionary):A.call(x.dictionary)==="[object ArrayBuffer]"?new Uint8Array(x.dictionary):x.dictionary,(S=i.deflateSetDictionary(this.strm,B))!==d)throw new Error(l[S]);this._dict_set=!0}}function g(m,x){var S=new f(x);if(S.push(m,!0),S.err)throw S.msg||l[S.err];return S.result}f.prototype.push=function(m,x){var S,B,F=this.strm,N=this.options.chunkSize;if(this.ended)return!1;B=x===~~x?x:x===!0?4:0,typeof m=="string"?F.input=o.string2buf(m):A.call(m)==="[object ArrayBuffer]"?F.input=new Uint8Array(m):F.input=m,F.next_in=0,F.avail_in=F.input.length;do{if(F.avail_out===0&&(F.output=new a.Buf8(N),F.next_out=0,F.avail_out=N),(S=i.deflate(F,B))!==1&&S!==d)return this.onEnd(S),!(this.ended=!0);F.avail_out!==0&&(F.avail_in!==0||B!==4&&B!==2)||(this.options.to==="string"?this.onData(o.buf2binstring(a.shrinkBuf(F.output,F.next_out))):this.onData(a.shrinkBuf(F.output,F.next_out)))}while((0<F.avail_in||F.avail_out===0)&&S!==1);return B===4?(S=i.deflateEnd(this.strm),this.onEnd(S),this.ended=!0,S===d):B!==2||(this.onEnd(d),!(F.avail_out=0))},f.prototype.onData=function(m){this.chunks.push(m)},f.prototype.onEnd=function(m){m===d&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=m,this.msg=this.strm.msg},s.Deflate=f,s.deflate=g,s.deflateRaw=function(m,x){return(x=x||{}).raw=!0,g(m,x)},s.gzip=function(m,x){return(x=x||{}).gzip=!0,g(m,x)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,n,s){var i=t("./zlib/inflate"),a=t("./utils/common"),o=t("./utils/strings"),l=t("./zlib/constants"),c=t("./zlib/messages"),A=t("./zlib/zstream"),d=t("./zlib/gzheader"),h=Object.prototype.toString;function u(f){if(!(this instanceof u))return new u(f);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},f||{});var g=this.options;g.raw&&0<=g.windowBits&&g.windowBits<16&&(g.windowBits=-g.windowBits,g.windowBits===0&&(g.windowBits=-15)),!(0<=g.windowBits&&g.windowBits<16)||f&&f.windowBits||(g.windowBits+=32),15<g.windowBits&&g.windowBits<48&&(15&g.windowBits)==0&&(g.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new A,this.strm.avail_out=0;var m=i.inflateInit2(this.strm,g.windowBits);if(m!==l.Z_OK)throw new Error(c[m]);this.header=new d,i.inflateGetHeader(this.strm,this.header)}function p(f,g){var m=new u(g);if(m.push(f,!0),m.err)throw m.msg||c[m.err];return m.result}u.prototype.push=function(f,g){var m,x,S,B,F,N,E=this.strm,w=this.options.chunkSize,v=this.options.dictionary,I=!1;if(this.ended)return!1;x=g===~~g?g:g===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof f=="string"?E.input=o.binstring2buf(f):h.call(f)==="[object ArrayBuffer]"?E.input=new Uint8Array(f):E.input=f,E.next_in=0,E.avail_in=E.input.length;do{if(E.avail_out===0&&(E.output=new a.Buf8(w),E.next_out=0,E.avail_out=w),(m=i.inflate(E,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&v&&(N=typeof v=="string"?o.string2buf(v):h.call(v)==="[object ArrayBuffer]"?new Uint8Array(v):v,m=i.inflateSetDictionary(this.strm,N)),m===l.Z_BUF_ERROR&&I===!0&&(m=l.Z_OK,I=!1),m!==l.Z_STREAM_END&&m!==l.Z_OK)return this.onEnd(m),!(this.ended=!0);E.next_out&&(E.avail_out!==0&&m!==l.Z_STREAM_END&&(E.avail_in!==0||x!==l.Z_FINISH&&x!==l.Z_SYNC_FLUSH)||(this.options.to==="string"?(S=o.utf8border(E.output,E.next_out),B=E.next_out-S,F=o.buf2string(E.output,S),E.next_out=B,E.avail_out=w-B,B&&a.arraySet(E.output,E.output,S,B,0),this.onData(F)):this.onData(a.shrinkBuf(E.output,E.next_out)))),E.avail_in===0&&E.avail_out===0&&(I=!0)}while((0<E.avail_in||E.avail_out===0)&&m!==l.Z_STREAM_END);return m===l.Z_STREAM_END&&(x=l.Z_FINISH),x===l.Z_FINISH?(m=i.inflateEnd(this.strm),this.onEnd(m),this.ended=!0,m===l.Z_OK):x!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),!(E.avail_out=0))},u.prototype.onData=function(f){this.chunks.push(f)},u.prototype.onEnd=function(f){f===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=f,this.msg=this.strm.msg},s.Inflate=u,s.inflate=p,s.inflateRaw=function(f,g){return(g=g||{}).raw=!0,p(f,g)},s.ungzip=p},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,n,s){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";s.assign=function(l){for(var c=Array.prototype.slice.call(arguments,1);c.length;){var A=c.shift();if(A){if(typeof A!="object")throw new TypeError(A+"must be non-object");for(var d in A)A.hasOwnProperty(d)&&(l[d]=A[d])}}return l},s.shrinkBuf=function(l,c){return l.length===c?l:l.subarray?l.subarray(0,c):(l.length=c,l)};var a={arraySet:function(l,c,A,d,h){if(c.subarray&&l.subarray)l.set(c.subarray(A,A+d),h);else for(var u=0;u<d;u++)l[h+u]=c[A+u]},flattenChunks:function(l){var c,A,d,h,u,p;for(c=d=0,A=l.length;c<A;c++)d+=l[c].length;for(p=new Uint8Array(d),c=h=0,A=l.length;c<A;c++)u=l[c],p.set(u,h),h+=u.length;return p}},o={arraySet:function(l,c,A,d,h){for(var u=0;u<d;u++)l[h+u]=c[A+u]},flattenChunks:function(l){return[].concat.apply([],l)}};s.setTyped=function(l){l?(s.Buf8=Uint8Array,s.Buf16=Uint16Array,s.Buf32=Int32Array,s.assign(s,a)):(s.Buf8=Array,s.Buf16=Array,s.Buf32=Array,s.assign(s,o))},s.setTyped(i)},{}],42:[function(t,n,s){var i=t("./common"),a=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch{a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{o=!1}for(var l=new i.Buf8(256),c=0;c<256;c++)l[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;function A(d,h){if(h<65537&&(d.subarray&&o||!d.subarray&&a))return String.fromCharCode.apply(null,i.shrinkBuf(d,h));for(var u="",p=0;p<h;p++)u+=String.fromCharCode(d[p]);return u}l[254]=l[254]=1,s.string2buf=function(d){var h,u,p,f,g,m=d.length,x=0;for(f=0;f<m;f++)(64512&(u=d.charCodeAt(f)))==55296&&f+1<m&&(64512&(p=d.charCodeAt(f+1)))==56320&&(u=65536+(u-55296<<10)+(p-56320),f++),x+=u<128?1:u<2048?2:u<65536?3:4;for(h=new i.Buf8(x),f=g=0;g<x;f++)(64512&(u=d.charCodeAt(f)))==55296&&f+1<m&&(64512&(p=d.charCodeAt(f+1)))==56320&&(u=65536+(u-55296<<10)+(p-56320),f++),u<128?h[g++]=u:(u<2048?h[g++]=192|u>>>6:(u<65536?h[g++]=224|u>>>12:(h[g++]=240|u>>>18,h[g++]=128|u>>>12&63),h[g++]=128|u>>>6&63),h[g++]=128|63&u);return h},s.buf2binstring=function(d){return A(d,d.length)},s.binstring2buf=function(d){for(var h=new i.Buf8(d.length),u=0,p=h.length;u<p;u++)h[u]=d.charCodeAt(u);return h},s.buf2string=function(d,h){var u,p,f,g,m=h||d.length,x=new Array(2*m);for(u=p=0;u<m;)if((f=d[u++])<128)x[p++]=f;else if(4<(g=l[f]))x[p++]=65533,u+=g-1;else{for(f&=g===2?31:g===3?15:7;1<g&&u<m;)f=f<<6|63&d[u++],g--;1<g?x[p++]=65533:f<65536?x[p++]=f:(f-=65536,x[p++]=55296|f>>10&1023,x[p++]=56320|1023&f)}return A(x,p)},s.utf8border=function(d,h){var u;for((h=h||d.length)>d.length&&(h=d.length),u=h-1;0<=u&&(192&d[u])==128;)u--;return u<0||u===0?h:u+l[d[u]]>h?u:h}},{"./common":41}],43:[function(t,n,s){n.exports=function(i,a,o,l){for(var c=65535&i|0,A=i>>>16&65535|0,d=0;o!==0;){for(o-=d=2e3<o?2e3:o;A=A+(c=c+a[l++]|0)|0,--d;);c%=65521,A%=65521}return c|A<<16|0}},{}],44:[function(t,n,s){n.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,n,s){var i=(function(){for(var a,o=[],l=0;l<256;l++){a=l;for(var c=0;c<8;c++)a=1&a?3988292384^a>>>1:a>>>1;o[l]=a}return o})();n.exports=function(a,o,l,c){var A=i,d=c+l;a^=-1;for(var h=c;h<d;h++)a=a>>>8^A[255&(a^o[h])];return-1^a}},{}],46:[function(t,n,s){var i,a=t("../utils/common"),o=t("./trees"),l=t("./adler32"),c=t("./crc32"),A=t("./messages"),d=0,h=4,u=0,p=-2,f=-1,g=4,m=2,x=8,S=9,B=286,F=30,N=19,E=2*B+1,w=15,v=3,I=258,k=I+v+1,_=42,T=113,L=1,K=2,se=3,X=4;function $(D,G){return D.msg=A[G],G}function V(D){return(D<<1)-(4<D?9:0)}function he(D){for(var G=D.length;0<=--G;)D[G]=0}function z(D){var G=D.state,ce=G.pending;ce>D.avail_out&&(ce=D.avail_out),ce!==0&&(a.arraySet(D.output,G.pending_buf,G.pending_out,ce,D.next_out),D.next_out+=ce,G.pending_out+=ce,D.total_out+=ce,D.avail_out-=ce,G.pending-=ce,G.pending===0&&(G.pending_out=0))}function M(D,G){o._tr_flush_block(D,0<=D.block_start?D.block_start:-1,D.strstart-D.block_start,G),D.block_start=D.strstart,z(D.strm)}function O(D,G){D.pending_buf[D.pending++]=G}function H(D,G){D.pending_buf[D.pending++]=G>>>8&255,D.pending_buf[D.pending++]=255&G}function J(D,G){var ce,Z,W=D.max_chain_length,ee=D.strstart,ye=D.prev_length,xe=D.nice_match,we=D.strstart>D.w_size-k?D.strstart-(D.w_size-k):0,Ee=D.window,Ne=D.w_mask,Ue=D.prev,je=D.strstart+I,st=Ee[ee+ye-1],Ze=Ee[ee+ye];D.prev_length>=D.good_match&&(W>>=2),xe>D.lookahead&&(xe=D.lookahead);do if(Ee[(ce=G)+ye]===Ze&&Ee[ce+ye-1]===st&&Ee[ce]===Ee[ee]&&Ee[++ce]===Ee[ee+1]){ee+=2,ce++;do;while(Ee[++ee]===Ee[++ce]&&Ee[++ee]===Ee[++ce]&&Ee[++ee]===Ee[++ce]&&Ee[++ee]===Ee[++ce]&&Ee[++ee]===Ee[++ce]&&Ee[++ee]===Ee[++ce]&&Ee[++ee]===Ee[++ce]&&Ee[++ee]===Ee[++ce]&&ee<je);if(Z=I-(je-ee),ee=je-I,ye<Z){if(D.match_start=G,xe<=(ye=Z))break;st=Ee[ee+ye-1],Ze=Ee[ee+ye]}}while((G=Ue[G&Ne])>we&&--W!=0);return ye<=D.lookahead?ye:D.lookahead}function de(D){var G,ce,Z,W,ee,ye,xe,we,Ee,Ne,Ue=D.w_size;do{if(W=D.window_size-D.lookahead-D.strstart,D.strstart>=Ue+(Ue-k)){for(a.arraySet(D.window,D.window,Ue,Ue,0),D.match_start-=Ue,D.strstart-=Ue,D.block_start-=Ue,G=ce=D.hash_size;Z=D.head[--G],D.head[G]=Ue<=Z?Z-Ue:0,--ce;);for(G=ce=Ue;Z=D.prev[--G],D.prev[G]=Ue<=Z?Z-Ue:0,--ce;);W+=Ue}if(D.strm.avail_in===0)break;if(ye=D.strm,xe=D.window,we=D.strstart+D.lookahead,Ee=W,Ne=void 0,Ne=ye.avail_in,Ee<Ne&&(Ne=Ee),ce=Ne===0?0:(ye.avail_in-=Ne,a.arraySet(xe,ye.input,ye.next_in,Ne,we),ye.state.wrap===1?ye.adler=l(ye.adler,xe,Ne,we):ye.state.wrap===2&&(ye.adler=c(ye.adler,xe,Ne,we)),ye.next_in+=Ne,ye.total_in+=Ne,Ne),D.lookahead+=ce,D.lookahead+D.insert>=v)for(ee=D.strstart-D.insert,D.ins_h=D.window[ee],D.ins_h=(D.ins_h<<D.hash_shift^D.window[ee+1])&D.hash_mask;D.insert&&(D.ins_h=(D.ins_h<<D.hash_shift^D.window[ee+v-1])&D.hash_mask,D.prev[ee&D.w_mask]=D.head[D.ins_h],D.head[D.ins_h]=ee,ee++,D.insert--,!(D.lookahead+D.insert<v)););}while(D.lookahead<k&&D.strm.avail_in!==0)}function ie(D,G){for(var ce,Z;;){if(D.lookahead<k){if(de(D),D.lookahead<k&&G===d)return L;if(D.lookahead===0)break}if(ce=0,D.lookahead>=v&&(D.ins_h=(D.ins_h<<D.hash_shift^D.window[D.strstart+v-1])&D.hash_mask,ce=D.prev[D.strstart&D.w_mask]=D.head[D.ins_h],D.head[D.ins_h]=D.strstart),ce!==0&&D.strstart-ce<=D.w_size-k&&(D.match_length=J(D,ce)),D.match_length>=v)if(Z=o._tr_tally(D,D.strstart-D.match_start,D.match_length-v),D.lookahead-=D.match_length,D.match_length<=D.max_lazy_match&&D.lookahead>=v){for(D.match_length--;D.strstart++,D.ins_h=(D.ins_h<<D.hash_shift^D.window[D.strstart+v-1])&D.hash_mask,ce=D.prev[D.strstart&D.w_mask]=D.head[D.ins_h],D.head[D.ins_h]=D.strstart,--D.match_length!=0;);D.strstart++}else D.strstart+=D.match_length,D.match_length=0,D.ins_h=D.window[D.strstart],D.ins_h=(D.ins_h<<D.hash_shift^D.window[D.strstart+1])&D.hash_mask;else Z=o._tr_tally(D,0,D.window[D.strstart]),D.lookahead--,D.strstart++;if(Z&&(M(D,!1),D.strm.avail_out===0))return L}return D.insert=D.strstart<v-1?D.strstart:v-1,G===h?(M(D,!0),D.strm.avail_out===0?se:X):D.last_lit&&(M(D,!1),D.strm.avail_out===0)?L:K}function le(D,G){for(var ce,Z,W;;){if(D.lookahead<k){if(de(D),D.lookahead<k&&G===d)return L;if(D.lookahead===0)break}if(ce=0,D.lookahead>=v&&(D.ins_h=(D.ins_h<<D.hash_shift^D.window[D.strstart+v-1])&D.hash_mask,ce=D.prev[D.strstart&D.w_mask]=D.head[D.ins_h],D.head[D.ins_h]=D.strstart),D.prev_length=D.match_length,D.prev_match=D.match_start,D.match_length=v-1,ce!==0&&D.prev_length<D.max_lazy_match&&D.strstart-ce<=D.w_size-k&&(D.match_length=J(D,ce),D.match_length<=5&&(D.strategy===1||D.match_length===v&&4096<D.strstart-D.match_start)&&(D.match_length=v-1)),D.prev_length>=v&&D.match_length<=D.prev_length){for(W=D.strstart+D.lookahead-v,Z=o._tr_tally(D,D.strstart-1-D.prev_match,D.prev_length-v),D.lookahead-=D.prev_length-1,D.prev_length-=2;++D.strstart<=W&&(D.ins_h=(D.ins_h<<D.hash_shift^D.window[D.strstart+v-1])&D.hash_mask,ce=D.prev[D.strstart&D.w_mask]=D.head[D.ins_h],D.head[D.ins_h]=D.strstart),--D.prev_length!=0;);if(D.match_available=0,D.match_length=v-1,D.strstart++,Z&&(M(D,!1),D.strm.avail_out===0))return L}else if(D.match_available){if((Z=o._tr_tally(D,0,D.window[D.strstart-1]))&&M(D,!1),D.strstart++,D.lookahead--,D.strm.avail_out===0)return L}else D.match_available=1,D.strstart++,D.lookahead--}return D.match_available&&(Z=o._tr_tally(D,0,D.window[D.strstart-1]),D.match_available=0),D.insert=D.strstart<v-1?D.strstart:v-1,G===h?(M(D,!0),D.strm.avail_out===0?se:X):D.last_lit&&(M(D,!1),D.strm.avail_out===0)?L:K}function fe(D,G,ce,Z,W){this.good_length=D,this.max_lazy=G,this.nice_length=ce,this.max_chain=Z,this.func=W}function ve(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=x,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(2*E),this.dyn_dtree=new a.Buf16(2*(2*F+1)),this.bl_tree=new a.Buf16(2*(2*N+1)),he(this.dyn_ltree),he(this.dyn_dtree),he(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(w+1),this.heap=new a.Buf16(2*B+1),he(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(2*B+1),he(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Ce(D){var G;return D&&D.state?(D.total_in=D.total_out=0,D.data_type=m,(G=D.state).pending=0,G.pending_out=0,G.wrap<0&&(G.wrap=-G.wrap),G.status=G.wrap?_:T,D.adler=G.wrap===2?0:1,G.last_flush=d,o._tr_init(G),u):$(D,p)}function Be(D){var G=Ce(D);return G===u&&(function(ce){ce.window_size=2*ce.w_size,he(ce.head),ce.max_lazy_match=i[ce.level].max_lazy,ce.good_match=i[ce.level].good_length,ce.nice_match=i[ce.level].nice_length,ce.max_chain_length=i[ce.level].max_chain,ce.strstart=0,ce.block_start=0,ce.lookahead=0,ce.insert=0,ce.match_length=ce.prev_length=v-1,ce.match_available=0,ce.ins_h=0})(D.state),G}function Qe(D,G,ce,Z,W,ee){if(!D)return p;var ye=1;if(G===f&&(G=6),Z<0?(ye=0,Z=-Z):15<Z&&(ye=2,Z-=16),W<1||S<W||ce!==x||Z<8||15<Z||G<0||9<G||ee<0||g<ee)return $(D,p);Z===8&&(Z=9);var xe=new ve;return(D.state=xe).strm=D,xe.wrap=ye,xe.gzhead=null,xe.w_bits=Z,xe.w_size=1<<xe.w_bits,xe.w_mask=xe.w_size-1,xe.hash_bits=W+7,xe.hash_size=1<<xe.hash_bits,xe.hash_mask=xe.hash_size-1,xe.hash_shift=~~((xe.hash_bits+v-1)/v),xe.window=new a.Buf8(2*xe.w_size),xe.head=new a.Buf16(xe.hash_size),xe.prev=new a.Buf16(xe.w_size),xe.lit_bufsize=1<<W+6,xe.pending_buf_size=4*xe.lit_bufsize,xe.pending_buf=new a.Buf8(xe.pending_buf_size),xe.d_buf=1*xe.lit_bufsize,xe.l_buf=3*xe.lit_bufsize,xe.level=G,xe.strategy=ee,xe.method=ce,Be(D)}i=[new fe(0,0,0,0,function(D,G){var ce=65535;for(ce>D.pending_buf_size-5&&(ce=D.pending_buf_size-5);;){if(D.lookahead<=1){if(de(D),D.lookahead===0&&G===d)return L;if(D.lookahead===0)break}D.strstart+=D.lookahead,D.lookahead=0;var Z=D.block_start+ce;if((D.strstart===0||D.strstart>=Z)&&(D.lookahead=D.strstart-Z,D.strstart=Z,M(D,!1),D.strm.avail_out===0)||D.strstart-D.block_start>=D.w_size-k&&(M(D,!1),D.strm.avail_out===0))return L}return D.insert=0,G===h?(M(D,!0),D.strm.avail_out===0?se:X):(D.strstart>D.block_start&&(M(D,!1),D.strm.avail_out),L)}),new fe(4,4,8,4,ie),new fe(4,5,16,8,ie),new fe(4,6,32,32,ie),new fe(4,4,16,16,le),new fe(8,16,32,32,le),new fe(8,16,128,128,le),new fe(8,32,128,256,le),new fe(32,128,258,1024,le),new fe(32,258,258,4096,le)],s.deflateInit=function(D,G){return Qe(D,G,x,15,8,0)},s.deflateInit2=Qe,s.deflateReset=Be,s.deflateResetKeep=Ce,s.deflateSetHeader=function(D,G){return D&&D.state?D.state.wrap!==2?p:(D.state.gzhead=G,u):p},s.deflate=function(D,G){var ce,Z,W,ee;if(!D||!D.state||5<G||G<0)return D?$(D,p):p;if(Z=D.state,!D.output||!D.input&&D.avail_in!==0||Z.status===666&&G!==h)return $(D,D.avail_out===0?-5:p);if(Z.strm=D,ce=Z.last_flush,Z.last_flush=G,Z.status===_)if(Z.wrap===2)D.adler=0,O(Z,31),O(Z,139),O(Z,8),Z.gzhead?(O(Z,(Z.gzhead.text?1:0)+(Z.gzhead.hcrc?2:0)+(Z.gzhead.extra?4:0)+(Z.gzhead.name?8:0)+(Z.gzhead.comment?16:0)),O(Z,255&Z.gzhead.time),O(Z,Z.gzhead.time>>8&255),O(Z,Z.gzhead.time>>16&255),O(Z,Z.gzhead.time>>24&255),O(Z,Z.level===9?2:2<=Z.strategy||Z.level<2?4:0),O(Z,255&Z.gzhead.os),Z.gzhead.extra&&Z.gzhead.extra.length&&(O(Z,255&Z.gzhead.extra.length),O(Z,Z.gzhead.extra.length>>8&255)),Z.gzhead.hcrc&&(D.adler=c(D.adler,Z.pending_buf,Z.pending,0)),Z.gzindex=0,Z.status=69):(O(Z,0),O(Z,0),O(Z,0),O(Z,0),O(Z,0),O(Z,Z.level===9?2:2<=Z.strategy||Z.level<2?4:0),O(Z,3),Z.status=T);else{var ye=x+(Z.w_bits-8<<4)<<8;ye|=(2<=Z.strategy||Z.level<2?0:Z.level<6?1:Z.level===6?2:3)<<6,Z.strstart!==0&&(ye|=32),ye+=31-ye%31,Z.status=T,H(Z,ye),Z.strstart!==0&&(H(Z,D.adler>>>16),H(Z,65535&D.adler)),D.adler=1}if(Z.status===69)if(Z.gzhead.extra){for(W=Z.pending;Z.gzindex<(65535&Z.gzhead.extra.length)&&(Z.pending!==Z.pending_buf_size||(Z.gzhead.hcrc&&Z.pending>W&&(D.adler=c(D.adler,Z.pending_buf,Z.pending-W,W)),z(D),W=Z.pending,Z.pending!==Z.pending_buf_size));)O(Z,255&Z.gzhead.extra[Z.gzindex]),Z.gzindex++;Z.gzhead.hcrc&&Z.pending>W&&(D.adler=c(D.adler,Z.pending_buf,Z.pending-W,W)),Z.gzindex===Z.gzhead.extra.length&&(Z.gzindex=0,Z.status=73)}else Z.status=73;if(Z.status===73)if(Z.gzhead.name){W=Z.pending;do{if(Z.pending===Z.pending_buf_size&&(Z.gzhead.hcrc&&Z.pending>W&&(D.adler=c(D.adler,Z.pending_buf,Z.pending-W,W)),z(D),W=Z.pending,Z.pending===Z.pending_buf_size)){ee=1;break}ee=Z.gzindex<Z.gzhead.name.length?255&Z.gzhead.name.charCodeAt(Z.gzindex++):0,O(Z,ee)}while(ee!==0);Z.gzhead.hcrc&&Z.pending>W&&(D.adler=c(D.adler,Z.pending_buf,Z.pending-W,W)),ee===0&&(Z.gzindex=0,Z.status=91)}else Z.status=91;if(Z.status===91)if(Z.gzhead.comment){W=Z.pending;do{if(Z.pending===Z.pending_buf_size&&(Z.gzhead.hcrc&&Z.pending>W&&(D.adler=c(D.adler,Z.pending_buf,Z.pending-W,W)),z(D),W=Z.pending,Z.pending===Z.pending_buf_size)){ee=1;break}ee=Z.gzindex<Z.gzhead.comment.length?255&Z.gzhead.comment.charCodeAt(Z.gzindex++):0,O(Z,ee)}while(ee!==0);Z.gzhead.hcrc&&Z.pending>W&&(D.adler=c(D.adler,Z.pending_buf,Z.pending-W,W)),ee===0&&(Z.status=103)}else Z.status=103;if(Z.status===103&&(Z.gzhead.hcrc?(Z.pending+2>Z.pending_buf_size&&z(D),Z.pending+2<=Z.pending_buf_size&&(O(Z,255&D.adler),O(Z,D.adler>>8&255),D.adler=0,Z.status=T)):Z.status=T),Z.pending!==0){if(z(D),D.avail_out===0)return Z.last_flush=-1,u}else if(D.avail_in===0&&V(G)<=V(ce)&&G!==h)return $(D,-5);if(Z.status===666&&D.avail_in!==0)return $(D,-5);if(D.avail_in!==0||Z.lookahead!==0||G!==d&&Z.status!==666){var xe=Z.strategy===2?(function(we,Ee){for(var Ne;;){if(we.lookahead===0&&(de(we),we.lookahead===0)){if(Ee===d)return L;break}if(we.match_length=0,Ne=o._tr_tally(we,0,we.window[we.strstart]),we.lookahead--,we.strstart++,Ne&&(M(we,!1),we.strm.avail_out===0))return L}return we.insert=0,Ee===h?(M(we,!0),we.strm.avail_out===0?se:X):we.last_lit&&(M(we,!1),we.strm.avail_out===0)?L:K})(Z,G):Z.strategy===3?(function(we,Ee){for(var Ne,Ue,je,st,Ze=we.window;;){if(we.lookahead<=I){if(de(we),we.lookahead<=I&&Ee===d)return L;if(we.lookahead===0)break}if(we.match_length=0,we.lookahead>=v&&0<we.strstart&&(Ue=Ze[je=we.strstart-1])===Ze[++je]&&Ue===Ze[++je]&&Ue===Ze[++je]){st=we.strstart+I;do;while(Ue===Ze[++je]&&Ue===Ze[++je]&&Ue===Ze[++je]&&Ue===Ze[++je]&&Ue===Ze[++je]&&Ue===Ze[++je]&&Ue===Ze[++je]&&Ue===Ze[++je]&&je<st);we.match_length=I-(st-je),we.match_length>we.lookahead&&(we.match_length=we.lookahead)}if(we.match_length>=v?(Ne=o._tr_tally(we,1,we.match_length-v),we.lookahead-=we.match_length,we.strstart+=we.match_length,we.match_length=0):(Ne=o._tr_tally(we,0,we.window[we.strstart]),we.lookahead--,we.strstart++),Ne&&(M(we,!1),we.strm.avail_out===0))return L}return we.insert=0,Ee===h?(M(we,!0),we.strm.avail_out===0?se:X):we.last_lit&&(M(we,!1),we.strm.avail_out===0)?L:K})(Z,G):i[Z.level].func(Z,G);if(xe!==se&&xe!==X||(Z.status=666),xe===L||xe===se)return D.avail_out===0&&(Z.last_flush=-1),u;if(xe===K&&(G===1?o._tr_align(Z):G!==5&&(o._tr_stored_block(Z,0,0,!1),G===3&&(he(Z.head),Z.lookahead===0&&(Z.strstart=0,Z.block_start=0,Z.insert=0))),z(D),D.avail_out===0))return Z.last_flush=-1,u}return G!==h?u:Z.wrap<=0?1:(Z.wrap===2?(O(Z,255&D.adler),O(Z,D.adler>>8&255),O(Z,D.adler>>16&255),O(Z,D.adler>>24&255),O(Z,255&D.total_in),O(Z,D.total_in>>8&255),O(Z,D.total_in>>16&255),O(Z,D.total_in>>24&255)):(H(Z,D.adler>>>16),H(Z,65535&D.adler)),z(D),0<Z.wrap&&(Z.wrap=-Z.wrap),Z.pending!==0?u:1)},s.deflateEnd=function(D){var G;return D&&D.state?(G=D.state.status)!==_&&G!==69&&G!==73&&G!==91&&G!==103&&G!==T&&G!==666?$(D,p):(D.state=null,G===T?$(D,-3):u):p},s.deflateSetDictionary=function(D,G){var ce,Z,W,ee,ye,xe,we,Ee,Ne=G.length;if(!D||!D.state||(ee=(ce=D.state).wrap)===2||ee===1&&ce.status!==_||ce.lookahead)return p;for(ee===1&&(D.adler=l(D.adler,G,Ne,0)),ce.wrap=0,Ne>=ce.w_size&&(ee===0&&(he(ce.head),ce.strstart=0,ce.block_start=0,ce.insert=0),Ee=new a.Buf8(ce.w_size),a.arraySet(Ee,G,Ne-ce.w_size,ce.w_size,0),G=Ee,Ne=ce.w_size),ye=D.avail_in,xe=D.next_in,we=D.input,D.avail_in=Ne,D.next_in=0,D.input=G,de(ce);ce.lookahead>=v;){for(Z=ce.strstart,W=ce.lookahead-(v-1);ce.ins_h=(ce.ins_h<<ce.hash_shift^ce.window[Z+v-1])&ce.hash_mask,ce.prev[Z&ce.w_mask]=ce.head[ce.ins_h],ce.head[ce.ins_h]=Z,Z++,--W;);ce.strstart=Z,ce.lookahead=v-1,de(ce)}return ce.strstart+=ce.lookahead,ce.block_start=ce.strstart,ce.insert=ce.lookahead,ce.lookahead=0,ce.match_length=ce.prev_length=v-1,ce.match_available=0,D.next_in=xe,D.input=we,D.avail_in=ye,ce.wrap=ee,u},s.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,n,s){n.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,n,s){n.exports=function(i,a){var o,l,c,A,d,h,u,p,f,g,m,x,S,B,F,N,E,w,v,I,k,_,T,L,K;o=i.state,l=i.next_in,L=i.input,c=l+(i.avail_in-5),A=i.next_out,K=i.output,d=A-(a-i.avail_out),h=A+(i.avail_out-257),u=o.dmax,p=o.wsize,f=o.whave,g=o.wnext,m=o.window,x=o.hold,S=o.bits,B=o.lencode,F=o.distcode,N=(1<<o.lenbits)-1,E=(1<<o.distbits)-1;e:do{S<15&&(x+=L[l++]<<S,S+=8,x+=L[l++]<<S,S+=8),w=B[x&N];t:for(;;){if(x>>>=v=w>>>24,S-=v,(v=w>>>16&255)===0)K[A++]=65535&w;else{if(!(16&v)){if((64&v)==0){w=B[(65535&w)+(x&(1<<v)-1)];continue t}if(32&v){o.mode=12;break e}i.msg="invalid literal/length code",o.mode=30;break e}I=65535&w,(v&=15)&&(S<v&&(x+=L[l++]<<S,S+=8),I+=x&(1<<v)-1,x>>>=v,S-=v),S<15&&(x+=L[l++]<<S,S+=8,x+=L[l++]<<S,S+=8),w=F[x&E];r:for(;;){if(x>>>=v=w>>>24,S-=v,!(16&(v=w>>>16&255))){if((64&v)==0){w=F[(65535&w)+(x&(1<<v)-1)];continue r}i.msg="invalid distance code",o.mode=30;break e}if(k=65535&w,S<(v&=15)&&(x+=L[l++]<<S,(S+=8)<v&&(x+=L[l++]<<S,S+=8)),u<(k+=x&(1<<v)-1)){i.msg="invalid distance too far back",o.mode=30;break e}if(x>>>=v,S-=v,(v=A-d)<k){if(f<(v=k-v)&&o.sane){i.msg="invalid distance too far back",o.mode=30;break e}if(T=m,(_=0)===g){if(_+=p-v,v<I){for(I-=v;K[A++]=m[_++],--v;);_=A-k,T=K}}else if(g<v){if(_+=p+g-v,(v-=g)<I){for(I-=v;K[A++]=m[_++],--v;);if(_=0,g<I){for(I-=v=g;K[A++]=m[_++],--v;);_=A-k,T=K}}}else if(_+=g-v,v<I){for(I-=v;K[A++]=m[_++],--v;);_=A-k,T=K}for(;2<I;)K[A++]=T[_++],K[A++]=T[_++],K[A++]=T[_++],I-=3;I&&(K[A++]=T[_++],1<I&&(K[A++]=T[_++]))}else{for(_=A-k;K[A++]=K[_++],K[A++]=K[_++],K[A++]=K[_++],2<(I-=3););I&&(K[A++]=K[_++],1<I&&(K[A++]=K[_++]))}break}}break}}while(l<c&&A<h);l-=I=S>>3,x&=(1<<(S-=I<<3))-1,i.next_in=l,i.next_out=A,i.avail_in=l<c?c-l+5:5-(l-c),i.avail_out=A<h?h-A+257:257-(A-h),o.hold=x,o.bits=S}},{}],49:[function(t,n,s){var i=t("../utils/common"),a=t("./adler32"),o=t("./crc32"),l=t("./inffast"),c=t("./inftrees"),A=1,d=2,h=0,u=-2,p=1,f=852,g=592;function m(_){return(_>>>24&255)+(_>>>8&65280)+((65280&_)<<8)+((255&_)<<24)}function x(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function S(_){var T;return _&&_.state?(T=_.state,_.total_in=_.total_out=T.total=0,_.msg="",T.wrap&&(_.adler=1&T.wrap),T.mode=p,T.last=0,T.havedict=0,T.dmax=32768,T.head=null,T.hold=0,T.bits=0,T.lencode=T.lendyn=new i.Buf32(f),T.distcode=T.distdyn=new i.Buf32(g),T.sane=1,T.back=-1,h):u}function B(_){var T;return _&&_.state?((T=_.state).wsize=0,T.whave=0,T.wnext=0,S(_)):u}function F(_,T){var L,K;return _&&_.state?(K=_.state,T<0?(L=0,T=-T):(L=1+(T>>4),T<48&&(T&=15)),T&&(T<8||15<T)?u:(K.window!==null&&K.wbits!==T&&(K.window=null),K.wrap=L,K.wbits=T,B(_))):u}function N(_,T){var L,K;return _?(K=new x,(_.state=K).window=null,(L=F(_,T))!==h&&(_.state=null),L):u}var E,w,v=!0;function I(_){if(v){var T;for(E=new i.Buf32(512),w=new i.Buf32(32),T=0;T<144;)_.lens[T++]=8;for(;T<256;)_.lens[T++]=9;for(;T<280;)_.lens[T++]=7;for(;T<288;)_.lens[T++]=8;for(c(A,_.lens,0,288,E,0,_.work,{bits:9}),T=0;T<32;)_.lens[T++]=5;c(d,_.lens,0,32,w,0,_.work,{bits:5}),v=!1}_.lencode=E,_.lenbits=9,_.distcode=w,_.distbits=5}function k(_,T,L,K){var se,X=_.state;return X.window===null&&(X.wsize=1<<X.wbits,X.wnext=0,X.whave=0,X.window=new i.Buf8(X.wsize)),K>=X.wsize?(i.arraySet(X.window,T,L-X.wsize,X.wsize,0),X.wnext=0,X.whave=X.wsize):(K<(se=X.wsize-X.wnext)&&(se=K),i.arraySet(X.window,T,L-K,se,X.wnext),(K-=se)?(i.arraySet(X.window,T,L-K,K,0),X.wnext=K,X.whave=X.wsize):(X.wnext+=se,X.wnext===X.wsize&&(X.wnext=0),X.whave<X.wsize&&(X.whave+=se))),0}s.inflateReset=B,s.inflateReset2=F,s.inflateResetKeep=S,s.inflateInit=function(_){return N(_,15)},s.inflateInit2=N,s.inflate=function(_,T){var L,K,se,X,$,V,he,z,M,O,H,J,de,ie,le,fe,ve,Ce,Be,Qe,D,G,ce,Z,W=0,ee=new i.Buf8(4),ye=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!_||!_.state||!_.output||!_.input&&_.avail_in!==0)return u;(L=_.state).mode===12&&(L.mode=13),$=_.next_out,se=_.output,he=_.avail_out,X=_.next_in,K=_.input,V=_.avail_in,z=L.hold,M=L.bits,O=V,H=he,G=h;e:for(;;)switch(L.mode){case p:if(L.wrap===0){L.mode=13;break}for(;M<16;){if(V===0)break e;V--,z+=K[X++]<<M,M+=8}if(2&L.wrap&&z===35615){ee[L.check=0]=255&z,ee[1]=z>>>8&255,L.check=o(L.check,ee,2,0),M=z=0,L.mode=2;break}if(L.flags=0,L.head&&(L.head.done=!1),!(1&L.wrap)||(((255&z)<<8)+(z>>8))%31){_.msg="incorrect header check",L.mode=30;break}if((15&z)!=8){_.msg="unknown compression method",L.mode=30;break}if(M-=4,D=8+(15&(z>>>=4)),L.wbits===0)L.wbits=D;else if(D>L.wbits){_.msg="invalid window size",L.mode=30;break}L.dmax=1<<D,_.adler=L.check=1,L.mode=512&z?10:12,M=z=0;break;case 2:for(;M<16;){if(V===0)break e;V--,z+=K[X++]<<M,M+=8}if(L.flags=z,(255&L.flags)!=8){_.msg="unknown compression method",L.mode=30;break}if(57344&L.flags){_.msg="unknown header flags set",L.mode=30;break}L.head&&(L.head.text=z>>8&1),512&L.flags&&(ee[0]=255&z,ee[1]=z>>>8&255,L.check=o(L.check,ee,2,0)),M=z=0,L.mode=3;case 3:for(;M<32;){if(V===0)break e;V--,z+=K[X++]<<M,M+=8}L.head&&(L.head.time=z),512&L.flags&&(ee[0]=255&z,ee[1]=z>>>8&255,ee[2]=z>>>16&255,ee[3]=z>>>24&255,L.check=o(L.check,ee,4,0)),M=z=0,L.mode=4;case 4:for(;M<16;){if(V===0)break e;V--,z+=K[X++]<<M,M+=8}L.head&&(L.head.xflags=255&z,L.head.os=z>>8),512&L.flags&&(ee[0]=255&z,ee[1]=z>>>8&255,L.check=o(L.check,ee,2,0)),M=z=0,L.mode=5;case 5:if(1024&L.flags){for(;M<16;){if(V===0)break e;V--,z+=K[X++]<<M,M+=8}L.length=z,L.head&&(L.head.extra_len=z),512&L.flags&&(ee[0]=255&z,ee[1]=z>>>8&255,L.check=o(L.check,ee,2,0)),M=z=0}else L.head&&(L.head.extra=null);L.mode=6;case 6:if(1024&L.flags&&(V<(J=L.length)&&(J=V),J&&(L.head&&(D=L.head.extra_len-L.length,L.head.extra||(L.head.extra=new Array(L.head.extra_len)),i.arraySet(L.head.extra,K,X,J,D)),512&L.flags&&(L.check=o(L.check,K,J,X)),V-=J,X+=J,L.length-=J),L.length))break e;L.length=0,L.mode=7;case 7:if(2048&L.flags){if(V===0)break e;for(J=0;D=K[X+J++],L.head&&D&&L.length<65536&&(L.head.name+=String.fromCharCode(D)),D&&J<V;);if(512&L.flags&&(L.check=o(L.check,K,J,X)),V-=J,X+=J,D)break e}else L.head&&(L.head.name=null);L.length=0,L.mode=8;case 8:if(4096&L.flags){if(V===0)break e;for(J=0;D=K[X+J++],L.head&&D&&L.length<65536&&(L.head.comment+=String.fromCharCode(D)),D&&J<V;);if(512&L.flags&&(L.check=o(L.check,K,J,X)),V-=J,X+=J,D)break e}else L.head&&(L.head.comment=null);L.mode=9;case 9:if(512&L.flags){for(;M<16;){if(V===0)break e;V--,z+=K[X++]<<M,M+=8}if(z!==(65535&L.check)){_.msg="header crc mismatch",L.mode=30;break}M=z=0}L.head&&(L.head.hcrc=L.flags>>9&1,L.head.done=!0),_.adler=L.check=0,L.mode=12;break;case 10:for(;M<32;){if(V===0)break e;V--,z+=K[X++]<<M,M+=8}_.adler=L.check=m(z),M=z=0,L.mode=11;case 11:if(L.havedict===0)return _.next_out=$,_.avail_out=he,_.next_in=X,_.avail_in=V,L.hold=z,L.bits=M,2;_.adler=L.check=1,L.mode=12;case 12:if(T===5||T===6)break e;case 13:if(L.last){z>>>=7&M,M-=7&M,L.mode=27;break}for(;M<3;){if(V===0)break e;V--,z+=K[X++]<<M,M+=8}switch(L.last=1&z,M-=1,3&(z>>>=1)){case 0:L.mode=14;break;case 1:if(I(L),L.mode=20,T!==6)break;z>>>=2,M-=2;break e;case 2:L.mode=17;break;case 3:_.msg="invalid block type",L.mode=30}z>>>=2,M-=2;break;case 14:for(z>>>=7&M,M-=7&M;M<32;){if(V===0)break e;V--,z+=K[X++]<<M,M+=8}if((65535&z)!=(z>>>16^65535)){_.msg="invalid stored block lengths",L.mode=30;break}if(L.length=65535&z,M=z=0,L.mode=15,T===6)break e;case 15:L.mode=16;case 16:if(J=L.length){if(V<J&&(J=V),he<J&&(J=he),J===0)break e;i.arraySet(se,K,X,J,$),V-=J,X+=J,he-=J,$+=J,L.length-=J;break}L.mode=12;break;case 17:for(;M<14;){if(V===0)break e;V--,z+=K[X++]<<M,M+=8}if(L.nlen=257+(31&z),z>>>=5,M-=5,L.ndist=1+(31&z),z>>>=5,M-=5,L.ncode=4+(15&z),z>>>=4,M-=4,286<L.nlen||30<L.ndist){_.msg="too many length or distance symbols",L.mode=30;break}L.have=0,L.mode=18;case 18:for(;L.have<L.ncode;){for(;M<3;){if(V===0)break e;V--,z+=K[X++]<<M,M+=8}L.lens[ye[L.have++]]=7&z,z>>>=3,M-=3}for(;L.have<19;)L.lens[ye[L.have++]]=0;if(L.lencode=L.lendyn,L.lenbits=7,ce={bits:L.lenbits},G=c(0,L.lens,0,19,L.lencode,0,L.work,ce),L.lenbits=ce.bits,G){_.msg="invalid code lengths set",L.mode=30;break}L.have=0,L.mode=19;case 19:for(;L.have<L.nlen+L.ndist;){for(;fe=(W=L.lencode[z&(1<<L.lenbits)-1])>>>16&255,ve=65535&W,!((le=W>>>24)<=M);){if(V===0)break e;V--,z+=K[X++]<<M,M+=8}if(ve<16)z>>>=le,M-=le,L.lens[L.have++]=ve;else{if(ve===16){for(Z=le+2;M<Z;){if(V===0)break e;V--,z+=K[X++]<<M,M+=8}if(z>>>=le,M-=le,L.have===0){_.msg="invalid bit length repeat",L.mode=30;break}D=L.lens[L.have-1],J=3+(3&z),z>>>=2,M-=2}else if(ve===17){for(Z=le+3;M<Z;){if(V===0)break e;V--,z+=K[X++]<<M,M+=8}M-=le,D=0,J=3+(7&(z>>>=le)),z>>>=3,M-=3}else{for(Z=le+7;M<Z;){if(V===0)break e;V--,z+=K[X++]<<M,M+=8}M-=le,D=0,J=11+(127&(z>>>=le)),z>>>=7,M-=7}if(L.have+J>L.nlen+L.ndist){_.msg="invalid bit length repeat",L.mode=30;break}for(;J--;)L.lens[L.have++]=D}}if(L.mode===30)break;if(L.lens[256]===0){_.msg="invalid code -- missing end-of-block",L.mode=30;break}if(L.lenbits=9,ce={bits:L.lenbits},G=c(A,L.lens,0,L.nlen,L.lencode,0,L.work,ce),L.lenbits=ce.bits,G){_.msg="invalid literal/lengths set",L.mode=30;break}if(L.distbits=6,L.distcode=L.distdyn,ce={bits:L.distbits},G=c(d,L.lens,L.nlen,L.ndist,L.distcode,0,L.work,ce),L.distbits=ce.bits,G){_.msg="invalid distances set",L.mode=30;break}if(L.mode=20,T===6)break e;case 20:L.mode=21;case 21:if(6<=V&&258<=he){_.next_out=$,_.avail_out=he,_.next_in=X,_.avail_in=V,L.hold=z,L.bits=M,l(_,H),$=_.next_out,se=_.output,he=_.avail_out,X=_.next_in,K=_.input,V=_.avail_in,z=L.hold,M=L.bits,L.mode===12&&(L.back=-1);break}for(L.back=0;fe=(W=L.lencode[z&(1<<L.lenbits)-1])>>>16&255,ve=65535&W,!((le=W>>>24)<=M);){if(V===0)break e;V--,z+=K[X++]<<M,M+=8}if(fe&&(240&fe)==0){for(Ce=le,Be=fe,Qe=ve;fe=(W=L.lencode[Qe+((z&(1<<Ce+Be)-1)>>Ce)])>>>16&255,ve=65535&W,!(Ce+(le=W>>>24)<=M);){if(V===0)break e;V--,z+=K[X++]<<M,M+=8}z>>>=Ce,M-=Ce,L.back+=Ce}if(z>>>=le,M-=le,L.back+=le,L.length=ve,fe===0){L.mode=26;break}if(32&fe){L.back=-1,L.mode=12;break}if(64&fe){_.msg="invalid literal/length code",L.mode=30;break}L.extra=15&fe,L.mode=22;case 22:if(L.extra){for(Z=L.extra;M<Z;){if(V===0)break e;V--,z+=K[X++]<<M,M+=8}L.length+=z&(1<<L.extra)-1,z>>>=L.extra,M-=L.extra,L.back+=L.extra}L.was=L.length,L.mode=23;case 23:for(;fe=(W=L.distcode[z&(1<<L.distbits)-1])>>>16&255,ve=65535&W,!((le=W>>>24)<=M);){if(V===0)break e;V--,z+=K[X++]<<M,M+=8}if((240&fe)==0){for(Ce=le,Be=fe,Qe=ve;fe=(W=L.distcode[Qe+((z&(1<<Ce+Be)-1)>>Ce)])>>>16&255,ve=65535&W,!(Ce+(le=W>>>24)<=M);){if(V===0)break e;V--,z+=K[X++]<<M,M+=8}z>>>=Ce,M-=Ce,L.back+=Ce}if(z>>>=le,M-=le,L.back+=le,64&fe){_.msg="invalid distance code",L.mode=30;break}L.offset=ve,L.extra=15&fe,L.mode=24;case 24:if(L.extra){for(Z=L.extra;M<Z;){if(V===0)break e;V--,z+=K[X++]<<M,M+=8}L.offset+=z&(1<<L.extra)-1,z>>>=L.extra,M-=L.extra,L.back+=L.extra}if(L.offset>L.dmax){_.msg="invalid distance too far back",L.mode=30;break}L.mode=25;case 25:if(he===0)break e;if(J=H-he,L.offset>J){if((J=L.offset-J)>L.whave&&L.sane){_.msg="invalid distance too far back",L.mode=30;break}de=J>L.wnext?(J-=L.wnext,L.wsize-J):L.wnext-J,J>L.length&&(J=L.length),ie=L.window}else ie=se,de=$-L.offset,J=L.length;for(he<J&&(J=he),he-=J,L.length-=J;se[$++]=ie[de++],--J;);L.length===0&&(L.mode=21);break;case 26:if(he===0)break e;se[$++]=L.length,he--,L.mode=21;break;case 27:if(L.wrap){for(;M<32;){if(V===0)break e;V--,z|=K[X++]<<M,M+=8}if(H-=he,_.total_out+=H,L.total+=H,H&&(_.adler=L.check=L.flags?o(L.check,se,H,$-H):a(L.check,se,H,$-H)),H=he,(L.flags?z:m(z))!==L.check){_.msg="incorrect data check",L.mode=30;break}M=z=0}L.mode=28;case 28:if(L.wrap&&L.flags){for(;M<32;){if(V===0)break e;V--,z+=K[X++]<<M,M+=8}if(z!==(4294967295&L.total)){_.msg="incorrect length check",L.mode=30;break}M=z=0}L.mode=29;case 29:G=1;break e;case 30:G=-3;break e;case 31:return-4;case 32:default:return u}return _.next_out=$,_.avail_out=he,_.next_in=X,_.avail_in=V,L.hold=z,L.bits=M,(L.wsize||H!==_.avail_out&&L.mode<30&&(L.mode<27||T!==4))&&k(_,_.output,_.next_out,H-_.avail_out)?(L.mode=31,-4):(O-=_.avail_in,H-=_.avail_out,_.total_in+=O,_.total_out+=H,L.total+=H,L.wrap&&H&&(_.adler=L.check=L.flags?o(L.check,se,H,_.next_out-H):a(L.check,se,H,_.next_out-H)),_.data_type=L.bits+(L.last?64:0)+(L.mode===12?128:0)+(L.mode===20||L.mode===15?256:0),(O==0&&H===0||T===4)&&G===h&&(G=-5),G)},s.inflateEnd=function(_){if(!_||!_.state)return u;var T=_.state;return T.window&&(T.window=null),_.state=null,h},s.inflateGetHeader=function(_,T){var L;return _&&_.state?(2&(L=_.state).wrap)==0?u:((L.head=T).done=!1,h):u},s.inflateSetDictionary=function(_,T){var L,K=T.length;return _&&_.state?(L=_.state).wrap!==0&&L.mode!==11?u:L.mode===11&&a(1,T,K,0)!==L.check?-3:k(_,T,K,K)?(L.mode=31,-4):(L.havedict=1,h):u},s.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,n,s){var i=t("../utils/common"),a=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],c=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];n.exports=function(A,d,h,u,p,f,g,m){var x,S,B,F,N,E,w,v,I,k=m.bits,_=0,T=0,L=0,K=0,se=0,X=0,$=0,V=0,he=0,z=0,M=null,O=0,H=new i.Buf16(16),J=new i.Buf16(16),de=null,ie=0;for(_=0;_<=15;_++)H[_]=0;for(T=0;T<u;T++)H[d[h+T]]++;for(se=k,K=15;1<=K&&H[K]===0;K--);if(K<se&&(se=K),K===0)return p[f++]=20971520,p[f++]=20971520,m.bits=1,0;for(L=1;L<K&&H[L]===0;L++);for(se<L&&(se=L),_=V=1;_<=15;_++)if(V<<=1,(V-=H[_])<0)return-1;if(0<V&&(A===0||K!==1))return-1;for(J[1]=0,_=1;_<15;_++)J[_+1]=J[_]+H[_];for(T=0;T<u;T++)d[h+T]!==0&&(g[J[d[h+T]]++]=T);if(E=A===0?(M=de=g,19):A===1?(M=a,O-=257,de=o,ie-=257,256):(M=l,de=c,-1),_=L,N=f,$=T=z=0,B=-1,F=(he=1<<(X=se))-1,A===1&&852<he||A===2&&592<he)return 1;for(;;){for(w=_-$,I=g[T]<E?(v=0,g[T]):g[T]>E?(v=de[ie+g[T]],M[O+g[T]]):(v=96,0),x=1<<_-$,L=S=1<<X;p[N+(z>>$)+(S-=x)]=w<<24|v<<16|I|0,S!==0;);for(x=1<<_-1;z&x;)x>>=1;if(x!==0?(z&=x-1,z+=x):z=0,T++,--H[_]==0){if(_===K)break;_=d[h+g[T]]}if(se<_&&(z&F)!==B){for($===0&&($=se),N+=L,V=1<<(X=_-$);X+$<K&&!((V-=H[X+$])<=0);)X++,V<<=1;if(he+=1<<X,A===1&&852<he||A===2&&592<he)return 1;p[B=z&F]=se<<24|X<<16|N-f|0}}return z!==0&&(p[N+z]=_-$<<24|64<<16|0),m.bits=se,0}},{"../utils/common":41}],51:[function(t,n,s){n.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,n,s){var i=t("../utils/common"),a=0,o=1;function l(W){for(var ee=W.length;0<=--ee;)W[ee]=0}var c=0,A=29,d=256,h=d+1+A,u=30,p=19,f=2*h+1,g=15,m=16,x=7,S=256,B=16,F=17,N=18,E=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],w=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],v=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],I=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],k=new Array(2*(h+2));l(k);var _=new Array(2*u);l(_);var T=new Array(512);l(T);var L=new Array(256);l(L);var K=new Array(A);l(K);var se,X,$,V=new Array(u);function he(W,ee,ye,xe,we){this.static_tree=W,this.extra_bits=ee,this.extra_base=ye,this.elems=xe,this.max_length=we,this.has_stree=W&&W.length}function z(W,ee){this.dyn_tree=W,this.max_code=0,this.stat_desc=ee}function M(W){return W<256?T[W]:T[256+(W>>>7)]}function O(W,ee){W.pending_buf[W.pending++]=255&ee,W.pending_buf[W.pending++]=ee>>>8&255}function H(W,ee,ye){W.bi_valid>m-ye?(W.bi_buf|=ee<<W.bi_valid&65535,O(W,W.bi_buf),W.bi_buf=ee>>m-W.bi_valid,W.bi_valid+=ye-m):(W.bi_buf|=ee<<W.bi_valid&65535,W.bi_valid+=ye)}function J(W,ee,ye){H(W,ye[2*ee],ye[2*ee+1])}function de(W,ee){for(var ye=0;ye|=1&W,W>>>=1,ye<<=1,0<--ee;);return ye>>>1}function ie(W,ee,ye){var xe,we,Ee=new Array(g+1),Ne=0;for(xe=1;xe<=g;xe++)Ee[xe]=Ne=Ne+ye[xe-1]<<1;for(we=0;we<=ee;we++){var Ue=W[2*we+1];Ue!==0&&(W[2*we]=de(Ee[Ue]++,Ue))}}function le(W){var ee;for(ee=0;ee<h;ee++)W.dyn_ltree[2*ee]=0;for(ee=0;ee<u;ee++)W.dyn_dtree[2*ee]=0;for(ee=0;ee<p;ee++)W.bl_tree[2*ee]=0;W.dyn_ltree[2*S]=1,W.opt_len=W.static_len=0,W.last_lit=W.matches=0}function fe(W){8<W.bi_valid?O(W,W.bi_buf):0<W.bi_valid&&(W.pending_buf[W.pending++]=W.bi_buf),W.bi_buf=0,W.bi_valid=0}function ve(W,ee,ye,xe){var we=2*ee,Ee=2*ye;return W[we]<W[Ee]||W[we]===W[Ee]&&xe[ee]<=xe[ye]}function Ce(W,ee,ye){for(var xe=W.heap[ye],we=ye<<1;we<=W.heap_len&&(we<W.heap_len&&ve(ee,W.heap[we+1],W.heap[we],W.depth)&&we++,!ve(ee,xe,W.heap[we],W.depth));)W.heap[ye]=W.heap[we],ye=we,we<<=1;W.heap[ye]=xe}function Be(W,ee,ye){var xe,we,Ee,Ne,Ue=0;if(W.last_lit!==0)for(;xe=W.pending_buf[W.d_buf+2*Ue]<<8|W.pending_buf[W.d_buf+2*Ue+1],we=W.pending_buf[W.l_buf+Ue],Ue++,xe===0?J(W,we,ee):(J(W,(Ee=L[we])+d+1,ee),(Ne=E[Ee])!==0&&H(W,we-=K[Ee],Ne),J(W,Ee=M(--xe),ye),(Ne=w[Ee])!==0&&H(W,xe-=V[Ee],Ne)),Ue<W.last_lit;);J(W,S,ee)}function Qe(W,ee){var ye,xe,we,Ee=ee.dyn_tree,Ne=ee.stat_desc.static_tree,Ue=ee.stat_desc.has_stree,je=ee.stat_desc.elems,st=-1;for(W.heap_len=0,W.heap_max=f,ye=0;ye<je;ye++)Ee[2*ye]!==0?(W.heap[++W.heap_len]=st=ye,W.depth[ye]=0):Ee[2*ye+1]=0;for(;W.heap_len<2;)Ee[2*(we=W.heap[++W.heap_len]=st<2?++st:0)]=1,W.depth[we]=0,W.opt_len--,Ue&&(W.static_len-=Ne[2*we+1]);for(ee.max_code=st,ye=W.heap_len>>1;1<=ye;ye--)Ce(W,Ee,ye);for(we=je;ye=W.heap[1],W.heap[1]=W.heap[W.heap_len--],Ce(W,Ee,1),xe=W.heap[1],W.heap[--W.heap_max]=ye,W.heap[--W.heap_max]=xe,Ee[2*we]=Ee[2*ye]+Ee[2*xe],W.depth[we]=(W.depth[ye]>=W.depth[xe]?W.depth[ye]:W.depth[xe])+1,Ee[2*ye+1]=Ee[2*xe+1]=we,W.heap[1]=we++,Ce(W,Ee,1),2<=W.heap_len;);W.heap[--W.heap_max]=W.heap[1],(function(Ze,ct){var wt,it,lt,tt,rt,ft,St=ct.dyn_tree,yt=ct.max_code,jt=ct.stat_desc.static_tree,Rt=ct.stat_desc.has_stree,wr=ct.stat_desc.extra_bits,Qr=ct.stat_desc.extra_base,Lt=ct.stat_desc.max_length,Ut=0;for(tt=0;tt<=g;tt++)Ze.bl_count[tt]=0;for(St[2*Ze.heap[Ze.heap_max]+1]=0,wt=Ze.heap_max+1;wt<f;wt++)Lt<(tt=St[2*St[2*(it=Ze.heap[wt])+1]+1]+1)&&(tt=Lt,Ut++),St[2*it+1]=tt,yt<it||(Ze.bl_count[tt]++,rt=0,Qr<=it&&(rt=wr[it-Qr]),ft=St[2*it],Ze.opt_len+=ft*(tt+rt),Rt&&(Ze.static_len+=ft*(jt[2*it+1]+rt)));if(Ut!==0){do{for(tt=Lt-1;Ze.bl_count[tt]===0;)tt--;Ze.bl_count[tt]--,Ze.bl_count[tt+1]+=2,Ze.bl_count[Lt]--,Ut-=2}while(0<Ut);for(tt=Lt;tt!==0;tt--)for(it=Ze.bl_count[tt];it!==0;)yt<(lt=Ze.heap[--wt])||(St[2*lt+1]!==tt&&(Ze.opt_len+=(tt-St[2*lt+1])*St[2*lt],St[2*lt+1]=tt),it--)}})(W,ee),ie(Ee,st,W.bl_count)}function D(W,ee,ye){var xe,we,Ee=-1,Ne=ee[1],Ue=0,je=7,st=4;for(Ne===0&&(je=138,st=3),ee[2*(ye+1)+1]=65535,xe=0;xe<=ye;xe++)we=Ne,Ne=ee[2*(xe+1)+1],++Ue<je&&we===Ne||(Ue<st?W.bl_tree[2*we]+=Ue:we!==0?(we!==Ee&&W.bl_tree[2*we]++,W.bl_tree[2*B]++):Ue<=10?W.bl_tree[2*F]++:W.bl_tree[2*N]++,Ee=we,st=(Ue=0)===Ne?(je=138,3):we===Ne?(je=6,3):(je=7,4))}function G(W,ee,ye){var xe,we,Ee=-1,Ne=ee[1],Ue=0,je=7,st=4;for(Ne===0&&(je=138,st=3),xe=0;xe<=ye;xe++)if(we=Ne,Ne=ee[2*(xe+1)+1],!(++Ue<je&&we===Ne)){if(Ue<st)for(;J(W,we,W.bl_tree),--Ue!=0;);else we!==0?(we!==Ee&&(J(W,we,W.bl_tree),Ue--),J(W,B,W.bl_tree),H(W,Ue-3,2)):Ue<=10?(J(W,F,W.bl_tree),H(W,Ue-3,3)):(J(W,N,W.bl_tree),H(W,Ue-11,7));Ee=we,st=(Ue=0)===Ne?(je=138,3):we===Ne?(je=6,3):(je=7,4)}}l(V);var ce=!1;function Z(W,ee,ye,xe){H(W,(c<<1)+(xe?1:0),3),(function(we,Ee,Ne,Ue){fe(we),O(we,Ne),O(we,~Ne),i.arraySet(we.pending_buf,we.window,Ee,Ne,we.pending),we.pending+=Ne})(W,ee,ye)}s._tr_init=function(W){ce||((function(){var ee,ye,xe,we,Ee,Ne=new Array(g+1);for(we=xe=0;we<A-1;we++)for(K[we]=xe,ee=0;ee<1<<E[we];ee++)L[xe++]=we;for(L[xe-1]=we,we=Ee=0;we<16;we++)for(V[we]=Ee,ee=0;ee<1<<w[we];ee++)T[Ee++]=we;for(Ee>>=7;we<u;we++)for(V[we]=Ee<<7,ee=0;ee<1<<w[we]-7;ee++)T[256+Ee++]=we;for(ye=0;ye<=g;ye++)Ne[ye]=0;for(ee=0;ee<=143;)k[2*ee+1]=8,ee++,Ne[8]++;for(;ee<=255;)k[2*ee+1]=9,ee++,Ne[9]++;for(;ee<=279;)k[2*ee+1]=7,ee++,Ne[7]++;for(;ee<=287;)k[2*ee+1]=8,ee++,Ne[8]++;for(ie(k,h+1,Ne),ee=0;ee<u;ee++)_[2*ee+1]=5,_[2*ee]=de(ee,5);se=new he(k,E,d+1,h,g),X=new he(_,w,0,u,g),$=new he(new Array(0),v,0,p,x)})(),ce=!0),W.l_desc=new z(W.dyn_ltree,se),W.d_desc=new z(W.dyn_dtree,X),W.bl_desc=new z(W.bl_tree,$),W.bi_buf=0,W.bi_valid=0,le(W)},s._tr_stored_block=Z,s._tr_flush_block=function(W,ee,ye,xe){var we,Ee,Ne=0;0<W.level?(W.strm.data_type===2&&(W.strm.data_type=(function(Ue){var je,st=4093624447;for(je=0;je<=31;je++,st>>>=1)if(1&st&&Ue.dyn_ltree[2*je]!==0)return a;if(Ue.dyn_ltree[18]!==0||Ue.dyn_ltree[20]!==0||Ue.dyn_ltree[26]!==0)return o;for(je=32;je<d;je++)if(Ue.dyn_ltree[2*je]!==0)return o;return a})(W)),Qe(W,W.l_desc),Qe(W,W.d_desc),Ne=(function(Ue){var je;for(D(Ue,Ue.dyn_ltree,Ue.l_desc.max_code),D(Ue,Ue.dyn_dtree,Ue.d_desc.max_code),Qe(Ue,Ue.bl_desc),je=p-1;3<=je&&Ue.bl_tree[2*I[je]+1]===0;je--);return Ue.opt_len+=3*(je+1)+5+5+4,je})(W),we=W.opt_len+3+7>>>3,(Ee=W.static_len+3+7>>>3)<=we&&(we=Ee)):we=Ee=ye+5,ye+4<=we&&ee!==-1?Z(W,ee,ye,xe):W.strategy===4||Ee===we?(H(W,2+(xe?1:0),3),Be(W,k,_)):(H(W,4+(xe?1:0),3),(function(Ue,je,st,Ze){var ct;for(H(Ue,je-257,5),H(Ue,st-1,5),H(Ue,Ze-4,4),ct=0;ct<Ze;ct++)H(Ue,Ue.bl_tree[2*I[ct]+1],3);G(Ue,Ue.dyn_ltree,je-1),G(Ue,Ue.dyn_dtree,st-1)})(W,W.l_desc.max_code+1,W.d_desc.max_code+1,Ne+1),Be(W,W.dyn_ltree,W.dyn_dtree)),le(W),xe&&fe(W)},s._tr_tally=function(W,ee,ye){return W.pending_buf[W.d_buf+2*W.last_lit]=ee>>>8&255,W.pending_buf[W.d_buf+2*W.last_lit+1]=255&ee,W.pending_buf[W.l_buf+W.last_lit]=255&ye,W.last_lit++,ee===0?W.dyn_ltree[2*ye]++:(W.matches++,ee--,W.dyn_ltree[2*(L[ye]+d+1)]++,W.dyn_dtree[2*M(ee)]++),W.last_lit===W.lit_bufsize-1},s._tr_align=function(W){H(W,2,3),J(W,S,k),(function(ee){ee.bi_valid===16?(O(ee,ee.bi_buf),ee.bi_buf=0,ee.bi_valid=0):8<=ee.bi_valid&&(ee.pending_buf[ee.pending++]=255&ee.bi_buf,ee.bi_buf>>=8,ee.bi_valid-=8)})(W)}},{"../utils/common":41}],53:[function(t,n,s){n.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,n,s){(function(i){(function(a,o){if(!a.setImmediate){var l,c,A,d,h=1,u={},p=!1,f=a.document,g=Object.getPrototypeOf&&Object.getPrototypeOf(a);g=g&&g.setTimeout?g:a,l={}.toString.call(a.process)==="[object process]"?function(B){process.nextTick(function(){x(B)})}:(function(){if(a.postMessage&&!a.importScripts){var B=!0,F=a.onmessage;return a.onmessage=function(){B=!1},a.postMessage("","*"),a.onmessage=F,B}})()?(d="setImmediate$"+Math.random()+"$",a.addEventListener?a.addEventListener("message",S,!1):a.attachEvent("onmessage",S),function(B){a.postMessage(d+B,"*")}):a.MessageChannel?((A=new MessageChannel).port1.onmessage=function(B){x(B.data)},function(B){A.port2.postMessage(B)}):f&&"onreadystatechange"in f.createElement("script")?(c=f.documentElement,function(B){var F=f.createElement("script");F.onreadystatechange=function(){x(B),F.onreadystatechange=null,c.removeChild(F),F=null},c.appendChild(F)}):function(B){setTimeout(x,0,B)},g.setImmediate=function(B){typeof B!="function"&&(B=new Function(""+B));for(var F=new Array(arguments.length-1),N=0;N<F.length;N++)F[N]=arguments[N+1];var E={callback:B,args:F};return u[h]=E,l(h),h++},g.clearImmediate=m}function m(B){delete u[B]}function x(B){if(p)setTimeout(x,0,B);else{var F=u[B];if(F){p=!0;try{(function(N){var E=N.callback,w=N.args;switch(w.length){case 0:E();break;case 1:E(w[0]);break;case 2:E(w[0],w[1]);break;case 3:E(w[0],w[1],w[2]);break;default:E.apply(o,w)}})(F)}finally{m(B),p=!1}}}}function S(B){B.source===a&&typeof B.data=="string"&&B.data.indexOf(d)===0&&x(+B.data.slice(d.length))}})(typeof self>"u"?i===void 0?this:i:self)}).call(this,typeof Jp<"u"?Jp:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(Jw)),Jw.exports}var CY=BY();const SY=jx(CY);var dm={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/var kY=dm.exports,Ak;function EY(){return Ak||(Ak=1,(function(r,e){((t,n)=>{r.exports=n()})(kY,function t(){var n=typeof self<"u"?self:typeof window<"u"?window:n!==void 0?n:{},s,i=!n.document&&!!n.postMessage,a=n.IS_PAPA_WORKER||!1,o={},l=0,c={};function A(w){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(v){var I=F(v);I.chunkSize=parseInt(I.chunkSize),v.step||v.chunk||(I.chunkSize=null),this._handle=new f(I),(this._handle.streamer=this)._config=I}).call(this,w),this.parseChunk=function(v,I){var k=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<k){let T=this._config.newline;T||(_=this._config.quoteChar||'"',T=this._handle.guessLineEndings(v,_)),v=[...v.split(T).slice(k)].join(T)}this.isFirstChunk&&E(this._config.beforeFirstChunk)&&(_=this._config.beforeFirstChunk(v))!==void 0&&(v=_),this.isFirstChunk=!1,this._halted=!1;var k=this._partialLine+v,_=(this._partialLine="",this._handle.parse(k,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(v=_.meta.cursor,k=(this._finished||(this._partialLine=k.substring(v-this._baseIndex),this._baseIndex=v),_&&_.data&&(this._rowCount+=_.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),a)n.postMessage({results:_,workerId:c.WORKER_ID,finished:k});else if(E(this._config.chunk)&&!I){if(this._config.chunk(_,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=_=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(_.data),this._completeResults.errors=this._completeResults.errors.concat(_.errors),this._completeResults.meta=_.meta),this._completed||!k||!E(this._config.complete)||_&&_.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),k||_&&_.meta.paused||this._nextChunk(),_}this._halted=!0},this._sendError=function(v){E(this._config.error)?this._config.error(v):a&&this._config.error&&n.postMessage({workerId:c.WORKER_ID,error:v,finished:!1})}}function d(w){var v;(w=w||{}).chunkSize||(w.chunkSize=c.RemoteChunkSize),A.call(this,w),this._nextChunk=i?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(I){this._input=I,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(v=new XMLHttpRequest,this._config.withCredentials&&(v.withCredentials=this._config.withCredentials),i||(v.onload=N(this._chunkLoaded,this),v.onerror=N(this._chunkError,this)),v.open(this._config.downloadRequestBody?"POST":"GET",this._input,!i),this._config.downloadRequestHeaders){var I,k=this._config.downloadRequestHeaders;for(I in k)v.setRequestHeader(I,k[I])}var _;this._config.chunkSize&&(_=this._start+this._config.chunkSize-1,v.setRequestHeader("Range","bytes="+this._start+"-"+_));try{v.send(this._config.downloadRequestBody)}catch(T){this._chunkError(T.message)}i&&v.status===0&&this._chunkError()}},this._chunkLoaded=function(){v.readyState===4&&(v.status<200||400<=v.status?this._chunkError():(this._start+=this._config.chunkSize||v.responseText.length,this._finished=!this._config.chunkSize||this._start>=(I=>(I=I.getResponseHeader("Content-Range"))!==null?parseInt(I.substring(I.lastIndexOf("/")+1)):-1)(v),this.parseChunk(v.responseText)))},this._chunkError=function(I){I=v.statusText||I,this._sendError(new Error(I))}}function h(w){(w=w||{}).chunkSize||(w.chunkSize=c.LocalChunkSize),A.call(this,w);var v,I,k=typeof FileReader<"u";this.stream=function(_){this._input=_,I=_.slice||_.webkitSlice||_.mozSlice,k?((v=new FileReader).onload=N(this._chunkLoaded,this),v.onerror=N(this._chunkError,this)):v=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var _=this._input,T=(this._config.chunkSize&&(T=Math.min(this._start+this._config.chunkSize,this._input.size),_=I.call(_,this._start,T)),v.readAsText(_,this._config.encoding));k||this._chunkLoaded({target:{result:T}})},this._chunkLoaded=function(_){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(_.target.result)},this._chunkError=function(){this._sendError(v.error)}}function u(w){var v;A.call(this,w=w||{}),this.stream=function(I){return v=I,this._nextChunk()},this._nextChunk=function(){var I,k;if(!this._finished)return I=this._config.chunkSize,v=I?(k=v.substring(0,I),v.substring(I)):(k=v,""),this._finished=!v,this.parseChunk(k)}}function p(w){A.call(this,w=w||{});var v=[],I=!0,k=!1;this.pause=function(){A.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){A.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(_){this._input=_,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){k&&v.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),v.length?this.parseChunk(v.shift()):I=!0},this._streamData=N(function(_){try{v.push(typeof _=="string"?_:_.toString(this._config.encoding)),I&&(I=!1,this._checkIsFinished(),this.parseChunk(v.shift()))}catch(T){this._streamError(T)}},this),this._streamError=N(function(_){this._streamCleanUp(),this._sendError(_)},this),this._streamEnd=N(function(){this._streamCleanUp(),k=!0,this._streamData("")},this),this._streamCleanUp=N(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function f(w){var v,I,k,_,T=Math.pow(2,53),L=-T,K=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,se=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,X=this,$=0,V=0,he=!1,z=!1,M=[],O={data:[],errors:[],meta:{}};function H(le){return w.skipEmptyLines==="greedy"?le.join("").trim()==="":le.length===1&&le[0].length===0}function J(){if(O&&k&&(ie("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+c.DefaultDelimiter+"'"),k=!1),w.skipEmptyLines&&(O.data=O.data.filter(function(Ce){return!H(Ce)})),de()){let Ce=function(Be,Qe){E(w.transformHeader)&&(Be=w.transformHeader(Be,Qe)),M.push(Be)};if(O)if(Array.isArray(O.data[0])){for(var le=0;de()&&le<O.data.length;le++)O.data[le].forEach(Ce);O.data.splice(0,1)}else O.data.forEach(Ce)}function fe(Ce,Be){for(var Qe=w.header?{}:[],D=0;D<Ce.length;D++){var G=D,ce=Ce[D],ce=((Z,W)=>(ee=>(w.dynamicTypingFunction&&w.dynamicTyping[ee]===void 0&&(w.dynamicTyping[ee]=w.dynamicTypingFunction(ee)),(w.dynamicTyping[ee]||w.dynamicTyping)===!0))(Z)?W==="true"||W==="TRUE"||W!=="false"&&W!=="FALSE"&&((ee=>{if(K.test(ee)&&(ee=parseFloat(ee),L<ee&&ee<T))return 1})(W)?parseFloat(W):se.test(W)?new Date(W):W===""?null:W):W)(G=w.header?D>=M.length?"__parsed_extra":M[D]:G,ce=w.transform?w.transform(ce,G):ce);G==="__parsed_extra"?(Qe[G]=Qe[G]||[],Qe[G].push(ce)):Qe[G]=ce}return w.header&&(D>M.length?ie("FieldMismatch","TooManyFields","Too many fields: expected "+M.length+" fields but parsed "+D,V+Be):D<M.length&&ie("FieldMismatch","TooFewFields","Too few fields: expected "+M.length+" fields but parsed "+D,V+Be)),Qe}var ve;O&&(w.header||w.dynamicTyping||w.transform)&&(ve=1,!O.data.length||Array.isArray(O.data[0])?(O.data=O.data.map(fe),ve=O.data.length):O.data=fe(O.data,0),w.header&&O.meta&&(O.meta.fields=M),V+=ve)}function de(){return w.header&&M.length===0}function ie(le,fe,ve,Ce){le={type:le,code:fe,message:ve},Ce!==void 0&&(le.row=Ce),O.errors.push(le)}E(w.step)&&(_=w.step,w.step=function(le){O=le,de()?J():(J(),O.data.length!==0&&($+=le.data.length,w.preview&&$>w.preview?I.abort():(O.data=O.data[0],_(O,X))))}),this.parse=function(le,fe,ve){var Ce=w.quoteChar||'"',Ce=(w.newline||(w.newline=this.guessLineEndings(le,Ce)),k=!1,w.delimiter?E(w.delimiter)&&(w.delimiter=w.delimiter(le),O.meta.delimiter=w.delimiter):((Ce=((Be,Qe,D,G,ce)=>{var Z,W,ee,ye;ce=ce||[",","	","|",";",c.RECORD_SEP,c.UNIT_SEP];for(var xe=0;xe<ce.length;xe++){for(var we,Ee=ce[xe],Ne=0,Ue=0,je=0,st=(ee=void 0,new m({comments:G,delimiter:Ee,newline:Qe,preview:10}).parse(Be)),Ze=0;Ze<st.data.length;Ze++)D&&H(st.data[Ze])?je++:(we=st.data[Ze].length,Ue+=we,ee===void 0?ee=we:0<we&&(Ne+=Math.abs(we-ee),ee=we));0<st.data.length&&(Ue/=st.data.length-je),(W===void 0||Ne<=W)&&(ye===void 0||ye<Ue)&&1.99<Ue&&(W=Ne,Z=Ee,ye=Ue)}return{successful:!!(w.delimiter=Z),bestDelimiter:Z}})(le,w.newline,w.skipEmptyLines,w.comments,w.delimitersToGuess)).successful?w.delimiter=Ce.bestDelimiter:(k=!0,w.delimiter=c.DefaultDelimiter),O.meta.delimiter=w.delimiter),F(w));return w.preview&&w.header&&Ce.preview++,v=le,I=new m(Ce),O=I.parse(v,fe,ve),J(),he?{meta:{paused:!0}}:O||{meta:{paused:!1}}},this.paused=function(){return he},this.pause=function(){he=!0,I.abort(),v=E(w.chunk)?"":v.substring(I.getCharIndex())},this.resume=function(){X.streamer._halted?(he=!1,X.streamer.parseChunk(v,!0)):setTimeout(X.resume,3)},this.aborted=function(){return z},this.abort=function(){z=!0,I.abort(),O.meta.aborted=!0,E(w.complete)&&w.complete(O),v=""},this.guessLineEndings=function(Be,Ce){Be=Be.substring(0,1048576);var Ce=new RegExp(g(Ce)+"([^]*?)"+g(Ce),"gm"),ve=(Be=Be.replace(Ce,"")).split("\r"),Ce=Be.split(`
`),Be=1<Ce.length&&Ce[0].length<ve[0].length;if(ve.length===1||Be)return`
`;for(var Qe=0,D=0;D<ve.length;D++)ve[D][0]===`
`&&Qe++;return Qe>=ve.length/2?`\r
`:"\r"}}function g(w){return w.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function m(w){var v=(w=w||{}).delimiter,I=w.newline,k=w.comments,_=w.step,T=w.preview,L=w.fastMode,K=null,se=!1,X=w.quoteChar==null?'"':w.quoteChar,$=X;if(w.escapeChar!==void 0&&($=w.escapeChar),(typeof v!="string"||-1<c.BAD_DELIMITERS.indexOf(v))&&(v=","),k===v)throw new Error("Comment character same as delimiter");k===!0?k="#":(typeof k!="string"||-1<c.BAD_DELIMITERS.indexOf(k))&&(k=!1),I!==`
`&&I!=="\r"&&I!==`\r
`&&(I=`
`);var V=0,he=!1;this.parse=function(z,M,O){if(typeof z!="string")throw new Error("Input must be a string");var H=z.length,J=v.length,de=I.length,ie=k.length,le=E(_),fe=[],ve=[],Ce=[],Be=V=0;if(!z)return Ne();if(L||L!==!1&&z.indexOf(X)===-1){for(var Qe=z.split(I),D=0;D<Qe.length;D++){if(Ce=Qe[D],V+=Ce.length,D!==Qe.length-1)V+=I.length;else if(O)return Ne();if(!k||Ce.substring(0,ie)!==k){if(le){if(fe=[],ye(Ce.split(v)),Ue(),he)return Ne()}else ye(Ce.split(v));if(T&&T<=D)return fe=fe.slice(0,T),Ne(!0)}}return Ne()}for(var G=z.indexOf(v,V),ce=z.indexOf(I,V),Z=new RegExp(g($)+g(X),"g"),W=z.indexOf(X,V);;)if(z[V]===X)for(W=V,V++;;){if((W=z.indexOf(X,W+1))===-1)return O||ve.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:fe.length,index:V}),we();if(W===H-1)return we(z.substring(V,W).replace(Z,X));if(X===$&&z[W+1]===$)W++;else if(X===$||W===0||z[W-1]!==$){G!==-1&&G<W+1&&(G=z.indexOf(v,W+1));var ee=xe((ce=ce!==-1&&ce<W+1?z.indexOf(I,W+1):ce)===-1?G:Math.min(G,ce));if(z.substr(W+1+ee,J)===v){Ce.push(z.substring(V,W).replace(Z,X)),z[V=W+1+ee+J]!==X&&(W=z.indexOf(X,V)),G=z.indexOf(v,V),ce=z.indexOf(I,V);break}if(ee=xe(ce),z.substring(W+1+ee,W+1+ee+de)===I){if(Ce.push(z.substring(V,W).replace(Z,X)),Ee(W+1+ee+de),G=z.indexOf(v,V),W=z.indexOf(X,V),le&&(Ue(),he))return Ne();if(T&&fe.length>=T)return Ne(!0);break}ve.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:fe.length,index:V}),W++}}else if(k&&Ce.length===0&&z.substring(V,V+ie)===k){if(ce===-1)return Ne();V=ce+de,ce=z.indexOf(I,V),G=z.indexOf(v,V)}else if(G!==-1&&(G<ce||ce===-1))Ce.push(z.substring(V,G)),V=G+J,G=z.indexOf(v,V);else{if(ce===-1)break;if(Ce.push(z.substring(V,ce)),Ee(ce+de),le&&(Ue(),he))return Ne();if(T&&fe.length>=T)return Ne(!0)}return we();function ye(je){fe.push(je),Be=V}function xe(je){var st=0;return st=je!==-1&&(je=z.substring(W+1,je))&&je.trim()===""?je.length:st}function we(je){return O||(je===void 0&&(je=z.substring(V)),Ce.push(je),V=H,ye(Ce),le&&Ue()),Ne()}function Ee(je){V=je,ye(Ce),Ce=[],ce=z.indexOf(I,V)}function Ne(je){if(w.header&&!M&&fe.length&&!se){var st=fe[0],Ze=Object.create(null),ct=new Set(st);let wt=!1;for(let it=0;it<st.length;it++){let lt=st[it];if(Ze[lt=E(w.transformHeader)?w.transformHeader(lt,it):lt]){let tt,rt=Ze[lt];for(;tt=lt+"_"+rt,rt++,ct.has(tt););ct.add(tt),st[it]=tt,Ze[lt]++,wt=!0,(K=K===null?{}:K)[tt]=lt}else Ze[lt]=1,st[it]=lt;ct.add(lt)}wt&&console.warn("Duplicate headers found and renamed."),se=!0}return{data:fe,errors:ve,meta:{delimiter:v,linebreak:I,aborted:he,truncated:!!je,cursor:Be+(M||0),renamedHeaders:K}}}function Ue(){_(Ne()),fe=[],ve=[]}},this.abort=function(){he=!0},this.getCharIndex=function(){return V}}function x(w){var v=w.data,I=o[v.workerId],k=!1;if(v.error)I.userError(v.error,v.file);else if(v.results&&v.results.data){var _={abort:function(){k=!0,S(v.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:B,resume:B};if(E(I.userStep)){for(var T=0;T<v.results.data.length&&(I.userStep({data:v.results.data[T],errors:v.results.errors,meta:v.results.meta},_),!k);T++);delete v.results}else E(I.userChunk)&&(I.userChunk(v.results,_,v.file),delete v.results)}v.finished&&!k&&S(v.workerId,v.results)}function S(w,v){var I=o[w];E(I.userComplete)&&I.userComplete(v),I.terminate(),delete o[w]}function B(){throw new Error("Not implemented.")}function F(w){if(typeof w!="object"||w===null)return w;var v,I=Array.isArray(w)?[]:{};for(v in w)I[v]=F(w[v]);return I}function N(w,v){return function(){w.apply(v,arguments)}}function E(w){return typeof w=="function"}return c.parse=function(w,v){var I=(v=v||{}).dynamicTyping||!1;if(E(I)&&(v.dynamicTypingFunction=I,I={}),v.dynamicTyping=I,v.transform=!!E(v.transform)&&v.transform,!v.worker||!c.WORKERS_SUPPORTED)return I=null,c.NODE_STREAM_INPUT,typeof w=="string"?(w=(k=>k.charCodeAt(0)!==65279?k:k.slice(1))(w),I=new(v.download?d:u)(v)):w.readable===!0&&E(w.read)&&E(w.on)?I=new p(v):(n.File&&w instanceof File||w instanceof Object)&&(I=new h(v)),I.stream(w);(I=(()=>{var k;return!!c.WORKERS_SUPPORTED&&(k=(()=>{var _=n.URL||n.webkitURL||null,T=t.toString();return c.BLOB_URL||(c.BLOB_URL=_.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",T,")();"],{type:"text/javascript"})))})(),(k=new n.Worker(k)).onmessage=x,k.id=l++,o[k.id]=k)})()).userStep=v.step,I.userChunk=v.chunk,I.userComplete=v.complete,I.userError=v.error,v.step=E(v.step),v.chunk=E(v.chunk),v.complete=E(v.complete),v.error=E(v.error),delete v.worker,I.postMessage({input:w,config:v,workerId:I.id})},c.unparse=function(w,v){var I=!1,k=!0,_=",",T=`\r
`,L='"',K=L+L,se=!1,X=null,$=!1,V=((()=>{if(typeof v=="object"){if(typeof v.delimiter!="string"||c.BAD_DELIMITERS.filter(function(M){return v.delimiter.indexOf(M)!==-1}).length||(_=v.delimiter),typeof v.quotes!="boolean"&&typeof v.quotes!="function"&&!Array.isArray(v.quotes)||(I=v.quotes),typeof v.skipEmptyLines!="boolean"&&typeof v.skipEmptyLines!="string"||(se=v.skipEmptyLines),typeof v.newline=="string"&&(T=v.newline),typeof v.quoteChar=="string"&&(L=v.quoteChar),typeof v.header=="boolean"&&(k=v.header),Array.isArray(v.columns)){if(v.columns.length===0)throw new Error("Option columns is empty");X=v.columns}v.escapeChar!==void 0&&(K=v.escapeChar+L),v.escapeFormulae instanceof RegExp?$=v.escapeFormulae:typeof v.escapeFormulae=="boolean"&&v.escapeFormulae&&($=/^[=+\-@\t\r].*$/)}})(),new RegExp(g(L),"g"));if(typeof w=="string"&&(w=JSON.parse(w)),Array.isArray(w)){if(!w.length||Array.isArray(w[0]))return he(null,w,se);if(typeof w[0]=="object")return he(X||Object.keys(w[0]),w,se)}else if(typeof w=="object")return typeof w.data=="string"&&(w.data=JSON.parse(w.data)),Array.isArray(w.data)&&(w.fields||(w.fields=w.meta&&w.meta.fields||X),w.fields||(w.fields=Array.isArray(w.data[0])?w.fields:typeof w.data[0]=="object"?Object.keys(w.data[0]):[]),Array.isArray(w.data[0])||typeof w.data[0]=="object"||(w.data=[w.data])),he(w.fields||[],w.data||[],se);throw new Error("Unable to serialize unrecognized input");function he(M,O,H){var J="",de=(typeof M=="string"&&(M=JSON.parse(M)),typeof O=="string"&&(O=JSON.parse(O)),Array.isArray(M)&&0<M.length),ie=!Array.isArray(O[0]);if(de&&k){for(var le=0;le<M.length;le++)0<le&&(J+=_),J+=z(M[le],le);0<O.length&&(J+=T)}for(var fe=0;fe<O.length;fe++){var ve=(de?M:O[fe]).length,Ce=!1,Be=de?Object.keys(O[fe]).length===0:O[fe].length===0;if(H&&!de&&(Ce=H==="greedy"?O[fe].join("").trim()==="":O[fe].length===1&&O[fe][0].length===0),H==="greedy"&&de){for(var Qe=[],D=0;D<ve;D++){var G=ie?M[D]:D;Qe.push(O[fe][G])}Ce=Qe.join("").trim()===""}if(!Ce){for(var ce=0;ce<ve;ce++){0<ce&&!Be&&(J+=_);var Z=de&&ie?M[ce]:ce;J+=z(O[fe][Z],ce)}fe<O.length-1&&(!H||0<ve&&!Be)&&(J+=T)}}return J}function z(M,O){var H,J;return M==null?"":M.constructor===Date?JSON.stringify(M).slice(1,25):(J=!1,$&&typeof M=="string"&&$.test(M)&&(M="'"+M,J=!0),H=M.toString().replace(V,K),(J=J||I===!0||typeof I=="function"&&I(M,O)||Array.isArray(I)&&I[O]||((de,ie)=>{for(var le=0;le<ie.length;le++)if(-1<de.indexOf(ie[le]))return!0;return!1})(H,c.BAD_DELIMITERS)||-1<H.indexOf(_)||H.charAt(0)===" "||H.charAt(H.length-1)===" ")?L+H+L:H)}},c.RECORD_SEP="",c.UNIT_SEP="",c.BYTE_ORDER_MARK="\uFEFF",c.BAD_DELIMITERS=["\r",`
`,'"',c.BYTE_ORDER_MARK],c.WORKERS_SUPPORTED=!i&&!!n.Worker,c.NODE_STREAM_INPUT=1,c.LocalChunkSize=10485760,c.RemoteChunkSize=5242880,c.DefaultDelimiter=",",c.Parser=m,c.ParserHandle=f,c.NetworkStreamer=d,c.FileStreamer=h,c.StringStreamer=u,c.ReadableStreamStreamer=p,n.jQuery&&((s=n.jQuery).fn.parse=function(w){var v=w.config||{},I=[];return this.each(function(T){if(!(s(this).prop("tagName").toUpperCase()==="INPUT"&&s(this).attr("type").toLowerCase()==="file"&&n.FileReader)||!this.files||this.files.length===0)return!0;for(var L=0;L<this.files.length;L++)I.push({file:this.files[L],inputElem:this,instanceConfig:s.extend({},v)})}),k(),this;function k(){if(I.length===0)E(w.complete)&&w.complete();else{var T,L,K,se,X=I[0];if(E(w.before)){var $=w.before(X.file,X.inputElem);if(typeof $=="object"){if($.action==="abort")return T="AbortError",L=X.file,K=X.inputElem,se=$.reason,void(E(w.error)&&w.error({name:T},L,K,se));if($.action==="skip")return void _();typeof $.config=="object"&&(X.instanceConfig=s.extend(X.instanceConfig,$.config))}else if($==="skip")return void _()}var V=X.instanceConfig.complete;X.instanceConfig.complete=function(he){E(V)&&V(he,X.file,X.inputElem),_()},c.parse(X.file,X.instanceConfig)}}function _(){I.splice(0,1),k()}}),a&&(n.onmessage=function(w){w=w.data,c.WORKER_ID===void 0&&w&&(c.WORKER_ID=w.workerId),typeof w.input=="string"?n.postMessage({workerId:c.WORKER_ID,results:c.parse(w.input,w.config),finished:!0}):(n.File&&w.input instanceof File||w.input instanceof Object)&&(w=c.parse(w.input,w.config))&&n.postMessage({workerId:c.WORKER_ID,results:w,finished:!0})}),(d.prototype=Object.create(A.prototype)).constructor=d,(h.prototype=Object.create(A.prototype)).constructor=h,(u.prototype=Object.create(u.prototype)).constructor=u,(p.prototype=Object.create(A.prototype)).constructor=p,c})})(dm)),dm.exports}var IY=EY();const TY=jx(IY);class FY{constructor(){this._state=this._initializeState(),this.state=this._state,console.log("StateManager initialized.")}_initializeState(){return{groups:[],students:[],tasks:[],evaluations:[],admins:[],classes:[],sections:[],subjects:[],teachers:[],currentTeacher:null,activeContext:{classId:null,sectionId:null,subjectId:null,session:null,teacherId:null},currentUser:null,currentUserData:null,authLoading:!0,isPublicMode:!0,filters:{membersList:{searchTerm:"",groupFilter:"all",academicFilter:"all"},studentCards:{searchTerm:"",groupFilter:"all",academicFilter:"all"},groupAnalysis:{groupFilter:"all"},graphAnalysis:{groupFilter:"all",startDate:"",endDate:"",studentSearch:""},statistics:{taskFilter:"all",groupFilter:"all",evaluationType:"all",viewMode:"table",showPendingOnly:!1},analysis:{groupFilter:"all",taskFilter:"all",evaluationType:"all",viewMode:"table",showFullOnly:!1,criteriaView:"topic",summaryEvaluationView:"table"},adminManagement:{searchTerm:""}},dashboardConfig:{forceAssignmentId:null,isForced:!1},activePage:"dashboard",isLoading:!1}}getState(){return this.state}get(e){if(e in this.state)return this.state[e];console.warn(`Attempted to get unknown state key: ${e}`)}set(e,t){e in this.state?this.state[e]=t:console.warn(`Attempted to set unknown state key: ${e}`)}update(e){if(typeof e!="object"||e===null){console.warn("StateManager update called with invalid argument:",e);return}for(const t in e)e.hasOwnProperty(t)&&t in this.state?this.set(t,e[t]):e.hasOwnProperty(t)&&console.warn(`Attempted to update unknown state key during bulk update: ${t}`)}getFilters(){return this.state.filters}getFilterSection(e){if(e in this.state.filters)return this.state.filters[e];console.warn(`Attempted to get unknown filter section: ${e}`)}updateFilters(e,t){if(!(e in this.state.filters))return console.warn(`Attempted to update filters for unknown section: ${e}`),!1;if(typeof t!="object"||t===null)return console.warn(`Invalid filterUpdates provided for section ${e}:`,t),!1;const n=this.state.filters[e];let s=!1;for(const i in t)t.hasOwnProperty(i)&&i in n?n[i]!==t[i]&&(n[i]=t[i],s=!0):t.hasOwnProperty(i)&&console.warn(`Attempted to update unknown filter key "${i}" in section "${e}"`);return s}resetAllFilters(){const e=this._initializeState().filters;this.set("filters",JSON.parse(JSON.stringify(e))),console.log("All filters reset.")}resetFiltersForSection(e){if(!(e in this.state.filters)){console.warn(`Attempted to reset filters for unknown section: ${e}`);return}const t=this._initializeState().filters[e];this.state.filters[e]=JSON.parse(JSON.stringify(t)),console.log(`Filters reset for section: ${e}`)}setUser(e,t){this.update({currentUser:e,currentUserData:t,isPublicMode:!e,authLoading:!1})}setAuthLoading(e){this.set("authLoading",e)}setLoading(e){this.set("isLoading",e)}getDashboardConfig(){return this.state.dashboardConfig||{forceAssignmentId:null,isForced:!1}}setDashboardConfig(e){this.state.dashboardConfig={...this.state.dashboardConfig,...e},console.log("Dashboard config updated (State):",this.state.dashboardConfig)}setActiveContext(e){if(typeof e!="object"||e===null){console.warn("setActiveContext called with invalid argument:",e);return}this.state.activeContext={...this.state.activeContext,...e},console.log("Active context updated:",this.state.activeContext)}getFilteredData(e,t=!1){var i;const n=this.state[e];if(!Array.isArray(n))return console.warn(`getFilteredData called with invalid collection: ${e}`),[];const s=(i=this.state.currentUserData)==null?void 0:i.type;if(s==="super-admin")return n;if(s==="teacher"){const a=this.state.activeContext,o=this.state.currentTeacher,l=(o==null?void 0:o.assignedClasses)||[],c=(o==null?void 0:o.assignedSections)||[],A=(o==null?void 0:o.assignedSubjects)||[];return n.filter(d=>e==="tasks"?!(!d.subjectId||!t&&a.subjectId&&String(d.subjectId)!==String(a.subjectId)||A.length>0&&!A.includes(d.subjectId)):!(d.classId&&(!t&&a.classId&&String(d.classId)!==String(a.classId)||l.length>0&&!l.includes(d.classId))||d.sectionId&&(!t&&a.sectionId&&String(d.sectionId)!==String(a.sectionId)||c.length>0&&!c.includes(d.sectionId))||d.subjectId&&(!t&&a.subjectId&&String(d.subjectId)!==String(a.subjectId)||A.length>0&&!A.includes(d.subjectId))||d.teacherId&&!t&&a.teacherId&&String(d.teacherId)!==String(a.teacherId)))}return n}}const ir=new FY;function LY(r){return typeof r!="string"?!1:/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r.trim())}function UY(r){let e;return t=>{if(typeof t!="function"){console.warn("Debouncer called without a valid callback.");return}clearTimeout(e),e=setTimeout(t,r)}}function MY(r){return typeof r!="string"?String(r||""):r.replace(/^\uFEFF/,"").normalize("NFC").trim()}function F1(r){const e=String(r??"");if(!e)return"";const t=["","","","","","","","","",""];return e.replace(/\d/g,n=>t[parseInt(n,10)]??n)}function NY(r){return typeof r!="number"||!Number.isInteger(r)||r<1?F1(r):{1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",10:""}[r]||`${F1(r)}`}function PY(r){if(!Number.isFinite(r)||r<0||r===0)return"0 Bytes";const e=1024,t=["Bytes","KB","MB","GB","TB","PB"],n=Math.floor(Math.log(r)/Math.log(e)),s=Math.min(n,t.length-1);return`${parseFloat((r/Math.pow(e,s)).toFixed(2))} ${t[s]}`}function DY(r,e){if(typeof r!="string")return"";if(r.length<=e)return r;const t=Math.max(e-3,0);return r.substring(0,t)+"..."}function RY(r){return typeof r!="number"||isNaN(r)?" ":r>=90?" ":r>=80?"  ":r>=70?" ":r>=60?" ":r>=50?" ":r>=40?" ":" "}function OY(r){return typeof r!="number"||isNaN(r)?"text-gray-500 dark:text-gray-400":r>=80?"text-green-600 dark:text-green-400":r>=60?"text-blue-600 dark:text-blue-400":r>=40?"text-orange-500 dark:text-orange-400":"text-red-600 dark:text-red-400"}function QY(r){return typeof r!="number"||isNaN(r)?"bg-gray-400 dark:bg-gray-600":r>=80?"bg-green-500":r>=60?"bg-blue-500":r>=40?"bg-orange-500":"bg-red-500"}function HY(r){if(!r)return"N/A";let e;try{if(r instanceof Date)e=r;else if(r&&typeof r.seconds=="number")e=new Date(r.seconds*1e3);else if(typeof r=="string"){if(e=new Date(r),isNaN(e.getTime()))return console.warn(`formatTimestamp: Invalid date string received: ${r}`)," "}else return console.warn(`formatTimestamp: Invalid input type: ${typeof r}`)," ";return isNaN(e.getTime())?(console.warn("formatTimestamp: Resulting date is invalid.")," "):new Intl.DateTimeFormat("bn-BD",{day:"numeric",month:"long",year:"numeric"}).format(e)}catch(t){return console.error("Error formatting date:",r,t)," "}}function A3(r,e,t,n=!1){r instanceof Element&&typeof t=="function"?r.addEventListener(e,t,n):r&&typeof t!="function"&&console.warn(`addListener: Invalid handler provided for element and event "${e}".`,r)}function jY(r){return{leader:" ","team-leader":" ","co-leader":"-",member:"",monitor:"","resource-manager":" ","time-keeper":" ","peace-maker":" ",reporter:"",facilitator:""}[r]||r||""}const VY=Object.freeze(Object.defineProperty({__proto__:null,addListener:A3,convertToBanglaNumber:F1,convertToBanglaRank:NY,createDebouncer:UY,ensureBengaliText:MY,formatFileSize:PY,formatTimestamp:HY,getPerformanceBgClass:QY,getPerformanceColorClass:OY,getStudentPerformanceLevel:RY,getStudentRoleText:jY,truncateText:DY,validateEmail:LY},Symbol.toStringTag,{value:"Module"}));class $Y{constructor(){this.elements=this._cacheDOMElements(),this.onConfirmDelete=null,this.onSaveEdit=null,this.onSaveAdmin=null,this.toastTimeout=null,this._initTheme(),this._setupEventListeners(),console.log(" UIManager initialized.")}_cacheDOMElements(){const e={},t=["loadingOverlay","loadingMessage","toast","toastMessage","mobileMenuOverlay","mobileMenuButton","themeToggle","headerLoginBtn","logoutBtn","userInfo","sidebar","appContainer","authModal","closeAuthModal","loginForm","registerForm","showRegister","showLogin","loginEmail","loginPassword","loginBtn","registerEmail","registerPassword","adminType","registerBtn","googleSignInBtn","logoutModal","cancelLogout","confirmLogout","deleteModal","deleteModalTitle","deleteModalText","cancelDelete","confirmDelete","confirmModal","confirmModalTitle","confirmModalText","cancelConfirm","actionConfirm","editModal","editModalTitle","editModalContent","cancelEdit","saveEdit","profileModal","openProfileModal","closeProfileModal","adminModal","adminModalTitle","adminModalContent","cancelAdmin","saveAdmin","adminEmail","adminPassword","adminTypeSelect","permissionsSection","permissionRead","permissionWrite","permissionEdit","permissionDelete"];e.pages=document.querySelectorAll(".page"),e.navButtons=document.querySelectorAll(".nav-btn"),e.privateTabs=document.querySelectorAll(".private-tab"),e.privateTabDividers=document.querySelectorAll(".private-tab-divider"),e.privateTabContent=document.querySelectorAll(".private-tab-content");for(const n of t)e[n]=document.getElementById(n),!e[n]&&["appContainer","loadingOverlay","toast","sidebar","authModal","deleteModal","confirmModal","editModal","adminModal","profileModal","logoutModal"].includes(n)&&console.error(` UIManager: Essential element with ID "${n}" not found!`);return e}addListener(e,t,n,s=!1){A3(e,t,n,s)}_setupEventListeners(){console.log(" Setting up UIManager internal event listeners..."),this.addListener(this.elements.themeToggle,"click",()=>this._toggleTheme()),this.addListener(this.elements.mobileMenuButton,"click",()=>this._toggleMobileMenu()),this.addListener(this.elements.mobileMenuOverlay,"click",()=>this._toggleMobileMenu(!1)),this.addListener(this.elements.openProfileModal,"click",()=>this.showModal(this.elements.profileModal)),this.addListener(this.elements.closeProfileModal,"click",()=>this.hideModal(this.elements.profileModal)),this.addListener(this.elements.profileModal,"click",e=>{e.target===this.elements.profileModal&&this.hideModal(this.elements.profileModal)}),this.addListener(this.elements.headerLoginBtn,"click",()=>{this._toggleAuthForm(!1),this.showModal(this.elements.authModal)}),this.addListener(this.elements.closeAuthModal,"click",()=>this.hideModal(this.elements.authModal)),this.addListener(this.elements.showRegister,"click",()=>this._toggleAuthForm(!0)),this.addListener(this.elements.showLogin,"click",()=>this._toggleAuthForm(!1)),this.addListener(this.elements.authModal,"click",e=>{e.target===this.elements.authModal&&this.hideModal(this.elements.authModal)}),this.addListener(this.elements.logoutBtn,"click",()=>this.showModal(this.elements.logoutModal)),this.addListener(this.elements.cancelLogout,"click",()=>this.hideModal(this.elements.logoutModal)),this.addListener(this.elements.cancelDelete,"click",()=>this.hideModal(this.elements.deleteModal)),this.addListener(this.elements.confirmDelete,"click",()=>{typeof this.onConfirmDelete=="function"&&this.onConfirmDelete(),this.hideModal(this.elements.deleteModal)}),this.addListener(this.elements.cancelConfirm,"click",()=>this.hideModal(this.elements.confirmModal)),this.addListener(this.elements.actionConfirm,"click",()=>{typeof this.onConfirmAction=="function"&&this.onConfirmAction(),this.hideModal(this.elements.confirmModal)}),this.addListener(this.elements.cancelEdit,"click",()=>this.hideModal(this.elements.editModal)),this.addListener(this.elements.saveEdit,"click",()=>{typeof this.onSaveEdit=="function"&&this.onSaveEdit()}),this.addListener(this.elements.cancelAdmin,"click",()=>this.hideModal(this.elements.adminModal)),this.addListener(this.elements.saveAdmin,"click",()=>{typeof this.onSaveAdmin=="function"&&this.onSaveAdmin()}),this.addListener(this.elements.adminTypeSelect,"change",e=>this._togglePermissionsSection(e.target.value)),console.log(" UIManager internal event listeners attached.")}_initTheme(){const e=localStorage.theme==="dark"||!("theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches;this._applyTheme(e)}_toggleTheme(){const e=document.documentElement.classList.contains("dark");this._applyTheme(!e)}_applyTheme(e){document.documentElement.classList.toggle("dark",e),localStorage.theme=e?"dark":"light",this._updateThemeIcon(e)}_updateThemeIcon(e){var n;const t=(n=this.elements.themeToggle)==null?void 0:n.querySelector("i");t&&(t.className=`fas ${e?"fa-sun":"fa-moon"} text-base sm:text-lg`,this.elements.themeToggle.setAttribute("aria-label",e?"Switch to light theme":"Switch to dark theme"))}_toggleMobileMenu(e){var o;const t=this.elements.sidebar,n=this.elements.mobileMenuOverlay,s=(o=this.elements.mobileMenuButton)==null?void 0:o.querySelector("i");if(!t||!n)return;let i;const a=t.classList.contains("-translate-x-full");e===void 0?i=a:i=e,t.classList.toggle("-translate-x-full",!i),n.classList.toggle("hidden",!i),s&&(s.className=`fas ${i?"fa-times":"fa-bars"} text-xl sm:text-2xl`),this.elements.mobileMenuButton&&this.elements.mobileMenuButton.setAttribute("aria-expanded",String(i))}showPage(e){(!e||typeof e!="string")&&(console.warn(`showPage: Invalid pageId "${e}". Defaulting to dashboard.`),e="dashboard");const t=document.getElementById(`page-${e}`);if(!t){console.error(`showPage: Page element #page-${e} not found! Showing dashboard.`),e!=="dashboard"&&this.showPage("dashboard");return}this.elements.pages.forEach(n=>{n!==t&&n.classList.add("hidden")}),t.classList.remove("hidden"),ir.set("activePage",e),this._updateActiveNav(e),window.innerWidth<1024&&this._toggleMobileMenu(!1),window.scrollTo({top:0,behavior:"smooth"})}_updateActiveNav(e){var n;const t="active-nav-btn";(n=this.elements.navButtons)==null||n.forEach(s=>{const i=s.dataset.page===e;s.classList.toggle(t,i),s.setAttribute("aria-current",i?"page":"false")})}showLoading(e=" ..."){this.elements.loadingOverlay?(this.elements.loadingMessage&&(this.elements.loadingMessage.textContent=e),this.elements.loadingOverlay.classList.remove("hidden","opacity-0"),ir.setLoading(!0)):console.warn("showLoading: loadingOverlay element not found.")}hideLoading(){this.elements.loadingOverlay&&(this.elements.loadingOverlay.classList.add("opacity-0"),setTimeout(()=>{this.elements.loadingOverlay.classList.contains("opacity-0")&&this.elements.loadingOverlay.classList.add("hidden")},300),ir.setLoading(!1))}showToast(e,t="info",n=3500){if(!this.elements.toast||!this.elements.toastMessage){console.warn("showToast: Toast elements not found.");return}clearTimeout(this.toastTimeout),this.elements.toastMessage.textContent=e,this.elements.toast.className=`toast toast-${t}`,this.elements.toast.classList.remove("hidden"),this.elements.toast.offsetWidth,this.elements.toast.classList.add("toast-show"),this.toastTimeout=setTimeout(()=>{var s;(s=this.elements.toast)==null||s.classList.remove("toast-show"),setTimeout(()=>{var i;(i=this.elements.toast)==null||i.classList.add("hidden")},500)},n)}showModal(e){e instanceof Element?(e.classList.remove("hidden"),document.body.style.overflow="hidden"):console.warn("showModal: Invalid or missing modal element.")}hideModal(e){if(e instanceof Element){e.classList.add("hidden"),document.body.style.overflow="";const t=e.id;t==="deleteModal"?this.onConfirmDelete=null:t==="editModal"?(this.onSaveEdit=null,this.elements.editModalContent&&(this.elements.editModalContent.innerHTML="")):t==="adminModal"&&(this.onSaveAdmin=null)}else console.warn("hideModal: Invalid or missing modal element.")}showDeleteModal(e="",t="  ?",n){this.elements.deleteModal?(this.elements.deleteModalTitle&&(this.elements.deleteModalTitle.textContent=e),this.elements.deleteModalText&&(this.elements.deleteModalText.textContent=t),this.onConfirmDelete=n,this.showModal(this.elements.deleteModal)):console.error("showDeleteModal: deleteModal element not found.")}showConfirmModal(e,t,n,s=" ",i="btn-primary"){if(this.elements.confirmModal){this.elements.confirmModalTitle&&(this.elements.confirmModalTitle.textContent=e),this.elements.confirmModalText&&(this.elements.confirmModalText.textContent=t);const a=this.elements.actionConfirm;a&&(a.textContent=s,a.className=`btn ${i}`),this.onConfirmAction=n,this.showModal(this.elements.confirmModal)}else console.error("showConfirmModal: confirmModal element not found.")}showEditModal(e,t,n,s){this.elements.editModal?(this.elements.editModalTitle&&(this.elements.editModalTitle.textContent=e),this.elements.editModalContent?this.elements.editModalContent.innerHTML=t:console.warn("showEditModal: editModalContent element not found."),this.onSaveEdit=n,this.showModal(this.elements.editModal),typeof s=="function"&&s()):console.error("showEditModal: editModal element not found.")}showAdminModal(e,t=null,n){if(this.elements.adminModal){this.elements.adminModalTitle&&(this.elements.adminModalTitle.textContent=e);const s=this.elements.adminEmail,i=this.elements.adminPassword,a=this.elements.adminTypeSelect;s&&(s.value=(t==null?void 0:t.email)||"",s.disabled=!!t),i&&(i.value="",i.placeholder=t?"  ()":"*"),a&&(a.value=(t==null?void 0:t.type)||"user");const o=(t==null?void 0:t.permissions)||{read:!0,write:!1,edit:!1,delete:!1};this.elements.permissionRead&&(this.elements.permissionRead.checked=o.read),this.elements.permissionWrite&&(this.elements.permissionWrite.checked=o.write),this.elements.permissionEdit&&(this.elements.permissionEdit.checked=o.edit),this.elements.permissionDelete&&(this.elements.permissionDelete.checked=o.delete),this._togglePermissionsSection((a==null?void 0:a.value)||"user"),this.onSaveAdmin=n,this.showModal(this.elements.adminModal)}else console.error("showAdminModal: adminModal element not found.")}_toggleAuthForm(e){var t;if(this.elements.loginForm&&this.elements.registerForm&&this.elements.showRegister&&this.elements.showLogin){this.elements.loginForm.classList.toggle("hidden",e),this.elements.registerForm.classList.toggle("hidden",!e),this.elements.showRegister.classList.toggle("hidden",e),this.elements.showLogin.classList.toggle("hidden",!e);const n=(t=this.elements.authModal)==null?void 0:t.querySelector("h3");n&&(n.textContent=e?"   ":"  ")}}_togglePermissionsSection(e){var n;const t=e==="admin";(n=this.elements.permissionsSection)==null||n.classList.toggle("hidden",!t)}updateUserInfo(e){var n,s,i;const t=!!e;if((n=this.elements.headerLoginBtn)==null||n.classList.toggle("hidden",t),(s=this.elements.logoutBtn)==null||s.classList.toggle("hidden",!t),(i=this.elements.userInfo)==null||i.classList.toggle("hidden",!t),t&&this.elements.userInfo){const a={"super-admin":" ",admin:"",teacher:"",user:""},o=this.elements.userInfo.querySelector("div");o&&(o.textContent=a[e==null?void 0:e.type]||"")}else if(this.elements.userInfo){const a=this.elements.userInfo.querySelector("div");a&&(a.textContent="")}}enableNavigation(e,t){const n=t==="admin"||t==="super-admin",s=t==="super-admin",i=t==="teacher",a="disabled-nav";document.querySelectorAll(".private-tab").forEach(c=>{const A=c.dataset.page;let d=!1;e&&(A==="admin-management"||A==="teacher-management"||A==="class-management"?d=s:A==="tasks"||A==="evaluation"?d=n||i:d=n),c.disabled=!d,c.classList.toggle(a,!d)}),document.querySelectorAll(".private-tab-divider").forEach(c=>{c.classList.toggle("hidden",!n&&!s&&!i)})}populateSelect(e,t,n="",s=""){if(!(e instanceof HTMLSelectElement)){console.warn("populateSelect: Provided element is not a select.");return}const i=e.value;e.innerHTML="";const a=document.createElement("option");a.value=n.includes("")||n.includes("All")?"all":"",a.textContent=n,n.includes(" ")&&(a.disabled=!0,a.selected=!s&&!i),e.appendChild(a),t==null||t.forEach(c=>{if(c&&typeof c.value<"u"&&typeof c.text<"u"){const A=document.createElement("option");A.value=c.value,A.textContent=c.text,e.appendChild(A)}});const o=["","all",...t.map(c=>c.value)],l=s&&o.includes(s)?s:i&&o.includes(i)?i:a.value;e.value=l}displayEmptyMessage(e,t="   "){if(!(e instanceof Element)){console.warn("displayEmptyMessage: Provided container is not valid.");return}e.innerHTML=`<div class="placeholder-content p-6 text-center text-gray-500 dark:text-gray-400">
            <i class="fas fa-info-circle text-3xl mb-3 text-gray-400"></i><p>${t}</p>
        </div>`}clearContainer(e){e instanceof Element?e.innerHTML="":e&&console.warn("clearContainer: Provided container is not valid.",e)}}const Gt=new $Y,GY=()=>{};var dk={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d3=function(r){const e=[];let t=0;for(let n=0;n<r.length;n++){let s=r.charCodeAt(n);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&n+1<r.length&&(r.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(r.charCodeAt(++n)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},zY=function(r){const e=[];let t=0,n=0;for(;t<r.length;){const s=r[t++];if(s<128)e[n++]=String.fromCharCode(s);else if(s>191&&s<224){const i=r[t++];e[n++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=r[t++],a=r[t++],o=r[t++],l=((s&7)<<18|(i&63)<<12|(a&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(l>>10)),e[n++]=String.fromCharCode(56320+(l&1023))}else{const i=r[t++],a=r[t++];e[n++]=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63)}}return e.join("")},u3={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(r,e){if(!Array.isArray(r))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<r.length;s+=3){const i=r[s],a=s+1<r.length,o=a?r[s+1]:0,l=s+2<r.length,c=l?r[s+2]:0,A=i>>2,d=(i&3)<<4|o>>4;let h=(o&15)<<2|c>>6,u=c&63;l||(u=64,a||(h=64)),n.push(t[A],t[d],t[h],t[u])}return n.join("")},encodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(r):this.encodeByteArray(d3(r),e)},decodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(r):zY(this.decodeStringToByteArray(r,e))},decodeStringToByteArray(r,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<r.length;){const i=t[r.charAt(s++)],o=s<r.length?t[r.charAt(s)]:0;++s;const c=s<r.length?t[r.charAt(s)]:64;++s;const d=s<r.length?t[r.charAt(s)]:64;if(++s,i==null||o==null||c==null||d==null)throw new KY;const h=i<<2|o>>4;if(n.push(h),c!==64){const u=o<<4&240|c>>2;if(n.push(u),d!==64){const p=c<<6&192|d;n.push(p)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let r=0;r<this.ENCODED_VALS.length;r++)this.byteToCharMap_[r]=this.ENCODED_VALS.charAt(r),this.charToByteMap_[this.byteToCharMap_[r]]=r,this.byteToCharMapWebSafe_[r]=this.ENCODED_VALS_WEBSAFE.charAt(r),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[r]]=r,r>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(r)]=r,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(r)]=r)}}};class KY extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const qY=function(r){const e=d3(r);return u3.encodeByteArray(e,!0)},nb=function(r){return qY(r).replace(/\./g,"")},h3=function(r){try{return u3.decodeString(r,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WY(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YY=()=>WY().__FIREBASE_DEFAULTS__,XY=()=>{if(typeof process>"u"||typeof dk>"u")return;const r=dk.__FIREBASE_DEFAULTS__;if(r)return JSON.parse(r)},JY=()=>{if(typeof document>"u")return;let r;try{r=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=r&&h3(r[1]);return e&&JSON.parse(e)},Wb=()=>{try{return GY()||YY()||XY()||JY()}catch(r){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${r}`);return}},f3=r=>{var e,t;return(t=(e=Wb())==null?void 0:e.emulatorHosts)==null?void 0:t[r]},ZY=r=>{const e=f3(r);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),n]:[e.substring(0,t),n]},g3=()=>{var r;return(r=Wb())==null?void 0:r.config},p3=r=>{var e;return(e=Wb())==null?void 0:e[`_${r}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eX{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xh(r){try{return(r.startsWith("http://")||r.startsWith("https://")?new URL(r).hostname:r).endsWith(".cloudworkstations.dev")}catch{return!1}}async function m3(r){return(await fetch(r,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tX(r,e){if(r.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},n=e||"demo-project",s=r.iat||0,i=r.sub||r.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...r};return[nb(JSON.stringify(t)),nb(JSON.stringify(a)),""].join(".")}const eg={};function rX(){const r={prod:[],emulator:[]};for(const e of Object.keys(eg))eg[e]?r.emulator.push(e):r.prod.push(e);return r}function nX(r){let e=document.getElementById(r),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",r),t=!0),{created:t,element:e}}let uk=!1;function b3(r,e){if(typeof window>"u"||typeof document>"u"||!xh(window.location.host)||eg[r]===e||eg[r]||uk)return;eg[r]=e;function t(h){return`__firebase__banner__${h}`}const n="__firebase__banner",i=rX().prod.length>0;function a(){const h=document.getElementById(n);h&&h.remove()}function o(h){h.style.display="flex",h.style.background="#7faaf0",h.style.position="fixed",h.style.bottom="5px",h.style.left="5px",h.style.padding=".5em",h.style.borderRadius="5px",h.style.alignItems="center"}function l(h,u){h.setAttribute("width","24"),h.setAttribute("id",u),h.setAttribute("height","24"),h.setAttribute("viewBox","0 0 24 24"),h.setAttribute("fill","none"),h.style.marginLeft="-6px"}function c(){const h=document.createElement("span");return h.style.cursor="pointer",h.style.marginLeft="16px",h.style.fontSize="24px",h.innerHTML=" &times;",h.onclick=()=>{uk=!0,a()},h}function A(h,u){h.setAttribute("id",u),h.innerText="Learn more",h.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",h.setAttribute("target","__blank"),h.style.paddingLeft="5px",h.style.textDecoration="underline"}function d(){const h=nX(n),u=t("text"),p=document.getElementById(u)||document.createElement("span"),f=t("learnmore"),g=document.getElementById(f)||document.createElement("a"),m=t("preprendIcon"),x=document.getElementById(m)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(h.created){const S=h.element;o(S),A(g,f);const B=c();l(x,m),S.append(x,p,g,B),document.body.appendChild(S)}i?(p.innerText="Preview backend disconnected.",x.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(x.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,p.innerText="Preview backend running in this workspace."),p.setAttribute("id",u)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",d):d()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ui(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function sX(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ui())}function iX(){var e;const r=(e=Wb())==null?void 0:e.forceEnvironment;if(r==="node")return!0;if(r==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function aX(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function oX(){const r=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof r=="object"&&r.id!==void 0}function lX(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function cX(){const r=Ui();return r.indexOf("MSIE ")>=0||r.indexOf("Trident/")>=0}function AX(){return!iX()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function dX(){try{return typeof indexedDB=="object"}catch{return!1}}function uX(){return new Promise((r,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(n),r(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var i;e(((i=s.error)==null?void 0:i.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hX="FirebaseError";class lc extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name=hX,Object.setPrototypeOf(this,lc.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Vg.prototype.create)}}class Vg{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},s=`${this.service}/${e}`,i=this.errors[e],a=i?fX(i,n):"Error",o=`${this.serviceName}: ${a} (${s}).`;return new lc(s,o,n)}}function fX(r,e){return r.replace(gX,(t,n)=>{const s=e[n];return s!=null?String(s):`<${n}?>`})}const gX=/\{\$([^}]+)}/g;function pX(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}function Nd(r,e){if(r===e)return!0;const t=Object.keys(r),n=Object.keys(e);for(const s of t){if(!n.includes(s))return!1;const i=r[s],a=e[s];if(hk(i)&&hk(a)){if(!Nd(i,a))return!1}else if(i!==a)return!1}for(const s of n)if(!t.includes(s))return!1;return!0}function hk(r){return r!==null&&typeof r=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $g(r){const e=[];for(const[t,n]of Object.entries(r))Array.isArray(n)?n.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Bf(r){const e={};return r.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[s,i]=n.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function Cf(r){const e=r.indexOf("?");if(!e)return"";const t=r.indexOf("#",e);return r.substring(e,t>0?t:void 0)}function mX(r,e){const t=new bX(r,e);return t.subscribe.bind(t)}class bX{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let s;if(e===void 0&&t===void 0&&n===void 0)throw new Error("Missing Observer.");yX(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:n},s.next===void 0&&(s.next=Zw),s.error===void 0&&(s.error=Zw),s.complete===void 0&&(s.complete=Zw);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function yX(r,e){if(typeof r!="object"||r===null)return!1;for(const t of e)if(t in r&&typeof r[t]=="function")return!0;return!1}function Zw(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fs(r){return r&&r._delegate?r._delegate:r}class Pd{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sd="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wX{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new eX;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),n=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(s){if(n)return null;throw s}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(xX(e))try{this.getOrInitializeService({instanceIdentifier:sd})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:s});n.resolve(i)}catch{}}}}clearInstance(e=sd){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=sd){return this.instances.has(e)}getOptions(e=sd){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[i,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(i);n===o&&a.resolve(s)}return s}onInit(e,t){const n=this.normalizeInstanceIdentifier(t),s=this.onInitCallbacks.get(n)??new Set;s.add(e),this.onInitCallbacks.set(n,s);const i=this.instances.get(n);return i&&e(i,n),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const s of n)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:vX(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=sd){return this.component?this.component.multipleInstances?e:sd:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function vX(r){return r===sd?void 0:r}function xX(r){return r.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _X{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new wX(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Er;(function(r){r[r.DEBUG=0]="DEBUG",r[r.VERBOSE=1]="VERBOSE",r[r.INFO=2]="INFO",r[r.WARN=3]="WARN",r[r.ERROR=4]="ERROR",r[r.SILENT=5]="SILENT"})(Er||(Er={}));const BX={debug:Er.DEBUG,verbose:Er.VERBOSE,info:Er.INFO,warn:Er.WARN,error:Er.ERROR,silent:Er.SILENT},CX=Er.INFO,SX={[Er.DEBUG]:"log",[Er.VERBOSE]:"log",[Er.INFO]:"info",[Er.WARN]:"warn",[Er.ERROR]:"error"},kX=(r,e,...t)=>{if(e<r.logLevel)return;const n=new Date().toISOString(),s=SX[e];if(s)console[s](`[${n}]  ${r.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class s2{constructor(e){this.name=e,this._logLevel=CX,this._logHandler=kX,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Er))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?BX[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Er.DEBUG,...e),this._logHandler(this,Er.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Er.VERBOSE,...e),this._logHandler(this,Er.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Er.INFO,...e),this._logHandler(this,Er.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Er.WARN,...e),this._logHandler(this,Er.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Er.ERROR,...e),this._logHandler(this,Er.ERROR,...e)}}const EX=(r,e)=>e.some(t=>r instanceof t);let fk,gk;function IX(){return fk||(fk=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function TX(){return gk||(gk=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const y3=new WeakMap,L1=new WeakMap,w3=new WeakMap,ev=new WeakMap,i2=new WeakMap;function FX(r){const e=new Promise((t,n)=>{const s=()=>{r.removeEventListener("success",i),r.removeEventListener("error",a)},i=()=>{t(oA(r.result)),s()},a=()=>{n(r.error),s()};r.addEventListener("success",i),r.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&y3.set(t,r)}).catch(()=>{}),i2.set(e,r),e}function LX(r){if(L1.has(r))return;const e=new Promise((t,n)=>{const s=()=>{r.removeEventListener("complete",i),r.removeEventListener("error",a),r.removeEventListener("abort",a)},i=()=>{t(),s()},a=()=>{n(r.error||new DOMException("AbortError","AbortError")),s()};r.addEventListener("complete",i),r.addEventListener("error",a),r.addEventListener("abort",a)});L1.set(r,e)}let U1={get(r,e,t){if(r instanceof IDBTransaction){if(e==="done")return L1.get(r);if(e==="objectStoreNames")return r.objectStoreNames||w3.get(r);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return oA(r[e])},set(r,e,t){return r[e]=t,!0},has(r,e){return r instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in r}};function UX(r){U1=r(U1)}function MX(r){return r===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const n=r.call(tv(this),e,...t);return w3.set(n,e.sort?e.sort():[e]),oA(n)}:TX().includes(r)?function(...e){return r.apply(tv(this),e),oA(y3.get(this))}:function(...e){return oA(r.apply(tv(this),e))}}function NX(r){return typeof r=="function"?MX(r):(r instanceof IDBTransaction&&LX(r),EX(r,IX())?new Proxy(r,U1):r)}function oA(r){if(r instanceof IDBRequest)return FX(r);if(ev.has(r))return ev.get(r);const e=NX(r);return e!==r&&(ev.set(r,e),i2.set(e,r)),e}const tv=r=>i2.get(r);function PX(r,e,{blocked:t,upgrade:n,blocking:s,terminated:i}={}){const a=indexedDB.open(r,e),o=oA(a);return n&&a.addEventListener("upgradeneeded",l=>{n(oA(a.result),l.oldVersion,l.newVersion,oA(a.transaction),l)}),t&&a.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),o.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const DX=["get","getKey","getAll","getAllKeys","count"],RX=["put","add","delete","clear"],rv=new Map;function pk(r,e){if(!(r instanceof IDBDatabase&&!(e in r)&&typeof e=="string"))return;if(rv.get(e))return rv.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,s=RX.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(s||DX.includes(t)))return;const i=async function(a,...o){const l=this.transaction(a,s?"readwrite":"readonly");let c=l.store;return n&&(c=c.index(o.shift())),(await Promise.all([c[t](...o),s&&l.done]))[0]};return rv.set(e,i),i}UX(r=>({...r,get:(e,t,n)=>pk(e,t)||r.get(e,t,n),has:(e,t)=>!!pk(e,t)||r.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OX{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(QX(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(t=>t).join(" ")}}function QX(r){const e=r.getComponent();return(e==null?void 0:e.type)==="VERSION"}const M1="@firebase/app",mk="0.14.5";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rc=new s2("@firebase/app"),HX="@firebase/app-compat",jX="@firebase/analytics-compat",VX="@firebase/analytics",$X="@firebase/app-check-compat",GX="@firebase/app-check",zX="@firebase/auth",KX="@firebase/auth-compat",qX="@firebase/database",WX="@firebase/data-connect",YX="@firebase/database-compat",XX="@firebase/functions",JX="@firebase/functions-compat",ZX="@firebase/installations",eJ="@firebase/installations-compat",tJ="@firebase/messaging",rJ="@firebase/messaging-compat",nJ="@firebase/performance",sJ="@firebase/performance-compat",iJ="@firebase/remote-config",aJ="@firebase/remote-config-compat",oJ="@firebase/storage",lJ="@firebase/storage-compat",cJ="@firebase/firestore",AJ="@firebase/ai",dJ="@firebase/firestore-compat",uJ="firebase",hJ="12.5.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N1="[DEFAULT]",fJ={[M1]:"fire-core",[HX]:"fire-core-compat",[VX]:"fire-analytics",[jX]:"fire-analytics-compat",[GX]:"fire-app-check",[$X]:"fire-app-check-compat",[zX]:"fire-auth",[KX]:"fire-auth-compat",[qX]:"fire-rtdb",[WX]:"fire-data-connect",[YX]:"fire-rtdb-compat",[XX]:"fire-fn",[JX]:"fire-fn-compat",[ZX]:"fire-iid",[eJ]:"fire-iid-compat",[tJ]:"fire-fcm",[rJ]:"fire-fcm-compat",[nJ]:"fire-perf",[sJ]:"fire-perf-compat",[iJ]:"fire-rc",[aJ]:"fire-rc-compat",[oJ]:"fire-gcs",[lJ]:"fire-gcs-compat",[cJ]:"fire-fst",[dJ]:"fire-fst-compat",[AJ]:"fire-vertex","fire-js":"fire-js",[uJ]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sb=new Map,gJ=new Map,P1=new Map;function bk(r,e){try{r.container.addComponent(e)}catch(t){rc.debug(`Component ${e.name} failed to register with FirebaseApp ${r.name}`,t)}}function ah(r){const e=r.name;if(P1.has(e))return rc.debug(`There were multiple attempts to register component ${e}.`),!1;P1.set(e,r);for(const t of sb.values())bk(t,r);for(const t of gJ.values())bk(t,r);return!0}function a2(r,e){const t=r.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),r.container.getProvider(e)}function Ea(r){return r==null?!1:r.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pJ={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},lA=new Vg("app","Firebase",pJ);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mJ{constructor(e,t,n){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Pd("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw lA.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _h=hJ;function v3(r,e={}){let t=r;typeof e!="object"&&(e={name:e});const n={name:N1,automaticDataCollectionEnabled:!0,...e},s=n.name;if(typeof s!="string"||!s)throw lA.create("bad-app-name",{appName:String(s)});if(t||(t=g3()),!t)throw lA.create("no-options");const i=sb.get(s);if(i){if(Nd(t,i.options)&&Nd(n,i.config))return i;throw lA.create("duplicate-app",{appName:s})}const a=new _X(s);for(const l of P1.values())a.addComponent(l);const o=new mJ(t,n,a);return sb.set(s,o),o}function x3(r=N1){const e=sb.get(r);if(!e&&r===N1&&g3())return v3();if(!e)throw lA.create("no-app",{appName:r});return e}function cA(r,e,t){let n=fJ[r]??r;t&&(n+=`-${t}`);const s=n.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const a=[`Unable to register library "${n}" with version "${e}":`];s&&a.push(`library name "${n}" contains illegal characters (whitespace or "/")`),s&&i&&a.push("and"),i&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),rc.warn(a.join(" "));return}ah(new Pd(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bJ="firebase-heartbeat-database",yJ=1,xg="firebase-heartbeat-store";let nv=null;function _3(){return nv||(nv=PX(bJ,yJ,{upgrade:(r,e)=>{switch(e){case 0:try{r.createObjectStore(xg)}catch(t){console.warn(t)}}}}).catch(r=>{throw lA.create("idb-open",{originalErrorMessage:r.message})})),nv}async function wJ(r){try{const t=(await _3()).transaction(xg),n=await t.objectStore(xg).get(B3(r));return await t.done,n}catch(e){if(e instanceof lc)rc.warn(e.message);else{const t=lA.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});rc.warn(t.message)}}}async function yk(r,e){try{const n=(await _3()).transaction(xg,"readwrite");await n.objectStore(xg).put(e,B3(r)),await n.done}catch(t){if(t instanceof lc)rc.warn(t.message);else{const n=lA.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});rc.warn(n.message)}}}function B3(r){return`${r.name}!${r.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vJ=1024,xJ=30;class _J{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new CJ(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,t;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=wk();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>xJ){const a=SJ(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){rc.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=wk(),{heartbeatsToSend:n,unsentEntries:s}=BJ(this._heartbeatsCache.heartbeats),i=nb(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return rc.warn(t),""}}}function wk(){return new Date().toISOString().substring(0,10)}function BJ(r,e=vJ){const t=[];let n=r.slice();for(const s of r){const i=t.find(a=>a.agent===s.agent);if(i){if(i.dates.push(s.date),vk(t)>e){i.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),vk(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}class CJ{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return dX()?uX().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await wJ(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return yk(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return yk(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function vk(r){return nb(JSON.stringify({version:2,heartbeats:r})).length}function SJ(r){if(r.length===0)return-1;let e=0,t=r[0].date;for(let n=1;n<r.length;n++)r[n].date<t&&(t=r[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kJ(r){ah(new Pd("platform-logger",e=>new OX(e),"PRIVATE")),ah(new Pd("heartbeat",e=>new _J(e),"PRIVATE")),cA(M1,mk,r),cA(M1,mk,"esm2020"),cA("fire-js","")}kJ("");var EJ="firebase",IJ="12.5.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */cA(EJ,IJ,"app");function C3(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const TJ=C3,S3=new Vg("auth","Firebase",C3());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ib=new s2("@firebase/auth");function FJ(r,...e){ib.logLevel<=Er.WARN&&ib.warn(`Auth (${_h}): ${r}`,...e)}function um(r,...e){ib.logLevel<=Er.ERROR&&ib.error(`Auth (${_h}): ${r}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function no(r,...e){throw l2(r,...e)}function mo(r,...e){return l2(r,...e)}function o2(r,e,t){const n={...TJ(),[e]:t};return new Vg("auth","Firebase",n).create(e,{appName:r.name})}function Yl(r){return o2(r,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function LJ(r,e,t){const n=t;if(!(e instanceof n))throw n.name!==e.constructor.name&&no(r,"argument-error"),o2(r,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function l2(r,...e){if(typeof r!="string"){const t=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=r.name),r._errorFactory.create(t,...n)}return S3.create(r,...e)}function Kt(r,e,...t){if(!r)throw l2(e,...t)}function $l(r){const e="INTERNAL ASSERTION FAILED: "+r;throw um(e),new Error(e)}function nc(r,e){r||$l(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D1(){var r;return typeof self<"u"&&((r=self.location)==null?void 0:r.href)||""}function UJ(){return xk()==="http:"||xk()==="https:"}function xk(){var r;return typeof self<"u"&&((r=self.location)==null?void 0:r.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MJ(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(UJ()||oX()||"connection"in navigator)?navigator.onLine:!0}function NJ(){if(typeof navigator>"u")return null;const r=navigator;return r.languages&&r.languages[0]||r.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gg{constructor(e,t){this.shortDelay=e,this.longDelay=t,nc(t>e,"Short delay should be less than long delay!"),this.isMobile=sX()||lX()}get(){return MJ()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c2(r,e){nc(r.emulator,"Emulator should always be set here");const{url:t}=r.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k3{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;$l("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;$l("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;$l("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PJ={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DJ=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],RJ=new Gg(3e4,6e4);function TA(r,e){return r.tenantId&&!e.tenantId?{...e,tenantId:r.tenantId}:e}async function FA(r,e,t,n,s={}){return E3(r,s,async()=>{let i={},a={};n&&(e==="GET"?a=n:i={body:JSON.stringify(n)});const o=$g({key:r.config.apiKey,...a}).slice(1),l=await r._getProgressHeaders();l["Content-Type"]="application/json",r.languageCode&&(l["X-Firebase-Locale"]=r.languageCode);const c={method:e,headers:l,...i};return aX()||(c.referrerPolicy="no-referrer"),r.emulatorConfig&&xh(r.emulatorConfig.host)&&(c.credentials="include"),k3.fetch()(await I3(r,r.config.apiHost,t,o),c)})}async function E3(r,e,t){r._canInitEmulator=!1;const n={...PJ,...e};try{const s=new QJ(r),i=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const a=await i.json();if("needConfirmation"in a)throw U0(r,"account-exists-with-different-credential",a);if(i.ok&&!("errorMessage"in a))return a;{const o=i.ok?a.errorMessage:a.error.message,[l,c]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw U0(r,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw U0(r,"email-already-in-use",a);if(l==="USER_DISABLED")throw U0(r,"user-disabled",a);const A=n[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw o2(r,A,c);no(r,A)}}catch(s){if(s instanceof lc)throw s;no(r,"network-request-failed",{message:String(s)})}}async function zg(r,e,t,n,s={}){const i=await FA(r,e,t,n,s);return"mfaPendingCredential"in i&&no(r,"multi-factor-auth-required",{_serverResponse:i}),i}async function I3(r,e,t,n){const s=`${e}${t}?${n}`,i=r,a=i.config.emulator?c2(r.config,s):`${r.config.apiScheme}://${s}`;return DJ.includes(t)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(a).toString():a}function OJ(r){switch(r){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class QJ{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,n)=>{this.timer=setTimeout(()=>n(mo(this.auth,"network-request-failed")),RJ.get())})}}function U0(r,e,t){const n={appName:r.name};t.email&&(n.email=t.email),t.phoneNumber&&(n.phoneNumber=t.phoneNumber);const s=mo(r,e,n);return s.customData._tokenResponse=t,s}function _k(r){return r!==void 0&&r.enterprise!==void 0}class HJ{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return OJ(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function jJ(r,e){return FA(r,"GET","/v2/recaptchaConfig",TA(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VJ(r,e){return FA(r,"POST","/v1/accounts:delete",e)}async function ab(r,e){return FA(r,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tg(r){if(r)try{const e=new Date(Number(r));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function $J(r,e=!1){const t=fs(r),n=await t.getIdToken(e),s=A2(n);Kt(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,a=i==null?void 0:i.sign_in_provider;return{claims:s,token:n,authTime:tg(sv(s.auth_time)),issuedAtTime:tg(sv(s.iat)),expirationTime:tg(sv(s.exp)),signInProvider:a||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function sv(r){return Number(r)*1e3}function A2(r){const[e,t,n]=r.split(".");if(e===void 0||t===void 0||n===void 0)return um("JWT malformed, contained fewer than 3 sections"),null;try{const s=h3(t);return s?JSON.parse(s):(um("Failed to decode base64 JWT payload"),null)}catch(s){return um("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function Bk(r){const e=A2(r);return Kt(e,"internal-error"),Kt(typeof e.exp<"u","internal-error"),Kt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _g(r,e,t=!1){if(t)return e;try{return await e}catch(n){throw n instanceof lc&&GJ(n)&&r.auth.currentUser===r&&await r.auth.signOut(),n}}function GJ({code:r}){return r==="auth/user-disabled"||r==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zJ{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R1{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=tg(this.lastLoginAt),this.creationTime=tg(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ob(r){var d;const e=r.auth,t=await r.getIdToken(),n=await _g(r,ab(e,{idToken:t}));Kt(n==null?void 0:n.users.length,e,"internal-error");const s=n.users[0];r._notifyReloadListener(s);const i=(d=s.providerUserInfo)!=null&&d.length?T3(s.providerUserInfo):[],a=qJ(r.providerData,i),o=r.isAnonymous,l=!(r.email&&s.passwordHash)&&!(a!=null&&a.length),c=o?l:!1,A={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new R1(s.createdAt,s.lastLoginAt),isAnonymous:c};Object.assign(r,A)}async function KJ(r){const e=fs(r);await ob(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function qJ(r,e){return[...r.filter(n=>!e.some(s=>s.providerId===n.providerId)),...e]}function T3(r){return r.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WJ(r,e){const t=await E3(r,{},async()=>{const n=$g({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=r.config,a=await I3(r,s,"/v1/token",`key=${i}`),o=await r._getProgressHeaders();o["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:o,body:n};return r.emulatorConfig&&xh(r.emulatorConfig.host)&&(l.credentials="include"),k3.fetch()(a,l)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function YJ(r,e){return FA(r,"POST","/v2/accounts:revokeToken",TA(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ku{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Kt(e.idToken,"internal-error"),Kt(typeof e.idToken<"u","internal-error"),Kt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Bk(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Kt(e.length!==0,"internal-error");const t=Bk(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Kt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:s,expiresIn:i}=await WJ(e,t);this.updateTokensAndExpiration(n,s,Number(i))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,t){const{refreshToken:n,accessToken:s,expirationTime:i}=t,a=new Ku;return n&&(Kt(typeof n=="string","internal-error",{appName:e}),a.refreshToken=n),s&&(Kt(typeof s=="string","internal-error",{appName:e}),a.accessToken=s),i&&(Kt(typeof i=="number","internal-error",{appName:e}),a.expirationTime=i),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ku,this.toJSON())}_performRefresh(){return $l("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pc(r,e){Kt(typeof r=="string"||typeof r>"u","internal-error",{appName:e})}class fo{constructor({uid:e,auth:t,stsTokenManager:n,...s}){this.providerId="firebase",this.proactiveRefresh=new zJ(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new R1(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await _g(this,this.stsTokenManager.getToken(this.auth,e));return Kt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return $J(this,e)}reload(){return KJ(this)}_assign(e){this!==e&&(Kt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new fo({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Kt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await ob(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ea(this.auth.app))return Promise.reject(Yl(this.auth));const e=await this.getIdToken();return await _g(this,VJ(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const n=t.displayName??void 0,s=t.email??void 0,i=t.phoneNumber??void 0,a=t.photoURL??void 0,o=t.tenantId??void 0,l=t._redirectEventId??void 0,c=t.createdAt??void 0,A=t.lastLoginAt??void 0,{uid:d,emailVerified:h,isAnonymous:u,providerData:p,stsTokenManager:f}=t;Kt(d&&f,e,"internal-error");const g=Ku.fromJSON(this.name,f);Kt(typeof d=="string",e,"internal-error"),Pc(n,e.name),Pc(s,e.name),Kt(typeof h=="boolean",e,"internal-error"),Kt(typeof u=="boolean",e,"internal-error"),Pc(i,e.name),Pc(a,e.name),Pc(o,e.name),Pc(l,e.name),Pc(c,e.name),Pc(A,e.name);const m=new fo({uid:d,auth:e,email:s,emailVerified:h,displayName:n,isAnonymous:u,photoURL:a,phoneNumber:i,tenantId:o,stsTokenManager:g,createdAt:c,lastLoginAt:A});return p&&Array.isArray(p)&&(m.providerData=p.map(x=>({...x}))),l&&(m._redirectEventId=l),m}static async _fromIdTokenResponse(e,t,n=!1){const s=new Ku;s.updateFromServerResponse(t);const i=new fo({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:n});return await ob(i),i}static async _fromGetAccountInfoResponse(e,t,n){const s=t.users[0];Kt(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?T3(s.providerUserInfo):[],a=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),o=new Ku;o.updateFromIdToken(n);const l=new fo({uid:s.localId,auth:e,stsTokenManager:o,isAnonymous:a}),c={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new R1(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ck=new Map;function Gl(r){nc(r instanceof Function,"Expected a class definition");let e=Ck.get(r);return e?(nc(e instanceof r,"Instance stored in cache mismatched with class"),e):(e=new r,Ck.set(r,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F3{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}F3.type="NONE";const Sk=F3;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hm(r,e,t){return`firebase:${r}:${e}:${t}`}class qu{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:s,name:i}=this.auth;this.fullUserKey=hm(this.userKey,s.apiKey,i),this.fullPersistenceKey=hm("persistence",s.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await ab(this.auth,{idToken:e}).catch(()=>{});return t?fo._fromGetAccountInfoResponse(this.auth,t,e):null}return fo._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new qu(Gl(Sk),e,n);const s=(await Promise.all(t.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let i=s[0]||Gl(Sk);const a=hm(n,e.config.apiKey,e.name);let o=null;for(const c of t)try{const A=await c._get(a);if(A){let d;if(typeof A=="string"){const h=await ab(e,{idToken:A}).catch(()=>{});if(!h)break;d=await fo._fromGetAccountInfoResponse(e,h,A)}else d=fo._fromJSON(e,A);c!==i&&(o=d),i=c;break}}catch{}const l=s.filter(c=>c._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new qu(i,e,n):(i=l[0],o&&await i._set(a,o.toJSON()),await Promise.all(t.map(async c=>{if(c!==i)try{await c._remove(a)}catch{}})),new qu(i,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kk(r){const e=r.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(N3(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(L3(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(D3(e))return"Blackberry";if(R3(e))return"Webos";if(U3(e))return"Safari";if((e.includes("chrome/")||M3(e))&&!e.includes("edge/"))return"Chrome";if(P3(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=r.match(t);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function L3(r=Ui()){return/firefox\//i.test(r)}function U3(r=Ui()){const e=r.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function M3(r=Ui()){return/crios\//i.test(r)}function N3(r=Ui()){return/iemobile/i.test(r)}function P3(r=Ui()){return/android/i.test(r)}function D3(r=Ui()){return/blackberry/i.test(r)}function R3(r=Ui()){return/webos/i.test(r)}function d2(r=Ui()){return/iphone|ipad|ipod/i.test(r)||/macintosh/i.test(r)&&/mobile/i.test(r)}function XJ(r=Ui()){var e;return d2(r)&&!!((e=window.navigator)!=null&&e.standalone)}function JJ(){return cX()&&document.documentMode===10}function O3(r=Ui()){return d2(r)||P3(r)||R3(r)||D3(r)||/windows phone/i.test(r)||N3(r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q3(r,e=[]){let t;switch(r){case"Browser":t=kk(Ui());break;case"Worker":t=`${kk(Ui())}-${r}`;break;default:t=r}const n=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${_h}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZJ{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=i=>new Promise((a,o)=>{try{const l=e(i);a(l)}catch(l){o(l)}});n.onAbort=t,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eZ(r,e={}){return FA(r,"GET","/v2/passwordPolicy",TA(r,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tZ=6;class rZ{constructor(e){var n;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??tZ,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((n=e.allowedNonAlphanumericCharacters)==null?void 0:n.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let n;for(let s=0;s<e.length;s++)n=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nZ{constructor(e,t,n,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ek(this),this.idTokenSubscription=new Ek(this),this.beforeStateQueue=new ZJ(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=S3,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Gl(t)),this._initializationPromise=this.queue(async()=>{var n,s,i;if(!this._deleted&&(this.persistenceManager=await qu.create(this,e),(n=this._resolvePersistenceManagerAvailable)==null||n.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await ab(this,{idToken:e}),n=await fo._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if(Ea(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let n=t,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(i=this.redirectUser)==null?void 0:i._redirectEventId,o=n==null?void 0:n._redirectEventId,l=await this.tryRedirectSignIn(e);(!a||a===o)&&(l!=null&&l.user)&&(n=l.user,s=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(n)}catch(a){n=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return Kt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await ob(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=NJ()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ea(this.app))return Promise.reject(Yl(this));const t=e?fs(e):null;return t&&Kt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Kt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ea(this.app)?Promise.reject(Yl(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ea(this.app)?Promise.reject(Yl(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Gl(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await eZ(this),t=new rZ(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Vg("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(n.tenantId=this.tenantId),await YJ(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Gl(e)||this._popupRedirectResolver;Kt(t,this,"argument-error"),this.redirectPersistenceManager=await qu.create(this,[Gl(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((n=this.redirectUser)==null?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,s){if(this._deleted)return()=>{};const i=typeof t=="function"?t:t.next.bind(t);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Kt(o,this,"internal-error"),o.then(()=>{a||i(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,n,s);return()=>{a=!0,l()}}else{const l=e.addObserver(t);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Kt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Q3(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getProgressHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){var t;if(Ea(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&FJ(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function LA(r){return fs(r)}class Ek{constructor(e){this.auth=e,this.observer=null,this.addObserver=mX(t=>this.observer=t)}get next(){return Kt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Yb={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function sZ(r){Yb=r}function H3(r){return Yb.loadJS(r)}function iZ(){return Yb.recaptchaEnterpriseScript}function aZ(){return Yb.gapiScript}function oZ(r){return`__${r}${Math.floor(Math.random()*1e6)}`}class lZ{constructor(){this.enterprise=new cZ}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class cZ{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const AZ="recaptcha-enterprise",j3="NO_RECAPTCHA";class dZ{constructor(e){this.type=AZ,this.auth=LA(e)}async verify(e="verify",t=!1){async function n(i){if(!t){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(a,o)=>{jJ(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)o(new Error("recaptcha Enterprise site key undefined"));else{const c=new HJ(l);return i.tenantId==null?i._agentRecaptchaConfig=c:i._tenantRecaptchaConfigs[i.tenantId]=c,a(c.siteKey)}}).catch(l=>{o(l)})})}function s(i,a,o){const l=window.grecaptcha;_k(l)?l.enterprise.ready(()=>{l.enterprise.execute(i,{action:e}).then(c=>{a(c)}).catch(()=>{a(j3)})}):o(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new lZ().execute("siteKey",{action:"verify"}):new Promise((i,a)=>{n(this.auth).then(o=>{if(!t&&_k(window.grecaptcha))s(o,i,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let l=iZ();l.length!==0&&(l+=o),H3(l).then(()=>{s(o,i,a)}).catch(c=>{a(c)})}}).catch(o=>{a(o)})})}}async function Ik(r,e,t,n=!1,s=!1){const i=new dZ(r);let a;if(s)a=j3;else try{a=await i.verify(t)}catch{a=await i.verify(t,!0)}const o={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in o){const l=o.phoneEnrollmentInfo.phoneNumber,c=o.phoneEnrollmentInfo.recaptchaToken;Object.assign(o,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:c,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in o){const l=o.phoneSignInInfo.recaptchaToken;Object.assign(o,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return o}return n?Object.assign(o,{captchaResp:a}):Object.assign(o,{captchaResponse:a}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function O1(r,e,t,n,s){var i;if((i=r._getRecaptchaConfig())!=null&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await Ik(r,e,t,t==="getOobCode");return n(r,a)}else return n(r,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await Ik(r,e,t,t==="getOobCode");return n(r,o)}else return Promise.reject(a)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uZ(r,e){const t=a2(r,"auth");if(t.isInitialized()){const s=t.getImmediate(),i=t.getOptions();if(Nd(i,e??{}))return s;no(s,"already-initialized")}return t.initialize({options:e})}function hZ(r,e){const t=(e==null?void 0:e.persistence)||[],n=(Array.isArray(t)?t:[t]).map(Gl);e!=null&&e.errorMap&&r._updateErrorMap(e.errorMap),r._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function fZ(r,e,t){const n=LA(r);Kt(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const s=!1,i=V3(e),{host:a,port:o}=gZ(e),l=o===null?"":`:${o}`,c={url:`${i}//${a}${l}/`},A=Object.freeze({host:a,port:o,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!n._canInitEmulator){Kt(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),Kt(Nd(c,n.config.emulator)&&Nd(A,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=c,n.emulatorConfig=A,n.settings.appVerificationDisabledForTesting=!0,xh(a)?(m3(`${i}//${a}${l}`),b3("Auth",!0)):pZ()}function V3(r){const e=r.indexOf(":");return e<0?"":r.substr(0,e+1)}function gZ(r){const e=V3(r),t=/(\/\/)?([^?#/]+)/.exec(r.substr(e.length));if(!t)return{host:"",port:null};const n=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(n);if(s){const i=s[1];return{host:i,port:Tk(n.substr(i.length+1))}}else{const[i,a]=n.split(":");return{host:i,port:Tk(a)}}}function Tk(r){if(!r)return null;const e=Number(r);return isNaN(e)?null:e}function pZ(){function r(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",r):r())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u2{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return $l("not implemented")}_getIdTokenResponse(e){return $l("not implemented")}_linkToIdToken(e,t){return $l("not implemented")}_getReauthenticationResolver(e){return $l("not implemented")}}async function mZ(r,e){return FA(r,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bZ(r,e){return zg(r,"POST","/v1/accounts:signInWithPassword",TA(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yZ(r,e){return zg(r,"POST","/v1/accounts:signInWithEmailLink",TA(r,e))}async function wZ(r,e){return zg(r,"POST","/v1/accounts:signInWithEmailLink",TA(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bg extends u2{constructor(e,t,n,s=null){super("password",n),this._email=e,this._password=t,this._tenantId=s}static _fromEmailAndPassword(e,t){return new Bg(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new Bg(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return O1(e,t,"signInWithPassword",bZ);case"emailLink":return yZ(e,{email:this._email,oobCode:this._password});default:no(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const n={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return O1(e,n,"signUpPassword",mZ);case"emailLink":return wZ(e,{idToken:t,email:this._email,oobCode:this._password});default:no(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Wu(r,e){return zg(r,"POST","/v1/accounts:signInWithIdp",TA(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vZ="http://localhost";class Dd extends u2{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Dd(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):no("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:s,...i}=t;if(!n||!s)return null;const a=new Dd(n,s);return a.idToken=i.idToken||void 0,a.accessToken=i.accessToken||void 0,a.secret=i.secret,a.nonce=i.nonce,a.pendingToken=i.pendingToken||null,a}_getIdTokenResponse(e){const t=this.buildRequest();return Wu(e,t)}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Wu(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Wu(e,t)}buildRequest(){const e={requestUri:vZ,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=$g(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xZ(r){switch(r){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function _Z(r){const e=Bf(Cf(r)).link,t=e?Bf(Cf(e)).deep_link_id:null,n=Bf(Cf(r)).deep_link_id;return(n?Bf(Cf(n)).link:null)||n||t||e||r}class h2{constructor(e){const t=Bf(Cf(e)),n=t.apiKey??null,s=t.oobCode??null,i=xZ(t.mode??null);Kt(n&&s&&i,"argument-error"),this.apiKey=n,this.operation=i,this.code=s,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=_Z(e);try{return new h2(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bh{constructor(){this.providerId=Bh.PROVIDER_ID}static credential(e,t){return Bg._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=h2.parseLink(t);return Kt(n,"argument-error"),Bg._fromEmailAndCode(e,n.code,n.tenantId)}}Bh.PROVIDER_ID="password";Bh.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Bh.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f2{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kg extends f2{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jc extends Kg{constructor(){super("facebook.com")}static credential(e){return Dd._fromParams({providerId:jc.PROVIDER_ID,signInMethod:jc.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return jc.credentialFromTaggedObject(e)}static credentialFromError(e){return jc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return jc.credential(e.oauthAccessToken)}catch{return null}}}jc.FACEBOOK_SIGN_IN_METHOD="facebook.com";jc.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ol extends Kg{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Dd._fromParams({providerId:Ol.PROVIDER_ID,signInMethod:Ol.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ol.credentialFromTaggedObject(e)}static credentialFromError(e){return Ol.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return Ol.credential(t,n)}catch{return null}}}Ol.GOOGLE_SIGN_IN_METHOD="google.com";Ol.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vc extends Kg{constructor(){super("github.com")}static credential(e){return Dd._fromParams({providerId:Vc.PROVIDER_ID,signInMethod:Vc.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Vc.credentialFromTaggedObject(e)}static credentialFromError(e){return Vc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Vc.credential(e.oauthAccessToken)}catch{return null}}}Vc.GITHUB_SIGN_IN_METHOD="github.com";Vc.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $c extends Kg{constructor(){super("twitter.com")}static credential(e,t){return Dd._fromParams({providerId:$c.PROVIDER_ID,signInMethod:$c.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return $c.credentialFromTaggedObject(e)}static credentialFromError(e){return $c.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return $c.credential(t,n)}catch{return null}}}$c.TWITTER_SIGN_IN_METHOD="twitter.com";$c.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BZ(r,e){return zg(r,"POST","/v1/accounts:signUp",TA(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rd{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,s=!1){const i=await fo._fromIdTokenResponse(e,n,s),a=Fk(n);return new Rd({user:i,providerId:a,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const s=Fk(n);return new Rd({user:e,providerId:s,_tokenResponse:n,operationType:t})}}function Fk(r){return r.providerId?r.providerId:"phoneNumber"in r?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lb extends lc{constructor(e,t,n,s){super(t.code,t.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,lb.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,s){return new lb(e,t,n,s)}}function $3(r,e,t,n){return(e==="reauthenticate"?t._getReauthenticationResolver(r):t._getIdTokenResponse(r)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?lb._fromErrorAndOperation(r,i,e,n):i})}async function CZ(r,e,t=!1){const n=await _g(r,e._linkToIdToken(r.auth,await r.getIdToken()),t);return Rd._forOperation(r,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SZ(r,e,t=!1){const{auth:n}=r;if(Ea(n.app))return Promise.reject(Yl(n));const s="reauthenticate";try{const i=await _g(r,$3(n,s,e,r),t);Kt(i.idToken,n,"internal-error");const a=A2(i.idToken);Kt(a,n,"internal-error");const{sub:o}=a;return Kt(r.uid===o,n,"user-mismatch"),Rd._forOperation(r,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&no(n,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function G3(r,e,t=!1){if(Ea(r.app))return Promise.reject(Yl(r));const n="signIn",s=await $3(r,n,e),i=await Rd._fromIdTokenResponse(r,n,s);return t||await r._updateCurrentUser(i.user),i}async function kZ(r,e){return G3(LA(r),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function z3(r){const e=LA(r);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function Lk(r,e,t){if(Ea(r.app))return Promise.reject(Yl(r));const n=LA(r),a=await O1(n,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",BZ).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&z3(r),l}),o=await Rd._fromIdTokenResponse(n,"signIn",a);return await n._updateCurrentUser(o.user),o}function EZ(r,e,t){return Ea(r.app)?Promise.reject(Yl(r)):kZ(fs(r),Bh.credential(e,t)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&z3(r),n})}function IZ(r,e,t,n){return fs(r).onIdTokenChanged(e,t,n)}function TZ(r,e,t){return fs(r).beforeAuthStateChanged(e,t)}function FZ(r,e,t,n){return fs(r).onAuthStateChanged(e,t,n)}function Af(r){return fs(r).signOut()}async function Uk(r){return fs(r).delete()}const cb="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K3{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(cb,"1"),this.storage.removeItem(cb),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LZ=1e3,UZ=10;class q3 extends K3{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=O3(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),s=this.localCache[t];n!==s&&e(t,s,n)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const n=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const a=this.storage.getItem(n);!t&&this.localCache[n]===a||this.notifyListeners(n,a)},i=this.storage.getItem(n);JJ()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,UZ):s()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},LZ)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}q3.type="LOCAL";const MZ=q3;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W3 extends K3{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}W3.type="SESSION";const Y3=W3;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NZ(r){return Promise.all(r.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xb{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const n=new Xb(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:s,data:i}=t.data,a=this.handlersMap[s];if(!(a!=null&&a.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const o=Array.from(a).map(async c=>c(t.origin,i)),l=await NZ(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Xb.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g2(r="",e=10){let t="";for(let n=0;n<e;n++)t+=Math.floor(Math.random()*10);return r+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PZ{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,a;return new Promise((o,l)=>{const c=g2("",20);s.port1.start();const A=setTimeout(()=>{l(new Error("unsupported_event"))},n);a={messageChannel:s,onMessage(d){const h=d;if(h.data.eventId===c)switch(h.data.status){case"ack":clearTimeout(A),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),o(h.data.response);break;default:clearTimeout(A),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(a),s.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[s.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function el(){return window}function DZ(r){el().location.href=r}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X3(){return typeof el().WorkerGlobalScope<"u"&&typeof el().importScripts=="function"}async function RZ(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function OZ(){var r;return((r=navigator==null?void 0:navigator.serviceWorker)==null?void 0:r.controller)||null}function QZ(){return X3()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J3="firebaseLocalStorageDb",HZ=1,Ab="firebaseLocalStorage",Z3="fbase_key";class qg{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Jb(r,e){return r.transaction([Ab],e?"readwrite":"readonly").objectStore(Ab)}function jZ(){const r=indexedDB.deleteDatabase(J3);return new qg(r).toPromise()}function Q1(){const r=indexedDB.open(J3,HZ);return new Promise((e,t)=>{r.addEventListener("error",()=>{t(r.error)}),r.addEventListener("upgradeneeded",()=>{const n=r.result;try{n.createObjectStore(Ab,{keyPath:Z3})}catch(s){t(s)}}),r.addEventListener("success",async()=>{const n=r.result;n.objectStoreNames.contains(Ab)?e(n):(n.close(),await jZ(),e(await Q1()))})})}async function Mk(r,e,t){const n=Jb(r,!0).put({[Z3]:e,value:t});return new qg(n).toPromise()}async function VZ(r,e){const t=Jb(r,!1).get(e),n=await new qg(t).toPromise();return n===void 0?null:n.value}function Nk(r,e){const t=Jb(r,!0).delete(e);return new qg(t).toPromise()}const $Z=800,GZ=3;class eL{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Q1(),this.db)}async _withRetries(e){let t=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(t++>GZ)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return X3()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Xb._getInstance(QZ()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,n;if(this.activeServiceWorker=await RZ(),!this.activeServiceWorker)return;this.sender=new PZ(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(n=e[0])!=null&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||OZ()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Q1();return await Mk(e,cb,"1"),await Nk(e,cb),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>Mk(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(n=>VZ(n,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Nk(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Jb(s,!1).getAll();return new qg(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],n=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),$Z)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}eL.type="LOCAL";const zZ=eL;new Gg(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tL(r,e){return e?Gl(e):(Kt(r._popupRedirectResolver,r,"argument-error"),r._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p2 extends u2{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Wu(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Wu(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Wu(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function KZ(r){return G3(r.auth,new p2(r),r.bypassAuthState)}function qZ(r){const{auth:e,user:t}=r;return Kt(t,e,"internal-error"),SZ(t,new p2(r),r.bypassAuthState)}async function WZ(r){const{auth:e,user:t}=r;return Kt(t,e,"internal-error"),CZ(t,new p2(r),r.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rL{constructor(e,t,n,s,i=!1){this.auth=e,this.resolver=n,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:s,tenantId:i,error:a,type:o}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return KZ;case"linkViaPopup":case"linkViaRedirect":return WZ;case"reauthViaPopup":case"reauthViaRedirect":return qZ;default:no(this.auth,"internal-error")}}resolve(e){nc(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){nc(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YZ=new Gg(2e3,1e4);async function XZ(r,e,t){if(Ea(r.app))return Promise.reject(mo(r,"operation-not-supported-in-this-environment"));const n=LA(r);LJ(r,e,f2);const s=tL(n,t);return new hd(n,"signInViaPopup",e,s).executeNotNull()}class hd extends rL{constructor(e,t,n,s,i){super(e,t,s,i),this.provider=n,this.authWindow=null,this.pollId=null,hd.currentPopupAction&&hd.currentPopupAction.cancel(),hd.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Kt(e,this.auth,"internal-error"),e}async onExecution(){nc(this.filter.length===1,"Popup operations only handle one event");const e=g2();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(mo(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(mo(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,hd.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;if((n=(t=this.authWindow)==null?void 0:t.window)!=null&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(mo(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,YZ.get())};e()}}hd.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JZ="pendingRedirect",fm=new Map;class ZZ extends rL{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=fm.get(this.auth._key());if(!e){try{const n=await eee(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}fm.set(this.auth._key(),e)}return this.bypassAuthState||fm.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function eee(r,e){const t=nee(e),n=ree(r);if(!await n._isAvailable())return!1;const s=await n._get(t)==="true";return await n._remove(t),s}function tee(r,e){fm.set(r._key(),e)}function ree(r){return Gl(r._redirectPersistence)}function nee(r){return hm(JZ,r.config.apiKey,r.name)}async function see(r,e,t=!1){if(Ea(r.app))return Promise.reject(Yl(r));const n=LA(r),s=tL(n,e),a=await new ZZ(n,s,t).execute();return a&&!t&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iee=600*1e3;class aee{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!oee(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!nL(e)){const s=((n=e.error.code)==null?void 0:n.split("auth/")[1])||"internal-error";t.onError(mo(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=iee&&this.cachedEventUids.clear(),this.cachedEventUids.has(Pk(e))}saveEventToCache(e){this.cachedEventUids.add(Pk(e)),this.lastProcessedEventTime=Date.now()}}function Pk(r){return[r.type,r.eventId,r.sessionId,r.tenantId].filter(e=>e).join("-")}function nL({type:r,error:e}){return r==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function oee(r){switch(r.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return nL(r);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lee(r,e={}){return FA(r,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cee=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Aee=/^https?/;async function dee(r){if(r.config.emulator)return;const{authorizedDomains:e}=await lee(r);for(const t of e)try{if(uee(t))return}catch{}no(r,"unauthorized-domain")}function uee(r){const e=D1(),{protocol:t,hostname:n}=new URL(e);if(r.startsWith("chrome-extension://")){const a=new URL(r);return a.hostname===""&&n===""?t==="chrome-extension:"&&r.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===n}if(!Aee.test(t))return!1;if(cee.test(r))return n===r;const s=r.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hee=new Gg(3e4,6e4);function Dk(){const r=el().___jsl;if(r!=null&&r.H){for(const e of Object.keys(r.H))if(r.H[e].r=r.H[e].r||[],r.H[e].L=r.H[e].L||[],r.H[e].r=[...r.H[e].L],r.CP)for(let t=0;t<r.CP.length;t++)r.CP[t]=null}}function fee(r){return new Promise((e,t)=>{var s,i,a;function n(){Dk(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Dk(),t(mo(r,"network-request-failed"))},timeout:hee.get()})}if((i=(s=el().gapi)==null?void 0:s.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((a=el().gapi)!=null&&a.load)n();else{const o=oZ("iframefcb");return el()[o]=()=>{gapi.load?n():t(mo(r,"network-request-failed"))},H3(`${aZ()}?onload=${o}`).catch(l=>t(l))}}).catch(e=>{throw gm=null,e})}let gm=null;function gee(r){return gm=gm||fee(r),gm}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pee=new Gg(5e3,15e3),mee="__/auth/iframe",bee="emulator/auth/iframe",yee={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},wee=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function vee(r){const e=r.config;Kt(e.authDomain,r,"auth-domain-config-required");const t=e.emulator?c2(e,bee):`https://${r.config.authDomain}/${mee}`,n={apiKey:e.apiKey,appName:r.name,v:_h},s=wee.get(r.config.apiHost);s&&(n.eid=s);const i=r._getFrameworks();return i.length&&(n.fw=i.join(",")),`${t}?${$g(n).slice(1)}`}async function xee(r){const e=await gee(r),t=el().gapi;return Kt(t,r,"internal-error"),e.open({where:document.body,url:vee(r),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:yee,dontclear:!0},n=>new Promise(async(s,i)=>{await n.restyle({setHideOnLeave:!1});const a=mo(r,"network-request-failed"),o=el().setTimeout(()=>{i(a)},pee.get());function l(){el().clearTimeout(o),s(n)}n.ping(l).then(l,()=>{i(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _ee={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Bee=500,Cee=600,See="_blank",kee="http://localhost";class Rk{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Eee(r,e,t,n=Bee,s=Cee){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const l={..._ee,width:n.toString(),height:s.toString(),top:i,left:a},c=Ui().toLowerCase();t&&(o=M3(c)?See:t),L3(c)&&(e=e||kee,l.scrollbars="yes");const A=Object.entries(l).reduce((h,[u,p])=>`${h}${u}=${p},`,"");if(XJ(c)&&o!=="_self")return Iee(e||"",o),new Rk(null);const d=window.open(e||"",o,A);Kt(d,r,"popup-blocked");try{d.focus()}catch{}return new Rk(d)}function Iee(r,e){const t=document.createElement("a");t.href=r,t.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tee="__/auth/handler",Fee="emulator/auth/handler",Lee=encodeURIComponent("fac");async function Ok(r,e,t,n,s,i){Kt(r.config.authDomain,r,"auth-domain-config-required"),Kt(r.config.apiKey,r,"invalid-api-key");const a={apiKey:r.config.apiKey,appName:r.name,authType:t,redirectUrl:n,v:_h,eventId:s};if(e instanceof f2){e.setDefaultLanguage(r.languageCode),a.providerId=e.providerId||"",pX(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[A,d]of Object.entries({}))a[A]=d}if(e instanceof Kg){const A=e.getScopes().filter(d=>d!=="");A.length>0&&(a.scopes=A.join(","))}r.tenantId&&(a.tid=r.tenantId);const o=a;for(const A of Object.keys(o))o[A]===void 0&&delete o[A];const l=await r._getAppCheckToken(),c=l?`#${Lee}=${encodeURIComponent(l)}`:"";return`${Uee(r)}?${$g(o).slice(1)}${c}`}function Uee({config:r}){return r.emulator?c2(r,Fee):`https://${r.authDomain}/${Tee}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iv="webStorageSupport";class Mee{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Y3,this._completeRedirectFn=see,this._overrideRedirectResult=tee}async _openPopup(e,t,n,s){var a;nc((a=this.eventManagers[e._key()])==null?void 0:a.manager,"_initialize() not called before _openPopup()");const i=await Ok(e,t,n,D1(),s);return Eee(e,i,g2())}async _openRedirect(e,t,n,s){await this._originValidation(e);const i=await Ok(e,t,n,D1(),s);return DZ(i),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:i}=this.eventManagers[t];return s?Promise.resolve(s):(nc(i,"If manager is not set, promise should be"),i)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await xee(e),n=new aee(e);return t.register("authEvent",s=>(Kt(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:n.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(iv,{type:iv},s=>{var a;const i=(a=s==null?void 0:s[0])==null?void 0:a[iv];i!==void 0&&t(!!i),no(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=dee(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return O3()||U3()||d2()}}const Nee=Mee;var Qk="@firebase/auth",Hk="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pee{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Kt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dee(r){switch(r){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Ree(r){ah(new Pd("auth",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=n.options;Kt(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const l={apiKey:a,authDomain:o,clientPlatform:r,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Q3(r)},c=new nZ(n,s,i,l);return hZ(c,t),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),ah(new Pd("auth-internal",e=>{const t=LA(e.getProvider("auth").getImmediate());return(n=>new Pee(n))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),cA(Qk,Hk,Dee(r)),cA(Qk,Hk,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oee=300,Qee=p3("authIdTokenMaxAge")||Oee;let jk=null;const Hee=r=>async e=>{const t=e&&await e.getIdTokenResult(),n=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>Qee)return;const s=t==null?void 0:t.token;jk!==s&&(jk=s,await fetch(r,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function jee(r=x3()){const e=a2(r,"auth");if(e.isInitialized())return e.getImmediate();const t=uZ(r,{popupRedirectResolver:Nee,persistence:[zZ,MZ,Y3]}),n=p3("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(n,location.origin);if(location.origin===i.origin){const a=Hee(i.toString());TZ(t,a,()=>a(t.currentUser)),IZ(t,o=>a(o))}}const s=f3("auth");return s&&fZ(t,`http://${s}`),t}function Vee(){var r;return((r=document.getElementsByTagName("head"))==null?void 0:r[0])??document}sZ({loadJS(r){return new Promise((e,t)=>{const n=document.createElement("script");n.setAttribute("src",r),n.onload=e,n.onerror=s=>{const i=mo("internal-error");i.customData=s,t(i)},n.type="text/javascript",n.charset="UTF-8",Vee().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Ree("Browser");var Vk=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var AA,sL;(function(){var r;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(E,w){function v(){}v.prototype=w.prototype,E.F=w.prototype,E.prototype=new v,E.prototype.constructor=E,E.D=function(I,k,_){for(var T=Array(arguments.length-2),L=2;L<arguments.length;L++)T[L-2]=arguments[L];return w.prototype[k].apply(I,T)}}function t(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(n,t),n.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(E,w,v){v||(v=0);const I=Array(16);if(typeof w=="string")for(var k=0;k<16;++k)I[k]=w.charCodeAt(v++)|w.charCodeAt(v++)<<8|w.charCodeAt(v++)<<16|w.charCodeAt(v++)<<24;else for(k=0;k<16;++k)I[k]=w[v++]|w[v++]<<8|w[v++]<<16|w[v++]<<24;w=E.g[0],v=E.g[1],k=E.g[2];let _=E.g[3],T;T=w+(_^v&(k^_))+I[0]+3614090360&4294967295,w=v+(T<<7&4294967295|T>>>25),T=_+(k^w&(v^k))+I[1]+3905402710&4294967295,_=w+(T<<12&4294967295|T>>>20),T=k+(v^_&(w^v))+I[2]+606105819&4294967295,k=_+(T<<17&4294967295|T>>>15),T=v+(w^k&(_^w))+I[3]+3250441966&4294967295,v=k+(T<<22&4294967295|T>>>10),T=w+(_^v&(k^_))+I[4]+4118548399&4294967295,w=v+(T<<7&4294967295|T>>>25),T=_+(k^w&(v^k))+I[5]+1200080426&4294967295,_=w+(T<<12&4294967295|T>>>20),T=k+(v^_&(w^v))+I[6]+2821735955&4294967295,k=_+(T<<17&4294967295|T>>>15),T=v+(w^k&(_^w))+I[7]+4249261313&4294967295,v=k+(T<<22&4294967295|T>>>10),T=w+(_^v&(k^_))+I[8]+1770035416&4294967295,w=v+(T<<7&4294967295|T>>>25),T=_+(k^w&(v^k))+I[9]+2336552879&4294967295,_=w+(T<<12&4294967295|T>>>20),T=k+(v^_&(w^v))+I[10]+4294925233&4294967295,k=_+(T<<17&4294967295|T>>>15),T=v+(w^k&(_^w))+I[11]+2304563134&4294967295,v=k+(T<<22&4294967295|T>>>10),T=w+(_^v&(k^_))+I[12]+1804603682&4294967295,w=v+(T<<7&4294967295|T>>>25),T=_+(k^w&(v^k))+I[13]+4254626195&4294967295,_=w+(T<<12&4294967295|T>>>20),T=k+(v^_&(w^v))+I[14]+2792965006&4294967295,k=_+(T<<17&4294967295|T>>>15),T=v+(w^k&(_^w))+I[15]+1236535329&4294967295,v=k+(T<<22&4294967295|T>>>10),T=w+(k^_&(v^k))+I[1]+4129170786&4294967295,w=v+(T<<5&4294967295|T>>>27),T=_+(v^k&(w^v))+I[6]+3225465664&4294967295,_=w+(T<<9&4294967295|T>>>23),T=k+(w^v&(_^w))+I[11]+643717713&4294967295,k=_+(T<<14&4294967295|T>>>18),T=v+(_^w&(k^_))+I[0]+3921069994&4294967295,v=k+(T<<20&4294967295|T>>>12),T=w+(k^_&(v^k))+I[5]+3593408605&4294967295,w=v+(T<<5&4294967295|T>>>27),T=_+(v^k&(w^v))+I[10]+38016083&4294967295,_=w+(T<<9&4294967295|T>>>23),T=k+(w^v&(_^w))+I[15]+3634488961&4294967295,k=_+(T<<14&4294967295|T>>>18),T=v+(_^w&(k^_))+I[4]+3889429448&4294967295,v=k+(T<<20&4294967295|T>>>12),T=w+(k^_&(v^k))+I[9]+568446438&4294967295,w=v+(T<<5&4294967295|T>>>27),T=_+(v^k&(w^v))+I[14]+3275163606&4294967295,_=w+(T<<9&4294967295|T>>>23),T=k+(w^v&(_^w))+I[3]+4107603335&4294967295,k=_+(T<<14&4294967295|T>>>18),T=v+(_^w&(k^_))+I[8]+1163531501&4294967295,v=k+(T<<20&4294967295|T>>>12),T=w+(k^_&(v^k))+I[13]+2850285829&4294967295,w=v+(T<<5&4294967295|T>>>27),T=_+(v^k&(w^v))+I[2]+4243563512&4294967295,_=w+(T<<9&4294967295|T>>>23),T=k+(w^v&(_^w))+I[7]+1735328473&4294967295,k=_+(T<<14&4294967295|T>>>18),T=v+(_^w&(k^_))+I[12]+2368359562&4294967295,v=k+(T<<20&4294967295|T>>>12),T=w+(v^k^_)+I[5]+4294588738&4294967295,w=v+(T<<4&4294967295|T>>>28),T=_+(w^v^k)+I[8]+2272392833&4294967295,_=w+(T<<11&4294967295|T>>>21),T=k+(_^w^v)+I[11]+1839030562&4294967295,k=_+(T<<16&4294967295|T>>>16),T=v+(k^_^w)+I[14]+4259657740&4294967295,v=k+(T<<23&4294967295|T>>>9),T=w+(v^k^_)+I[1]+2763975236&4294967295,w=v+(T<<4&4294967295|T>>>28),T=_+(w^v^k)+I[4]+1272893353&4294967295,_=w+(T<<11&4294967295|T>>>21),T=k+(_^w^v)+I[7]+4139469664&4294967295,k=_+(T<<16&4294967295|T>>>16),T=v+(k^_^w)+I[10]+3200236656&4294967295,v=k+(T<<23&4294967295|T>>>9),T=w+(v^k^_)+I[13]+681279174&4294967295,w=v+(T<<4&4294967295|T>>>28),T=_+(w^v^k)+I[0]+3936430074&4294967295,_=w+(T<<11&4294967295|T>>>21),T=k+(_^w^v)+I[3]+3572445317&4294967295,k=_+(T<<16&4294967295|T>>>16),T=v+(k^_^w)+I[6]+76029189&4294967295,v=k+(T<<23&4294967295|T>>>9),T=w+(v^k^_)+I[9]+3654602809&4294967295,w=v+(T<<4&4294967295|T>>>28),T=_+(w^v^k)+I[12]+3873151461&4294967295,_=w+(T<<11&4294967295|T>>>21),T=k+(_^w^v)+I[15]+530742520&4294967295,k=_+(T<<16&4294967295|T>>>16),T=v+(k^_^w)+I[2]+3299628645&4294967295,v=k+(T<<23&4294967295|T>>>9),T=w+(k^(v|~_))+I[0]+4096336452&4294967295,w=v+(T<<6&4294967295|T>>>26),T=_+(v^(w|~k))+I[7]+1126891415&4294967295,_=w+(T<<10&4294967295|T>>>22),T=k+(w^(_|~v))+I[14]+2878612391&4294967295,k=_+(T<<15&4294967295|T>>>17),T=v+(_^(k|~w))+I[5]+4237533241&4294967295,v=k+(T<<21&4294967295|T>>>11),T=w+(k^(v|~_))+I[12]+1700485571&4294967295,w=v+(T<<6&4294967295|T>>>26),T=_+(v^(w|~k))+I[3]+2399980690&4294967295,_=w+(T<<10&4294967295|T>>>22),T=k+(w^(_|~v))+I[10]+4293915773&4294967295,k=_+(T<<15&4294967295|T>>>17),T=v+(_^(k|~w))+I[1]+2240044497&4294967295,v=k+(T<<21&4294967295|T>>>11),T=w+(k^(v|~_))+I[8]+1873313359&4294967295,w=v+(T<<6&4294967295|T>>>26),T=_+(v^(w|~k))+I[15]+4264355552&4294967295,_=w+(T<<10&4294967295|T>>>22),T=k+(w^(_|~v))+I[6]+2734768916&4294967295,k=_+(T<<15&4294967295|T>>>17),T=v+(_^(k|~w))+I[13]+1309151649&4294967295,v=k+(T<<21&4294967295|T>>>11),T=w+(k^(v|~_))+I[4]+4149444226&4294967295,w=v+(T<<6&4294967295|T>>>26),T=_+(v^(w|~k))+I[11]+3174756917&4294967295,_=w+(T<<10&4294967295|T>>>22),T=k+(w^(_|~v))+I[2]+718787259&4294967295,k=_+(T<<15&4294967295|T>>>17),T=v+(_^(k|~w))+I[9]+3951481745&4294967295,E.g[0]=E.g[0]+w&4294967295,E.g[1]=E.g[1]+(k+(T<<21&4294967295|T>>>11))&4294967295,E.g[2]=E.g[2]+k&4294967295,E.g[3]=E.g[3]+_&4294967295}n.prototype.v=function(E,w){w===void 0&&(w=E.length);const v=w-this.blockSize,I=this.C;let k=this.h,_=0;for(;_<w;){if(k==0)for(;_<=v;)s(this,E,_),_+=this.blockSize;if(typeof E=="string"){for(;_<w;)if(I[k++]=E.charCodeAt(_++),k==this.blockSize){s(this,I),k=0;break}}else for(;_<w;)if(I[k++]=E[_++],k==this.blockSize){s(this,I),k=0;break}}this.h=k,this.o+=w},n.prototype.A=function(){var E=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);E[0]=128;for(var w=1;w<E.length-8;++w)E[w]=0;w=this.o*8;for(var v=E.length-8;v<E.length;++v)E[v]=w&255,w/=256;for(this.v(E),E=Array(16),w=0,v=0;v<4;++v)for(let I=0;I<32;I+=8)E[w++]=this.g[v]>>>I&255;return E};function i(E,w){var v=o;return Object.prototype.hasOwnProperty.call(v,E)?v[E]:v[E]=w(E)}function a(E,w){this.h=w;const v=[];let I=!0;for(let k=E.length-1;k>=0;k--){const _=E[k]|0;I&&_==w||(v[k]=_,I=!1)}this.g=v}var o={};function l(E){return-128<=E&&E<128?i(E,function(w){return new a([w|0],w<0?-1:0)}):new a([E|0],E<0?-1:0)}function c(E){if(isNaN(E)||!isFinite(E))return d;if(E<0)return g(c(-E));const w=[];let v=1;for(let I=0;E>=v;I++)w[I]=E/v|0,v*=4294967296;return new a(w,0)}function A(E,w){if(E.length==0)throw Error("number format error: empty string");if(w=w||10,w<2||36<w)throw Error("radix out of range: "+w);if(E.charAt(0)=="-")return g(A(E.substring(1),w));if(E.indexOf("-")>=0)throw Error('number format error: interior "-" character');const v=c(Math.pow(w,8));let I=d;for(let _=0;_<E.length;_+=8){var k=Math.min(8,E.length-_);const T=parseInt(E.substring(_,_+k),w);k<8?(k=c(Math.pow(w,k)),I=I.j(k).add(c(T))):(I=I.j(v),I=I.add(c(T)))}return I}var d=l(0),h=l(1),u=l(16777216);r=a.prototype,r.m=function(){if(f(this))return-g(this).m();let E=0,w=1;for(let v=0;v<this.g.length;v++){const I=this.i(v);E+=(I>=0?I:4294967296+I)*w,w*=4294967296}return E},r.toString=function(E){if(E=E||10,E<2||36<E)throw Error("radix out of range: "+E);if(p(this))return"0";if(f(this))return"-"+g(this).toString(E);const w=c(Math.pow(E,6));var v=this;let I="";for(;;){const k=B(v,w).g;v=m(v,k.j(w));let _=((v.g.length>0?v.g[0]:v.h)>>>0).toString(E);if(v=k,p(v))return _+I;for(;_.length<6;)_="0"+_;I=_+I}},r.i=function(E){return E<0?0:E<this.g.length?this.g[E]:this.h};function p(E){if(E.h!=0)return!1;for(let w=0;w<E.g.length;w++)if(E.g[w]!=0)return!1;return!0}function f(E){return E.h==-1}r.l=function(E){return E=m(this,E),f(E)?-1:p(E)?0:1};function g(E){const w=E.g.length,v=[];for(let I=0;I<w;I++)v[I]=~E.g[I];return new a(v,~E.h).add(h)}r.abs=function(){return f(this)?g(this):this},r.add=function(E){const w=Math.max(this.g.length,E.g.length),v=[];let I=0;for(let k=0;k<=w;k++){let _=I+(this.i(k)&65535)+(E.i(k)&65535),T=(_>>>16)+(this.i(k)>>>16)+(E.i(k)>>>16);I=T>>>16,_&=65535,T&=65535,v[k]=T<<16|_}return new a(v,v[v.length-1]&-2147483648?-1:0)};function m(E,w){return E.add(g(w))}r.j=function(E){if(p(this)||p(E))return d;if(f(this))return f(E)?g(this).j(g(E)):g(g(this).j(E));if(f(E))return g(this.j(g(E)));if(this.l(u)<0&&E.l(u)<0)return c(this.m()*E.m());const w=this.g.length+E.g.length,v=[];for(var I=0;I<2*w;I++)v[I]=0;for(I=0;I<this.g.length;I++)for(let k=0;k<E.g.length;k++){const _=this.i(I)>>>16,T=this.i(I)&65535,L=E.i(k)>>>16,K=E.i(k)&65535;v[2*I+2*k]+=T*K,x(v,2*I+2*k),v[2*I+2*k+1]+=_*K,x(v,2*I+2*k+1),v[2*I+2*k+1]+=T*L,x(v,2*I+2*k+1),v[2*I+2*k+2]+=_*L,x(v,2*I+2*k+2)}for(E=0;E<w;E++)v[E]=v[2*E+1]<<16|v[2*E];for(E=w;E<2*w;E++)v[E]=0;return new a(v,0)};function x(E,w){for(;(E[w]&65535)!=E[w];)E[w+1]+=E[w]>>>16,E[w]&=65535,w++}function S(E,w){this.g=E,this.h=w}function B(E,w){if(p(w))throw Error("division by zero");if(p(E))return new S(d,d);if(f(E))return w=B(g(E),w),new S(g(w.g),g(w.h));if(f(w))return w=B(E,g(w)),new S(g(w.g),w.h);if(E.g.length>30){if(f(E)||f(w))throw Error("slowDivide_ only works with positive integers.");for(var v=h,I=w;I.l(E)<=0;)v=F(v),I=F(I);var k=N(v,1),_=N(I,1);for(I=N(I,2),v=N(v,2);!p(I);){var T=_.add(I);T.l(E)<=0&&(k=k.add(v),_=T),I=N(I,1),v=N(v,1)}return w=m(E,k.j(w)),new S(k,w)}for(k=d;E.l(w)>=0;){for(v=Math.max(1,Math.floor(E.m()/w.m())),I=Math.ceil(Math.log(v)/Math.LN2),I=I<=48?1:Math.pow(2,I-48),_=c(v),T=_.j(w);f(T)||T.l(E)>0;)v-=I,_=c(v),T=_.j(w);p(_)&&(_=h),k=k.add(_),E=m(E,T)}return new S(k,E)}r.B=function(E){return B(this,E).h},r.and=function(E){const w=Math.max(this.g.length,E.g.length),v=[];for(let I=0;I<w;I++)v[I]=this.i(I)&E.i(I);return new a(v,this.h&E.h)},r.or=function(E){const w=Math.max(this.g.length,E.g.length),v=[];for(let I=0;I<w;I++)v[I]=this.i(I)|E.i(I);return new a(v,this.h|E.h)},r.xor=function(E){const w=Math.max(this.g.length,E.g.length),v=[];for(let I=0;I<w;I++)v[I]=this.i(I)^E.i(I);return new a(v,this.h^E.h)};function F(E){const w=E.g.length+1,v=[];for(let I=0;I<w;I++)v[I]=E.i(I)<<1|E.i(I-1)>>>31;return new a(v,E.h)}function N(E,w){const v=w>>5;w%=32;const I=E.g.length-v,k=[];for(let _=0;_<I;_++)k[_]=w>0?E.i(_+v)>>>w|E.i(_+v+1)<<32-w:E.i(_+v);return new a(k,E.h)}n.prototype.digest=n.prototype.A,n.prototype.reset=n.prototype.u,n.prototype.update=n.prototype.v,sL=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.B,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=c,a.fromString=A,AA=a}).apply(typeof Vk<"u"?Vk:typeof self<"u"?self:typeof window<"u"?window:{});var M0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var iL,Sf,aL,pm,H1,oL,lL,cL;(function(){var r,e=Object.defineProperty;function t(y){y=[typeof globalThis=="object"&&globalThis,y,typeof window=="object"&&window,typeof self=="object"&&self,typeof M0=="object"&&M0];for(var R=0;R<y.length;++R){var j=y[R];if(j&&j.Math==Math)return j}throw Error("Cannot find global object")}var n=t(this);function s(y,R){if(R)e:{var j=n;y=y.split(".");for(var oe=0;oe<y.length-1;oe++){var Le=y[oe];if(!(Le in j))break e;j=j[Le]}y=y[y.length-1],oe=j[y],R=R(oe),R!=oe&&R!=null&&e(j,y,{configurable:!0,writable:!0,value:R})}}s("Symbol.dispose",function(y){return y||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(y){return y||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(y){return y||function(R){var j=[],oe;for(oe in R)Object.prototype.hasOwnProperty.call(R,oe)&&j.push([oe,R[oe]]);return j}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},a=this||self;function o(y){var R=typeof y;return R=="object"&&y!=null||R=="function"}function l(y,R,j){return y.call.apply(y.bind,arguments)}function c(y,R,j){return c=l,c.apply(null,arguments)}function A(y,R){var j=Array.prototype.slice.call(arguments,1);return function(){var oe=j.slice();return oe.push.apply(oe,arguments),y.apply(this,oe)}}function d(y,R){function j(){}j.prototype=R.prototype,y.Z=R.prototype,y.prototype=new j,y.prototype.constructor=y,y.Ob=function(oe,Le,Re){for(var at=Array(arguments.length-2),Jt=2;Jt<arguments.length;Jt++)at[Jt-2]=arguments[Jt];return R.prototype[Le].apply(oe,at)}}var h=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?y=>y&&AsyncContext.Snapshot.wrap(y):y=>y;function u(y){const R=y.length;if(R>0){const j=Array(R);for(let oe=0;oe<R;oe++)j[oe]=y[oe];return j}return[]}function p(y,R){for(let oe=1;oe<arguments.length;oe++){const Le=arguments[oe];var j=typeof Le;if(j=j!="object"?j:Le?Array.isArray(Le)?"array":j:"null",j=="array"||j=="object"&&typeof Le.length=="number"){j=y.length||0;const Re=Le.length||0;y.length=j+Re;for(let at=0;at<Re;at++)y[j+at]=Le[at]}else y.push(Le)}}class f{constructor(R,j){this.i=R,this.j=j,this.h=0,this.g=null}get(){let R;return this.h>0?(this.h--,R=this.g,this.g=R.next,R.next=null):R=this.i(),R}}function g(y){a.setTimeout(()=>{throw y},0)}function m(){var y=E;let R=null;return y.g&&(R=y.g,y.g=y.g.next,y.g||(y.h=null),R.next=null),R}class x{constructor(){this.h=this.g=null}add(R,j){const oe=S.get();oe.set(R,j),this.h?this.h.next=oe:this.g=oe,this.h=oe}}var S=new f(()=>new B,y=>y.reset());class B{constructor(){this.next=this.g=this.h=null}set(R,j){this.h=R,this.g=j,this.next=null}reset(){this.next=this.g=this.h=null}}let F,N=!1,E=new x,w=()=>{const y=Promise.resolve(void 0);F=()=>{y.then(v)}};function v(){for(var y;y=m();){try{y.h.call(y.g)}catch(j){g(j)}var R=S;R.j(y),R.h<100&&(R.h++,y.next=R.g,R.g=y)}N=!1}function I(){this.u=this.u,this.C=this.C}I.prototype.u=!1,I.prototype.dispose=function(){this.u||(this.u=!0,this.N())},I.prototype[Symbol.dispose]=function(){this.dispose()},I.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function k(y,R){this.type=y,this.g=this.target=R,this.defaultPrevented=!1}k.prototype.h=function(){this.defaultPrevented=!0};var _=(function(){if(!a.addEventListener||!Object.defineProperty)return!1;var y=!1,R=Object.defineProperty({},"passive",{get:function(){y=!0}});try{const j=()=>{};a.addEventListener("test",j,R),a.removeEventListener("test",j,R)}catch{}return y})();function T(y){return/^[\s\xa0]*$/.test(y)}function L(y,R){k.call(this,y?y.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,y&&this.init(y,R)}d(L,k),L.prototype.init=function(y,R){const j=this.type=y.type,oe=y.changedTouches&&y.changedTouches.length?y.changedTouches[0]:null;this.target=y.target||y.srcElement,this.g=R,R=y.relatedTarget,R||(j=="mouseover"?R=y.fromElement:j=="mouseout"&&(R=y.toElement)),this.relatedTarget=R,oe?(this.clientX=oe.clientX!==void 0?oe.clientX:oe.pageX,this.clientY=oe.clientY!==void 0?oe.clientY:oe.pageY,this.screenX=oe.screenX||0,this.screenY=oe.screenY||0):(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0),this.button=y.button,this.key=y.key||"",this.ctrlKey=y.ctrlKey,this.altKey=y.altKey,this.shiftKey=y.shiftKey,this.metaKey=y.metaKey,this.pointerId=y.pointerId||0,this.pointerType=y.pointerType,this.state=y.state,this.i=y,y.defaultPrevented&&L.Z.h.call(this)},L.prototype.h=function(){L.Z.h.call(this);const y=this.i;y.preventDefault?y.preventDefault():y.returnValue=!1};var K="closure_listenable_"+(Math.random()*1e6|0),se=0;function X(y,R,j,oe,Le){this.listener=y,this.proxy=null,this.src=R,this.type=j,this.capture=!!oe,this.ha=Le,this.key=++se,this.da=this.fa=!1}function $(y){y.da=!0,y.listener=null,y.proxy=null,y.src=null,y.ha=null}function V(y,R,j){for(const oe in y)R.call(j,y[oe],oe,y)}function he(y,R){for(const j in y)R.call(void 0,y[j],j,y)}function z(y){const R={};for(const j in y)R[j]=y[j];return R}const M="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function O(y,R){let j,oe;for(let Le=1;Le<arguments.length;Le++){oe=arguments[Le];for(j in oe)y[j]=oe[j];for(let Re=0;Re<M.length;Re++)j=M[Re],Object.prototype.hasOwnProperty.call(oe,j)&&(y[j]=oe[j])}}function H(y){this.src=y,this.g={},this.h=0}H.prototype.add=function(y,R,j,oe,Le){const Re=y.toString();y=this.g[Re],y||(y=this.g[Re]=[],this.h++);const at=de(y,R,oe,Le);return at>-1?(R=y[at],j||(R.fa=!1)):(R=new X(R,this.src,Re,!!oe,Le),R.fa=j,y.push(R)),R};function J(y,R){const j=R.type;if(j in y.g){var oe=y.g[j],Le=Array.prototype.indexOf.call(oe,R,void 0),Re;(Re=Le>=0)&&Array.prototype.splice.call(oe,Le,1),Re&&($(R),y.g[j].length==0&&(delete y.g[j],y.h--))}}function de(y,R,j,oe){for(let Le=0;Le<y.length;++Le){const Re=y[Le];if(!Re.da&&Re.listener==R&&Re.capture==!!j&&Re.ha==oe)return Le}return-1}var ie="closure_lm_"+(Math.random()*1e6|0),le={};function fe(y,R,j,oe,Le){if(Array.isArray(R)){for(let Re=0;Re<R.length;Re++)fe(y,R[Re],j,oe,Le);return null}return j=W(j),y&&y[K]?y.J(R,j,o(oe)?!!oe.capture:!1,Le):ve(y,R,j,!1,oe,Le)}function ve(y,R,j,oe,Le,Re){if(!R)throw Error("Invalid event type");const at=o(Le)?!!Le.capture:!!Le;let Jt=ce(y);if(Jt||(y[ie]=Jt=new H(y)),j=Jt.add(R,j,oe,at,Re),j.proxy)return j;if(oe=Ce(),j.proxy=oe,oe.src=y,oe.listener=j,y.addEventListener)_||(Le=at),Le===void 0&&(Le=!1),y.addEventListener(R.toString(),oe,Le);else if(y.attachEvent)y.attachEvent(D(R.toString()),oe);else if(y.addListener&&y.removeListener)y.addListener(oe);else throw Error("addEventListener and attachEvent are unavailable.");return j}function Ce(){function y(j){return R.call(y.src,y.listener,j)}const R=G;return y}function Be(y,R,j,oe,Le){if(Array.isArray(R))for(var Re=0;Re<R.length;Re++)Be(y,R[Re],j,oe,Le);else oe=o(oe)?!!oe.capture:!!oe,j=W(j),y&&y[K]?(y=y.i,Re=String(R).toString(),Re in y.g&&(R=y.g[Re],j=de(R,j,oe,Le),j>-1&&($(R[j]),Array.prototype.splice.call(R,j,1),R.length==0&&(delete y.g[Re],y.h--)))):y&&(y=ce(y))&&(R=y.g[R.toString()],y=-1,R&&(y=de(R,j,oe,Le)),(j=y>-1?R[y]:null)&&Qe(j))}function Qe(y){if(typeof y!="number"&&y&&!y.da){var R=y.src;if(R&&R[K])J(R.i,y);else{var j=y.type,oe=y.proxy;R.removeEventListener?R.removeEventListener(j,oe,y.capture):R.detachEvent?R.detachEvent(D(j),oe):R.addListener&&R.removeListener&&R.removeListener(oe),(j=ce(R))?(J(j,y),j.h==0&&(j.src=null,R[ie]=null)):$(y)}}}function D(y){return y in le?le[y]:le[y]="on"+y}function G(y,R){if(y.da)y=!0;else{R=new L(R,this);const j=y.listener,oe=y.ha||y.src;y.fa&&Qe(y),y=j.call(oe,R)}return y}function ce(y){return y=y[ie],y instanceof H?y:null}var Z="__closure_events_fn_"+(Math.random()*1e9>>>0);function W(y){return typeof y=="function"?y:(y[Z]||(y[Z]=function(R){return y.handleEvent(R)}),y[Z])}function ee(){I.call(this),this.i=new H(this),this.M=this,this.G=null}d(ee,I),ee.prototype[K]=!0,ee.prototype.removeEventListener=function(y,R,j,oe){Be(this,y,R,j,oe)};function ye(y,R){var j,oe=y.G;if(oe)for(j=[];oe;oe=oe.G)j.push(oe);if(y=y.M,oe=R.type||R,typeof R=="string")R=new k(R,y);else if(R instanceof k)R.target=R.target||y;else{var Le=R;R=new k(oe,y),O(R,Le)}Le=!0;let Re,at;if(j)for(at=j.length-1;at>=0;at--)Re=R.g=j[at],Le=xe(Re,oe,!0,R)&&Le;if(Re=R.g=y,Le=xe(Re,oe,!0,R)&&Le,Le=xe(Re,oe,!1,R)&&Le,j)for(at=0;at<j.length;at++)Re=R.g=j[at],Le=xe(Re,oe,!1,R)&&Le}ee.prototype.N=function(){if(ee.Z.N.call(this),this.i){var y=this.i;for(const R in y.g){const j=y.g[R];for(let oe=0;oe<j.length;oe++)$(j[oe]);delete y.g[R],y.h--}}this.G=null},ee.prototype.J=function(y,R,j,oe){return this.i.add(String(y),R,!1,j,oe)},ee.prototype.K=function(y,R,j,oe){return this.i.add(String(y),R,!0,j,oe)};function xe(y,R,j,oe){if(R=y.i.g[String(R)],!R)return!0;R=R.concat();let Le=!0;for(let Re=0;Re<R.length;++Re){const at=R[Re];if(at&&!at.da&&at.capture==j){const Jt=at.listener,cn=at.ha||at.src;at.fa&&J(y.i,at),Le=Jt.call(cn,oe)!==!1&&Le}}return Le&&!oe.defaultPrevented}function we(y,R){if(typeof y!="function")if(y&&typeof y.handleEvent=="function")y=c(y.handleEvent,y);else throw Error("Invalid listener argument");return Number(R)>2147483647?-1:a.setTimeout(y,R||0)}function Ee(y){y.g=we(()=>{y.g=null,y.i&&(y.i=!1,Ee(y))},y.l);const R=y.h;y.h=null,y.m.apply(null,R)}class Ne extends I{constructor(R,j){super(),this.m=R,this.l=j,this.h=null,this.i=!1,this.g=null}j(R){this.h=arguments,this.g?this.i=!0:Ee(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ue(y){I.call(this),this.h=y,this.g={}}d(Ue,I);var je=[];function st(y){V(y.g,function(R,j){this.g.hasOwnProperty(j)&&Qe(R)},y),y.g={}}Ue.prototype.N=function(){Ue.Z.N.call(this),st(this)},Ue.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ze=a.JSON.stringify,ct=a.JSON.parse,wt=class{stringify(y){return a.JSON.stringify(y,void 0)}parse(y){return a.JSON.parse(y,void 0)}};function it(){}function lt(){}var tt={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function rt(){k.call(this,"d")}d(rt,k);function ft(){k.call(this,"c")}d(ft,k);var St={},yt=null;function jt(){return yt=yt||new ee}St.Ia="serverreachability";function Rt(y){k.call(this,St.Ia,y)}d(Rt,k);function wr(y){const R=jt();ye(R,new Rt(R))}St.STAT_EVENT="statevent";function Qr(y,R){k.call(this,St.STAT_EVENT,y),this.stat=R}d(Qr,k);function Lt(y){const R=jt();ye(R,new Qr(R,y))}St.Ja="timingevent";function Ut(y,R){k.call(this,St.Ja,y),this.size=R}d(Ut,k);function mr(y,R){if(typeof y!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){y()},R)}function gs(){this.g=!0}gs.prototype.ua=function(){this.g=!1};function Pn(y,R,j,oe,Le,Re){y.info(function(){if(y.g)if(Re){var at="",Jt=Re.split("&");for(let Sr=0;Sr<Jt.length;Sr++){var cn=Jt[Sr].split("=");if(cn.length>1){const pn=cn[0];cn=cn[1];const js=pn.split("_");at=js.length>=2&&js[1]=="type"?at+(pn+"="+cn+"&"):at+(pn+"=redacted&")}}}else at=null;else at=Re;return"XMLHTTP REQ ("+oe+") [attempt "+Le+"]: "+R+`
`+j+`
`+at})}function hi(y,R,j,oe,Le,Re,at){y.info(function(){return"XMLHTTP RESP ("+oe+") [ attempt "+Le+"]: "+R+`
`+j+`
`+Re+" "+at})}function Bs(y,R,j,oe){y.info(function(){return"XMLHTTP TEXT ("+R+"): "+da(y,j)+(oe?" "+oe:"")})}function Ht(y,R){y.info(function(){return"TIMEOUT: "+R})}gs.prototype.info=function(){};function da(y,R){if(!y.g)return R;if(!R)return null;try{const Re=JSON.parse(R);if(Re){for(y=0;y<Re.length;y++)if(Array.isArray(Re[y])){var j=Re[y];if(!(j.length<2)){var oe=j[1];if(Array.isArray(oe)&&!(oe.length<1)){var Le=oe[0];if(Le!="noop"&&Le!="stop"&&Le!="close")for(let at=1;at<oe.length;at++)oe[at]=""}}}}return Ze(Re)}catch{return R}}var Cs={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Xs={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Js;function Jr(){}d(Jr,it),Jr.prototype.g=function(){return new XMLHttpRequest},Js=new Jr;function sn(y){return encodeURIComponent(String(y))}function Xn(y){var R=1;y=y.split(":");const j=[];for(;R>0&&y.length;)j.push(y.shift()),R--;return y.length&&j.push(y.join(":")),j}function Ss(y,R,j,oe){this.j=y,this.i=R,this.l=j,this.S=oe||1,this.V=new Ue(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new ua}function ua(){this.i=null,this.g="",this.h=!1}var Zs={},ei={};function Ps(y,R,j){y.M=1,y.A=Jn(Cr(R)),y.u=j,y.R=!0,ti(y,null)}function ti(y,R){y.F=Date.now(),Qs(y),y.B=Cr(y.A);var j=y.B,oe=y.S;Array.isArray(oe)||(oe=[String(oe)]),nr(j.i,"t",oe),y.C=0,j=y.j.L,y.h=new ua,y.g=vt(y.j,j?R:null,!y.u),y.P>0&&(y.O=new Ne(c(y.Y,y,y.g),y.P)),R=y.V,j=y.g,oe=y.ba;var Le="readystatechange";Array.isArray(Le)||(Le&&(je[0]=Le.toString()),Le=je);for(let Re=0;Re<Le.length;Re++){const at=fe(j,Le[Re],oe||R.handleEvent,!1,R.h||R);if(!at)break;R.g[at.key]=at}R=y.J?z(y.J):{},y.u?(y.v||(y.v="POST"),R["Content-Type"]="application/x-www-form-urlencoded",y.g.ea(y.B,y.v,y.u,R)):(y.v="GET",y.g.ea(y.B,y.v,null,R)),wr(),Pn(y.i,y.v,y.B,y.l,y.S,y.u)}Ss.prototype.ba=function(y){y=y.target;const R=this.O;R&&Ji(y)==3?R.j():this.Y(y)},Ss.prototype.Y=function(y){try{if(y==this.g)e:{const Jt=Ji(this.g),cn=this.g.ya(),Sr=this.g.ca();if(!(Jt<3)&&(Jt!=3||this.g&&(this.h.h||this.g.la()||mc(this.g)))){this.K||Jt!=4||cn==7||(cn==8||Sr<=0?wr(3):wr(2)),Vi(this);var R=this.g.ca();this.X=R;var j=Ds(this);if(this.o=R==200,hi(this.i,this.v,this.B,this.l,this.S,Jt,R),this.o){if(this.U&&!this.L){t:{if(this.g){var oe,Le=this.g;if((oe=Le.g?Le.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!T(oe)){var Re=oe;break t}}Re=null}if(y=Re)Bs(this.i,this.l,y,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Gi(this,y);else{this.o=!1,this.m=3,Lt(12),ha(this),$i(this);break e}}if(this.R){y=!0;let pn;for(;!this.K&&this.C<j.length;)if(pn=Os(this,j),pn==ei){Jt==4&&(this.m=4,Lt(14),y=!1),Bs(this.i,this.l,null,"[Incomplete Response]");break}else if(pn==Zs){this.m=4,Lt(15),Bs(this.i,this.l,j,"[Invalid Chunk]"),y=!1;break}else Bs(this.i,this.l,pn,null),Gi(this,pn);if(Rs(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Jt!=4||j.length!=0||this.h.h||(this.m=1,Lt(16),y=!1),this.o=this.o&&y,!y)Bs(this.i,this.l,j,"[Invalid Chunked Response]"),ha(this),$i(this);else if(j.length>0&&!this.W){this.W=!0;var at=this.j;at.g==this&&at.aa&&!at.P&&(at.j.info("Great, no buffering proxy detected. Bytes received: "+j.length),yc(at),at.P=!0,Lt(11))}}else Bs(this.i,this.l,j,null),Gi(this,j);Jt==4&&ha(this),this.o&&!this.K&&(Jt==4?ge(this.j,this):(this.o=!1,Qs(this)))}else wl(this.g),R==400&&j.indexOf("Unknown SID")>0?(this.m=3,Lt(12)):(this.m=0,Lt(13)),ha(this),$i(this)}}}catch{}finally{}};function Ds(y){if(!Rs(y))return y.g.la();const R=mc(y.g);if(R==="")return"";let j="";const oe=R.length,Le=Ji(y.g)==4;if(!y.h.i){if(typeof TextDecoder>"u")return ha(y),$i(y),"";y.h.i=new a.TextDecoder}for(let Re=0;Re<oe;Re++)y.h.h=!0,j+=y.h.i.decode(R[Re],{stream:!(Le&&Re==oe-1)});return R.length=0,y.h.g+=j,y.C=0,y.h.g}function Rs(y){return y.g?y.v=="GET"&&y.M!=2&&y.j.Aa:!1}function Os(y,R){var j=y.C,oe=R.indexOf(`
`,j);return oe==-1?ei:(j=Number(R.substring(j,oe)),isNaN(j)?Zs:(oe+=1,oe+j>R.length?ei:(R=R.slice(oe,oe+j),y.C=oe+j,R)))}Ss.prototype.cancel=function(){this.K=!0,ha(this)};function Qs(y){y.T=Date.now()+y.H,ji(y,y.H)}function ji(y,R){if(y.D!=null)throw Error("WatchDog timer not null");y.D=mr(c(y.aa,y),R)}function Vi(y){y.D&&(a.clearTimeout(y.D),y.D=null)}Ss.prototype.aa=function(){this.D=null;const y=Date.now();y-this.T>=0?(Ht(this.i,this.B),this.M!=2&&(wr(),Lt(17)),ha(this),this.m=2,$i(this)):ji(this,this.T-y)};function $i(y){y.j.I==0||y.K||ge(y.j,y)}function ha(y){Vi(y);var R=y.O;R&&typeof R.dispose=="function"&&R.dispose(),y.O=null,st(y.V),y.g&&(R=y.g,y.g=null,R.abort(),R.dispose())}function Gi(y,R){try{var j=y.j;if(j.I!=0&&(j.g==y||Ki(j.h,y))){if(!y.L&&Ki(j.h,y)&&j.I==3){try{var oe=j.Ba.g.parse(R)}catch{oe=null}if(Array.isArray(oe)&&oe.length==3){var Le=oe;if(Le[0]==0){e:if(!j.v){if(j.g)if(j.g.F+3e3<y.F)q(j),Uo(j);else break e;so(j),Lt(18)}}else j.xa=Le[1],0<j.xa-j.K&&Le[2]<37500&&j.F&&j.A==0&&!j.C&&(j.C=mr(c(j.Va,j),6e3));Hs(j.h)<=1&&j.ta&&(j.ta=void 0)}else Te(j,11)}else if((y.L||j.g==y)&&q(j),!T(R))for(Le=j.Ba.g.parse(R),R=0;R<Le.length;R++){let Sr=Le[R];const pn=Sr[0];if(!(pn<=j.K))if(j.K=pn,Sr=Sr[1],j.I==2)if(Sr[0]=="c"){j.M=Sr[1],j.ba=Sr[2];const js=Sr[3];js!=null&&(j.ka=js,j.j.info("VER="+j.ka));const Pi=Sr[4];Pi!=null&&(j.za=Pi,j.j.info("SVER="+j.za));const _n=Sr[5];_n!=null&&typeof _n=="number"&&_n>0&&(oe=1.5*_n,j.O=oe,j.j.info("backChannelRequestTimeoutMs_="+oe)),oe=j;const gi=y.g;if(gi){const Ra=gi.g?gi.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ra){var Re=oe.h;Re.g||Ra.indexOf("spdy")==-1&&Ra.indexOf("quic")==-1&&Ra.indexOf("h2")==-1||(Re.j=Re.l,Re.g=new Set,Re.h&&(ps(Re,Re.h),Re.h=null))}if(oe.G){const xl=gi.g?gi.g.getResponseHeader("X-HTTP-Session-Id"):null;xl&&(oe.wa=xl,_r(oe.J,oe.G,xl))}}j.I=3,j.l&&j.l.ra(),j.aa&&(j.T=Date.now()-y.F,j.j.info("Handshake RTT: "+j.T+"ms")),oe=j;var at=y;if(oe.na=Ye(oe,oe.L?oe.ba:null,oe.W),at.L){ri(oe.h,at);var Jt=at,cn=oe.O;cn&&(Jt.H=cn),Jt.D&&(Vi(Jt),Qs(Jt)),oe.g=at}else $A(oe);j.i.length>0&&vl(j)}else Sr[0]!="stop"&&Sr[0]!="close"||Te(j,7);else j.I==3&&(Sr[0]=="stop"||Sr[0]=="close"?Sr[0]=="stop"?Te(j,7):Lo(j):Sr[0]!="noop"&&j.l&&j.l.qa(Sr),j.A=0)}}wr(4)}catch{}}var ks=class{constructor(y,R){this.g=y,this.map=R}};function zi(y){this.l=y||10,a.PerformanceNavigationTiming?(y=a.performance.getEntriesByType("navigation"),y=y.length>0&&(y[0].nextHopProtocol=="hq"||y[0].nextHopProtocol=="h2")):y=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=y?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Fn(y){return y.h?!0:y.g?y.g.size>=y.j:!1}function Hs(y){return y.h?1:y.g?y.g.size:0}function Ki(y,R){return y.h?y.h==R:y.g?y.g.has(R):!1}function ps(y,R){y.g?y.g.add(R):y.h=R}function ri(y,R){y.h&&y.h==R?y.h=null:y.g&&y.g.has(R)&&y.g.delete(R)}zi.prototype.cancel=function(){if(this.i=ko(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const y of this.g.values())y.cancel();this.g.clear()}};function ko(y){if(y.h!=null)return y.i.concat(y.h.G);if(y.g!=null&&y.g.size!==0){let R=y.i;for(const j of y.g.values())R=R.concat(j.G);return R}return u(y.i)}var Eo=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function fa(y,R){if(y){y=y.split("&");for(let j=0;j<y.length;j++){const oe=y[j].indexOf("=");let Le,Re=null;oe>=0?(Le=y[j].substring(0,oe),Re=y[j].substring(oe+1)):Le=y[j],R(Le,Re?decodeURIComponent(Re.replace(/\+/g," ")):"")}}}function Ln(y){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let R;y instanceof Ln?(this.l=y.l,qi(this,y.j),this.o=y.o,this.g=y.g,Wi(this,y.u),this.h=y.h,ni(this,on(y.i)),this.m=y.m):y&&(R=String(y).match(Eo))?(this.l=!1,qi(this,R[1]||"",!0),this.o=Qn(R[2]||""),this.g=Qn(R[3]||"",!0),Wi(this,R[4]),this.h=Qn(R[5]||"",!0),ni(this,R[6]||"",!0),this.m=Qn(R[7]||"")):(this.l=!1,this.i=new Ae(null,this.l))}Ln.prototype.toString=function(){const y=[];var R=this.j;R&&y.push(Zr(R,To,!0),":");var j=this.g;return(j||R=="file")&&(y.push("//"),(R=this.o)&&y.push(Zr(R,To,!0),"@"),y.push(sn(j).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),j=this.u,j!=null&&y.push(":",String(j))),(j=this.h)&&(this.g&&j.charAt(0)!="/"&&y.push("/"),y.push(Zr(j,j.charAt(0)=="/"?OA:hc,!0))),(j=this.i.toString())&&y.push("?",j),(j=this.m)&&y.push("#",Zr(j,re)),y.join("")},Ln.prototype.resolve=function(y){const R=Cr(this);let j=!!y.j;j?qi(R,y.j):j=!!y.o,j?R.o=y.o:j=!!y.g,j?R.g=y.g:j=y.u!=null;var oe=y.h;if(j)Wi(R,y.u);else if(j=!!y.h){if(oe.charAt(0)!="/")if(this.g&&!this.h)oe="/"+oe;else{var Le=R.h.lastIndexOf("/");Le!=-1&&(oe=R.h.slice(0,Le+1)+oe)}if(Le=oe,Le==".."||Le==".")oe="";else if(Le.indexOf("./")!=-1||Le.indexOf("/.")!=-1){oe=Le.lastIndexOf("/",0)==0,Le=Le.split("/");const Re=[];for(let at=0;at<Le.length;){const Jt=Le[at++];Jt=="."?oe&&at==Le.length&&Re.push(""):Jt==".."?((Re.length>1||Re.length==1&&Re[0]!="")&&Re.pop(),oe&&at==Le.length&&Re.push("")):(Re.push(Jt),oe=!0)}oe=Re.join("/")}else oe=Le}return j?R.h=oe:j=y.i.toString()!=="",j?ni(R,on(y.i)):j=!!y.m,j&&(R.m=y.m),R};function Cr(y){return new Ln(y)}function qi(y,R,j){y.j=j?Qn(R,!0):R,y.j&&(y.j=y.j.replace(/:$/,""))}function Wi(y,R){if(R){if(R=Number(R),isNaN(R)||R<0)throw Error("Bad port number "+R);y.u=R}else y.u=null}function ni(y,R,j){R instanceof Ae?(y.i=R,hn(y.i,y.l)):(j||(R=Zr(R,Yi)),y.i=new Ae(R,y.l))}function _r(y,R,j){y.i.set(R,j)}function Jn(y){return _r(y,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),y}function Qn(y,R){return y?R?decodeURI(y.replace(/%25/g,"%2525")):decodeURIComponent(y):""}function Zr(y,R,j){return typeof y=="string"?(y=encodeURI(y).replace(R,Io),j&&(y=y.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y):null}function Io(y){return y=y.charCodeAt(0),"%"+(y>>4&15).toString(16)+(y&15).toString(16)}var To=/[#\/\?@]/g,hc=/[#\?:]/g,OA=/[#\?]/g,Yi=/[#\?@]/g,re=/#/g;function Ae(y,R){this.h=this.g=null,this.i=y||null,this.j=!!R}function be(y){y.g||(y.g=new Map,y.h=0,y.i&&fa(y.i,function(R,j){y.add(decodeURIComponent(R.replace(/\+/g," ")),j)}))}r=Ae.prototype,r.add=function(y,R){be(this),this.i=null,y=Hr(this,y);let j=this.g.get(y);return j||this.g.set(y,j=[]),j.push(R),this.h+=1,this};function Oe(y,R){be(y),R=Hr(y,R),y.g.has(R)&&(y.i=null,y.h-=y.g.get(R).length,y.g.delete(R))}function Je(y,R){return be(y),R=Hr(y,R),y.g.has(R)}r.forEach=function(y,R){be(this),this.g.forEach(function(j,oe){j.forEach(function(Le){y.call(R,Le,oe,this)},this)},this)};function ht(y,R){be(y);let j=[];if(typeof R=="string")Je(y,R)&&(j=j.concat(y.g.get(Hr(y,R))));else for(y=Array.from(y.g.values()),R=0;R<y.length;R++)j=j.concat(y[R]);return j}r.set=function(y,R){return be(this),this.i=null,y=Hr(this,y),Je(this,y)&&(this.h-=this.g.get(y).length),this.g.set(y,[R]),this.h+=1,this},r.get=function(y,R){return y?(y=ht(this,y),y.length>0?String(y[0]):R):R};function nr(y,R,j){Oe(y,R),j.length>0&&(y.i=null,y.g.set(Hr(y,R),u(j)),y.h+=j.length)}r.toString=function(){if(this.i)return this.i;if(!this.g)return"";const y=[],R=Array.from(this.g.keys());for(let oe=0;oe<R.length;oe++){var j=R[oe];const Le=sn(j);j=ht(this,j);for(let Re=0;Re<j.length;Re++){let at=Le;j[Re]!==""&&(at+="="+sn(j[Re])),y.push(at)}}return this.i=y.join("&")};function on(y){const R=new Ae;return R.i=y.i,y.g&&(R.g=new Map(y.g),R.h=y.h),R}function Hr(y,R){return R=String(R),y.j&&(R=R.toLowerCase()),R}function hn(y,R){R&&!y.j&&(be(y),y.i=null,y.g.forEach(function(j,oe){const Le=oe.toLowerCase();oe!=Le&&(Oe(this,oe),nr(this,Le,j))},y)),y.j=R}function fi(y,R){const j=new gs;if(a.Image){const oe=new Image;oe.onload=A(Xi,j,"TestLoadImage: loaded",!0,R,oe),oe.onerror=A(Xi,j,"TestLoadImage: error",!1,R,oe),oe.onabort=A(Xi,j,"TestLoadImage: abort",!1,R,oe),oe.ontimeout=A(Xi,j,"TestLoadImage: timeout",!1,R,oe),a.setTimeout(function(){oe.ontimeout&&oe.ontimeout()},1e4),oe.src=y}else R(!1)}function pl(y,R){const j=new gs,oe=new AbortController,Le=setTimeout(()=>{oe.abort(),Xi(j,"TestPingServer: timeout",!1,R)},1e4);fetch(y,{signal:oe.signal}).then(Re=>{clearTimeout(Le),Re.ok?Xi(j,"TestPingServer: ok",!0,R):Xi(j,"TestPingServer: server error",!1,R)}).catch(()=>{clearTimeout(Le),Xi(j,"TestPingServer: error",!1,R)})}function Xi(y,R,j,oe,Le){try{Le&&(Le.onload=null,Le.onerror=null,Le.onabort=null,Le.ontimeout=null),oe(j)}catch{}}function Xt(){this.g=new wt}function QA(y){this.i=y.Sb||null,this.h=y.ab||!1}d(QA,it),QA.prototype.g=function(){return new fc(this.i,this.h)};function fc(y,R){ee.call(this),this.H=y,this.o=R,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}d(fc,ee),r=fc.prototype,r.open=function(y,R){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=y,this.D=R,this.readyState=1,Mi(this)},r.send=function(y){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const R={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};y&&(R.body=y),(this.H||a).fetch(new Request(this.D,R)).then(this.Pa.bind(this),this.ga.bind(this))},r.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,ml(this)),this.readyState=0},r.Pa=function(y){if(this.g&&(this.l=y,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=y.headers,this.readyState=2,Mi(this)),this.g&&(this.readyState=3,Mi(this),this.g)))if(this.responseType==="arraybuffer")y.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in y){if(this.j=y.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;su(this)}else y.text().then(this.Oa.bind(this),this.ga.bind(this))};function su(y){y.j.read().then(y.Ma.bind(y)).catch(y.ga.bind(y))}r.Ma=function(y){if(this.g){if(this.o&&y.value)this.response.push(y.value);else if(!this.o){var R=y.value?y.value:new Uint8Array(0);(R=this.B.decode(R,{stream:!y.done}))&&(this.response=this.responseText+=R)}y.done?ml(this):Mi(this),this.readyState==3&&su(this)}},r.Oa=function(y){this.g&&(this.response=this.responseText=y,ml(this))},r.Na=function(y){this.g&&(this.response=y,ml(this))},r.ga=function(){this.g&&ml(this)};function ml(y){y.readyState=4,y.l=null,y.j=null,y.B=null,Mi(y)}r.setRequestHeader=function(y,R){this.A.append(y,R)},r.getResponseHeader=function(y){return this.h&&this.h.get(y.toLowerCase())||""},r.getAllResponseHeaders=function(){if(!this.h)return"";const y=[],R=this.h.entries();for(var j=R.next();!j.done;)j=j.value,y.push(j[0]+": "+j[1]),j=R.next();return y.join(`\r
`)};function Mi(y){y.onreadystatechange&&y.onreadystatechange.call(y)}Object.defineProperty(fc.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(y){this.m=y?"include":"same-origin"}});function Pa(y){let R="";return V(y,function(j,oe){R+=oe,R+=":",R+=j,R+=`\r
`}),R}function HA(y,R,j){e:{for(oe in j){var oe=!1;break e}oe=!0}oe||(j=Pa(j),typeof y=="string"?j!=null&&sn(j):_r(y,R,j))}function fn(y){ee.call(this),this.headers=new Map,this.L=y||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}d(fn,ee);var gc=/^https?$/i,jA=["POST","PUT"];r=fn.prototype,r.Fa=function(y){this.H=y},r.ea=function(y,R,j,oe){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+y);R=R?R.toUpperCase():"GET",this.D=y,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Js.g(),this.g.onreadystatechange=h(c(this.Ca,this));try{this.B=!0,this.g.open(R,String(y),!0),this.B=!1}catch(Re){Fo(this,Re);return}if(y=j||"",j=new Map(this.headers),oe)if(Object.getPrototypeOf(oe)===Object.prototype)for(var Le in oe)j.set(Le,oe[Le]);else if(typeof oe.keys=="function"&&typeof oe.get=="function")for(const Re of oe.keys())j.set(Re,oe.get(Re));else throw Error("Unknown input type for opt_headers: "+String(oe));oe=Array.from(j.keys()).find(Re=>Re.toLowerCase()=="content-type"),Le=a.FormData&&y instanceof a.FormData,!(Array.prototype.indexOf.call(jA,R,void 0)>=0)||oe||Le||j.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Re,at]of j)this.g.setRequestHeader(Re,at);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(y),this.v=!1}catch(Re){Fo(this,Re)}};function Fo(y,R){y.h=!1,y.g&&(y.j=!0,y.g.abort(),y.j=!1),y.l=R,y.o=5,bl(y),pc(y)}function bl(y){y.A||(y.A=!0,ye(y,"complete"),ye(y,"error"))}r.abort=function(y){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=y||7,ye(this,"complete"),ye(this,"abort"),pc(this))},r.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),pc(this,!0)),fn.Z.N.call(this)},r.Ca=function(){this.u||(this.B||this.v||this.j?yl(this):this.Xa())},r.Xa=function(){yl(this)};function yl(y){if(y.h&&typeof i<"u"){if(y.v&&Ji(y)==4)setTimeout(y.Ca.bind(y),0);else if(ye(y,"readystatechange"),Ji(y)==4){y.h=!1;try{const Re=y.ca();e:switch(Re){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var R=!0;break e;default:R=!1}var j;if(!(j=R)){var oe;if(oe=Re===0){let at=String(y.D).match(Eo)[1]||null;!at&&a.self&&a.self.location&&(at=a.self.location.protocol.slice(0,-1)),oe=!gc.test(at?at.toLowerCase():"")}j=oe}if(j)ye(y,"complete"),ye(y,"success");else{y.o=6;try{var Le=Ji(y)>2?y.g.statusText:""}catch{Le=""}y.l=Le+" ["+y.ca()+"]",bl(y)}}finally{pc(y)}}}}function pc(y,R){if(y.g){y.m&&(clearTimeout(y.m),y.m=null);const j=y.g;y.g=null,R||ye(y,"ready");try{j.onreadystatechange=null}catch{}}}r.isActive=function(){return!!this.g};function Ji(y){return y.g?y.g.readyState:0}r.ca=function(){try{return Ji(this)>2?this.g.status:-1}catch{return-1}},r.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},r.La=function(y){if(this.g){var R=this.g.responseText;return y&&R.indexOf(y)==0&&(R=R.substring(y.length)),ct(R)}};function mc(y){try{if(!y.g)return null;if("response"in y.g)return y.g.response;switch(y.F){case"":case"text":return y.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in y.g)return y.g.mozResponseArrayBuffer}return null}catch{return null}}function wl(y){const R={};y=(y.g&&Ji(y)>=2&&y.g.getAllResponseHeaders()||"").split(`\r
`);for(let oe=0;oe<y.length;oe++){if(T(y[oe]))continue;var j=Xn(y[oe]);const Le=j[0];if(j=j[1],typeof j!="string")continue;j=j.trim();const Re=R[Le]||[];R[Le]=Re,Re.push(j)}he(R,function(oe){return oe.join(", ")})}r.ya=function(){return this.o},r.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function ga(y,R,j){return j&&j.internalChannelParams&&j.internalChannelParams[y]||R}function bc(y){this.za=0,this.i=[],this.j=new gs,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=ga("failFast",!1,y),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=ga("baseRetryDelayMs",5e3,y),this.Za=ga("retryDelaySeedMs",1e4,y),this.Ta=ga("forwardChannelMaxRetries",2,y),this.va=ga("forwardChannelRequestTimeoutMs",2e4,y),this.ma=y&&y.xmlHttpFactory||void 0,this.Ua=y&&y.Rb||void 0,this.Aa=y&&y.useFetchStreams||!1,this.O=void 0,this.L=y&&y.supportsCrossDomainXhr||!1,this.M="",this.h=new zi(y&&y.concurrentRequestLimit),this.Ba=new Xt,this.S=y&&y.fastHandshake||!1,this.R=y&&y.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=y&&y.Pb||!1,y&&y.ua&&this.j.ua(),y&&y.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&y&&y.detectBufferingProxy||!1,this.ia=void 0,y&&y.longPollingTimeout&&y.longPollingTimeout>0&&(this.ia=y.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}r=bc.prototype,r.ka=8,r.I=1,r.connect=function(y,R,j,oe){Lt(0),this.W=y,this.H=R||{},j&&oe!==void 0&&(this.H.OSID=j,this.H.OAID=oe),this.F=this.X,this.J=Ye(this,null,this.W),vl(this)};function Lo(y){if(Mo(y),y.I==3){var R=y.V++,j=Cr(y.J);if(_r(j,"SID",y.M),_r(j,"RID",R),_r(j,"TYPE","terminate"),Ni(y,j),R=new Ss(y,y.j,R),R.M=2,R.A=Jn(Cr(j)),j=!1,a.navigator&&a.navigator.sendBeacon)try{j=a.navigator.sendBeacon(R.A.toString(),"")}catch{}!j&&a.Image&&(new Image().src=R.A,j=!0),j||(R.g=vt(R.j,null),R.g.ea(R.A)),R.F=Date.now(),Qs(R)}$e(y)}function Uo(y){y.g&&(yc(y),y.g.cancel(),y.g=null)}function Mo(y){Uo(y),y.v&&(a.clearTimeout(y.v),y.v=null),q(y),y.h.cancel(),y.m&&(typeof y.m=="number"&&a.clearTimeout(y.m),y.m=null)}function vl(y){if(!Fn(y.h)&&!y.m){y.m=!0;var R=y.Ea;F||w(),N||(F(),N=!0),E.add(R,y),y.D=0}}function iu(y,R){return Hs(y.h)>=y.h.j-(y.m?1:0)?!1:y.m?(y.i=R.G.concat(y.i),!0):y.I==1||y.I==2||y.D>=(y.Sa?0:y.Ta)?!1:(y.m=mr(c(y.Ea,y,R),_e(y,y.D)),y.D++,!0)}r.Ea=function(y){if(this.m)if(this.m=null,this.I==1){if(!y){this.V=Math.floor(Math.random()*1e5),y=this.V++;const Le=new Ss(this,this.j,y);let Re=this.o;if(this.U&&(Re?(Re=z(Re),O(Re,this.U)):Re=this.U),this.u!==null||this.R||(Le.J=Re,Re=null),this.S)e:{for(var R=0,j=0;j<this.i.length;j++){t:{var oe=this.i[j];if("__data__"in oe.map&&(oe=oe.map.__data__,typeof oe=="string")){oe=oe.length;break t}oe=void 0}if(oe===void 0)break;if(R+=oe,R>4096){R=j;break e}if(R===4096||j===this.i.length-1){R=j+1;break e}}R=1e3}else R=1e3;R=VA(this,Le,R),j=Cr(this.J),_r(j,"RID",y),_r(j,"CVER",22),this.G&&_r(j,"X-HTTP-Session-Id",this.G),Ni(this,j),Re&&(this.R?R="headers="+sn(Pa(Re))+"&"+R:this.u&&HA(j,this.u,Re)),ps(this.h,Le),this.Ra&&_r(j,"TYPE","init"),this.S?(_r(j,"$req",R),_r(j,"SID","null"),Le.U=!0,Ps(Le,j,null)):Ps(Le,j,R),this.I=2}}else this.I==3&&(y?Da(this,y):this.i.length==0||Fn(this.h)||Da(this))};function Da(y,R){var j;R?j=R.l:j=y.V++;const oe=Cr(y.J);_r(oe,"SID",y.M),_r(oe,"RID",j),_r(oe,"AID",y.K),Ni(y,oe),y.u&&y.o&&HA(oe,y.u,y.o),j=new Ss(y,y.j,j,y.D+1),y.u===null&&(j.J=y.o),R&&(y.i=R.G.concat(y.i)),R=VA(y,j,1e3),j.H=Math.round(y.va*.5)+Math.round(y.va*.5*Math.random()),ps(y.h,j),Ps(j,oe,R)}function Ni(y,R){y.H&&V(y.H,function(j,oe){_r(R,oe,j)}),y.l&&V({},function(j,oe){_r(R,oe,j)})}function VA(y,R,j){j=Math.min(y.i.length,j);const oe=y.l?c(y.l.Ka,y.l,y):null;e:{var Le=y.i;let Jt=-1;for(;;){const cn=["count="+j];Jt==-1?j>0?(Jt=Le[0].g,cn.push("ofs="+Jt)):Jt=0:cn.push("ofs="+Jt);let Sr=!0;for(let pn=0;pn<j;pn++){var Re=Le[pn].g;const js=Le[pn].map;if(Re-=Jt,Re<0)Jt=Math.max(0,Le[pn].g-100),Sr=!1;else try{Re="req"+Re+"_"||"";try{var at=js instanceof Map?js:Object.entries(js);for(const[Pi,_n]of at){let gi=_n;o(_n)&&(gi=Ze(_n)),cn.push(Re+Pi+"="+encodeURIComponent(gi))}}catch(Pi){throw cn.push(Re+"type="+encodeURIComponent("_badmap")),Pi}}catch{oe&&oe(js)}}if(Sr){at=cn.join("&");break e}}at=void 0}return y=y.i.splice(0,j),R.G=y,at}function $A(y){if(!y.g&&!y.v){y.Y=1;var R=y.Da;F||w(),N||(F(),N=!0),E.add(R,y),y.A=0}}function so(y){return y.g||y.v||y.A>=3?!1:(y.Y++,y.v=mr(c(y.Da,y),_e(y,y.A)),y.A++,!0)}r.Da=function(){if(this.v=null,U(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var y=4*this.T;this.j.info("BP detection timer enabled: "+y),this.B=mr(c(this.Wa,this),y)}},r.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Lt(10),Uo(this),U(this))};function yc(y){y.B!=null&&(a.clearTimeout(y.B),y.B=null)}function U(y){y.g=new Ss(y,y.j,"rpc",y.Y),y.u===null&&(y.g.J=y.o),y.g.P=0;var R=Cr(y.na);_r(R,"RID","rpc"),_r(R,"SID",y.M),_r(R,"AID",y.K),_r(R,"CI",y.F?"0":"1"),!y.F&&y.ia&&_r(R,"TO",y.ia),_r(R,"TYPE","xmlhttp"),Ni(y,R),y.u&&y.o&&HA(R,y.u,y.o),y.O&&(y.g.H=y.O);var j=y.g;y=y.ba,j.M=1,j.A=Jn(Cr(R)),j.u=null,j.R=!0,ti(j,y)}r.Va=function(){this.C!=null&&(this.C=null,Uo(this),so(this),Lt(19))};function q(y){y.C!=null&&(a.clearTimeout(y.C),y.C=null)}function ge(y,R){var j=null;if(y.g==R){q(y),yc(y),y.g=null;var oe=2}else if(Ki(y.h,R))j=R.G,ri(y.h,R),oe=1;else return;if(y.I!=0){if(R.o)if(oe==1){j=R.u?R.u.length:0,R=Date.now()-R.F;var Le=y.D;oe=jt(),ye(oe,new Ut(oe,j)),vl(y)}else $A(y);else if(Le=R.m,Le==3||Le==0&&R.X>0||!(oe==1&&iu(y,R)||oe==2&&so(y)))switch(j&&j.length>0&&(R=y.h,R.i=R.i.concat(j)),Le){case 1:Te(y,5);break;case 4:Te(y,10);break;case 3:Te(y,6);break;default:Te(y,2)}}}function _e(y,R){let j=y.Qa+Math.floor(Math.random()*y.Za);return y.isActive()||(j*=2),j*R}function Te(y,R){if(y.j.info("Error code "+R),R==2){var j=c(y.bb,y),oe=y.Ua;const Le=!oe;oe=new Ln(oe||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||qi(oe,"https"),Jn(oe),Le?fi(oe.toString(),j):pl(oe.toString(),j)}else Lt(2);y.I=0,y.l&&y.l.pa(R),$e(y),Mo(y)}r.bb=function(y){y?(this.j.info("Successfully pinged google.com"),Lt(2)):(this.j.info("Failed to ping google.com"),Lt(1))};function $e(y){if(y.I=0,y.ja=[],y.l){const R=ko(y.h);(R.length!=0||y.i.length!=0)&&(p(y.ja,R),p(y.ja,y.i),y.h.i.length=0,u(y.i),y.i.length=0),y.l.oa()}}function Ye(y,R,j){var oe=j instanceof Ln?Cr(j):new Ln(j);if(oe.g!="")R&&(oe.g=R+"."+oe.g),Wi(oe,oe.u);else{var Le=a.location;oe=Le.protocol,R=R?R+"."+Le.hostname:Le.hostname,Le=+Le.port;const Re=new Ln(null);oe&&qi(Re,oe),R&&(Re.g=R),Le&&Wi(Re,Le),j&&(Re.h=j),oe=Re}return j=y.G,R=y.wa,j&&R&&_r(oe,j,R),_r(oe,"VER",y.ka),Ni(y,oe),oe}function vt(y,R,j){if(R&&!y.L)throw Error("Can't create secondary domain capable XhrIo object.");return R=y.Aa&&!y.ma?new fn(new QA({ab:j})):new fn(y.ma),R.Fa(y.L),R}r.isActive=function(){return!!this.l&&this.l.isActive(this)};function Et(){}r=Et.prototype,r.ra=function(){},r.qa=function(){},r.pa=function(){},r.oa=function(){},r.isActive=function(){return!0},r.Ka=function(){};function $t(){}$t.prototype.g=function(y,R){return new Mt(y,R)};function Mt(y,R){ee.call(this),this.g=new bc(R),this.l=y,this.h=R&&R.messageUrlParams||null,y=R&&R.messageHeaders||null,R&&R.clientProtocolHeaderRequired&&(y?y["X-Client-Protocol"]="webchannel":y={"X-Client-Protocol":"webchannel"}),this.g.o=y,y=R&&R.initMessageHeaders||null,R&&R.messageContentType&&(y?y["X-WebChannel-Content-Type"]=R.messageContentType:y={"X-WebChannel-Content-Type":R.messageContentType}),R&&R.sa&&(y?y["X-WebChannel-Client-Profile"]=R.sa:y={"X-WebChannel-Client-Profile":R.sa}),this.g.U=y,(y=R&&R.Qb)&&!T(y)&&(this.g.u=y),this.A=R&&R.supportsCrossDomainXhr||!1,this.v=R&&R.sendRawJson||!1,(R=R&&R.httpSessionIdParam)&&!T(R)&&(this.g.G=R,y=this.h,y!==null&&R in y&&(y=this.h,R in y&&delete y[R])),this.j=new ln(this)}d(Mt,ee),Mt.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Mt.prototype.close=function(){Lo(this.g)},Mt.prototype.o=function(y){var R=this.g;if(typeof y=="string"){var j={};j.__data__=y,y=j}else this.v&&(j={},j.__data__=Ze(y),y=j);R.i.push(new ks(R.Ya++,y)),R.I==3&&vl(R)},Mt.prototype.N=function(){this.g.l=null,delete this.j,Lo(this.g),delete this.g,Mt.Z.N.call(this)};function Ur(y){rt.call(this),y.__headers__&&(this.headers=y.__headers__,this.statusCode=y.__status__,delete y.__headers__,delete y.__status__);var R=y.__sm__;if(R){e:{for(const j in R){y=j;break e}y=void 0}(this.i=y)&&(y=this.i,R=R!==null&&y in R?R[y]:void 0),this.data=R}else this.data=y}d(Ur,rt);function gn(){ft.call(this),this.status=1}d(gn,ft);function ln(y){this.g=y}d(ln,Et),ln.prototype.ra=function(){ye(this.g,"a")},ln.prototype.qa=function(y){ye(this.g,new Ur(y))},ln.prototype.pa=function(y){ye(this.g,new gn)},ln.prototype.oa=function(){ye(this.g,"b")},$t.prototype.createWebChannel=$t.prototype.g,Mt.prototype.send=Mt.prototype.o,Mt.prototype.open=Mt.prototype.m,Mt.prototype.close=Mt.prototype.close,cL=function(){return new $t},lL=function(){return jt()},oL=St,H1={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Cs.NO_ERROR=0,Cs.TIMEOUT=8,Cs.HTTP_ERROR=6,pm=Cs,Xs.COMPLETE="complete",aL=Xs,lt.EventType=tt,tt.OPEN="a",tt.CLOSE="b",tt.ERROR="c",tt.MESSAGE="d",ee.prototype.listen=ee.prototype.J,Sf=lt,fn.prototype.listenOnce=fn.prototype.K,fn.prototype.getLastError=fn.prototype.Ha,fn.prototype.getLastErrorCode=fn.prototype.ya,fn.prototype.getStatus=fn.prototype.ca,fn.prototype.getResponseJson=fn.prototype.La,fn.prototype.getResponseText=fn.prototype.la,fn.prototype.send=fn.prototype.ea,fn.prototype.setWithCredentials=fn.prototype.Fa,iL=fn}).apply(typeof M0<"u"?M0:typeof self<"u"?self:typeof window<"u"?window:{});const $k="@firebase/firestore",Gk="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bi{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Bi.UNAUTHENTICATED=new Bi(null),Bi.GOOGLE_CREDENTIALS=new Bi("google-credentials-uid"),Bi.FIRST_PARTY=new Bi("first-party-uid"),Bi.MOCK_USER=new Bi("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ch="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Od=new s2("@firebase/firestore");function ku(){return Od.logLevel}function bt(r,...e){if(Od.logLevel<=Er.DEBUG){const t=e.map(m2);Od.debug(`Firestore (${Ch}): ${r}`,...t)}}function sc(r,...e){if(Od.logLevel<=Er.ERROR){const t=e.map(m2);Od.error(`Firestore (${Ch}): ${r}`,...t)}}function Qd(r,...e){if(Od.logLevel<=Er.WARN){const t=e.map(m2);Od.warn(`Firestore (${Ch}): ${r}`,...t)}}function m2(r){if(typeof r=="string")return r;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(r)}catch{return r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wt(r,e,t){let n="Unexpected state";typeof e=="string"?n=e:t=e,AL(r,n,t)}function AL(r,e,t){let n=`FIRESTORE (${Ch}) INTERNAL ASSERTION FAILED: ${e} (ID: ${r.toString(16)})`;if(t!==void 0)try{n+=" CONTEXT: "+JSON.stringify(t)}catch{n+=" CONTEXT: "+t}throw sc(n),new Error(n)}function Xr(r,e,t,n){let s="Unexpected state";typeof t=="string"?s=t:n=t,r||AL(e,s,n)}function cr(r,e){return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ke={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ut extends lc{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xl{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dL{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class uL{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Bi.UNAUTHENTICATED)))}shutdown(){}}class $ee{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class Gee{constructor(e){this.t=e,this.currentUser=Bi.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Xr(this.o===void 0,42304);let n=this.i;const s=l=>this.i!==n?(n=this.i,t(l)):Promise.resolve();let i=new Xl;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Xl,e.enqueueRetryable((()=>s(this.currentUser)))};const a=()=>{const l=i;e.enqueueRetryable((async()=>{await l.promise,await s(this.currentUser)}))},o=l=>{bt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit((l=>o(l))),setTimeout((()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(bt("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Xl)}}),0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((n=>this.i!==e?(bt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Xr(typeof n.accessToken=="string",31837,{l:n}),new dL(n.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Xr(e===null||typeof e=="string",2055,{h:e}),new Bi(e)}}class zee{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=Bi.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Kee{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new zee(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Bi.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class zk{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class qee{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Ea(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Xr(this.o===void 0,3512);const n=i=>{i.error!=null&&bt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.m;return this.m=i.token,bt("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable((()=>n(i)))};const s=i=>{bt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((i=>s(i))),setTimeout((()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):bt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new zk(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Xr(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new zk(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wee(r){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(r);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let n=0;n<r;n++)t[n]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zb{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const s=Wee(40);for(let i=0;i<s.length;++i)n.length<20&&s[i]<t&&(n+=e.charAt(s[i]%62))}return n}}function Ir(r,e){return r<e?-1:r>e?1:0}function j1(r,e){const t=Math.min(r.length,e.length);for(let n=0;n<t;n++){const s=r.charAt(n),i=e.charAt(n);if(s!==i)return av(s)===av(i)?Ir(s,i):av(s)?1:-1}return Ir(r.length,e.length)}const Yee=55296,Xee=57343;function av(r){const e=r.charCodeAt(0);return e>=Yee&&e<=Xee}function oh(r,e,t){return r.length===e.length&&r.every(((n,s)=>t(n,e[s])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kk="__name__";class Vo{constructor(e,t,n){t===void 0?t=0:t>e.length&&Wt(637,{offset:t,range:e.length}),n===void 0?n=e.length-t:n>e.length-t&&Wt(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return Vo.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Vo?e.forEach((n=>{t.push(n)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let s=0;s<n;s++){const i=Vo.compareSegments(e.get(s),t.get(s));if(i!==0)return i}return Ir(e.length,t.length)}static compareSegments(e,t){const n=Vo.isNumericId(e),s=Vo.isNumericId(t);return n&&!s?-1:!n&&s?1:n&&s?Vo.extractNumericId(e).compare(Vo.extractNumericId(t)):j1(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return AA.fromString(e.substring(4,e.length-2))}}class vn extends Vo{construct(e,t,n){return new vn(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new ut(Ke.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter((s=>s.length>0)))}return new vn(t)}static emptyPath(){return new vn([])}}const Jee=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class zs extends Vo{construct(e,t,n){return new zs(e,t,n)}static isValidIdentifier(e){return Jee.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),zs.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Kk}static keyField(){return new zs([Kk])}static fromServerFormat(e){const t=[];let n="",s=0;const i=()=>{if(n.length===0)throw new ut(Ke.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let a=!1;for(;s<e.length;){const o=e[s];if(o==="\\"){if(s+1===e.length)throw new ut(Ke.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new ut(Ke.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=l,s+=2}else o==="`"?(a=!a,s++):o!=="."||a?(n+=o,s++):(i(),s++)}if(i(),a)throw new ut(Ke.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new zs(t)}static emptyPath(){return new zs([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qt{constructor(e){this.path=e}static fromPath(e){return new Qt(vn.fromString(e))}static fromName(e){return new Qt(vn.fromString(e).popFirst(5))}static empty(){return new Qt(vn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&vn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return vn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Qt(new vn(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hL(r,e,t){if(!t)throw new ut(Ke.INVALID_ARGUMENT,`Function ${r}() cannot be called with an empty ${e}.`)}function fL(r,e,t,n){if(e===!0&&n===!0)throw new ut(Ke.INVALID_ARGUMENT,`${r} and ${t} cannot be used together.`)}function qk(r){if(!Qt.isDocumentKey(r))throw new ut(Ke.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${r} has ${r.length}.`)}function Wk(r){if(Qt.isDocumentKey(r))throw new ut(Ke.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${r} has ${r.length}.`)}function gL(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}function ey(r){if(r===void 0)return"undefined";if(r===null)return"null";if(typeof r=="string")return r.length>20&&(r=`${r.substring(0,20)}...`),JSON.stringify(r);if(typeof r=="number"||typeof r=="boolean")return""+r;if(typeof r=="object"){if(r instanceof Array)return"an array";{const e=(function(n){return n.constructor?n.constructor.name:null})(r);return e?`a custom ${e} object`:"an object"}}return typeof r=="function"?"a function":Wt(12329,{type:typeof r})}function Na(r,e){if("_delegate"in r&&(r=r._delegate),!(r instanceof e)){if(e.name===r.constructor.name)throw new ut(Ke.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=ey(r);throw new ut(Ke.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return r}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xs(r,e){const t={typeString:r};return e&&(t.value=e),t}function Wg(r,e){if(!gL(r))throw new ut(Ke.INVALID_ARGUMENT,"JSON must be an object");let t;for(const n in e)if(e[n]){const s=e[n].typeString,i="value"in e[n]?{value:e[n].value}:void 0;if(!(n in r)){t=`JSON missing required field: '${n}'`;break}const a=r[n];if(s&&typeof a!==s){t=`JSON field '${n}' must be a ${s}.`;break}if(i!==void 0&&a!==i.value){t=`Expected '${n}' field to equal '${i.value}'`;break}}if(t)throw new ut(Ke.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yk=-62135596800,Xk=1e6;class xn{static now(){return xn.fromMillis(Date.now())}static fromDate(e){return xn.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*Xk);return new xn(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ut(Ke.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ut(Ke.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Yk)throw new ut(Ke.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ut(Ke.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Xk}_compareTo(e){return this.seconds===e.seconds?Ir(this.nanoseconds,e.nanoseconds):Ir(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:xn._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Wg(e,xn._jsonSchema))return new xn(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Yk;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}xn._jsonSchemaVersion="firestore/timestamp/1.0",xn._jsonSchema={type:xs("string",xn._jsonSchemaVersion),seconds:xs("number"),nanoseconds:xs("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rr{static fromTimestamp(e){return new rr(e)}static min(){return new rr(new xn(0,0))}static max(){return new rr(new xn(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cg=-1;function Zee(r,e){const t=r.toTimestamp().seconds,n=r.toTimestamp().nanoseconds+1,s=rr.fromTimestamp(n===1e9?new xn(t+1,0):new xn(t,n));return new vA(s,Qt.empty(),e)}function ete(r){return new vA(r.readTime,r.key,Cg)}class vA{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new vA(rr.min(),Qt.empty(),Cg)}static max(){return new vA(rr.max(),Qt.empty(),Cg)}}function tte(r,e){let t=r.readTime.compareTo(e.readTime);return t!==0?t:(t=Qt.comparator(r.documentKey,e.documentKey),t!==0?t:Ir(r.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rte="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class nte{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Sh(r){if(r.code!==Ke.FAILED_PRECONDITION||r.message!==rte)throw r;bt("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class We{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Wt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new We(((n,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(n,s)},this.catchCallback=i=>{this.wrapFailure(t,i).next(n,s)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof We?t:We.resolve(t)}catch(t){return We.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):We.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):We.reject(t)}static resolve(e){return new We(((t,n)=>{t(e)}))}static reject(e){return new We(((t,n)=>{n(e)}))}static waitFor(e){return new We(((t,n)=>{let s=0,i=0,a=!1;e.forEach((o=>{++s,o.next((()=>{++i,a&&i===s&&t()}),(l=>n(l)))})),a=!0,i===s&&t()}))}static or(e){let t=We.resolve(!1);for(const n of e)t=t.next((s=>s?We.resolve(s):n()));return t}static forEach(e,t){const n=[];return e.forEach(((s,i)=>{n.push(t.call(this,s,i))})),this.waitFor(n)}static mapArray(e,t){return new We(((n,s)=>{const i=e.length,a=new Array(i);let o=0;for(let l=0;l<i;l++){const c=l;t(e[c]).next((A=>{a[c]=A,++o,o===i&&n(a)}),(A=>s(A)))}}))}static doWhile(e,t){return new We(((n,s)=>{const i=()=>{e()===!0?t().next((()=>{i()}),s):n()};i()}))}}function ste(r){const e=r.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function kh(r){return r.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ty{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>t.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}ty.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b2=-1;function ry(r){return r==null}function db(r){return r===0&&1/r==-1/0}function ite(r){return typeof r=="number"&&Number.isInteger(r)&&!db(r)&&r<=Number.MAX_SAFE_INTEGER&&r>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pL="";function ate(r){let e="";for(let t=0;t<r.length;t++)e.length>0&&(e=Jk(e)),e=ote(r.get(t),e);return Jk(e)}function ote(r,e){let t=e;const n=r.length;for(let s=0;s<n;s++){const i=r.charAt(s);switch(i){case"\0":t+="";break;case pL:t+="";break;default:t+=i}}return t}function Jk(r){return r+pL+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zk(r){let e=0;for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e++;return e}function UA(r,e){for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e(t,r[t])}function mL(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class On{constructor(e,t){this.comparator=e,this.root=t||li.EMPTY}insert(e,t){return new On(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,li.BLACK,null,null))}remove(e){return new On(this.comparator,this.root.remove(e,this.comparator).copy(null,null,li.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return t+n.left.size;s<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new N0(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new N0(this.root,e,this.comparator,!1)}getReverseIterator(){return new N0(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new N0(this.root,e,this.comparator,!0)}}class N0{constructor(e,t,n,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class li{constructor(e,t,n,s,i){this.key=e,this.value=t,this.color=n??li.RED,this.left=s??li.EMPTY,this.right=i??li.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,s,i){return new li(e??this.key,t??this.value,n??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let s=this;const i=n(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,t,n),null):i===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return li.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return li.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,li.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,li.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Wt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Wt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Wt(27949);return e+(this.isRed()?0:1)}}li.EMPTY=null,li.RED=!0,li.BLACK=!1;li.EMPTY=new class{constructor(){this.size=0}get key(){throw Wt(57766)}get value(){throw Wt(16141)}get color(){throw Wt(16727)}get left(){throw Wt(29726)}get right(){throw Wt(36894)}copy(e,t,n,s,i){return this}insert(e,t,n){return new li(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ns{constructor(e){this.comparator=e,this.data=new On(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let n;for(n=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new eE(this.data.getIterator())}getIteratorFrom(e){return new eE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((n=>{t=t.add(n)})),t}isEqual(e){if(!(e instanceof Ns)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=n.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Ns(this.comparator);return t.data=e,t}}class eE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fa{constructor(e){this.fields=e,e.sort(zs.comparator)}static empty(){return new Fa([])}unionWith(e){let t=new Ns(zs.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new Fa(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return oh(this.fields,e.fields,((t,n)=>t.isEqual(n)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bL extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ys{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new bL("Invalid base64 string: "+i):i}})(e);return new Ys(t)}static fromUint8Array(e){const t=(function(s){let i="";for(let a=0;a<s.length;++a)i+=String.fromCharCode(s[a]);return i})(e);return new Ys(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const n=new Uint8Array(t.length);for(let s=0;s<t.length;s++)n[s]=t.charCodeAt(s);return n})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ir(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ys.EMPTY_BYTE_STRING=new Ys("");const lte=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function xA(r){if(Xr(!!r,39018),typeof r=="string"){let e=0;const t=lte.exec(r);if(Xr(!!t,46558,{timestamp:r}),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const n=new Date(r);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:is(r.seconds),nanos:is(r.nanos)}}function is(r){return typeof r=="number"?r:typeof r=="string"?Number(r):0}function _A(r){return typeof r=="string"?Ys.fromBase64String(r):Ys.fromUint8Array(r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yL="server_timestamp",wL="__type__",vL="__previous_value__",xL="__local_write_time__";function y2(r){var t,n;return((n=(((t=r==null?void 0:r.mapValue)==null?void 0:t.fields)||{})[wL])==null?void 0:n.stringValue)===yL}function ny(r){const e=r.mapValue.fields[vL];return y2(e)?ny(e):e}function Sg(r){const e=xA(r.mapValue.fields[xL].timestampValue);return new xn(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cte{constructor(e,t,n,s,i,a,o,l,c,A){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=s,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=c,this.isUsingEmulator=A}}const ub="(default)";class lh{constructor(e,t){this.projectId=e,this.database=t||ub}static empty(){return new lh("","")}get isDefaultDatabase(){return this.database===ub}isEqual(e){return e instanceof lh&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _L="__type__",Ate="__max__",P0={mapValue:{}},BL="__vector__",hb="value";function BA(r){return"nullValue"in r?0:"booleanValue"in r?1:"integerValue"in r||"doubleValue"in r?2:"timestampValue"in r?3:"stringValue"in r?5:"bytesValue"in r?6:"referenceValue"in r?7:"geoPointValue"in r?8:"arrayValue"in r?9:"mapValue"in r?y2(r)?4:ute(r)?9007199254740991:dte(r)?10:11:Wt(28295,{value:r})}function cl(r,e){if(r===e)return!0;const t=BA(r);if(t!==BA(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return r.booleanValue===e.booleanValue;case 4:return Sg(r).isEqual(Sg(e));case 3:return(function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const a=xA(s.timestampValue),o=xA(i.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos})(r,e);case 5:return r.stringValue===e.stringValue;case 6:return(function(s,i){return _A(s.bytesValue).isEqual(_A(i.bytesValue))})(r,e);case 7:return r.referenceValue===e.referenceValue;case 8:return(function(s,i){return is(s.geoPointValue.latitude)===is(i.geoPointValue.latitude)&&is(s.geoPointValue.longitude)===is(i.geoPointValue.longitude)})(r,e);case 2:return(function(s,i){if("integerValue"in s&&"integerValue"in i)return is(s.integerValue)===is(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const a=is(s.doubleValue),o=is(i.doubleValue);return a===o?db(a)===db(o):isNaN(a)&&isNaN(o)}return!1})(r,e);case 9:return oh(r.arrayValue.values||[],e.arrayValue.values||[],cl);case 10:case 11:return(function(s,i){const a=s.mapValue.fields||{},o=i.mapValue.fields||{};if(Zk(a)!==Zk(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!cl(a[l],o[l])))return!1;return!0})(r,e);default:return Wt(52216,{left:r})}}function kg(r,e){return(r.values||[]).find((t=>cl(t,e)))!==void 0}function ch(r,e){if(r===e)return 0;const t=BA(r),n=BA(e);if(t!==n)return Ir(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return Ir(r.booleanValue,e.booleanValue);case 2:return(function(i,a){const o=is(i.integerValue||i.doubleValue),l=is(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1})(r,e);case 3:return tE(r.timestampValue,e.timestampValue);case 4:return tE(Sg(r),Sg(e));case 5:return j1(r.stringValue,e.stringValue);case 6:return(function(i,a){const o=_A(i),l=_A(a);return o.compareTo(l)})(r.bytesValue,e.bytesValue);case 7:return(function(i,a){const o=i.split("/"),l=a.split("/");for(let c=0;c<o.length&&c<l.length;c++){const A=Ir(o[c],l[c]);if(A!==0)return A}return Ir(o.length,l.length)})(r.referenceValue,e.referenceValue);case 8:return(function(i,a){const o=Ir(is(i.latitude),is(a.latitude));return o!==0?o:Ir(is(i.longitude),is(a.longitude))})(r.geoPointValue,e.geoPointValue);case 9:return rE(r.arrayValue,e.arrayValue);case 10:return(function(i,a){var h,u,p,f;const o=i.fields||{},l=a.fields||{},c=(h=o[hb])==null?void 0:h.arrayValue,A=(u=l[hb])==null?void 0:u.arrayValue,d=Ir(((p=c==null?void 0:c.values)==null?void 0:p.length)||0,((f=A==null?void 0:A.values)==null?void 0:f.length)||0);return d!==0?d:rE(c,A)})(r.mapValue,e.mapValue);case 11:return(function(i,a){if(i===P0.mapValue&&a===P0.mapValue)return 0;if(i===P0.mapValue)return 1;if(a===P0.mapValue)return-1;const o=i.fields||{},l=Object.keys(o),c=a.fields||{},A=Object.keys(c);l.sort(),A.sort();for(let d=0;d<l.length&&d<A.length;++d){const h=j1(l[d],A[d]);if(h!==0)return h;const u=ch(o[l[d]],c[A[d]]);if(u!==0)return u}return Ir(l.length,A.length)})(r.mapValue,e.mapValue);default:throw Wt(23264,{he:t})}}function tE(r,e){if(typeof r=="string"&&typeof e=="string"&&r.length===e.length)return Ir(r,e);const t=xA(r),n=xA(e),s=Ir(t.seconds,n.seconds);return s!==0?s:Ir(t.nanos,n.nanos)}function rE(r,e){const t=r.values||[],n=e.values||[];for(let s=0;s<t.length&&s<n.length;++s){const i=ch(t[s],n[s]);if(i)return i}return Ir(t.length,n.length)}function Ah(r){return V1(r)}function V1(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?(function(t){const n=xA(t);return`time(${n.seconds},${n.nanos})`})(r.timestampValue):"stringValue"in r?r.stringValue:"bytesValue"in r?(function(t){return _A(t).toBase64()})(r.bytesValue):"referenceValue"in r?(function(t){return Qt.fromName(t).toString()})(r.referenceValue):"geoPointValue"in r?(function(t){return`geo(${t.latitude},${t.longitude})`})(r.geoPointValue):"arrayValue"in r?(function(t){let n="[",s=!0;for(const i of t.values||[])s?s=!1:n+=",",n+=V1(i);return n+"]"})(r.arrayValue):"mapValue"in r?(function(t){const n=Object.keys(t.fields||{}).sort();let s="{",i=!0;for(const a of n)i?i=!1:s+=",",s+=`${a}:${V1(t.fields[a])}`;return s+"}"})(r.mapValue):Wt(61005,{value:r})}function mm(r){switch(BA(r)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=ny(r);return e?16+mm(e):16;case 5:return 2*r.stringValue.length;case 6:return _A(r.bytesValue).approximateByteSize();case 7:return r.referenceValue.length;case 9:return(function(n){return(n.values||[]).reduce(((s,i)=>s+mm(i)),0)})(r.arrayValue);case 10:case 11:return(function(n){let s=0;return UA(n.fields,((i,a)=>{s+=i.length+mm(a)})),s})(r.mapValue);default:throw Wt(13486,{value:r})}}function nE(r,e){return{referenceValue:`projects/${r.projectId}/databases/${r.database}/documents/${e.path.canonicalString()}`}}function $1(r){return!!r&&"integerValue"in r}function w2(r){return!!r&&"arrayValue"in r}function sE(r){return!!r&&"nullValue"in r}function iE(r){return!!r&&"doubleValue"in r&&isNaN(Number(r.doubleValue))}function bm(r){return!!r&&"mapValue"in r}function dte(r){var t,n;return((n=(((t=r==null?void 0:r.mapValue)==null?void 0:t.fields)||{})[_L])==null?void 0:n.stringValue)===BL}function rg(r){if(r.geoPointValue)return{geoPointValue:{...r.geoPointValue}};if(r.timestampValue&&typeof r.timestampValue=="object")return{timestampValue:{...r.timestampValue}};if(r.mapValue){const e={mapValue:{fields:{}}};return UA(r.mapValue.fields,((t,n)=>e.mapValue.fields[t]=rg(n))),e}if(r.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(r.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=rg(r.arrayValue.values[t]);return e}return{...r}}function ute(r){return(((r.mapValue||{}).fields||{}).__type__||{}).stringValue===Ate}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ca{constructor(e){this.value=e}static empty(){return new ca({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!bm(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=rg(t)}setAll(e){let t=zs.emptyPath(),n={},s=[];e.forEach(((a,o)=>{if(!t.isImmediateParentOf(o)){const l=this.getFieldsMap(t);this.applyChanges(l,n,s),n={},s=[],t=o.popLast()}a?n[o.lastSegment()]=rg(a):s.push(o.lastSegment())}));const i=this.getFieldsMap(t);this.applyChanges(i,n,s)}delete(e){const t=this.field(e.popLast());bm(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return cl(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let s=t.mapValue.fields[e.get(n)];bm(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,n){UA(t,((s,i)=>e[s]=i));for(const s of n)delete e[s]}clone(){return new ca(rg(this.value))}}function CL(r){const e=[];return UA(r.fields,((t,n)=>{const s=new zs([t]);if(bm(n)){const i=CL(n.mapValue).fields;if(i.length===0)e.push(s);else for(const a of i)e.push(s.child(a))}else e.push(s)})),new Fa(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ei{constructor(e,t,n,s,i,a,o){this.key=e,this.documentType=t,this.version=n,this.readTime=s,this.createTime=i,this.data=a,this.documentState=o}static newInvalidDocument(e){return new Ei(e,0,rr.min(),rr.min(),rr.min(),ca.empty(),0)}static newFoundDocument(e,t,n,s){return new Ei(e,1,t,rr.min(),n,s,0)}static newNoDocument(e,t){return new Ei(e,2,t,rr.min(),rr.min(),ca.empty(),0)}static newUnknownDocument(e,t){return new Ei(e,3,t,rr.min(),rr.min(),ca.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(rr.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ca.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ca.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=rr.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ei&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ei(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fb{constructor(e,t){this.position=e,this.inclusive=t}}function aE(r,e,t){let n=0;for(let s=0;s<r.position.length;s++){const i=e[s],a=r.position[s];if(i.field.isKeyField()?n=Qt.comparator(Qt.fromName(a.referenceValue),t.key):n=ch(a,t.data.field(i.field)),i.dir==="desc"&&(n*=-1),n!==0)break}return n}function oE(r,e){if(r===null)return e===null;if(e===null||r.inclusive!==e.inclusive||r.position.length!==e.position.length)return!1;for(let t=0;t<r.position.length;t++)if(!cl(r.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eg{constructor(e,t="asc"){this.field=e,this.dir=t}}function hte(r,e){return r.dir===e.dir&&r.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SL{}class ys extends SL{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new gte(e,t,n):t==="array-contains"?new bte(e,n):t==="in"?new yte(e,n):t==="not-in"?new wte(e,n):t==="array-contains-any"?new vte(e,n):new ys(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new pte(e,n):new mte(e,n)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(ch(t,this.value)):t!==null&&BA(this.value)===BA(t)&&this.matchesComparison(ch(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Wt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class vo extends SL{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new vo(e,t)}matches(e){return kL(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function kL(r){return r.op==="and"}function EL(r){return fte(r)&&kL(r)}function fte(r){for(const e of r.filters)if(e instanceof vo)return!1;return!0}function G1(r){if(r instanceof ys)return r.field.canonicalString()+r.op.toString()+Ah(r.value);if(EL(r))return r.filters.map((e=>G1(e))).join(",");{const e=r.filters.map((t=>G1(t))).join(",");return`${r.op}(${e})`}}function IL(r,e){return r instanceof ys?(function(n,s){return s instanceof ys&&n.op===s.op&&n.field.isEqual(s.field)&&cl(n.value,s.value)})(r,e):r instanceof vo?(function(n,s){return s instanceof vo&&n.op===s.op&&n.filters.length===s.filters.length?n.filters.reduce(((i,a,o)=>i&&IL(a,s.filters[o])),!0):!1})(r,e):void Wt(19439)}function TL(r){return r instanceof ys?(function(t){return`${t.field.canonicalString()} ${t.op} ${Ah(t.value)}`})(r):r instanceof vo?(function(t){return t.op.toString()+" {"+t.getFilters().map(TL).join(" ,")+"}"})(r):"Filter"}class gte extends ys{constructor(e,t,n){super(e,t,n),this.key=Qt.fromName(n.referenceValue)}matches(e){const t=Qt.comparator(e.key,this.key);return this.matchesComparison(t)}}class pte extends ys{constructor(e,t){super(e,"in",t),this.keys=FL("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class mte extends ys{constructor(e,t){super(e,"not-in",t),this.keys=FL("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function FL(r,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map((n=>Qt.fromName(n.referenceValue)))}class bte extends ys{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return w2(t)&&kg(t.arrayValue,this.value)}}class yte extends ys{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&kg(this.value.arrayValue,t)}}class wte extends ys{constructor(e,t){super(e,"not-in",t)}matches(e){if(kg(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!kg(this.value.arrayValue,t)}}class vte extends ys{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!w2(t)||!t.arrayValue.values)&&t.arrayValue.values.some((n=>kg(this.value.arrayValue,n)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xte{constructor(e,t=null,n=[],s=[],i=null,a=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=s,this.limit=i,this.startAt=a,this.endAt=o,this.Te=null}}function lE(r,e=null,t=[],n=[],s=null,i=null,a=null){return new xte(r,e,t,n,s,i,a)}function v2(r){const e=cr(r);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((n=>G1(n))).join(","),t+="|ob:",t+=e.orderBy.map((n=>(function(i){return i.field.canonicalString()+i.dir})(n))).join(","),ry(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((n=>Ah(n))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((n=>Ah(n))).join(",")),e.Te=t}return e.Te}function x2(r,e){if(r.limit!==e.limit||r.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<r.orderBy.length;t++)if(!hte(r.orderBy[t],e.orderBy[t]))return!1;if(r.filters.length!==e.filters.length)return!1;for(let t=0;t<r.filters.length;t++)if(!IL(r.filters[t],e.filters[t]))return!1;return r.collectionGroup===e.collectionGroup&&!!r.path.isEqual(e.path)&&!!oE(r.startAt,e.startAt)&&oE(r.endAt,e.endAt)}function z1(r){return Qt.isDocumentKey(r.path)&&r.collectionGroup===null&&r.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eh{constructor(e,t=null,n=[],s=[],i=null,a="F",o=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=s,this.limit=i,this.limitType=a,this.startAt=o,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function _te(r,e,t,n,s,i,a,o){return new Eh(r,e,t,n,s,i,a,o)}function _2(r){return new Eh(r)}function cE(r){return r.filters.length===0&&r.limit===null&&r.startAt==null&&r.endAt==null&&(r.explicitOrderBy.length===0||r.explicitOrderBy.length===1&&r.explicitOrderBy[0].field.isKeyField())}function LL(r){return r.collectionGroup!==null}function ng(r){const e=cr(r);if(e.Ie===null){e.Ie=[];const t=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),t.add(i.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new Ns(zs.comparator);return a.filters.forEach((l=>{l.getFlattenedFilters().forEach((c=>{c.isInequality()&&(o=o.add(c.field))}))})),o})(e).forEach((i=>{t.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new Eg(i,n))})),t.has(zs.keyField().canonicalString())||e.Ie.push(new Eg(zs.keyField(),n))}return e.Ie}function tl(r){const e=cr(r);return e.Ee||(e.Ee=Bte(e,ng(r))),e.Ee}function Bte(r,e){if(r.limitType==="F")return lE(r.path,r.collectionGroup,e,r.filters,r.limit,r.startAt,r.endAt);{e=e.map((s=>{const i=s.dir==="desc"?"asc":"desc";return new Eg(s.field,i)}));const t=r.endAt?new fb(r.endAt.position,r.endAt.inclusive):null,n=r.startAt?new fb(r.startAt.position,r.startAt.inclusive):null;return lE(r.path,r.collectionGroup,e,r.filters,r.limit,t,n)}}function K1(r,e){const t=r.filters.concat([e]);return new Eh(r.path,r.collectionGroup,r.explicitOrderBy.slice(),t,r.limit,r.limitType,r.startAt,r.endAt)}function gb(r,e,t){return new Eh(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),e,t,r.startAt,r.endAt)}function sy(r,e){return x2(tl(r),tl(e))&&r.limitType===e.limitType}function UL(r){return`${v2(tl(r))}|lt:${r.limitType}`}function Eu(r){return`Query(target=${(function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map((s=>TL(s))).join(", ")}]`),ry(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map((s=>(function(a){return`${a.field.canonicalString()} (${a.dir})`})(s))).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map((s=>Ah(s))).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map((s=>Ah(s))).join(",")),`Target(${n})`})(tl(r))}; limitType=${r.limitType})`}function iy(r,e){return e.isFoundDocument()&&(function(n,s){const i=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(i):Qt.isDocumentKey(n.path)?n.path.isEqual(i):n.path.isImmediateParentOf(i)})(r,e)&&(function(n,s){for(const i of ng(n))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0})(r,e)&&(function(n,s){for(const i of n.filters)if(!i.matches(s))return!1;return!0})(r,e)&&(function(n,s){return!(n.startAt&&!(function(a,o,l){const c=aE(a,o,l);return a.inclusive?c<=0:c<0})(n.startAt,ng(n),s)||n.endAt&&!(function(a,o,l){const c=aE(a,o,l);return a.inclusive?c>=0:c>0})(n.endAt,ng(n),s))})(r,e)}function Cte(r){return r.collectionGroup||(r.path.length%2==1?r.path.lastSegment():r.path.get(r.path.length-2))}function ML(r){return(e,t)=>{let n=!1;for(const s of ng(r)){const i=Ste(s,e,t);if(i!==0)return i;n=n||s.field.isKeyField()}return 0}}function Ste(r,e,t){const n=r.field.isKeyField()?Qt.comparator(e.key,t.key):(function(i,a,o){const l=a.data.field(i),c=o.data.field(i);return l!==null&&c!==null?ch(l,c):Wt(42886)})(r.field,e,t);switch(r.dir){case"asc":return n;case"desc":return-1*n;default:return Wt(19790,{direction:r.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jd{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(const[s,i]of n)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],e))return n.length===1?delete this.inner[t]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(e){UA(this.inner,((t,n)=>{for(const[s,i]of n)e(s,i)}))}isEmpty(){return mL(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kte=new On(Qt.comparator);function ic(){return kte}const NL=new On(Qt.comparator);function kf(...r){let e=NL;for(const t of r)e=e.insert(t.key,t);return e}function PL(r){let e=NL;return r.forEach(((t,n)=>e=e.insert(t,n.overlayedDocument))),e}function fd(){return sg()}function DL(){return sg()}function sg(){return new Jd((r=>r.toString()),((r,e)=>r.isEqual(e)))}const Ete=new On(Qt.comparator),Ite=new Ns(Qt.comparator);function Tr(...r){let e=Ite;for(const t of r)e=e.add(t);return e}const Tte=new Ns(Ir);function Fte(){return Tte}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B2(r,e){if(r.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:db(e)?"-0":e}}function RL(r){return{integerValue:""+r}}function Lte(r,e){return ite(e)?RL(e):B2(r,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ay{constructor(){this._=void 0}}function Ute(r,e,t){return r instanceof Ig?(function(s,i){const a={fields:{[wL]:{stringValue:yL},[xL]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&y2(i)&&(i=ny(i)),i&&(a.fields[vL]=i),{mapValue:a}})(t,e):r instanceof Tg?QL(r,e):r instanceof Fg?HL(r,e):(function(s,i){const a=OL(s,i),o=AE(a)+AE(s.Ae);return $1(a)&&$1(s.Ae)?RL(o):B2(s.serializer,o)})(r,e)}function Mte(r,e,t){return r instanceof Tg?QL(r,e):r instanceof Fg?HL(r,e):t}function OL(r,e){return r instanceof pb?(function(n){return $1(n)||(function(i){return!!i&&"doubleValue"in i})(n)})(e)?e:{integerValue:0}:null}class Ig extends ay{}class Tg extends ay{constructor(e){super(),this.elements=e}}function QL(r,e){const t=jL(e);for(const n of r.elements)t.some((s=>cl(s,n)))||t.push(n);return{arrayValue:{values:t}}}class Fg extends ay{constructor(e){super(),this.elements=e}}function HL(r,e){let t=jL(e);for(const n of r.elements)t=t.filter((s=>!cl(s,n)));return{arrayValue:{values:t}}}class pb extends ay{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function AE(r){return is(r.integerValue||r.doubleValue)}function jL(r){return w2(r)&&r.arrayValue.values?r.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nte{constructor(e,t){this.field=e,this.transform=t}}function Pte(r,e){return r.field.isEqual(e.field)&&(function(n,s){return n instanceof Tg&&s instanceof Tg||n instanceof Fg&&s instanceof Fg?oh(n.elements,s.elements,cl):n instanceof pb&&s instanceof pb?cl(n.Ae,s.Ae):n instanceof Ig&&s instanceof Ig})(r.transform,e.transform)}class Dte{constructor(e,t){this.version=e,this.transformResults=t}}class Hi{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Hi}static exists(e){return new Hi(void 0,e)}static updateTime(e){return new Hi(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ym(r,e){return r.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(r.updateTime):r.exists===void 0||r.exists===e.isFoundDocument()}class oy{}function VL(r,e){if(!r.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return r.isNoDocument()?new ly(r.key,Hi.none()):new Yg(r.key,r.data,Hi.none());{const t=r.data,n=ca.empty();let s=new Ns(zs.comparator);for(let i of e.fields)if(!s.has(i)){let a=t.field(i);a===null&&i.length>1&&(i=i.popLast(),a=t.field(i)),a===null?n.delete(i):n.set(i,a),s=s.add(i)}return new MA(r.key,n,new Fa(s.toArray()),Hi.none())}}function Rte(r,e,t){r instanceof Yg?(function(s,i,a){const o=s.value.clone(),l=uE(s.fieldTransforms,i,a.transformResults);o.setAll(l),i.convertToFoundDocument(a.version,o).setHasCommittedMutations()})(r,e,t):r instanceof MA?(function(s,i,a){if(!ym(s.precondition,i))return void i.convertToUnknownDocument(a.version);const o=uE(s.fieldTransforms,i,a.transformResults),l=i.data;l.setAll($L(s)),l.setAll(o),i.convertToFoundDocument(a.version,l).setHasCommittedMutations()})(r,e,t):(function(s,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()})(0,e,t)}function ig(r,e,t,n){return r instanceof Yg?(function(i,a,o,l){if(!ym(i.precondition,a))return o;const c=i.value.clone(),A=hE(i.fieldTransforms,l,a);return c.setAll(A),a.convertToFoundDocument(a.version,c).setHasLocalMutations(),null})(r,e,t,n):r instanceof MA?(function(i,a,o,l){if(!ym(i.precondition,a))return o;const c=hE(i.fieldTransforms,l,a),A=a.data;return A.setAll($L(i)),A.setAll(c),a.convertToFoundDocument(a.version,A).setHasLocalMutations(),o===null?null:o.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map((d=>d.field)))})(r,e,t,n):(function(i,a,o){return ym(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o})(r,e,t)}function Ote(r,e){let t=null;for(const n of r.fieldTransforms){const s=e.data.field(n.field),i=OL(n.transform,s||null);i!=null&&(t===null&&(t=ca.empty()),t.set(n.field,i))}return t||null}function dE(r,e){return r.type===e.type&&!!r.key.isEqual(e.key)&&!!r.precondition.isEqual(e.precondition)&&!!(function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&oh(n,s,((i,a)=>Pte(i,a)))})(r.fieldTransforms,e.fieldTransforms)&&(r.type===0?r.value.isEqual(e.value):r.type!==1||r.data.isEqual(e.data)&&r.fieldMask.isEqual(e.fieldMask))}class Yg extends oy{constructor(e,t,n,s=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class MA extends oy{constructor(e,t,n,s,i=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function $L(r){const e=new Map;return r.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const n=r.data.field(t);e.set(t,n)}})),e}function uE(r,e,t){const n=new Map;Xr(r.length===t.length,32656,{Re:t.length,Ve:r.length});for(let s=0;s<t.length;s++){const i=r[s],a=i.transform,o=e.data.field(i.field);n.set(i.field,Mte(a,o,t[s]))}return n}function hE(r,e,t){const n=new Map;for(const s of r){const i=s.transform,a=t.data.field(s.field);n.set(s.field,Ute(i,a,e))}return n}class ly extends oy{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Qte extends oy{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hte{constructor(e,t,n,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&Rte(i,e,n[s])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=ig(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=ig(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=DL();return this.mutations.forEach((s=>{const i=e.get(s.key),a=i.overlayedDocument;let o=this.applyToLocalView(a,i.mutatedFields);o=t.has(s.key)?null:o;const l=VL(a,o);l!==null&&n.set(s.key,l),a.isValidDocument()||a.convertToNoDocument(rr.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Tr())}isEqual(e){return this.batchId===e.batchId&&oh(this.mutations,e.mutations,((t,n)=>dE(t,n)))&&oh(this.baseMutations,e.baseMutations,((t,n)=>dE(t,n)))}}class C2{constructor(e,t,n,s){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=s}static from(e,t,n){Xr(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let s=(function(){return Ete})();const i=e.mutations;for(let a=0;a<i.length;a++)s=s.insert(i[a].key,n[a].version);return new C2(e,t,n,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jte{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vte{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ms,Nr;function $te(r){switch(r){case Ke.OK:return Wt(64938);case Ke.CANCELLED:case Ke.UNKNOWN:case Ke.DEADLINE_EXCEEDED:case Ke.RESOURCE_EXHAUSTED:case Ke.INTERNAL:case Ke.UNAVAILABLE:case Ke.UNAUTHENTICATED:return!1;case Ke.INVALID_ARGUMENT:case Ke.NOT_FOUND:case Ke.ALREADY_EXISTS:case Ke.PERMISSION_DENIED:case Ke.FAILED_PRECONDITION:case Ke.ABORTED:case Ke.OUT_OF_RANGE:case Ke.UNIMPLEMENTED:case Ke.DATA_LOSS:return!0;default:return Wt(15467,{code:r})}}function GL(r){if(r===void 0)return sc("GRPC error has no .code"),Ke.UNKNOWN;switch(r){case ms.OK:return Ke.OK;case ms.CANCELLED:return Ke.CANCELLED;case ms.UNKNOWN:return Ke.UNKNOWN;case ms.DEADLINE_EXCEEDED:return Ke.DEADLINE_EXCEEDED;case ms.RESOURCE_EXHAUSTED:return Ke.RESOURCE_EXHAUSTED;case ms.INTERNAL:return Ke.INTERNAL;case ms.UNAVAILABLE:return Ke.UNAVAILABLE;case ms.UNAUTHENTICATED:return Ke.UNAUTHENTICATED;case ms.INVALID_ARGUMENT:return Ke.INVALID_ARGUMENT;case ms.NOT_FOUND:return Ke.NOT_FOUND;case ms.ALREADY_EXISTS:return Ke.ALREADY_EXISTS;case ms.PERMISSION_DENIED:return Ke.PERMISSION_DENIED;case ms.FAILED_PRECONDITION:return Ke.FAILED_PRECONDITION;case ms.ABORTED:return Ke.ABORTED;case ms.OUT_OF_RANGE:return Ke.OUT_OF_RANGE;case ms.UNIMPLEMENTED:return Ke.UNIMPLEMENTED;case ms.DATA_LOSS:return Ke.DATA_LOSS;default:return Wt(39323,{code:r})}}(Nr=ms||(ms={}))[Nr.OK=0]="OK",Nr[Nr.CANCELLED=1]="CANCELLED",Nr[Nr.UNKNOWN=2]="UNKNOWN",Nr[Nr.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Nr[Nr.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Nr[Nr.NOT_FOUND=5]="NOT_FOUND",Nr[Nr.ALREADY_EXISTS=6]="ALREADY_EXISTS",Nr[Nr.PERMISSION_DENIED=7]="PERMISSION_DENIED",Nr[Nr.UNAUTHENTICATED=16]="UNAUTHENTICATED",Nr[Nr.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Nr[Nr.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Nr[Nr.ABORTED=10]="ABORTED",Nr[Nr.OUT_OF_RANGE=11]="OUT_OF_RANGE",Nr[Nr.UNIMPLEMENTED=12]="UNIMPLEMENTED",Nr[Nr.INTERNAL=13]="INTERNAL",Nr[Nr.UNAVAILABLE=14]="UNAVAILABLE",Nr[Nr.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gte(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zte=new AA([4294967295,4294967295],0);function fE(r){const e=Gte().encode(r),t=new sL;return t.update(e),new Uint8Array(t.digest())}function gE(r){const e=new DataView(r.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new AA([t,n],0),new AA([s,i],0)]}class S2{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Ef(`Invalid padding: ${t}`);if(n<0)throw new Ef(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Ef(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new Ef(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=AA.fromNumber(this.ge)}ye(e,t,n){let s=e.add(t.multiply(AA.fromNumber(n)));return s.compare(zte)===1&&(s=new AA([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=fE(e),[n,s]=gE(t);for(let i=0;i<this.hashCount;i++){const a=this.ye(n,s,i);if(!this.we(a))return!1}return!0}static create(e,t,n){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new S2(i,s,t);return n.forEach((o=>a.insert(o))),a}insert(e){if(this.ge===0)return;const t=fE(e),[n,s]=gE(t);for(let i=0;i<this.hashCount;i++){const a=this.ye(n,s,i);this.Se(a)}}Se(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class Ef extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cy{constructor(e,t,n,s,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const s=new Map;return s.set(e,Xg.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new cy(rr.min(),s,new On(Ir),ic(),Tr())}}class Xg{constructor(e,t,n,s,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new Xg(n,t,Tr(),Tr(),Tr())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wm{constructor(e,t,n,s){this.be=e,this.removedTargetIds=t,this.key=n,this.De=s}}class zL{constructor(e,t){this.targetId=e,this.Ce=t}}class KL{constructor(e,t,n=Ys.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=s}}class pE{constructor(){this.ve=0,this.Fe=mE(),this.Me=Ys.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Tr(),t=Tr(),n=Tr();return this.Fe.forEach(((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:n=n.add(s);break;default:Wt(38017,{changeType:i})}})),new Xg(this.Me,this.xe,e,t,n)}qe(){this.Oe=!1,this.Fe=mE()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Xr(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class Kte{constructor(e){this.Ge=e,this.ze=new Map,this.je=ic(),this.Je=D0(),this.He=D0(),this.Ye=new On(Ir)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const n=this.nt(t);switch(e.state){case 0:this.rt(t)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),n.Le(e.resumeToken));break;default:Wt(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((n,s)=>{this.rt(s)&&t(s)}))}st(e){const t=e.targetId,n=e.Ce.count,s=this.ot(t);if(s){const i=s.target;if(z1(i))if(n===0){const a=new Qt(i.path);this.et(t,a,Ei.newNoDocument(a,rr.min()))}else Xr(n===1,20013,{expectedCount:n});else{const a=this._t(t);if(a!==n){const o=this.ut(e),l=o?this.ct(o,e,a):1;if(l!==0){this.it(t);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,c)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:s=0},hashCount:i=0}=t;let a,o;try{a=_A(n).toUint8Array()}catch(l){if(l instanceof bL)return Qd("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new S2(a,s,i)}catch(l){return Qd(l instanceof Ef?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.ge===0?null:o}ct(e,t,n){return t.Ce.count===n-this.Pt(e,t.targetId)?0:2}Pt(e,t){const n=this.Ge.getRemoteKeysForTarget(t);let s=0;return n.forEach((i=>{const a=this.Ge.ht(),o=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(o)||(this.et(t,i,null),s++)})),s}Tt(e){const t=new Map;this.ze.forEach(((i,a)=>{const o=this.ot(a);if(o){if(i.current&&z1(o.target)){const l=new Qt(o.target.path);this.It(l).has(a)||this.Et(a,l)||this.et(a,l,Ei.newNoDocument(l,e))}i.Be&&(t.set(a,i.ke()),i.qe())}}));let n=Tr();this.He.forEach(((i,a)=>{let o=!0;a.forEachWhile((l=>{const c=this.ot(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)})),o&&(n=n.add(i))})),this.je.forEach(((i,a)=>a.setReadTime(e)));const s=new cy(e,t,this.Ye,this.je,n);return this.je=ic(),this.Je=D0(),this.He=D0(),this.Ye=new On(Ir),s}Xe(e,t){if(!this.rt(e))return;const n=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,n),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,n){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,t)?s.Qe(t,1):s.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),n&&(this.je=this.je.insert(t,n))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new pE,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Ns(Ir),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Ns(Ir),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||bt("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new pE),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function D0(){return new On(Qt.comparator)}function mE(){return new On(Qt.comparator)}const qte={asc:"ASCENDING",desc:"DESCENDING"},Wte={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Yte={and:"AND",or:"OR"};class Xte{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function q1(r,e){return r.useProto3Json||ry(e)?e:{value:e}}function mb(r,e){return r.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function qL(r,e){return r.useProto3Json?e.toBase64():e.toUint8Array()}function Jte(r,e){return mb(r,e.toTimestamp())}function rl(r){return Xr(!!r,49232),rr.fromTimestamp((function(t){const n=xA(t);return new xn(n.seconds,n.nanos)})(r))}function k2(r,e){return W1(r,e).canonicalString()}function W1(r,e){const t=(function(s){return new vn(["projects",s.projectId,"databases",s.database])})(r).child("documents");return e===void 0?t:t.child(e)}function WL(r){const e=vn.fromString(r);return Xr(eU(e),10190,{key:e.toString()}),e}function Y1(r,e){return k2(r.databaseId,e.path)}function ov(r,e){const t=WL(e);if(t.get(1)!==r.databaseId.projectId)throw new ut(Ke.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+r.databaseId.projectId);if(t.get(3)!==r.databaseId.database)throw new ut(Ke.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+r.databaseId.database);return new Qt(XL(t))}function YL(r,e){return k2(r.databaseId,e)}function Zte(r){const e=WL(r);return e.length===4?vn.emptyPath():XL(e)}function X1(r){return new vn(["projects",r.databaseId.projectId,"databases",r.databaseId.database]).canonicalString()}function XL(r){return Xr(r.length>4&&r.get(4)==="documents",29091,{key:r.toString()}),r.popFirst(5)}function bE(r,e,t){return{name:Y1(r,e),fields:t.value.mapValue.fields}}function ere(r,e){let t;if("targetChange"in e){e.targetChange;const n=(function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Wt(39313,{state:c})})(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=(function(c,A){return c.useProto3Json?(Xr(A===void 0||typeof A=="string",58123),Ys.fromBase64String(A||"")):(Xr(A===void 0||A instanceof Buffer||A instanceof Uint8Array,16193),Ys.fromUint8Array(A||new Uint8Array))})(r,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&(function(c){const A=c.code===void 0?Ke.UNKNOWN:GL(c.code);return new ut(A,c.message||"")})(a);t=new KL(n,s,i,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const s=ov(r,n.document.name),i=rl(n.document.updateTime),a=n.document.createTime?rl(n.document.createTime):rr.min(),o=new ca({mapValue:{fields:n.document.fields}}),l=Ei.newFoundDocument(s,i,a,o),c=n.targetIds||[],A=n.removedTargetIds||[];t=new wm(c,A,l.key,l)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const s=ov(r,n.document),i=n.readTime?rl(n.readTime):rr.min(),a=Ei.newNoDocument(s,i),o=n.removedTargetIds||[];t=new wm([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const s=ov(r,n.document),i=n.removedTargetIds||[];t=new wm([],i,s,null)}else{if(!("filter"in e))return Wt(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:s=0,unchangedNames:i}=n,a=new Vte(s,i),o=n.targetId;t=new zL(o,a)}}return t}function tre(r,e){let t;if(e instanceof Yg)t={update:bE(r,e.key,e.value)};else if(e instanceof ly)t={delete:Y1(r,e.key)};else if(e instanceof MA)t={update:bE(r,e.key,e.data),updateMask:Are(e.fieldMask)};else{if(!(e instanceof Qte))return Wt(16599,{Vt:e.type});t={verify:Y1(r,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((n=>(function(i,a){const o=a.transform;if(o instanceof Ig)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof Tg)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof Fg)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof pb)return{fieldPath:a.field.canonicalString(),increment:o.Ae};throw Wt(20930,{transform:a.transform})})(0,n)))),e.precondition.isNone||(t.currentDocument=(function(s,i){return i.updateTime!==void 0?{updateTime:Jte(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:Wt(27497)})(r,e.precondition)),t}function rre(r,e){return r&&r.length>0?(Xr(e!==void 0,14353),r.map((t=>(function(s,i){let a=s.updateTime?rl(s.updateTime):rl(i);return a.isEqual(rr.min())&&(a=rl(i)),new Dte(a,s.transformResults||[])})(t,e)))):[]}function nre(r,e){return{documents:[YL(r,e.path)]}}function sre(r,e){const t={structuredQuery:{}},n=e.path;let s;e.collectionGroup!==null?(s=n,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=n.popLast(),t.structuredQuery.from=[{collectionId:n.lastSegment()}]),t.parent=YL(r,s);const i=(function(c){if(c.length!==0)return ZL(vo.create(c,"and"))})(e.filters);i&&(t.structuredQuery.where=i);const a=(function(c){if(c.length!==0)return c.map((A=>(function(h){return{field:Iu(h.field),direction:ore(h.dir)}})(A)))})(e.orderBy);a&&(t.structuredQuery.orderBy=a);const o=q1(r,e.limit);return o!==null&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt=(function(c){return{before:c.inclusive,values:c.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(c){return{before:!c.inclusive,values:c.position}})(e.endAt)),{ft:t,parent:s}}function ire(r){let e=Zte(r.parent);const t=r.structuredQuery,n=t.from?t.from.length:0;let s=null;if(n>0){Xr(n===1,65062);const A=t.from[0];A.allDescendants?s=A.collectionId:e=e.child(A.collectionId)}let i=[];t.where&&(i=(function(d){const h=JL(d);return h instanceof vo&&EL(h)?h.getFilters():[h]})(t.where));let a=[];t.orderBy&&(a=(function(d){return d.map((h=>(function(p){return new Eg(Tu(p.field),(function(g){switch(g){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(p.direction))})(h)))})(t.orderBy));let o=null;t.limit&&(o=(function(d){let h;return h=typeof d=="object"?d.value:d,ry(h)?null:h})(t.limit));let l=null;t.startAt&&(l=(function(d){const h=!!d.before,u=d.values||[];return new fb(u,h)})(t.startAt));let c=null;return t.endAt&&(c=(function(d){const h=!d.before,u=d.values||[];return new fb(u,h)})(t.endAt)),_te(e,s,a,i,o,"F",l,c)}function are(r,e){const t=(function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Wt(28987,{purpose:s})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function JL(r){return r.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const n=Tu(t.unaryFilter.field);return ys.create(n,"==",{doubleValue:NaN});case"IS_NULL":const s=Tu(t.unaryFilter.field);return ys.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Tu(t.unaryFilter.field);return ys.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Tu(t.unaryFilter.field);return ys.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Wt(61313);default:return Wt(60726)}})(r):r.fieldFilter!==void 0?(function(t){return ys.create(Tu(t.fieldFilter.field),(function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Wt(58110);default:return Wt(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(r):r.compositeFilter!==void 0?(function(t){return vo.create(t.compositeFilter.filters.map((n=>JL(n))),(function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Wt(1026)}})(t.compositeFilter.op))})(r):Wt(30097,{filter:r})}function ore(r){return qte[r]}function lre(r){return Wte[r]}function cre(r){return Yte[r]}function Iu(r){return{fieldPath:r.canonicalString()}}function Tu(r){return zs.fromServerFormat(r.fieldPath)}function ZL(r){return r instanceof ys?(function(t){if(t.op==="=="){if(iE(t.value))return{unaryFilter:{field:Iu(t.field),op:"IS_NAN"}};if(sE(t.value))return{unaryFilter:{field:Iu(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(iE(t.value))return{unaryFilter:{field:Iu(t.field),op:"IS_NOT_NAN"}};if(sE(t.value))return{unaryFilter:{field:Iu(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Iu(t.field),op:lre(t.op),value:t.value}}})(r):r instanceof vo?(function(t){const n=t.getFilters().map((s=>ZL(s)));return n.length===1?n[0]:{compositeFilter:{op:cre(t.op),filters:n}}})(r):Wt(54877,{filter:r})}function Are(r){const e=[];return r.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function eU(r){return r.length>=4&&r.get(0)==="projects"&&r.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tA{constructor(e,t,n,s,i=rr.min(),a=rr.min(),o=Ys.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new tA(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new tA(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new tA(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new tA(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dre{constructor(e){this.yt=e}}function ure(r){const e=ire({parent:r.parent,structuredQuery:r.structuredQuery});return r.limitType==="LAST"?gb(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hre{constructor(){this.Cn=new fre}addToCollectionParentIndex(e,t){return this.Cn.add(t),We.resolve()}getCollectionParents(e,t){return We.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return We.resolve()}deleteFieldIndex(e,t){return We.resolve()}deleteAllFieldIndexes(e){return We.resolve()}createTargetIndexes(e,t){return We.resolve()}getDocumentsMatchingTarget(e,t){return We.resolve(null)}getIndexType(e,t){return We.resolve(0)}getFieldIndexes(e,t){return We.resolve([])}getNextCollectionGroupToUpdate(e){return We.resolve(null)}getMinOffset(e,t){return We.resolve(vA.min())}getMinOffsetFromCollectionGroup(e,t){return We.resolve(vA.min())}updateCollectionGroup(e,t,n){return We.resolve()}updateIndexEntries(e,t){return We.resolve()}}class fre{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),s=this.index[t]||new Ns(vn.comparator),i=!s.has(n);return this.index[t]=s.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),s=this.index[t];return s&&s.has(n)}getEntries(e){return(this.index[e]||new Ns(vn.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yE={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},tU=41943040;class sa{static withCacheSize(e){return new sa(e,sa.DEFAULT_COLLECTION_PERCENTILE,sa.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */sa.DEFAULT_COLLECTION_PERCENTILE=10,sa.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,sa.DEFAULT=new sa(tU,sa.DEFAULT_COLLECTION_PERCENTILE,sa.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),sa.DISABLED=new sa(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dh{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new dh(0)}static cr(){return new dh(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wE="LruGarbageCollector",gre=1048576;function vE([r,e],[t,n]){const s=Ir(r,t);return s===0?Ir(e,n):s}class pre{constructor(e){this.Ir=e,this.buffer=new Ns(vE),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const n=this.buffer.last();vE(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}}class mre{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){bt(wE,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){kh(t)?bt(wE,"Ignoring IndexedDB error during garbage collection: ",t):await Sh(t)}await this.Vr(3e5)}))}}class bre{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((n=>Math.floor(t/100*n)))}nthSequenceNumber(e,t){if(t===0)return We.resolve(ty.ce);const n=new pre(t);return this.mr.forEachTarget(e,(s=>n.Ar(s.sequenceNumber))).next((()=>this.mr.pr(e,(s=>n.Ar(s))))).next((()=>n.maxValue))}removeTargets(e,t,n){return this.mr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(bt("LruGarbageCollector","Garbage collection skipped; disabled"),We.resolve(yE)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(bt("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),yE):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let n,s,i,a,o,l,c;const A=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((d=>(d>this.params.maximumSequenceNumbersToCollect?(bt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),s=this.params.maximumSequenceNumbersToCollect):s=d,a=Date.now(),this.nthSequenceNumber(e,s)))).next((d=>(n=d,o=Date.now(),this.removeTargets(e,n,t)))).next((d=>(i=d,l=Date.now(),this.removeOrphanedDocuments(e,n)))).next((d=>(c=Date.now(),ku()<=Er.DEBUG&&bt("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-A}ms
	Determined least recently used ${s} in `+(o-a)+`ms
	Removed ${i} targets in `+(l-o)+`ms
	Removed ${d} documents in `+(c-l)+`ms
Total Duration: ${c-A}ms`),We.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:d}))))}}function yre(r,e){return new bre(r,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wre{constructor(){this.changes=new Jd((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ei.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return n!==void 0?We.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vre{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xre{constructor(e,t,n,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=s}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((s=>(n=s,this.remoteDocumentCache.getEntry(e,t)))).next((s=>(n!==null&&ig(n.mutation,s,Fa.empty(),xn.now()),s)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((n=>this.getLocalViewOfDocuments(e,n,Tr()).next((()=>n))))}getLocalViewOfDocuments(e,t,n=Tr()){const s=fd();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,n).next((i=>{let a=kf();return i.forEach(((o,l)=>{a=a.insert(o,l.overlayedDocument)})),a}))))}getOverlayedDocuments(e,t){const n=fd();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,Tr())))}populateOverlays(e,t,n){const s=[];return n.forEach((i=>{t.has(i)||s.push(i)})),this.documentOverlayCache.getOverlays(e,s).next((i=>{i.forEach(((a,o)=>{t.set(a,o)}))}))}computeViews(e,t,n,s){let i=ic();const a=sg(),o=(function(){return sg()})();return t.forEach(((l,c)=>{const A=n.get(c.key);s.has(c.key)&&(A===void 0||A.mutation instanceof MA)?i=i.insert(c.key,c):A!==void 0?(a.set(c.key,A.mutation.getFieldMask()),ig(A.mutation,c,A.mutation.getFieldMask(),xn.now())):a.set(c.key,Fa.empty())})),this.recalculateAndSaveOverlays(e,i).next((l=>(l.forEach(((c,A)=>a.set(c,A))),t.forEach(((c,A)=>o.set(c,new vre(A,a.get(c)??null)))),o)))}recalculateAndSaveOverlays(e,t){const n=sg();let s=new On(((a,o)=>a-o)),i=Tr();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((a=>{for(const o of a)o.keys().forEach((l=>{const c=t.get(l);if(c===null)return;let A=n.get(l)||Fa.empty();A=o.applyToLocalView(c,A),n.set(l,A);const d=(s.get(o.batchId)||Tr()).add(l);s=s.insert(o.batchId,d)}))})).next((()=>{const a=[],o=s.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),c=l.key,A=l.value,d=DL();A.forEach((h=>{if(!i.has(h)){const u=VL(t.get(h),n.get(h));u!==null&&d.set(h,u),i=i.add(h)}})),a.push(this.documentOverlayCache.saveOverlays(e,c,d))}return We.waitFor(a)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((n=>this.recalculateAndSaveOverlays(e,n)))}getDocumentsMatchingQuery(e,t,n,s){return(function(a){return Qt.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):LL(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,s):this.getDocumentsMatchingCollectionQuery(e,t,n,s)}getNextDocuments(e,t,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,s).next((i=>{const a=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,s-i.size):We.resolve(fd());let o=Cg,l=i;return a.next((c=>We.forEach(c,((A,d)=>(o<d.largestBatchId&&(o=d.largestBatchId),i.get(A)?We.resolve():this.remoteDocumentCache.getEntry(e,A).next((h=>{l=l.insert(A,h)}))))).next((()=>this.populateOverlays(e,c,i))).next((()=>this.computeViews(e,l,c,Tr()))).next((A=>({batchId:o,changes:PL(A)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Qt(t)).next((n=>{let s=kf();return n.isFoundDocument()&&(s=s.insert(n.key,n)),s}))}getDocumentsMatchingCollectionGroupQuery(e,t,n,s){const i=t.collectionGroup;let a=kf();return this.indexManager.getCollectionParents(e,i).next((o=>We.forEach(o,(l=>{const c=(function(d,h){return new Eh(h,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)})(t,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,c,n,s).next((A=>{A.forEach(((d,h)=>{a=a.insert(d,h)}))}))})).next((()=>a))))}getDocumentsMatchingCollectionQuery(e,t,n,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i,s)))).next((a=>{i.forEach(((l,c)=>{const A=c.getKey();a.get(A)===null&&(a=a.insert(A,Ei.newInvalidDocument(A)))}));let o=kf();return a.forEach(((l,c)=>{const A=i.get(l);A!==void 0&&ig(A.mutation,c,Fa.empty(),xn.now()),iy(t,c)&&(o=o.insert(l,c))})),o}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _re{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return We.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(s){return{id:s.id,version:s.version,createTime:rl(s.createTime)}})(t)),We.resolve()}getNamedQuery(e,t){return We.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(s){return{name:s.name,query:ure(s.bundledQuery),readTime:rl(s.readTime)}})(t)),We.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bre{constructor(){this.overlays=new On(Qt.comparator),this.qr=new Map}getOverlay(e,t){return We.resolve(this.overlays.get(t))}getOverlays(e,t){const n=fd();return We.forEach(t,(s=>this.getOverlay(e,s).next((i=>{i!==null&&n.set(s,i)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((s,i)=>{this.St(e,t,i)})),We.resolve()}removeOverlaysForBatchId(e,t,n){const s=this.qr.get(n);return s!==void 0&&(s.forEach((i=>this.overlays=this.overlays.remove(i))),this.qr.delete(n)),We.resolve()}getOverlaysForCollection(e,t,n){const s=fd(),i=t.length+1,a=new Qt(t.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,c=l.getKey();if(!t.isPrefixOf(c.path))break;c.path.length===i&&l.largestBatchId>n&&s.set(l.getKey(),l)}return We.resolve(s)}getOverlaysForCollectionGroup(e,t,n,s){let i=new On(((c,A)=>c-A));const a=this.overlays.getIterator();for(;a.hasNext();){const c=a.getNext().value;if(c.getKey().getCollectionGroup()===t&&c.largestBatchId>n){let A=i.get(c.largestBatchId);A===null&&(A=fd(),i=i.insert(c.largestBatchId,A)),A.set(c.getKey(),c)}}const o=fd(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach(((c,A)=>o.set(c,A))),!(o.size()>=s)););return We.resolve(o)}St(e,t,n){const s=this.overlays.get(n.key);if(s!==null){const a=this.qr.get(s.largestBatchId).delete(n.key);this.qr.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new jte(t,n));let i=this.qr.get(t);i===void 0&&(i=Tr(),this.qr.set(t,i)),this.qr.set(t,i.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cre{constructor(){this.sessionToken=Ys.EMPTY_BYTE_STRING}getSessionToken(e){return We.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,We.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E2{constructor(){this.Qr=new Ns($s.$r),this.Ur=new Ns($s.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const n=new $s(e,t);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,t){e.forEach((n=>this.addReference(n,t)))}removeReference(e,t){this.Gr(new $s(e,t))}zr(e,t){e.forEach((n=>this.removeReference(n,t)))}jr(e){const t=new Qt(new vn([])),n=new $s(t,e),s=new $s(t,e+1),i=[];return this.Ur.forEachInRange([n,s],(a=>{this.Gr(a),i.push(a.key)})),i}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Qt(new vn([])),n=new $s(t,e),s=new $s(t,e+1);let i=Tr();return this.Ur.forEachInRange([n,s],(a=>{i=i.add(a.key)})),i}containsKey(e){const t=new $s(e,0),n=this.Qr.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}}class $s{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Qt.comparator(e.key,t.key)||Ir(e.Yr,t.Yr)}static Kr(e,t){return Ir(e.Yr,t.Yr)||Qt.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sre{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Ns($s.$r)}checkEmpty(e){return We.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new Hte(i,t,n,s);this.mutationQueue.push(a);for(const o of s)this.Zr=this.Zr.add(new $s(o.key,i)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return We.resolve(a)}lookupMutationBatch(e,t){return We.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,s=this.ei(n),i=s<0?0:s;return We.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return We.resolve(this.mutationQueue.length===0?b2:this.tr-1)}getAllMutationBatches(e){return We.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new $s(t,0),s=new $s(t,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([n,s],(a=>{const o=this.Xr(a.Yr);i.push(o)})),We.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Ns(Ir);return t.forEach((s=>{const i=new $s(s,0),a=new $s(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,a],(o=>{n=n.add(o.Yr)}))})),We.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,s=n.length+1;let i=n;Qt.isDocumentKey(i)||(i=i.child(""));const a=new $s(new Qt(i),0);let o=new Ns(Ir);return this.Zr.forEachWhile((l=>{const c=l.key.path;return!!n.isPrefixOf(c)&&(c.length===s&&(o=o.add(l.Yr)),!0)}),a),We.resolve(this.ti(o))}ti(e){const t=[];return e.forEach((n=>{const s=this.Xr(n);s!==null&&t.push(s)})),t}removeMutationBatch(e,t){Xr(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return We.forEach(t.mutations,(s=>{const i=new $s(s.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)})).next((()=>{this.Zr=n}))}ir(e){}containsKey(e,t){const n=new $s(t,0),s=this.Zr.firstAfterOrEqual(n);return We.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,We.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kre{constructor(e){this.ri=e,this.docs=(function(){return new On(Qt.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,s=this.docs.get(n),i=s?s.size:0,a=this.ri(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return We.resolve(n?n.document.mutableCopy():Ei.newInvalidDocument(t))}getEntries(e,t){let n=ic();return t.forEach((s=>{const i=this.docs.get(s);n=n.insert(s,i?i.document.mutableCopy():Ei.newInvalidDocument(s))})),We.resolve(n)}getDocumentsMatchingQuery(e,t,n,s){let i=ic();const a=t.path,o=new Qt(a.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:c,value:{document:A}}=l.getNext();if(!a.isPrefixOf(c.path))break;c.path.length>a.length+1||tte(ete(A),n)<=0||(s.has(A.key)||iy(t,A))&&(i=i.insert(A.key,A.mutableCopy()))}return We.resolve(i)}getAllFromCollectionGroup(e,t,n,s){Wt(9500)}ii(e,t){return We.forEach(this.docs,(n=>t(n)))}newChangeBuffer(e){return new Ere(this)}getSize(e){return We.resolve(this.size)}}class Ere extends wre{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((n,s)=>{s.isValidDocument()?t.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(n)})),We.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ire{constructor(e){this.persistence=e,this.si=new Jd((t=>v2(t)),x2),this.lastRemoteSnapshotVersion=rr.min(),this.highestTargetId=0,this.oi=0,this._i=new E2,this.targetCount=0,this.ai=dh.ur()}forEachTarget(e,t){return this.si.forEach(((n,s)=>t(s))),We.resolve()}getLastRemoteSnapshotVersion(e){return We.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return We.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),We.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.oi&&(this.oi=t),We.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new dh(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,We.resolve()}updateTargetData(e,t){return this.Pr(t),We.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,We.resolve()}removeTargets(e,t,n){let s=0;const i=[];return this.si.forEach(((a,o)=>{o.sequenceNumber<=t&&n.get(o.targetId)===null&&(this.si.delete(a),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),s++)})),We.waitFor(i).next((()=>s))}getTargetCount(e){return We.resolve(this.targetCount)}getTargetData(e,t){const n=this.si.get(t)||null;return We.resolve(n)}addMatchingKeys(e,t,n){return this._i.Wr(t,n),We.resolve()}removeMatchingKeys(e,t,n){this._i.zr(t,n);const s=this.persistence.referenceDelegate,i=[];return s&&t.forEach((a=>{i.push(s.markPotentiallyOrphaned(e,a))})),We.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),We.resolve()}getMatchingKeysForTargetId(e,t){const n=this._i.Hr(t);return We.resolve(n)}containsKey(e,t){return We.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rU{constructor(e,t){this.ui={},this.overlays={},this.ci=new ty(0),this.li=!1,this.li=!0,this.hi=new Cre,this.referenceDelegate=e(this),this.Pi=new Ire(this),this.indexManager=new hre,this.remoteDocumentCache=(function(s){return new kre(s)})((n=>this.referenceDelegate.Ti(n))),this.serializer=new dre(t),this.Ii=new _re(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Bre,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ui[e.toKey()];return n||(n=new Sre(t,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,n){bt("MemoryPersistence","Starting transaction:",e);const s=new Tre(this.ci.next());return this.referenceDelegate.Ei(),n(s).next((i=>this.referenceDelegate.di(s).next((()=>i)))).toPromise().then((i=>(s.raiseOnCommittedEvent(),i)))}Ai(e,t){return We.or(Object.values(this.ui).map((n=>()=>n.containsKey(e,t))))}}class Tre extends nte{constructor(e){super(),this.currentSequenceNumber=e}}class I2{constructor(e){this.persistence=e,this.Ri=new E2,this.Vi=null}static mi(e){return new I2(e)}get fi(){if(this.Vi)return this.Vi;throw Wt(60996)}addReference(e,t,n){return this.Ri.addReference(n,t),this.fi.delete(n.toString()),We.resolve()}removeReference(e,t,n){return this.Ri.removeReference(n,t),this.fi.add(n.toString()),We.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),We.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((s=>this.fi.add(s.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((s=>{s.forEach((i=>this.fi.add(i.toString())))})).next((()=>n.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return We.forEach(this.fi,(n=>{const s=Qt.fromPath(n);return this.gi(e,s).next((i=>{i||t.removeEntry(s,rr.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((n=>{n?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return We.or([()=>We.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class bb{constructor(e,t){this.persistence=e,this.pi=new Jd((n=>ate(n.path)),((n,s)=>n.isEqual(s))),this.garbageCollector=yre(this,t)}static mi(e,t){return new bb(e,t)}Ei(){}di(e){return We.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((n=>t.next((s=>n+s))))}wr(e){let t=0;return this.pr(e,(n=>{t++})).next((()=>t))}pr(e,t){return We.forEach(this.pi,((n,s)=>this.br(e,n,s).next((i=>i?We.resolve():t(s)))))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,(a=>this.br(e,a,t).next((o=>{o||(n++,i.removeEntry(a,rr.min()))})))).next((()=>i.apply(e))).next((()=>n))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),We.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),We.resolve()}removeReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),We.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),We.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=mm(e.data.value)),t}br(e,t,n){return We.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const s=this.pi.get(t);return We.resolve(s!==void 0&&s>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T2{constructor(e,t,n,s){this.targetId=e,this.fromCache=t,this.Es=n,this.ds=s}static As(e,t){let n=Tr(),s=Tr();for(const i of t.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new T2(e,t.fromCache,n,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fre{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lre{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return AX()?8:ste(Ui())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,n,s){const i={result:null};return this.ys(e,t).next((a=>{i.result=a})).next((()=>{if(!i.result)return this.ws(e,t,s,n).next((a=>{i.result=a}))})).next((()=>{if(i.result)return;const a=new Fre;return this.Ss(e,t,a).next((o=>{if(i.result=o,this.Vs)return this.bs(e,t,a,o.size)}))})).next((()=>i.result))}bs(e,t,n,s){return n.documentReadCount<this.fs?(ku()<=Er.DEBUG&&bt("QueryEngine","SDK will not create cache indexes for query:",Eu(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),We.resolve()):(ku()<=Er.DEBUG&&bt("QueryEngine","Query:",Eu(t),"scans",n.documentReadCount,"local documents and returns",s,"documents as results."),n.documentReadCount>this.gs*s?(ku()<=Er.DEBUG&&bt("QueryEngine","The SDK decides to create cache indexes for query:",Eu(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,tl(t))):We.resolve())}ys(e,t){if(cE(t))return We.resolve(null);let n=tl(t);return this.indexManager.getIndexType(e,n).next((s=>s===0?null:(t.limit!==null&&s===1&&(t=gb(t,null,"F"),n=tl(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((i=>{const a=Tr(...i);return this.ps.getDocuments(e,a).next((o=>this.indexManager.getMinOffset(e,n).next((l=>{const c=this.Ds(t,o);return this.Cs(t,c,a,l.readTime)?this.ys(e,gb(t,null,"F")):this.vs(e,c,t,l)}))))})))))}ws(e,t,n,s){return cE(t)||s.isEqual(rr.min())?We.resolve(null):this.ps.getDocuments(e,n).next((i=>{const a=this.Ds(t,i);return this.Cs(t,a,n,s)?We.resolve(null):(ku()<=Er.DEBUG&&bt("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Eu(t)),this.vs(e,a,t,Zee(s,Cg)).next((o=>o)))}))}Ds(e,t){let n=new Ns(ML(e));return t.forEach(((s,i)=>{iy(e,i)&&(n=n.add(i))})),n}Cs(e,t,n,s){if(e.limit===null)return!1;if(n.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,t,n){return ku()<=Er.DEBUG&&bt("QueryEngine","Using full collection scan to execute query:",Eu(t)),this.ps.getDocumentsMatchingQuery(e,t,vA.min(),n)}vs(e,t,n,s){return this.ps.getDocumentsMatchingQuery(e,n,s).next((i=>(t.forEach((a=>{i=i.insert(a.key,a)})),i)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F2="LocalStore",Ure=3e8;class Mre{constructor(e,t,n,s){this.persistence=e,this.Fs=t,this.serializer=s,this.Ms=new On(Ir),this.xs=new Jd((i=>v2(i)),x2),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new xre(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function Nre(r,e,t,n){return new Mre(r,e,t,n)}async function nU(r,e){const t=cr(r);return await t.persistence.runTransaction("Handle user change","readonly",(n=>{let s;return t.mutationQueue.getAllMutationBatches(n).next((i=>(s=i,t.Bs(e),t.mutationQueue.getAllMutationBatches(n)))).next((i=>{const a=[],o=[];let l=Tr();for(const c of s){a.push(c.batchId);for(const A of c.mutations)l=l.add(A.key)}for(const c of i){o.push(c.batchId);for(const A of c.mutations)l=l.add(A.key)}return t.localDocuments.getDocuments(n,l).next((c=>({Ls:c,removedBatchIds:a,addedBatchIds:o})))}))}))}function Pre(r,e){const t=cr(r);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(n=>{const s=e.batch.keys(),i=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(o,l,c,A){const d=c.batch,h=d.keys();let u=We.resolve();return h.forEach((p=>{u=u.next((()=>A.getEntry(l,p))).next((f=>{const g=c.docVersions.get(p);Xr(g!==null,48541),f.version.compareTo(g)<0&&(d.applyToRemoteDocument(f,c),f.isValidDocument()&&(f.setReadTime(c.commitVersion),A.addEntry(f)))}))})),u.next((()=>o.mutationQueue.removeMutationBatch(l,d)))})(t,n,e,i).next((()=>i.apply(n))).next((()=>t.mutationQueue.performConsistencyCheck(n))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(n,s,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,(function(o){let l=Tr();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(l=l.add(o.batch.mutations[c].key));return l})(e)))).next((()=>t.localDocuments.getDocuments(n,s)))}))}function sU(r){const e=cr(r);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function Dre(r,e){const t=cr(r),n=e.snapshotVersion;let s=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(i=>{const a=t.Ns.newChangeBuffer({trackRemovals:!0});s=t.Ms;const o=[];e.targetChanges.forEach(((A,d)=>{const h=s.get(d);if(!h)return;o.push(t.Pi.removeMatchingKeys(i,A.removedDocuments,d).next((()=>t.Pi.addMatchingKeys(i,A.addedDocuments,d))));let u=h.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(d)!==null?u=u.withResumeToken(Ys.EMPTY_BYTE_STRING,rr.min()).withLastLimboFreeSnapshotVersion(rr.min()):A.resumeToken.approximateByteSize()>0&&(u=u.withResumeToken(A.resumeToken,n)),s=s.insert(d,u),(function(f,g,m){return f.resumeToken.approximateByteSize()===0||g.snapshotVersion.toMicroseconds()-f.snapshotVersion.toMicroseconds()>=Ure?!0:m.addedDocuments.size+m.modifiedDocuments.size+m.removedDocuments.size>0})(h,u,A)&&o.push(t.Pi.updateTargetData(i,u))}));let l=ic(),c=Tr();if(e.documentUpdates.forEach((A=>{e.resolvedLimboDocuments.has(A)&&o.push(t.persistence.referenceDelegate.updateLimboDocument(i,A))})),o.push(Rre(i,a,e.documentUpdates).next((A=>{l=A.ks,c=A.qs}))),!n.isEqual(rr.min())){const A=t.Pi.getLastRemoteSnapshotVersion(i).next((d=>t.Pi.setTargetsMetadata(i,i.currentSequenceNumber,n)));o.push(A)}return We.waitFor(o).next((()=>a.apply(i))).next((()=>t.localDocuments.getLocalViewOfDocuments(i,l,c))).next((()=>l))})).then((i=>(t.Ms=s,i)))}function Rre(r,e,t){let n=Tr(),s=Tr();return t.forEach((i=>n=n.add(i))),e.getEntries(r,n).next((i=>{let a=ic();return t.forEach(((o,l)=>{const c=i.get(o);l.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(o)),l.isNoDocument()&&l.version.isEqual(rr.min())?(e.removeEntry(o,l.readTime),a=a.insert(o,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),a=a.insert(o,l)):bt(F2,"Ignoring outdated watch update for ",o,". Current version:",c.version," Watch version:",l.version)})),{ks:a,qs:s}}))}function Ore(r,e){const t=cr(r);return t.persistence.runTransaction("Get next mutation batch","readonly",(n=>(e===void 0&&(e=b2),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e))))}function Qre(r,e){const t=cr(r);return t.persistence.runTransaction("Allocate target","readwrite",(n=>{let s;return t.Pi.getTargetData(n,e).next((i=>i?(s=i,We.resolve(s)):t.Pi.allocateTargetId(n).next((a=>(s=new tA(e,a,"TargetPurposeListen",n.currentSequenceNumber),t.Pi.addTargetData(n,s).next((()=>s)))))))})).then((n=>{const s=t.Ms.get(n.targetId);return(s===null||n.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(n.targetId,n),t.xs.set(e,n.targetId)),n}))}async function J1(r,e,t){const n=cr(r),s=n.Ms.get(e),i=t?"readwrite":"readwrite-primary";try{t||await n.persistence.runTransaction("Release target",i,(a=>n.persistence.referenceDelegate.removeTarget(a,s)))}catch(a){if(!kh(a))throw a;bt(F2,`Failed to update sequence numbers for target ${e}: ${a}`)}n.Ms=n.Ms.remove(e),n.xs.delete(s.target)}function xE(r,e,t){const n=cr(r);let s=rr.min(),i=Tr();return n.persistence.runTransaction("Execute query","readwrite",(a=>(function(l,c,A){const d=cr(l),h=d.xs.get(A);return h!==void 0?We.resolve(d.Ms.get(h)):d.Pi.getTargetData(c,A)})(n,a,tl(e)).next((o=>{if(o)return s=o.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(a,o.targetId).next((l=>{i=l}))})).next((()=>n.Fs.getDocumentsMatchingQuery(a,e,t?s:rr.min(),t?i:Tr()))).next((o=>(Hre(n,Cte(e),o),{documents:o,Qs:i})))))}function Hre(r,e,t){let n=r.Os.get(e)||rr.min();t.forEach(((s,i)=>{i.readTime.compareTo(n)>0&&(n=i.readTime)})),r.Os.set(e,n)}class _E{constructor(){this.activeTargetIds=Fte()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class jre{constructor(){this.Mo=new _E,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,n){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new _E,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vre{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BE="ConnectivityMonitor";class CE{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){bt(BE,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){bt(BE,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let R0=null;function Z1(){return R0===null?R0=(function(){return 268435456+Math.round(2147483648*Math.random())})():R0++,"0x"+R0.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lv="RestConnection",$re={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Gre{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${n}/databases/${s}`,this.Wo=this.databaseId.database===ub?`project_id=${n}`:`project_id=${n}&database_id=${s}`}Go(e,t,n,s,i){const a=Z1(),o=this.zo(e,t.toUriEncodedString());bt(lv,`Sending RPC '${e}' ${a}:`,o,n);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,s,i);const{host:c}=new URL(o),A=xh(c);return this.Jo(e,o,l,n,A).then((d=>(bt(lv,`Received RPC '${e}' ${a}: `,d),d)),(d=>{throw Qd(lv,`RPC '${e}' ${a} failed with error: `,d,"url: ",o,"request:",n),d}))}Ho(e,t,n,s,i,a){return this.Go(e,t,n,s,i)}jo(e,t,n){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Ch})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((s,i)=>e[i]=s)),n&&n.headers.forEach(((s,i)=>e[i]=s))}zo(e,t){const n=$re[e];return`${this.Uo}/v1/${t}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zre{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vi="WebChannelConnection";class Kre extends Gre{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,n,s,i){const a=Z1();return new Promise(((o,l)=>{const c=new iL;c.setWithCredentials(!0),c.listenOnce(aL.COMPLETE,(()=>{try{switch(c.getLastErrorCode()){case pm.NO_ERROR:const d=c.getResponseJson();bt(vi,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(d)),o(d);break;case pm.TIMEOUT:bt(vi,`RPC '${e}' ${a} timed out`),l(new ut(Ke.DEADLINE_EXCEEDED,"Request time out"));break;case pm.HTTP_ERROR:const h=c.getStatus();if(bt(vi,`RPC '${e}' ${a} failed with status:`,h,"response text:",c.getResponseText()),h>0){let u=c.getResponseJson();Array.isArray(u)&&(u=u[0]);const p=u==null?void 0:u.error;if(p&&p.status&&p.message){const f=(function(m){const x=m.toLowerCase().replace(/_/g,"-");return Object.values(Ke).indexOf(x)>=0?x:Ke.UNKNOWN})(p.status);l(new ut(f,p.message))}else l(new ut(Ke.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new ut(Ke.UNAVAILABLE,"Connection failed."));break;default:Wt(9055,{l_:e,streamId:a,h_:c.getLastErrorCode(),P_:c.getLastError()})}}finally{bt(vi,`RPC '${e}' ${a} completed.`)}}));const A=JSON.stringify(s);bt(vi,`RPC '${e}' ${a} sending request:`,s),c.send(t,"POST",A,n,15)}))}T_(e,t,n){const s=Z1(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=cL(),o=lL(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,t,n),l.encodeInitMessageHeaders=!0;const A=i.join("");bt(vi,`Creating RPC '${e}' stream ${s}: ${A}`,l);const d=a.createWebChannel(A,l);this.I_(d);let h=!1,u=!1;const p=new zre({Yo:g=>{u?bt(vi,`Not sending because RPC '${e}' stream ${s} is closed:`,g):(h||(bt(vi,`Opening RPC '${e}' stream ${s} transport.`),d.open(),h=!0),bt(vi,`RPC '${e}' stream ${s} sending:`,g),d.send(g))},Zo:()=>d.close()}),f=(g,m,x)=>{g.listen(m,(S=>{try{x(S)}catch(B){setTimeout((()=>{throw B}),0)}}))};return f(d,Sf.EventType.OPEN,(()=>{u||(bt(vi,`RPC '${e}' stream ${s} transport opened.`),p.o_())})),f(d,Sf.EventType.CLOSE,(()=>{u||(u=!0,bt(vi,`RPC '${e}' stream ${s} transport closed`),p.a_(),this.E_(d))})),f(d,Sf.EventType.ERROR,(g=>{u||(u=!0,Qd(vi,`RPC '${e}' stream ${s} transport errored. Name:`,g.name,"Message:",g.message),p.a_(new ut(Ke.UNAVAILABLE,"The operation could not be completed")))})),f(d,Sf.EventType.MESSAGE,(g=>{var m;if(!u){const x=g.data[0];Xr(!!x,16349);const S=x,B=(S==null?void 0:S.error)||((m=S[0])==null?void 0:m.error);if(B){bt(vi,`RPC '${e}' stream ${s} received error:`,B);const F=B.status;let N=(function(v){const I=ms[v];if(I!==void 0)return GL(I)})(F),E=B.message;N===void 0&&(N=Ke.INTERNAL,E="Unknown error status: "+F+" with message "+B.message),u=!0,p.a_(new ut(N,E)),d.close()}else bt(vi,`RPC '${e}' stream ${s} received:`,x),p.u_(x)}})),f(o,oL.STAT_EVENT,(g=>{g.stat===H1.PROXY?bt(vi,`RPC '${e}' stream ${s} detected buffering proxy`):g.stat===H1.NOPROXY&&bt(vi,`RPC '${e}' stream ${s} detected no buffering proxy`)})),setTimeout((()=>{p.__()}),0),p}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function cv(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ay(r){return new Xte(r,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iU{constructor(e,t,n=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=t,this.d_=n,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),s=Math.max(0,t-n);s>0&&bt("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SE="PersistentStream";class aU{constructor(e,t,n,s,i,a,o,l){this.Mi=e,this.S_=n,this.b_=s,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new iU(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===Ke.RESOURCE_EXHAUSTED?(sc(t.toString()),sc("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===Ke.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([n,s])=>{this.D_===t&&this.G_(n,s)}),(n=>{e((()=>{const s=new ut(Ke.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(s)}))}))}G_(e,t){const n=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{n((()=>this.listener.Xo()))})),this.stream.t_((()=>{n((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((s=>{n((()=>this.z_(s)))})),this.stream.onMessage((s=>{n((()=>++this.F_==1?this.J_(s):this.onNext(s)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return bt(SE,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(bt(SE,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class qre extends aU{constructor(e,t,n,s,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,s,a),this.serializer=i}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=ere(this.serializer,e),n=(function(i){if(!("targetChange"in i))return rr.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?rr.min():a.readTime?rl(a.readTime):rr.min()})(e);return this.listener.H_(t,n)}Y_(e){const t={};t.database=X1(this.serializer),t.addTarget=(function(i,a){let o;const l=a.target;if(o=z1(l)?{documents:nre(i,l)}:{query:sre(i,l).ft},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=qL(i,a.resumeToken);const c=q1(i,a.expectedCount);c!==null&&(o.expectedCount=c)}else if(a.snapshotVersion.compareTo(rr.min())>0){o.readTime=mb(i,a.snapshotVersion.toTimestamp());const c=q1(i,a.expectedCount);c!==null&&(o.expectedCount=c)}return o})(this.serializer,e);const n=are(this.serializer,e);n&&(t.labels=n),this.q_(t)}Z_(e){const t={};t.database=X1(this.serializer),t.removeTarget=e,this.q_(t)}}class Wre extends aU{constructor(e,t,n,s,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,s,a),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Xr(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Xr(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Xr(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=rre(e.writeResults,e.commitTime),n=rl(e.commitTime);return this.listener.na(n,t)}ra(){const e={};e.database=X1(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((n=>tre(this.serializer,n)))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yre{}class Xre extends Yre{constructor(e,t,n,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new ut(Ke.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,n,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,a])=>this.connection.Go(e,W1(t,n),s,i,a))).catch((i=>{throw i.name==="FirebaseError"?(i.code===Ke.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new ut(Ke.UNKNOWN,i.toString())}))}Ho(e,t,n,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,o])=>this.connection.Ho(e,W1(t,n),s,a,o,i))).catch((a=>{throw a.name==="FirebaseError"?(a.code===Ke.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new ut(Ke.UNKNOWN,a.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class Jre{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(sc(t),this.aa=!1):bt("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hd="RemoteStore";class Zre{constructor(e,t,n,s,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo((a=>{n.enqueueAndForget((async()=>{Zd(this)&&(bt(Hd,"Restarting streams for network reachability change."),await(async function(l){const c=cr(l);c.Ea.add(4),await Jg(c),c.Ra.set("Unknown"),c.Ea.delete(4),await dy(c)})(this))}))})),this.Ra=new Jre(n,s)}}async function dy(r){if(Zd(r))for(const e of r.da)await e(!0)}async function Jg(r){for(const e of r.da)await e(!1)}function oU(r,e){const t=cr(r);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),N2(t)?M2(t):Ih(t).O_()&&U2(t,e))}function L2(r,e){const t=cr(r),n=Ih(t);t.Ia.delete(e),n.O_()&&lU(t,e),t.Ia.size===0&&(n.O_()?n.L_():Zd(t)&&t.Ra.set("Unknown"))}function U2(r,e){if(r.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(rr.min())>0){const t=r.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Ih(r).Y_(e)}function lU(r,e){r.Va.Ue(e),Ih(r).Z_(e)}function M2(r){r.Va=new Kte({getRemoteKeysForTarget:e=>r.remoteSyncer.getRemoteKeysForTarget(e),At:e=>r.Ia.get(e)||null,ht:()=>r.datastore.serializer.databaseId}),Ih(r).start(),r.Ra.ua()}function N2(r){return Zd(r)&&!Ih(r).x_()&&r.Ia.size>0}function Zd(r){return cr(r).Ea.size===0}function cU(r){r.Va=void 0}async function ene(r){r.Ra.set("Online")}async function tne(r){r.Ia.forEach(((e,t)=>{U2(r,e)}))}async function rne(r,e){cU(r),N2(r)?(r.Ra.ha(e),M2(r)):r.Ra.set("Unknown")}async function nne(r,e,t){if(r.Ra.set("Online"),e instanceof KL&&e.state===2&&e.cause)try{await(async function(s,i){const a=i.cause;for(const o of i.targetIds)s.Ia.has(o)&&(await s.remoteSyncer.rejectListen(o,a),s.Ia.delete(o),s.Va.removeTarget(o))})(r,e)}catch(n){bt(Hd,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await yb(r,n)}else if(e instanceof wm?r.Va.Ze(e):e instanceof zL?r.Va.st(e):r.Va.tt(e),!t.isEqual(rr.min()))try{const n=await sU(r.localStore);t.compareTo(n)>=0&&await(function(i,a){const o=i.Va.Tt(a);return o.targetChanges.forEach(((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const A=i.Ia.get(c);A&&i.Ia.set(c,A.withResumeToken(l.resumeToken,a))}})),o.targetMismatches.forEach(((l,c)=>{const A=i.Ia.get(l);if(!A)return;i.Ia.set(l,A.withResumeToken(Ys.EMPTY_BYTE_STRING,A.snapshotVersion)),lU(i,l);const d=new tA(A.target,l,c,A.sequenceNumber);U2(i,d)})),i.remoteSyncer.applyRemoteEvent(o)})(r,t)}catch(n){bt(Hd,"Failed to raise snapshot:",n),await yb(r,n)}}async function yb(r,e,t){if(!kh(e))throw e;r.Ea.add(1),await Jg(r),r.Ra.set("Offline"),t||(t=()=>sU(r.localStore)),r.asyncQueue.enqueueRetryable((async()=>{bt(Hd,"Retrying IndexedDB access"),await t(),r.Ea.delete(1),await dy(r)}))}function AU(r,e){return e().catch((t=>yb(r,t,e)))}async function uy(r){const e=cr(r),t=CA(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:b2;for(;sne(e);)try{const s=await Ore(e.localStore,n);if(s===null){e.Ta.length===0&&t.L_();break}n=s.batchId,ine(e,s)}catch(s){await yb(e,s)}dU(e)&&uU(e)}function sne(r){return Zd(r)&&r.Ta.length<10}function ine(r,e){r.Ta.push(e);const t=CA(r);t.O_()&&t.X_&&t.ea(e.mutations)}function dU(r){return Zd(r)&&!CA(r).x_()&&r.Ta.length>0}function uU(r){CA(r).start()}async function ane(r){CA(r).ra()}async function one(r){const e=CA(r);for(const t of r.Ta)e.ea(t.mutations)}async function lne(r,e,t){const n=r.Ta.shift(),s=C2.from(n,e,t);await AU(r,(()=>r.remoteSyncer.applySuccessfulWrite(s))),await uy(r)}async function cne(r,e){e&&CA(r).X_&&await(async function(n,s){if((function(a){return $te(a)&&a!==Ke.ABORTED})(s.code)){const i=n.Ta.shift();CA(n).B_(),await AU(n,(()=>n.remoteSyncer.rejectFailedWrite(i.batchId,s))),await uy(n)}})(r,e),dU(r)&&uU(r)}async function kE(r,e){const t=cr(r);t.asyncQueue.verifyOperationInProgress(),bt(Hd,"RemoteStore received new credentials");const n=Zd(t);t.Ea.add(3),await Jg(t),n&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await dy(t)}async function Ane(r,e){const t=cr(r);e?(t.Ea.delete(2),await dy(t)):e||(t.Ea.add(2),await Jg(t),t.Ra.set("Unknown"))}function Ih(r){return r.ma||(r.ma=(function(t,n,s){const i=cr(t);return i.sa(),new qre(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)})(r.datastore,r.asyncQueue,{Xo:ene.bind(null,r),t_:tne.bind(null,r),r_:rne.bind(null,r),H_:nne.bind(null,r)}),r.da.push((async e=>{e?(r.ma.B_(),N2(r)?M2(r):r.Ra.set("Unknown")):(await r.ma.stop(),cU(r))}))),r.ma}function CA(r){return r.fa||(r.fa=(function(t,n,s){const i=cr(t);return i.sa(),new Wre(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)})(r.datastore,r.asyncQueue,{Xo:()=>Promise.resolve(),t_:ane.bind(null,r),r_:cne.bind(null,r),ta:one.bind(null,r),na:lne.bind(null,r)}),r.da.push((async e=>{e?(r.fa.B_(),await uy(r)):(await r.fa.stop(),r.Ta.length>0&&(bt(Hd,`Stopping write stream with ${r.Ta.length} pending writes`),r.Ta=[]))}))),r.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P2{constructor(e,t,n,s,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=s,this.removalCallback=i,this.deferred=new Xl,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((a=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,s,i){const a=Date.now()+n,o=new P2(e,t,a,s,i);return o.start(n),o}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ut(Ke.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function D2(r,e){if(sc("AsyncQueue",`${e}: ${r}`),kh(r))return new ut(Ke.UNAVAILABLE,`${e}: ${r}`);throw r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yu{static emptySet(e){return new Yu(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||Qt.comparator(t.key,n.key):(t,n)=>Qt.comparator(t.key,n.key),this.keyedMap=kf(),this.sortedSet=new On(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Yu)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=n.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const n=new Yu;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EE{constructor(){this.ga=new On(Qt.comparator)}track(e){const t=e.doc.key,n=this.ga.get(t);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(t,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(t):e.type===1&&n.type===2?this.ga=this.ga.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Wt(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,n)=>{e.push(n)})),e}}class uh{constructor(e,t,n,s,i,a,o,l,c){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,t,n,s,i){const a=[];return t.forEach((o=>{a.push({type:0,doc:o})})),new uh(e,t,Yu.emptySet(t),a,n,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&sy(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==n[s].type||!t[s].doc.isEqual(n[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dne{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class une{constructor(){this.queries=IE(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,n){const s=cr(t),i=s.queries;s.queries=IE(),i.forEach(((a,o)=>{for(const l of o.Sa)l.onError(n)}))})(this,new ut(Ke.ABORTED,"Firestore shutting down"))}}function IE(){return new Jd((r=>UL(r)),sy)}async function hU(r,e){const t=cr(r);let n=3;const s=e.query;let i=t.queries.get(s);i?!i.ba()&&e.Da()&&(n=2):(i=new dne,n=e.Da()?0:1);try{switch(n){case 0:i.wa=await t.onListen(s,!0);break;case 1:i.wa=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(a){const o=D2(a,`Initialization of query '${Eu(e.query)}' failed`);return void e.onError(o)}t.queries.set(s,i),i.Sa.push(e),e.va(t.onlineState),i.wa&&e.Fa(i.wa)&&R2(t)}async function fU(r,e){const t=cr(r),n=e.query;let s=3;const i=t.queries.get(n);if(i){const a=i.Sa.indexOf(e);a>=0&&(i.Sa.splice(a,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return t.queries.delete(n),t.onUnlisten(n,!0);case 1:return t.queries.delete(n),t.onUnlisten(n,!1);case 2:return t.onLastRemoteStoreUnlisten(n);default:return}}function hne(r,e){const t=cr(r);let n=!1;for(const s of e){const i=s.query,a=t.queries.get(i);if(a){for(const o of a.Sa)o.Fa(s)&&(n=!0);a.wa=s}}n&&R2(t)}function fne(r,e,t){const n=cr(r),s=n.queries.get(e);if(s)for(const i of s.Sa)i.onError(t);n.queries.delete(e)}function R2(r){r.Ca.forEach((e=>{e.next()}))}var ex,TE;(TE=ex||(ex={})).Ma="default",TE.Cache="cache";class gU{constructor(e,t,n){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const s of e.docChanges)s.type!==3&&n.push(s);e=new uh(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const n=t!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=uh.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==ex.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pU{constructor(e){this.key=e}}class mU{constructor(e){this.key=e}}class gne{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Tr(),this.mutatedKeys=Tr(),this.eu=ML(e),this.tu=new Yu(this.eu)}get nu(){return this.Ya}ru(e,t){const n=t?t.iu:new EE,s=t?t.tu:this.tu;let i=t?t.mutatedKeys:this.mutatedKeys,a=s,o=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal(((A,d)=>{const h=s.get(A),u=iy(this.query,d)?d:null,p=!!h&&this.mutatedKeys.has(h.key),f=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let g=!1;h&&u?h.data.isEqual(u.data)?p!==f&&(n.track({type:3,doc:u}),g=!0):this.su(h,u)||(n.track({type:2,doc:u}),g=!0,(l&&this.eu(u,l)>0||c&&this.eu(u,c)<0)&&(o=!0)):!h&&u?(n.track({type:0,doc:u}),g=!0):h&&!u&&(n.track({type:1,doc:h}),g=!0,(l||c)&&(o=!0)),g&&(u?(a=a.add(u),i=f?i.add(A):i.delete(A)):(a=a.delete(A),i=i.delete(A)))})),this.query.limit!==null)for(;a.size>this.query.limit;){const A=this.query.limitType==="F"?a.last():a.first();a=a.delete(A.key),i=i.delete(A.key),n.track({type:1,doc:A})}return{tu:a,iu:n,Cs:o,mutatedKeys:i}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort(((A,d)=>(function(u,p){const f=g=>{switch(g){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Wt(20277,{Rt:g})}};return f(u)-f(p)})(A.type,d.type)||this.eu(A.doc,d.doc))),this.ou(n),s=s??!1;const o=t&&!s?this._u():[],l=this.Xa.size===0&&this.current&&!s?1:0,c=l!==this.Za;return this.Za=l,a.length!==0||c?{snapshot:new uh(this.query,e.tu,i,a,e.mutatedKeys,l===0,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:o}:{au:o}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new EE,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Tr(),this.tu.forEach((n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))}));const t=[];return e.forEach((n=>{this.Xa.has(n)||t.push(new mU(n))})),this.Xa.forEach((n=>{e.has(n)||t.push(new pU(n))})),t}cu(e){this.Ya=e.Qs,this.Xa=Tr();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return uh.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const O2="SyncEngine";class pne{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class mne{constructor(e){this.key=e,this.hu=!1}}class bne{constructor(e,t,n,s,i,a){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new Jd((o=>UL(o)),sy),this.Iu=new Map,this.Eu=new Set,this.du=new On(Qt.comparator),this.Au=new Map,this.Ru=new E2,this.Vu={},this.mu=new Map,this.fu=dh.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function yne(r,e,t=!0){const n=_U(r);let s;const i=n.Tu.get(e);return i?(n.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await bU(n,e,t,!0),s}async function wne(r,e){const t=_U(r);await bU(t,e,!0,!1)}async function bU(r,e,t,n){const s=await Qre(r.localStore,tl(e)),i=s.targetId,a=r.sharedClientState.addLocalQueryTarget(i,t);let o;return n&&(o=await vne(r,e,i,a==="current",s.resumeToken)),r.isPrimaryClient&&t&&oU(r.remoteStore,s),o}async function vne(r,e,t,n,s){r.pu=(d,h,u)=>(async function(f,g,m,x){let S=g.view.ru(m);S.Cs&&(S=await xE(f.localStore,g.query,!1).then((({documents:E})=>g.view.ru(E,S))));const B=x&&x.targetChanges.get(g.targetId),F=x&&x.targetMismatches.get(g.targetId)!=null,N=g.view.applyChanges(S,f.isPrimaryClient,B,F);return LE(f,g.targetId,N.au),N.snapshot})(r,d,h,u);const i=await xE(r.localStore,e,!0),a=new gne(e,i.Qs),o=a.ru(i.documents),l=Xg.createSynthesizedTargetChangeForCurrentChange(t,n&&r.onlineState!=="Offline",s),c=a.applyChanges(o,r.isPrimaryClient,l);LE(r,t,c.au);const A=new pne(e,t,a);return r.Tu.set(e,A),r.Iu.has(t)?r.Iu.get(t).push(e):r.Iu.set(t,[e]),c.snapshot}async function xne(r,e,t){const n=cr(r),s=n.Tu.get(e),i=n.Iu.get(s.targetId);if(i.length>1)return n.Iu.set(s.targetId,i.filter((a=>!sy(a,e)))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await J1(n.localStore,s.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(s.targetId),t&&L2(n.remoteStore,s.targetId),tx(n,s.targetId)})).catch(Sh)):(tx(n,s.targetId),await J1(n.localStore,s.targetId,!0))}async function _ne(r,e){const t=cr(r),n=t.Tu.get(e),s=t.Iu.get(n.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(n.targetId),L2(t.remoteStore,n.targetId))}async function Bne(r,e,t){const n=Fne(r);try{const s=await(function(a,o){const l=cr(a),c=xn.now(),A=o.reduce(((u,p)=>u.add(p.key)),Tr());let d,h;return l.persistence.runTransaction("Locally write mutations","readwrite",(u=>{let p=ic(),f=Tr();return l.Ns.getEntries(u,A).next((g=>{p=g,p.forEach(((m,x)=>{x.isValidDocument()||(f=f.add(m))}))})).next((()=>l.localDocuments.getOverlayedDocuments(u,p))).next((g=>{d=g;const m=[];for(const x of o){const S=Ote(x,d.get(x.key).overlayedDocument);S!=null&&m.push(new MA(x.key,S,CL(S.value.mapValue),Hi.exists(!0)))}return l.mutationQueue.addMutationBatch(u,c,m,o)})).next((g=>{h=g;const m=g.applyToLocalDocumentSet(d,f);return l.documentOverlayCache.saveOverlays(u,g.batchId,m)}))})).then((()=>({batchId:h.batchId,changes:PL(d)})))})(n.localStore,e);n.sharedClientState.addPendingMutation(s.batchId),(function(a,o,l){let c=a.Vu[a.currentUser.toKey()];c||(c=new On(Ir)),c=c.insert(o,l),a.Vu[a.currentUser.toKey()]=c})(n,s.batchId,t),await Zg(n,s.changes),await uy(n.remoteStore)}catch(s){const i=D2(s,"Failed to persist write");t.reject(i)}}async function yU(r,e){const t=cr(r);try{const n=await Dre(t.localStore,e);e.targetChanges.forEach(((s,i)=>{const a=t.Au.get(i);a&&(Xr(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?a.hu=!0:s.modifiedDocuments.size>0?Xr(a.hu,14607):s.removedDocuments.size>0&&(Xr(a.hu,42227),a.hu=!1))})),await Zg(t,n,e)}catch(n){await Sh(n)}}function FE(r,e,t){const n=cr(r);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){const s=[];n.Tu.forEach(((i,a)=>{const o=a.view.va(e);o.snapshot&&s.push(o.snapshot)})),(function(a,o){const l=cr(a);l.onlineState=o;let c=!1;l.queries.forEach(((A,d)=>{for(const h of d.Sa)h.va(o)&&(c=!0)})),c&&R2(l)})(n.eventManager,e),s.length&&n.Pu.H_(s),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function Cne(r,e,t){const n=cr(r);n.sharedClientState.updateQueryState(e,"rejected",t);const s=n.Au.get(e),i=s&&s.key;if(i){let a=new On(Qt.comparator);a=a.insert(i,Ei.newNoDocument(i,rr.min()));const o=Tr().add(i),l=new cy(rr.min(),new Map,new On(Ir),a,o);await yU(n,l),n.du=n.du.remove(i),n.Au.delete(e),Q2(n)}else await J1(n.localStore,e,!1).then((()=>tx(n,e,t))).catch(Sh)}async function Sne(r,e){const t=cr(r),n=e.batch.batchId;try{const s=await Pre(t.localStore,e);vU(t,n,null),wU(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),await Zg(t,s)}catch(s){await Sh(s)}}async function kne(r,e,t){const n=cr(r);try{const s=await(function(a,o){const l=cr(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",(c=>{let A;return l.mutationQueue.lookupMutationBatch(c,o).next((d=>(Xr(d!==null,37113),A=d.keys(),l.mutationQueue.removeMutationBatch(c,d)))).next((()=>l.mutationQueue.performConsistencyCheck(c))).next((()=>l.documentOverlayCache.removeOverlaysForBatchId(c,A,o))).next((()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,A))).next((()=>l.localDocuments.getDocuments(c,A)))}))})(n.localStore,e);vU(n,e,t),wU(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),await Zg(n,s)}catch(s){await Sh(s)}}function wU(r,e){(r.mu.get(e)||[]).forEach((t=>{t.resolve()})),r.mu.delete(e)}function vU(r,e,t){const n=cr(r);let s=n.Vu[n.currentUser.toKey()];if(s){const i=s.get(e);i&&(t?i.reject(t):i.resolve(),s=s.remove(e)),n.Vu[n.currentUser.toKey()]=s}}function tx(r,e,t=null){r.sharedClientState.removeLocalQueryTarget(e);for(const n of r.Iu.get(e))r.Tu.delete(n),t&&r.Pu.yu(n,t);r.Iu.delete(e),r.isPrimaryClient&&r.Ru.jr(e).forEach((n=>{r.Ru.containsKey(n)||xU(r,n)}))}function xU(r,e){r.Eu.delete(e.path.canonicalString());const t=r.du.get(e);t!==null&&(L2(r.remoteStore,t),r.du=r.du.remove(e),r.Au.delete(t),Q2(r))}function LE(r,e,t){for(const n of t)n instanceof pU?(r.Ru.addReference(n.key,e),Ene(r,n)):n instanceof mU?(bt(O2,"Document no longer in limbo: "+n.key),r.Ru.removeReference(n.key,e),r.Ru.containsKey(n.key)||xU(r,n.key)):Wt(19791,{wu:n})}function Ene(r,e){const t=e.key,n=t.path.canonicalString();r.du.get(t)||r.Eu.has(n)||(bt(O2,"New document in limbo: "+t),r.Eu.add(n),Q2(r))}function Q2(r){for(;r.Eu.size>0&&r.du.size<r.maxConcurrentLimboResolutions;){const e=r.Eu.values().next().value;r.Eu.delete(e);const t=new Qt(vn.fromString(e)),n=r.fu.next();r.Au.set(n,new mne(t)),r.du=r.du.insert(t,n),oU(r.remoteStore,new tA(tl(_2(t.path)),n,"TargetPurposeLimboResolution",ty.ce))}}async function Zg(r,e,t){const n=cr(r),s=[],i=[],a=[];n.Tu.isEmpty()||(n.Tu.forEach(((o,l)=>{a.push(n.pu(l,e,t).then((c=>{var A;if((c||t)&&n.isPrimaryClient){const d=c?!c.fromCache:(A=t==null?void 0:t.targetChanges.get(l.targetId))==null?void 0:A.current;n.sharedClientState.updateQueryState(l.targetId,d?"current":"not-current")}if(c){s.push(c);const d=T2.As(l.targetId,c);i.push(d)}})))})),await Promise.all(a),n.Pu.H_(s),await(async function(l,c){const A=cr(l);try{await A.persistence.runTransaction("notifyLocalViewChanges","readwrite",(d=>We.forEach(c,(h=>We.forEach(h.Es,(u=>A.persistence.referenceDelegate.addReference(d,h.targetId,u))).next((()=>We.forEach(h.ds,(u=>A.persistence.referenceDelegate.removeReference(d,h.targetId,u)))))))))}catch(d){if(!kh(d))throw d;bt(F2,"Failed to update sequence numbers: "+d)}for(const d of c){const h=d.targetId;if(!d.fromCache){const u=A.Ms.get(h),p=u.snapshotVersion,f=u.withLastLimboFreeSnapshotVersion(p);A.Ms=A.Ms.insert(h,f)}}})(n.localStore,i))}async function Ine(r,e){const t=cr(r);if(!t.currentUser.isEqual(e)){bt(O2,"User change. New user:",e.toKey());const n=await nU(t.localStore,e);t.currentUser=e,(function(i,a){i.mu.forEach((o=>{o.forEach((l=>{l.reject(new ut(Ke.CANCELLED,a))}))})),i.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Zg(t,n.Ls)}}function Tne(r,e){const t=cr(r),n=t.Au.get(e);if(n&&n.hu)return Tr().add(n.key);{let s=Tr();const i=t.Iu.get(e);if(!i)return s;for(const a of i){const o=t.Tu.get(a);s=s.unionWith(o.view.nu)}return s}}function _U(r){const e=cr(r);return e.remoteStore.remoteSyncer.applyRemoteEvent=yU.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Tne.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Cne.bind(null,e),e.Pu.H_=hne.bind(null,e.eventManager),e.Pu.yu=fne.bind(null,e.eventManager),e}function Fne(r){const e=cr(r);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Sne.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=kne.bind(null,e),e}class wb{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Ay(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return Nre(this.persistence,new Lre,e.initialUser,this.serializer)}Cu(e){return new rU(I2.mi,this.serializer)}Du(e){return new jre}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}wb.provider={build:()=>new wb};class Lne extends wb{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Xr(this.persistence.referenceDelegate instanceof bb,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new mre(n,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?sa.withCacheSize(this.cacheSizeBytes):sa.DEFAULT;return new rU((n=>bb.mi(n,t)),this.serializer)}}class rx{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>FE(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=Ine.bind(null,this.syncEngine),await Ane(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new une})()}createDatastore(e){const t=Ay(e.databaseInfo.databaseId),n=(function(i){return new Kre(i)})(e.databaseInfo);return(function(i,a,o,l){return new Xre(i,a,o,l)})(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return(function(n,s,i,a,o){return new Zre(n,s,i,a,o)})(this.localStore,this.datastore,e.asyncQueue,(t=>FE(this.syncEngine,t,0)),(function(){return CE.v()?new CE:new Vre})())}createSyncEngine(e,t){return(function(s,i,a,o,l,c,A){const d=new bne(s,i,a,o,l,c);return A&&(d.gu=!0),d})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(s){const i=cr(s);bt(Hd,"RemoteStore shutting down."),i.Ea.add(5),await Jg(i),i.Aa.shutdown(),i.Ra.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}rx.provider={build:()=>new rx};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BU{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):sc("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SA="FirestoreClient";class Une{constructor(e,t,n,s,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=s,this.user=Bi.UNAUTHENTICATED,this.clientId=Zb.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,(async a=>{bt(SA,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a})),this.appCheckCredentials.start(n,(a=>(bt(SA,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Xl;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=D2(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function Av(r,e){r.asyncQueue.verifyOperationInProgress(),bt(SA,"Initializing OfflineComponentProvider");const t=r.configuration;await e.initialize(t);let n=t.initialUser;r.setCredentialChangeListener((async s=>{n.isEqual(s)||(await nU(e.localStore,s),n=s)})),e.persistence.setDatabaseDeletedListener((()=>r.terminate())),r._offlineComponents=e}async function UE(r,e){r.asyncQueue.verifyOperationInProgress();const t=await Mne(r);bt(SA,"Initializing OnlineComponentProvider"),await e.initialize(t,r.configuration),r.setCredentialChangeListener((n=>kE(e.remoteStore,n))),r.setAppCheckTokenChangeListener(((n,s)=>kE(e.remoteStore,s))),r._onlineComponents=e}async function Mne(r){if(!r._offlineComponents)if(r._uninitializedComponentsProvider){bt(SA,"Using user provided OfflineComponentProvider");try{await Av(r,r._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(s){return s.name==="FirebaseError"?s.code===Ke.FAILED_PRECONDITION||s.code===Ke.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11})(t))throw t;Qd("Error using user provided cache. Falling back to memory cache: "+t),await Av(r,new wb)}}else bt(SA,"Using default OfflineComponentProvider"),await Av(r,new Lne(void 0));return r._offlineComponents}async function CU(r){return r._onlineComponents||(r._uninitializedComponentsProvider?(bt(SA,"Using user provided OnlineComponentProvider"),await UE(r,r._uninitializedComponentsProvider._online)):(bt(SA,"Using default OnlineComponentProvider"),await UE(r,new rx))),r._onlineComponents}function Nne(r){return CU(r).then((e=>e.syncEngine))}async function SU(r){const e=await CU(r),t=e.eventManager;return t.onListen=yne.bind(null,e.syncEngine),t.onUnlisten=xne.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=wne.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=_ne.bind(null,e.syncEngine),t}function Pne(r,e,t={}){const n=new Xl;return r.asyncQueue.enqueueAndForget((async()=>(function(i,a,o,l,c){const A=new BU({next:h=>{A.Nu(),a.enqueueAndForget((()=>fU(i,d)));const u=h.docs.has(o);!u&&h.fromCache?c.reject(new ut(Ke.UNAVAILABLE,"Failed to get document because the client is offline.")):u&&h.fromCache&&l&&l.source==="server"?c.reject(new ut(Ke.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(h)},error:h=>c.reject(h)}),d=new gU(_2(o.path),A,{includeMetadataChanges:!0,qa:!0});return hU(i,d)})(await SU(r),r.asyncQueue,e,t,n))),n.promise}function Dne(r,e,t={}){const n=new Xl;return r.asyncQueue.enqueueAndForget((async()=>(function(i,a,o,l,c){const A=new BU({next:h=>{A.Nu(),a.enqueueAndForget((()=>fU(i,d))),h.fromCache&&l.source==="server"?c.reject(new ut(Ke.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(h)},error:h=>c.reject(h)}),d=new gU(o,A,{includeMetadataChanges:!0,qa:!0});return hU(i,d)})(await SU(r),r.asyncQueue,e,t,n))),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kU(r){const e={};return r.timeoutSeconds!==void 0&&(e.timeoutSeconds=r.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ME=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EU="firestore.googleapis.com",NE=!0;class PE{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new ut(Ke.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=EU,this.ssl=NE}else this.host=e.host,this.ssl=e.ssl??NE;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=tU;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<gre)throw new ut(Ke.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}fL("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=kU(e.experimentalLongPollingOptions??{}),(function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new ut(Ke.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new ut(Ke.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new ut(Ke.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(n,s){return n.timeoutSeconds===s.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class hy{constructor(e,t,n,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new PE({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ut(Ke.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ut(Ke.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new PE(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(n){if(!n)return new uL;switch(n.type){case"firstParty":return new Kee(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new ut(Ke.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const n=ME.get(t);n&&(bt("ComponentProvider","Removing Datastore"),ME.delete(t),n.terminate())})(this),Promise.resolve()}}function IU(r,e,t,n={}){var c;r=Na(r,hy);const s=xh(e),i=r._getSettings(),a={...i,emulatorOptions:r._getEmulatorOptions()},o=`${e}:${t}`;s&&(m3(`https://${o}`),b3("Firestore",!0)),i.host!==EU&&i.host!==o&&Qd("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...i,host:o,ssl:s,emulatorOptions:n};if(!Nd(l,a)&&(r._setSettings(l),n.mockUserToken)){let A,d;if(typeof n.mockUserToken=="string")A=n.mockUserToken,d=Bi.MOCK_USER;else{A=tX(n.mockUserToken,(c=r._app)==null?void 0:c.options.projectId);const h=n.mockUserToken.sub||n.mockUserToken.user_id;if(!h)throw new ut(Ke.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new Bi(h)}r._authCredentials=new $ee(new dL(A,d))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cc{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new cc(this.firestore,e,this._query)}}class qn{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Jl(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new qn(this.firestore,e,this._key)}toJSON(){return{type:qn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if(Wg(t,qn._jsonSchema))return new qn(e,n||null,new Qt(vn.fromString(t.referencePath)))}}qn._jsonSchemaVersion="firestore/documentReference/1.0",qn._jsonSchema={type:xs("string",qn._jsonSchemaVersion),referencePath:xs("string")};class Jl extends cc{constructor(e,t,n){super(e,t,_2(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new qn(this.firestore,null,new Qt(e))}withConverter(e){return new Jl(this.firestore,e,this._path)}}function gl(r,e,...t){if(r=fs(r),hL("collection","path",e),r instanceof hy){const n=vn.fromString(e,...t);return Wk(n),new Jl(r,null,n)}{if(!(r instanceof qn||r instanceof Jl))throw new ut(Ke.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(vn.fromString(e,...t));return Wk(n),new Jl(r.firestore,null,n)}}function Ws(r,e,...t){if(r=fs(r),arguments.length===1&&(e=Zb.newId()),hL("doc","path",e),r instanceof hy){const n=vn.fromString(e,...t);return qk(n),new qn(r,null,new Qt(n))}{if(!(r instanceof qn||r instanceof Jl))throw new ut(Ke.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(vn.fromString(e,...t));return qk(n),new qn(r.firestore,r instanceof Jl?r.converter:null,new Qt(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DE="AsyncQueue";class RE{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new iU(this,"async_queue_retry"),this._c=()=>{const n=cv();n&&bt(DE,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const t=cv();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=cv();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Xl;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!kh(e))throw e;bt(DE,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((n=>{throw this.nc=n,this.rc=!1,sc("INTERNAL UNHANDLED ERROR: ",OE(n)),n})).then((n=>(this.rc=!1,n))))));return this.ac=t,t}enqueueAfterDelay(e,t,n){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const s=P2.createAndSchedule(this,e,t,n,(i=>this.hc(i)));return this.tc.push(s),s}uc(){this.nc&&Wt(47125,{Pc:OE(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,n)=>t.targetTimeMs-n.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function OE(r){let e=r.message||"";return r.stack&&(e=r.stack.includes(r.message)?r.stack:r.message+`
`+r.stack),e}class Ac extends hy{constructor(e,t,n,s){super(e,t,n,s),this.type="firestore",this._queue=new RE,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new RE(e),this._firestoreClient=void 0,await e}}}function TU(r,e){const t=typeof r=="object"?r:x3(),n=typeof r=="string"?r:ub,s=a2(t,"firestore").getImmediate({identifier:n});if(!s._initialized){const i=ZY("firestore");i&&IU(s,...i)}return s}function ep(r){if(r._terminated)throw new ut(Ke.FAILED_PRECONDITION,"The client has already been terminated.");return r._firestoreClient||Rne(r),r._firestoreClient}function Rne(r){var n,s,i;const e=r._freezeSettings(),t=(function(o,l,c,A){return new cte(o,l,c,A.host,A.ssl,A.experimentalForceLongPolling,A.experimentalAutoDetectLongPolling,kU(A.experimentalLongPollingOptions),A.useFetchStreams,A.isUsingEmulator)})(r._databaseId,((n=r._app)==null?void 0:n.options.appId)||"",r._persistenceKey,e);r._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(r._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),r._firestoreClient=new Une(r._authCredentials,r._appCheckCredentials,r._queue,t,r._componentsProvider&&(function(o){const l=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(l),_online:l}})(r._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ia{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ia(Ys.fromBase64String(e))}catch(t){throw new ut(Ke.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Ia(Ys.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Ia._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Wg(e,Ia._jsonSchema))return Ia.fromBase64String(e.bytes)}}Ia._jsonSchemaVersion="firestore/bytes/1.0",Ia._jsonSchema={type:xs("string",Ia._jsonSchemaVersion),bytes:xs("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Th{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ut(Ke.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new zs(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tp{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bo{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ut(Ke.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ut(Ke.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ir(this._lat,e._lat)||Ir(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:bo._jsonSchemaVersion}}static fromJSON(e){if(Wg(e,bo._jsonSchema))return new bo(e.latitude,e.longitude)}}bo._jsonSchemaVersion="firestore/geoPoint/1.0",bo._jsonSchema={type:xs("string",bo._jsonSchemaVersion),latitude:xs("number"),longitude:xs("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yo{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(n,s){if(n.length!==s.length)return!1;for(let i=0;i<n.length;++i)if(n[i]!==s[i])return!1;return!0})(this._values,e._values)}toJSON(){return{type:yo._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Wg(e,yo._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new yo(e.vectorValues);throw new ut(Ke.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}yo._jsonSchemaVersion="firestore/vectorValue/1.0",yo._jsonSchema={type:xs("string",yo._jsonSchemaVersion),vectorValues:xs("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const One=/^__.*__$/;class Qne{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return this.fieldMask!==null?new MA(e,this.data,this.fieldMask,t,this.fieldTransforms):new Yg(e,this.data,t,this.fieldTransforms)}}class FU{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new MA(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function LU(r){switch(r){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Wt(40011,{Ac:r})}}class H2{constructor(e,t,n,s,i,a){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new H2({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var s;const t=(s=this.path)==null?void 0:s.child(e),n=this.Vc({path:t,fc:!1});return n.gc(e),n}yc(e){var s;const t=(s=this.path)==null?void 0:s.child(e),n=this.Vc({path:t,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return vb(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(LU(this.Ac)&&One.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class Hne{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||Ay(e)}Cc(e,t,n,s=!1){return new H2({Ac:e,methodName:t,Dc:n,path:zs.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function rp(r){const e=r._freezeSettings(),t=Ay(r._databaseId);return new Hne(r._databaseId,!!e.ignoreUndefinedProperties,t)}function j2(r,e,t,n,s,i={}){const a=r.Cc(i.merge||i.mergeFields?2:0,e,t,s);$2("Data must be an object, but it was:",a,n);const o=NU(n,a);let l,c;if(i.merge)l=new Fa(a.fieldMask),c=a.fieldTransforms;else if(i.mergeFields){const A=[];for(const d of i.mergeFields){const h=nx(e,d,t);if(!a.contains(h))throw new ut(Ke.INVALID_ARGUMENT,`Field '${h}' is specified in your field mask but missing from your input data.`);DU(A,h)||A.push(h)}l=new Fa(A),c=a.fieldTransforms.filter((d=>l.covers(d.field)))}else l=null,c=a.fieldTransforms;return new Qne(new ca(o),l,c)}class fy extends tp{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof fy}}class V2 extends tp{_toFieldTransform(e){return new Nte(e.path,new Ig)}isEqual(e){return e instanceof V2}}function UU(r,e,t,n){const s=r.Cc(1,e,t);$2("Data must be an object, but it was:",s,n);const i=[],a=ca.empty();UA(n,((l,c)=>{const A=G2(e,l,t);c=fs(c);const d=s.yc(A);if(c instanceof fy)i.push(A);else{const h=np(c,d);h!=null&&(i.push(A),a.set(A,h))}}));const o=new Fa(i);return new FU(a,o,s.fieldTransforms)}function MU(r,e,t,n,s,i){const a=r.Cc(1,e,t),o=[nx(e,n,t)],l=[s];if(i.length%2!=0)throw new ut(Ke.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<i.length;h+=2)o.push(nx(e,i[h])),l.push(i[h+1]);const c=[],A=ca.empty();for(let h=o.length-1;h>=0;--h)if(!DU(c,o[h])){const u=o[h];let p=l[h];p=fs(p);const f=a.yc(u);if(p instanceof fy)c.push(u);else{const g=np(p,f);g!=null&&(c.push(u),A.set(u,g))}}const d=new Fa(c);return new FU(A,d,a.fieldTransforms)}function jne(r,e,t,n=!1){return np(t,r.Cc(n?4:3,e))}function np(r,e){if(PU(r=fs(r)))return $2("Unsupported field value:",e,r),NU(r,e);if(r instanceof tp)return(function(n,s){if(!LU(s.Ac))throw s.Sc(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${n._methodName}() is not currently supported inside arrays`);const i=n._toFieldTransform(s);i&&s.fieldTransforms.push(i)})(r,e),null;if(r===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),r instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(n,s){const i=[];let a=0;for(const o of n){let l=np(o,s.wc(a));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),a++}return{arrayValue:{values:i}}})(r,e)}return(function(n,s){if((n=fs(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return Lte(s.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const i=xn.fromDate(n);return{timestampValue:mb(s.serializer,i)}}if(n instanceof xn){const i=new xn(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:mb(s.serializer,i)}}if(n instanceof bo)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Ia)return{bytesValue:qL(s.serializer,n._byteString)};if(n instanceof qn){const i=s.databaseId,a=n.firestore._databaseId;if(!a.isEqual(i))throw s.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:k2(n.firestore._databaseId||s.databaseId,n._key.path)}}if(n instanceof yo)return(function(a,o){return{mapValue:{fields:{[_L]:{stringValue:BL},[hb]:{arrayValue:{values:a.toArray().map((c=>{if(typeof c!="number")throw o.Sc("VectorValues must only contain numeric values.");return B2(o.serializer,c)}))}}}}}})(n,s);throw s.Sc(`Unsupported field value: ${ey(n)}`)})(r,e)}function NU(r,e){const t={};return mL(r)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):UA(r,((n,s)=>{const i=np(s,e.mc(n));i!=null&&(t[n]=i)})),{mapValue:{fields:t}}}function PU(r){return!(typeof r!="object"||r===null||r instanceof Array||r instanceof Date||r instanceof xn||r instanceof bo||r instanceof Ia||r instanceof qn||r instanceof tp||r instanceof yo)}function $2(r,e,t){if(!PU(t)||!gL(t)){const n=ey(t);throw n==="an object"?e.Sc(r+" a custom object"):e.Sc(r+" "+n)}}function nx(r,e,t){if((e=fs(e))instanceof Th)return e._internalPath;if(typeof e=="string")return G2(r,e);throw vb("Field path arguments must be of type string or ",r,!1,void 0,t)}const Vne=new RegExp("[~\\*/\\[\\]]");function G2(r,e,t){if(e.search(Vne)>=0)throw vb(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,r,!1,void 0,t);try{return new Th(...e.split("."))._internalPath}catch{throw vb(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,r,!1,void 0,t)}}function vb(r,e,t,n,s){const i=n&&!n.isEmpty(),a=s!==void 0;let o=`Function ${e}() called with invalid data`;t&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(i||a)&&(l+=" (found",i&&(l+=` in field ${n}`),a&&(l+=` in document ${s}`),l+=")"),new ut(Ke.INVALID_ARGUMENT,o+r+l)}function DU(r,e){return r.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RU{constructor(e,t,n,s,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new qn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new $ne(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(gy("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class $ne extends RU{data(){return super.data()}}function gy(r,e){return typeof e=="string"?G2(r,e):e instanceof Th?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gne(r){if(r.limitType==="L"&&r.explicitOrderBy.length===0)throw new ut(Ke.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class z2{}class py extends z2{}function NA(r,e,...t){let n=[];e instanceof z2&&n.push(e),n=n.concat(t),(function(i){const a=i.filter((l=>l instanceof my)).length,o=i.filter((l=>l instanceof sp)).length;if(a>1||a>0&&o>0)throw new ut(Ke.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(n);for(const s of n)r=s._apply(r);return r}class sp extends py{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new sp(e,t,n)}_apply(e){const t=this._parse(e);return QU(e._query,t),new cc(e.firestore,e.converter,K1(e._query,t))}_parse(e){const t=rp(e.firestore);return(function(i,a,o,l,c,A,d){let h;if(c.isKeyField()){if(A==="array-contains"||A==="array-contains-any")throw new ut(Ke.INVALID_ARGUMENT,`Invalid Query. You can't perform '${A}' queries on documentId().`);if(A==="in"||A==="not-in"){HE(d,A);const p=[];for(const f of d)p.push(QE(l,i,f));h={arrayValue:{values:p}}}else h=QE(l,i,d)}else A!=="in"&&A!=="not-in"&&A!=="array-contains-any"||HE(d,A),h=jne(o,a,d,A==="in"||A==="not-in");return ys.create(c,A,h)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function ac(r,e,t){const n=e,s=gy("where",r);return sp._create(s,n,t)}class my extends z2{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new my(e,t)}_parse(e){const t=this._queryConstraints.map((n=>n._parse(e))).filter((n=>n.getFilters().length>0));return t.length===1?t[0]:vo.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(s,i){let a=s;const o=i.getFlattenedFilters();for(const l of o)QU(a,l),a=K1(a,l)})(e._query,t),new cc(e.firestore,e.converter,K1(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class by extends py{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new by(e,t)}_apply(e){const t=(function(s,i,a){if(s.startAt!==null)throw new ut(Ke.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new ut(Ke.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Eg(i,a)})(e._query,this._field,this._direction);return new cc(e.firestore,e.converter,(function(s,i){const a=s.explicitOrderBy.concat([i]);return new Eh(s.path,s.collectionGroup,a,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)})(e._query,t))}}function OU(r,e="asc"){const t=e,n=gy("orderBy",r);return by._create(n,t)}class yy extends py{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new yy(e,t,n)}_apply(e){return new cc(e.firestore,e.converter,gb(e._query,this._limit,this._limitType))}}function ip(r){return yy._create("limit",r,"F")}function QE(r,e,t){if(typeof(t=fs(t))=="string"){if(t==="")throw new ut(Ke.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!LL(e)&&t.indexOf("/")!==-1)throw new ut(Ke.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const n=e.path.child(vn.fromString(t));if(!Qt.isDocumentKey(n))throw new ut(Ke.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return nE(r,new Qt(n))}if(t instanceof qn)return nE(r,t._key);throw new ut(Ke.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ey(t)}.`)}function HE(r,e){if(!Array.isArray(r)||r.length===0)throw new ut(Ke.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function QU(r,e){const t=(function(s,i){for(const a of s)for(const o of a.getFlattenedFilters())if(i.indexOf(o.op)>=0)return o.op;return null})(r.filters,(function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new ut(Ke.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ut(Ke.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class HU{convertValue(e,t="none"){switch(BA(e)){case 0:return null;case 1:return e.booleanValue;case 2:return is(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(_A(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Wt(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return UA(e,((s,i)=>{n[s]=this.convertValue(i,t)})),n}convertVectorValue(e){var n,s,i;const t=(i=(s=(n=e.fields)==null?void 0:n[hb].arrayValue)==null?void 0:s.values)==null?void 0:i.map((a=>is(a.doubleValue)));return new yo(t)}convertGeoPoint(e){return new bo(is(e.latitude),is(e.longitude))}convertArray(e,t){return(e.values||[]).map((n=>this.convertValue(n,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=ny(e);return n==null?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Sg(e));default:return null}}convertTimestamp(e){const t=xA(e);return new xn(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=vn.fromString(e);Xr(eU(n),9688,{name:e});const s=new lh(n.get(1),n.get(3)),i=new Qt(n.popFirst(5));return s.isEqual(t)||sc(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K2(r,e,t){let n;return n=r?t&&(t.merge||t.mergeFields)?r.toFirestore(e,t):r.toFirestore(e):e,n}class Nu{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class dA extends RU{constructor(e,t,n,s,i,a){super(e,t,n,s,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new ag(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(gy("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ut(Ke.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=dA._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}dA._jsonSchemaVersion="firestore/documentSnapshot/1.0",dA._jsonSchema={type:xs("string",dA._jsonSchemaVersion),bundleSource:xs("string","DocumentSnapshot"),bundleName:xs("string"),bundle:xs("string")};class ag extends dA{data(e={}){return super.data(e)}}class Sd{constructor(e,t,n,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new Nu(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new ag(this._firestore,this._userDataWriter,n.key,n,new Nu(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ut(Ke.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(s,i){if(s._snapshot.oldDocs.isEmpty()){let a=0;return s._snapshot.docChanges.map((o=>{const l=new ag(s._firestore,s._userDataWriter,o.doc.key,o.doc,new Nu(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}}))}{let a=s._snapshot.oldDocs;return s._snapshot.docChanges.filter((o=>i||o.type!==3)).map((o=>{const l=new ag(s._firestore,s._userDataWriter,o.doc.key,o.doc,new Nu(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,A=-1;return o.type!==0&&(c=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),A=a.indexOf(o.doc.key)),{type:zne(o.type),doc:l,oldIndex:c,newIndex:A}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ut(Ke.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Sd._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Zb.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],n=[],s=[];return this.docs.forEach((i=>{i._document!==null&&(t.push(i._document),n.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function zne(r){switch(r){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Wt(61501,{type:r})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eu(r){r=Na(r,qn);const e=Na(r.firestore,Ac);return Pne(ep(e),r._key).then((t=>Kne(e,r,t)))}Sd._jsonSchemaVersion="firestore/querySnapshot/1.0",Sd._jsonSchema={type:xs("string",Sd._jsonSchemaVersion),bundleSource:xs("string","QuerySnapshot"),bundleName:xs("string"),bundle:xs("string")};class jU extends HU{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ia(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new qn(this.firestore,null,t)}}function dc(r){r=Na(r,cc);const e=Na(r.firestore,Ac),t=ep(e),n=new jU(e);return Gne(r._query),Dne(t,r._query).then((s=>new Sd(e,n,r,s)))}function Xu(r,e,t){r=Na(r,qn);const n=Na(r.firestore,Ac),s=K2(r.converter,e,t);return Fh(n,[j2(rp(n),"setDoc",r._key,s,r.converter!==null,t).toMutation(r._key,Hi.none())])}function VU(r,e,t,...n){r=Na(r,qn);const s=Na(r.firestore,Ac),i=rp(s);let a;return a=typeof(e=fs(e))=="string"||e instanceof Th?MU(i,"updateDoc",r._key,e,t,n):UU(i,"updateDoc",r._key,e),Fh(s,[a.toMutation(r._key,Hi.exists(!0))])}function $U(r){return Fh(Na(r.firestore,Ac),[new ly(r._key,Hi.none())])}function GU(r,e){const t=Na(r.firestore,Ac),n=Ws(r),s=K2(r.converter,e);return Fh(t,[j2(rp(r.firestore),"addDoc",n._key,s,r.converter!==null,{}).toMutation(n._key,Hi.exists(!1))]).then((()=>n))}function Fh(r,e){return(function(n,s){const i=new Xl;return n.asyncQueue.enqueueAndForget((async()=>Bne(await Nne(n),s,i))),i.promise})(ep(r),e)}function Kne(r,e,t){const n=t.docs.get(e._key),s=new jU(r);return new dA(r,s,e._key,n,new Nu(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zU{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=rp(e)}set(e,t,n){this._verifyNotCommitted();const s=dv(e,this._firestore),i=K2(s.converter,t,n),a=j2(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,n);return this._mutations.push(a.toMutation(s._key,Hi.none())),this}update(e,t,n,...s){this._verifyNotCommitted();const i=dv(e,this._firestore);let a;return a=typeof(t=fs(t))=="string"||t instanceof Th?MU(this._dataReader,"WriteBatch.update",i._key,t,n,s):UU(this._dataReader,"WriteBatch.update",i._key,t),this._mutations.push(a.toMutation(i._key,Hi.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=dv(e,this._firestore);return this._mutations=this._mutations.concat(new ly(t._key,Hi.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new ut(Ke.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function dv(r,e){if((r=fs(r)).firestore!==e)throw new ut(Ke.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return r}function KU(){return new V2("serverTimestamp")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ap(r){return ep(r=Na(r,Ac)),new zU(r,(e=>Fh(r,e)))}(function(e,t=!0){(function(s){Ch=s})(_h),ah(new Pd("firestore",((n,{instanceIdentifier:s,options:i})=>{const a=n.getProvider("app").getImmediate(),o=new Ac(new Gee(n.getProvider("auth-internal")),new qee(a,n.getProvider("app-check-internal")),(function(c,A){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new ut(Ke.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new lh(c.options.projectId,A)})(a,s),a);return i={useFetchStreams:t,...i},o._setSettings(i),o}),"PUBLIC").setMultipleInstances(!0)),cA($k,Gk,e),cA($k,Gk,"esm2020")})();const qne=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:HU,Bytes:Ia,CollectionReference:Jl,DocumentReference:qn,DocumentSnapshot:dA,FieldPath:Th,FieldValue:tp,Firestore:Ac,FirestoreError:ut,GeoPoint:bo,Query:cc,QueryCompositeFilterConstraint:my,QueryConstraint:py,QueryDocumentSnapshot:ag,QueryFieldFilterConstraint:sp,QueryLimitConstraint:yy,QueryOrderByConstraint:by,QuerySnapshot:Sd,SnapshotMetadata:Nu,Timestamp:xn,VectorValue:yo,WriteBatch:zU,_AutoId:Zb,_ByteString:Ys,_DatabaseId:lh,_DocumentKey:Qt,_EmptyAuthCredentialsProvider:uL,_FieldPath:zs,_cast:Na,_logWarn:Qd,_validateIsNotUsedTogether:fL,addDoc:GU,collection:gl,connectFirestoreEmulator:IU,deleteDoc:$U,doc:Ws,ensureFirestoreConfigured:ep,executeWrite:Fh,getDoc:eu,getDocs:dc,getFirestore:TU,limit:ip,orderBy:OU,query:NA,serverTimestamp:KU,setDoc:Xu,updateDoc:VU,where:ac,writeBatch:ap},Symbol.toStringTag,{value:"Module"})),Wne={apiKey:"AIzaSyAkw1kL7AU73Y9FWrPZ-ERv5xFvXGGILBA",authDomain:"claritybudget-6lnmd.firebaseapp.com",projectId:"claritybudget-6lnmd",storageBucket:"claritybudget-6lnmd.firebasestorage.app",messagingSenderId:"40318182466",appId:"1:40318182466:web:c2ce0637f8f23afa95b9db"},qU=v3(Wne),ra=jee(qU),zr=TU(qU),Yne=new Ol,nl=KU;class Xne{constructor(e="smart_evaluator_",t=5){if(typeof e!="string")throw new Error("CacheManager prefix must be a string.");if(typeof t!="number"||t<=0)throw new Error("CacheManager default duration must be a positive number.");this.PREFIX=e,this.DEFAULT_CACHE_DURATION_MS=t*60*1e3,this.forceRefresh=!1,console.log(`CacheManager initialized with prefix "${this.PREFIX}" and default duration ${t} minutes.`)}set(e,t,n=null){if(!e||typeof e!="string"){console.warn("Cache set failed: Invalid key.",{key:e});return}if(t===void 0){console.warn(`Cache set skipped for key "${e}": Data is undefined.`);return}const s=n!==null&&n>0?n*60*1e3:this.DEFAULT_CACHE_DURATION_MS,i={data:t,timestamp:Date.now(),expires:Date.now()+s};try{const a=JSON.stringify(i);localStorage.setItem(this.PREFIX+e,a)}catch(a){if(console.error(`Error setting cache for key "${e}":`,a),a.name==="QuotaExceededError"||a.message&&a.message.toLowerCase().includes("quota")){console.warn("LocalStorage quota exceeded. Attempting to clear oldest items..."),this.clearOldest();try{localStorage.setItem(this.PREFIX+e,JSON.stringify(i)),console.log(`Cache set for key: ${e} after clearing space.`)}catch(o){console.error(`Failed to set cache for key "${e}" even after clearing space:`,o)}}}}get(e){if(!e||typeof e!="string")return console.warn("Cache get failed: Invalid key."),null;const t=this.PREFIX+e,n=localStorage.getItem(t);if(!n)return null;if(this.forceRefresh)return console.log(`Cache force refresh triggered for key: ${e}.`),this.forceRefresh=!1,this.clear(e),null;try{const s=JSON.parse(n);return typeof s!="object"||s===null||!s.hasOwnProperty("data")||!s.hasOwnProperty("expires")||typeof s.expires!="number"?(console.warn(`Invalid cache structure for key: ${e}. Clearing item.`),localStorage.removeItem(t),null):Date.now()>s.expires?(localStorage.removeItem(t),null):s.data}catch(s){return console.error(`Error parsing cache for key "${e}". Clearing item.`,s),localStorage.removeItem(t),null}}clear(e){if(!(!e||typeof e!="string"))try{localStorage.removeItem(this.PREFIX+e)}catch(t){console.error(`Error clearing cache for key "${e}":`,t)}}clearAll(){let e=0;try{Object.keys(localStorage).filter(n=>n.startsWith(this.PREFIX)).forEach(n=>{localStorage.removeItem(n),e++}),e>0&&console.log(`Cleared ${e} cache items.`)}catch(t){console.error("Error clearing all cache items:",t)}}clearOldest(e=50,t=10){if(!(e<=0||t<=0))try{const n=Object.keys(localStorage).filter(s=>s.startsWith(this.PREFIX));if(n.length>e){console.log(`Cache limit exceeded. Clearing ${t} oldest items.`);const s=n.map(i=>{try{const a=localStorage.getItem(i),o=a?JSON.parse(a):null;return{key:i,timestamp:(o==null?void 0:o.timestamp)||0}}catch{return{key:i,timestamp:0}}});s.sort((i,a)=>i.timestamp-a.timestamp),s.slice(0,t).forEach(i=>{localStorage.removeItem(i.key)})}}catch(n){console.error("Error clearing oldest cache items:",n)}}setForceRefresh(){this.forceRefresh=!0,console.log("Cache force refresh enabled for the next get() call.")}async getSmartData(e,t){var n;if(!e||typeof t!="function")return console.error("getSmartData: Invalid arguments."),null;try{const s=await eu(Ws(zr,"settings","status"));let i=0;if(s.exists()){const h=s.data();(n=h==null?void 0:h.lastUpdated)!=null&&n.toMillis?i=h.lastUpdated.toMillis():h!=null&&h.lastUpdated&&(i=new Date(h.lastUpdated).getTime())}else{console.warn('SmartCache: "settings/status" doc not found. Creating it now...');try{const{setDoc:h,doc:u}=await Yf(async()=>{const{setDoc:p,doc:f}=await Promise.resolve().then(()=>qne);return{setDoc:p,doc:f}},void 0);await h(u(zr,"settings","status"),{lastUpdated:Date.now()}),i=Date.now(),console.log('SmartCache: Created "settings/status" with timestamp:',i)}catch(h){console.error("SmartCache: Failed to auto-create settings/status:",h)}}const a=this.PREFIX+e,o=localStorage.getItem(a);let l=null,c=-1;if(o&&!this.forceRefresh)try{const h=JSON.parse(o);h&&h.serverLastUpdated&&(c=h.serverLastUpdated,l=h.data)}catch(h){console.warn("SmartCache: Error parsing local cache.",h)}if(i>0&&i===c&&l)return console.log(`[SmartCache] HIT for "${e}". Server: ${i} === Cache: ${c}`),l;console.log(`[SmartCache] MISS for "${e}". Server: ${i} !== Cache: ${c}. Fetching...`);const A=await t(),d={data:A,timestamp:Date.now(),serverLastUpdated:i,expires:Date.now()+this.DEFAULT_CACHE_DURATION_MS};try{localStorage.setItem(a,JSON.stringify(d))}catch(h){if(console.error("SmartCache: Error saving to localStorage",h),h.name==="QuotaExceededError"||h.message&&h.message.toLowerCase().includes("quota")){this.clearOldest();try{localStorage.setItem(a,JSON.stringify(d))}catch(u){console.error("SmartCache: Retry failed",u)}}}return this.forceRefresh&&(this.forceRefresh=!1),A}catch(s){return console.error(`[SmartCache] Error in getSmartData for "${e}":`,s),await t()}}}const _s=new Xne,vm={BLUE:"theme-blue",EMERALD:"theme-emerald",VIOLET:"theme-violet",AMBER:"theme-amber"},Jne=vm.BLUE,q2={init(){console.log(" ThemeManager initialized")},applyTheme(r){const e=document.documentElement;Object.values(vm).forEach(n=>e.classList.remove(n));const t=Object.values(vm).includes(r)?r:Jne;e.classList.add(t),console.log(` Theme applied: ${t}`)},setDarkMode(r){const e=document.documentElement;r?e.classList.add("dark"):e.classList.remove("dark")},getThemes(){return vm}},Yt={GROUPS:"groups_data",STUDENTS:"students_data",TASKS:"tasks_data",EVALUATIONS:"evaluations_data",ADMINS:"admins_data",CLASSES:"classes_data",SECTIONS:"sections_data",SUBJECTS:"subjects_data",TEACHERS:"teachers_data"};function jd(r){return typeof r=="string"?r.trim():typeof r=="number"?String(r).trim():""}function tu(r){const e=jd(r);return e?e.toLowerCase():""}function WU(r,e,t=null){if(!e)return!1;const n=_s.get(r);return!Array.isArray(n)||n.length===0?!1:n.some(s=>!s||t&&s.id===t?!1:(typeof s.nameLower=="string"&&s.nameLower?s.nameLower:tu(s.name))===e)}async function PA(){try{const r=Ws(zr,"settings","status");await Xu(r,{lastUpdated:Date.now()},{merge:!0}),console.log(" Server metadata updated (Sync Triggered).")}catch(r){console.error("Failed to update server metadata:",r)}}async function uc(r,e,t={}){const n=async()=>{try{let s=gl(zr,r);return t.orderByField&&(s=NA(s,OU(t.orderByField,t.orderByDirection||"asc"))),(await dc(s)).docs.map(a=>({id:a.id,...a.data()}))}catch(s){throw console.error(` Error loading ${r}:`,s),new Error(`Failed to load ${r}. Check connection/permissions.`)}};return await _s.getSmartData(e,n)}async function ru(r,e,t=null){try{const n=await GU(gl(zr,r),{...e,createdAt:nl(),updatedAt:nl()});return t&&_s.clear(t),await PA(),console.log(` Document added to ${r} (${n.id})`),n.id}catch(n){throw console.error(` Error adding document to ${r}:`,n),new Error(`Failed to add item to ${r}.`)}}async function So(r,e,t,n=null){if(!e)throw new Error("Document ID required for update.");try{await VU(Ws(zr,r,e),{...t,updatedAt:nl()}),n&&_s.clear(n),await PA(),console.log(` Document updated in ${r} (${e})`),r==="admins"&&_s.clear(`admin_${e}`)}catch(s){throw console.error(` Error updating document ${e} in ${r}:`,s),new Error(`Failed to update item in ${r}.`)}}async function Ya(r,e,t=null){if(!e)throw new Error("Document ID required for deletion.");try{await $U(Ws(zr,r,e)),_s.clear(t),await PA(),console.log(` Document deleted from ${r} (${e})`),r==="admins"&&_s.clear(`admin_${e}`)}catch(n){throw console.error(` Error deleting document ${e} in ${r}:`,n),new Error(`Failed to delete item from ${r}.`)}}async function Zne(r,e){if(!Array.isArray(e)||e.length===0)return;const t=450,n=[];for(let i=0;i<e.length;i+=t)n.push(e.slice(i,i+t));console.log(`Starting restore for ${r}: ${e.length} items in ${n.length} batches.`);for(const i of n){const a=ap(zr);i.forEach(o=>{if(!o.id)return;const l=Ws(zr,r,o.id);a.set(l,{...o,updatedAt:nl()},{merge:!0})});try{await a.commit(),console.log(` Restored batch of ${i.length} items to ${r}`)}catch(o){throw console.error(` Error restoring batch to ${r}:`,o),new Error(`Failed to restore data to ${r}.`)}}const s={groups:Yt.GROUPS,students:Yt.STUDENTS,tasks:Yt.TASKS,evaluations:Yt.EVALUATIONS,admins:Yt.ADMINS,classes:Yt.CLASSES,sections:Yt.SECTIONS,subjects:Yt.SUBJECTS,teachers:Yt.TEACHERS};s[r]&&_s.clear(s[r]),await PA()}async function ese(r){try{const e=await dc(gl(zr,r));if(e.empty)return;const t=450,n=e.docs,s=[];for(let a=0;a<n.length;a+=t)s.push(n.slice(a,a+t));console.log(`Clearing ${r}: ${n.length} items...`);for(const a of s){const o=ap(zr);a.forEach(l=>{o.delete(l.ref)}),await o.commit()}console.log(` Cleared collection ${r}`);const i={groups:Yt.GROUPS,students:Yt.STUDENTS,classes:Yt.CLASSES,sections:Yt.SECTIONS,subjects:Yt.SUBJECTS,teachers:Yt.TEACHERS};i[r]&&_s.clear(i[r]),await PA()}catch(e){throw console.error(` Error clearing collection ${r}:`,e),new Error(`Failed to clear ${r}.`)}}const tse=()=>uc("groups",Yt.GROUPS,{orderByField:"name"}),rse=(r={})=>{const e=jd(r.name);if(!e)throw new Error("Group name is required.");const t={...r,name:e,nameLower:tu(e)};return ru("groups",t,Yt.GROUPS)},nse=(r,e={})=>{if(!r)throw new Error("Group ID required for update.");const t={...e};if(Object.prototype.hasOwnProperty.call(e,"name")){const n=jd(e.name);if(!n)throw new Error("Group name cannot be empty.");t.name=n,t.nameLower=tu(n)}return So("groups",r,t,Yt.GROUPS)},sse=r=>Ya("groups",r,Yt.GROUPS),ise=()=>uc("students",Yt.STUDENTS,{orderByField:"name"}),ase=r=>ru("students",r,Yt.STUDENTS),ose=(r,e)=>So("students",r,e,Yt.STUDENTS),lse=async(r,e)=>{if(!r||r.length===0)return;const t=ap(zr);r.forEach(n=>{const s=Ws(zr,"students",n);t.update(s,{...e,updatedAt:nl()})});try{await t.commit(),_s.clear(Yt.STUDENTS),await PA(),console.log(` Batch updated ${r.length} students.`)}catch(n){throw console.error(" Error batch updating students:",n),new Error("Failed to update student group assignments.")}},cse=r=>Ya("students",r,Yt.STUDENTS),Ase=(r,e)=>So("subjects",r,e,Yt.SUBJECTS),dse=r=>Ya("subjects",r,Yt.SUBJECTS),use=r=>ru("teachers",r,Yt.TEACHERS),hse=(r,e)=>So("teachers",r,e,Yt.TEACHERS);async function fse(r){await So("teachers",r,{deleted:!0,deletedAt:new Date().toISOString(),active:!1}),_s.clear(Yt.TEACHERS)}async function gse(r){await So("teachers",r,{deleted:!1,deletedAt:null,active:!0,restoredAt:new Date().toISOString()}),_s.clear(Yt.TEACHERS)}async function pse(r="active"){const e=await uc("teachers",Yt.TEACHERS,{orderByField:"name"});return r==="active"?e.filter(t=>!t.deleted):r==="deleted"?e.filter(t=>t.deleted===!0):e}async function mse(r){if(!r)return console.warn("getTeacherByUid called without uid"),null;const e=`teacher_${r}`,t=_s.get(e);if(t)return t;try{const n=await eu(Ws(zr,"teachers",r));if(n.exists()){const s={id:n.id,...n.data()};return _s.set(e,s,15),s}else return null}catch(n){return console.error(` Error fetching teacher data for uid ${r}:`,n),null}}async function bse(r){if(!r)return[];try{const e=NA(gl(zr,"groups"),ac("teacherId","==",r));return(await dc(e)).docs.map(n=>({id:n.id,...n.data()}))}catch(e){return console.error(` Error loading groups for teacher ${r}:`,e),[]}}async function yse(r,e){if(!r||!e)return[];try{const t=NA(gl(zr,"students"),ac("classId","==",r),ac("sectionId","==",e));return(await dc(t)).docs.map(s=>({id:s.id,...s.data()}))}catch(t){return console.error(` Error loading students for class ${r}, section ${e}:`,t),[]}}const wse=()=>uc("tasks",Yt.TASKS,{orderByField:"date",orderByDirection:"desc"}),vse=(r={})=>{const e=jd(r.name);if(!e)throw new Error("Task name is required.");const t={...r,name:e,nameLower:tu(e)};return ru("tasks",t,Yt.TASKS)},xse=(r,e={})=>{if(!r)throw new Error("Task ID required for update.");const t={...e};if(Object.prototype.hasOwnProperty.call(e,"name")){const n=jd(e.name);if(!n)throw new Error("Task name cannot be empty.");t.name=n,t.nameLower=tu(n)}return So("tasks",r,t,Yt.TASKS)},_se=r=>Ya("tasks",r,Yt.TASKS),Bse=()=>uc("evaluations",Yt.EVALUATIONS,{orderByField:"taskDate",orderByDirection:"desc"}),Cse=r=>ru("evaluations",r,Yt.EVALUATIONS),Sse=(r,e)=>So("evaluations",r,e,Yt.EVALUATIONS),kse=r=>Ya("evaluations",r,Yt.EVALUATIONS),Ese=async r=>{if(!r||r.length===0)return;const e=ap(zr);r.forEach(t=>{const n=Ws(zr,"evaluations",t);e.delete(n)});try{await e.commit(),_s.clear(Yt.EVALUATIONS),await PA(),console.log(` Batch deleted ${r.length} evaluations.`)}catch(t){throw console.error(" Error batch deleting evaluations:",t),new Error("Failed to delete associated evaluations.")}};async function Ise(r){if(!r)throw new Error("Evaluation ID is required.");try{const e=await eu(Ws(zr,"evaluations",r));return e.exists()?{id:e.id,...e.data()}:(console.warn(`Evaluation with ID ${r} not found.`),null)}catch(e){throw console.error(` Error fetching evaluation ${r}:`,e),new Error("Failed to fetch evaluation details.")}}const Tse=()=>uc("admins",Yt.ADMINS,{orderByField:"email"}),Fse=(r,e)=>So("admins",r,e,Yt.ADMINS),Lse=r=>Ya("admins",r,Yt.ADMINS);async function sx(r){if(!r)return console.warn("getAdminData called without userId"),null;const e=`admin_${r}`,t=_s.get(e);if(t)return t;try{const n=await eu(Ws(zr,"admins",r));if(n.exists()){const s={id:n.id,...n.data()};return _s.set(e,s,15),s}else return null}catch(n){return console.error(` Error fetching admin data for user ${r}:`,n),null}}const ix=()=>uc("classes",Yt.CLASSES,{orderByField:"name"}),xm=()=>uc("sections",Yt.SECTIONS,{orderByField:"name"}),_m=()=>uc("subjects",Yt.SUBJECTS,{orderByField:"name"});async function Use(r,e,t=null){const n=jd(r),s=jd(e);if(!n||!s)throw new Error("Roll and Academic Group required.");try{let i=NA(gl(zr,"students"),ac("roll","==",n),ac("academicGroup","==",s),ip(1));const a=await dc(i);return!(a.empty||t&&a.docs[0].id===t)}catch(i){throw console.error(" Error checking student uniqueness:",i),i.code==="failed-precondition"&&i.message.includes("index")?(console.error("Firestore composite index missing: students(roll ASC, academicGroup ASC)."),new Error("   (Student Index missing)")):new Error("Failed to check duplicate students.")}}const Mse=async(r,e=null)=>{const t=tu(r);if(!t)return!1;if(WU(Yt.GROUPS,t,e))return!0;try{let n=NA(gl(zr,"groups"),ac("nameLower","==",t),ip(1));const s=await dc(n);return!(s.empty||e&&s.docs[0].id===e)}catch(n){throw console.error(" Error checking group name uniqueness:",n),n.code==="failed-precondition"&&n.message.includes("index")?(console.error("Firestore index missing: groups(nameLower ASC)."),new Error("   (Group Index missing)")):new Error("Failed to check duplicate group name.")}},Nse=async(r,e=null)=>{const t=tu(r);if(!t)return!1;if(WU(Yt.TASKS,t,e))return!0;try{let n=NA(gl(zr,"tasks"),ac("nameLower","==",t),ip(1));const s=await dc(n);return!(s.empty||e&&s.docs[0].id===e)}catch(n){throw console.error(" Error checking task name uniqueness:",n),n.code==="failed-precondition"&&n.message.includes("index")?(console.error("Firestore index missing: tasks(nameLower ASC)."),new Error("   (Task Index missing)")):new Error("     ")}},YU=async()=>{try{const r=Ws(zr,"settings","global"),e=await eu(r);return e.exists()?e.data():null}catch(r){return console.error(" Error loading global settings:",r),null}},XU=async r=>{try{const e=Ws(zr,"settings","global");await Xu(e,{...r,updatedAt:nl()},{merge:!0}),await PA(),console.log(" Global settings saved.")}catch(e){throw console.error(" Error saving global settings:",e),new Error("Failed to save global settings.")}},JU=Object.freeze(Object.defineProperty({__proto__:null,addDocument:ru,addEvaluation:Cse,addGroup:rse,addStudent:ase,addTask:vse,addTeacher:use,batchDeleteEvaluations:Ese,batchUpdateStudents:lse,checkGroupNameExists:Mse,checkStudentUniqueness:Use,checkTaskNameExists:Nse,clearCollection:ese,deleteAdmin:Lse,deleteDocument:Ya,deleteEvaluation:kse,deleteGroup:sse,deleteStudent:cse,deleteSubject:dse,deleteTask:_se,deleteTeacher:fse,getAdminData:sx,getEvaluationById:Ise,getTeacherByUid:mse,loadAdmins:Tse,loadClasses:ix,loadEvaluations:Bse,loadGlobalSettings:YU,loadGroups:tse,loadGroupsByTeacher:bse,loadSections:xm,loadStudents:ise,loadStudentsByClassAndSection:yse,loadSubjects:_m,loadTasks:wse,loadTeachers:pse,restoreCollection:Zne,restoreTeacher:gse,saveGlobalSettings:XU,updateAdmin:Fse,updateDocument:So,updateEvaluation:Sse,updateGroup:nse,updateStudent:ose,updateSubject:Ase,updateTask:xse,updateTeacher:hse},Symbol.toStringTag,{value:"Module"}));class Pse{constructor(){this.unsubscribeAuthStateListener=null,this._setupAuthStateListener(),console.log("AuthService initialized and listener attached.")}_setupAuthStateListener(){this.unsubscribeAuthStateListener&&this.unsubscribeAuthStateListener(),this.unsubscribeAuthStateListener=FZ(ra,async e=>{console.log("Auth state changed. User:",e?e.email:"Logged out"),ir.setAuthLoading(!0);let t=null;if(e)try{const{getTeacherByUid:n}=await Yf(async()=>{const{getTeacherByUid:i}=await Promise.resolve().then(()=>JU);return{getTeacherByUid:i}},void 0),s=await n(e.uid);if(s){if(s.deleted){console.warn("Teacher account has been deleted:",e.email),await this.logout(),Gt.showToast("     Admin    ","error"),ir.setAuthLoading(!1),Gt.hideLoading();return}const i={uid:e.uid,email:e.email,displayName:e.displayName};ir.setUser(i,{id:e.uid,email:e.email,type:"teacher",permissions:s.permissions||{read:!0,write:!0,edit:!0,delete:!1}}),ir.set("currentTeacher",s),console.log(` Teacher ${e.email} logged in.`)}else{if(t=await sx(e.uid),!t){console.warn(`No admin document for ${e.email}, creating default 'user' profile.`);const a={email:e.email,type:"user",permissions:{read:!0,write:!1,edit:!1,delete:!1},createdAt:nl()};await Xu(Ws(zr,"admins",e.uid),a),t={id:e.uid,...a},_s.clear(`admin_${e.uid}`)}const i={uid:e.uid,email:e.email,displayName:e.displayName};ir.setUser(i,t),console.log(` User ${e.email} logged in. Role: ${t.type}`)}}catch(n){console.error("Auth state change - Error handling user data:",n),Gt.showToast("     ","error");const s={uid:e.uid,email:e.email,displayName:e.displayName};ir.setUser(s,{id:e.uid,email:e.email,type:"user",permissions:{read:!0}})}else ir.setUser(null,null),_s.clearAll(),console.log("User logged out, cache cleared.");ir.setAuthLoading(!1),Gt.hideLoading(),this._triggerUIUpdateCallbacks()},e=>{console.error("Firebase Auth state listener error:",e),ir.setUser(null,null),ir.setAuthLoading(!1),Gt.hideLoading(),Gt.showToast(`     : ${e.message}`,"error"),this._triggerUIUpdateCallbacks()})}async loginWithEmail(e,t){if(!e||!t)throw new Error("   ");if(t.length<6)throw new Error("     ");try{await EZ(ra,e,t),Gt.showToast(` ${e}!`,"success"),Gt.hideModal(Gt.elements.authModal)}catch(n){console.error("Login Error:",n);const s=this._translateAuthError(n,"");throw Gt.showToast(s,"error"),new Error(s)}}async registerWithEmail(e,t,n="user"){var s;if(!e||!t)throw new Error("   ");if(t.length<6)throw new Error("     ");["user","admin"].includes(n)||(n="user");try{const a=(await Lk(ra,e,t)).user;let o={read:!0,write:!1,edit:!1,delete:!1};n==="admin"&&(o={read:!0,write:!0,edit:!1,delete:!1});const l={email:a.email,type:n,permissions:o,createdAt:nl()};await Xu(Ws(zr,"admins",a.uid),l),console.log(`User registered: ${a.email}, Type: ${n}, Doc created.`),await Af(ra),Gt.showToast(" !    ","success")}catch(i){if(console.error("Registration Error:",i),i.code!=="auth/email-already-in-use"&&((s=ra.currentUser)==null?void 0:s.email)===e){try{await Uk(ra.currentUser)}catch(o){console.warn("Failed to delete partially registered auth user:",o)}await Af(ra)}const a=this._translateAuthError(i,"");throw Gt.showToast(a,"error"),new Error(a)}}async registerTeacher(e,t,n){var i;const s=ir.get("currentUserData");if((s==null?void 0:s.type)!=="super-admin")throw new Error("      ");if(!e||!t)throw new Error("   ");if(t.length<6)throw new Error("     ");try{const o=(await Lk(ra,e,t)).user,l={uid:o.uid,email:o.email,name:n.name||e,assignedClasses:n.assignedClasses||[],assignedSections:n.assignedSections||[],assignedSubjects:n.assignedSubjects||[],role:"teacher",permissions:{read:!0,write:!0,edit:!0,delete:!1},createdAt:nl()};return await Xu(Ws(zr,"teachers",o.uid),l),console.log(` Teacher registered: ${o.email}`),await Af(ra),Gt.showToast(` ${e}   `,"success"),o.uid}catch(a){if(console.error("Teacher Registration Error:",a),a.code!=="auth/email-already-in-use"&&((i=ra.currentUser)==null?void 0:i.email)===e){try{await Uk(ra.currentUser)}catch(l){console.warn("Failed to delete partially registered teacher auth user:",l)}await Af(ra)}const o=this._translateAuthError(a," ");throw Gt.showToast(o,"error"),new Error(o)}}async signInWithGoogle(){try{const t=(await XZ(ra,Yne)).user;await sx(t.uid),Gt.showToast("Google   !","success"),Gt.hideModal(Gt.elements.authModal)}catch(e){console.error("Google Sign-In Error:",e);const t=this._translateAuthError(e,"Google  ");throw Gt.showToast(t,"error"),new Error(t)}}async logout(){try{await Af(ra),Gt.showToast("  ","info")}catch(e){console.error("Logout Error:",e);const t=this._translateAuthError(e,"");throw Gt.showToast(t,"error"),new Error(t)}}_translateAuthError(e,t=""){let n=`    (${(e==null?void 0:e.code)||"UNKNOWN"})`;switch(e==null?void 0:e.code){case"auth/user-not-found":case"auth/wrong-password":case"auth/invalid-credential":n="   ";break;case"auth/invalid-email":n="   ";break;case"auth/email-already-in-use":n="     ";break;case"auth/weak-password":n="  (  )";break;case"auth/too-many-requests":n=" ,   ";break;case"auth/network-request-failed":n="    ";break;case"auth/popup-closed-by-user":n="     ";break;case"auth/cancelled-popup-request":case"auth/popup-blocked":n="     ";break;case"auth/operation-not-allowed":n="     ";break;case"auth/requires-recent-login":n="       ";break}return`${t}  : ${n}`}_triggerUIUpdateCallbacks(){var a,o,l,c,A;const e=ir.get("currentUser"),t=ir.get("currentUserData"),n=(t==null?void 0:t.type)||"user";Gt.updateUserInfo(t),Gt.enableNavigation(!!e,n);const s=ir.get("activePage"),i=((a=window.smartEvaluator)==null?void 0:a.publicPages)||["dashboard"];!e&&s&&!i.includes(s)&&(console.log(`User logged out from private page "${s}", redirecting to dashboard.`),Gt.showPage("dashboard"),(l=(o=window.smartEvaluator)==null?void 0:o.components.dashboard)==null||l.render()),(A=(c=window.smartEvaluator)==null?void 0:c.components.settings)==null||A.applySettings()}}const Al=new Pse,Dse=Al.loginWithEmail.bind(Al),Rse=Al.registerWithEmail.bind(Al),Ose=Al.signInWithGoogle.bind(Al),Qse=Al.logout.bind(Al);function DA(){const r=ir.get("currentUserData");return(r==null?void 0:r.type)==="super-admin"?{read:!0,write:!0,edit:!0,delete:!0}:(r==null?void 0:r.permissions)||{read:!0,write:!1,edit:!1,delete:!1}}function nu(){const r=ir.get("currentUserData");return(r==null?void 0:r.type)||"user"}function ZU(){return DA().read===!0}function eM(){return DA().write===!0}function tM(){return DA().edit===!0}function rM(){return DA().delete===!0}function op(r){return DA()[r]===!0}function nM(r,e=null){if(!op(r)){const n=e||{read:"     ",write:"      ",edit:"     ",delete:"     "}[r]||"     ";return Gt.showToast(n,"warning"),!1}return!0}function lp(){return nu()==="super-admin"}function sM(){const r=nu();return r==="admin"||r==="super-admin"}function iM(){return nu()==="user"}function aM(){return nu()==="teacher"}function oM(){return lp()}function lM(){return lp()}function cM(){return lp()}function AM(){const r=DA(),e=nu();let n=` : ${{"super-admin":" ",admin:"",user:""}[e]||e}
`;n+=": ";const s=[];return r.read&&s.push(""),r.write&&s.push(" "),r.edit&&s.push(""),r.delete&&s.push(" "),n+=s.length>0?s.join(", "):" ",n}function dM(r,e){if(!r)return;op(e)?(r.classList.remove("hidden"),r.disabled=!1):(r.classList.add("hidden"),r.disabled=!0)}function uM(r,e){if(!r)return;op(e)?(r.disabled=!1,r.classList.remove("opacity-50","cursor-not-allowed"),r.title=""):(r.disabled=!0,r.classList.add("opacity-50","cursor-not-allowed"),r.title="     ")}const Hse={getUserPermissions:DA,getUserType:nu,canRead:ZU,canWrite:eM,canEdit:tM,canDelete:rM,hasPermission:op,enforcePermission:nM,isSuperAdmin:lp,isAdmin:sM,isRegularUser:iM,isTeacher:aM,canManageTeachers:oM,canManageClasses:lM,canDeleteOverride:cM,getPermissionSummary:AM,toggleElementByPermission:dM,disableIfNoPermission:uM},jse=Object.freeze(Object.defineProperty({__proto__:null,canDelete:rM,canDeleteOverride:cM,canEdit:tM,canManageClasses:lM,canManageTeachers:oM,canRead:ZU,canWrite:eM,default:Hse,disableIfNoPermission:uM,enforcePermission:nM,getPermissionSummary:AM,getUserPermissions:DA,getUserType:nu,hasPermission:op,isAdmin:sM,isRegularUser:iM,isSuperAdmin:lp,isTeacher:aM,toggleElementByPermission:dM},Symbol.toStringTag,{value:"Module"}));async function RA(r){const e=document.createElement("iframe");e.style.position="fixed",e.style.right="0",e.style.bottom="0",e.style.width="0",e.style.height="0",e.style.border="0",document.body.appendChild(e);const t=e.contentWindow.document;t.open(),t.write(`
    <!DOCTYPE html>
    <html lang="bn">
    <head>
      <meta charset="UTF-8">
      <title>Report</title>
      <script src="https://cdn.tailwindcss.com"><\/script>
      <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Bengali:wght@400;500;600;700&display=swap" rel="stylesheet">
      <style>
        body { 
          font-family: 'Noto Sans Bengali', sans-serif; 
          -webkit-print-color-adjust: exact; 
          print-color-adjust: exact;
        }
        @media print {
          @page { margin: 5mm; size: A4; }
          body { -webkit-print-color-adjust: exact; }
        }
      </style>
    </head>
    <body class="bg-white text-gray-900 p-4">
      ${r}
      <script>
        // Wait for fonts and styles to load before printing
        window.onload = () => {
          setTimeout(() => {
            window.print();
            window.onafterprint = () => {
              // Optional: Notify parent window
            };
          }, 1000); // Small delay to ensure rendering
        };
      <\/script>
    </body>
    </html>
  `),t.close(),setTimeout(()=>{document.body.removeChild(e)},6e4)}async function Vse(r,e){const t=new Date().toLocaleDateString("bn-BD"),n=r.map((i,a)=>`
    <tr class="border-b border-gray-200 ${a%2===0?"bg-gray-50":"bg-white"}">
      <td class="py-2 px-3 text-left">${i.groupName}</td>
      <td class="py-2 px-3 text-center">${jr(i.studentCount)}</td>
      <td class="py-2 px-3 text-center">${jr(i.evaluationCount)}</td>
      <td class="py-2 px-3 text-center">${jr(i.averageScore)}%</td>
      <td class="py-2 px-3 text-center">${jr(i.participationRate)}%</td>
    </tr>
  `).join(""),s=`
    <div class="font-bengali">
      <div class="text-center mb-6">
        <h1 class="text-2xl font-bold text-blue-700 mb-2">  </h1>
        <h2 class="text-xl font-semibold text-gray-700">   </h2>
        <p class="text-sm text-gray-500 mt-1">: ${t}</p>
      </div>
      
      <table class="w-full border-collapse border border-gray-300 text-sm">
        <thead>
          <tr class="bg-blue-600 text-white">
            <th class="py-2 px-3 text-left font-semibold"> </th>
            <th class="py-2 px-3 text-center font-semibold"></th>
            <th class="py-2 px-3 text-center font-semibold"></th>
            <th class="py-2 px-3 text-center font-semibold"> </th>
            <th class="py-2 px-3 text-center font-semibold"></th>
          </tr>
        </thead>
        <tbody>
          ${n}
        </tbody>
      </table>
      
      <div class="mt-8 text-xs text-gray-400 text-center border-t pt-2">
              
      </div>
    </div>
  `;await RA(s),e.showToast("   ...","info")}async function $se(r,e,t,n,s){const i=new Date().toLocaleDateString("bn-BD"),a=r.map((l,c)=>{var A,d;return`
    <tr class="border-b border-gray-200 ${c%2===0?"bg-gray-50":"bg-white"}">
      <td class="py-2 px-2 text-center">${jr(l.roll)}</td>
      <td class="py-2 px-2 text-left font-medium">${l.name}</td>
      <td class="py-2 px-2 text-center">${((A=n==null?void 0:n.get(l.classId))==null?void 0:A.name)||"-"}</td>
      <td class="py-2 px-2 text-center">${((d=s==null?void 0:s.get(l.sectionId))==null?void 0:d.name)||"-"}</td>
      <td class="py-2 px-2 text-left">${e.get(l.groupId)||"-"}</td>
      <td class="py-2 px-2 text-center">${l.academicGroup||"-"}</td>
      <td class="py-2 px-2 text-center">${l.gender||"-"}</td>
      <td class="py-2 px-2 text-center">${l.contact||"-"}</td>
    </tr>
  `}).join(""),o=`
    <div class="font-bengali">
      <div class="text-center mb-6">
        <h1 class="text-2xl font-bold text-indigo-700 mb-2">  </h1>
        <h2 class="text-xl font-semibold text-gray-700">  </h2>
        <p class="text-sm text-gray-500 mt-1"> : ${jr(r.length)}  | : ${i}</p>
      </div>
      
      <table class="w-full border-collapse border border-gray-300 text-xs">
        <thead>
          <tr class="bg-indigo-600 text-white">
            <th class="py-2 px-2 text-center font-semibold w-16"></th>
            <th class="py-2 px-2 text-left font-semibold"></th>
            <th class="py-2 px-2 text-center font-semibold"></th>
            <th class="py-2 px-2 text-center font-semibold"></th>
            <th class="py-2 px-2 text-left font-semibold"></th>
            <th class="py-2 px-2 text-center font-semibold"></th>
            <th class="py-2 px-2 text-center font-semibold"></th>
            <th class="py-2 px-2 text-center font-semibold"></th>
          </tr>
        </thead>
        <tbody>
          ${a}
        </tbody>
      </table>
      
      <div class="mt-8 text-xs text-gray-400 text-center border-t pt-2">
              
      </div>
    </div>
  `;await RA(o),t.showToast("   ...","info")}async function Gse(r,e,t,n,s){const i=new Date().toLocaleDateString("bn-BD");let a="";r.forEach(l=>{const c=e.filter(d=>d.groupId===l.id);if(c.length===0)return;const A=c.map((d,h)=>{var u,p;return`
      <tr class="border-b border-gray-100 ${h%2===0?"bg-gray-50":"bg-white"}">
        <td class="py-1 px-2 text-center">${jr(d.roll)}</td>
        <td class="py-1 px-2 text-left">${d.name}</td>
        <td class="py-1 px-2 text-center">${((u=n==null?void 0:n.get(d.classId))==null?void 0:u.name)||"-"}</td>
        <td class="py-1 px-2 text-center">${((p=s==null?void 0:s.get(d.sectionId))==null?void 0:p.name)||"-"}</td>
        <td class="py-1 px-2 text-center">${d.role||"-"}</td>
        <td class="py-1 px-2 text-center">${d.contact||"-"}</td>
      </tr>
    `}).join("");a+=`
      <div class="mb-8 break-inside-avoid">
        <h3 class="text-lg font-bold text-purple-700 mb-2 border-b-2 border-purple-200 pb-1">
          ${l.name} <span class="text-sm font-normal text-gray-500 ml-2">(${jr(c.length)} )</span>
        </h3>
        <table class="w-full border-collapse border border-gray-200 text-xs">
          <thead>
            <tr class="bg-purple-100 text-purple-900">
              <th class="py-1 px-2 text-center w-16"></th>
              <th class="py-1 px-2 text-left"></th>
              <th class="py-1 px-2 text-center"></th>
              <th class="py-1 px-2 text-center"></th>
              <th class="py-1 px-2 text-center"></th>
              <th class="py-1 px-2 text-center"></th>
            </tr>
          </thead>
          <tbody>
            ${A}
          </tbody>
        </table>
      </div>
    `});const o=`
    <div class="font-bengali">
      <div class="text-center mb-6">
        <h1 class="text-2xl font-bold text-purple-700 mb-2">  </h1>
        <h2 class="text-xl font-semibold text-gray-700">   </h2>
        <p class="text-sm text-gray-500 mt-1">: ${i}</p>
      </div>
      
      <div class="space-y-4">
        ${a}
      </div>
      
      <div class="mt-8 text-xs text-gray-400 text-center border-t pt-2">
              
      </div>
    </div>
  `;await RA(o),t.showToast("   ...","info")}function jr(r){if(r==null)return"-";const e=["0","1","2","3","4","5","6","7","8","9"],t=["","","","","","","","","",""];return String(r).split("").map(n=>{const s=e.indexOf(n);return s>-1?t[s]:n}).join("")}function zse(r){if(!r)return 0;if(typeof r=="object"&&r.seconds)return r.seconds*1e3;const e=Date.parse(r);return Number.isFinite(e)?e:0}function W2(r){return{"team-leader":" ","time-keeper":" ",reporter:"","resource-manager":" ","peace-maker":" "}[String(r||"").trim()]||(r?String(r):"")}function hM(r){return{"team-leader":"bg-amber-50 text-amber-700 border-amber-200","time-keeper":"bg-sky-50 text-sky-700 border-sky-200",reporter:"bg-purple-50 text-purple-700 border-purple-200","resource-manager":"bg-emerald-50 text-emerald-700 border-emerald-200","peace-maker":"bg-rose-50 text-rose-700 border-rose-200"}[String(r||"").trim()]||"bg-gray-50 text-gray-700 border-gray-200"}function fM(r){const e=Number(r)||0;return e>=85?"bg-emerald-50 text-emerald-700":e>=70?"bg-sky-50 text-sky-700":e>=55?"bg-amber-50 text-amber-700":"bg-rose-50 text-rose-700"}function Kse(r,e,t,n,s){const i=new Map(n.map(u=>[u==null?void 0:u.id,u])),a=t.filter(u=>String(u==null?void 0:u.groupId)===String(r)),o=new Set(a.map(u=>String(u==null?void 0:u.id))),c=s.filter(u=>String(u==null?void 0:u.groupId)===String(r)).map(u=>{const p=i.get(u==null?void 0:u.taskId),f=parseFloat(u==null?void 0:u.maxPossibleScore)||parseFloat(p==null?void 0:p.maxScore)||100;let g=0,m=0,x=null,S=-1;if(f>0&&(u!=null&&u.scores))for(const[F,N]of Object.entries(u.scores)){if(!o.has(String(F)))continue;const w=(parseFloat(N==null?void 0:N.totalScore)||0)/f*100;g++,m+=w,w>S&&(S=w,x=F)}const B=zse((u==null?void 0:u.taskDate)||(u==null?void 0:u.updatedAt)||(u==null?void 0:u.evaluationDate)||(u==null?void 0:u.createdAt)||(p==null?void 0:p.date));return{ev:u,task:p,ts:B,avgPct:g?m/g:0,count:g,topStudentId:x,topPct:S}}),A=c.length?c.reduce((u,p)=>u+p.avgPct,0)/c.length:0,h=e.map(u=>{const p=String(u==null?void 0:u.id),g=s.filter(m=>String(m==null?void 0:m.groupId)===p).map(m=>{const x=i.get(m==null?void 0:m.taskId),S=parseFloat(m==null?void 0:m.maxPossibleScore)||parseFloat(x==null?void 0:x.maxScore)||100;if(S<=0||!(m!=null&&m.scores))return 0;let B=0,F=0;for(const N of Object.values(m.scores)){const E=parseFloat(N==null?void 0:N.totalScore)||0;B++,F+=E/S*100}return B?F/B:0});return{id:p,avg:g.length?g.reduce((m,x)=>m+x,0)/g.length:-1}}).filter(u=>u.avg>=0).sort((u,p)=>p.avg-u.avg).findIndex(u=>u.id===String(r));return{members:a,perEval:c,groupAvg:A,rank:h>=0?h+1:null}}async function qse(r,e,t,n,s){const i=new Date().toLocaleDateString("bn-BD");let a="";const o=[...r].sort((c,A)=>(c.name||"").localeCompare(A.name||"","bn"));for(const c of o){const{perEval:A,groupAvg:d,rank:h}=Kse(c.id,r,e,t,n),u=`
      <div class="grid grid-cols-4 gap-3 mb-6">
        <div class="flex items-center gap-3 rounded-xl border border-gray-200 bg-gray-50 p-3">
          <div class="text-indigo-600"><i class="fa-solid fa-layer-group text-xl"></i></div>
          <div><div class="text-xs text-gray-500">Group</div><div class="text-sm font-semibold">${c.name}</div></div>
        </div>
        <div class="flex items-center gap-3 rounded-xl border border-gray-200 bg-gray-50 p-3">
          <div class="text-emerald-600"><i class="fa-solid fa-chart-line text-xl"></i></div>
          <div><div class="text-xs text-gray-500">Average %</div><div class="text-sm font-semibold">${d.toFixed(2)}%</div></div>
        </div>
        <div class="flex items-center gap-3 rounded-xl border border-gray-200 bg-gray-50 p-3">
          <div class="text-amber-600"><i class="fa-solid fa-crown text-xl"></i></div>
          <div><div class="text-xs text-gray-500">Rank</div><div class="text-sm font-semibold">${h?jr(h):"-"}</div></div>
        </div>
        <div class="flex items-center gap-3 rounded-xl border border-gray-200 bg-gray-50 p-3">
          <div class="text-sky-600"><i class="fa-solid fa-percent text-xl"></i></div>
          <div><div class="text-xs text-gray-500">Evaluations</div><div class="text-sm font-semibold">${jr(A.length)}</div></div>
        </div>
      </div>
    `,g=`
      <h4 class="text-sm font-bold text-gray-700 mb-2 uppercase">Evaluations Summary</h4>
      <table class="w-full border-collapse border border-gray-200 text-xs mb-6">
        <thead class="bg-gray-100">
          <tr>
            <th class="px-3 py-2 text-left">Assignment</th>
            <th class="px-3 py-2 text-left">Date</th>
            <th class="px-3 py-2 text-center">Evaluated</th>
            <th class="px-3 py-2 text-center">Avg %</th>
          </tr>
        </thead>
        <tbody>${A.slice().sort((m,x)=>(x.ts||0)-(m.ts||0)).map((m,x)=>{var S;return`
      <tr class="border-b border-gray-100">
        <td class="px-3 py-2">${((S=m.task)==null?void 0:S.name)||"Assignment-"+(x+1)}</td>
        <td class="px-3 py-2">${m.ts?new Date(m.ts).toLocaleDateString("bn-BD"):"-"}</td>
        <td class="px-3 py-2 text-center">${jr(m.count)}</td>
        <td class="px-3 py-2 text-center">${m.avgPct.toFixed(2)}%</td>
      </tr>
    `}).join("")}</tbody>
      </table>
    `;a+=`
      <div class="break-after-page mb-8">
        <h2 class="text-xl font-bold text-indigo-800 mb-4 border-b-2 border-indigo-100 pb-2">${c.name}</h2>
        ${u}
        ${g}
      </div>
    `}const l=`
    <div class="font-bengali">
      <div class="text-center mb-8">
        <h1 class="text-2xl font-bold text-indigo-700">  </h1>
        <h2 class="text-lg font-semibold text-gray-600">   </h2>
        <p class="text-sm text-gray-500">: ${i}</p>
      </div>
      ${a}
    </div>
  `;await RA(l),s.showToast("   ...","info")}async function Wse(r,e,t,n,s,i,a,o){const l=new Date().toLocaleDateString("bn-BD");let c="";const A=String(r),d=n.find(f=>String(f.id)===A),h=d?d.name:"Unknown Assignment",u=[...e].sort((f,g)=>(f.name||"").localeCompare(g.name||"","bn"));for(const f of u){const g=s.find(N=>String(N.groupId)===String(f.id)&&String(N.taskId)===A);if(!g)continue;const m=parseFloat(g.maxPossibleScore)||parseFloat(d==null?void 0:d.maxScore)||100;g.scores;const B=m>0?0/0/m*100:0,F=studentRows.map(N=>{var E,w;return`
      <tr class="border-b border-gray-100">
        <td class="px-2 py-1 text-center">${jr(N.roll)}</td>
        <td class="px-2 py-1 font-medium">${N.name}</td>
        <td class="px-2 py-1 text-center text-xs">${((E=a==null?void 0:a.get(N.classId))==null?void 0:E.name)||"-"}</td>
        <td class="px-2 py-1 text-center text-xs">${((w=o==null?void 0:o.get(N.sectionId))==null?void 0:w.name)||"-"}</td>
        <td class="px-2 py-1 text-xs text-gray-500">${W2(N.role)}</td>
        <td class="px-2 py-1 text-right font-bold">${N.total.toFixed(2)}</td>
        <td class="px-2 py-1 text-right"><span class="px-1 py-0.5 rounded text-xs ${fM(N.pct)}">${N.pct.toFixed(1)}%</span></td>
        <td class="px-2 py-1 text-center">
             ${(()=>{const v=N.topic;return v==="topic_understood"||v==="topic_none"?N.problemRecovered?'<span class="text-[9px] text-green-600 font-bold whitespace-nowrap">Problem Resolved</span>':'<span class="text-[9px] text-red-600 font-bold whitespace-nowrap">Have a problem</span>':v==="topic_learned_well"&&N.problemRecovered?'<span class="text-[9px] text-green-600 font-bold whitespace-nowrap">Problem Resolved</span>':"-"})()}
        </td>
      </tr>
    `}).join("");c+=`
      <div class="mb-8 break-inside-avoid">
        <div class="flex items-center justify-between mb-2 border-b border-gray-200 pb-1">
          <h3 class="text-lg font-bold text-indigo-700">${f.name}</h3>
          <div class="text-sm text-gray-600">Avg: <span class="font-bold">${B.toFixed(2)}%</span></div>
        </div>
        <table class="w-full border-collapse border border-gray-200 text-xs">
          <thead class="bg-gray-50">
            <tr>
              <th class="px-2 py-1 text-center w-12">Roll</th>
              <th class="px-2 py-1 text-left">Name</th>
              <th class="px-2 py-1 text-center">Class</th>
              <th class="px-2 py-1 text-center">Section</th>
              <th class="px-2 py-1 text-left">Role</th>
              <th class="px-2 py-1 text-right">Total</th>
              <th class="px-2 py-1 text-right">%</th>
              <th class="px-2 py-1 text-center">Status</th>
            </tr>
          </thead>
          <tbody>${F}</tbody>
        </table>
      </div>
    `}const p=`
    <div class="font-bengali">
      <div class="text-center mb-8">
        <h1 class="text-2xl font-bold text-indigo-700">  </h1>
        <h2 class="text-lg font-semibold text-gray-600"> :</h2>
        <h2 class="text-lg font-semibold text-gray-600">${h}</h2>
        <p class="text-sm text-gray-500">: ${l}</p>
      </div>
      <div class="space-y-6">
        ${c||'<p class="text-center text-gray-500">      </p>'}
      </div>
    </div>
  `;await RA(p),i.showToast("   ...","info")}async function Yse(r,e,t,n,s,i="all",a=null,o,l){const c=new Date().toLocaleDateString("bn-BD");let A="",d=[...r].sort((x,S)=>(x.name||"").localeCompare(S.name||"","bn"));a&&(d=d.filter(x=>String(x.id)===String(a)));const h=i!=="all",u=h?t.find(x=>String(x.id)===String(i)):null,p=h?"":"    ",f=h&&(u!=null&&u.date)?new Date(u.date).toLocaleDateString("bn-BD"):c,g=new Map;e.forEach(x=>{g.set(x.id,{totalScore:0,maxPossible:0,evalCount:0,taskScore:0,teamScore:0,ProgressScore:0,mcqScore:0,comment:"",problemRecovered:!1,topic:null})}),n.forEach(x=>{if(h&&String(x.taskId)!==String(i))return;const S=t.find(F=>String(F.id)===String(x.taskId)),B=parseFloat(x.maxPossibleScore)||parseFloat(S==null?void 0:S.maxScore)||100;x.scores&&Object.entries(x.scores).forEach(([F,N])=>{var w;const E=g.get(F);if(E){const v=parseFloat(N.totalScore)||0;E.totalScore+=v,E.maxPossible+=B,E.evalCount++,E.taskScore+=parseFloat(N.taskScore)||0,E.teamScore+=parseFloat(N.teamScore)||0,E.ProgressScore+=parseFloat(N.ProgressScore)||0,E.mcqScore+=parseFloat(N.mcqScore)||0,h&&(E.comment=N.comments||"",E.problemRecovered=N.problemRecovered||!1,E.topic=((w=N.ProgressCriteria)==null?void 0:w.topic)||null)}})});for(const x of d){const S=e.filter(I=>I.groupId===x.id);if(S.length===0)continue;let B=0,F=0;const N=S.map(I=>{const k=g.get(I.id),_=k.maxPossible>0?k.totalScore/k.maxPossible*100:0;k.evalCount>0&&(B+=_,F++);const T=h?1:k.evalCount||1,L={task:(k.taskScore/T).toFixed(1),team:(k.teamScore/T).toFixed(1),add:(k.ProgressScore/T).toFixed(1),mcq:(k.mcqScore/T).toFixed(1),total:k.totalScore.toFixed(1),max:k.maxPossible},K=k.evalCount>0?100:0,se=K>=80?"text-emerald-600":K>=50?"text-amber-600":"text-rose-600";return{...I,stats:k,displayStats:L,avgPct:_,participationRate:K,participationClass:se}}).sort((I,k)=>k.avgPct-I.avgPct),E=F>0?B/F:0,w=N.map((I,k)=>{var _,T;return`
      <tr class="border-b border-gray-100 ${k%2===0?"bg-gray-50":"bg-white"} hover:bg-indigo-50 transition-colors">
        <td class="px-2 py-2 text-center border-r border-gray-100">${jr(I.roll)}</td>
        <td class="px-3 py-2 font-medium border-r border-gray-100">
          ${I.name}
          <div class="text-[10px] text-gray-500">${I.academicGroup||""}</div>
        </td>
        <td class="px-2 py-2 text-center border-r border-gray-100 text-xs">${((_=o==null?void 0:o.get(I.classId))==null?void 0:_.name)||"-"}</td>
        <td class="px-2 py-2 text-center border-r border-gray-100 text-xs">${((T=l==null?void 0:l.get(I.sectionId))==null?void 0:T.name)||"-"}</td>
        <td class="px-2 py-2 text-center border-r border-gray-100 whitespace-nowrap">
          <span class="px-2 py-0.5 rounded-full text-[10px] border ${hM(I.role)}">
            ${W2(I.role)||""}
          </span>
        </td>
        <td class="px-2 py-2 text-center border-r border-gray-100 font-bold text-gray-700">
             ${jr(I.stats.evalCount>0?1:0)}
        </td>
        ${h?"":`<td class="px-2 py-2 text-center border-r border-gray-100">${jr(I.stats.evalCount)}</td>`}
        <td class="px-2 py-2 text-center text-gray-600 border-r border-gray-100">${I.displayStats.task}</td>
        <td class="px-2 py-2 text-center text-gray-600 border-r border-gray-100">${I.displayStats.team}</td>
        <td class="px-2 py-2 text-center text-gray-600 border-r border-gray-100">${I.displayStats.add}</td>
        <td class="px-2 py-2 text-center text-gray-600 border-r border-gray-100">${I.displayStats.mcq}</td>
        <td class="px-2 py-2 text-right font-mono text-gray-800 font-bold border-r border-gray-100">${I.displayStats.total} / ${I.displayStats.max}</td>
        <td class="px-2 py-2 text-right border-r border-gray-100">
          <span class="font-bold ${fM(I.avgPct)} px-1.5 py-0.5 rounded">
            ${I.avgPct.toFixed(1)}%
          </span>
        </td>
        <td class="px-2 py-2 text-center border-r border-gray-100">
          ${(()=>{if(h){const L=I.stats.topic;if(L==="topic_understood"||L==="topic_none")return I.stats.problemRecovered?'<span class="text-[9px] text-green-600 font-bold whitespace-nowrap">Problem Resolved</span>':'<span class="text-[9px] text-red-600 font-bold whitespace-nowrap">Have a problem</span>';if(L==="topic_learned_well"&&I.stats.problemRecovered)return'<span class="text-[9px] text-green-600 font-bold whitespace-nowrap">Problem Resolved</span>'}return"-"})()}
        </td>
      </tr>
    `}).join(""),v=h?`
      <div class="bg-indigo-50 border-b border-indigo-100 px-4 py-2 flex justify-between items-center text-xs text-indigo-800">
        <div class="font-semibold"><i class="fas fa-file-alt mr-1"></i> ${(u==null?void 0:u.name)||""}</div>
        <div><i class="far fa-calendar-alt mr-1"></i> ${f}</div>
      </div>
    `:"";A+=`
      <div class="break-inside-avoid mb-8 border border-gray-200 rounded-xl overflow-hidden shadow-sm">
        <div class="bg-gradient-to-r from-gray-50 to-white border-b border-gray-200 p-4 flex justify-between items-center">
          <div>
            <h3 class="text-lg font-bold text-gray-800 flex items-center gap-2">
              <i class="fas fa-layer-group text-indigo-500"></i> ${x.name}
            </h3>
            <p class="text-xs text-gray-500 mt-1">: ${jr(S.length)} </p>
          </div>
          <div class="text-right">
            <div class="text-xs text-gray-500"> </div>
            <div class="text-xl font-bold text-indigo-600">${E.toFixed(1)}%</div>
          </div>
        </div>
        
        ${v}

        <table class="w-full text-xs table-fixed border-collapse">
          <thead class="bg-indigo-600 text-white uppercase tracking-wider text-[10px]">
            <tr>
              <th class="px-2 py-3 text-center font-bold w-[6%] border-r border-indigo-500/30"></th>
              <th class="px-3 py-3 text-left font-bold w-[20%] border-r border-indigo-500/30"></th>
              <th class="px-2 py-3 text-center font-bold w-[8%] border-r border-indigo-500/30"></th>
              <th class="px-2 py-3 text-center font-bold w-[8%] border-r border-indigo-500/30"></th>
              <th class="px-2 py-3 text-center font-bold w-[12%] border-r border-indigo-500/30 whitespace-nowrap"></th>
              <th class="px-2 py-3 text-center font-bold w-[8%] border-r border-indigo-500/30"></th>
              ${h?"":'<th class="px-2 py-3 text-center font-bold w-[8%] border-r border-indigo-500/30"></th>'}
              <th class="px-2 py-3 text-center font-bold w-[8%] border-r border-indigo-500/30"></th>
              <th class="px-2 py-3 text-center font-bold w-[8%] border-r border-indigo-500/30"></th>
              <th class="px-2 py-3 text-center font-bold w-[8%] border-r border-indigo-500/30"></th>
              <th class="px-2 py-3 text-center font-bold w-[8%] border-r border-indigo-500/30">MCQ</th>
              <th class="px-2 py-3 text-right font-bold w-[9%] border-r border-indigo-500/30"></th>
              <th class="px-2 py-3 text-right font-bold w-[9%] border-r border-indigo-500/30"> %</th>
              <th class="px-2 py-3 text-center font-bold w-[10%] border-r border-indigo-500/30"></th>
            </tr>
          </thead>
          <tbody class="divide-y divide-gray-100">
            ${w}
          </tbody>
        </table>
      </div>
    `}const m=`
    <div class="font-bengali bg-white min-h-screen">
      <!-- Top Header Section -->
      <div class="flex justify-between items-end border-b-[3px] border-indigo-600 pb-4 mb-8">
        <div>
          <h1 class="text-4xl font-extrabold text-indigo-800 tracking-tight mb-1">  </h1>
          <div class="flex items-center gap-2 text-sm text-gray-600 font-medium">
            <span class="bg-indigo-100 text-indigo-700 px-2 py-0.5 rounded"> </span>
            <span>|</span>
            <span>: -</span>
          </div>
        </div>
        <div class="text-right">
          <div class="text-[10px] text-gray-400 uppercase tracking-widest font-bold mb-1">  </div>
          <div class="text-xl font-bold text-gray-800 font-mono bg-gray-50 px-3 py-1 rounded border border-gray-200 inline-block">
            ${new Date().toLocaleDateString("bn-BD")}
          </div>
        </div>
      </div>

      <!-- Report Title Card -->
      <div class="mb-10 bg-gradient-to-br from-indigo-50 to-white rounded-2xl border border-indigo-100 p-6 shadow-sm text-center relative overflow-hidden">
        <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-indigo-400 to-purple-400"></div>
        
        ${p?`<h2 class="text-2xl font-bold text-gray-800 mb-2">${p}</h2>`:""}
        ${h?`<div class="inline-block bg-white border border-indigo-100 text-indigo-600 px-4 py-1 rounded-full text-sm font-semibold shadow-sm mb-4">${u==null?void 0:u.name}</div>`:""}
        
        <div class="flex justify-center flex-wrap gap-4 mt-2">
          <div class="flex items-center gap-2 bg-white px-3 py-1.5 rounded-lg border border-gray-100 shadow-sm">
            <div class="w-8 h-8 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-600"><i class="fas fa-layer-group"></i></div>
            <div class="text-left">
              <div class="text-[10px] text-gray-400 uppercase font-bold"> </div>
              <div class="text-sm font-bold text-gray-700">${jr(d.length)}</div>
            </div>
          </div>
          <div class="flex items-center gap-2 bg-white px-3 py-1.5 rounded-lg border border-gray-100 shadow-sm">
            <div class="w-8 h-8 rounded-full bg-emerald-100 flex items-center justify-center text-emerald-600"><i class="fas fa-users"></i></div>
            <div class="text-left">
              <div class="text-[10px] text-gray-400 uppercase font-bold"> </div>
              <div class="text-sm font-bold text-gray-700">${jr(e.length)}</div>
            </div>
          </div>
          <div class="flex items-center gap-2 bg-white px-3 py-1.5 rounded-lg border border-gray-100 shadow-sm">
             <div class="w-8 h-8 rounded-full bg-amber-100 flex items-center justify-center text-amber-600"><i class="far fa-calendar-alt"></i></div>
             <div class="text-left">
               <div class="text-[10px] text-gray-400 uppercase font-bold"></div>
               <div class="text-sm font-bold text-gray-700">${f}</div>
             </div>
          </div>
        </div>

        <!-- Developer Info -->
        <div class="mt-6 pt-4 border-t border-indigo-50">
          <div class="inline-flex items-center gap-2 bg-indigo-50 px-4 py-2 rounded-full border border-indigo-100">
            <i class="fas fa-code text-indigo-500 text-sm"></i>
            <span class="text-xs font-medium text-indigo-800">
               : <span class="font-bold">  </span>,  ,  ( ) | : <span class="font-mono font-bold">01840-643936</span>
            </span>
          </div>
        </div>
      </div>
      
      <!-- Main Content -->
      <div class="space-y-8">
        ${A}
      </div>
      
      <!-- Footer -->
      <div class="mt-16 pt-8 border-t border-gray-200 flex justify-between items-end">
        <div class="text-xs text-gray-400">
          <p class="font-semibold text-gray-500 mb-1">   </p>
          <p>    </p>
        </div>
        <div class="text-right text-xs">
          <p class="text-gray-400 mb-1"> </p>
          <p class="font-bold text-indigo-600 text-sm">   </p>
          <p class="text-[10px] text-gray-400 mt-0.5"> ${new Date().getFullYear()}    </p>
        </div>
      </div>
    </div>
  `;await RA(m),s.showToast("   ...","info")}async function Xse(r,e,t,n){const s=new Date().toLocaleDateString("bn-BD"),i=r.metric||{},a=i.groupName||"Group",o=r.members||[],l=r.evaluations||[],c=`
    <div class="grid grid-cols-4 gap-4 mb-6">
      <div class="p-4 bg-blue-50 rounded-lg border border-blue-100">
        <div class="text-xs text-blue-600 uppercase font-semibold"> </div>
        <div class="text-2xl font-bold text-blue-800">${jr(i.evaluationCount)}</div>
      </div>
      <div class="p-4 bg-emerald-50 rounded-lg border border-emerald-100">
        <div class="text-xs text-emerald-600 uppercase font-semibold">  </div>
        <div class="text-2xl font-bold text-emerald-800">${jr(i.averageScore)}%</div>
      </div>
      <div class="p-4 bg-indigo-50 rounded-lg border border-indigo-100">
        <div class="text-xs text-indigo-600 uppercase font-semibold"> </div>
        <div class="text-2xl font-bold text-indigo-800">${jr(i.participationRate)}%</div>
      </div>
      <div class="p-4 bg-amber-50 rounded-lg border border-amber-100">
        <div class="text-xs text-amber-600 uppercase font-semibold"> </div>
        <div class="text-2xl font-bold text-amber-800">${jr(i.pendingStudents)}</div>
      </div>
    </div>
  `,d=`
    <div class="mb-8 break-inside-avoid">
      <h3 class="text-lg font-bold text-gray-800 mb-3 border-b pb-2"> </h3>
      <table class="w-full text-xs border border-gray-200">
        <thead class="bg-gray-100 text-gray-600 uppercase">
          <tr>
            <th class="px-3 py-2 text-left"></th>
            <th class="px-3 py-2 text-center"></th>
            <th class="px-3 py-2 text-center"></th>
            <th class="px-3 py-2 text-center"></th>
            <th class="px-3 py-2 text-center"></th>
            <th class="px-3 py-2 text-center"></th>
            <th class="px-3 py-2 text-center"> </th>
            <th class="px-3 py-2 text-center"> </th>
            <th class="px-3 py-2 text-center"> </th>
            <th class="px-3 py-2 text-center">MCQ </th>
            <th class="px-3 py-2 text-center"> </th>
          </tr>
        </thead>
        <tbody>${o.map((f,g)=>{var m,x;return`
    <tr class="border-b border-gray-100 ${g%2===0?"bg-gray-50":"bg-white"}">
      <td class="px-3 py-2 font-medium">
        ${f.name}
        <div class="text-[10px] text-gray-500">${f.academicGroup||""}</div>
      </td>
      <td class="px-3 py-2 text-center">${jr(f.roll)}</td>
      <td class="px-3 py-2 text-center text-xs">${((m=t==null?void 0:t.get(f.classId))==null?void 0:m.name)||"-"}</td>
      <td class="px-3 py-2 text-center text-xs">${((x=n==null?void 0:n.get(f.sectionId))==null?void 0:x.name)||"-"}</td>
      <td class="px-3 py-2 text-center text-xs">
        <span class="px-2 py-0.5 rounded-full border ${hM(f.role)}">
          ${W2(f.role)}
        </span>
      </td>
      <td class="px-3 py-2 text-center">${jr(f.evaluationCount)}</td>
      <td class="px-3 py-2 text-center text-gray-600">${f.avgTaskScore?f.avgTaskScore.toFixed(1):"-"}</td>
      <td class="px-3 py-2 text-center text-gray-600">${f.avgTeamScore?f.avgTeamScore.toFixed(1):"-"}</td>
      <td class="px-3 py-2 text-center text-gray-600">${f.avgProgressScore?f.avgProgressScore.toFixed(1):"-"}</td>
      <td class="px-3 py-2 text-center text-gray-600">${f.avgMcqScore?f.avgMcqScore.toFixed(1):"-"}</td>
      <td class="px-3 py-2 text-center font-bold text-indigo-700">${f.avgTotalScore?f.avgTotalScore.toFixed(1):"-"}</td>
    </tr>
  `}).join("")}</tbody>
      </table>
    </div>
  `,u=`
    <div class="mb-8 break-inside-avoid">
      <h3 class="text-lg font-bold text-gray-800 mb-3 border-b pb-2"> </h3>
      <table class="w-full text-xs border border-gray-200">
        <thead class="bg-gray-100 text-gray-600 uppercase">
          <tr>
            <th class="px-3 py-2 text-left"></th>
            <th class="px-3 py-2 text-center"></th>
            <th class="px-3 py-2 text-center"></th>
            <th class="px-3 py-2 text-center"> </th>
            <th class="px-3 py-2 text-center"> %</th>
          </tr>
        </thead>
        <tbody>${l.map((f,g)=>`
    <tr class="border-b border-gray-100 ${g%2===0?"bg-gray-50":"bg-white"}">
      <td class="px-3 py-2 font-medium">${f.taskName}</td>
      <td class="px-3 py-2 text-center">${f.dateLabel}</td>
      <td class="px-3 py-2 text-center">${jr(f.assessedCount)} / ${jr(f.assessedCount+f.pendingCount)}</td>
      <td class="px-3 py-2 text-center">${f.avgTaskScore.toFixed(1)}</td>
      <td class="px-3 py-2 text-center font-bold text-indigo-700">
        ${f.averagePercentage.toFixed(1)}%
        ${f.problemRecovered?'<div class="mt-1 text-[9px] text-red-600 font-semibold"><i class="fas fa-check-circle text-[8px]"></i> Problem Resolved</div>':""}
      </td>
    </tr>
  `).join("")}</tbody>
      </table>
    </div>
  `,p=`
    <div class="font-bengali">
      <div class="text-center mb-8 border-b-2 border-gray-100 pb-6">
        <h1 class="text-2xl font-bold text-indigo-700 mb-2">  </h1>
        <h2 class="text-xl font-semibold text-gray-700">  : ${a}</h2>
        <div class="flex justify-center gap-4 mt-2 text-sm text-gray-500">
          <span>: ${s}</span>
          <span>: ${jr(i.studentCount)} </span>
        </div>
      </div>
      
      ${c}
      ${d}
      ${u}
      
      <div class="mt-8 text-xs text-gray-400 text-center border-t pt-2">
              
      </div>
    </div>
  `;await RA(p),e.showToast("   ...","info")}async function gM(r,e,t,n,s,i,a,o){var u;const l=new Date().toLocaleDateString("bn-BD"),c=()=>{var f;const p=[];if(e.group!=="all"&&p.push(`: ${((f=n.get(e.group))==null?void 0:f.name)||e.group}`),e.academicGroup!=="all"&&p.push(`: ${e.academicGroup}`),e.session!=="all"&&p.push(`: ${e.session}`),e.gender!=="all"&&p.push(`: ${e.gender}`),e.role!=="all"&&p.push(`: ${e.role}`),e.extra&&e.extra.length>0){const g=e.extra.map(m=>s.get(m)||m).join(", ");p.push(`: ${g}`)}return p.length>0?p.join(" | "):" "};let A="";e.assignment!=="all"&&i&&(A=((u=i.get(e.assignment))==null?void 0:u.name)||"");const d=r.map((p,f)=>{var N,E,w;const g=((N=n.get(p.groupId))==null?void 0:N.name)||"-",m=[];t.forEach(v=>{v.scores&&v.scores[p.id]&&m.push({taskId:v.taskId,...v.scores[p.id]})});const x=m.reduce((v,I)=>v+(I.totalScore||0),0),S=m.length?(x/m.length).toFixed(1):0,B=m.length?jr(S):"-";let F="-";if(e.assignment!=="all"){const v=m.find(I=>I.taskId===e.assignment);v&&(F=jr(v.totalScore))}return`
        <tr class="border-b border-gray-200 ${f%2===0?"bg-gray-50":"bg-white"}">
          <td class="py-2 px-3 text-center text-gray-500">${jr(f+1)}</td>
          <td class="py-2 px-3 text-left">${p.name}</td>
          <td class="py-2 px-3 text-center">${jr(p.roll)}</td>
          <td class="py-2 px-3 text-center">${((E=a==null?void 0:a.get(p.classId))==null?void 0:E.name)||"-"}</td>
          <td class="py-2 px-3 text-center">${((w=o==null?void 0:o.get(p.sectionId))==null?void 0:w.name)||"-"}</td>
          <td class="py-2 px-3 text-center">${p.gender||"-"}</td>
          <td class="py-2 px-3 text-center">${g}</td>
          <td class="py-2 px-3 text-center">${p.academicGroup||"-"}</td>
          <td class="py-2 px-3 text-center">${p.session||"-"}</td>
          <td class="py-2 px-3 text-center">${p.role==="member"?"":p.role||"-"}</td>
          <td class="py-2 px-3 text-center">${B}</td>
          ${e.assignment!=="all"?`<td class="py-2 px-3 text-center font-bold">${F}</td>`:""}
        </tr>
      `}).join(""),h=`
    <div class="font-bengali">
      <div class="text-center mb-6">
        <h1 class="text-2xl font-bold text-blue-700 mb-2">  </h1>
        <h2 class="text-xl font-semibold text-gray-700">  </h2>
        ${A?`<h3 class="text-lg font-medium text-blue-600 mt-1">${A}</h3>`:""}
        <div class="flex flex-col items-center gap-1 mt-2">
            <p class="text-sm text-gray-600 font-medium text-center px-4">${c()}</p>
            <p class="text-xs text-gray-500">: ${l} |  : ${jr(r.length)} </p>
        </div>
      </div>
      
      <table class="w-full border-collapse border border-gray-300 text-xs">
        <thead>
          <tr class="bg-gray-100 text-gray-700">
            <th class="py-2 px-3 text-center font-semibold border border-gray-300 w-12">#</th>
            <th class="py-2 px-3 text-left font-semibold border border-gray-300"></th>
            <th class="py-2 px-3 text-center font-semibold border border-gray-300"></th>
            <th class="py-2 px-3 text-center font-semibold border border-gray-300"></th>
            <th class="py-2 px-3 text-center font-semibold border border-gray-300"></th>
            <th class="py-2 px-3 text-center font-semibold border border-gray-300"></th>
            <th class="py-2 px-3 text-center font-semibold border border-gray-300"></th>
            <th class="py-2 px-3 text-center font-semibold border border-gray-300"></th>
            <th class="py-2 px-3 text-center font-semibold border border-gray-300"></th>
            <th class="py-2 px-3 text-center font-semibold border border-gray-300"></th>
            <th class="py-2 px-3 text-center font-semibold border border-gray-300"> </th>
            ${e.assignment!=="all"?'<th class="py-2 px-3 text-center font-semibold border border-gray-300"></th>':""}
          </tr>
        </thead>
        <tbody>
          ${d}
        </tbody>
      </table>
      
      <div class="mt-8 text-xs text-gray-400 text-center border-t pt-2">
              
      </div>
    </div>
  `;await RA(h)}const Jse=Object.freeze(Object.defineProperty({__proto__:null,generateAllGroupsResultPDF:qse,generateAllStudentsPDF:$se,generateAssignmentResultPDF:Wse,generateGroupAnalysisPDF:Vse,generateGroupWiseFullDetailsPDF:Yse,generateGroupWiseStudentsPDF:Gse,generateSingleGroupAnalysisPDF:Xse,generateStudentListPDF:gM},Symbol.toStringTag,{value:"Module"}));let hr,La,gr,ax;const Ie={},Y2=11,X2=55,J2=0,Zse=1;let uv="latest";const eie=["time","scheduledTime","scheduleTime","assignmentTime","startTime","startAt","timeSlot","slotTime","meetingTime"],$a=["bg-red-100 text-red-800 border-red-200 dark:bg-red-900 dark:text-white dark:border-red-700","bg-orange-100 text-orange-800 border-orange-200 dark:bg-orange-900 dark:text-white dark:border-orange-700","bg-yellow-100 text-yellow-800 border-yellow-200 dark:bg-yellow-900 dark:text-white dark:border-yellow-700","bg-green-100 text-green-800 border-green-200 dark:bg-green-900 dark:text-white dark:border-green-700","bg-teal-100 text-teal-800 border-teal-200 dark:bg-teal-900 dark:text-white dark:border-teal-700","bg-blue-100 text-blue-800 border-blue-200 dark:bg-blue-900 dark:text-white dark:border-blue-700","bg-indigo-100 text-indigo-800 border-indigo-200 dark:bg-indigo-900 dark:text-white dark:border-indigo-700","bg-purple-100 text-purple-800 border-purple-200 dark:bg-purple-900 dark:text-white dark:border-purple-700","bg-pink-100 text-pink-800 border-pink-200 dark:bg-pink-900 dark:text-white dark:border-pink-700","bg-gray-100 text-gray-800 border-gray-200 dark:bg-gray-700 dark:text-white dark:border-gray-600"];function pM(r){if(!r)return $a[0];const e=r.trim().toLowerCase();if(e.includes("")||e.includes("bangla"))return $a[0];if(e.includes("")||e.includes("english"))return $a[5];if(e.includes("")||e.includes("math"))return $a[1];if(e.includes("")||e.includes("ict")||e.includes(""))return $a[4];if(e.includes("")||e.includes("science"))return $a[3];if(e.includes("")||e.includes("religion")||e.includes(""))return $a[7];if(e.includes("")||e.includes("physics"))return $a[8];if(e.includes("")||e.includes("chemistry"))return $a[2];if(e.includes("")||e.includes("biology"))return $a[6];let t=0;for(let n=0;n<r.length;n++)t=r.charCodeAt(n)+((t<<5)-t);return $a[Math.abs(t)%$a.length]}function tie(r){return hr=r.managers.stateManager,La=r.managers.uiManager,gr=r.utils,ax=r.app,oie(),console.log(" Dashboard component initialized."),{render:mM}}function mM(){var r,e,t;if(console.log("Rendering Dashboard..."),!Ie.page){console.error(" Dashboard render failed: Page element (#page-dashboard) not found.");return}La.clearContainer(Ie.page),Ie.page.innerHTML='  <div class="placeholder-content"><i class="fas fa-spinner fa-spin mr-2"></i>    ...</div>';try{const n=(r=hr.get("currentUserData"))==null?void 0:r.type,s=hr.get("activeContext")||{};let i,a,o,l;if(n==="teacher"){console.log(" Teacher mode: Using strict filtered data");const A=hr.get("currentTeacher"),d={tasks:hr.get("tasks")||[],subjects:hr.get("subjects")||[],evaluations:hr.get("evaluations")||[],students:hr.get("students")||[],groups:hr.get("groups")||[],sections:hr.get("sections")||[],classes:hr.get("classes")||[]},h=wM(d,A);o=h.tasks,l=h.evaluations,a=h.students,i=h.groups}else{const A=hr.getState();if(i=A.groups||[],a=A.students||[],o=A.tasks||[],l=A.evaluations||[],s.classId||s.sectionId||s.subjectId){const d=hr.get("sections")||[],h=hr.get("subjects")||[],u=d.find(m=>m.id===s.sectionId),p=h.find(m=>m.id===s.subjectId),f=((e=u==null?void 0:u.name)==null?void 0:e.trim())||"",g=((t=p==null?void 0:p.name)==null?void 0:t.trim())||"";if(s.classId&&(a=a.filter(m=>m.classId===s.classId)),s.sectionId&&f&&(a=a.filter(m=>{var S;if(!m.sectionId)return!1;const x=d.find(B=>B.id===m.sectionId);return((S=x==null?void 0:x.name)==null?void 0:S.trim())===f})),console.log(" Dashboard Filter Context:",s),console.log(" Total Tasks Before Filter:",o.length),o=o.filter(m=>{var S;let x=!0;if(s.classId&&m.classId&&m.classId!==s.classId&&(x=!1,console.log(` Task Rejected (Class Mismatch): ${m.title||m.name} (${m.classId} != ${s.classId})`)),s.sectionId&&m.sectionId&&m.sectionId!==s.sectionId&&(x=!1,console.log(` Task Rejected (Section Mismatch): ${m.title||m.name} (${m.sectionId} != ${s.sectionId})`)),s.subjectId&&g)if(!m.subjectId)x=!1,console.log(` Task Rejected (No Subject ID): ${m.title||m.name}`);else{const B=h.find(F=>F.id===m.subjectId);((S=B==null?void 0:B.name)==null?void 0:S.trim())!==g&&(x=!1,console.log(` Task Rejected (Subject Name Mismatch): ${m.title||m.name}`))}return x}),console.log(" Total Tasks After Filter:",o.length),s.classId||s.sectionId){const m=new Set(a.filter(x=>x.groupId).map(x=>x.groupId));i=i.filter(x=>m.has(x.id))}if(s.subjectId){const m=new Set(o.map(x=>x.id));l=l.filter(x=>m.has(x.taskId))}}}if(Array.isArray(i)||(console.warn(" Groups variable is not an array in render! Refetching from state."),i=hr.get("groups")||[]),!i||!a||!o||!l){La.displayEmptyMessage(Ie.page,"   ...");return}Ie.page.innerHTML=rie(),lie();const c=If(i,a,o,l);yM(c),Tf(c.groupPerformanceData),Ff(c.academicGroupStats),Lf(c.groupPerformanceData,c.groupRankingMeta),cie(o),xie(),ax.components.settings&&ax.components.settings.applySettings(),console.log(" Dashboard rendered successfully.")}catch(n){console.error(" Error rendering dashboard:",n),Ie.page&&La.displayEmptyMessage(Ie.page,`    : ${n.message}`)}}function rie(){return`
    <style>
      @keyframes glowOrbit {
        from { transform: rotate(0deg); }
        to { transform: rotate(360deg); }
      }
      .glow-ring {
        position: relative;
        isolation: isolate;
      }
      .glow-ring::before,
      .glow-ring::after {
        content: '';
        position: absolute;
        inset: 0;
        border-radius: 9999px;
        pointer-events: none;
      }
      .glow-ring::before {
        background: conic-gradient(from 0deg,
          rgba(255,180,0,0) 0deg,
          rgba(255,190,0,0.2) 180deg,
          rgba(255,200,0,0.9) 300deg,
          rgba(255,215,0,1) 340deg,
          rgba(255,180,0,0) 360deg);
        mask: radial-gradient(circle, transparent 65%, black 72%);
        -webkit-mask: radial-gradient(circle, transparent 65%, black 72%);
        box-shadow: 0 0 40px rgba(255,180,0,0.7), 0 0 80px rgba(255,200,0,0.5);
        animation: glowOrbit 3s linear infinite;
      }
      .glow-ring::after {
        background: conic-gradient(from 0deg,
          rgba(255,160,0,0) 0deg,
          rgba(255,180,0,0.3) 240deg,
          rgba(255,200,0,0.9) 320deg,
          rgba(255,160,0,0) 360deg);
        mask: radial-gradient(circle, transparent 55%, black 68%);
        -webkit-mask: radial-gradient(circle, transparent 55%, black 68%);
        filter: blur(12px);
        opacity: 1;
        animation: glowOrbit 5s linear infinite;
      }
    </style>
    <div class="max-w-7xl mx-auto space-y-2">
     

    <section id="dashboard-hero" class="relative overflow-hidden rounded-3xl border border-slate-300/60
  bg-gradient-to-br from-white via-slate-50 to-slate-200
  text-slate-900 shadow-[0_4px_10px_rgba(0,0,0,0.10),0_10px_28px_rgba(255,255,255,0.65)]
  hover:shadow-[0_8px_18px_rgba(0,0,0,0.14),0_14px_34px_rgba(255,255,255,0.75)]
  transition-all duration-500 ease-out
  dark:border-slate-700/60 dark:bg-gradient-to-br dark:from-slate-800 dark:via-slate-900 dark:to-black
  dark:text-slate-100 dark:shadow-[inset_0_2px_4px_rgba(255,255,255,0.05),0_6px_18px_rgba(0,0,0,0.60),0_0_28px_rgba(255,255,255,0.10)]
  dark:hover:shadow-[inset_0_3px_6px_rgba(255,255,255,0.08),0_10px_24px_rgba(0,0,0,0.75),0_0_36px_rgba(255,255,255,0.14)]">

  <!-- subtle radial aura -->
  <div aria-hidden class="absolute inset-0 opacity-30 bg-[radial-gradient(60%_50%_at_50%_0%,rgba(99,102,241,0.35),transparent_60%)]"></div>

  <div class="relative p-2 sm:p-3 space-y-2">

    <!-- Card (hero row) -->
    <section class="relative overflow-hidden rounded-3xl border
      border-slate-300/70 ring-1 ring-white/40 backdrop-blur supports-[backdrop-filter]:bg-white/70
      bg-gradient-to-br from-amber-50 via-rose-50 to-sky-50
      shadow-[0_6px_16px_rgba(0,0,0,0.10),0_0_30px_rgba(255,255,255,0.55)]
      hover:shadow-[0_10px_24px_rgba(0,0,0,0.14),0_0_36px_rgba(255,255,255,0.65)]
      transition-all duration-500 ease-out
      dark:border-slate-700/70 dark:bg-gradient-to-br dark:from-slate-800 dark:via-slate-900 dark:to-slate-950
      dark:text-slate-100 dark:shadow-[inset_0_2px_4px_rgba(255,255,255,0.06),0_10px_26px_rgba(0,0,0,0.70),0_0_34px_rgba(255,255,255,0.10)]
      dark:hover:shadow-[inset_0_3px_6px_rgba(255,255,255,0.08),0_14px_30px_rgba(0,0,0,0.78),0_0_40px_rgba(255,255,255,0.14)]">

      <!-- conic aura -->
      <div aria-hidden class="pointer-events-none absolute -inset-px rounded-[24px] opacity-[0.10] blur-2xl"
           style="background: conic-gradient(#fde68a, #f0abfc, #93c5fd, #fde68a)"></div>

      <div class="relative p-2">
        <div class="flex flex-col items-center justify-between gap-2 md:flex-row">

          <!-- Left: title & icon -->
          <div class="flex w-full items-center gap-3 md:w-auto justify-center md:justify-start">
            
            <p class="text-2xl font-black tracking-tight text-slate-900 dark:text-white text-center md:text-left">
                
            </p>
             <!-- Assignment Filter -->
           
          </div>

          <!-- Score chips -->
          <div class="grid w-full grid-cols-2 gap-2 text-[0.9rem] font-semibold sm:w-auto sm:grid-cols-3 md:grid-cols-4">
            <span class="relative rounded-2xl px-4 py-1.5
              text-emerald-900 bg-gradient-to-b from-emerald-50 via-emerald-200 to-emerald-500
              ring-2 ring-emerald-300/80
              shadow-[inset_0_1px_3px_rgba(255,255,255,0.9),0_4px_8px_rgba(0,0,0,0.15),0_10px_18px_rgba(0,0,0,0.20)]
              transition-all duration-300
              dark:text-emerald-100 dark:from-emerald-700 dark:via-emerald-800 dark:to-emerald-900 dark:ring-emerald-600/40
              dark:shadow-[inset_0_1px_2px_rgba(255,255,255,0.08),0_6px_12px_rgba(0,0,0,0.75)]"> </span>

            <span class="relative rounded-2xl px-4 py-1.5
              text-sky-900 bg-gradient-to-b from-sky-50 via-sky-200 to-sky-500
              ring-2 ring-sky-300/80
              shadow-[inset_0_1px_3px_rgba(255,255,255,0.9),0_4px_8px_rgba(0,0,0,0.15),0_10px_18px_rgba(0,0,0,0.20)]
              transition-all duration-300
              dark:text-sky-100 dark:from-sky-700 dark:via-sky-800 dark:to-sky-900 dark:ring-sky-600/40
              dark:shadow-[inset_0_1px_2px_rgba(255,255,255,0.08),0_6px_12px_rgba(0,0,0,0.75)]"> </span>

            <span class="relative rounded-2xl px-4 py-1.5
              text-rose-900 bg-gradient-to-b from-rose-50 via-rose-200 to-rose-500
              ring-2 ring-rose-300/80
              shadow-[inset_0_1px_3px_rgba(255,255,255,0.9),0_4px_8px_rgba(0,0,0,0.15),0_10px_18px_rgba(0,0,0,0.20)]
              transition-all duration-300
              dark:text-rose-100 dark:from-rose-700 dark:via-rose-800 dark:to-rose-900 dark:ring-rose-600/40
              dark:shadow-[inset_0_1px_2px_rgba(255,255,255,0.08),0_6px_12px_rgba(0,0,0,0.75)]"> </span>

            <span class="relative rounded-2xl px-4 py-1.5
              text-amber-900 bg-gradient-to-b from-amber-50 via-amber-200 to-amber-500
              ring-2 ring-amber-300/80
              shadow-[inset_0_1px_3px_rgba(255,255,255,0.9),0_4px_8px_rgba(0,0,0,0.15),0_10px_18px_rgba(0,0,0,0.20)]
              transition-all duration-300
              dark:text-amber-100 dark:from-amber-700 dark:via-amber-800 dark:to-amber-900 dark:ring-amber-700/40
              dark:shadow-[inset_0_1px_2px_rgba(255,255,255,0.08),0_6px_12px_rgba(0,0,0,0.75)]">MCQ </span>
          </div>

          

          <!-- Right: image preview -->
          <div class="w-full md:w-auto">
            <div class="glow-ring relative mx-auto h-28 w-28 sm:h-32 sm:w-32">
              <div class="absolute inset-[10px] overflow-hidden rounded-full border-2 border-amber-200/60 bg-white
                shadow-[0_10px_25px_rgba(0,0,0,0.25),0_0_35px_rgba(255,214,155,0.7)]
                dark:bg-slate-900 dark:shadow-[0_12px_28px_rgba(0,0,0,0.65),0_0_35px_rgba(255,214,155,0.10)]">
                <img src="images/smart.png" alt="Evaluation summary visual"
                     class="h-full w-full object-cover object-center" loading="lazy" decoding="async" />
              </div>
            </div>
          </div>

          

        </div>
         <div class="flex flex-col gap-1 mt-2">
            
            <div id="teacherFiltersContainer" class="hidden w-full">
                <div id="teacherInfoCard" class="hidden w-full flex flex-wrap items-center gap-2 px-1 py-1">
                    <div class="flex items-center gap-2 text-sm text-slate-700 dark:text-slate-300">
                        <i class="fas fa-user-circle text-blue-600 dark:text-blue-400"></i>
                        <span class="font-bold" id="teacherNameDisplay"></span>
                        <span class="text-slate-400 dark:text-slate-500">|</span>
                    </div>
                    <div id="teacherAssignmentDisplay" class="text-xs font-medium text-slate-600 dark:text-slate-400">
                        <!-- Details will be populated here -->
                    </div>
                </div>
            </div>

            <!-- Row 2: Filters (Red Area) -->
            <!-- All filters in one row with minimal height -->
            <div class="w-full mt-1">
                <div class="flex flex-wrap gap-2 items-center justify-between">
                    
                    <!-- Context Filters Group -->
                    <div id="contextFiltersWrapper" class="flex flex-1 flex-wrap gap-2 items-center hidden min-w-0">
                        <div class="relative flex-1 min-w-[100px]">
                            <select id="dashboardClassFilter" class="w-full appearance-none bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 text-slate-700 dark:text-slate-200 text-xs font-medium rounded-lg py-2 px-3 pr-8 focus:outline-none focus:ring-2 focus:ring-indigo-500/50 cursor-pointer transition-all hover:border-indigo-300 dark:hover:border-indigo-600">
                                <option value=""> </option>
                            </select>
                            <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-slate-400">
                                <i class="fas fa-chevron-down text-[10px]"></i>
                            </div>
                        </div>
                        
                        <div class="relative flex-1 min-w-[100px]">
                            <select id="dashboardSectionFilter" class="w-full appearance-none bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 text-slate-700 dark:text-slate-200 text-xs font-medium rounded-lg py-2 px-3 pr-8 focus:outline-none focus:ring-2 focus:ring-indigo-500/50 cursor-pointer transition-all hover:border-indigo-300 dark:hover:border-indigo-600">
                                <option value=""> </option>
                            </select>
                            <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-slate-400">
                                <i class="fas fa-chevron-down text-[10px]"></i>
                            </div>
                        </div>

                        <div class="relative flex-1 min-w-[100px]">
                            <select id="dashboardSubjectFilter" class="w-full appearance-none bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 text-slate-700 dark:text-slate-200 text-xs font-medium rounded-lg py-2 px-3 pr-8 focus:outline-none focus:ring-2 focus:ring-indigo-500/50 cursor-pointer transition-all hover:border-indigo-300 dark:hover:border-indigo-600">
                                <option value=""> </option>
                            </select>
                            <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-slate-400">
                                <i class="fas fa-chevron-down text-[10px]"></i>
                            </div>
                        </div>
                    </div>

                    <!-- Assignment Filter -->
                    <div class="relative flex-1 min-w-[140px]">
                        <select id="dashboardAssignmentFilter" 
                          class="w-full appearance-none bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 
                          text-slate-700 dark:text-slate-200 text-xs font-medium rounded-lg py-2 pl-3 pr-8 
                          focus:outline-none focus:ring-2 focus:ring-indigo-500/50 cursor-pointer transition-all hover:border-indigo-300 dark:hover:border-indigo-600">
                          <option value="latest"> </option>
                        </select>
                        <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-slate-400">
                          <i class="fas fa-chevron-down text-[10px]"></i>
                        </div>
                    </div>
                </div>
            </div>
         </div>
      </div>
    </section>

    <!-- Two-column content -->
    <div class="grid gap-3 lg:grid-cols-2 items-stretch">

      <!-- Students & Groups -->
      <article class="rounded-3xl border border-slate-300/70 bg-gradient-to-br from-white via-slate-50 to-slate-100 
        text-slate-900 shadow-[0_8px_24px_rgba(0,0,0,0.10),0_0_24px_rgba(255,255,255,0.5)]
        backdrop-blur dark:border-slate-700/70 dark:bg-gradient-to-br dark:from-slate-800 dark:via-slate-900 dark:to-black 
        dark:text-white dark:shadow-[inset_0_2px_4px_rgba(255,255,255,0.06),0_12px_32px_rgba(0,0,0,0.7)] h-full p-2">

        <div class="space-y-2">
          <div class="flex items-center justify-center text-xs font-semibold text-slate-800 dark:text-white/80">
            <span class="inline-flex items-center gap-2 rounded-full bg-white px-3 py-1 text-slate-900 
              ring-1 ring-slate-200 shadow-sm dark:bg-white/10 dark:text-white">
              <i class="fas fa-people-group text-indigo-600 drop-shadow-[0_1px_1px_rgba(0,0,0,0.3)]"></i>
              <span id="assignmentStatusTitle">    </span>
            </span>
           
          </div>
           <!-- Evaluation progress -->
        <div class="relative rounded-2xl border border-blue-300/70
            bg-gradient-to-br from-white via-blue-50 to-emerald-50
            shadow-[inset_0_1px_2px_rgba(255,255,255,0.9),0_8px_18px_rgba(0,0,0,0.08)]
            p-1 mb-2
            dark:border-blue-400/40 dark:from-slate-900 dark:via-slate-900 dark:to-slate-950
            dark:shadow-[inset_0_1px_2px_rgba(255,255,255,0.05),0_10px_24px_rgba(0,0,0,0.55)]">

          <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4 items-center">
            <!-- Col 1: Title chip -->
            <div class="min-w-0">
              <span class="inline-flex items-center gap-2 rounded-full
                           px-3 py-1 text-[0.85rem] font-semibold
                           bg-white/90 text-slate-900 ring-1 ring-white/70
                           shadow-[0_1px_2px_rgba(0,0,0,0.14)] backdrop-blur
                           dark:bg-white/10 dark:text-white dark:ring-white/15">
                <i class="fas fa-chart-simple text-indigo-600 dark:text-indigo-300 text-sm"></i>
                <span class="truncate" lang="bn">  </span>
              </span>
            </div>

            <!-- Col 2: Progress bar -->
            <div class="w-full">
              <div class="battery w-full">
                <div class="battery-shell relative w-full h-full">
                  <div id="progressBar" class="battery-liquid h-full" style="width: 0%"></div>
                  <span id="progressBarLabel" class="battery-label absolute inset-0 flex items-center justify-center text-xs font-bold text-slate-900 dark:text-white z-10 drop-shadow-md">0%</span>
                </div>
               
              </div>
            </div>
          </div>
        </div>

          <div class="grid gap-3 md:grid-cols-2">
            <!--  -->
            <div class="rounded-2xl border border-emerald-300/70 bg-gradient-to-br from-white via-emerald-50 to-emerald-100/70 
              shadow-[0_6px_16px_rgba(16,185,129,0.18)] px-4 py-2
              dark:border-emerald-300/30 dark:from-emerald-900/40 dark:via-slate-900 dark:to-emerald-900/10">
              <div class="flex items-center justify-between">
                <div>
                  <p class="text-sm font-bold text-emerald-900 dark:text-emerald-200"></p>
                  <p class="text-xs text-emerald-700 dark:text-emerald-300/90"> </p>
                </div>
                <span class="flex h-9 w-9 items-center justify-center rounded-full bg-emerald-100 text-emerald-600 
                  shadow-[0_1px_2px_rgba(0,0,0,0.2)] dark:bg-emerald-500/20 dark:text-emerald-200">
                  <i class="fas fa-user-graduate"></i>
                </span>
              </div>

              <div class="mt-3 space-y-2 text-sm font-semibold text-slate-900 dark:text-white">
                <div class="flex items-center justify-between"><span></span><span><span id="latestAssignmentEvaluated">-</span> </span></div>
                <div class="flex items-center justify-between"><span></span><span><span id="latestAssignmentPending">-</span> </span></div>
                <div class="flex items-center justify-between"><span></span><span><span id="latestAssignmentStudentTotal">-</span> </span></div>
              </div>
            </div>

            <!--  -->
            <div class="rounded-2xl border border-sky-300/70 bg-gradient-to-br from-white via-sky-50 to-sky-100/70 
              shadow-[0_6px_16px_rgba(14,165,233,0.18)] px-4 py-4
              dark:border-sky-300/30 dark:from-sky-900/40 dark:via-slate-900 dark:to-sky-900/10">
              <div class="flex items-center justify-between">
                <div>
                  <p class="text-sm font-bold text-sky-900 dark:text-sky-100"></p>
                  <p class="text-xs text-sky-700 dark:text-sky-200/80"> </p>
                </div>
                <span class="flex h-9 w-9 items-center justify-center rounded-full bg-sky-100 text-sky-600 
                  shadow-[0_1px_2px_rgba(0,0,0,0.2)] dark:bg-sky-500/20 dark:text-sky-200">
                  <i class="fas fa-layer-group"></i>
                </span>
              </div>
              <div class="mt-3 space-y-2 text-sm font-semibold text-slate-900 dark:text-white">
                <div class="flex items-center justify-between"><span></span><span><span id="latestAssignmentGroupEvaluated">-</span> </span></div>
                <div class="flex items-center justify-between"><span></span><span><span id="latestAssignmentGroupPending">-</span> </span></div>
                <div class="flex items-center justify-between"><span></span><span><span id="latestAssignmentGroupTotal">-</span> </span></div>
              </div>
            </div>
          </div>
        </div>
      </article>

      <!-- Latest assignment + progress -->
      <article class="relative rounded-3xl border border-slate-300/70 
        bg-gradient-to-br from-blue-50 via-sky-100 to-emerald-50 
        text-slate-900 shadow-[0_10px_25px_rgba(0,0,0,0.08),0_0_35px_rgba(255,255,255,0.6)] 
        backdrop-blur p-3 sm:p-4 transition-all duration-500 
        dark:border-slate-700/70 dark:bg-gradient-to-br dark:from-slate-800 dark:via-slate-900 dark:to-slate-950 
        dark:text-white dark:shadow-[inset_0_2px_4px_rgba(255,255,255,0.06),0_12px_32px_rgba(0,0,0,0.7)] h-full">

       

        <!-- Header -->
        <div class="mb-2 sm:mb-3 ">
          <p class="text-xs font-bold text-slate-700 dark:text-white/60" lang="bn" >
            <span id="latestAssignmentLabel"> </span>    <span class="text-xs text-slate-700 dark:text-white/60">
            : <span id="latestAssignmentUpdated">-</span>
          </span>
          </p>
          <p id="latestTaskTitle"
            class="mt-1 max-w-[28rem]  font-bold text-slate-900 dark:text-white text-sm sm:text-lg"
            title="-">-</p>
        </div>

       

        <!-- Content: 3-column on sm+ -->
        <div class="grid grid-cols-2 gap-3">
          <!-- Average -->
          <div class="flex flex-col items-center justify-center gap-2 sm:gap-3">
            <div class="relative h-24 w-24 sm:h-26 sm:w-26 rounded-full border border-emerald-300/60 
              bg-emerald-50 dark:bg-slate-800
              shadow-[0_6px_16px_rgba(16,185,129,0.25)] 
              dark:border-emerald-300/30 flex items-center justify-center"
              id="latestAssignmentCircle">
              <div class="absolute inset-3 rounded-full bg-white dark:bg-slate-900 flex items-center justify-center shadow-sm">
                <p id="latestAssignmentAverage" class="text-2xl sm:text-3xl font-bold text-emerald-600 dark:text-emerald-400">-</p>
              </div>
            </div>
            <p id="latestAssignmentAverageLabelText" class="text-[0.8rem] sm:text-sm font-bold text-emerald-800 dark:text-white/80 text-center">
                
            </p>
          </div>

          <!-- Overall -->
          <div class="flex flex-col items-center justify-center gap-2 sm:gap-3">
            <div class="relative h-24 w-24 sm:h-26 sm:w-26 rounded-full border border-sky-300/60 
              bg-sky-50 dark:bg-slate-800
              shadow-[0_6px_16px_rgba(14,165,233,0.25)] 
              dark:border-sky-300/30 flex items-center justify-center"
              id="overallProgressCircle">
              <div class="absolute inset-3 rounded-full bg-white dark:bg-slate-900 flex items-center justify-center shadow-sm">
                <p id="overallProgress" class="text-2xl sm:text-3xl font-bold text-sky-600 dark:text-sky-400">-</p>
              </div>
            </div>
            <p class="text-[0.8rem] sm:text-sm font-bold text-sky-800 dark:text-white/80 text-center">
               
            </p>
          </div>
        </div>
      </article>

    </div>
  </div>
</section>

      <section id="dashboard-stats" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3">
        <article class="relative overflow-hidden rounded-2xl border border-gray-200/70 bg-white p-4 shadow-sm dark:border-gray-700/70 dark:bg-gray-900/70">
          <div class="absolute inset-0 bg-gradient-to-br from-indigo-500/10 via-transparent to-transparent"></div>
          <div class="relative flex items-start justify-between">
            <div>
              <p class="text-xs font-semibold uppercase tracking-wide text-gray-500 dark:text-gray-400"> </p>
              <h3 class="text-lg font-semibold text-gray-800 dark:text-white"> </h3>
              <p class="mt-4 text-3xl font-bold text-gray-900 dark:text-white" id="totalGroups">-</p>
              <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">   </p>
            </div>
            <span class="flex h-12 w-12 items-center justify-center rounded-xl bg-indigo-500/15 text-indigo-600 dark:text-indigo-300">
              <i class="fas fa-layer-group text-lg"></i>
            </span>
          </div>
        </article>

        <article class="relative overflow-hidden rounded-2xl border border-gray-200/70 bg-white p-4 shadow-sm dark:border-gray-700/70 dark:bg-gray-900/70">
          <div class="absolute inset-0 bg-gradient-to-br from-emerald-500/10 via-transparent to-transparent"></div>
          <div class="relative flex items-start justify-between">
            <div>
              <p class="text-xs font-semibold uppercase tracking-wide text-gray-500 dark:text-gray-400"> </p>
              <h3 class="text-lg font-semibold text-gray-800 dark:text-white"> </h3>
              <p class="mt-4 text-3xl font-bold text-gray-900 dark:text-white" id="totalStudents">-</p>
              <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">   </p>
            </div>
            <span class="flex h-12 w-12 items-center justify-center rounded-xl bg-emerald-500/15 text-emerald-600 dark:text-emerald-300">
              <i class="fas fa-user-graduate text-lg"></i>
            </span>
          </div>
        </article>

        <article class="relative overflow-hidden rounded-2xl border border-gray-200/70 bg-white p-4 shadow-sm dark:border-gray-700/70 dark:bg-gray-900/70">
          <div class="absolute inset-0 bg-gradient-to-br from-sky-500/10 via-transparent to-transparent"></div>
          <div class="relative flex items-start justify-between">
            <div>
              <p class="text-xs font-semibold uppercase tracking-wide text-gray-500 dark:text-gray-400"> </p>
              <h3 class="text-lg font-semibold text-gray-800 dark:text-white"> </h3>
              <p class="mt-4 text-3xl font-bold text-gray-900 dark:text-white" id="totalAcademicGroups">-</p>
              <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">    </p>
            </div>
            <span class="flex h-12 w-12 items-center justify-center rounded-xl bg-sky-500/15 text-sky-600 dark:text-sky-300">
              <i class="fas fa-university text-lg"></i>
            </span>
          </div>
        </article>

        <article class="relative overflow-hidden rounded-2xl border border-gray-200/70 bg-white p-4 shadow-sm dark:border-gray-700/70 dark:bg-gray-900/70">
          <div class="absolute inset-0 bg-gradient-to-br from-amber-500/10 via-transparent to-transparent"></div>
          <div class="relative flex items-start justify-between">
            <div>
              <p class="text-xs font-semibold uppercase tracking-wide text-gray-500 dark:text-gray-400"> </p>
              <h3 class="text-lg font-semibold text-gray-800 dark:text-white"> </h3>
              <p class="mt-4 text-3xl font-bold text-gray-900 dark:text-white" id="pendingRoles">-</p>
              <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">   </p>
            </div>
            <span class="flex h-12 w-12 items-center justify-center rounded-xl bg-amber-500/15 text-amber-600 dark:text-amber-300">
              <i class="fas fa-user-clock text-lg"></i>
            </span>
          </div>
        </article>

        <article class="relative overflow-hidden rounded-2xl border border-gray-200/70 bg-white p-4 shadow-sm dark:border-gray-700/70 dark:bg-gray-900/70">
          <div class="absolute inset-0 bg-gradient-to-br from-blue-500/10 via-transparent to-transparent"></div>
          <div class="relative flex items-start justify-between">
            <div>
              <p class="text-xs font-semibold uppercase tracking-wide text-gray-500 dark:text-gray-400"> </p>
              <h3 class="text-lg font-semibold text-gray-800 dark:text-white"> </h3>
              <p class="mt-4 text-3xl font-bold text-gray-900 dark:text-white" id="maleStudents">-</p>
              <div class="mt-1 inline-flex items-center gap-2 rounded-full bg-blue-500/10 px-3 py-1 text-xs font-medium text-blue-600 dark:text-blue-300">
                <i class="fas fa-male"></i>
                <span id="malePercentage">-</span>
              </div>
            </div>
            <span class="flex h-12 w-12 items-center justify-center rounded-xl bg-blue-500/15 text-blue-600 dark:text-blue-300">
              <i class="fas fa-venus-mars text-lg"></i>
            </span>
          </div>
        </article>

        <article class="relative overflow-hidden rounded-2xl border border-gray-200/70 bg-white p-4 shadow-sm dark:border-gray-700/70 dark:bg-gray-900/70">
          <div class="absolute inset-0 bg-gradient-to-br from-rose-500/10 via-transparent to-transparent"></div>
          <div class="relative flex items-start justify-between">
            <div>
              <p class="text-xs font-semibold uppercase tracking-wide text-gray-500 dark:text-gray-400"> </p>
              <h3 class="text-lg font-semibold text-gray-800 dark:text-white"> </h3>
              <p class="mt-4 text-3xl font-bold text-gray-900 dark:text-white" id="femaleStudents">-</p>
              <div class="mt-1 inline-flex items-center gap-2 rounded-full bg-rose-500/10 px-3 py-1 text-xs font-medium text-rose-600 dark:text-rose-300">
                <i class="fas fa-female"></i>
                <span id="femalePercentage">-</span>
              </div>
            </div>
            <span class="flex h-12 w-12 items-center justify-center rounded-xl bg-rose-500/15 text-rose-600 dark:text-rose-300">
              <i class="fas fa-user-friends text-lg"></i>
            </span>
          </div>
        </article>

        <article class="relative overflow-hidden rounded-2xl border border-gray-200/70 bg-white p-4 shadow-sm dark:border-gray-700/70 dark:bg-gray-900/70">
          <div class="absolute inset-0 bg-gradient-to-br from-teal-500/10 via-transparent to-transparent"></div>
          <div class="relative flex items-start justify-between">
            <div>
              <p class="text-xs font-semibold uppercase tracking-wide text-gray-500 dark:text-gray-400"> </p>
              <h3 class="text-lg font-semibold text-gray-800 dark:text-white"> </h3>
              <p class="mt-4 text-3xl font-bold text-gray-900 dark:text-white" id="totalTasks">-</p>
              <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">   </p>
            </div>
            <span class="flex h-12 w-12 items-center justify-center rounded-xl bg-teal-500/15 text-teal-600 dark:text-teal-300">
              <i class="fas fa-tasks text-lg"></i>
            </span>
          </div>
        </article>

        <article class="relative overflow-hidden rounded-2xl border border-gray-200/70 bg-white p-4 shadow-sm dark:border-gray-700/70 dark:bg-gray-900/70">
          <div class="absolute inset-0 bg-gradient-to-br from-red-500/10 via-transparent to-transparent"></div>
          <div class="relative flex items-start justify-between">
            <div>
              <p class="text-xs font-semibold uppercase tracking-wide text-gray-500 dark:text-gray-400"> </p>
              <h3 class="text-lg font-semibold text-gray-800 dark:text-white"> </h3>
              <p class="mt-4 text-3xl font-bold text-gray-900 dark:text-white" id="pendingEvaluations">-</p>
              <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">   </p>
            </div>
            <span class="flex h-12 w-12 items-center justify-center rounded-xl bg-red-500/15 text-red-600 dark:text-red-300">
              <i class="fas fa-hourglass-half text-lg"></i>
            </span>
          </div>
        </article>
      </section>

      <section id="dashboard-top-groups" class="relative overflow-hidden rounded-3xl border border-gray-200/70 bg-white shadow-sm transition hover:shadow-lg dark:border-gray-700/70 dark:bg-gray-900/70">
        <div class="border-b border-gray-200/60 px-6 py-4 dark:border-gray-800/80">
          <div class="flex flex-wrap items-center justify-between gap-3">
            <div>
              <h3 class="text-lg font-semibold text-gray-900 dark:text-white"> </h3>
              <p class="text-xs text-gray-500 dark:text-gray-400">        </p>
            </div>
            <span class="inline-flex items-center gap-2 rounded-full bg-indigo-500/10 px-3 py-1 text-xs font-medium text-indigo-600 dark:text-indigo-300">
              <i class="fas fa-trophy"></i> Elite Group
            </span>
          </div>
        </div>
        <div id="topGroupsContainer" class="p-6"></div>
      </section>

      <section id="dashboard-academic-stats" class="relative overflow-hidden rounded-3xl border border-gray-200/70 bg-white shadow-sm transition hover:shadow-lg dark:border-gray-700/70 dark:bg-gray-900/70">
        <div class="border-b border-gray-200/60 px-6 py-4 dark:border-gray-800/80">
          <div class="flex flex-wrap items-center justify-between gap-3">
            <div>
              <h3 class="text-lg font-semibold text-gray-900 dark:text-white">  </h3>
              <p class="text-xs text-gray-500 dark:text-gray-400">     </p>
            </div>
            <span class="inline-flex items-center gap-2 rounded-full bg-emerald-500/10 px-3 py-1 text-xs font-medium text-emerald-600 dark:text-emerald-300">
              <i class="fas fa-chart-bar"></i> 
            </span>
          </div>
        </div>
        <div id="academicGroupStatsList" class="p-6"></div>
      </section>

      <section id="dashboard-ranking" class="relative overflow-hidden rounded-3xl border border-gray-200/70 bg-white shadow-sm transition hover:shadow-lg dark:border-gray-700/70 dark:bg-gray-900/70">
        <div class="border-b border-gray-200/60 px-6 py-4 dark:border-gray-800/80">
          <div class="flex flex-wrap items-center justify-between gap-3">
            <div>
              <h3 class="text-lg font-semibold text-gray-900 dark:text-white">     </h3>
              <p class="text-xs text-gray-500 dark:text-gray-400"> ,  ,     </p>
            </div>
            <span class="inline-flex items-center gap-2 rounded-full bg-purple-500/10 px-3 py-1 text-xs font-medium text-purple-600 dark:text-purple-300">
              <i class="fas fa-star"></i>  
            </span>
          </div>
        </div>
        <div id="groupsRankingList" class="p-6 space-y-4"></div>
      </section>
    </div>
  `}function to(r){if(!r)return 0;if(r instanceof Date){const t=r.getTime();return Number.isNaN(t)?0:t}if(typeof r=="object"){if(typeof r.seconds=="number")return r.seconds*1e3;if(typeof r.toDate=="function")try{return r.toDate().getTime()}catch{return 0}}const e=Date.parse(r);return Number.isNaN(e)?0:e}function qo(r){if(!r)return 0;const e=[r.date,r.scheduleDate,r.startDate,r.dueDate,r.deadline,r.assignmentDate,r.assignmentDay,r.createdAt,r.updatedAt];let t=0;for(const i of e){const a=to(i);if(a){t=a;break}}if(!t)return 0;const n=Z2(r),s=new Date(t);return n?s.setHours(n.hour,n.minute,0,0):s.getHours()===0&&s.getMinutes()===0&&s.getSeconds()===0&&s.getMilliseconds()===0&&s.setHours(Y2,X2,J2,0),s.getTime()}function Z2(r){if(!r)return null;const e=["timeHour","hour","startHour"],t=["timeMinute","minute","startMinute"],n=e.map(i=>typeof r[i]=="number"?r[i]:parseInt(r[i],10)).find(i=>Number.isFinite(i)),s=t.map(i=>typeof r[i]=="number"?r[i]:parseInt(r[i],10)).find(i=>Number.isFinite(i));if(Number.isFinite(n)&&n>=0&&n<=23){const i=Number.isFinite(s)&&s>=0&&s<=59?s:0;return{hour:n,minute:i}}for(const i of eie){if(!Object.prototype.hasOwnProperty.call(r,i))continue;const a=nie(r[i]);if(a)return a}return null}function nie(r){if(!r)return null;const e=String(r).trim();if(!e)return null;const n=e.toLowerCase().match(/(\d{1,2})(?::(\d{1,2}))?\s*(am|pm|a\.m\.|p\.m\.)?/i);if(!n)return null;let s=parseInt(n[1],10),i=n[2]?parseInt(n[2],10):0;if(Number.isNaN(s)||Number.isNaN(i))return null;const a=n[3];if(a){const o=a.includes("p"),l=a.includes("a");o&&s<12&&(s+=12),l&&s===12&&(s=0)}return s=Math.min(Math.max(s,0),23),i=Math.min(Math.max(i,0),59),{hour:s,minute:i}}function sie(r=[]){let e=null;return r.forEach(t=>{if(!t)return;const n=qo(t);if(n&&(!e||n>e.ts)){const s=t.id??t.uid??t.key??t.slug??null,i=Z2(t);e={task:t,id:s,ts:n,timeParts:i}}}),e}function iie(r){if(!r)return null;try{const e=new Date;return e.setHours(r.hour,r.minute??0,0,0),new Intl.DateTimeFormat("bn-BD",{hour:"numeric",minute:"2-digit",hour12:!0}).format(e)}catch{return null}}function bM(r){const e=to(r);if(!e)return"-";try{const t=new Date(e);return Number.isNaN(t.getTime())?"-":(t.getHours()===0&&t.getMinutes()===0&&t.getSeconds()===0&&t.getMilliseconds()===0&&t.setHours(Y2,X2,J2,0),new Intl.DateTimeFormat("bn-BD",{dateStyle:"medium",timeStyle:"short"}).format(t))}catch{return"-"}}function xb(r){if(!r)return"-";try{const e=new Date(r);return new Intl.DateTimeFormat("bn-BD",{dateStyle:"medium"}).format(e)}catch{return"-"}}function aie(r){const e=to(r);if(!e)return"-";try{const t=new Date(e);return Number.isNaN(t.getTime())?"-":(t.getHours()===0&&t.getMinutes()===0&&t.getSeconds()===0&&t.getMilliseconds()===0&&t.setHours(Y2,X2,J2,0),new Intl.DateTimeFormat("bn-BD",{hour:"numeric",minute:"2-digit",hour12:!0}).format(t))}catch{return"-"}}function oie(){Ie.page=document.getElementById("page-dashboard"),Ie.page||console.error(" Dashboard init failed: #page-dashboard not found!")}function lie(){if(!Ie.page)return;["totalGroups","totalStudents","totalAcademicGroups","pendingRoles","maleStudents","malePercentage","femaleStudents","femalePercentage","totalTasks","pendingEvaluations","progressBar","progressBarLabel","overallProgress","overallProgressCircle","latestAssignmentAverage","latestAssignmentAverageLabelText","latestAssignmentCircle","latestTaskTitle","latestAssignmentUpdated","latestAssignmentEvaluated","latestAssignmentPending","latestAssignmentStudentTotal","latestAssignmentGroupEvaluated","latestAssignmentGroupPending","latestAssignmentGroupTotal","topGroupsContainer","academicGroupStatsList","groupsRankingList","groupsRankingList","dashboardAssignmentFilter","dashboardClassFilter","dashboardSectionFilter","dashboardSubjectFilter","assignmentStatusTitle","latestAssignmentLabel"].forEach(e=>{Ie[e]=Ie.page.querySelector(`#${e}`),Ie[e]||console.warn(`Dashboard: Element #${e} not found.`)})}function cie(r){if(!Ie.dashboardAssignmentFilter)return;for(;Ie.dashboardAssignmentFilter.options.length>1;)Ie.dashboardAssignmentFilter.remove(1);const e=[...r].sort((s,i)=>{const a=qo(s);return qo(i)-a}),t=document.createElement("option");t.value="global_rank",t.textContent="    ",Ie.dashboardAssignmentFilter.appendChild(t),e.forEach(s=>{const i=document.createElement("option");i.value=s.id,i.textContent=s.name,Ie.dashboardAssignmentFilter.appendChild(i)});const n=hr.getDashboardConfig();if(n.isForced&&n.forceAssignmentId){Ie.dashboardAssignmentFilter.value=n.forceAssignmentId,Ie.dashboardAssignmentFilter.disabled=!0,Ie.dashboardClassFilter&&(Ie.dashboardClassFilter.disabled=!0),Ie.dashboardSectionFilter&&(Ie.dashboardSectionFilter.disabled=!0),Ie.dashboardSubjectFilter&&(Ie.dashboardSubjectFilter.disabled=!0);const s=r.find(i=>i.id===n.forceAssignmentId);s&&(Ie.dashboardClassFilter&&s.classId&&(Ie.dashboardClassFilter.value=s.classId,Ie.dashboardClassFilter.dispatchEvent(new Event("change"))),Ie.dashboardSectionFilter&&s.sectionId&&(Ie.dashboardSectionFilter.value=s.sectionId),Ie.dashboardSubjectFilter&&s.subjectId&&(Ie.dashboardSubjectFilter.value=s.subjectId)),console.log(" Dashboard forced to assignment:",n.forceAssignmentId),hv(n.forceAssignmentId)}else Ie.dashboardAssignmentFilter.disabled=!1,Ie.dashboardClassFilter&&(Ie.dashboardClassFilter.disabled=!1),Ie.dashboardSectionFilter&&(Ie.dashboardSectionFilter.disabled=!1),Ie.dashboardSubjectFilter&&(Ie.dashboardSubjectFilter.disabled=!1),Ie.dashboardAssignmentFilter.value=uv,hv(uv);Ie.dashboardAssignmentFilter.addEventListener("change",s=>{uv=s.target.value,hv(s.target.value)})}function hv(r){var p,f,g,m,x,S;console.log(" Filter changed to:",r);const e=hr.getState();let{groups:t,students:n,tasks:s,evaluations:i}=e;const a=(p=hr.get("currentUserData"))==null?void 0:p.type,o=hr.get("activeContext")||{};let l=s,c=i;const A=hr.get("currentTeacher");if(a==="teacher"&&A){const B={tasks:s,subjects:hr.get("subjects")||[],evaluations:i,students:n,groups:t,sections:hr.get("sections")||[],classes:hr.get("classes")||[]},F=wM(B,A);if(l=F.tasks,c=F.evaluations,n=F.students,t=F.groups,console.log(" Teacher Dashboard: Filtered by assignments via helper"),o.classId&&(n=n.filter(N=>String(N.classId)===String(o.classId)),t=t.filter(N=>String(N.classId)===String(o.classId))),o.sectionId&&(n=n.filter(N=>String(N.sectionId)===String(o.sectionId)),t=t.filter(N=>String(N.sectionId)===String(o.sectionId))),o.subjectId){r&&r!=="latest"&&r!=="global_rank"?l=l.filter(E=>String(E.subjectId)===String(o.subjectId)||String(E.id)===String(r)):l=l.filter(E=>String(E.subjectId)===String(o.subjectId));const N=new Set(l.map(E=>E.id));c=c.filter(E=>N.has(E.taskId))}console.log(" Filtered Data (Assignments + Selection):",{tasks:l.length,evaluations:c.length,students:n.length,groups:t.length})}if(a!=="teacher"&&(o.classId||o.sectionId||o.subjectId)){console.log(" Admin filter: Applying activeContext to task view:",o);const B=hr.get("sections")||[],F=hr.get("subjects")||[],N=B.find(I=>I.id===o.sectionId),E=F.find(I=>I.id===o.subjectId),w=((f=N==null?void 0:N.name)==null?void 0:f.trim())||"",v=((g=E==null?void 0:E.name)==null?void 0:g.trim())||"";if(o.classId&&(n=n.filter(I=>I.classId===o.classId)),o.sectionId&&w&&(n=n.filter(I=>{var _;if(!I.sectionId)return!1;const k=B.find(T=>T.id===I.sectionId);return((_=k==null?void 0:k.name)==null?void 0:_.trim())===w})),o.subjectId&&v&&(l=l.filter(I=>{var _;if(!I.subjectId)return!1;const k=F.find(T=>T.id===I.subjectId);return((_=k==null?void 0:k.name)==null?void 0:_.trim())===v})),o.classId||o.sectionId){const I=new Set(n.filter(k=>k.groupId).map(k=>k.groupId));t=t.filter(k=>I.has(k.id))}if(o.subjectId){const I=new Set(l.map(k=>k.id));c=c.filter(k=>I.has(k.taskId))}}let d=null;if(r==="global_rank"){const B=If(t,n,l,c);let F="";const N=new Set(l.map(X=>X.subjectId).filter(Boolean));if(N.size===1){const X=hr.get("subjects")||[],$=[...N][0],V=X.find(he=>he.id===$);F=(V==null?void 0:V.name)||""}Tf(B.groupPerformanceData),Ff(B.academicGroupStats),Lf(B.groupPerformanceData,B.groupRankingMeta,F),Ie.latestTaskTitle&&(a==="teacher"?(Ie.latestTaskTitle.textContent="  ( )",Ie.latestTaskTitle.title="       "):(Ie.latestTaskTitle.textContent="  ( )",Ie.latestTaskTitle.title="    ")),Ie.assignmentStatusTitle&&(Ie.assignmentStatusTitle.textContent="  "),Ie.latestAssignmentLabel&&(Ie.latestAssignmentLabel.textContent=""),Ie.latestAssignmentUpdated&&(Ie.latestAssignmentUpdated.textContent="");const E=n.length*l.length;let w=0;c.forEach(X=>{X.scores&&(w+=Object.keys(X.scores).length)});const v=B.overallAssignmentAverage||0,I=E>0?Math.round(w/E*100):0;Ie.progressBar&&(Ie.progressBar.offsetHeight,setTimeout(()=>{Ie.progressBar.style.setProperty("width",`${I}%`,"important")},50)),Ie.progressBarLabel&&(Ie.progressBarLabel.textContent=`${gr.convertToBanglaNumber(I)}%`),Ie.latestAssignmentEvaluated&&(Ie.latestAssignmentEvaluated.textContent=gr.convertToBanglaNumber(w)),Ie.latestAssignmentPending&&(Ie.latestAssignmentPending.textContent=gr.convertToBanglaNumber(E-w)),Ie.latestAssignmentStudentTotal&&(Ie.latestAssignmentStudentTotal.textContent=gr.convertToBanglaNumber(E));const k=t.length*l.length;let _=0;const T=new Set;c.forEach(X=>{X.groupId&&X.taskId&&T.add(`${X.groupId}_${X.taskId}`)}),_=T.size,Ie.latestAssignmentGroupEvaluated&&(Ie.latestAssignmentGroupEvaluated.textContent=gr.convertToBanglaNumber(_)),Ie.latestAssignmentGroupPending&&(Ie.latestAssignmentGroupPending.textContent=gr.convertToBanglaNumber(k-_)),Ie.latestAssignmentGroupTotal&&(Ie.latestAssignmentGroupTotal.textContent=gr.convertToBanglaNumber(k)),Ie.overallProgress&&(Ie.overallProgress.textContent=gr.convertToBanglaNumber(v.toFixed(1)));const L=[...l].sort((X,$)=>qo($)-qo(X));let K=L.find(X=>c.some($=>String($.taskId)===String(X.id)));K||(K=L[0]);let se=0;if(K){const X=c.filter(V=>String(V.taskId)===String(K.id));if(se=ox([K],X).assignmentAverageMap.get(String(K.id))||0,Ie.latestTaskTitle&&(Ie.latestTaskTitle.textContent=K.title||K.name||" ",Ie.latestTaskTitle.title=K.title||K.name||""),Ie.latestAssignmentUpdated){const V=qo(K);Ie.latestAssignmentUpdated.textContent=V?xb(V):"-"}}else Ie.latestTaskTitle&&(Ie.latestTaskTitle.textContent="-"),Ie.latestAssignmentUpdated&&(Ie.latestAssignmentUpdated.textContent="-");Ie.latestAssignmentAverage&&(Ie.latestAssignmentAverage.textContent=gr.convertToBanglaNumber(se.toFixed(1))),Ie.latestAssignmentAverageLabelText&&(Ie.latestAssignmentAverageLabelText.textContent="  ");return}if(r==="latest"){const F=If(t,n,l,c).latestAssignmentSummary;if(F&&F.taskId){if(d=l.find(N=>N.id===F.taskId),d){const N=c.filter(v=>String(v.taskId)===String(d.id)),E=If(t,n,l,N);E.latestAssignmentSummary;let w="";if(d.subjectId){const I=(hr.get("subjects")||[]).find(k=>k.id===d.subjectId);w=(I==null?void 0:I.name)||""}Tf(E.groupPerformanceData),Ff(E.academicGroupStats),Lf(E.groupPerformanceData,E.groupRankingMeta,w),Ie.latestAssignmentAverageLabelText&&(Ie.latestAssignmentAverageLabelText.textContent="  ")}}else Tf([]),Ff({}),Lf([],null)}else if(d=l.find(B=>String(B.id)===String(r)),d){c=i.filter(E=>String(E.taskId)===String(d.id)),d.classId&&(n=n.filter(E=>String(E.classId)===String(d.classId))),d.sectionId&&(n=n.filter(E=>String(E.sectionId)===String(d.sectionId)));const B=new Set(n.map(E=>E.groupId).filter(Boolean));t=t.filter(E=>B.has(E.id)),console.log(" Task Context Applied:",{task:d.name,classId:d.classId,sectionId:d.sectionId,filteredStudents:n.length,filteredGroups:t.length});const F=If(t,n,[d],c);F.latestAssignmentSummary;let N="";if(d.subjectId){const w=(hr.get("subjects")||[]).find(v=>v.id===d.subjectId);N=(w==null?void 0:w.name)||""}if(Ie.latestTaskTitle&&(Ie.latestTaskTitle.textContent=d.title||d.name||" ",Ie.latestTaskTitle.title=d.title||d.name||""),Ie.latestAssignmentUpdated){const E=qo(d);Ie.latestAssignmentUpdated.textContent=E?xb(E):"-"}Ie.latestAssignmentAverageLabelText&&(Ie.latestAssignmentAverageLabelText.textContent=" "),Tf(F.groupPerformanceData),Ff(F.academicGroupStats),Lf(F.groupPerformanceData,F.groupRankingMeta,N),yM(F),Ie.latestAssignmentAverageLabelText&&(Ie.latestAssignmentAverageLabelText.textContent=" ")}if(!d)return;if(Ie.assignmentStatusTitle)if(r==="latest")Ie.assignmentStatusTitle.textContent="    ",Ie.latestAssignmentLabel&&(Ie.latestAssignmentLabel.textContent=" ");else{const B=hr.getDashboardConfig(),F=B.isForced&&String(B.forceAssignmentId)===String(r);Ie.assignmentStatusTitle.innerHTML=F?'    <span class="ml-2 text-xs bg-indigo-100 text-indigo-700 px-2 py-0.5 rounded border border-indigo-200"> </span>':"   ",Ie.latestAssignmentLabel&&(Ie.latestAssignmentLabel.textContent="")}if(Ie.latestAssignmentUpdated){const B=qo(d),F=bM(B),N=hr.get("classes")||[],E=hr.get("sections")||[],w=hr.get("subjects")||[],v=d.classId&&((m=N.find(T=>T.id===d.classId))==null?void 0:m.name)||"",I=d.sectionId&&((x=E.find(T=>T.id===d.sectionId))==null?void 0:x.name)||"",k=d.subjectId&&((S=w.find(T=>T.id===d.subjectId))==null?void 0:S.name)||"";let _="";if(v||I||k){if(_='<span class="inline-flex items-center gap-1 ml-2 align-middle">',v&&(_+=`<span class="px-1.5 py-0.5 rounded bg-slate-100 dark:bg-slate-600 text-[10px] font-medium border border-slate-200 dark:border-slate-500 text-slate-600 dark:text-white">${v}</span>`),I&&(_+=`<span class="px-1.5 py-0.5 rounded bg-slate-100 dark:bg-slate-600 text-[10px] font-medium border border-slate-200 dark:border-slate-500 text-slate-600 dark:text-white">${I}</span>`),k){const T=pM(k);_+=`<span class="px-1.5 py-0.5 rounded text-[10px] font-medium border ${T}">${k}</span>`}_+="</span>"}Ie.latestAssignmentUpdated.innerHTML=`${F}${_}`}const u=ox(s,i).overallAverage||0;if(Ie.overallProgress&&(Ie.overallProgress.textContent=gr.convertToBanglaNumber(u.toFixed(1))),Ie.overallProgressCircle){const B=u/100*360,F="#0ea5e9",N="rgba(14,165,233,0.1)";Ie.overallProgressCircle.style.background=`conic-gradient(${F} ${B}deg, ${N} ${B}deg)`}}function If(r=[],e=[],t=[],n=[]){const s=r.length,i=e.length,a=t.length,{male:o,female:l}=Aie(e),c=i>0?o/i*100:0,A=i>0?l/i*100:0,h=new Set(e.map(L=>L.academicGroup).filter(Boolean)).size,u=e.filter(L=>!L.role||L.role==="").length,p=uie(r,e,n,t),f=hie(r,e,n),g=p.filter(L=>L.evalCount>0),m=g.reduce((L,K)=>L+K.averageScore,0),x=g.length>0?m/g.length:0,S=new Set(n.map(L=>`${L.taskId}_${L.groupId}`));let B=0;if(t.length>0&&r.length>0)for(const L of t)for(const K of r)S.has(`${L.id}_${K.id}`)||B++;const F=bie(e,{data:p}),N=gie(r,e,t,n),E=ox(t,n),w=E.assignmentSummaries,v=w.length>0,I=v?E.overallAverage:0,k=v?I:x,_=pie(t,N),T=N!=null&&N.taskId&&E.assignmentAverageMap?E.assignmentAverageMap.get(String(N.taskId))??null:null;return{totalGroups:s,totalStudents:i,totalTasks:a,maleStudents:o,femaleStudents:l,malePercentage:c,femalePercentage:A,totalAcademicGroups:h,pendingRoles:u,pendingEvaluations:B,overallProgress:k,overallAssignmentAverage:I,latestAssignmentAverage:T,assignmentSummaries:w,groupPerformanceData:p,groupRankingMeta:f,academicGroupStats:F,latestAssignmentSummary:N,assignmentOverview:_}}function Aie(r=[]){return r.reduce((e,t)=>{const n=die(t.gender);return n==="male"?e.male++:n==="female"&&e.female++,e},{male:0,female:0})}function die(r){const e=(r||"").toString().trim();if(!e)return"";const t=e.normalize("NFC").toLowerCase().replace(/\s+/g,""),n=t.replace(//g,"");return n.includes("")||t.includes("male")||t.includes("boy")||t==="m"?"male":n.includes("")||t.includes("female")||t.includes("girl")||t==="f"?"female":""}function uie(r,e,t,n){const s=new Map(n.map(l=>[String(l.id),l])),i=new Map(e.map(l=>[String(l.id),l.groupId])),a={};return r.forEach(l=>{const c=String(l.id);a[c]={group:l,groupName:l.name,studentCount:0,totalScoreSum:0,totalMaxScoreSum:0,validEvalsCount:0,evaluatedMemberIds:new Set,taskIds:new Set,latestEvalMeta:{ts:0,avgPct:null,participants:null,participationRate:null}}}),e.forEach(l=>{if(l.groupId){const c=String(l.groupId);a[c]&&a[c].studentCount++}}),t.forEach(l=>{if(!l.scores)return;const c=l.taskId,A=s.get(String(c)),d=parseFloat(A==null?void 0:A.maxScore)||parseFloat(l.maxPossibleScore)||100,h=to(l.taskDate)||to(l.updatedAt)||to(l.createdAt),u={};Object.entries(l.scores).forEach(([p,f])=>{let g=i.get(String(p));g||(g=l.groupId);const m=g?String(g):null;if(!m||!a[m])return;u[m]||(u[m]={totalScore:0,studentCount:0,studentIds:new Set});const x=parseFloat(f.totalScore)||0;u[m].totalScore+=x,u[m].studentCount++,u[m].studentIds.add(p),a[m].totalScoreSum+=x,a[m].totalMaxScoreSum+=d,a[m].evaluatedMemberIds.add(p),a[m].taskIds.add(c)}),Object.entries(u).forEach(([p,f])=>{const g=a[p];if(g.validEvalsCount++,h>=g.latestEvalMeta.ts){const m=g.studentCount||1,x=Math.min(100,f.studentCount/m*100),S=d*f.studentCount,B=S>0?f.totalScore/S*100:0;g.latestEvalMeta={ts:h,avgPct:B,participants:f.studentCount,participationRate:x}}})}),Object.values(a).map(l=>{const c=l.totalMaxScoreSum>0?l.totalScoreSum/l.totalMaxScoreSum*100:0,A=l.evaluatedMemberIds.size,d=l.taskIds.size,h=l.studentCount>0?Math.min(100,A/l.studentCount*100):0;return{group:l.group,groupName:l.groupName,studentCount:l.studentCount,averageScore:c,evalCount:l.validEvalsCount,evalCount:l.validEvalsCount,evaluatedMembers:A,evaluatedMemberIds:l.evaluatedMemberIds,taskCount:d,participationRate:h,latestAverageScore:l.latestEvalMeta.avgPct,latestParticipantCount:l.latestEvalMeta.participants,latestParticipationRate:l.latestEvalMeta.participationRate}}).sort((l,c)=>c.averageScore-l.averageScore)}function hie(r=[],e=[],t=[]){if(!Array.isArray(r)||!Array.isArray(e)||!Array.isArray(t))return{list:[],map:new Map};const n=new Map(e.map(o=>[String(o.id),fv(o.groupId)])),s={};e.forEach(o=>{const l=fv(o.groupId);s[l]=(s[l]||0)+1});const i={};t.forEach(o=>{const l=parseFloat(o.maxPossibleScore)||60,c=to(o.taskDate)||to(o.updatedAt)||to(o.createdAt),A=o.scores||{},d=new Set;Object.entries(A).forEach(([h,u])=>{const p=h!=null?String(h):"";let f=n.get(p);f||(f=o.groupId?String(o.groupId):null),f||(f="__none");const g=fv(f);i[g]||(i[g]={evalCount:0,totalScore:0,maxScoreSum:0,latestMs:null,participants:new Set});const m=i[g];d.has(g)||(m.evalCount+=1,d.add(g));const x=l>0?l:100,S=parseFloat(u==null?void 0:u.totalScore)||0;m.totalScore+=S,m.maxScoreSum+=x,m.participants.add(p),c&&(m.latestMs=m.latestMs?Math.max(m.latestMs,c):c)})});const a=Object.entries(i).map(([o,l])=>{if(l.evalCount<Zse)return null;const c=l.maxScoreSum>0?l.totalScore/l.maxScoreSum*100:0,A=s[o]||0,d=l.participants.size;return{groupId:o,efficiency:c,evalCount:l.evalCount,totalScore:l.totalScore,maxScoreSum:l.maxScoreSum,latestEvaluationMs:l.latestMs||0,participantsCount:d,groupSize:A,remainingCount:Math.max(0,A-d)}}).filter(Boolean).sort((o,l)=>l.efficiency!==o.efficiency?l.efficiency-o.efficiency:l.evalCount!==o.evalCount?l.evalCount-o.evalCount:l.totalScore!==o.totalScore?l.totalScore-o.totalScore:(l.latestEvaluationMs||0)-(o.latestEvaluationMs||0));return a.forEach((o,l)=>{o.rank=l+1}),{list:a,map:new Map(a.map(o=>[o.groupId,o]))}}function fv(r){return r==null||r===""?"__none":String(r)}function fie(r,e){if(!r)return null;const t=parseFloat(r.groupAverageScore);if(!Number.isNaN(t))return t;if(!r.scores)return null;const n=e.get(String(r.taskId)),s=parseFloat(n==null?void 0:n.maxScore)||parseFloat(r.maxPossibleScore)||100;if(!(s>0))return null;let i=0,a=0;return Object.values(r.scores).forEach(o=>{i+=parseFloat(o.totalScore)||0,a++}),a===0?null:i/a/s*100}function gie(r=[],e=[],t=[],n=[]){var I,k;const s=sie(t);if(!n.length&&!s)return null;const i=new Map(r.map(_=>[_.id,0]));e.forEach(_=>{const T=_.groupId;T&&(i.has(T)||i.set(T,0),i.set(T,i.get(T)+1))});let a=null;n.forEach(_=>{const T=to(_.taskDate)||to(_.updatedAt)||to(_.createdAt);(!a||T>a.ts)&&(a={ts:T,taskId:_.taskId})});const o=(a==null?void 0:a.taskId)||(s==null?void 0:s.id);if(!o)return null;const l=t.find(_=>_.id===o)||(s==null?void 0:s.task)||null,c=(l==null?void 0:l.title)||(l==null?void 0:l.name)||((I=s==null?void 0:s.task)==null?void 0:I.title)||((k=s==null?void 0:s.task)==null?void 0:k.name)||" ",A=qo(l)||(s==null?void 0:s.ts)||0,d=Z2(l)||(s==null?void 0:s.timeParts)||null,h=iie(d),u=new Set;let p=!1;const f=["assignedGroupIds","targetGroupIds","groupIds","assignedGroups","groups","targets","selectedGroups","participantGroups","assignmentTargets"],g=(_,T=!1,L=0)=>{if(_==null||L>6)return;if(Array.isArray(_)){_.forEach(se=>g(se,T,L+1));return}if(typeof _=="object"){if("id"in _||"groupId"in _||"value"in _){g(_.id??_.groupId??_.value,T,L+1);return}if(_.group){g(_.group.id??_.group.groupId,T,L+1);return}Object.values(_).forEach(se=>g(se,T,L+1));return}const K=typeof _=="string"?_.trim():_;K!=null&&K!==""&&(u.add(K),T&&(p=!0))};l&&((l.assignToAllGroups||l.assignmentScope==="all"||l.targetScope==="all")&&r.forEach(_=>g(_.id,!0)),f.forEach(_=>{Object.prototype.hasOwnProperty.call(l,_)&&g(l[_],!0)}));const m=n.filter(_=>_.taskId===o),x=new Set;let S=0;m.forEach(_=>{_.groupId&&(x.add(_.groupId),g(_.groupId,!1));const T=_!=null&&_.scores?Object.keys(_.scores).length:Number(_.participantCount)||0;S+=T}),(!u.size||!p)&&r.forEach(_=>{(_==null?void 0:_.id)!==void 0&&(_==null?void 0:_.id)!==null&&u.add(_.id)});let B=0;u.forEach(_=>{B+=i.get(_)||0}),B===0&&(B=e.length),B===0&&(B=S),S=Math.min(S,B);const F=Math.max(B-S,0),N=B>0?Math.min(100,S/B*100):0,E=u.size||r.length||x.size,w=x.size,v=Math.max((E||0)-w,0);return{taskId:o,taskTitle:c,evaluated:S,pending:F,total:B,completionPercent:N,lastUpdated:(a==null?void 0:a.ts)||A||Date.now(),scheduledTimeDisplay:h,groupTotal:E,groupsEvaluated:w,groupsPending:v}}function ox(r=[],e=[]){if(!e.length)return{assignmentSummaries:[],overallAverage:0,assignmentAverageMap:new Map};const t=new Map(r.map(o=>[String(o.id),o])),n=new Map;e.forEach(o=>{if(!o.taskId)return;const l=String(o.taskId),c=fie(o,t);if(typeof c!="number"||Number.isNaN(c))return;n.has(l)||n.set(l,{total:0,count:0});const A=n.get(l);A.total+=c,A.count++});const s=[],i=new Map;n.forEach((o,l)=>{if(!o.count)return;const c=t.get(l),A=o.total/o.count;s.push({taskId:l,taskTitle:(c==null?void 0:c.title)||(c==null?void 0:c.name)||" ",averagePercent:A,evaluationCount:o.count}),i.set(l,A)});const a=s.length?s.reduce((o,l)=>o+l.averagePercent,0)/s.length:0;return{assignmentSummaries:s,overallAverage:a,assignmentAverageMap:i}}function pie(r=[],e=null){if(!Array.isArray(r)||r.length===0)return[];const t=(e==null?void 0:e.taskId)||null;return r.map(n=>{const s=qo(n),i=n.title||n.name||" ";return{id:n.id??n.uid??n.key??`${i}-${s||Date.now()}`,title:i,timestamp:s,dateLabel:s?xb(s):"  "}}).sort((n,s)=>(s.timestamp||0)-(n.timestamp||0)).slice(0,6).map((n,s)=>{const i=t?n.id===t:s===0;return{...n,index:s+1,isLatest:i,relativeLabel:mie(n.timestamp)}})}function mie(r){if(!r)return"";const e=new Date(r);if(Number.isNaN(e.getTime()))return"";const t=new Date,n=new Date(e.getFullYear(),e.getMonth(),e.getDate()),s=new Date(t.getFullYear(),t.getMonth(),t.getDate()),i=Math.round((n-s)/(1e3*60*60*24));if(i===0)return"";const a=Math.abs(i),o=gr!=null&&gr.convertToBanglaNumber&&typeof gr.convertToBanglaNumber=="function"?gr.convertToBanglaNumber(String(a)):String(a);return i>0?`${o}  `:`${o}  `}function bie(r,e){const t=e?e.data:[],n={},s=new Map(r.map(i=>[String(i.id),i]));return t.forEach(i=>{const a=i.group.id,o=i.averageScore;if(o<0)return;(i.evaluatedMemberIds||new Set).forEach(c=>{const A=s.get(String(c));if(!A)return;const d=A.academicGroup;if(!d)return;n[d]||(n[d]={totalStudents:0,scoreSum:0,groupCount:0,processedGroups:new Set,processedStudents:new Set}),n[d].processedStudents.has(String(c))||(n[d].totalStudents++,n[d].processedStudents.add(String(c)));const h=String(a);n[d].processedGroups.has(h)||(n[d].scoreSum+=o,n[d].groupCount++,n[d].processedGroups.add(h))})}),Object.keys(n).forEach(i=>{const a=n[i];a.averageScore=a.groupCount>0?a.scoreSum/a.groupCount:0,delete a.processedGroups,delete a.processedStudents}),n}function yM(r){const e=(x,S)=>{x&&(x.textContent=S??"-")},t=(x,S=0)=>typeof x!="number"||isNaN(x)?"-":gr.convertToBanglaNumber(x.toFixed(S));e(Ie.totalGroups,t(r.totalGroups)),e(Ie.totalStudents,t(r.totalStudents)),e(Ie.totalAcademicGroups,t(r.totalAcademicGroups)),e(Ie.pendingRoles,t(r.pendingRoles)),e(Ie.maleStudents,t(r.maleStudents)),e(Ie.malePercentage,`${t(r.malePercentage,0)}%`),e(Ie.femaleStudents,t(r.femaleStudents)),e(Ie.femalePercentage,`${t(r.femalePercentage,0)}%`),e(Ie.totalTasks,t(r.totalTasks)),e(Ie.pendingEvaluations,t(r.pendingEvaluations));const n=r.latestAssignmentSummary||null,s=n?Math.min(100,Math.max(0,Number(n.completionPercent)||0)):0,i=n?t(n.evaluated):"-",a=n?t(n.pending):"-",o=n?t(n.total):"-",l=n?t(n.groupsEvaluated):"-",c=n?t(n.groupsPending):"-",A=n?t(n.groupTotal):"-",d=n?xb(n.lastUpdated):"-";let h=n?aie(n.lastUpdated):"-";h==="-"&&(n!=null&&n.scheduledTimeDisplay)&&(h=n.scheduledTimeDisplay);const u=d==="-"&&h==="-"?"-":`: ${d} | : ${h}`;if(Ie.latestTaskTitle){const x=(n==null?void 0:n.taskTitle)||" ";e(Ie.latestTaskTitle,x),Ie.latestTaskTitle.setAttribute("title",x)}Ie.latestAssignmentUpdated&&e(Ie.latestAssignmentUpdated,u),Ie.latestAssignmentEvaluated&&e(Ie.latestAssignmentEvaluated,i),Ie.latestAssignmentPending&&e(Ie.latestAssignmentPending,a),Ie.latestAssignmentStudentTotal&&e(Ie.latestAssignmentStudentTotal,o),Ie.latestAssignmentGroupEvaluated&&e(Ie.latestAssignmentGroupEvaluated,l),Ie.latestAssignmentGroupPending&&e(Ie.latestAssignmentGroupPending,c),Ie.latestAssignmentGroupTotal&&e(Ie.latestAssignmentGroupTotal,A);const p=Array.isArray(r.assignmentSummaries)&&r.assignmentSummaries.length>0&&typeof r.overallAssignmentAverage=="number"&&!Number.isNaN(r.overallAssignmentAverage),f=typeof r.latestAssignmentAverage=="number"&&!isNaN(r.latestAssignmentAverage)?Math.min(100,Math.max(0,r.latestAssignmentAverage)):null,g=p?r.overallAssignmentAverage:r.overallProgress,m=typeof g=="number"&&!isNaN(g)?Math.min(100,Math.max(0,g)):0;if(e(Ie.overallProgress,`${t(m,0)}%`),Ie.latestAssignmentAverage&&(f!==null?e(Ie.latestAssignmentAverage,`${t(f,0)}%`):Ie.latestAssignmentAverage.textContent="-"),Ie.overallProgressCircle){const x=m/100*360,S="#0ea5e9",B="rgba(14,165,233,0.1)";Ie.overallProgressCircle.style.background=`conic-gradient(${S} ${x}deg, ${B} ${x}deg)`,Ie.overallProgressCircle.style.boxShadow="0 0 20px rgba(14,165,233,0.3)"}if(Ie.overallProgress,Ie.latestAssignmentCircle&&f!==null){const x=f/100*360,S="#10b981",B="rgba(16,185,129,0.1)";Ie.latestAssignmentCircle.style.background=`conic-gradient(${S} ${x}deg, ${B} ${x}deg)`,Ie.latestAssignmentCircle.style.boxShadow="0 0 20px rgba(16,185,129,0.3)",Ie.latestAssignmentAverage}if(Ie.progressBar){const x=Ie.progressBar,S=t_(s),B=Math.max(0,Math.min(100,s)),F=Number(x.dataset.prevWidth||0);x.classList.add("battery-liquid","shadow-lg"),x.style.setProperty("--fill",S.solid),x.style.boxShadow=`0 8px 20px ${S.shadow}`,x.style.transition="width 900ms cubic-bezier(0.4, 0, 0.2, 1)",F!==B?(x.style.width=`${F}%`,x.offsetWidth,requestAnimationFrame(()=>{x.style.width=`${B}%`})):x.style.width=`${B}%`,x.dataset.prevWidth=String(B)}if(Ie.progressBarLabel){const x=`${t(s,0)}%`;Ie.progressBarLabel.textContent=x;const S=s>=20;Ie.progressBarLabel.style.right=S?"8px":"auto",Ie.progressBarLabel.style.left=S?"auto":"8px",Ie.progressBarLabel.style.color="rgba(255,255,255,0.92)",Ie.progressBarLabel.style.minWidth="32px",Ie.progressBarLabel.style.textAlign=S?"right":"left"}yie(r.assignmentOverview||[],n)}function yie(r=[],e=null){if(!Ie.assignmentOverviewList)return;const t=s=>gr!=null&&gr.convertToBanglaNumber&&typeof gr.convertToBanglaNumber=="function"?gr.convertToBanglaNumber(String(s)):String(s);if(!r.length)Ie.assignmentOverviewList.innerHTML='<div class="py-4 text-sm text-gray-500 dark:text-gray-400">    </div>';else{const s=r.map(i=>{const a=t(i.index),o=i.isLatest?'<span class="inline-flex items-center gap-1 rounded-full bg-emerald-500/10 px-2 py-0.5 text-[0.65rem] font-medium text-emerald-600 dark:text-emerald-300"><i class="fas fa-bolt text-[0.6rem]"></i> </span>':"",l=i.relativeLabel?`<p class="text-xs text-gray-500 dark:text-gray-400">${Bm(i.relativeLabel)}</p>`:"",c=Bm(i.title);return`
          <div class="flex items-center justify-between gap-4 py-3">
            <div class="flex items-center gap-3 min-w-0">
              <span class="flex h-10 w-10 items-center justify-center rounded-2xl bg-indigo-500/10 text-sm font-semibold text-indigo-600 dark:text-indigo-300">${a}</span>
              <div class="min-w-0 space-y-1">
                <p class="text-sm font-semibold text-gray-900 dark:text-white truncate" title="${c}">${c}</p>
                ${o}
              </div>
            </div>
            <div class="text-right">
              <p class="text-sm font-medium text-gray-700 dark:text-gray-200">${Bm(i.dateLabel)}</p>
              ${l}
            </div>
          </div>
        `}).join("");Ie.assignmentOverviewList.innerHTML=s}const n=r.find(s=>s.isLatest)||r[0];if(Ie.assignmentOverviewLatestTitle){const s=(e==null?void 0:e.taskTitle)||(n==null?void 0:n.title)||"-";Ie.assignmentOverviewLatestTitle.textContent=s,Ie.assignmentOverviewLatestTitle.setAttribute("title",s)}if(Ie.assignmentOverviewLatestDate){let s="-";e!=null&&e.lastUpdated?s=bM(e.lastUpdated):n!=null&&n.timestamp&&(s=n.dateLabel||"-"),Ie.assignmentOverviewLatestDate.textContent=s}}function Tf(r){if(!Ie.topGroupsContainer)return;La.clearContainer(Ie.topGroupsContainer);const e=r.filter(u=>u.evalCount>0).slice(0,3);if(e.length===0){La.displayEmptyMessage(Ie.topGroupsContainer,"     ");return}const t=(u={})=>{const p=typeof u.latestAverageScore=="number"&&!Number.isNaN(u.latestAverageScore)?gr.convertToBanglaNumber(u.latestAverageScore.toFixed(1)):"-",f=typeof u.latestParticipantCount=="number"&&u.latestParticipantCount!==null?gr.convertToBanglaNumber(String(u.latestParticipantCount)):"-",g=typeof u.latestParticipationRate=="number"&&!Number.isNaN(u.latestParticipationRate)?gr.convertToBanglaNumber(String(Math.round(u.latestParticipationRate))):"-";return{avg:p==="-"?"-":`${p}%`,participants:f==="-"?"-":`${f} `,rate:g==="-"?"-":`${g}%`}},n=u=>`
    <div class="elite-latest-metrics">
      <div class="elite-metrics-title">
        <span class="elite-metrics-icon">
          <i class="fas fa-chart-line"></i>
        </span>
        <p class="elite-metrics-headline">   </p>
      </div>
      <div class="elite-metrics-chips">
        <div class="elite-metric-chip">
          <span class="elite-metric-label"></span>
          <span class="elite-metric-value">${u.avg}</span>
        </div>
        <div class="elite-metric-chip">
          <span class="elite-metric-label"></span>
          <span class="elite-metric-value">${u.participants}</span>
        </div>
        <div class="elite-metric-chip">
          <span class="elite-metric-label"> </span>
          <span class="elite-metric-value">${u.rate}</span>
        </div>
      </div>
    </div>
  `,s=[" "," "," "],i=["elite-podium-card relative rounded-3xl bg-gradient-to-br from-amber-400 via-yellow-500 to-orange-500 text-white p-5 md:p-6 shadow-2xl ring-4 ring-yellow-300/60 dark:ring-yellow-400/50 order-1 md:order-2 cursor-pointer","elite-podium-card relative rounded-3xl bg-gradient-to-br from-gray-100 via-gray-200 to-slate-200 dark:from-slate-600 dark:via-slate-500 dark:to-slate-600 text-gray-900 dark:text-gray-100 p-5 shadow-2xl ring-2 ring-slate-300/60 dark:ring-slate-400/40 order-2 md:order-1 cursor-pointer","elite-podium-card relative rounded-3xl bg-gradient-to-br from-amber-200 via-orange-300 to-amber-400 dark:from-amber-700 dark:via-orange-600 dark:to-amber-700 text-gray-900 dark:text-white p-5 shadow-2xl ring-2 ring-amber-300/60 dark:ring-amber-500/50 order-3 md:order-3 cursor-pointer"],a=['<i class="fa-solid fa-crown text-amber-400 dark:text-amber-200"></i>','<i class="fa-solid fa-medal text-slate-700 dark:text-slate-200"></i>','<i class="fa-solid fa-award text-amber-700 dark:text-amber-200"></i>'],o=[{max:34,min:16},{max:30,min:14},{max:28,min:15}],l=()=>{!Ie.topGroupsContainer||typeof window>"u"||typeof window.requestAnimationFrame!="function"||window.requestAnimationFrame(()=>{Ie.topGroupsContainer.querySelectorAll(".elite-card-name").forEach(p=>{const f=window.getComputedStyle(p),g=parseFloat(p.dataset.maxFont||"")||parseFloat(f.fontSize)||22,m=parseFloat(p.dataset.minFont||"")||Math.max(12,g*.65);let x=g;p.style.fontSize=`${x}px`;let S=0;for(;x>m&&p.scrollWidth>p.clientWidth&&S<25;)x-=.5,p.style.fontSize=`${Math.max(x,m)}px`,S+=1})})},c=(u,p)=>{var _;if(!u)return"";const f=typeof u.averageScore=="number"?u.averageScore:0,g=gr.convertToBanglaNumber(f.toFixed(1)),m=typeof u.studentCount=="number"?u.studentCount:0,x=gr.convertToBanglaNumber(m),S=t(u),B=n(S),F=e_(u.groupName),N=o[p]||o[o.length-1],E=p===0?"elite-card-name elite-name-xl font-semibold text-white":"elite-card-name elite-name-lg font-semibold text-gray-900 dark:text-white",w=p===0?"text-white/85":"text-gray-800/80 dark:text-white/80",v=s[p]||gr.convertToBanglaRank(p+1),I=i[p]||i[i.length-1],k=a[p]||'<i class="fa-solid fa-trophy text-amber-700 dark:text-amber-200"></i>';return`
        <article class="${I}" data-group-id="${(_=u.group)==null?void 0:_.id}" role="button" tabindex="0" aria-pressed="false">
          <span class="elite-rank-chip">
            <span class="elite-rank-icon">${k}</span>
            <span class="elite-rank-title">${v}</span>
          </span>
          <div class="elite-card-inner">
            <div class="elite-score-stack">
              <span class="elite-score-value">${g}%</span>
              <span class="elite-score-label">  </span>
            </div>
            <div class="elite-card-body ${p===0?"space-y-1.5":"space-y-1"}">
              <div class="${E}" title="${F}" data-max-font="${N.max}" data-min-font="${N.min}">${F}</div>
              <div class="${w} text-xs sm:text-sm font-medium">
                <span>:</span>
                <span>${x}</span>
              </div>
            </div>
            ${B}
          </div>
        </article>
      `},A=e.map((u,p)=>c(u,p)).join(""),d=["grid","grid-cols-1","gap-6"];e.length>=2&&d.push("sm:grid-cols-2"),e.length>=3&&d.push("md:grid-cols-3"),Ie.topGroupsContainer.innerHTML=`
    <div class="${d.join(" ")}">
      ${A}
    </div>
  `,l(),Ie.topGroupsContainer&&typeof window<"u"&&typeof window.openGroupModalById=="function"&&La.addListener(Ie.topGroupsContainer,"click",u=>{const p=u.target.closest("[data-group-id]");if(!p)return;const f=p.getAttribute("data-group-id");if(f)try{window.openGroupModalById(f)}catch(g){console.warn("Elite group modal open failed:",g)}});const h=Ie.topGroupsContainer.closest("section");if(h){const u=h.querySelector("h3");u&&(u.textContent=" ");const p=h.querySelector("p.text-xs");p&&(p.textContent="        ");const f=h.querySelector("span.bg-indigo-500\\/10");if(f){const g=f.querySelector("i"),m=g?g.outerHTML:"";f.innerHTML=`${m} Elite Group`}}}function Ff(r){if(!Ie.academicGroupStatsList)return;La.clearContainer(Ie.academicGroupStatsList);const e=Object.entries(r).filter(([,i])=>i.groupCount>0).sort(([,i],[,a])=>a.averageScore-i.averageScore);if(e.length===0){La.displayEmptyMessage(Ie.academicGroupStatsList,"   ");return}const t=e.slice(0,3),n=t.map(([i,a])=>{const o=a.averageScore,l=t_(o),c=Math.min(100,Math.round(o)),A=gr.convertToBanglaNumber(o.toFixed(1)),d=gr.convertToBanglaNumber(a.totalStudents),h=gr.convertToBanglaNumber(a.groupCount),u=e_(i);return`
        <article class="relative overflow-hidden rounded-2xl border border-gray-200/70 bg-white p-5 shadow-sm transition hover:shadow-lg dark:border-gray-700/70 dark:bg-gray-900/70">
          <div class="absolute inset-0 bg-gradient-to-br ${l.gradient} opacity-60"></div>
          <div class="relative space-y-4">
            <div class="flex items-center justify-between">
              <h4 class="text-base font-semibold text-gray-900 dark:text-white" title="${u}">${u}</h4>
              <span class="inline-flex items-center gap-2 rounded-full bg-white/80 px-3 py-1 text-xs font-semibold text-gray-700 dark:bg-white/10 dark:text-gray-200 shadow">
                <i class="fas fa-signal"></i> : ${A}%
              </span>
            </div>
            <div class="h-2 w-full overflow-hidden rounded-full bg-gray-200 dark:bg-gray-700">
              <div class="h-full rounded-full" style="width: ${c}%; background: ${l.solid}; box-shadow: 0 6px 12px ${l.shadow};"></div>
            </div>
            <div class="grid grid-cols-2 gap-3 text-xs font-medium text-gray-600 dark:text-gray-300">
              <span class="inline-flex items-center gap-2">
                <i class="fas fa-users text-indigo-500"></i> : ${d}
              </span>
              <span class="inline-flex items-center gap-2 justify-end">
                <i class="fas fa-layer-group text-emerald-500"></i> : ${h}
              </span>
            </div>
          </div>
        </article>
      `}).join(""),s=["grid","grid-cols-1","gap-6"];t.length>=2&&s.push("sm:grid-cols-2"),t.length>=3&&s.push("lg:grid-cols-3"),Ie.academicGroupStatsList.innerHTML=`
    <div class="${s.join(" ")}">
      ${n}
    </div>
  `}function wie(r,e,t=""){var g;const n=t_(r.averageScore),s=gr.convertToBanglaRank(e),i=e_(r.groupName),a=m=>{const S=`${Math.max(0,Math.round(Number(m)||0))}`;return gr.convertToBanglaNumber?gr.convertToBanglaNumber(S):S},o=m=>{const S=(Number(m)||0).toFixed(2);return gr.convertToBanglaNumber?gr.convertToBanglaNumber(S):S},l=Math.min(100,Math.max(0,Number(r.averageScore)||0)),c=o(l),A=a(r.evalCount||0),d=a(r.studentCount||0),h=a(r.evaluatedMembers||0);a(r.taskCount||0);const u=` : ${d}  : ${h} `,p=((g=r.group)==null?void 0:g.id)||"";let f="";return t&&(f=`
        <span class="inline-flex items-center justify-center rounded-lg px-2 py-1 text-[10px] font-bold border ml-2 ${pM(t)}">
          ${t}
        </span>
      `),`
  <article class="relative flex items-center justify-between gap-4 rounded-2xl border border-transparent
                  bg-white/90 p-4 shadow-sm transition hover:-translate-y-0.5 hover:shadow-lg
                  dark:border-transparent dark:bg-slate-900/70 cursor-pointer"
           data-group-id="${p}"
           style="box-shadow:0 10px 24px ${n.shadow}; border:1px solid ${n.solid}55;">
    <div class="flex items-start gap-3 min-w-0">
      <div class="flex flex-col items-center justify-center rounded-xl bg-slate-900/5 px-3 py-2 text-center
                  text-slate-700 shadow-sm dark:bg-white/10 dark:text-slate-100">
        <div class="text-sm font-bold">${s}</div>
        <div class="text-[10px] font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-300"> </div>
      </div>
      <div class="min-w-0 space-y-2">
        <h4 class="truncate text-base font-semibold text-slate-900 dark:text-white flex items-center" title="${i}">
          ${i}
          ${f}
        </h4>
        <div class="grid grid-cols-2 gap-2 text-[12px] font-semibold">
          <span class="inline-flex items-center justify-center rounded-lg bg-slate-100 px-2 py-1 text-slate-700
                       dark:bg-slate-800 dark:text-slate-100">
            : ${c}%
          </span>
          <span class="inline-flex items-center justify-center rounded-lg bg-slate-900/5 px-2 py-1 text-slate-700
                       dark:bg-white/10 dark:text-slate-100">
             : ${A} 
          </span>
        </div>
        <p class="text-xs text-slate-600 dark:text-slate-300 truncate" title="${u}">
          ${u}
        </p>
      </div>
    </div>

    <div class="flex flex-col items-center gap-1 shrink-0">
      ${vie(l,n,64)}
      <span class="text-xs font-semibold text-slate-500 dark:text-slate-300">Avg%</span>
    </div>
  </article>`}function Lf(r,e=null,t=""){if(!Ie.groupsRankingList)return;La.clearContainer(Ie.groupsRankingList);const n=r.filter(a=>a.evalCount>0);if(n.length===0){La.displayEmptyMessage(Ie.groupsRankingList,"   ");return}const i=[...n].sort((a,o)=>o.averageScore!==a.averageScore?o.averageScore-a.averageScore:o.evalCount!==a.evalCount?o.evalCount-a.evalCount:(a.groupName||"").localeCompare(o.groupName||"","bn")).map((a,o)=>{const l=o+1;return wie(a,l,t)}).join("");Ie.groupsRankingList.innerHTML=`
    <div class="grid grid-cols-1 gap-4 sm:gap-5">
      ${i}
    </div>
  `,Ie.groupsRankingList&&window&&typeof window.openGroupModalById=="function"&&La.addListener(Ie.groupsRankingList,"click",a=>{const o=a.target.closest("[data-group-id]");if(!o)return;const l=o.getAttribute("data-group-id");if(l)try{window.openGroupModalById(l)}catch(c){console.warn("Group modal open failed:",c)}})}function e_(r){if(r==null)return"";const e=gr!=null&&gr.ensureBengaliText&&typeof gr.ensureBengaliText=="function"?gr.ensureBengaliText(r):String(r);return Bm(e.trim())}function Bm(r){return String(r).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function t_(r){const e=Number(r)||0;return e>=85?{solid:"#22c55e",soft:"rgba(34,197,94,0.18)",gradient:"from-emerald-500/15 via-emerald-400/10 to-transparent",shadow:"rgba(34,197,94,0.28)"}:e>=70?{solid:"#0ea5e9",soft:"rgba(14,165,233,0.18)",gradient:"from-sky-500/15 via-sky-400/10 to-transparent",shadow:"rgba(14,165,233,0.25)"}:e>=55?{solid:"#f59e0b",soft:"rgba(245,158,11,0.18)",gradient:"from-amber-500/15 via-amber-400/10 to-transparent",shadow:"rgba(245,158,11,0.25)"}:{solid:"#f43f5e",soft:"rgba(244,63,94,0.18)",gradient:"from-rose-500/15 via-rose-400/10 to-transparent",shadow:"rgba(244,63,94,0.25)"}}function vie(r,e,t=96){const n=Math.max(0,Math.min(100,Number(r)||0)),s=typeof t=="number"?t:96,i=gr.convertToBanglaNumber(Math.round(n).toString());return`
    <div class="relative flex items-center justify-center" style="width:${s}px;height:${s}px;">
      <div class="absolute inset-0 rounded-full" style="background: conic-gradient(${e.solid} ${n}%, ${e.soft} ${n}% 100%);"></div>
      <div class="absolute inset-[18%] rounded-full bg-white dark:bg-gray-900 flex items-center justify-center shadow-inner" style="box-shadow: 0 8px 18px ${e.shadow};">
        <span class="text-lg font-semibold text-gray-800 dark:text-gray-100">${i}%</span>
      </div>
    </div>
  `}function xie(){var se;const r=document.getElementById("teacherFiltersContainer"),e=document.getElementById("teacherInfoCard"),t=document.getElementById("teacherNameDisplay"),n=document.getElementById("teacherAssignmentDisplay"),s=document.getElementById("dashboardClassFilter"),i=document.getElementById("dashboardSectionFilter"),a=document.getElementById("dashboardSubjectFilter"),o=document.getElementById("topNavTeacherInfo"),l=document.getElementById("topNavTeacherName"),c=document.getElementById("topNavContextDetails"),A=document.getElementById("topNavFilters"),d=document.getElementById("topNavClassFilter"),h=document.getElementById("topNavSectionFilter"),u=document.getElementById("topNavSubjectFilter"),p=document.getElementById("contextFiltersWrapper");console.log(" Filter setup debug:",{teacherInfoContainer:!!r,teacherInfoCard:!!e,contextFiltersWrapper:!!p});const f=hr.get("currentUserData"),g=hr.get("currentTeacher"),m=f&&f.type==="teacher",x=f?f.type==="admin"||f.type==="super-admin":!0;if(console.log(" User type:",f==null?void 0:f.type,"isAdmin:",x,"isTeacher:",m),p&&p.classList.remove("hidden"),A&&A.classList.remove("hidden"),m){r&&r.classList.remove("hidden"),e&&e.classList.remove("hidden");const X=(g==null?void 0:g.name)||(f==null?void 0:f.name)||((se=f==null?void 0:f.email)==null?void 0:se.split("@")[0])||"";e.querySelector(".rounded-full"),e.querySelector("i");const $=e.querySelector("span.text-xs");$&&($.textContent=" "),t&&(t.textContent=X),o&&o.classList.add("hidden"),l&&(l.textContent=X);const V=(g==null?void 0:g.assignedClasses)||[],he=(g==null?void 0:g.assignedSections)||[],z=(g==null?void 0:g.assignedSubjects)||[],M=hr.get("classes")||[],O=hr.get("sections")||[],H=hr.get("subjects")||[],J=M.filter(Be=>V.includes(Be.id)),de=O.filter(Be=>he.includes(Be.id)),ie=H.filter(Be=>z.includes(Be.id)),le=J.map(Be=>Be.name).join(", ")||"N/A",fe=de.map(Be=>Be.name).join(", ")||"N/A",ve=ie.map(Be=>Be.name).join(", ")||"N/A",Ce=`
                <span class="text-indigo-600 dark:text-indigo-400">:</span> ${le} 
                <span class="mx-1 text-indigo-400">|</span>
                <span class="text-indigo-600 dark:text-indigo-400">:</span> ${fe}
                <span class="mx-1 text-indigo-400">|</span>
                <span class="text-indigo-600 dark:text-indigo-400">:</span> ${ve}
            `;n&&(n.innerHTML=Ce),c&&(c.innerHTML=Ce)}else e&&e.classList.add("hidden"),o&&o.classList.add("hidden");if(!s||!i||!a)return;const S=hr.get("classes")||[],B=hr.get("sections")||[],F=hr.get("subjects")||[];let N=S,E=B,w=F;if(m){const X=(g==null?void 0:g.assignedClasses)||[],$=(g==null?void 0:g.assignedSections)||[],V=(g==null?void 0:g.assignedSubjects)||[];N=S.filter(he=>X.includes(he.id)),E=B.filter(he=>$.includes(he.id)),w=F.filter(he=>V.includes(he.id))}const v=Array.from(new Map(N.map(X=>[X.name,X])).values()),I=Array.from(new Map(E.map(X=>[X.name,X])).values()),k=Array.from(new Map(w.map(X=>[X.name,X])).values()),_=(X,$,V)=>{X&&La.populateSelect(X,$.map(he=>({value:he.id,text:he.name})),V)};_(s,v," "),_(i,I," "),_(a,k," "),_(d,v," "),_(h,I," "),_(u,k," ");const T=hr.get("activeContext")||{},L=(X,$)=>{X&&$&&(X.value=$)};L(s,T.classId),L(i,T.sectionId),L(a,T.subjectId),L(d,T.classId),L(h,T.sectionId),L(u,T.subjectId);const K=X=>{let $,V,he;X==="topnav"?($=d==null?void 0:d.value,V=h==null?void 0:h.value,he=u==null?void 0:u.value):($=s==null?void 0:s.value,V=i==null?void 0:i.value,he=a==null?void 0:a.value),hr.setActiveContext({classId:$||null,sectionId:V||null,subjectId:he||null}),mM()};s&&(s.onchange=()=>K("body")),i&&(i.onchange=()=>K("body")),a&&(a.onchange=()=>K("body")),d&&(d.onchange=()=>K("topnav")),h&&(h.onchange=()=>K("topnav")),u&&(u.onchange=()=>K("topnav"))}function wM(r,e){if(!e)return r;const t=e.assignedClasses||[],n=e.assignedSections||[],s=e.assignedSubjects||[],i=r.subjects||[],a=r.sections||[];new Set(i.filter(u=>s.includes(u.id)).map(u=>{var p;return(p=u.name)==null?void 0:p.trim()}));const o=new Set(a.filter(u=>n.includes(u.id)).map(u=>{var p;return(p=u.name)==null?void 0:p.trim()})),l=r.tasks.filter(u=>u.subjectId?!!s.includes(u.subjectId):!1),c=r.students.filter(u=>{if(!t.includes(u.classId))return!1;if(n.length>0){if(n.includes(u.sectionId))return!0;const p=a.find(f=>f.id===u.sectionId);return!!(p&&p.name&&o.has(p.name.trim()))}return!0}),A=r.groups.filter(u=>{if(!t.includes(u.classId))return!1;if(n.length>0){if(!u.sectionId||n.includes(u.sectionId))return!0;const p=a.find(f=>f.id===u.sectionId);return!!(p&&p.name&&o.has(p.name.trim()))}return!0}),d=new Set(l.map(u=>u.id)),h=r.evaluations.filter(u=>{if(!d.has(u.taskId))return!1;const p=r.groups.find(f=>f.id===u.groupId);if(p){if(!t.includes(p.classId))return!1;if(n.length>0&&p.sectionId){if(n.includes(p.sectionId))return!0;const f=a.find(g=>g.id===p.sectionId);return!!(f&&f.name&&o.has(f.name.trim()))}}return!0});return{tasks:l,students:c,groups:A,evaluations:h}}let cs,vr,uA,hh,wy,sl;const Ci={};function _ie(r){return cs=r.managers.stateManager,vr=r.managers.uiManager,uA=r.services.dataService,sl=r.utils.permissionHelper,hh=r.utils,wy=r.app,Cie(),Sie(),console.log(" Groups component initialized."),{render:Bie,populateGroupSelects:Lie}}function Bie(){if(!Ci.page){console.error(" Groups render failed: Page element #page-groups not found.");return}console.log("Rendering Groups page...");const r=cs.get("groups");kie(r)}function Cie(){if(Ci.page=document.getElementById("page-groups"),!Ci.page){console.error(" Groups init failed: #page-groups element not found!");return}Ci.groupNameInput=Ci.page.querySelector("#groupNameInput"),Ci.addGroupBtn=Ci.page.querySelector("#addGroupBtn"),Ci.groupsList=Ci.page.querySelector("#groupsList")}function Sie(){Ci.page&&(vr.addListener(Ci.addGroupBtn,"click",Eie),vr.addListener(Ci.groupsList,"click",r=>{const e=r.target.closest(".edit-group-btn"),t=r.target.closest(".delete-group-btn");if(e){const n=e.dataset.id;Tie(n)}else if(t){const n=t.dataset.id;Fie(n)}}))}function kie(r){if(!Ci.groupsList){console.warn("Groups render: groupsList element not found.");return}if(vr.clearContainer(Ci.groupsList),!r||r.length===0){vr.displayEmptyMessage(Ci.groupsList,"    ");return}const e=[...r].sort((s,i)=>(s.name||"").localeCompare(i.name||"","bn")),t=cs.get("students")||[],n=e.map(s=>{var a,o;const i=t.filter(l=>l.groupId===s.id).length;return`
        <div class="card p-4 flex flex-col sm:flex-row justify-between items-start sm:items-center">
            <div>
                <h4 class="text-lg font-semibold text-gray-800 dark:text-white">${hh.ensureBengaliText(s.name)}</h4>
                <div class="text-sm text-gray-500 dark:text-gray-400 mt-1">
                    ${s.classId?`<span class="mr-2"><i class="fas fa-chalkboard mr-1"></i>${((a=(cs.get("classes")||[]).find(l=>l.id===s.classId))==null?void 0:a.name)||" "}</span>`:""}
                    ${s.sectionId?`<span class="mr-2"><i class="fas fa-layer-group mr-1"></i>${((o=(cs.get("sections")||[]).find(l=>l.id===s.sectionId))==null?void 0:o.name)||" "}</span>`:""}
                    <span><i class="fas fa-users mr-1"></i>${hh.convertToBanglaNumber(i)} </span>
                </div>
            </div>
            <div class="flex space-x-2 mt-3 sm:mt-0 self-end sm:self-auto">
                <button data-id="${s.id}" 
                        class="edit-group-btn btn btn-light btn-sm py-1 px-2"
                        aria-label="  ">
                    <i class="fas fa-edit pointer-events-none"></i>
                </button>
                <button data-id="${s.id}" 
                        class="delete-group-btn btn btn-danger btn-sm py-1 px-2"
                        aria-label="  ">
                    <i class="fas fa-trash pointer-events-none"></i>
                </button>
            </div>
        </div>
        `}).join("");Ci.groupsList.innerHTML=n}async function Eie(){if(!(sl!=null&&sl.canWrite())){vr.showToast("      ","warning");return}Iie()}function Iie(){const r=cs.get("students")||[],e=cs.get("classes")||[],t=cs.get("sections")||[],n=[],s=new Set;t.forEach(w=>{const v=w.name?w.name.trim():"";v&&!s.has(v)&&(s.add(v),n.push(w))});let i=new Set,a=[...r];const o=`
    <div id="studentSelectionModal" class="fixed inset-0 z-[9999] bg-black/50 flex items-center justify-center p-4">
      <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] flex flex-col">
        <!-- Header -->
        <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between flex-shrink-0">
          <h3 class="text-xl font-bold text-gray-900 dark:text-white">   </h3>
          <button id="btnCloseStudentModal" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300">
            <i class="fas fa-times text-xl"></i>
          </button>
        </div>
        
        <!-- Content -->
        <div class="flex-1 overflow-y-auto p-6 space-y-4">
          <!-- Group Details Form (Top) -->
          <div class="space-y-4 pb-4 border-b border-gray-200 dark:border-gray-700">
            <div>
              <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">  *</label>
              <input 
                id="groupNameInput" 
                type="text" 
                placeholder=":   - A" 
                class="form-input w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"
                maxlength="50"
              >
            </div>
            
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
              <div>
                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"> *</label>
                <select id="groupClassInput" class="form-select w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                  <option value="">  </option>
                  ${e.map(w=>`<option value="${w.id}">${w.name}</option>`).join("")}
                </select>
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"> ()</label>
                <select id="groupSectionInput" class="form-select w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                  <option value="">  </option>
                  ${n.map(w=>`<option value="${w.id}">${w.name}</option>`).join("")}
                </select>
              </div>
            </div>
            
            <div>
              <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"> ()</label>
              <textarea 
                id="groupDescInput" 
                rows="2" 
                placeholder="   ..."
                class="form-input w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"
              ></textarea>
            </div>
          </div>
          
          <!-- Student Selection Section -->
          <div class="space-y-3">
            <h4 class="text-lg font-semibold text-gray-900 dark:text-white">  </h4>
            
            <!-- Search -->
            <input 
              id="studentSearch" 
              type="text" 
              placeholder="  (  )..." 
              class="form-input w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"
            >
            
            <!-- Filters -->
            <div class="grid grid-cols-1 sm:grid-cols-3 gap-3">
              <select id="filterClass" class="form-select px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                <option value=""> </option>
                ${e.map(w=>`<option value="${w.id}">${w.name}</option>`).join("")}
              </select>
              
              <select id="filterSection" class="form-select px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                <option value=""> </option>
                ${n.map(w=>`<option value="${w.id}">${w.name}</option>`).join("")}
              </select>
              
              <select id="filterAcademicGroup" class="form-select px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                <option value="">  </option>
                ${[...new Set(r.map(w=>w.academicGroup||w.group).filter(w=>w))].map(w=>`<option value="${w}">${w}</option>`).join("")}
              </select>
            </div>
            
            <!-- Select All and Count -->
            <div class="flex items-center justify-between py-2 px-3 bg-indigo-50 dark:bg-indigo-900/20 rounded-lg border border-indigo-200 dark:border-indigo-800">
              <label class="flex items-center gap-2 cursor-pointer">
                <input type="checkbox" id="selectAllStudents" class="form-checkbox rounded text-indigo-600">
                <span class="text-sm font-medium text-indigo-700 dark:text-indigo-300">   </span>
              </label>
              <span id="selectedCount" class="text-sm font-bold text-indigo-600 dark:text-indigo-400 bg-white dark:bg-gray-800 px-3 py-1 rounded-full">: </span>
            </div>
            
            <!-- Students List -->
            <div id="modalStudentsList" class="space-y-2 max-h-72 overflow-y-auto border border-gray-200 dark:border-gray-700 rounded-lg p-3 bg-gray-50 dark:bg-gray-900/50">
              <p class="text-center text-gray-500 dark:text-gray-400 py-8"> ...</p>
            </div>
          </div>
        </div>
        
        <!-- Footer -->
        <div class="px-6 py-4 border-t border-gray-200 dark:border-gray-700 flex gap-3 flex-shrink-0">
          <button id="btnCancelGroupCreate" class="flex-1 px-4 py-2.5 border-2 border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 font-medium">
            
          </button>
          <button id="btnCreateGroup" class="flex-1 px-4 py-2.5 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-medium shadow-sm">
            <i class="fas fa-plus mr-2"></i>  
          </button>
        </div>
      </div>
    </div>
  `,l=document.createElement("div");l.innerHTML=o,document.body.appendChild(l.firstElementChild);const c=document.getElementById("studentSelectionModal"),A=document.getElementById("modalStudentsList"),d=document.getElementById("studentSearch"),h=document.getElementById("filterClass"),u=document.getElementById("filterSection"),p=document.getElementById("filterAcademicGroup"),f=document.getElementById("selectAllStudents"),g=document.getElementById("selectedCount"),m=document.getElementById("btnCloseStudentModal"),x=document.getElementById("btnCancelGroupCreate"),S=document.getElementById("btnCreateGroup");function B(){if(console.log(" renderStudents called"),console.log(" filteredStudents count:",a.length),console.log(" studentsList element:",A),!A){console.error(" studentsList element not found!");return}if(a.length===0){A.innerHTML='<p class="text-center text-gray-500 dark:text-gray-400 py-8">   </p>';return}const w=a.map(v=>{var T,L;const I=((T=e.find(K=>K.id===v.classId))==null?void 0:T.name)||"-",k=((L=t.find(K=>K.id===v.sectionId))==null?void 0:L.name)||"-",_=i.has(v.id);return`
        <label class="flex items-center gap-3 p-3 rounded-lg border ${_?"border-indigo-500 bg-indigo-50 dark:bg-indigo-900/20":"border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800"} hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer transition-colors">
          <input 
            type="checkbox" 
            class="student-checkbox form-checkbox rounded text-indigo-600" 
            data-student-id="${v.id}"
            ${_?"checked":""}
          >
          <div class="flex-1 min-w-0">
            <div class="font-semibold text-gray-900 dark:text-white truncate">${v.name||" "}</div>
            <div class="text-sm text-gray-500 dark:text-gray-400 truncate">
              <span class="inline-flex items-center"><i class="fas fa-id-badge mr-1 text-xs"></i>: ${v.roll||"-"}</span>
              <span class="mx-2"></span>
              <span>${I}</span>
              <span class="mx-2"></span>
              <span>${k}</span>
              ${v.academicGroup?`<span class="mx-2"></span><span>${v.academicGroup}</span>`:""}
            </div>
          </div>
        </label>
      `}).join("");console.log(" Rendering",a.length,"students"),A.innerHTML=w,N()}function F(){var _;console.log(" applyFilters called");const w=((_=d==null?void 0:d.value)==null?void 0:_.toLowerCase().trim())||"",v=(h==null?void 0:h.value)||"",I=(u==null?void 0:u.value)||"",k=(p==null?void 0:p.value)||"";if(console.log(" Filters:",{searchTerm:w,classFilter:v,sectionFilter:I,groupFilter:k}),console.log(" Total students:",r.length),k){const T=[...new Set(r.map(L=>L.academicGroup||L.group||"(empty)"))];console.log(" Unique Academic Groups in DB:",T),console.log(" Filter value:",k)}a=r.filter(T=>{const L=!w||T.name&&T.name.toLowerCase().includes(w)||T.roll&&T.roll.toString().includes(w),K=!v||T.classId===v;let se=!0;if(I){const $=n.find(V=>V.id===I);if($){const V=t.find(he=>he.id===T.sectionId);se=V&&V.name===$.name}else se=T.sectionId===I}let X=!0;if(k){const $=(T.academicGroup||T.group||"").trim(),V=k.trim();X=$===V||$.toLowerCase()===V.toLowerCase()}return L&&K&&se&&X}),console.log(" Filtered students count:",a.length),B()}function N(){const w=i.size;g.textContent=`: ${hh.convertToBanglaNumber(w)}`;const v=Array.from(A.querySelectorAll(".student-checkbox")),I=v.length>0&&v.every(k=>k.checked);f.checked=I}d.addEventListener("input",F),h.addEventListener("change",F),u.addEventListener("change",F),p.addEventListener("change",F),f.addEventListener("change",w=>{A.querySelectorAll(".student-checkbox").forEach(I=>{I.checked=w.target.checked;const k=I.dataset.studentId;w.target.checked?i.add(k):i.delete(k)}),B()}),A.addEventListener("change",w=>{if(w.target.classList.contains("student-checkbox")){const v=w.target.dataset.studentId;w.target.checked?i.add(v):i.delete(v),N()}});const E=()=>{c.remove()};m.addEventListener("click",E),x.addEventListener("click",E),c.addEventListener("click",w=>{w.target===c&&E()}),S.addEventListener("click",async()=>{const w=document.getElementById("groupNameInput").value.trim(),v=document.getElementById("groupDescInput").value.trim(),I=document.getElementById("groupClassInput").value,k=document.getElementById("groupSectionInput").value;if(!w){vr.showToast("  ","warning");return}if(!I){vr.showToast("   ","warning");return}if(i.size===0){vr.showToast("    ","warning");return}vr.showLoading("  ...");try{if(await uA.checkGroupNameExists(w)){vr.showToast("     ","warning"),vr.hideLoading();return}const T={name:w,description:v,classId:I,sectionId:k||null,studentIds:Array.from(i),createdAt:new Date().toISOString()},L=await uA.addGroup(T),K=Array.from(i);await uA.batchUpdateStudents(K,{groupId:L}),await wy.refreshAllData(),E(),vr.showToast(`    (${i.size}   )`,"success")}catch(_){console.error(" Error creating group:",_),vr.showToast(`    : ${_.message}`,"error")}finally{vr.hideLoading()}}),F()}function Tie(r){if(!(sl!=null&&sl.canEdit())){vr.showToast("     ","warning");return}const e=cs.get("groups").find(n=>n.id===r);if(!e){vr.showToast("  ","error");return}const t=`
        <div>
            <label class="label" for="editGroupNameInput"> </label>
            <input id="editGroupNameInput" type="text" 
                   class="form-input w-full" 
                   value="${e.name||""}"
                   maxlength="50" />
        </div>
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mt-3">
            <div>
                <label class="label" for="editGroupClassInput"></label>
                <select id="editGroupClassInput" class="form-select w-full">
                    <option value="">  </option>
                </select>
            </div>
            <div>
                <label class="label" for="editGroupSectionInput"></label>
                <select id="editGroupSectionInput" class="form-select w-full">
                    <option value="">  </option>
                </select>
            </div>
        </div>
    `;vr.showEditModal(" ",t,async()=>{const n=document.getElementById("editGroupNameInput"),s=document.getElementById("editGroupClassInput"),i=document.getElementById("editGroupSectionInput"),a=n==null?void 0:n.value.trim(),o=s==null?void 0:s.value,l=i==null?void 0:i.value;if(!a){vr.showToast("     ","warning");return}if(!o){vr.showToast("   ","warning");return}vr.showLoading("  ...");try{if(await uA.checkGroupNameExists(a,r)){vr.showToast("     ","warning"),vr.hideLoading();return}await uA.updateGroup(r,{name:a,classId:o,sectionId:l||null}),await wy.refreshAllData(),vr.hideModal(vr.elements.editModal),vr.showToast("    ","success")}catch(c){console.error(" Error updating group:",c),vr.showToast(`   : ${c.message}`,"error")}finally{vr.hideLoading()}},()=>{const n=cs.get("groups").find(l=>l.id===r)||e,s=cs.get("classes")||[],i=cs.get("sections")||[],a=document.getElementById("editGroupClassInput"),o=document.getElementById("editGroupSectionInput");if(a&&vr.populateSelect(a,s.map(l=>({value:l.id,text:l.name})),"  ",n.classId),o){const l=[],c=new Set;i.forEach(A=>{const d=A.name?A.name.trim():"";d&&!c.has(d)&&(c.add(d),l.push(A))}),vr.populateSelect(o,l.map(A=>({value:A.id,text:A.name})),"  ",n.sectionId)}})}function Fie(r){if(!(sl!=null&&sl.canDelete())){vr.showToast("     ","warning");return}const e=cs.get("groups").find(s=>s.id===r);if(!e){vr.showToast("  ","error");return}const t=cs.get("students").filter(s=>s.groupId===r).length;let n=`     "${e.name}"    ?`;t>0&&(n+=` (  ${hh.convertToBanglaNumber(t)}           !)`),vr.showDeleteModal("  ",n,async()=>{vr.showLoading("  ...");try{const s=cs.get("students").filter(i=>i.groupId===r).map(i=>i.id);s.length>0&&await uA.batchUpdateStudents(s,{groupId:"",role:""}),await uA.deleteGroup(r),await wy.refreshAllData(),vr.showToast("    ","success")}catch(s){console.error(" Error deleting group:",s),vr.showToast(`    : ${s.message}`,"error")}finally{vr.hideLoading()}})}function Lie(r,e=" "){const t=cs.get("groups"),n=cs.get("currentUserData");console.log(" populateGroupSelects called"),console.log("Total groups:",(t==null?void 0:t.length)||0),console.log("User type:",n==null?void 0:n.type);let s=t;if(n&&n.type==="teacher"){const a=cs.get("students")||[],o=cs.get("currentTeacher"),l=(o==null?void 0:o.assignedClasses)||[],c=(o==null?void 0:o.assignedSections)||[],A=new Set(a.filter(f=>l.includes(f.classId)&&f.groupId).map(f=>f.groupId)),d=cs.get("classes")||[],h=cs.get("sections")||[],u=new Set(d.filter(f=>l.includes(f.id)).map(f=>{var g;return(g=f.name)==null?void 0:g.trim()})),p=new Set(h.filter(f=>c.includes(f.id)).map(f=>{var g;return(g=f.name)==null?void 0:g.trim()}));s=t.filter(f=>{var g,m;if(A.has(f.id))return!0;if(f.classId){const x=d.find(F=>F.id===f.classId),S=(g=x==null?void 0:x.name)==null?void 0:g.trim();if(l.includes(f.classId)||S&&u.has(S))if(f.sectionId){const F=h.find(w=>w.id===f.sectionId),N=(m=F==null?void 0:F.name)==null?void 0:m.trim();if(c.includes(f.sectionId)||N&&p.has(N))return!0}else return!0}return!1})}const i=s.map(a=>({value:a.id,text:hh.ensureBengaliText(a.name)})).sort((a,o)=>a.text.localeCompare(o.text,"bn"));r.forEach(a=>{const o=document.getElementById(a);if(o){const l=e.includes("")||e.includes("All")?"all":"";vr.populateSelect(o,i,e,o.value||l),e.includes("")&&o.options[0]&&(o.options[0].disabled=!0)}})}let Dr,dt,Wa,Bt,zl,Ua;const He={membersPage:null,csvFileInput:null,csvFileName:null,downloadTemplateBtn:null,processImportBtn:null,studentNameInput:null,studentRollInput:null,studentGenderInput:null,studentGroupInput:null,studentContactInput:null,studentAcademicGroupInput:null,studentSessionInput:null,studentRoleInput:null,addStudentBtn:null,membersFilterGroup:null,membersFilterAcademicGroup:null,studentSearchInput:null,studentsListContainer:null,cardsPage:null,cardsFilterGroup:null,cardsFilterAcademicGroup:null,allStudentsSearchInput:null,allStudentsCardsContainer:null};let vM,xM;const _M={membersList:"members-list",studentCards:"student-cards"};let jE="",VE="";const r_="inline-flex items-center px-2.5 py-1 text-xs font-semibold rounded-full border",Uie={"team-leader":{label:" ",className:"bg-amber-100 text-amber-700 border-amber-200 dark:bg-amber-500/20 dark:text-amber-100 dark:border-amber-500/40"},"time-keeper":{label:" ",className:"bg-sky-100 text-sky-700 border-sky-200 dark:bg-sky-500/20 dark:text-sky-100 dark:border-sky-500/40"},reporter:{label:"",className:"bg-purple-100 text-purple-700 border-purple-200 dark:bg-purple-500/20 dark:text-purple-100 dark:border-purple-500/40"},"resource-manager":{label:" ",className:"bg-emerald-100 text-emerald-700 border-emerald-200 dark:bg-emerald-500/20 dark:text-emerald-100 dark:border-emerald-500/40"},"peace-maker":{label:" ",className:"bg-rose-100 text-rose-700 border-rose-200 dark:bg-rose-500/20 dark:text-rose-100 dark:border-rose-500/40"}},Mie={science:{className:"bg-sky-100 text-sky-700 border-sky-200 dark:bg-sky-500/15 dark:text-sky-100 dark:border-sky-500/40"},humanities:{className:"bg-amber-100 text-amber-700 border-amber-200 dark:bg-amber-500/15 dark:text-amber-100 dark:border-amber-500/40"},business:{className:"bg-emerald-100 text-emerald-700 border-emerald-200 dark:bg-emerald-500/20 dark:text-emerald-100 dark:border-emerald-500/40"},other:{className:"bg-gray-100 text-gray-600 border-gray-200 dark:bg-gray-800 dark:text-gray-200 dark:border-gray-700"}};function Nie(){if(document.getElementById("members-soft3d-styles"))return;const r=document.createElement("style");r.id="members-soft3d-styles",r.textContent=`
  /* Panel (group section wrapper) */
  .panel-3d{
    border-radius: 1rem;
    overflow: hidden;
    box-shadow:
      0 1px 0 rgba(255,255,255,.6) inset,
      0 10px 18px rgba(0,0,0,.06),
      0 2px 4px rgba(0,0,0,.04);
  }
  .dark .panel-3d{
    box-shadow:
      0 1px 0 rgba(255,255,255,.08) inset,
      0 12px 22px rgba(0,0,0,.25),
      0 2px 4px rgba(0,0,0,.18);
  }

  /* Section header gloss */
  .header-3d::after{
    content:""; position:absolute; inset:0; pointer-events:none;
    background: radial-gradient(120% 140% at 110% -20%, rgba(255,255,255,.18), transparent 60%);
  }
  .dark .header-3d::after{
    background: radial-gradient(120% 140% at 110% -20%, rgba(255,255,255,.08), transparent 60%);
  }

  /* Card 3D (student card/list item) */
  .card-3d{
    border-radius: .875rem;
    box-shadow:
      0 1px 0 rgba(255,255,255,.55) inset,
      0 10px 18px rgba(0,0,0,.06),
      0 2px 4px rgba(0,0,0,.04);
    transition: transform .15s ease, box-shadow .15s ease;
    will-change: transform;
  }
  .card-3d:hover{
    transform: translateY(-1px);
    box-shadow:
      0 1px 0 rgba(255,255,255,.6) inset,
      0 14px 24px rgba(0,0,0,.10),
      0 4px 8px rgba(0,0,0,.06);
  }
  .dark .card-3d{
    box-shadow:
      0 1px 0 rgba(255,255,255,.08) inset,
      0 12px 22px rgba(0,0,0,.25),
      0 2px 4px rgba(0,0,0,.18);
  }
  .dark .card-3d:hover{
    box-shadow:
      0 1px 0 rgba(255,255,255,.10) inset,
      0 16px 26px rgba(0,0,0,.35),
      0 4px 8px rgba(0,0,0,.25);
  }

  /* Chip/Badge subtle inner highlight */
  .badge-3d{
    box-shadow: 0 1px 0 rgba(255,255,255,.45) inset, 0 1px 2px rgba(0,0,0,.06);
  }
  .dark .badge-3d{
    box-shadow: 0 1px 0 rgba(255,255,255,.10) inset, 0 1px 2px rgba(0,0,0,.25);
  }
  `,document.head.appendChild(r)}function BM(r){const e=`${r_} badge-3d`;if(!r)return`<span class="${e} bg-gray-100 text-gray-500 border-gray-200 dark:bg-gray-800 dark:text-gray-300 dark:border-gray-700">  </span>`;const t=Uie[r]||{label:r,className:"bg-gray-100 text-gray-600 border-gray-200 dark:bg-gray-800 dark:text-gray-200 dark:border-gray-700"},n=t.label?$o(t.label):$o(r);return`<span class="${e} ${t.className||""}">${n}</span>`}function CM(r){const e=`${r_} badge-3d`,t=(r||"").toString().trim();if(!t)return`<span class="${e} bg-gray-100 text-gray-500 border-gray-200 dark:bg-gray-800 dark:text-gray-300 dark:border-gray-700">   </span>`;const n=Die(t),s=Mie[n]||{className:"bg-gray-100 text-gray-600 border-gray-200 dark:bg-gray-800 dark:text-gray-200 dark:border-gray-700"},i=$o(t);return`<span class="${e} ${s.className}">${i}</span>`}function $o(r){if(r==null)return"";const e=Bt!=null&&Bt.ensureBengaliText&&typeof Bt.ensureBengaliText=="function"?Bt.ensureBengaliText(r):String(r);return Pie(e.trim())}function Pie(r){return String(r).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function Die(r){const e=(r||"").toString().toLowerCase();return e?e.includes("science")||e.includes("")?"science":e.includes("human")||e.includes("")?"humanities":e.includes("business")||e.includes("")||e.includes("")?"business":"other":"other"}function O0(r){return typeof r=="string"?r.toLowerCase():r==null?"":String(r).toLowerCase()}function Rie(r){if(!r)return"";if(typeof r=="number"||typeof r=="string")return String(r);if(typeof r=="object"){if(typeof r.toMillis=="function")try{return String(r.toMillis())}catch{}if(typeof r.seconds=="number"){const e=typeof r.nanoseconds=="number"?r.nanoseconds:0;return`${r.seconds}:${e}`}}return JSON.stringify(r)}function SM(r,e,t){const s=[...r].sort((a,o)=>{const l=(a.groupId||"").localeCompare(o.groupId||"");if(l!==0)return l;const c=`${a.roll??""}`.localeCompare(`${o.roll??""}`,void 0,{numeric:!0});return c!==0?c:(a.name||"").localeCompare(o.name||"","bn")}).map(a=>{const o=a.roll===void 0||a.roll===null?"":`${a.roll}`;return[a.id||"",a.name||"",o,a.groupId||"",a.academicGroup||"",a.session||"",a.gender||"",a.role||"",a.contact||"",Rie(a.updatedAt)].join("|")}).join("~"),i=JSON.stringify({group:(e==null?void 0:e.groupFilter)||"all",academic:(e==null?void 0:e.academicFilter)||"all",search:((e==null?void 0:e.searchTerm)||"").toLowerCase()});return`${t}::${i}::${s}`}function Oie(r){return Dr=r.managers.stateManager,dt=r.managers.uiManager,Wa=r.services.dataService,Ua=r.utils.permissionHelper,Bt=r.utils,zl=r.app,vM=Bt.createDebouncer(300),xM=Bt.createDebouncer(300),Nie(),jie(),Vie(),console.log(" Members component initialized."),{render:Qie,renderStudentCards:Hie,populateFilters:n_}}function Qie(){He.membersPage&&(n_(),Xie(),EM(),Cm())}function Hie(){if(!He.cardsPage){console.error(" Student Cards render failed: Page element #page-all-students not found.");return}console.log("Rendering All Students (Cards) page..."),n_(),Sm()}function jie(){He.membersPage=document.getElementById("page-members"),He.membersPage?(He.csvFileInput=He.membersPage.querySelector("#csvFileInput"),He.csvFileName=He.membersPage.querySelector("#csvFileName"),He.downloadTemplateBtn=He.membersPage.querySelector("#downloadTemplateBtn"),He.processImportBtn=He.membersPage.querySelector("#processImportBtn"),He.studentNameInput=He.membersPage.querySelector("#studentNameInput"),He.studentRollInput=He.membersPage.querySelector("#studentRollInput"),He.studentGenderInput=He.membersPage.querySelector("#studentGenderInput"),He.studentClassInput=He.membersPage.querySelector("#studentClassInput"),He.studentSectionInput=He.membersPage.querySelector("#studentSectionInput"),He.studentGroupInput=He.membersPage.querySelector("#studentGroupInput"),He.studentContactInput=He.membersPage.querySelector("#studentContactInput"),He.studentAcademicGroupInput=He.membersPage.querySelector("#studentAcademicGroupInput"),He.studentSessionInput=He.membersPage.querySelector("#studentSessionInput"),He.studentRoleInput=He.membersPage.querySelector("#studentRoleInput"),He.addStudentBtn=He.membersPage.querySelector("#addStudentBtn"),He.membersFilterGroup=He.membersPage.querySelector("#membersFilterGroup"),He.membersFilterAcademicGroup=He.membersPage.querySelector("#membersFilterAcademicGroup"),He.studentSearchInput=He.membersPage.querySelector("#studentSearchInput"),He.studentsListContainer=He.membersPage.querySelector("#studentsList")):console.warn("Members page element (#page-members) not found!"),He.cardsPage=document.getElementById("page-all-students"),He.cardsPage?(He.cardsFilterGroup=He.cardsPage.querySelector("#cardsFilterGroup"),He.cardsFilterAcademicGroup=He.cardsPage.querySelector("#cardsFilterAcademicGroup"),He.allStudentsSearchInput=He.cardsPage.querySelector("#allStudentsSearchInput"),He.allStudentsCardsContainer=He.cardsPage.querySelector("#allStudentsCards")):console.warn("All Students Cards page element (#page-all-students) not found!")}function Vie(){if(He.membersPage&&(dt.addListener(He.addStudentBtn,"click",Gie),dt.addListener(He.downloadTemplateBtn,"click",qie),dt.addListener(He.csvFileInput,"change",Wie),dt.addListener(He.processImportBtn,"click",Yie),dt.addListener(He.studentClassInput,"change",r=>{const e=r.target.value;EM(e)}),dt.addListener(He.membersFilterGroup,"change",r=>{Dr.updateFilters("membersList",{groupFilter:r.target.value})&&Cm()}),dt.addListener(He.membersFilterAcademicGroup,"change",r=>{Dr.updateFilters("membersList",{academicFilter:r.target.value})&&Cm()}),dt.addListener(He.studentSearchInput,"input",r=>{const e=r.target.value.trim();vM(()=>{Dr.updateFilters("membersList",{searchTerm:e})&&Cm()})}),He.studentsListContainer&&He.studentsListContainer.addEventListener("click",r=>{const e=r.target.closest(".edit-student-btn"),t=r.target.closest(".delete-student-btn");e?(r.stopPropagation(),zie(e.dataset.id)):t&&(r.stopPropagation(),Kie(t.dataset.id))},!0)),He.cardsPage){dt.addListener(He.cardsFilterGroup,"change",e=>{Dr.updateFilters("studentCards",{groupFilter:e.target.value})&&Sm()}),dt.addListener(He.cardsFilterAcademicGroup,"change",e=>{Dr.updateFilters("studentCards",{academicFilter:e.target.value})&&Sm()}),dt.addListener(He.allStudentsSearchInput,"input",e=>{const t=e.target.value.trim();xM(()=>{Dr.updateFilters("studentCards",{searchTerm:t})&&Sm()})});const r=He.cardsPage.querySelector("#printStudentsBtn");r&&dt.addListener(r,"click",$ie)}}function $ie(){const r=Dr.getFilterSection("studentCards"),t=(Dr.get("students")||[]).filter(c=>{const A=r.groupFilter==="all"||c.groupId===r.groupFilter,d=r.academicFilter==="all"||c.academicGroup===r.academicFilter,h=!r.searchTerm||c.name.toLowerCase().includes(r.searchTerm.toLowerCase())||String(c.roll||"").includes(r.searchTerm)||c.phone&&c.phone.includes(r.searchTerm);return A&&d&&h});if(t.length===0){dt.showToast("      ","warning");return}const n=new Date().toLocaleDateString("bn-BD"),s=Dr.get("groups")||[],i=t.map((c,A)=>{const d=s.find(g=>g.id===c.groupId),h=d?Bt.ensureBengaliText(d.name):"N/A",u=Bt.getStudentRoleText(c.role),f=c.role==="leader"||c.role==="team-leader"?"color: #ef4444; font-weight: bold;":"";return`
      <tr>
        <td>${Bt.convertToBanglaNumber(A+1)}</td>
        <td>${c.name}</td>
        <td>${Bt.convertToBanglaNumber(c.roll)}</td>
        <td>${h}</td>
        <td>${c.academicGroup||"-"}</td>
        <td>${c.session||"-"}</td>
        <td>${c.gender||"-"}</td>
        <td style="${f}">${u}</td>
      </tr>
    `}).join(""),a=`
    <!DOCTYPE html>
    <html lang="bn">
    <head>
      <meta charset="UTF-8">
      <title>Students List - ${n}</title>
      <style>
        body { font-family: 'Kalpurush', sans-serif; padding: 20px; }
        h1 { text-align: center; margin-bottom: 10px; }
        .meta { text-align: center; margin-bottom: 20px; color: #666; font-size: 14px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; font-size: 12px; }
        th { background-color: #f2f2f2; font-weight: bold; }
        tr:nth-child(even) { background-color: #f9f9f9; }
        @media print {
          .no-print { display: none; }
          table { page-break-inside: auto; }
          tr { page-break-inside: avoid; page-break-after: auto; }
        }
      </style>
    </head>
    <body>
      <h1>Students Directory</h1>
      <div class="meta">
        Total Students: ${Bt.convertToBanglaNumber(t.length)} | Date: ${n}
      </div>
      <table>
        <thead>
          <tr>
            <th></th>
            <th></th>
            <th></th>
            <th></th>
            <th> </th>
            <th></th>
            <th></th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          ${i}
        </tbody>
      </table>
    </body>
    </html>
  `;let o=document.getElementById("printFrame");o||(o=document.createElement("iframe"),o.id="printFrame",o.style.position="fixed",o.style.right="0",o.style.bottom="0",o.style.width="0",o.style.height="0",o.style.border="0",document.body.appendChild(o));const l=o.contentWindow.document;l.open(),l.write(a),l.close(),o.contentWindow.focus(),setTimeout(()=>{o.contentWindow.print()},500)}function n_(){const r=Dr.get("groups")||[],e=JSON.stringify(r.map(i=>`${i.id||""}:${i.name||""}`));if(e!==jE){jE=e;const i=[];He.membersFilterGroup&&i.push("membersFilterGroup"),He.cardsFilterGroup&&i.push("cardsFilterGroup"),zl.components.groups&&zl.components.groups.populateGroupSelects?(i.length&&zl.components.groups.populateGroupSelects(i," "),He.studentGroupInput&&(zl.components.groups.populateGroupSelects(["studentGroupInput"],"   "),He.studentGroupInput.options[0]&&(He.studentGroupInput.options[0].disabled=!0))):(i.length||He.studentGroupInput)&&console.warn("Members: Groups component not available to populate group selects.")}const t=Dr.get("students")||[],n=[...new Set(t.map(i=>i.academicGroup).filter(Boolean))].sort((i,a)=>(i||"").localeCompare(a||"","bn")),s=JSON.stringify(n);if(s!==VE){VE=s;const i=n.map(o=>({value:o,text:o}));[He.membersFilterAcademicGroup,He.cardsFilterAcademicGroup].forEach(o=>{o&&dt.populateSelect(o,i,"  ")})}}function Cm(){if(!He.studentsListContainer)return;const r=Dr.getFilterSection("membersList"),e=kM(r),t=SM(e,r,_M.membersList);if(He.studentsListContainer.dataset.renderSignature===t)return;if(dt.clearContainer(He.studentsListContainer),!e.length){dt.displayEmptyMessage(He.studentsListContainer,"   "),He.studentsListContainer.dataset.renderSignature=t;return}const n=Dr.get("groups")||[],s=new Map(n.map(u=>[u.id,u])),i=IM(n),a=Dr.get("classes")||[],o=new Map(a.map(u=>[u.id,u])),l=Dr.get("sections")||[],c=new Map(l.map(u=>[u.id,u])),A=new Map;e.forEach(u=>{const p=u.groupId||"unassigned";A.has(p)||A.set(p,[]),A.get(p).push(u)});const h=Array.from(A.entries()).sort((u,p)=>{var m,x;if(u[0]==="unassigned")return 1;if(p[0]==="unassigned")return-1;const f=((m=s.get(u[0]))==null?void 0:m.name)||"",g=((x=s.get(p[0]))==null?void 0:x.name)||"";return f.localeCompare(g,"bn")}).map(([u,p])=>{const f=i[u]||i.__default,g=s.get(u),m=(g==null?void 0:g.name)||"  ",x=Bt!=null&&Bt.ensureBengaliText&&typeof Bt.ensureBengaliText=="function"?Bt.ensureBengaliText(m):m,S=Bt!=null&&Bt.convertToBanglaNumber&&typeof Bt.convertToBanglaNumber=="function"?Bt.convertToBanglaNumber(p.length):p.length;p.sort((w,v)=>{const I=w.roll!==void 0&&w.roll!==null?w.roll.toString():"",k=v.roll!==void 0&&v.roll!==null?v.roll.toString():"",_=I.localeCompare(k,void 0,{numeric:!0});return _!==0?_:(w.name||"").localeCompare(v.name||"","bn")});const B=p.map(w=>{var $,V;const v=Bt!=null&&Bt.ensureBengaliText&&typeof Bt.ensureBengaliText=="function"?Bt.ensureBengaliText(w.name||""):w.name||"",k=w.roll!==void 0&&w.roll!==null&&`${w.roll}`.trim()!==""?Bt!=null&&Bt.convertToBanglaNumber&&typeof Bt.convertToBanglaNumber=="function"?Bt.convertToBanglaNumber(w.roll):w.roll:"",_=Bt!=null&&Bt.ensureBengaliText&&typeof Bt.ensureBengaliText=="function"?Bt.ensureBengaliText(w.session||""):w.session||"",T=Bt!=null&&Bt.ensureBengaliText&&typeof Bt.ensureBengaliText=="function"?Bt.ensureBengaliText(w.gender||""):w.gender||"",L=Bt!=null&&Bt.ensureBengaliText&&typeof Bt.ensureBengaliText=="function"?Bt.ensureBengaliText(w.academicGroup||""):w.academicGroup||"",K=(($=o.get(w.classId))==null?void 0:$.name)||"",se=((V=c.get(w.sectionId))==null?void 0:V.name)||"",X=w.contact?`<div class="mt-2 text-xs text-gray-500 dark:text-gray-400">: ${w.contact}</div>`:"";return`
            <article 
              class="card-3d rounded-lg border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-900/70 p-4 hover:shadow-md transition cursor-pointer"
              onclick="window.openStudentModalById && window.openStudentModalById('${w.id}')"
            >
              <div class="flex items-start justify-between gap-3">
                <div>
                  <h5 class="text-base font-semibold text-gray-900 dark:text-white">${v||" "}</h5>
                  <div class="mt-2 flex flex-wrap gap-2">
                    ${CM(w.academicGroup)}
                    ${BM(w.role)}
                  </div>
                </div>
                <span class="text-sm font-semibold text-gray-500 dark:text-gray-400">${k?` ${k}`:""}</span>
              </div>
              <div class="mt-3 space-y-1 text-xs text-gray-600 dark:text-gray-300">
                <p><span class="font-medium text-gray-700 dark:text-gray-200">:</span> ${K||"N/A"}</p>
                <p><span class="font-medium text-gray-700 dark:text-gray-200">:</span> ${se||"N/A"}</p>
                <p><span class="font-medium text-gray-700 dark:text-gray-200">:</span> ${_||"N/A"}</p>
                <p><span class="font-medium text-gray-700 dark:text-gray-200">:</span> ${T||"N/A"}</p>
                <p><span class="font-medium text-gray-700 dark:text-gray-200"> :</span> ${L||"N/A"}</p>
              </div>
              ${X}
              <div class="mt-4 flex justify-end gap-2">
                <button data-id="${w.id}" class="edit-student-btn btn btn-light btn-sm py-1 px-2" aria-label=""><i class="fas fa-edit pointer-events-none"></i></button>
                <button data-id="${w.id}" class="delete-student-btn btn btn-danger btn-sm py-1 px-2" aria-label=""><i class="fas fa-trash pointer-events-none"></i></button>
              </div>
            </article>
          `}).join(""),F=`relative header-3d px-4 py-3 bg-gradient-to-r ${f.headerBg||"from-slate-500 to-slate-600"} text-white flex items-center justify-between`,N=`mb-6 panel-3d rounded-xl overflow-hidden shadow-sm border ${f.panelBorder||"border-gray-200 dark:border-gray-700"}`,E=`p-4 ${f.sectionBg||"bg-gray-50 dark:bg-gray-900/40"}`;return`
        <section class="${N}">
          <header class="${F}">
            <h3 class="text-lg font-semibold">${x}</h3>
            <span class="text-sm font-medium"> : ${S}</span>
          </header>
          <div class="${E}">
            <div class="grid gap-4 md:grid-cols-2 xl:grid-cols-3">
              ${B}
            </div>
          </div>
        </section>
      `}).join("");He.studentsListContainer.innerHTML=h,He.studentsListContainer.dataset.renderSignature=t}function Sm(){if(!He.allStudentsCardsContainer)return;const r=Dr.getFilterSection("studentCards"),e=kM(r),t=SM(e,r,_M.studentCards);if(He.allStudentsCardsContainer.dataset.renderSignature===t)return;if(e.sort((d,h)=>(d.groupId||"").localeCompare(h.groupId||"")||(d.name||"").localeCompare(h.name||"","bn")),dt.clearContainer(He.allStudentsCardsContainer),!e.length){dt.displayEmptyMessage(He.allStudentsCardsContainer,"   "),He.allStudentsCardsContainer.dataset.renderSignature=t;return}const n=Dr.get("groups")||[],s=new Map(n.map(d=>[d.id,d])),i=IM(n),a=Dr.get("classes")||[],o=new Map(a.map(d=>[d.id,d])),l=Dr.get("sections")||[],c=new Map(l.map(d=>[d.id,d])),A=e.map(d=>{var E,w;const h=s.get(d.groupId),u=(h==null?void 0:h.name)||"  ",p=$o(u),f=i[d.groupId]||i.__default,g=$o(d.name||" "),x=d.roll!==void 0&&d.roll!==null&&`${d.roll}`.trim()!==""?Bt!=null&&Bt.convertToBanglaNumber&&typeof Bt.convertToBanglaNumber=="function"?Bt.convertToBanglaNumber(d.roll):String(d.roll):"",S=$o(d.session||"N/A"),B=$o(d.gender||"N/A");$o(d.academicGroup||"N/A");const F=$o(((E=o.get(d.classId))==null?void 0:E.name)||"N/A"),N=$o(((w=c.get(d.sectionId))==null?void 0:w.name)||"N/A");return`
  <article
    class="card-3d relative mx-auto w-full max-w-lg md:max-w-xl rounded-2xl border ${f.panelBorder||"border-gray-200 dark:border-gray-700"} bg-white dark:bg-gray-900/80 hover:shadow-lg transition duration-200 cursor-pointer focus-visible:outline focus-visible:outline-2 focus-visible:outline-indigo-500 focus-visible:outline-offset-2"
    data-student-id="${d.id}"
    role="button"
    tabindex="0"
    aria-label="${g} - "
    onclick="window.openStudentModalById && window.openStudentModalById('${d.id}')"
  >
    <!-- Top gradient bar -->
    <div class="absolute inset-x-0 top-0 h-1.5 bg-gradient-to-r ${f.headerBg||"from-indigo-500 to-blue-500"} rounded-t-2xl"></div>

    <!-- Body (kept compact) -->
    <div class="relative px-2 pt-8 pb-4 flex flex-col items-center gap-2">

      <!-- Roll: top-center -->
      <span
        class="absolute -top-4 left-1/2 -translate-x-1/2 inline-flex h-10 min-w-[72px] px-3 items-center justify-center rounded-xl
               bg-gray-100 text-[13px] font-semibold text-gray-800 dark:bg-gray-800 dark:text-gray-200 shadow-inner
               ring-1 ring-gray-300 dark:ring-gray-700"
      >
        ${x?` ${x}`:"N/A"}
      </span>

      <!-- Name (below roll) -->
      <h4
        class="mt-1 text-base md:text-lg font-semibold leading-snug text-gray-900 dark:text-white
               text-center whitespace-normal break-words hyphens-auto"
        title="${g}"
      >
        ${g}
      </h4>

      <!-- Badges (tight wrap) -->
      <!-- Badges (tight wrap) -->
      <div class="flex flex-col items-center gap-1.5 w-full">
        <div class="flex flex-wrap justify-center gap-1.5 w-full">
          ${CM(d.academicGroup)}
          ${BM(d.role)}
        </div>
        <span class="${r_} ${f.chipBg||"bg-gray-200 text-gray-700 border border-gray-300 dark:bg-gray-800 dark:text-gray-200 dark:border-gray-600"} badge-3d max-w-full whitespace-normal text-center leading-tight justify-center px-3 py-1.5 text-[11px]" title=": ${p}">: ${p}</span>
      </div>

      <!-- Info grid (compact, non-overlapping) -->
      <!-- Info grid (compact, non-overlapping) -->
      <section class="w-full" aria-label="Student details">
        <div class="flex flex-col gap-1 rounded-lg border border-gray-200 dark:border-gray-700 bg-gray-50/70 dark:bg-gray-800/50 px-3 py-2">
           <div class="flex justify-between items-center text-[11px]">
              <span class="text-gray-500 dark:text-gray-400">:</span>
              <span class="font-bold text-gray-700 dark:text-gray-200">${F}</span>
           </div>
           <div class="flex justify-between items-center text-[11px]">
              <span class="text-gray-500 dark:text-gray-400">:</span>
              <span class="font-bold text-gray-700 dark:text-gray-200">${N}</span>
           </div>
           <div class="h-px w-full bg-gray-200 dark:bg-gray-700 my-1"></div>
           <div class="flex justify-between items-center text-[11px]">
              <span class="text-gray-500 dark:text-gray-400">:</span>
              <span class="font-bold text-gray-700 dark:text-gray-200">${S}</span>
           </div>
           <div class="flex justify-between items-center text-[11px]">
              <span class="text-gray-500 dark:text-gray-400">:</span>
              <span class="font-bold text-gray-700 dark:text-gray-200">${B}</span>
           </div>
        </div>
      </section>

    </div>
  </article>
`}).join("");He.allStudentsCardsContainer.innerHTML=`
    <div class="grid items-stretch gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4">
      ${A}
    </div>
  `,He.allStudentsCardsContainer.dataset.renderSignature=t}function kM(r){const e=Dr.get("students")||[],{groupFilter:t,academicFilter:n,searchTerm:s}=r||{},i=O0(s||"");return e.filter(a=>{const o=!t||t==="all"||a.groupId===t,l=!n||n==="all"||a.academicGroup===n,c=!i||O0(a.name).includes(i)||O0(a.roll).includes(i)||O0(a.academicGroup).includes(i);return o&&l&&c})}async function Gie(){var d,h,u,p,f,g,m,x,S,B;if(!(Ua!=null&&Ua.canWrite())){dt.showToast("      ","warning");return}const r=(d=He.studentNameInput)==null?void 0:d.value.trim(),e=(h=He.studentRollInput)==null?void 0:h.value.trim(),t=(u=He.studentGenderInput)==null?void 0:u.value,n=(p=He.studentClassInput)==null?void 0:p.value,s=(f=He.studentSectionInput)==null?void 0:f.value,i=(g=He.studentGroupInput)==null?void 0:g.value,a=(m=He.studentContactInput)==null?void 0:m.value.trim(),o=(x=He.studentAcademicGroupInput)==null?void 0:x.value.trim(),l=(S=He.studentSessionInput)==null?void 0:S.value.trim(),c=(B=He.studentRoleInput)==null?void 0:B.value;if(!r||!e||!t||!n||!s||!o||!l){dt.showToast(", , , , ,     ","warning");return}dt.showLoading("   ...");try{if(await Wa.checkStudentUniqueness(e,o)){dt.showToast("          ","warning"),dt.hideLoading();return}}catch(F){console.error("Uniqueness check failed:",F),dt.showToast(`    : ${F.message}`,"error"),dt.hideLoading();return}const A={name:r,roll:e,gender:t,classId:n,sectionId:s,groupId:i,contact:a,academicGroup:o,session:l,role:c};dt.showLoading("   ...");try{await Wa.addStudent(A),await zl.refreshAllData(),He.studentNameInput&&(He.studentNameInput.value=""),He.studentRollInput&&(He.studentRollInput.value=""),He.studentGroupInput&&(He.studentGroupInput.value=""),He.studentClassInput&&(He.studentClassInput.value=""),He.studentSectionInput&&(He.studentSectionInput.value=""),He.studentContactInput&&(He.studentContactInput.value=""),He.studentAcademicGroupInput&&(He.studentAcademicGroupInput.value=""),He.studentSessionInput&&(He.studentSessionInput.value=""),He.studentRoleInput&&(He.studentRoleInput.value=""),dt.showToast("    ","success")}catch(F){console.error(" Error adding student:",F),dt.showToast(`    : ${F.message}`,"error")}finally{dt.hideLoading()}}function zie(r){if(!(Ua!=null&&Ua.canEdit())){dt.showToast("     ","warning");return}const e=Dr.get("students").find(d=>d.id===r);if(!e){dt.showToast("  ","error");return}const t=Dr.get("groups"),n=Dr.get("classes")||[],s=Dr.get("sections")||[],i=t.map(d=>`<option value="${d.id}" ${d.id===e.groupId?"selected":""}>${Bt.ensureBengaliText(d.name)}</option>`).sort((d,h)=>d.localeCompare(h,"bn")).join(""),a='<option value="">  </option>'+n.map(d=>`<option value="${d.id}" ${d.id===e.classId?"selected":""}>${d.name}</option>`).join(""),l='<option value="">  </option>'+s.filter(d=>d.classId===(e.classId||"")).map(d=>`<option value="${d.id}" ${d.id===e.sectionId?"selected":""}>${d.name}</option>`).join(""),c=[{value:"",text:" "},{value:"team-leader",text:" "},{value:"time-keeper",text:" "},{value:"reporter",text:""},{value:"resource-manager",text:" "},{value:"peace-maker",text:" "}].map(d=>`<option value="${d.value}" ${d.value===e.role?"selected":""}>${d.text}</option>`).join(""),A=`
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div><label class="label">*</label><input id="editStudentName" type="text" value="${e.name||""}" class="form-input" maxlength="100"></div>
            <div><label class="label">*</label><input id="editStudentRoll" type="text" value="${e.roll||""}" class="form-input" maxlength="20"></div>
            <div><label class="label">*</label><select id="editStudentGender" class="form-select"><option value="" ${e.gender===""?"selected":""}></option><option value="" ${e.gender===""?"selected":""}></option></select></div>
            <div><label class="label"></label><select id="editStudentGroup" class="form-select"><option value=""> </option>${i}</select></div>
            <div><label class="label"></label><select id="editStudentClass" class="form-select">${a}</select></div>
            <div><label class="label"></label><select id="editStudentSection" class="form-select">${l}</select></div>
            <div><label class="label"></label><input id="editStudentContact" type="text" value="${e.contact||""}" class="form-input" maxlength="100"></div>
            <div><label class="label"> *</label><input id="editStudentAcademicGroup" type="text" value="${e.academicGroup||""}" class="form-input" maxlength="50"></div>
            <div><label class="label">*</label><input id="editStudentSession" type="text" value="${e.session||""}" class="form-input" maxlength="20"></div>
            <div><label class="label"></label><select id="editStudentRole" class="form-select">${c}</select></div>
        </div>`;dt.showEditModal(" ",A,async()=>{var h,u,p,f,g,m,x,S,B,F;const d={name:(h=document.getElementById("editStudentName"))==null?void 0:h.value.trim(),roll:(u=document.getElementById("editStudentRoll"))==null?void 0:u.value.trim(),gender:(p=document.getElementById("editStudentGender"))==null?void 0:p.value,groupId:(f=document.getElementById("editStudentGroup"))==null?void 0:f.value,classId:(g=document.getElementById("editStudentClass"))==null?void 0:g.value,sectionId:(m=document.getElementById("editStudentSection"))==null?void 0:m.value,contact:(x=document.getElementById("editStudentContact"))==null?void 0:x.value.trim(),academicGroup:(S=document.getElementById("editStudentAcademicGroup"))==null?void 0:S.value.trim(),session:(B=document.getElementById("editStudentSession"))==null?void 0:B.value.trim(),role:(F=document.getElementById("editStudentRole"))==null?void 0:F.value};if(!d.name||!d.roll||!d.gender||!d.academicGroup||!d.session){dt.showToast(", , ,     ","warning");return}if(dt.showLoading("  ..."),d.roll!==e.roll||d.academicGroup!==e.academicGroup)try{if(await Wa.checkStudentUniqueness(d.roll,d.academicGroup,r)){dt.showToast("          ","warning"),dt.hideLoading();return}}catch(N){dt.showToast(`  : ${N.message}`,"error"),dt.hideLoading();return}dt.showLoading("  ...");try{await Wa.updateStudent(r,d),await zl.refreshAllData(),dt.hideModal(dt.elements.editModal),dt.showToast("    ","success")}catch(N){console.error(" Error updating student:",N),dt.showToast(`   : ${N.message}`,"error")}finally{dt.hideLoading()}}),setTimeout(()=>{const d=document.getElementById("editStudentClass"),h=document.getElementById("editStudentSection");d&&h&&d.addEventListener("change",()=>{const u=d.value,p=s.filter(f=>f.classId===u);h.innerHTML='<option value="">  </option>'+p.map(f=>`<option value="${f.id}">${f.name}</option>`).join("")})},100)}function Kie(r){if(!(Ua!=null&&Ua.canDelete())){dt.showToast("     ","warning");return}const e=Dr.get("students").find(n=>n.id===r);if(!e){dt.showToast("  ","error");return}const t=`     "${e.name}" (: ${Bt.convertToBanglaNumber(e.roll)})    ?`;dt.showDeleteModal("  ",t,async()=>{dt.showLoading("  ...");try{await Wa.deleteStudent(r),await zl.refreshAllData(),dt.showToast("    ","success")}catch(n){console.error(" Error deleting student:",n),dt.showToast(`   : ${n.message}`,"error")}finally{dt.hideLoading()}})}function qie(){const r=["","","","",""," ","",""," "," "],e=[" ","","","","A","","2023-24","01xxxxxxxxx"," ","team-leader"],t="#  : team-leader, time-keeper, reporter, resource-manager, peace-maker (  )",n="#   : Class Management        ",s=Papa.unparse([r,e],{header:!1}),o="\uFEFF"+(t+`
`+n+`
`+s),l=new Blob([o],{type:"text/csv;charset=utf-8;"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(l,"student_template.csv");else{const c=URL.createObjectURL(l),A=document.createElement("a");A.href=c,A.download="student_template.csv",A.style.display="none",document.body.appendChild(A),A.click(),setTimeout(()=>{document.body.removeChild(A),URL.revokeObjectURL(c)},250)}dt.showToast("CSV    ","info")}function Wie(){He.csvFileInput.files.length>0?He.csvFileName.textContent=` : ${He.csvFileInput.files[0].name}`:He.csvFileName.textContent=""}function Yie(){var e;if(!(Ua!=null&&Ua.canWrite())){dt.showToast(" CSV import   ","warning");return}const r=(e=He.csvFileInput)==null?void 0:e.files[0];if(!r){dt.showToast("   CSV   ","warning");return}dt.showLoading("CSV    ..."),Papa.parse(r,{header:!0,skipEmptyLines:!0,encoding:"UTF-8",transformHeader:t=>Bt.ensureBengaliText(t).trim(),transform:t=>Bt.ensureBengaliText(t),complete:async t=>{const n=t.data,s=[],i=[];(!n||n.length===0)&&s.push("CSV  ");const o=["","","","",""," ",""].filter(B=>!t.meta.fields.includes(B));if(o.length>0&&s.push(`  : ${o.join(", ")}`),s.length>0){dt.hideLoading(),dt.showToast(s[0],"error",5e3);return}const l=B=>(B||"").normalize("NFC").trim().toLowerCase(),c=new Map(Dr.get("groups").map(B=>[l(B.name),B.id]));let A=Dr.get("classes"),d=new Map(A.map(B=>[l(B.name),B.id]));const h=new Set;for(const B of n){const F=l(B.);F&&!d.has(F)&&h.add(B..trim())}if(h.size>0)if(confirm(`CSV  ${h.size}     :
${[...h].join(", ")}

    ?`)){dt.showLoading("    ...");for(const B of h)await Wa.addDocument("classes",{name:B,createdAt:new Date().toISOString()});A=await Wa.loadClasses(),Dr.update({classes:A}),d=new Map(A.map(B=>[l(B.name),B.id]))}else{dt.hideLoading();return}let u=Dr.get("sections"),p=new Map(u.map(B=>[`${B.classId}_${l(B.name)}`,B.id]));const f=new Map;for(const B of n){const F=l(B.),N=l(B.);if(F&&N){const E=d.get(F);if(E){const w=`${E}_${N}`;p.has(w)||f.set(w,{name:B..trim(),classId:E})}}}if(f.size>0)if(confirm(`CSV  ${f.size}     
    ?`)){dt.showLoading("    ...");for(const B of f.values())await Wa.addDocument("sections",{name:B.name,classId:B.classId,createdAt:new Date().toISOString()});u=await Wa.loadSections(),Dr.update({sections:u}),p=new Map(u.map(B=>[`${B.classId}_${l(B.name)}`,B.id]))}else{dt.hideLoading();return}const g=Dr.get("students");dt.showLoading("    ...");const m=n.map(async(B,F)=>{const N=F+2,E=B.,w=B.,v=B.,I=l(B.),k=l(B.),_=B[" "],T=B.,L=B.||"",K=l(B[" "]),se=(B[" "]||"").toLowerCase();if(!E||!w||!v||!I||!k||!_||!T)return{error:` ${N}:    `};const X=v.normalize("NFC");if(!["","",""].includes(X))return{error:` ${N}:  (${v})  ''  ''  `};const V=d.get(I)||"";if(!V){const de=Array.from(d.keys()).join(", ");return{error:` ${N}: "${B.}"     (: ${de})`}}const he=`${V}_${k}`,z=p.get(he)||"";if(!z){const de=u.filter(ie=>ie.classId===V).map(ie=>ie.name).join(", ");return{error:` ${N}: "${B.}"   "${B.}"    (: ${de})`}}const M=K&&c.get(K)||"";if(K&&!M)return Array.from(c.keys()).slice(0,10).join(", ")+(c.size>10?"...":""),{error:` ${N}: "${B[" "]}"    `};const O=["",""].includes(X)?"":"",H={name:E,roll:w,gender:O,classId:V,sectionId:z,groupId:M,contact:L,academicGroup:_,session:T,role:se},J=g.find(de=>String(de.roll)===String(w)&&l(de.academicGroup)===l(_));return J?{student:{...H,id:J.id},isUpdate:!0}:{student:H,isUpdate:!1}}),x=await Promise.all(m),S=new Set;for(const B of x){if(B.student){const F=`${B.student.roll}|${B.student.academicGroup}`;S.has(F)&&(B.error=` (CSV):  ${B.student.roll} (${B.student.academicGroup})   `,delete B.student),S.add(F)}B.error?s.push(B.error):B.student&&(B.student.isUpdate=B.isUpdate,i.push(B.student))}if(s.length>0){dt.hideLoading();const B=s.slice(0,3).join(`
`)+(s.length>3?`
...`:"");dt.showToast(`CSV  ${Bt.convertToBanglaNumber(s.length)}  :
${B}`,"error",1e4),console.error("CSV Import Errors:",s)}else if(i.length>0){const B=i.filter(N=>!N.isUpdate),F=i.filter(N=>N.isUpdate);dt.showLoading(`: ${Bt.convertToBanglaNumber(B.length)} , ${Bt.convertToBanglaNumber(F.length)} ...`);try{for(const N of B){const{isUpdate:E,...w}=N;await Wa.addStudent(w)}for(const N of F){const{isUpdate:E,id:w,...v}=N;await Wa.updateStudent(w,v)}await zl.refreshAllData(),dt.showToast(`! ${Bt.convertToBanglaNumber(B.length)} , ${Bt.convertToBanglaNumber(F.length)} `,"success")}catch(N){dt.showToast(`   : ${N.message}`,"error")}finally{dt.hideLoading()}}else dt.hideLoading(),dt.showToast("CSV     ","info");He.csvFileInput&&(He.csvFileInput.value=""),He.csvFileName&&(He.csvFileName.textContent="")},error:t=>{dt.hideLoading(),dt.showToast(`CSV    : ${t.message}`,"error")}})}async function Xie(){if(!He.studentClassInput)return;const e=(Dr.get("classes")||[]).map(t=>({value:t.id,text:Bt.ensureBengaliText(t.name)})).sort((t,n)=>t.text.localeCompare(n.text,"bn"));dt.populateSelect(He.studentClassInput,e," ")}async function EM(r=null){if(!He.studentSectionInput)return;let e=Dr.get("sections")||[];r&&(e=e.filter(n=>n.classId===r));const t=e.map(n=>({value:n.id,text:Bt.ensureBengaliText(n.name)})).sort((n,s)=>n.text.localeCompare(s.text,"bn"));He.studentSectionInput.value="",e.length===0&&r?dt.populateSelect(He.studentSectionInput,[],"    "):dt.populateSelect(He.studentSectionInput,t," ")}function IM(r){const e=[{panelBorder:"border-blue-300 dark:border-blue-700",sectionBg:"bg-blue-50/80 dark:bg-blue-900/15",headerBg:"from-blue-500 to-indigo-500",chipBg:"bg-blue-100 text-blue-700 border-blue-200 dark:bg-blue-900/40 dark:text-blue-100 dark:border-blue-800"},{panelBorder:"border-emerald-300 dark:border-emerald-700",sectionBg:"bg-emerald-50/80 dark:bg-emerald-900/15",headerBg:"from-emerald-500 to-teal-500",chipBg:"bg-emerald-100 text-emerald-700 border-emerald-200 dark:bg-emerald-900/40 dark:text-emerald-100 dark:border-emerald-800"},{panelBorder:"border-amber-300 dark:border-amber-700",sectionBg:"bg-amber-50/80 dark:bg-amber-900/20",headerBg:"from-amber-500 to-orange-500",chipBg:"bg-amber-100 text-amber-700 border-amber-200 dark:bg-amber-900/40 dark:text-amber-100 dark:border-amber-800"},{panelBorder:"border-purple-300 dark:border-purple-700",sectionBg:"bg-purple-50/80 dark:bg-purple-900/15",headerBg:"from-violet-500 to-purple-600",chipBg:"bg-purple-100 text-purple-700 border-purple-200 dark:bg-purple-900/40 dark:text-purple-100 dark:border-purple-800"},{panelBorder:"border-rose-300 dark:border-rose-700",sectionBg:"bg-rose-50/80 dark:bg-rose-900/15",headerBg:"from-rose-500 to-pink-500",chipBg:"bg-rose-100 text-rose-700 border-rose-200 dark:bg-rose-900/40 dark:text-rose-100 dark:border-rose-800"},{panelBorder:"border-sky-300 dark:border-sky-700",sectionBg:"bg-sky-50/80 dark:bg-sky-900/15",headerBg:"from-sky-500 to-cyan-500",chipBg:"bg-sky-100 text-sky-700 border-sky-200 dark:bg-sky-900/40 dark:text-sky-100 dark:border-sky-800"},{panelBorder:"border-indigo-300 dark:border-indigo-700",sectionBg:"bg-indigo-50/80 dark:bg-indigo-900/15",headerBg:"from-indigo-500 to-blue-600",chipBg:"bg-indigo-100 text-indigo-700 border-indigo-200 dark:bg-indigo-900/40 dark:text-indigo-100 dark:border-indigo-800"},{panelBorder:"border-lime-300 dark:border-lime-700",sectionBg:"bg-lime-50/80 dark:bg-lime-900/15",headerBg:"from-lime-500 to-green-500",chipBg:"bg-lime-100 text-lime-700 border-lime-200 dark:bg-lime-900/40 dark:text-lime-100 dark:border-lime-800"}],n={__default:{panelBorder:"border-gray-200 dark:border-gray-700",sectionBg:"bg-gray-50 dark:bg-gray-900/40",headerBg:"from-slate-500 to-slate-600",chipBg:"bg-gray-200 text-gray-700 border-gray-300 dark:bg-gray-800 dark:text-gray-200 dark:border-gray-600"}};return(r||[]).forEach((s,i)=>{n[s.id]=e[i%e.length]}),n}let Vr,Pt,Jo,ia,cp,il;const nt={},gd={task:20,team:15,Progress:25,mcq:40},TM=100,Vd="11:55",Jie=["scheduledTime","scheduleTime","assignmentTime","assignmentClock","time","startTime","timeSlot","meetingTime"],FM=[{value:"upcoming",label:" "},{value:"ongoing",label:" "},{value:"completed",label:" "}],$E={upcoming:{label:"",badge:"bg-sky-100 text-sky-700 dark:bg-sky-900/40 dark:text-sky-200"},ongoing:{label:"",badge:"bg-amber-100 text-amber-700 dark:bg-amber-900/40 dark:text-amber-200"},completed:{label:"",badge:"bg-emerald-100 text-emerald-700 dark:bg-emerald-900/40 dark:text-emerald-200"}},Ga=["bg-red-100 text-red-800 border-red-200 dark:bg-red-900 dark:text-white dark:border-red-700","bg-orange-100 text-orange-800 border-orange-200 dark:bg-orange-900 dark:text-white dark:border-orange-700","bg-yellow-100 text-yellow-800 border-yellow-200 dark:bg-yellow-900 dark:text-white dark:border-yellow-700","bg-green-100 text-green-800 border-green-200 dark:bg-green-900 dark:text-white dark:border-green-700","bg-teal-100 text-teal-800 border-teal-200 dark:bg-teal-900 dark:text-white dark:border-teal-700","bg-blue-100 text-blue-800 border-blue-200 dark:bg-blue-900 dark:text-white dark:border-blue-700","bg-indigo-100 text-indigo-800 border-indigo-200 dark:bg-indigo-900 dark:text-white dark:border-indigo-700","bg-purple-100 text-purple-800 border-purple-200 dark:bg-purple-900 dark:text-white dark:border-purple-700","bg-pink-100 text-pink-800 border-pink-200 dark:bg-pink-900 dark:text-white dark:border-pink-700","bg-gray-100 text-gray-800 border-gray-200 dark:bg-gray-700 dark:text-white dark:border-gray-600"],gv=["bg-blue-100 text-blue-800 border-blue-200 dark:bg-blue-900 dark:text-white dark:border-blue-700","bg-indigo-100 text-indigo-800 border-indigo-200 dark:bg-indigo-900 dark:text-white dark:border-indigo-700","bg-violet-100 text-violet-800 border-violet-200 dark:bg-violet-900 dark:text-white dark:border-violet-700","bg-purple-100 text-purple-800 border-purple-200 dark:bg-purple-900 dark:text-white dark:border-purple-700","bg-fuchsia-100 text-fuchsia-800 border-fuchsia-200 dark:bg-fuchsia-900 dark:text-white dark:border-fuchsia-700","bg-pink-100 text-pink-800 border-pink-200 dark:bg-pink-900 dark:text-white dark:border-pink-700","bg-rose-100 text-rose-800 border-rose-200 dark:bg-rose-900 dark:text-white dark:border-rose-700","bg-orange-100 text-orange-800 border-orange-200 dark:bg-orange-900 dark:text-white dark:border-orange-700","bg-amber-100 text-amber-800 border-amber-200 dark:bg-amber-900 dark:text-white dark:border-amber-700","bg-lime-100 text-lime-800 border-lime-200 dark:bg-lime-900 dark:text-white dark:border-lime-700","bg-emerald-100 text-emerald-800 border-emerald-200 dark:bg-emerald-900 dark:text-white dark:border-emerald-700","bg-teal-100 text-teal-800 border-teal-200 dark:bg-teal-900 dark:text-white dark:border-teal-700","bg-cyan-100 text-cyan-800 border-cyan-200 dark:bg-cyan-900 dark:text-white dark:border-cyan-700","bg-sky-100 text-sky-800 border-sky-200 dark:bg-sky-900 dark:text-white dark:border-sky-700"];function Zie(r){if(!r)return Ga[0];const e=r.trim().toLowerCase();if(e.includes("")||e.includes("bangla"))return Ga[0];if(e.includes("")||e.includes("english"))return Ga[5];if(e.includes("")||e.includes("math"))return Ga[1];if(e.includes("")||e.includes("ict")||e.includes(""))return Ga[4];if(e.includes("")||e.includes("science"))return Ga[3];if(e.includes("")||e.includes("religion")||e.includes(""))return Ga[7];if(e.includes("")||e.includes("physics"))return Ga[8];if(e.includes("")||e.includes("chemistry"))return Ga[2];if(e.includes("")||e.includes("biology"))return Ga[6];let t=0;for(let n=0;n<r.length;n++)t=r.charCodeAt(n)+((t<<5)-t);return Ga[Math.abs(t)%Ga.length]}function eae(r){if(!r)return gv[0];let e=0;for(let t=0;t<r.length;t++)e=r.charCodeAt(t)+((e<<5)-e);return gv[Math.abs(e)%gv.length]}const LM=FM.map(r=>r.value);function tae(r){return Vr=r.managers.stateManager,Pt=r.managers.uiManager,Jo=r.services.dataService,il=r.utils.permissionHelper,ia=r.utils,cp=r.app,nae(),aae(),console.log(" Tasks component initialized."),{render:rae,populateTaskSelects:gae}}function rae(){if(!nt.page)return;sae();const r=Vr.get("tasks"),e=Vr.get("currentUserData");let t=r;if(e&&e.type==="teacher"){const n=Vr.get("currentTeacher"),s=(n==null?void 0:n.assignedSubjects)||[],i=Vr.get("subjects")||[],a=new Set(i.filter(o=>s.includes(o.id)).map(o=>{var l;return(l=o.name)==null?void 0:l.trim()}));t=r.filter(o=>{if(!o.subjectId)return!1;if(s.includes(o.subjectId))return!0;const l=i.find(c=>c.id===o.subjectId);return!!(l&&l.name&&a.has(l.name.trim()))})}cae(t),NM(gd,"")}function nae(){if(nt.page=document.getElementById("page-tasks"),!nt.page){console.error(" Tasks page element (#page-tasks) not found!");return}nt.taskNameInput=nt.page.querySelector("#taskNameInput"),nt.taskClassInput=nt.page.querySelector("#taskClassInput"),nt.taskSectionInput=nt.page.querySelector("#taskSectionInput"),nt.taskSubjectInput=nt.page.querySelector("#taskSubjectInput"),nt.maxTaskScoreInput=nt.page.querySelector("#maxTaskScoreInput"),nt.maxTeamScoreInput=nt.page.querySelector("#maxTeamScoreInput"),nt.maxProgressScoreInput=nt.page.querySelector("#maxProgressScoreInput"),nt.maxMcqScoreInput=nt.page.querySelector("#maxMcqScoreInput"),nt.totalMaxScoreDisplay=nt.page.querySelector("#totalMaxScoreDisplay"),nt.taskDescriptionInput=nt.page.querySelector("#taskDescriptionInput"),nt.taskDateInput=nt.page.querySelector("#taskDateInput"),nt.taskTimeInput=nt.page.querySelector("#taskTimeInput"),nt.taskStatusInput=nt.page.querySelector("#taskStatusInput"),nt.addTaskBtn=nt.page.querySelector("#addTaskBtn"),nt.tasksListContainer=nt.page.querySelector("#tasksList"),(!nt.maxTaskScoreInput||!nt.totalMaxScoreDisplay)&&console.warn("Tasks: One or more score breakdown elements are missing in the HTML."),nt.taskStatusInput&&!nt.taskStatusInput.value&&(nt.taskStatusInput.value="upcoming"),nt.taskTimeInput&&!nt.taskTimeInput.value&&(nt.taskTimeInput.value=Vd)}function sae(){const r=Vr.get("classes")||[],e=Vr.get("sections")||[],t=Vr.get("subjects")||[],n=Vr.get("currentUserData"),s=Array.from(new Map(e.map(c=>{var A;return[(A=c.name)==null?void 0:A.trim(),c]})).values()),i=Array.from(new Map(t.map(c=>{var A;return[(A=c.name)==null?void 0:A.trim(),c]})).values());let a=r,o=s,l=i;if(n&&n.type==="teacher"){const c=Vr.get("currentTeacher"),A=(c==null?void 0:c.assignedClasses)||[],d=(c==null?void 0:c.assignedSections)||[],h=(c==null?void 0:c.assignedSubjects)||[],u=new Set(s.filter(f=>d.includes(f.id)).map(f=>{var g;return(g=f.name)==null?void 0:g.trim()})),p=new Set(i.filter(f=>h.includes(f.id)).map(f=>{var g;return(g=f.name)==null?void 0:g.trim()}));if(A.length>0&&(a=r.filter(f=>A.includes(f.id))),d.length>0&&(o=s.filter(f=>d.includes(f.id)||f.name&&u.has(f.name.trim()))),h.length>0){l=i.filter(g=>h.includes(g.id)||g.name&&p.has(g.name.trim()));const f=new Map;l.forEach(g=>{var x;const m=(x=g.name)==null?void 0:x.trim();if(m)if(f.has(m)){const S=f.get(m);!h.includes(S.id)&&h.includes(g.id)&&f.set(m,g)}else f.set(m,g)}),l=Array.from(f.values())}}nt.taskClassInput&&Pt.populateSelect(nt.taskClassInput,a.map(c=>({value:c.id,text:c.name})),"  "),UM(o,l)}function UM(r,e){nt.taskSectionInput&&Pt.populateSelect(nt.taskSectionInput,r.map(t=>({value:t.id,text:t.name})),"  "),nt.taskSubjectInput&&Pt.populateSelect(nt.taskSubjectInput,e.map(t=>({value:t.id,text:t.name})),"  ")}function iae(r){var c,A;const e=Vr.get("sections")||[],t=Vr.get("subjects")||[],n=Vr.get("currentUserData");let s=e,i=t;if(r){const d=Vr.get("classes")||[],h=d.find(p=>p.id===r),u=(c=h==null?void 0:h.name)==null?void 0:c.trim();if(u){const p=d.filter(f=>{var g;return((g=f.name)==null?void 0:g.trim())===u}).map(f=>f.id);s=s.filter(f=>p.includes(f.classId))}else s=s.filter(p=>p.classId===r)}if(n&&n.type==="teacher"){const d=Vr.get("currentTeacher"),h=(d==null?void 0:d.assignedSections)||[],u=(d==null?void 0:d.assignedSubjects)||[],p=new Set(e.filter(g=>h.includes(g.id)).map(g=>{var m;return(m=g.name)==null?void 0:m.trim()})),f=new Set(t.filter(g=>u.includes(g.id)).map(g=>{var m;return(m=g.name)==null?void 0:m.trim()}));h.length>0&&(s=s.filter(g=>{const m=h.includes(g.id),x=g.name&&p.has(g.name.trim());return m||x})),u.length>0&&(i=i.filter(g=>{const m=u.includes(g.id),x=g.name&&f.has(g.name.trim());return m||x}))}const a=n&&n.type==="teacher"?((A=Vr.get("currentTeacher"))==null?void 0:A.assignedSubjects)||[]:[],o=new Map;s.forEach(d=>{var h;return o.set((h=d.name)==null?void 0:h.trim(),d)}),s=Array.from(o.values());const l=new Map;i.forEach(d=>{var u;const h=(u=d.name)==null?void 0:u.trim();if(h)if(l.has(h)){const p=l.get(h);a.length>0&&!a.includes(p.id)&&a.includes(d.id)&&l.set(h,d)}else l.set(h,d)}),i=Array.from(l.values()),UM(s,i)}function aae(){if(!nt.page)return;Pt.addListener(nt.addTaskBtn,"click",Aae),nt.taskClassInput&&Pt.addListener(nt.taskClassInput,"change",()=>{const e=nt.taskClassInput.value;iae(e)}),[nt.maxTaskScoreInput,nt.maxTeamScoreInput,nt.maxProgressScoreInput,nt.maxMcqScoreInput].forEach(e=>{Pt.addListener(e,"input",()=>_b(""))}),Pt.addListener(nt.tasksListContainer,"click",e=>{const t=e.target.closest(".edit-task-btn"),n=e.target.closest(".delete-task-btn");t?uae(t.dataset.id):n&&hae(n.dataset.id)}),Pt.addListener(nt.tasksListContainer,"change",e=>{const t=e.target.closest(".task-status-select");t&&(e.stopPropagation(),fae(t))})}function Lg(r){if(!r)return"";try{if(typeof r=="string")return r.split("T")[0];if(r instanceof Date)return r.toISOString().split("T")[0];if(typeof r.toDate=="function")return r.toDate().toISOString().split("T")[0]}catch(e){console.warn("Unsupported date type for comparison:",r,e)}return""}function vy(r){const e=oae(r);if(!e)return null;const t=String(e.hour).padStart(2,"0"),n=String(e.minute).padStart(2,"0");return`${t}:${n}`}function oae(r){if(r==null)return null;const e=String(r).trim();if(!e)return null;const t=e.toLowerCase(),n=t.match(/(\d{1,2})(?::(\d{1,2}))?\s*(am|pm|a\.m\.|p\.m\.)?/);if(!n){if(/^\d{3,4}$/.test(t)){const o=t.padStart(4,"0"),l=parseInt(o.slice(0,2),10),c=parseInt(o.slice(2),10);if(!Number.isNaN(l)&&!Number.isNaN(c))return{hour:Math.min(Math.max(l,0),23),minute:Math.min(Math.max(c,0),59)}}return null}let s=parseInt(n[1],10),i=n[2]?parseInt(n[2],10):0;if(Number.isNaN(s)||Number.isNaN(i))return null;const a=n[3];if(a){const o=a.includes("p"),l=a.includes("a");o&&s<12&&(s+=12),l&&s===12&&(s=0)}return s=Math.min(Math.max(s,0),23),i=Math.min(Math.max(i,0),59),{hour:s,minute:i}}function MM(r,e){const t=Lg(r);if(!t)return"";const n=vy(e)||Vd;try{const s=new Date(`${t}T${n}:00`);if(!Number.isNaN(s.getTime()))return s.toISOString()}catch{}return r||""}function lae(r){if(!r)return Vd;for(const t of Jie){if(!Object.prototype.hasOwnProperty.call(r,t))continue;const n=vy(r[t]);if(n)return n}const e=DM(r.date);if(e&&!Number.isNaN(e.getTime())){const t=e.getHours(),n=e.getMinutes();if(t||n)return`${String(t).padStart(2,"0")}:${String(n).padStart(2,"0")}`}return Vd}function _b(r=""){var o,l,c,A;const e=parseFloat((o=document.getElementById(`${r}maxTaskScoreInput`))==null?void 0:o.value)||0,t=parseFloat((l=document.getElementById(`${r}maxTeamScoreInput`))==null?void 0:l.value)||0,n=parseFloat((c=document.getElementById(`${r}maxProgressScoreInput`))==null?void 0:c.value)||0,s=parseFloat((A=document.getElementById(`${r}maxMcqScoreInput`))==null?void 0:A.value)||0,i=e+t+n+s,a=document.getElementById(`${r}totalMaxScoreDisplay`);return a&&(a.textContent=ia.convertToBanglaNumber(i)),i}function NM(r,e=""){const t=document.getElementById(`${e}maxTaskScoreInput`),n=document.getElementById(`${e}maxTeamScoreInput`),s=document.getElementById(`${e}maxProgressScoreInput`),i=document.getElementById(`${e}maxMcqScoreInput`);t&&(t.value=(r==null?void 0:r.task)??gd.task),n&&(n.value=(r==null?void 0:r.team)??gd.team),s&&(s.value=(r==null?void 0:r.Progress)??gd.Progress),i&&(i.value=(r==null?void 0:r.mcq)??gd.mcq),_b(e)}function cae(r){if(!nt.tasksListContainer)return;if(Pt.clearContainer(nt.tasksListContainer),!r||r.length===0){Pt.displayEmptyMessage(nt.tasksListContainer,"   ");return}const e=[...r].sort((a,o)=>{const l=Lg(a.date);return Lg(o.date).localeCompare(l)}),t=Vr.get("classes")||[],n=Vr.get("sections")||[],s=Vr.get("subjects")||[],i=e.map(a=>{var F,N,E;const o=ia.formatTimestamp(a.date)||" ",l=a.maxScoreBreakdown?(parseFloat(a.maxScoreBreakdown.task)||0)+(parseFloat(a.maxScoreBreakdown.team)||0)+(parseFloat(a.maxScoreBreakdown.Progress)||0)+(parseFloat(a.maxScoreBreakdown.mcq)||0):parseFloat(a.maxScore)||TM,c=ia.convertToBanglaNumber(l),A=a.description?`<p class="text-sm text-gray-600 dark:text-gray-400 mt-1">${ia.truncateText(a.description,100)}</p>`:"",d=a.maxScoreBreakdown||{},h=`: -${ia.convertToBanglaNumber(d.task??"N/A")}, -${ia.convertToBanglaNumber(d.team??"N/A")}, -${ia.convertToBanglaNumber(d.Progress??"N/A")}, MCQ-${ia.convertToBanglaNumber(d.mcq??"N/A")}`,u=PM(a),p=$E[u]||$E.upcoming,f=`<span class="inline-flex items-center gap-1 rounded-full px-2.5 py-0.5 text-xs font-semibold ${p.badge}">
        <i class="fas fa-circle text-[6px]"></i>${p.label}
      </span>`,g=a.classId?((F=t.find(w=>w.id===a.classId))==null?void 0:F.name)||"":"-",m=a.sectionId?((N=n.find(w=>w.id===a.sectionId))==null?void 0:N.name)||"":"-",x=a.subjectId?((E=s.find(w=>w.id===a.subjectId))==null?void 0:E.name)||"":"-",S=Zie(x),B=eae(g);return`
        <div class="card p-4 space-y-3">
          <div class="flex flex-col lg:flex-row lg:items-start lg:justify-between gap-4">
            <div class="flex-grow" title="${h}">
              <div class="flex items-center gap-2 flex-wrap">
                <h4 class="text-lg font-semibold text-gray-900 dark:text-white">${ia.ensureBengaliText(a.name)}</h4>
                ${f}
              </div>
              <p class="text-sm text-gray-500 dark:text-gray-400 mt-1">
                <i class="far fa-calendar-alt mr-1"></i>: ${o} | <i class="fas fa-star mr-1"></i>: ${c}
              </p>
              <div class="flex flex-wrap gap-2 mt-2">
                <span class="inline-flex items-center gap-1 px-2.5 py-0.5 rounded-md text-xs font-semibold border ${B}">
                  <i class="fas fa-graduation-cap"></i> ${g}
                </span>
                <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-300">
                  <i class="fas fa-layer-group"></i> ${m}
                </span>
                <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium ${S}">
                  <i class="fas fa-book"></i> ${x}
                </span>
              </div>
              ${A}
            </div>
            <div class="flex flex-col sm:flex-row lg:flex-col items-stretch sm:items-end gap-2">
              <label class="text-xs font-semibold text-gray-500 dark:text-gray-400"> </label>
              <select
                class="task-status-select form-input text-sm font-medium"
                data-id="${a.id}"
                data-current-status="${u}"
                aria-label="  "
              >
                ${RM(u)}
              </select>
              <div class="flex space-x-2 justify-end">
                <button data-id="${a.id}" class="edit-task-btn btn btn-light btn-sm py-1 px-2" aria-label="">
                  <i class="fas fa-edit pointer-events-none"></i>
                </button>
                <button data-id="${a.id}" class="delete-task-btn btn btn-danger btn-sm py-1 px-2" aria-label="">
                  <i class="fas fa-trash pointer-events-none"></i>
                </button>
              </div>
            </div>
          </div>
        </div>`}).join("");nt.tasksListContainer.innerHTML=i}async function Aae(){var p,f,g,m,x,S,B,F,N,E,w,v;if(!(il!=null&&il.canWrite())){Pt.showToast("      ","warning");return}const r=(p=nt.taskNameInput)==null?void 0:p.value.trim(),e=(f=nt.taskClassInput)==null?void 0:f.value,t=(g=nt.taskSectionInput)==null?void 0:g.value,n=(m=nt.taskSubjectInput)==null?void 0:m.value,s=(x=nt.taskDescriptionInput)==null?void 0:x.value.trim(),i=(S=nt.taskDateInput)==null?void 0:S.value,a=(B=nt.taskTimeInput)==null?void 0:B.value,o=vy(a)||Vd,l=MM(i,o),A=Bb((F=nt.taskStatusInput)==null?void 0:F.value)||s_(l),d={task:parseFloat((N=nt.maxTaskScoreInput)==null?void 0:N.value)||0,team:parseFloat((E=nt.maxTeamScoreInput)==null?void 0:E.value)||0,Progress:parseFloat((w=nt.maxProgressScoreInput)==null?void 0:w.value)||0,mcq:parseFloat((v=nt.maxMcqScoreInput)==null?void 0:v.value)||0},h=d.task+d.team+d.Progress+d.mcq;if(!r){Pt.showToast("  ","warning");return}if(!n){Pt.showToast("  ","warning");return}if(h<=0||Object.values(d).some(I=>I<0)){Pt.showToast("                ","warning");return}if(!i){Pt.showToast("   ","warning");return}Pt.showLoading("   ...");try{if(await Jo.checkTaskNameExists(name)){Pt.showToast("     ","warning"),Pt.hideLoading();return}}catch(I){Pt.showToast(`   : ${I.message}`,"error"),Pt.hideLoading();return}const u={name:r,classId:e,sectionId:t,subjectId:n,description:s,date:l||i,scheduledTime:o,maxScore:h,maxScoreBreakdown:d,status:A,nameLower:name.toLowerCase()};Pt.showLoading("   ...");try{await Jo.addTask(u),await cp.refreshAllData(),nt.taskNameInput&&(nt.taskNameInput.value=""),nt.taskClassInput&&(nt.taskClassInput.value=""),nt.taskSectionInput&&(nt.taskSectionInput.value=""),nt.taskSubjectInput&&(nt.taskSubjectInput.value=""),NM(gd,""),nt.taskDescriptionInput&&(nt.taskDescriptionInput.value=""),nt.taskDateInput&&(nt.taskDateInput.value=""),nt.taskTimeInput&&(nt.taskTimeInput.value=Vd),nt.taskStatusInput&&(nt.taskStatusInput.value="upcoming"),Pt.showToast("    ","success")}catch(I){Pt.showToast(`   : ${I.message}`,"error")}finally{Pt.hideLoading()}}function PM(r){return dae(r==null?void 0:r.status,r==null?void 0:r.date)}function dae(r,e){return LM.includes(r)?r:s_(e)}function Bb(r){return LM.includes(r)?r:null}function s_(r){const e=DM(r);if(!e)return"upcoming";const t=new Date,n=new Date(e.getFullYear(),e.getMonth(),e.getDate()),s=new Date(t.getFullYear(),t.getMonth(),t.getDate());return n.getTime()===s.getTime()?"ongoing":n>s?"upcoming":"completed"}function DM(r){if(!r)return null;try{return typeof r.toDate=="function"?r.toDate():typeof r=="number"?new Date(r):new Date(r)}catch{return null}}function RM(r){return FM.map(e=>`<option value="${e.value}" ${e.value===r?"selected":""}>${e.label}</option>`).join("")}function uae(r){var c,A,d;if(!(il!=null&&il.canEdit())){Pt.showToast("     ","warning");return}const e=Vr.get("tasks").find(h=>h.id===r);if(!e){Pt.showToast("  ","error");return}const t=e.maxScoreBreakdown||gd,n=e.maxScoreBreakdown?(parseFloat(t.task)||0)+(parseFloat(t.team)||0)+(parseFloat(t.Progress)||0)+(parseFloat(t.mcq)||0):e.maxScore||TM,s=Lg(e.date)||"",i=lae(e),a=PM(e),o=`
        <div class="space-y-4">
            <div><label for="editTaskName" class="label"> *</label><input id="editTaskName" type="text" value="${e.name||""}" class="form-input" maxlength="100"></div>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                <div><label class="label"></label><select id="editTaskClass" class="form-select"></select></div>
                <div><label class="label"></label><select id="editTaskSection" class="form-select"></select></div>
                <div><label class="label"></label><select id="editTaskSubject" class="form-select"></select></div>
            </div>

            <fieldset class="border p-3 rounded dark:border-gray-600">
                 <legend class="text-sm font-medium px-1">  *</legend>
                 <div class="grid grid-cols-2 gap-3 mt-2">
                    <div><label for="editmaxTaskScoreInput" class="label text-xs"></label><input id="editmaxTaskScoreInput" type="number" min="0" step="any" value="${t.task??0}" class="form-input breakdown-input"></div>
                    <div><label for="editmaxTeamScoreInput" class="label text-xs"></label><input id="editmaxTeamScoreInput" type="number" min="0" step="any" value="${t.team??0}" class="form-input breakdown-input"></div>
                    <div><label for="editmaxProgressScoreInput" class="label text-xs"></label><input id="editmaxProgressScoreInput" type="number" min="0" step="any" value="${t.Progress??0}" class="form-input breakdown-input"></div>
                    <div><label for="editmaxMcqScoreInput" class="label text-xs">MCQ</label><input id="editmaxMcqScoreInput" type="number" min="0" step="any" value="${t.mcq??0}" class="form-input breakdown-input"></div>
                 </div>
                 <p class="text-sm mt-3 text-gray-600 dark:text-gray-400">  : <strong id="edittotalMaxScoreDisplay">${ia.convertToBanglaNumber(n)}</strong></p>
            </fieldset>
            <div><label for="editTaskDescription" class="label"></label><textarea id="editTaskDescription" class="form-input" rows="3">${e.description||""}</textarea></div>
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
              <div><label for="editTaskDate" class="label">?????*</label><input id="editTaskDate" type="date" value="${s}" class="form-input"></div>
              <div><label for="editTaskTime" class="label">???????? ()</label><input id="editTaskTime" type="time" value="${i}" class="form-input"></div>
            </div>
            <div><label for="editTaskStatus" class="label"></label><select id="editTaskStatus" class="form-input">
              ${RM(a)}
            </select></div>
        </div>`;Pt.showEditModal(" ",o,async()=>{var v,I,k,_,T,L,K,se,X,$,V,he;const h=(v=document.getElementById("editTaskName"))==null?void 0:v.value.trim(),u=(I=document.getElementById("editTaskClass"))==null?void 0:I.value,p=(k=document.getElementById("editTaskSection"))==null?void 0:k.value,f=(_=document.getElementById("editTaskSubject"))==null?void 0:_.value,g=(T=document.getElementById("editTaskDescription"))==null?void 0:T.value.trim(),m=(L=document.getElementById("editTaskDate"))==null?void 0:L.value,x=(K=document.getElementById("editTaskTime"))==null?void 0:K.value,S=vy(x)||Vd,B=MM(m,S),F=Bb((se=document.getElementById("editTaskStatus"))==null?void 0:se.value)||s_(B),N={task:parseFloat((X=document.getElementById("editmaxTaskScoreInput"))==null?void 0:X.value)||0,team:parseFloat(($=document.getElementById("editmaxTeamScoreInput"))==null?void 0:$.value)||0,Progress:parseFloat((V=document.getElementById("editmaxProgressScoreInput"))==null?void 0:V.value)||0,mcq:parseFloat((he=document.getElementById("editmaxMcqScoreInput"))==null?void 0:he.value)||0},E=N.task+N.team+N.Progress+N.mcq;if(!h||E<=0||!m||Object.values(N).some(z=>z<0)){Pt.showToast(",    (>=0)      ","warning");return}Pt.showLoading("  ...");try{if(await Jo.checkTaskNameExists(h,r)){Pt.showToast("    ","warning"),Pt.hideLoading();return}}catch(z){Pt.showToast(`   : ${z.message}`,"error"),Pt.hideLoading();return}const w={name:h,classId:u,sectionId:p,subjectId:f,description:g,date:B||m,scheduledTime:S,maxScore:E,maxScoreBreakdown:N,status:F,nameLower:h.toLowerCase()};Pt.showLoading(" ...");try{await Jo.updateTask(r,w),await cp.refreshAllData(),Pt.hideModal(Pt.elements.editModal),Pt.showToast("  ","success")}catch(z){Pt.showToast(` : ${z.message}`,"error")}finally{Pt.hideLoading()}});const l=Pt.elements.editModalContent;if(l){l.querySelectorAll(".breakdown-input").forEach(E=>{E.oninput=()=>_b("edit")}),_b("edit");const h=Vr.get("classes")||[],u=Vr.get("sections")||[],p=Vr.get("subjects")||[],f=Vr.get("currentUserData"),g=new Map(u.map(E=>{var w;return[(w=E.name)==null?void 0:w.trim(),E]}));if(e.sectionId){const E=u.find(w=>w.id===e.sectionId);E&&E.name&&g.set(E.name.trim(),E)}const m=Array.from(g.values()),x=new Map(p.map(E=>{var w;return[(w=E.name)==null?void 0:w.trim(),E]}));if(e.subjectId){const E=p.find(w=>w.id===e.subjectId);E&&E.name&&x.set(E.name.trim(),E)}const S=Array.from(x.values());let B=h,F=m,N=S;f&&f.type==="teacher"&&((c=f.assignedClasses)!=null&&c.length&&(B=h.filter(E=>f.assignedClasses.includes(E.id))),(A=f.assignedSections)!=null&&A.length&&(F=m.filter(E=>f.assignedSections.includes(E.id))),(d=f.assignedSubjects)!=null&&d.length&&(N=S.filter(E=>f.assignedSubjects.includes(E.id)))),Pt.populateSelect(document.getElementById("editTaskClass"),B.map(E=>({value:E.id,text:E.name})),"  "),Pt.populateSelect(document.getElementById("editTaskSection"),F.map(E=>({value:E.id,text:E.name})),"  "),Pt.populateSelect(document.getElementById("editTaskSubject"),N.map(E=>({value:E.id,text:E.name})),"  "),e.classId&&(document.getElementById("editTaskClass").value=e.classId),e.sectionId&&(document.getElementById("editTaskSection").value=e.sectionId),e.subjectId&&(document.getElementById("editTaskSubject").value=e.subjectId),document.getElementById("editTaskClass").addEventListener("change",E=>{var K;const w=E.target.value,v=Vr.get("sections")||[],I=Vr.get("subjects")||[];let k=v;if(w){const se=Vr.get("classes")||[],X=se.find(V=>V.id===w),$=(K=X==null?void 0:X.name)==null?void 0:K.trim();if($){const V=se.filter(he=>{var z;return((z=he.name)==null?void 0:z.trim())===$}).map(he=>he.id);k=k.filter(he=>V.includes(he.classId))}else k=k.filter(V=>V.classId===w)}const _=Array.from(new Map(k.map(se=>{var X;return[(X=se.name)==null?void 0:X.trim(),se]})).values());Pt.populateSelect(document.getElementById("editTaskSection"),_.map(se=>({value:se.id,text:se.name})),"  ");let T=I;w&&(T=T.filter(se=>!se.classId||se.classId===w));const L=Array.from(new Map(T.map(se=>{var X;return[(X=se.name)==null?void 0:X.trim(),se]})).values());Pt.populateSelect(document.getElementById("editTaskSubject"),L.map(se=>({value:se.id,text:se.name})),"  ")})}}async function hae(r){if(!(il!=null&&il.canDelete())){Pt.showToast("     ","warning");return}const e=Vr.get("tasks").find(s=>s.id===r);if(!e){Pt.showToast("  ","error");return}const t=Vr.get("evaluations").filter(s=>s.taskId===r);let n=`"${e.name}"    ?`;t.length>0&&(n+=`

(  ${ia.convertToBanglaNumber(t.length)}    !)`),Pt.showDeleteModal(" ",n,async()=>{Pt.showLoading(" ...");try{if(t.length>0&&Jo.batchDeleteEvaluations)await Jo.batchDeleteEvaluations(t.map(s=>s.id));else if(t.length>0)for(const s of t)await Jo.deleteEvaluation(s.id);await Jo.deleteTask(r),await cp.refreshAllData(),Pt.showToast("  ","success")}catch(s){Pt.showToast(` : ${s.message}`,"error")}finally{Pt.hideLoading()}})}async function fae(r){const e=r==null?void 0:r.dataset.id,t=Bb(r==null?void 0:r.value),n=(r==null?void 0:r.dataset.currentStatus)||Bb(r==null?void 0:r.value);if(!(!e||!t||t===n)){r.disabled=!0,Pt.showLoading("  ...");try{await Jo.updateTask(e,{status:t}),r.dataset.currentStatus=t,await cp.refreshAllData(),Pt.showToast("  ","success")}catch(s){Pt.showToast(`  : ${s.message}`,"error"),n&&(r.value=n)}finally{r.disabled=!1,Pt.hideLoading()}}}function gae(r,e="  "){const t=Vr.get("tasks"),n=Vr.get("currentUserData");if(!t){console.warn("populateTaskSelects: Tasks not loaded yet.");return}let s=t;if(n&&n.type==="teacher"){const a=Vr.get("currentTeacher"),o=(a==null?void 0:a.assignedSubjects)||[];s=t.filter(l=>l.subjectId?o.includes(l.subjectId):!1)}const i=s.map(a=>({value:a.id,text:`${ia.ensureBengaliText(a.name)} (${ia.formatTimestamp(a.date)||"N/A"})`,date:Lg(a.date)})).sort((a,o)=>o.date.localeCompare(a.date));r.forEach(a=>{const o=document.getElementById(a);o?(Pt.populateSelect(o,i,e),o.options[0]&&o.options[0].value===""&&(o.options[0].disabled=!0)):console.warn(`populateTaskSelects: Element #${a} not found.`)})}let Vt,Ot,$d,Yr,i_,Ma;const ot={};let hA=null,kA=null;const OM={task:20,team:15,Progress:25,mcq:40},QM=100,pae={"team-leader":{label:" ",className:"bg-amber-100 text-amber-700 border-amber-200 dark:bg-amber-500/20 dark:text-amber-100 dark:border-amber-500/40"},"time-keeper":{label:" ",className:"bg-sky-100 text-sky-700 border-sky-200 dark:bg-sky-500/20 dark:text-sky-100 dark:border-sky-500/40"},reporter:{label:"",className:"bg-purple-100 text-purple-700 border-purple-200 dark:bg-purple-500/20 dark:text-purple-100 dark:border-purple-500/40"},"resource-manager":{label:" ",className:"bg-emerald-100 text-emerald-700 border-emerald-200 dark:bg-emerald-500/20 dark:text-emerald-100 dark:border-emerald-500/40"},"peace-maker":{label:" ",className:"bg-rose-100 text-rose-700 border-rose-200 dark:bg-rose-500/20 dark:text-rose-100 dark:border-rose-500/40"}},co=["bg-red-100 text-red-800 border-red-200 dark:bg-red-900 dark:text-white dark:border-red-700","bg-orange-100 text-orange-800 border-orange-200 dark:bg-orange-900 dark:text-white dark:border-orange-700","bg-yellow-100 text-yellow-800 border-yellow-200 dark:bg-yellow-900 dark:text-white dark:border-yellow-700","bg-green-100 text-green-800 border-green-200 dark:bg-green-900 dark:text-white dark:border-green-700","bg-teal-100 text-teal-800 border-teal-200 dark:bg-teal-900 dark:text-white dark:border-teal-700","bg-blue-100 text-blue-800 border-blue-200 dark:bg-blue-900 dark:text-white dark:border-blue-700","bg-indigo-100 text-indigo-800 border-indigo-200 dark:bg-indigo-900 dark:text-white dark:border-indigo-700","bg-purple-100 text-purple-800 border-purple-200 dark:bg-purple-900 dark:text-white dark:border-purple-700","bg-pink-100 text-pink-800 border-pink-200 dark:bg-pink-900 dark:text-white dark:border-pink-700","bg-gray-100 text-gray-800 border-gray-200 dark:bg-gray-700 dark:text-white dark:border-gray-600"],GE=["bg-blue-100 text-blue-800 border-blue-200 dark:bg-blue-900 dark:text-white dark:border-blue-700","bg-indigo-100 text-indigo-800 border-indigo-200 dark:bg-indigo-900 dark:text-white dark:border-indigo-700","bg-violet-100 text-violet-800 border-violet-200 dark:bg-violet-900 dark:text-white dark:border-violet-700","bg-purple-100 text-purple-800 border-purple-200 dark:bg-purple-900 dark:text-white dark:border-purple-700","bg-fuchsia-100 text-fuchsia-800 border-fuchsia-200 dark:bg-fuchsia-900 dark:text-white dark:border-fuchsia-700","bg-pink-100 text-pink-800 border-pink-200 dark:bg-pink-900 dark:text-white dark:border-pink-700","bg-rose-100 text-rose-800 border-rose-200 dark:bg-rose-900 dark:text-white dark:border-rose-700","bg-orange-100 text-orange-800 border-orange-200 dark:bg-orange-900 dark:text-white dark:border-orange-700","bg-amber-100 text-amber-800 border-amber-200 dark:bg-amber-900 dark:text-white dark:border-amber-700","bg-lime-100 text-lime-800 border-lime-200 dark:bg-lime-900 dark:text-white dark:border-lime-700","bg-emerald-100 text-emerald-800 border-emerald-200 dark:bg-emerald-900 dark:text-white dark:border-emerald-700","bg-teal-100 text-teal-800 border-teal-200 dark:bg-teal-900 dark:text-white dark:border-teal-700","bg-cyan-100 text-cyan-800 border-cyan-200 dark:bg-cyan-900 dark:text-white dark:border-cyan-700","bg-sky-100 text-sky-800 border-sky-200 dark:bg-sky-900 dark:text-white dark:border-sky-700"];function mae(r){const e=r.trim().toLowerCase();if(e.includes("")||e.includes("bangla"))return co[0];if(e.includes("")||e.includes("english"))return co[5];if(e.includes("")||e.includes("math"))return co[1];if(e.includes("")||e.includes("ict")||e.includes(""))return co[4];if(e.includes("")||e.includes("science"))return co[3];if(e.includes("")||e.includes("religion")||e.includes(""))return co[7];if(e.includes("")||e.includes("physics"))return co[8];if(e.includes("")||e.includes("chemistry"))return co[2];if(e.includes("")||e.includes("biology"))return co[6];let t=0;for(let n=0;n<r.length;n++)t=r.charCodeAt(n)+((t<<5)-t);return co[Math.abs(t)%co.length]}function bae(r){let e=0;for(let t=0;t<r.length;t++)e=r.charCodeAt(t)+((e<<5)-e);return GE[Math.abs(e)%GE.length]}const zE={topic:[{id:"topic_none",text:"   ",marks:-5},{id:"topic_understood",text:" ",marks:5},{id:"topic_learned_well",text:"  ",marks:10}],options:[{id:"homework_done",text:"    ",marks:5},{id:"attendance_regular",text:"  ",marks:10}]};function yae(r){const e="inline-flex items-center px-2 py-0.5 text-xs font-semibold rounded-full border mt-1";if(!r)return`<span class="${e} bg-gray-100 text-gray-500 border-gray-200 dark:bg-gray-800 dark:text-gray-300 dark:border-gray-700">  </span>`;const t=pae[r]||{label:Yr!=null&&Yr.ensureBengaliText?Yr.ensureBengaliText(r):r,className:"bg-gray-100 text-gray-600 border-gray-200 dark:bg-gray-800 dark:text-gray-200 dark:border-gray-700"},n=t.label||(Yr!=null&&Yr.ensureBengaliText?Yr.ensureBengaliText(r):r),s=t.className||"";return`<span class="${e} ${s}">${n}</span>`}function wae(r){return Vt=r.managers.stateManager,Ot=r.managers.uiManager,$d=r.services.dataService,Ma=r.utils.permissionHelper,Yr=r.utils,i_=r.app,r.app.components.tasks,xae(),_ae(),console.log(" Evaluation component initialized."),{render:vae}}function vae(){if(!ot.page){console.error(" Evaluation render failed: Page element not found.");return}console.log("Rendering Evaluation page..."),Bae(),Iae(),a_(),hA||(Ot.clearContainer(ot.evaluationFormContainer),kA=null)}function xae(){ot.page=document.getElementById("page-evaluation"),ot.page?(ot.evaluationTaskSelect=ot.page.querySelector("#evaluationTaskSelect"),ot.evaluationGroupSelect=ot.page.querySelector("#evaluationGroupSelect"),ot.evaluationClassSelect=ot.page.querySelector("#evaluationClassSelect"),ot.evaluationSectionSelect=ot.page.querySelector("#evaluationSectionSelect"),ot.evaluationSubjectSelect=ot.page.querySelector("#evaluationSubjectSelect"),ot.startEvaluationBtn=ot.page.querySelector("#startEvaluationBtn"),ot.dashboardConfigContainer=ot.page.querySelector("#dashboardConfigContainer"),ot.evaluationFormContainer=ot.page.querySelector("#evaluationForm"),ot.evaluationListTableBody=ot.page.querySelector("#evaluationListTable")):console.error(" Evaluation init failed: #page-evaluation element not found!")}function _ae(){ot.page&&(ot.evaluationClassSelect&&Ot.addListener(ot.evaluationClassSelect,"change",()=>{HM(),km()}),ot.evaluationSectionSelect&&Ot.addListener(ot.evaluationSectionSelect,"change",km),ot.evaluationSubjectSelect&&Ot.addListener(ot.evaluationSubjectSelect,"change",km),Ot.addListener(ot.startEvaluationBtn,"click",Cae),Ot.addListener(ot.evaluationFormContainer,"submit",r=>{r.target&&r.target.id==="dynamicEvaluationForm"&&(r.preventDefault(),Sae())}),Ot.addListener(ot.evaluationFormContainer,"click",r=>{r.target&&r.target.id==="cancelEvaluationBtn"&&xy()}),Ot.addListener(ot.evaluationFormContainer,"input",r=>{r.target&&(r.target.classList.contains("score-input")||r.target.classList.contains("criteria-input")||r.target.classList.contains("comments-input"))&&VM(r.target)}),Ot.addListener(ot.evaluationListTableBody,"click",r=>{const e=r.target.closest(".edit-evaluation-btn"),t=r.target.closest(".delete-evaluation-btn");e?kae(e.dataset.id):t&&Eae(t.dataset.id)}))}function Bae(){console.log(" Populating evaluation selectors...");const r=Vt.get("classes")||[],e=Vt.get("sections")||[],t=Vt.get("subjects")||[],n=Vt.get("currentUserData");let s=r;if(n&&n.type==="teacher"){const i=Vt.get("currentTeacher"),a=(i==null?void 0:i.assignedClasses)||[],o=(i==null?void 0:i.assignedSections)||[],l=(i==null?void 0:i.assignedSubjects)||[],c=new Set(e.filter(d=>o.includes(d.id)).map(d=>{var h;return(h=d.name)==null?void 0:h.trim()})),A=new Set(t.filter(d=>l.includes(d.id)).map(d=>{var h;return(h=d.name)==null?void 0:h.trim()}));a.length>0&&(s=r.filter(d=>a.includes(d.id))),o.length>0&&e.filter(d=>o.includes(d.id)||d.name&&c.has(d.name.trim())),l.length>0&&t.filter(d=>l.includes(d.id)||d.name&&A.has(d.name.trim()))}ot.evaluationClassSelect&&Ot.populateSelect(ot.evaluationClassSelect,s.map(i=>({value:i.id,text:i.name}))," "),HM(),km()}function HM(){var c,A,d;const r=(c=ot.evaluationClassSelect)==null?void 0:c.value,e=Vt.get("sections")||[],t=Vt.get("subjects")||[],n=Vt.get("tasks")||[],s=Vt.get("currentUserData");let i=e,a=t;if(s&&s.type==="teacher"){const h=Vt.get("currentTeacher"),u=(h==null?void 0:h.assignedSections)||[],p=(h==null?void 0:h.assignedSubjects)||[];if(u.length>0){const f=new Set(e.filter(g=>u.includes(g.id)).map(g=>{var m;return(m=g.name)==null?void 0:m.trim()}));i=e.filter(g=>u.includes(g.id)||g.name&&f.has(g.name.trim()))}if(p.length>0){const f=new Set(t.filter(g=>p.includes(g.id)).map(g=>{var m;return(m=g.name)==null?void 0:m.trim()}));a=t.filter(g=>p.includes(g.id)||g.name&&f.has(g.name.trim()))}}if(r){const h=Vt.get("students")||[],u=Vt.get("groups")||[],p=new Set,f=new Set,g=S=>{if(!S)return;p.add(S);const B=e.find(F=>F.id===S);B&&B.name&&f.add(B.name.trim())};h.forEach(S=>{S.classId===r&&g(S.sectionId)}),u.forEach(S=>{S.classId===r&&g(S.sectionId)}),n.forEach(S=>{S.classId===r&&g(S.sectionId)}),p.size>0&&(i=i.filter(S=>p.has(S.id)||S.name&&f.has(S.name.trim())));const m=new Set,x=new Set;n.filter(S=>S.classId===r).forEach(S=>{if(S.subjectId){m.add(S.subjectId);const B=t.find(F=>F.id===S.subjectId);B&&B.name&&x.add(B.name.trim())}}),a=a.filter(S=>m.has(S.id)||S.name&&x.has(S.name.trim()))}const o=(A=ot.evaluationSectionSelect)==null?void 0:A.value,l=(d=ot.evaluationSubjectSelect)==null?void 0:d.value;if(ot.evaluationSectionSelect){const h=[],u=new Set;i.forEach(p=>{const f=p.name?p.name.trim():"";f&&!u.has(f)&&(u.add(f),h.push(p))}),Ot.populateSelect(ot.evaluationSectionSelect,h.map(p=>({value:p.id,text:p.name}))," "),o&&h.some(p=>p.id===o)&&(ot.evaluationSectionSelect.value=o)}if(ot.evaluationSubjectSelect){const h=[],u=new Set;a.forEach(p=>{const f=p.name?p.name.trim():"";f&&!u.has(f)&&(u.add(f),h.push(p))}),Ot.populateSelect(ot.evaluationSubjectSelect,h.map(p=>({value:p.id,text:p.name}))," "),l&&h.some(p=>p.id===l)&&(ot.evaluationSubjectSelect.value=l)}}function km(){var A,d,h,u;const r=(A=ot.evaluationClassSelect)==null?void 0:A.value,e=(d=ot.evaluationSectionSelect)==null?void 0:d.value,t=(h=ot.evaluationSubjectSelect)==null?void 0:h.value,n=Vt.get("tasks")||[],s=Vt.get("groups")||[],i=Vt.get("currentUserData");let a=n;if(i&&i.type==="teacher"){const p=Vt.get("currentTeacher"),f=(p==null?void 0:p.assignedSubjects)||[],g=Vt.get("subjects")||[],m=new Set(g.filter(x=>f.includes(x.id)).map(x=>{var S;return(S=x.name)==null?void 0:S.trim()}));a=a.filter(x=>{if(!x.subjectId)return!1;if(f.includes(x.subjectId))return!0;const S=g.find(B=>B.id===x.subjectId);return S&&S.name&&m.has(S.name.trim())})}if(console.log(" Evaluation Filter - Start:",{totalTasks:n.length,selectedClassId:r,selectedSectionId:e,selectedSubjectId:t}),r&&(a=a.filter(p=>p.classId===r),console.log(" After class filter:",a.length)),e){const p=Vt.get("sections")||[],f=p.find(g=>g.id===e);f?a=a.filter(g=>{if(!g.sectionId)return!0;const m=p.find(x=>x.id===g.sectionId);return m&&m.name===f.name}):a=a.filter(g=>!g.sectionId||g.sectionId===e),console.log(" After section filter:",a.length)}if(t){const p=Vt.get("subjects")||[],f=p.find(g=>g.id===t);if(f&&f.name){const g=f.name.trim();a=a.filter(m=>{if(m.subjectId===t)return!0;const x=p.find(S=>S.id===m.subjectId);return x&&x.name&&x.name.trim()===g})}else a=a.filter(g=>g.subjectId===t);console.log(" After subject filter:",a.length)}console.log(" Final filtered tasks:",a.map(p=>({name:p.name,classId:p.classId,sectionId:p.sectionId,subjectId:p.subjectId})));let o=s;if(i&&i.type==="teacher"){const p=Vt.get("currentTeacher"),f=(p==null?void 0:p.assignedClasses)||[],g=(p==null?void 0:p.assignedSections)||[],m=Vt.get("sections")||[],x=new Set(m.filter(S=>g.includes(S.id)).map(S=>{var B;return(B=S.name)==null?void 0:B.trim()}));o=o.filter(S=>{if(f.length>0&&!f.includes(S.classId))return!1;if(S.sectionId&&g.length>0){if(g.includes(S.sectionId))return!0;const B=m.find(F=>F.id===S.sectionId);return!!(B&&B.name&&x.has(B.name.trim()))}return!0})}if(r&&(o=o.filter(p=>p.classId===r)),e){const p=Vt.get("sections")||[],f=p.find(m=>m.id===e),g=(u=f==null?void 0:f.name)==null?void 0:u.trim().toLowerCase();o=o.filter(m=>{var x;if(!m.sectionId||m.sectionId===e)return!0;if(g){const S=p.find(F=>F.id===m.sectionId);return((x=S==null?void 0:S.name)==null?void 0:x.trim().toLowerCase())===g}return!1})}const l=a.map(p=>{let f="";try{p.date&&(typeof p.date=="string"?f=p.date:typeof p.date.toDate=="function"?f=p.date.toDate().toISOString():p.date instanceof Date&&(f=p.date.toISOString()))}catch(g){console.warn("Date conversion error",g)}return{value:p.id,text:`${Yr.ensureBengaliText(p.name)} (${Yr.formatTimestamp(p.date)||"N/A"})`,sortDate:f}}).sort((p,f)=>f.sortDate.localeCompare(p.sortDate));ot.evaluationTaskSelect&&(Ot.populateSelect(ot.evaluationTaskSelect,l,"  "),ot.evaluationTaskSelect.options.length>1&&(ot.evaluationTaskSelect.selectedIndex=0));const c=o.map(p=>({value:p.id,text:p.name}));ot.evaluationGroupSelect&&Ot.populateSelect(ot.evaluationGroupSelect,c,"  ")}async function Cae(){var o,l;const r=(o=ot.evaluationTaskSelect)==null?void 0:o.value,e=(l=ot.evaluationGroupSelect)==null?void 0:l.value;if(!r||!e){Ot.showToast("      ","warning");return}const t=Vt.get("tasks").find(c=>c.id===r),n=Vt.get("groups").find(c=>c.id===e);if(!t||!n){Ot.showToast("      ","error");return}if(!t.maxScoreBreakdown||t.maxScoreBreakdown.mcq===void 0){Ot.showToast("    (task, team, Progress, mcq)        ","error",5e3);return}kA=t.maxScoreBreakdown;let s=Vt.get("students").filter(c=>c.groupId===e).sort((c,A)=>String(c.roll).localeCompare(String(A.roll),void 0,{numeric:!0}));const i=Vt.get("currentUserData");if(i&&i.type==="teacher"){const c=Vt.get("currentTeacher"),A=(c==null?void 0:c.assignedClasses)||[];s=s.filter(d=>A.includes(d.classId))}if(s.length===0){Ot.showToast("    ","warning");return}const a=Vt.get("evaluations").find(c=>c.taskId===r&&c.groupId===e);a?await $M(a.id,t,n,s):(jM(t,n,s,null),hA=null)}function jM(r,e,t,n=null){if(!ot.evaluationFormContainer)return;const s=r.maxScoreBreakdown||OM,i=parseFloat(s.task)||0,a=parseFloat(s.team)||0,o=parseFloat(s.Progress)||0,l=parseFloat(s.mcq)||0,c=r.maxScore||i+a+o+l;kA=s;const A=Vt.get("classes")||[],d=Vt.get("sections")||[],h=new Map(A.map(g=>[g.id,g])),u=new Map(d.map(g=>[g.id,g]));let p=`
    <form id="dynamicEvaluationForm" class="card card-body space-y-6">
        <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center border-b pb-3 dark:border-gray-600">
             <h3 class="text-xl font-semibold text-gray-800 dark:text-white">
                 ${n?"":" "}: ${Yr.ensureBengaliText(r.name)} - ${Yr.ensureBengaliText(e.name)}
             </h3>
             <p class="text-sm text-gray-600 dark:text-gray-400 mt-1 sm:mt-0" title="-${i}, -${a}, -${o}, MCQ-${l}">
                   : ${Yr.convertToBanglaNumber(c)}
             </p>
        </div>
        <div class="overflow-x-auto relative shadow-md sm:rounded-lg">
            <table class="w-full text-sm text-left text-gray-500 dark:text-gray-400">
                <thead class="text-xs text-gray-700 uppercase bg-gray-100 dark:bg-gray-700 dark:text-gray-300">
                    <tr>
                        <th scope="col" class="th w-1/12"></th>
                        <th scope="col" class="th w-2/12">  </th>
                        <th scope="col" class="th text-center w-1/12"> (${Yr.convertToBanglaNumber(i)})</th>
                        <th scope="col" class="th text-center w-1/12"> (${Yr.convertToBanglaNumber(a)})</th>
                        <th scope="col" class="th text-center w-1/12">MCQ (${Yr.convertToBanglaNumber(l)})</th>
                        <th scope="col" class="th text-center w-4/12">
                          <div class="flex flex-col items-center gap-1">
                            <span>  ( ${Yr.convertToBanglaNumber(o)})</span>
                            <button type="button" id="unmarkAllCriteriaBtn" class="px-2 py-0.5 text-[10px] font-medium bg-rose-500/10 text-rose-700 dark:text-rose-300 hover:bg-rose-500/20 rounded border border-rose-200 dark:border-rose-800 transition-colors">
                              <i class="fas fa-times-circle text-[9px]"></i>  
                            </button>
                          </div>
                        </th>
                        <th scope="col" class="th text-center w-1/12"></th>
                        <th scope="col" class="th text-center w-1/12"> (${Yr.convertToBanglaNumber(c)})</th>
                    </tr>
                </thead>
                <tbody>
    `;t.forEach((g,m)=>{var T,L;const x=n?n[g.id]:null,S=m%2===0?"bg-white dark:bg-gray-800":"bg-gray-50 dark:bg-gray-700",B=(x==null?void 0:x.ProgressCriteria)||{},F=B.topic||"",N=B.homework||!1,E=B.attendance||!1,w=(x==null?void 0:x.comments)||"",v=(x==null?void 0:x.problemRecovered)||!1,I=F==="topic_none"||F==="topic_understood",k=((T=h.get(g.classId))==null?void 0:T.name)||"-",_=((L=u.get(g.sectionId))==null?void 0:L.name)||"-";p+=`
            <tr class="${S} border-b dark:border-gray-600 student-row" data-student-id="${g.id}">
                <td class="td font-medium text-gray-900 dark:text-white">${Yr.convertToBanglaNumber(g.roll)}</td>
                <td class="td">
                    <div class="font-semibold text-gray-900 dark:text-white">${Yr.ensureBengaliText?Yr.ensureBengaliText(g.name||""):g.name||""}</div>
                    <div class="text-xs text-gray-500 dark:text-gray-400 mt-0.5">${k}  ${_}</div>
                    ${yae(g.role)}
                    
                    <!-- Problem Recovered Checkbox Container -->
                    <div class="problem-recovered-container mt-2 ${I?"":"hidden"}">
                        <label class="inline-flex items-center space-x-2 cursor-pointer bg-red-50 dark:bg-red-900/20 px-2 py-1 rounded border border-red-100 dark:border-red-800">
                            <input type="checkbox" class="form-checkbox h-3 w-3 text-red-600 rounded border-gray-300 focus:ring-red-500 problem-recovered-input" 
                                   ${v?"checked":""}>
                            <span class="text-xs font-medium text-red-700 dark:text-red-300"> </span>
                        </label>
                    </div>
                </td>
                <td class="td"><input type="number" step="any" class="score-input task-score" min="0" max="${i}" data-max="${i}" value="${(x==null?void 0:x.taskScore)??""}" aria-label="${g.name} Task Score"></td>
                <td class="td"><input type="number" step="any" class="score-input team-score" min="0" max="${a}" data-max="${a}" value="${(x==null?void 0:x.teamScore)??""}" aria-label="${g.name} Team Score"></td>
                <td class="td"><input type="number" step="any" class="score-input mcq-score" min="0" max="${l}" data-max="${l}" value="${(x==null?void 0:x.mcqScore)??""}" aria-label="${g.name} MCQ Score"></td>
                <td class="td criteria-cell" data-max-Progress="${o}">
                    <fieldset class="space-y-2">
                        <legend class="sr-only"> </legend>
                        ${zE.topic.map(K=>`
                            <label class="flex items-center text-xs space-x-2 cursor-pointer">
                                <input type="radio" name="topic-${g.id}" value="${K.id}" data-marks="${K.marks}" ${F===K.id?"checked":""} class="criteria-input topic-radio">
                                <span>${K.text} (${K.marks>0?"+":""}${Yr.convertToBanglaNumber(K.marks)})</span>
                            </label>
                        `).join("")}
                        <hr class="dark:border-gray-600 my-1">
                        ${zE.options.map(K=>`
                            <label class="flex items-center text-xs space-x-2 cursor-pointer">
                                <input type="checkbox" name="${K.id}-${g.id}" value="${K.id}" data-marks="${K.marks}" ${N&&K.id==="homework_done"?"checked":""} ${E&&K.id==="attendance_regular"?"checked":""} class="criteria-input">
                                <span>${K.text} (+${Yr.convertToBanglaNumber(K.marks)})</span>
                            </label>
                        `).join("")}
                    </fieldset>
                </td>
                <td class="td"><textarea class="form-input text-xs p-1 comments-input" rows="3" placeholder="-..." aria-label="${g.name} Comments">${w}</textarea></td>
                <td class="td text-center font-bold text-lg total-score-display dark:text-white" data-total-max="${c}">
                   ${(x==null?void 0:x.totalScore)!==void 0?Yr.convertToBanglaNumber(parseFloat(x.totalScore).toFixed(2)):"0"}
                </td>
            </tr>
        `}),p+=`
                </tbody>
            </table>
            <style>
                .td { padding: 8px 6px; border: 1px solid #e5e7eb; vertical-align: top; }
                .dark .td { border-color: #4b5563; }
                .th { padding: 10px 6px; border: 1px solid #e5e7eb; vertical-align: middle; }
                .dark .th { border-color: #4b5563; }
                .score-input, .comments-input { width: 100%; min-width: 50px; padding: 4px; border: 1px solid #d1d5db; border-radius: 4px; text-align: center; background-color: white; }
                .dark .score-input, .dark .comments-input { background-color: #374151; border-color: #4b5563; color: white; }
                .score-input:focus, .comments-input:focus { border-color: #3b82f6; box-shadow: 0 0 0 1px #3b82f6; outline: none; }
                .criteria-cell { background-color: #f9fafb; }
                .dark .criteria-cell { background-color: rgba(31, 41, 55, 0.5); }
                .criteria-input { width: 1rem; height: 1rem; cursor: pointer; border: 1px solid #d1d5db; background-color: transparent; accent-color: #2563eb; }
                .dark .criteria-input { border-color: #4b5563; background-color: #1f2937; accent-color: #60a5fa; }
            </style>
        </div>
        <div class="flex justify-end space-x-3 pt-4 border-t dark:border-gray-600">
             <button type="button" id="cancelEvaluationBtn" class="btn btn-light"></button>
             <button type="submit" class="btn btn-primary">${n?" ":" "}</button>
        </div>
    </form>
    `,ot.evaluationFormContainer.innerHTML=p;const f=document.getElementById("unmarkAllCriteriaBtn");f&&f.addEventListener("click",()=>{const g=document.getElementById("dynamicEvaluationForm");g&&(g.querySelectorAll('.criteria-cell input[type="checkbox"]').forEach(m=>{m.classList.contains("problem-recovered-input")||(m.checked=!1)}),g.querySelectorAll('.criteria-cell input[type="radio"]').forEach(m=>{m.checked=!1}),g.querySelectorAll(".problem-recovered-container").forEach(m=>{m.classList.add("hidden")}),g.querySelectorAll(".student-row").forEach(m=>{const x=m.querySelector(".score-input");x&&VM(x)}),Ot.showToast("     ","info",2e3))})}function VM(r){const e=r.closest(".student-row");if(!e)return;if(r.classList.contains("topic-radio")){const B=e.querySelector(".problem-recovered-container"),F=e.querySelector(".problem-recovered-input"),N=r.value;N==="topic_none"||N==="topic_understood"?B.classList.remove("hidden"):(B.classList.add("hidden"),F&&(F.checked=!1))}const t=e.querySelector(".total-score-display"),n=parseFloat((t==null?void 0:t.dataset.totalMax)||QM),s=kA||OM,i=parseFloat(s.task)||0,a=parseFloat(s.team)||0,o=parseFloat(s.Progress)||0,l=parseFloat(s.mcq)||0,c=e.querySelector(".task-score"),A=e.querySelector(".team-score"),d=e.querySelector(".mcq-score"),h=(B,F)=>{if(!B)return 0;let N=B.value===""?null:parseFloat(B.value);return N!==null&&(isNaN(N)||N<0?(N=0,B.value=0):N>F&&(N=F,B.value=F,Ot.showToast(`  ${Yr.convertToBanglaNumber(F)}`,"warning",1500))),N||0},u=h(c,i),p=h(A,a),f=h(d,l);let g=0;const m=e.querySelector('input[type="radio"]:checked');m&&(g+=parseFloat(m.dataset.marks)||0),e.querySelectorAll('input[type="checkbox"]:checked').forEach(B=>{B.classList.contains("problem-recovered-input")||(g+=parseFloat(B.dataset.marks)||0)}),g=Math.min(Math.max(g,-5),o);const x=u+p+f+g,S=Math.min(Math.max(x,0),n);t&&(t.textContent=Yr.convertToBanglaNumber(S.toFixed(2)))}function xy(){Ot.clearContainer(ot.evaluationFormContainer),hA=null,kA=null,ot.evaluationTaskSelect&&(ot.evaluationTaskSelect.selectedIndex=0),ot.evaluationGroupSelect&&(ot.evaluationGroupSelect.selectedIndex=0),Ot.showToast("   ","info")}async function Sae(){var m,x,S;if(!(Ma!=null&&Ma.canWrite())){Ot.showToast(" evaluation submit   ","warning");return}const r=(m=ot.evaluationTaskSelect)==null?void 0:m.value,e=(x=ot.evaluationGroupSelect)==null?void 0:x.value,t=Vt.get("tasks").find(B=>B.id===r);if(!t||!e||!kA){Ot.showToast(" , ,      ","error");return}const{task:n,team:s,Progress:i,mcq:a}=kA,o=t.maxScore||QM,l={};let c=!0,A=0,d=0;if((S=ot.evaluationFormContainer)==null||S.querySelectorAll(".student-row").forEach(B=>{var ie,le;const F=B.dataset.studentId;if(!F){c=!1;return}const N=B.querySelector(".task-score"),E=B.querySelector(".team-score"),w=B.querySelector(".mcq-score"),v=((ie=B.querySelector(".comments-input"))==null?void 0:ie.value.trim())||"",I=B.querySelector('input[type="radio"]:checked'),k=B.querySelector('input[type="checkbox"][value="homework_done"]'),_=B.querySelector('input[type="checkbox"][value="attendance_regular"]'),T=B.querySelector(".problem-recovered-input"),L=T?T.checked:!1,K=N==null?void 0:N.value,se=E==null?void 0:E.value,X=w==null?void 0:w.value;if(K===""&&se===""&&X===""&&!I&&!(k!=null&&k.checked)&&!(_!=null&&_.checked)){B.style.outline="";return}const V=parseFloat(K),he=parseFloat(se),z=parseFloat(X);let M=0;const O={topic:(I==null?void 0:I.value)||null,homework:(k==null?void 0:k.checked)||!1,attendance:(_==null?void 0:_.checked)||!1};I&&(M+=parseFloat(I.dataset.marks)||0),k!=null&&k.checked&&(M+=parseFloat(k.dataset.marks)||0),_!=null&&_.checked&&(M+=parseFloat(_.dataset.marks)||0),M=Math.min(Math.max(M,-5),i);let H=!0;if((isNaN(V)||V<0||V>n)&&(H=!1),(isNaN(he)||he<0||he>s)&&(H=!1),(isNaN(z)||z<0||z>a)&&(H=!1),I||(H=!1),H)B.style.outline="";else{c=!1,B.style.outline="2px solid red",Ot.showToast(` ${((le=B.querySelector("td:nth-child(2)"))==null?void 0:le.textContent)||F}     /`,"warning",2500);return}const J=parseFloat((V+he+z+M).toFixed(2)),de=Math.min(Math.max(J,0),o);l[F]={taskScore:V,teamScore:he,ProgressScore:M,mcqScore:z,totalScore:de,ProgressCriteria:O,comments:v,problemRecovered:L},d+=de,A++}),!c){Ot.showToast("        ","error");return}if(A===0){Ot.showToast("       ","warning");return}const h=d/A,u=o>0?h/o*100:0,p=Vt.get("groups").find(B=>B.id===e),f={taskId:r,groupId:e,classId:(p==null?void 0:p.classId)||null,sectionId:(p==null?void 0:p.sectionId)||null,taskName:t.name,groupName:(p==null?void 0:p.name)||"Unknown",scores:l,studentCount:A,groupTotalScore:d,groupAverageScore:u,maxPossibleScore:o,evaluationDate:nl(),taskDate:t.date},g=hA?"":"";Ot.showLoading(` ${g} ...`);try{hA?(delete f.evaluationDate,await $d.updateEvaluation(hA,f)):await $d.addEvaluation(f),await i_.refreshAllData(),xy(),Ot.showToast(` ${g} `,"success"),a_()}catch(B){console.error(` Error ${g}ing evaluation:`,B),Ot.showToast(` ${g}  : ${B.message}`,"error")}finally{Ot.hideLoading()}}function a_(){if(!ot.evaluationListTableBody)return;let r=Vt.get("evaluations");const e=Vt.get("currentUserData"),t=Vt.get("tasks")||[],n=Vt.get("groups")||[],s=Vt.get("classes")||[],i=Vt.get("subjects")||[],a=Vt.get("sections")||[];if(e&&e.type==="teacher"){const c=Vt.get("currentTeacher"),A=(c==null?void 0:c.assignedSubjects)||[],d=(c==null?void 0:c.assignedClasses)||[],h=(c==null?void 0:c.assignedSections)||[],u=new Set(i.filter(m=>A.includes(m.id)).map(m=>{var x;return(x=m.name)==null?void 0:x.trim()})),p=new Set(a.filter(m=>h.includes(m.id)).map(m=>{var x;return(x=m.name)==null?void 0:x.trim()})),f=new Map(t.map(m=>[m.id,m])),g=new Map(n.map(m=>[m.id,m]));r=r.filter(m=>{const x=f.get(m.taskId),S=g.get(m.groupId);let B=!1;if(x&&x.subjectId)if(A.includes(x.subjectId))B=!0;else{const w=i.find(v=>v.id===x.subjectId);w&&w.name&&u.has(w.name.trim())&&(B=!0)}const F=m.classId?d.includes(m.classId):S!=null&&S.classId?d.includes(S.classId):!0;let N=!0;const E=m.sectionId||(S==null?void 0:S.sectionId);if(E&&h.length>0)if(h.includes(E))N=!0;else{const w=a.find(v=>v.id===E);w&&w.name&&p.has(w.name.trim())?N=!0:N=!1}return B&&F&&N})}const o=new Map(t.map(c=>[c.id,c])),l=new Map(n.map(c=>[c.id,c.name]));if(r.sort((c,A)=>(A.taskDate||"").localeCompare(c.taskDate||"")),Ot.clearContainer(ot.evaluationListTableBody),r.length===0){const c=ot.evaluationListTableBody.insertRow();c.innerHTML='<td colspan="5" class="placeholder-content p-4 text-center text-gray-500 dark:text-gray-400">    </td>';return}r.forEach(c=>{var w,v;const A=o.get(c.taskId),d=(A==null?void 0:A.name)||c.taskName||"",h=l.get(c.groupId)||c.groupName||"",u=c.taskDate?Yr.formatTimestamp(c.taskDate):"N/A",p=c.groupAverageScore!==void 0?c.groupAverageScore:null,f=p!==null&&!isNaN(p)?`${Yr.convertToBanglaNumber(p.toFixed(1))}%`:"N/A",g=p!==null&&!isNaN(p)?Yr.getPerformanceColorClass(p):"",m=(A==null?void 0:A.classId)||c.classId,x=A==null?void 0:A.subjectId,S=m?((w=s.find(I=>I.id===m))==null?void 0:w.name)||"":"-",B=x?((v=i.find(I=>I.id===x))==null?void 0:v.name)||"":"-",F=bae(S),N=mae(B),E=ot.evaluationListTableBody.insertRow();E.className="border-b dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700/50",E.innerHTML=`
            <td class="td p-3">
                <div class="font-semibold text-gray-900 dark:text-white">${d}</div>
                <div class="flex flex-wrap gap-1 mt-1">
                    ${S!=="-"?`<span class="inline-flex items-center px-1.5 py-0.5 rounded text-[10px] font-medium border ${F}">${S}</span>`:""}
                    ${B!=="-"?`<span class="inline-flex items-center px-1.5 py-0.5 rounded text-[10px] font-medium ${N}">${B}</span>`:""}
                </div>
            </td> 
            <td class="td p-3">${h}</td> <td class="td p-3">${u}</td>
            <td class="td p-3 text-center font-semibold ${g}">${f}</td>
            <td class="td p-3 text-center whitespace-nowrap">
                <button data-id="${c.id}" class="edit-evaluation-btn btn btn-light btn-sm p-1 mx-1" aria-label=""><i class="fas fa-edit pointer-events-none"></i></button>
                <button data-id="${c.id}" class="delete-evaluation-btn btn btn-danger btn-sm p-1 mx-1" aria-label=""><i class="fas fa-trash pointer-events-none"></i></button>
            </td>`})}async function $M(r,e,t,n){var s;Ot.showLoading("   ...");try{const i=await $d.getEvaluationById(r);if(!i||!i.scores)throw new Error("    ");jM(e,t,n,i.scores),hA=r,(s=ot.evaluationFormContainer)==null||s.scrollIntoView({behavior:"smooth",block:"start"})}catch(i){console.error(" Error loading evaluation for edit:",i),Ot.showToast(`   : ${i.message}`,"error"),xy()}finally{Ot.hideLoading()}}async function kae(r){if(!(Ma!=null&&Ma.canEdit())){Ot.showToast(" evaluation    ","warning");return}const e=Vt.get("evaluations").find(i=>i.id===r);if(!e){Ot.showToast("   ","error");return}const t=Vt.get("tasks").find(i=>i.id===e.taskId),n=Vt.get("groups").find(i=>i.id===e.groupId);if(!t){Ot.showToast("     ","error");return}if(!n){Ot.showToast("     ","error");return}if(!t.maxScoreBreakdown||t.maxScoreBreakdown.mcq===void 0){Ot.showToast("          ","error",5e3);return}kA=t.maxScoreBreakdown;const s=Vt.get("students").filter(i=>i.groupId===e.groupId).sort((i,a)=>String(i.roll).localeCompare(String(a.roll),void 0,{numeric:!0}));if(s.length===0){Ot.showToast("     ","warning");return}ot.evaluationTaskSelect&&(ot.evaluationTaskSelect.value=e.taskId),ot.evaluationGroupSelect&&(ot.evaluationGroupSelect.value=e.groupId),await $M(r,t,n,s)}function Eae(r){if(!(Ma!=null&&Ma.canDelete())){Ot.showToast(" evaluation    ","warning");return}const e=Vt.get("evaluations").find(i=>i.id===r);if(!e){Ot.showToast("   ","error");return}const t=e.taskName||" ",n=e.groupName||" ",s=`   "${t}"   "${n}"     ?`;Ot.showDeleteModal(" ",s,async()=>{Ot.showLoading(" ...");try{await $d.deleteEvaluation(r),await i_.refreshAllData(),a_(),hA===r&&xy(),Ot.showToast("   ","success")}catch(i){Ot.showToast(` : ${i.message}`,"error")}finally{Ot.hideLoading()}})}function Iae(){if(!ot.dashboardConfigContainer)return;if(!(Ma==null?void 0:Ma.isSuperAdmin())){ot.dashboardConfigContainer.classList.add("hidden");return}ot.dashboardConfigContainer.classList.remove("hidden");const e=Vt.getDashboardConfig(),t=Vt.get("tasks")||[],n=Vt.get("classes")||[],s=Vt.get("sections")||[],i=Vt.get("subjects")||[],a=[],o=new Set;i.forEach(S=>{const B=S.name?S.name.trim():"";B&&!o.has(B)&&(o.add(B),a.push(S))});const l=[...t].sort((S,B)=>{const F=new Date(S.date||0);return new Date(B.date||0)-F}),c=e.isForced,A=e.forceAssignmentId;ot.dashboardConfigContainer.innerHTML=`
    <div class="card card-body mb-6 border-l-4 border-indigo-500">
      <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
        <div>
          <h3 class="text-lg font-semibold text-gray-800 dark:text-white">  </h3>
          <p class="text-sm text-gray-600 dark:text-gray-400">        </p>
        </div>
        <div class="flex items-center gap-3">
             <label class="inline-flex items-center cursor-pointer">
                <input type="checkbox" id="forceDashboardToggle" class="sr-only peer" ${c?"checked":""}>
                <div class="relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-indigo-300 dark:peer-focus:ring-indigo-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-indigo-600"></div>
                <span class="ms-3 text-sm font-medium text-gray-900 dark:text-gray-300"> </span>
            </label>
        </div>
      </div>
      
      <div id="forceConfigControls" class="mt-4 pt-4 border-t dark:border-gray-700 transition-all duration-300 ${c?"":"hidden opacity-50 pointer-events-none"}">
          
          <!-- Filters -->
          <div class="grid grid-cols-1 sm:grid-cols-3 gap-3 mb-3">
              <div>
                  <label class="block mb-1 text-xs font-medium text-gray-700 dark:text-gray-300"></label>
                  <select id="configClassFilter" class="form-select w-full text-sm py-1">
                      <option value=""> </option>
                      ${n.map(S=>`<option value="${S.id}">${S.name}</option>`).join("")}
                  </select>
              </div>
              <div>
                  <label class="block mb-1 text-xs font-medium text-gray-700 dark:text-gray-300"></label>
                  <select id="configSectionFilter" class="form-select w-full text-sm py-1">
                      <option value=""> </option>
                      ${s.map(S=>`<option value="${S.id}">${S.name}</option>`).join("")}
                  </select>
              </div>
              <div>
                  <label class="block mb-1 text-xs font-medium text-gray-700 dark:text-gray-300"></label>
                  <select id="configSubjectFilter" class="form-select w-full text-sm py-1">
                      <option value=""> </option>
                      ${a.map(S=>`<option value="${S.id}">${S.name}</option>`).join("")}
                  </select>
              </div>
          </div>

          <div class="flex flex-col sm:flex-row gap-3 items-end">
            <div class="w-full sm:w-1/2">
                <label for="forceAssignmentSelect" class="block mb-1 text-sm font-medium text-gray-700 dark:text-gray-300">  </label>
                <select id="forceAssignmentSelect" class="form-select w-full">
                    <option value="" disabled ${A?"":"selected"}>  ...</option>
                    ${l.map(S=>`<option value="${S.id}" ${S.id===A?"selected":""}>${S.name}</option>`).join("")}
                </select>
            </div>
            <button id="saveDashboardConfigBtn" class="btn btn-primary whitespace-nowrap">
                <i class="fas fa-save mr-2"></i>  
            </button>
          </div>
          <p class="text-xs text-amber-600 dark:text-amber-400 mt-2">
            <i class="fas fa-info-circle"></i>         
          </p>
      </div>
    </div>
  `;const d=ot.dashboardConfigContainer.querySelector("#forceDashboardToggle"),h=ot.dashboardConfigContainer.querySelector("#forceConfigControls"),u=ot.dashboardConfigContainer.querySelector("#saveDashboardConfigBtn"),p=ot.dashboardConfigContainer.querySelector("#forceAssignmentSelect"),f=ot.dashboardConfigContainer.querySelector("#configClassFilter"),g=ot.dashboardConfigContainer.querySelector("#configSectionFilter"),m=ot.dashboardConfigContainer.querySelector("#configSubjectFilter"),x=()=>{const S=f.value,B=g.value,F=m.value,N=l.filter(w=>{if(S&&w.classId!==S||B&&w.sectionId!==B)return!1;if(F){if(w.subjectId===F)return!0;const v=i.find(k=>k.id===F),I=i.find(k=>k.id===w.subjectId);return!!(v&&I&&v.name.trim()===I.name.trim())}return!0}),E=p.value;p.innerHTML='<option value="" disabled>  ...</option>'+N.map(w=>`<option value="${w.id}" ${w.id===E?"selected":""}>${w.name}</option>`).join(""),E&&N.find(w=>w.id===E)?p.value=E:p.value=""};if(f.addEventListener("change",x),g.addEventListener("change",x),m.addEventListener("change",x),A){const S=t.find(B=>B.id===A);if(S){if(S.classId&&(f.value=S.classId),S.sectionId&&(g.value=S.sectionId),S.subjectId)if(a.find(B=>B.id===S.subjectId))m.value=S.subjectId;else{const B=i.find(F=>F.id===S.subjectId);if(B){const F=a.find(N=>N.name.trim()===B.name.trim());F&&(m.value=F.id)}}x(),p.value=A}}d.addEventListener("change",async S=>{if(S.target.checked)h.classList.remove("hidden","opacity-50","pointer-events-none");else{h.classList.add("hidden","opacity-50","pointer-events-none");const F={isForced:!1,forceAssignmentId:null};Vt.setDashboardConfig(F);try{await $d.saveGlobalSettings({dashboardConfig:F}),Ot.showToast("     (Global)","info")}catch(N){console.error(N),Ot.showToast("    ","error")}}}),u.addEventListener("click",async()=>{const S=d.checked,B=p.value;if(S&&!B){Ot.showToast("     ","warning");return}const F={isForced:S,forceAssignmentId:B};Vt.setDashboardConfig(F);try{Ot.showLoading(" ..."),await $d.saveGlobalSettings({dashboardConfig:F}),Ot.showToast("    (Global)","success")}catch(N){console.error(N),Ot.showToast("   ","error")}finally{Ot.hideLoading()}})}let za,ws,bn,GM;const Dt={},fh={active:"students"},Zl={name:"",roll:""},Ft={rankedStudents:[],rankedGroups:[],groups:[],students:[],classes:[],sections:[],subjects:[]},ar={classId:"",sectionId:"",sectionId:"",subjectId:"",taskId:""},zM=1;function Tae(){if(document.getElementById("ranking-soft3d-styles"))return;const r=document.createElement("style");r.id="ranking-soft3d-styles",r.textContent=`
  /* ---------- Global soft page vibe ---------- */
  .rk-soft-page{
    --rk-page-start:#f8fafc;
    --rk-page-mid:#eef2ff;
    --rk-page-end:#ffffff;
    background: radial-gradient(120% 140% at 10% -10%, var(--rk-page-start) 0%, var(--rk-page-mid) 42%, var(--rk-page-end) 100%);
    background-attachment: fixed;
  }
  .dark .rk-soft-page{
    --rk-page-start:#0b1220; --rk-page-mid:#0f172a; --rk-page-end:#111827;
    background: radial-gradient(120% 140% at 10% -10%, var(--rk-page-start) 0%, var(--rk-page-mid) 52%, var(--rk-page-end) 100%);
    background-attachment: fixed;
  }

  .rk-surface{
    --rk-bg:#fff;
    border-radius: 1rem;
    background-color: var(--rk-bg);
    box-shadow:
      8px 8px 20px rgba(0,0,0,.08),
      -6px -6px 16px rgba(255,255,255,.70),
      inset 0 1px 0 rgba(255,255,255,.45);
  }
  .dark .rk-surface{
    --rk-bg: rgba(17,24,39,.92);
    box-shadow:
      10px 10px 26px rgba(0,0,0,.45),
      -6px -6px 14px rgba(255,255,255,.06),
      inset 0 1px 0 rgba(255,255,255,.08);
  }

  .rk-chip{
    border-radius: .65rem;
    background: rgba(255,255,255,.85);
    border: 1px solid rgba(0,0,0,.06);
    box-shadow: 0 1px 0 rgba(255,255,255,.60) inset, 0 2px 6px rgba(0,0,0,.06);
    color: var(--rk-chip-fg, var(--rk-card-fg, #0f172a));
    white-space: nowrap;
  }
  .dark .rk-chip{
    background: rgba(255,255,255,.06);
    border: 1px solid rgba(255,255,255,.08);
    --rk-chip-fg: #f8fafc;
    box-shadow: inset 0 1px 0 rgba(255,255,255,.08), 0 2px 6px rgba(0,0,0,.35);
  }

  .rk-card{
    --rk-card-bg: var(--rk-bg, #fff);
    position: relative;
    border-radius: .9rem;
    background: var(--rk-card-bg);
    color: var(--rk-card-fg, #0f172a);
    border: 1px solid rgba(0,0,0,.06);
    box-shadow:
      6px 6px 16px rgba(0,0,0,.08),
      -4px -4px 12px rgba(255,255,255,.70),
      inset 0 1px 0 rgba(255,255,255,.45);
    transition: transform .2s ease, box-shadow .2s ease, background .25s ease;
  }
  .rk-card:hover{ transform: translateY(-1px); }
  .dark .rk-card{
    --rk-card-bg: rgba(15,23,42,.92);
    --rk-card-fg: #e2e8f0;
    border-color: rgba(255,255,255,.08);
    box-shadow:
      10px 10px 24px rgba(0,0,0,.45),
      -6px -6px 14px rgba(255,255,255,.06),
      inset 0 1px 0 rgba(255,255,255,.08);
  }

  .ranking-card{
    background: var(--rk-card-bg, #fdfefe);
    color: var(--rk-card-fg, #0f172a);
  }
  .dark .ranking-card{
    --rk-card-bg: rgba(13,20,34,.92);
    --rk-card-fg: #e2e8f0;
    border-color: rgba(255,255,255,.08);
  }
  .ranking-card *{
    color: inherit;
  }

  /* Accent border + glow (driven by --rk-grad/--rk-accent/--rk-glow) */
  .rk-card[data-accent]{
    border: 1px solid transparent;
    background-image:
      linear-gradient(var(--rk-card-bg), var(--rk-card-bg)),
      var(--rk-grad, linear-gradient(90deg,#e5e7eb,#e5e7eb));
    background-origin: border-box;
    background-clip: padding-box, border-box;
  }
  .rk-card[data-accent]::after{
    content:""; position:absolute; inset:-6px; z-index:-1; border-radius:inherit;
    background: radial-gradient(60% 60% at 50% -10%, var(--rk-accent, #94a3b8) 0%, transparent 60%);
    filter: blur(16px); opacity:.18; pointer-events:none;
  }
  .dark .rk-card[data-accent]::after{ opacity:.28; }

  .rk-meter-outer{
    box-shadow: inset 0 1px 0 rgba(255,255,255,.6), 0 8px 18px var(--rk-glow, rgba(0,0,0,.10));
  }

  .rk-micro{ font-size: 11px; line-height: 1.1; }

  /* -------- Pretty, soft badges for Branch & Role -------- */
  .rk-badges{
    display: grid;
    grid-template-columns: repeat(2, minmax(0, 1fr)); /* mobile: 2 columns */
    gap: .35rem;
    margin-top: .45rem;

  }
  .rk-badge{
    display:inline-flex; align-items:center; justify-content:center; gap:.35rem;
    padding:.32rem .50rem; border-radius:.65rem;
    border:1px solid var(--rk-badge-border, rgba(0,0,0,.06));
    background: var(--rk-badge-bg, rgba(255,255,255,.85));
    color: var(--rk-badge-fg, #0f172a);
    font-weight:600; font-size:11px;
    box-shadow: 0 1px 0 rgba(255,255,255,.60) inset, 0 2px 6px var(--rk-badge-glow, rgba(0,0,0,.05));
    white-space: nowrap;
    min-width: 0;
    text-align: center;
  }
  .dark .rk-badge{
    border-color: var(--rk-badge-border-dark, rgba(255,255,255,.12));
    background: var(--rk-badge-bg-dark, rgba(255,255,255,.08));
    color: var(--rk-badge-fg-dark, #f8fafc);
    box-shadow: inset 0 1px 0 rgba(255,255,255,.10), 0 2px 8px var(--rk-badge-glow-dark, rgba(0,0,0,.45));
  }
  .rk-badge i{ font-size: 11px; }
  .rk-badge--compact{ padding:.28rem .45rem; font-size:10px; }

  @media (min-width: 640px){
    .rk-badges{ display:flex; flex-wrap:wrap; gap:.4rem; }
    .rk-badge{ padding:.46rem .66rem; font-size:12px; }
    .rk-badge i{ font-size:12px; }
  }

  /* -------- Tabs -------- */
  .rk-tabbar{
    display:flex; flex-wrap:wrap; gap:.6rem; align-items:center; justify-content:space-between;
    padding:.6rem; border-radius:.9rem;
    background: color-mix(in srgb, var(--rk-bg) 88%, transparent);
    backdrop-filter: blur(6px);
  }
  .rk-tabs{
    display:flex; gap:.4rem; align-items:center;
    padding:.25rem; border-radius:999px;
    background: linear-gradient(180deg, rgba(0,0,0,.03), rgba(0,0,0,0));
    border:1px solid rgba(0,0,0,.06);
    box-shadow: 0 1px 0 rgba(255,255,255,.5) inset;
  }
  .dark .rk-tabs{ border-color: rgba(255,255,255,.10); background: rgba(255,255,255,.04); }

  .rk-tab{
    position:relative; border:0; background:transparent; cursor:pointer;
    padding:.55rem .85rem; border-radius:999px; font-weight:600; font-size:14px;
    color: #0f172a;
  }
  .dark .rk-tab{ color:#e5e7eb; }

  .rk-tab[aria-selected="true"]{
    color:white;
    background: var(--rk-grad, linear-gradient(90deg,#0ea5e9,#7dd3fc));
    box-shadow: 0 6px 14px var(--rk-glow, rgba(14,165,233,.25));
  }

  .rk-tab-search{ display:flex; gap:.5rem; width:100%; max-width:560px; }
  .rk-input{
    flex:1 1 auto;
    padding:.55rem .75rem; border-radius:.7rem;
    border:1px solid rgba(0,0,0,.08);
    background: rgba(255,255,255,.85);
    color:#0f172a; font-size: 14px; outline: none;
  }
  .rk-input::placeholder{ color:#94a3b8; }
  .rk-input:focus{ border-color: rgba(14,165,233,.45); box-shadow: 0 0 0 3px rgba(14,165,233,.12); }
  .rk-input:disabled{ opacity:.55; cursor:not-allowed; }

  .dark .rk-input{ background: rgba(255,255,255,.06); border-color: rgba(255,255,255,.10); color:#e5e7eb; }
  .dark .rk-input:focus{ border-color: rgba(14,165,233,.55); box-shadow: 0 0 0 3px rgba(14,165,233,.22); }
  `,document.head.appendChild(r)}function Fae(){const r=document.body||document.documentElement;r&&!r.classList.contains("rk-soft-page")&&r.classList.add("rk-soft-page")}function Lae(r){return za=r.managers.stateManager,ws=r.managers.uiManager,r.services.dataService,bn=r.utils,GM=r.app,Tae(),Fae(),Mae(),Nae(),console.log(" Ranking component initialized."),{render:Uae}}function Uae(){var r;if(!Dt.page){console.error(" Ranking render failed: Page element not found.");return}console.log("Rendering Student Ranking page..."),ws.showLoading("   ...");try{let e,t,n,s,i,a;const o=za.get("currentUserData");if(o&&o.type==="teacher"){const h=za.get("students")||[],u=za.get("evaluations")||[],p=za.get("tasks")||[],f=za.get("groups")||[],g=za.get("currentTeacher"),m=(g==null?void 0:g.assignedClasses)||[],x=(g==null?void 0:g.assignedSections)||[],S=(g==null?void 0:g.assignedSubjects)||[],B=za.get("sections")||[],F=za.get("subjects")||[],N=za.get("classes")||[],E=new Set(F.filter(I=>S.includes(I.id)).map(I=>{var k;return(k=I.name)==null?void 0:k.trim()})),w=new Set(B.filter(I=>x.includes(I.id)).map(I=>{var k;return(k=I.name)==null?void 0:k.trim()}));n=p.filter(I=>{if(!I.subjectId)return!1;if(S.includes(I.subjectId))return!0;const k=F.find(_=>_.id===I.subjectId);return!!(k&&k.name&&E.has(k.name.trim()))}),e=h.filter(I=>{if(!m.includes(I.classId))return!1;if(x.length>0){if(x.includes(I.sectionId))return!0;const k=B.find(_=>_.id===I.sectionId);return!!(k&&k.name&&w.has(k.name.trim()))}return!0}),s=f.filter(I=>{if(!m.includes(I.classId))return!1;if(x.length>0){if(!I.sectionId||x.includes(I.sectionId))return!0;const k=B.find(_=>_.id===I.sectionId);return!!(k&&k.name&&w.has(k.name.trim()))}return!0});const v=new Set(n.map(I=>I.id));t=u.filter(I=>{if(!v.has(I.taskId))return!1;const k=f.find(_=>_.id===I.groupId);if(k){if(!m.includes(k.classId))return!1;if(x.length>0&&k.sectionId){if(x.includes(k.sectionId))return!0;const _=B.find(T=>T.id===k.sectionId);return!!(_&&_.name&&w.has(_.name.trim()))}}return!0}),i=N.filter(I=>m.includes(I.id)),a=B.filter(I=>x.length>0?!!(x.includes(I.id)||I.name&&w.has(I.name.trim())):!0),Ft.subjects=F.filter(I=>!!(S.includes(I.id)||I.name&&E.has(I.name.trim()))),o.assignedClassId&&(ar.classId=o.assignedClassId),o.assignedSectionId&&(ar.sectionId=o.assignedSectionId),o.assignedSubjectId&&(ar.subjectId=o.assignedSubjectId)}else{const h=za.getState();e=h.students,t=h.evaluations,n=h.tasks,s=h.groups,i=h.classes,a=h.sections,Ft.subjects=h.subjects||[]}if(!e||!t||!n){ws.displayEmptyMessage(Dt.studentRankingListContainer,"     ...");return}Ft.groups=s||[],Ft.students=e||[],Ft.evaluations=t||[],Ft.tasks=n||[],Ft.classes=i||[],Ft.sections=a||[],(!Dt.classFilter||!Dt.sectionFilter||!Dt.subjectFilter||!Dt.taskFilter)&&(Dt.classFilter=Dt.page.querySelector("#rankingClassFilter"),Dt.sectionFilter=Dt.page.querySelector("#rankingSectionFilter"),Dt.subjectFilter=Dt.page.querySelector("#rankingSubjectFilter"),Dt.taskFilter=Dt.page.querySelector("#rankingTaskFilter")),WM();const l=YM(t,n,e);let c=e||[];if(ar.classId&&(c=c.filter(h=>String(h.classId)===String(ar.classId))),ar.sectionId){const h=ar.sectionId,u=Ft.sections.find(f=>f.id===h),p=(r=u==null?void 0:u.name)==null?void 0:r.trim().toLowerCase();c=c.filter(f=>{var g;if(String(f.sectionId)===String(h))return!0;if(p&&f.sectionId){const m=Ft.sections.find(x=>x.id===f.sectionId);if(m&&((g=m.name)==null?void 0:g.trim().toLowerCase())===p)return!0}return!1})}const A=KM(c,l,n),d=qM(c,l,s||[]);Ft.rankedStudents=A,Ft.rankedGroups=d,Zl.name="",Zl.roll="",fh.active="students",Ap(A,d,s||[],c,i||[],a||[])}catch(e){console.error(" Error rendering student ranking:",e),ws.displayEmptyMessage(Dt.studentRankingListContainer,"     ")}finally{ws.hideLoading()}}function Mae(){Dt.page=document.getElementById("page-student-ranking"),Dt.page?(Dt.refreshRankingBtn=Dt.page.querySelector("#refreshRanking"),Dt.studentRankingListContainer=Dt.page.querySelector("#studentRankingList"),Dt.classFilter=Dt.page.querySelector("#rankingClassFilter"),Dt.sectionFilter=Dt.page.querySelector("#rankingSectionFilter"),Dt.subjectFilter=Dt.page.querySelector("#rankingSubjectFilter"),Dt.taskFilter=Dt.page.querySelector("#rankingTaskFilter")):console.error(" Ranking init failed: #page-student-ranking element not found!")}function Nae(){Dt.page&&(ws.addListener(Dt.refreshRankingBtn,"click",async()=>{ws.showLoading("   ...");try{await GM.refreshAllData()}catch(r){console.error(" Error refreshing ranking data:",r),ws.showToast("    ","error")}}),ws.addListener(Dt.page,"change",r=>{const e=r.target.id;(e==="rankingClassFilter"||e==="rankingSectionFilter"||e==="rankingSubjectFilter"||e==="rankingTaskFilter")&&(e==="rankingClassFilter"?(ar.classId=r.target.value==="all"?"":r.target.value,ar.sectionId="",ar.subjectId="",ar.taskId=""):e==="rankingSectionFilter"?(ar.sectionId=r.target.value==="all"?"":r.target.value,ar.taskId=""):e==="rankingSubjectFilter"?(ar.subjectId=r.target.value==="all"?"":r.target.value,ar.taskId=""):e==="rankingTaskFilter"&&(ar.taskId=r.target.value==="all"?"":r.target.value),Pae())}),ws.addListener(Dt.studentRankingListContainer,"click",r=>{const e=r.target.closest("[data-student-id]");if(e&&typeof window<"u"&&typeof window.openStudentModalById=="function"){const n=e.getAttribute("data-student-id");if(n){r.preventDefault();try{window.openStudentModalById(n)}catch{}return}}const t=r.target.closest("[data-group-id]");if(t&&typeof window<"u"&&typeof window.openGroupModalById=="function"){const n=t.getAttribute("data-group-id");if(n){r.preventDefault();try{window.openGroupModalById(n)}catch{}}}}))}function KM(r,e,t){if(!r||!e||!t)return[];const n={};e.forEach(i=>{const a=parseFloat(i.maxPossibleScore)||60,o=JM(i.taskDate||i.updatedAt||i.evaluationDate||i.createdAt),l=i.scores||{};Object.entries(l).forEach(([c,A])=>{n[c]||(n[c]={evalCount:0,totalScore:0,maxScoreSum:0,latestMs:null});const d=parseFloat(A.totalScore)||0,h=n[c];h.evalCount+=1,h.totalScore+=d,h.maxScoreSum+=a,o&&(h.latestMs=h.latestMs?Math.max(h.latestMs,o):o)})});const s=r.map(i=>{const a=n[i.id];if(!a||a.evalCount<zM)return null;const o=a.maxScoreSum>0?a.totalScore/a.maxScoreSum*100:0;return{student:i,evalCount:a.evalCount,totalScore:a.totalScore,maxScoreSum:a.maxScoreSum,efficiency:o,latestEvaluationMs:a.latestMs||null,rank:0}}).filter(Boolean).sort((i,a)=>a.efficiency!==i.efficiency?a.efficiency-i.efficiency:a.evalCount!==i.evalCount?a.evalCount-i.evalCount:a.totalScore!==i.totalScore?a.totalScore-i.totalScore:a.maxScoreSum!==i.maxScoreSum?a.maxScoreSum-i.maxScoreSum:(a.latestEvaluationMs||0)-(i.latestEvaluationMs||0));return s.forEach((i,a)=>i.rank=a+1),s}function qM(r,e,t){if(!r||!e)return[];const n=new Map((t||[]).map(l=>[l.id,l.name||""])),s=new Map((r||[]).map(l=>[l.id,l.groupId||"__none"])),i={};(r||[]).forEach(l=>{const c=l.groupId||"__none";i[c]=(i[c]||0)+1});const a={};e.forEach(l=>{const c=parseFloat(l.maxPossibleScore)||60,A=JM(l.taskDate||l.updatedAt||l.evaluationDate||l.createdAt),d=l.scores||{},h=new Set;Object.entries(d).forEach(([u,p])=>{const f=s.get(u)||"__none";a[f]||(a[f]={evalCount:0,totalScore:0,maxScoreSum:0,latestMs:null,participants:new Set});const g=parseFloat(p.totalScore)||0,m=a[f];h.has(f)||(m.evalCount+=1,h.add(f)),m.totalScore+=g,m.maxScoreSum+=c,m.participants.add(u),A&&(m.latestMs=m.latestMs?Math.max(m.latestMs,A):A)})});const o=Object.entries(a).map(([l,c])=>{if(c.evalCount<zM)return null;const A=c.maxScoreSum>0?c.totalScore/c.maxScoreSum*100:0,d=i[l]||0,h=c.participants.size,u=Math.max(0,d-h);return{groupId:l,groupName:n.get(l)||" ",evalCount:c.evalCount,totalScore:c.totalScore,maxScoreSum:c.maxScoreSum,efficiency:A,latestEvaluationMs:c.latestMs||null,participantsCount:h,groupSize:d,remainingCount:u,rank:0}}).filter(Boolean).sort((l,c)=>c.efficiency!==l.efficiency?c.efficiency-l.efficiency:c.evalCount!==l.evalCount?c.evalCount-l.evalCount:c.totalScore!==l.totalScore?c.totalScore-l.totalScore:c.maxScoreSum!==l.maxScoreSum?c.maxScoreSum-l.maxScoreSum:(c.latestEvaluationMs||0)-(l.latestEvaluationMs||0));return o.forEach((l,c)=>l.rank=c+1),o}function WM(){var r;if(Dt.classFilter&&Ft.classes){ws.populateSelect(Dt.classFilter,Ft.classes.map(t=>({value:t.id,text:t.name}))," "),Dt.classFilter.value=ar.classId||"all";const e=za.get("currentUserData");e&&e.type==="teacher"&&e.assignedClassId}if(Dt.sectionFilter&&Ft.sections){const e=[],t=new Set;Ft.sections.forEach(n=>{var i;const s=(i=n.name)==null?void 0:i.trim();s&&!t.has(s)&&(t.add(s),e.push(n))}),ws.populateSelect(Dt.sectionFilter,e.map(n=>({value:n.id,text:n.name}))," "),Dt.sectionFilter.value=ar.sectionId||"all"}if(Dt.subjectFilter&&Ft.subjects){const e=[],t=new Set;Ft.subjects.forEach(n=>{var i;const s=(i=n.name)==null?void 0:i.trim();s&&!t.has(s)&&(t.add(s),e.push(n))}),ws.populateSelect(Dt.subjectFilter,e.map(n=>({value:n.id,text:n.name}))," "),Dt.subjectFilter.value=ar.subjectId||"all"}if(Dt.taskFilter&&Ft.tasks){let e=Ft.tasks;if(ar.classId&&(e=e.filter(t=>t.classId===ar.classId)),ar.sectionId&&(e=e.filter(t=>!t.sectionId||t.sectionId===ar.sectionId)),ar.subjectId){const t=ar.subjectId,n=Ft.subjects.find(i=>i.id===t),s=(r=n==null?void 0:n.name)==null?void 0:r.trim().toLowerCase();e=e.filter(i=>{var a;if(i.subjectId===t)return!0;if(s&&i.subjectId){const o=Ft.subjects.find(l=>l.id===i.subjectId);if(o&&((a=o.name)==null?void 0:a.trim().toLowerCase())===s)return!0}return!1})}e.sort((t,n)=>new Date(n.date||0)-new Date(t.date||0)),ws.populateSelect(Dt.taskFilter,e.map(t=>({value:t.id,text:t.name}))," "),Dt.taskFilter.value=ar.taskId||"all"}}function YM(r,e,t){var s,i;let n=r;if(ar.subjectId){const a=ar.subjectId,o=Ft.subjects.find(A=>A.id===a),l=(s=o==null?void 0:o.name)==null?void 0:s.trim().toLowerCase(),c=new Map(e.map(A=>[A.id,A]));n=n.filter(A=>{var h;const d=c.get(A.taskId);if(!d)return!1;if(String(d.subjectId)===String(a))return!0;if(l&&d.subjectId){const u=Ft.subjects.find(p=>p.id===d.subjectId);if(u&&((h=u.name)==null?void 0:h.trim().toLowerCase())===l)return!0}return!1})}if(ar.classId||ar.sectionId){new Map(t.map(c=>[c.id,c]));const a=ar.sectionId,o=Ft.sections.find(c=>c.id===a),l=(i=o==null?void 0:o.name)==null?void 0:i.trim().toLowerCase();n=n.filter(c=>{var d;if(!c.scores)return!1;const A=e.find(h=>h.id===c.taskId);if(!A||ar.classId&&String(A.classId)!==String(ar.classId))return!1;if(ar.sectionId){if(String(A.sectionId)===String(a))return!0;if(l&&A.sectionId){const h=Ft.sections.find(u=>u.id===A.sectionId);if(h&&((d=h.name)==null?void 0:d.trim().toLowerCase())===l)return!0}return!A.sectionId}return!0})}return ar.taskId&&(n=n.filter(a=>a.taskId===ar.taskId)),n}function Pae(){ws.showLoading("   ..."),setTimeout(()=>{var s;WM();const r=YM(Ft.evaluations||[],Ft.tasks||[],Ft.students||[]);let e=Ft.students||[];if(ar.classId&&(e=e.filter(i=>String(i.classId)===String(ar.classId))),ar.sectionId){const i=ar.sectionId,a=Ft.sections.find(l=>l.id===i),o=(s=a==null?void 0:a.name)==null?void 0:s.trim().toLowerCase();e=e.filter(l=>{var c;if(String(l.sectionId)===String(i))return!0;if(o&&l.sectionId){const A=Ft.sections.find(d=>d.id===l.sectionId);if(A&&((c=A.name)==null?void 0:c.trim().toLowerCase())===o)return!0}return!1})}const t=KM(e,r,Ft.tasks||[]),n=qM(e,r,Ft.groups||[]);Ft.rankedStudents=t,Ft.rankedGroups=n,Ap(t,n,Ft.groups,e,Ft.classes,Ft.sections),ws.hideLoading()},50)}const Nn={currentPage:1,itemsPerPage:20,isLoading:!1,hasMore:!0,observer:null};function XM(){Nn.currentPage=1,Nn.isLoading=!1,Nn.hasMore=!0,Nn.observer&&(Nn.observer.disconnect(),Nn.observer=null)}function Ap(r,e,t,n,s,i,a={}){if(!Dt.studentRankingListContainer)return;const o=!!(a!=null&&a.onlyUpdateStudents),l=!!(a!=null&&a.append);!l&&!o&&XM();const c=fh.active==="students",A=c?Qae(r):e,d=0,h=Nn.currentPage*Nn.itemsPerPage,u=A.slice(d,h);Nn.hasMore=h<A.length;const p=new Map((t||[]).map(E=>[E.id,E.name])),f=new Map((s||[]).map(E=>[E.id,E.name])),g=new Map((i||[]).map(E=>[E.id,E.name])),m=E=>{const w=(Number(E)||0).toFixed(2);return bn!=null&&bn.convertToBanglaNumber?bn.convertToBanglaNumber(w):w},x=E=>{const w=`${Math.round(Number(E)||0)}`;return bn!=null&&bn.convertToBanglaNumber?bn.convertToBanglaNumber(w):w},S=E=>{const w=(E??"").toString();return bn!=null&&bn.convertToBanglaNumber?bn.convertToBanglaNumber(w):w},B=(E,w)=>{if(w==="student"){const v=E.student,I=ZE(E.rank),k=m(E.efficiency),_=x(E.evalCount),T=H0(E.efficiency),L=p.get(v.groupId)||" ",K=f.get(v.classId)||"",se=g.get(v.sectionId)||"";let X="";if(ar.subjectId){const O=Ft.subjects.find(H=>H.id===ar.subjectId);O&&(X=`<div class="rk-badge rk-badge--compact" style="--rk-badge-bg:rgba(99,102,241,0.1); --rk-badge-fg:#4f46e5; --rk-badge-border:rgba(99,102,241,0.2);">
                    <i class="fas fa-book"></i> ${O.name}
                    </div>`)}const $=`: ${S(v.roll||"")}  : ${K}  : ${se}  : ${ld(L)}`,V=$ae(v.academicGroup),he=Vae(v.role),z=YE(V,v.academicGroup||" "),M=YE(he,jae(v.role));return`
        <article class="ranking-card rk-card p-4 flex items-center gap-3 justify-between"
            data-student-id="${v.id}" data-accent
            style="--rk-accent:${T.solid}; --rk-grad:${T.grad}; --rk-glow:${T.shadow};">
            <div class="flex items-start gap-3 min-w-0">
            <div class="rk-chip px-3 py-2 text-center shrink-0">
                <div class="text-sm font-bold">${I}</div>
                <div class="rk-micro text-gray-500 dark:text-gray-400"></div>
            </div>
            <div class="min-w-0">
                <div class="flex items-center gap-2 min-w-0">
                <h4 class="font-semibold truncate" title="${Q0(v.name)}">${Q0(v.name)}</h4>
                </div>
                <p class="rk-micro mt-1 text-gray-600 dark:text-gray-300 truncate" title="${ld($)}">${$}</p>
                <div class="rk-badges">
                ${z}
                ${M}
                ${X}
                </div>
                <div class="flex gap-4 sm:gap-8 mt-2 text-[10px] sm:text-sm font-semibold">
                <div class="hidden sm:flex">: ${k}%</div>
                <div class=""> : ${_} </div>
                </div>
            </div>
            </div>
            <div class="flex flex-col items-center gap-1 shrink-0">
            ${JE(E.efficiency,T,XE())}
            <span class="rk-micro text-gray-500 dark:text-gray-400">Avg%</span>
            </div>
        </article>`}else{const v=E,I=ZE(v.rank),k=m(v.efficiency),_=x(v.evalCount),T=H0(v.efficiency),L=` : ${x(v.groupSize)}    : ${x(v.participantsCount)}   : ${x(v.remainingCount)}`;return`
        <article class="rk-card p-4 flex items-center gap-3 justify-between"
            data-accent${v.groupId&&v.groupId!=="__none"?` data-group-id="${ld(v.groupId)}"`:""} style="--rk-accent:${T.solid}; --rk-grad:${T.grad}; --rk-glow:${T.shadow};">
            <div class="flex items-start gap-3 min-w-0">
            <div class="rk-chip px-3 py-2 text-center shrink-0">
                <div class="text-sm font-bold">${I}</div>
                <div class="rk-micro text-gray-500 dark:text-gray-400"> </div>
            </div>
            <div class="min-w-0">
                <h4 class="font-semibold truncate" title="${Q0(v.groupName)}">${Q0(v.groupName)}</h4>
                <div class="mt-1 grid grid-cols-2 gap-2 text-[12px] font-semibold">
                <div class="rk-chip px-2 py-1">: ${k}%</div>
                <div class="rk-chip px-2 py-1"> : ${_} </div>
                </div>
                ${ar.subjectId?(()=>{const se=Ft.subjects.find(X=>X.id===ar.subjectId);return se?`<div class="mt-2 inline-flex items-center gap-1 px-2 py-1 rounded bg-indigo-50 dark:bg-indigo-900/30 text-indigo-700 dark:text-indigo-300 text-[10px] font-medium border border-indigo-100 dark:border-indigo-800"><i class="fas fa-book"></i> ${se.name}</div>`:""})():""}
                <p class="rk-micro mt-2 text-gray-600 dark:text-gray-300 truncate" title="${L}">${L}</p>
            </div>
            </div>
            <div class="flex flex-col items-center gap-1 shrink-0">
            ${JE(v.efficiency,T,XE())}
            <span class="rk-micro text-gray-500 dark:text-gray-400">Avg%</span>
            </div>
        </article>`}},F=u.length>0?u.map(E=>B(E,c?"student":"group")).join(""):'<div class="rk-card p-4 text-center text-gray-600 dark:text-gray-300">   </div>',N=Nn.hasMore?'<div id="ranking-sentinel" class="py-4 text-center text-gray-500 dark:text-gray-400"><i class="fas fa-spinner fa-spin"></i>   ...</div>':"";if(o){const E=Dt.studentRankingListContainer.querySelector("[data-student-cards]");E&&(E.innerHTML=F+N,Nn.hasMore&&pv());return}if(l){const E=Dt.studentRankingListContainer.querySelector(c?"[data-student-cards]":"[data-group-cards]");if(E){const w=E.querySelector("#ranking-sentinel");w&&w.remove();const v=(Nn.currentPage-1)*Nn.itemsPerPage,k=A.slice(v,h).map(_=>B(_,c?"student":"group")).join("");E.insertAdjacentHTML("beforeend",k+N),Nn.hasMore&&pv()}}else{const E=H0(c?r&&r[0]?r[0].efficiency:70:e&&e[0]?e[0].efficiency:70),w=!c,v=ld(Zl.name),I=ld(Zl.roll),k=`
        <div class="rk-tabbar rk-surface" style="--rk-accent:${E.solid}; --rk-grad:${E.grad}; --rk-glow:${E.shadow};">
        <div class="rk-tabs">
            <button class="rk-tab" data-tab="students" aria-selected="${c}"> </button>
            <button class="rk-tab" data-tab="groups" aria-selected="${!c}"> </button>
        </div>
        <div class="rk-tab-search">
            <input id="studentSearchName" type="text" class="rk-input" placeholder="  "
            value="${v}" ${w?"disabled":""} />
            <input id="studentSearchRoll" type="text" inputmode="numeric" autocomplete="off"
            class="rk-input" placeholder=" ()" value="${I}" ${w?"disabled":""} />
        </div>
        </div>
      `,_=c?`<div class="grid gap-4 grid-cols-1" data-student-cards>${F}${N}</div>`:`<div class="grid gap-4 grid-cols-1" data-group-cards>${F}${N}</div>`;ws.clearContainer(Dt.studentRankingListContainer),Dt.studentRankingListContainer.innerHTML=`
        <div class="space-y-4" style="--rk-accent:${E.solid}; --rk-grad:${E.grad}; --rk-glow:${E.shadow};">
        ${k}
        ${_}
        </div>
      `,Dae(),Rae(),Nn.hasMore&&pv()}}function pv(){Nn.observer&&Nn.observer.disconnect();const r={root:null,rootMargin:"100px",threshold:.1};Nn.observer=new IntersectionObserver(t=>{t.forEach(n=>{n.isIntersecting&&Nn.hasMore&&!Nn.isLoading&&(Nn.isLoading=!0,Nn.currentPage++,Ap(Ft.rankedStudents,Ft.rankedGroups,Ft.groups,Ft.students,Ft.classes,Ft.sections,{append:!0}),Nn.isLoading=!1)})},r);const e=document.getElementById("ranking-sentinel");e&&Nn.observer.observe(e)}function Dae(){if(!Dt.studentRankingListContainer)return;const r=Dt.studentRankingListContainer;Array.from(r.querySelectorAll(".rk-tab")).forEach(t=>{ws.addListener(t,"click",()=>{const n=t.getAttribute("data-tab");!n||n!=="students"&&n!=="groups"||fh.active!==n&&(fh.active=n,Ap(Ft.rankedStudents,Ft.rankedGroups,Ft.groups,Ft.students,Ft.classes,Ft.sections,{onlyUpdateStudents:!1}))})})}function KE(r,e){let t;return function(...n){const s=this;clearTimeout(t),t=setTimeout(()=>r.apply(s,n),e)}}function Rae(){if(!Dt.studentRankingListContainer)return;const r=Dt.studentRankingListContainer.querySelector("#studentSearchName"),e=Dt.studentRankingListContainer.querySelector("#studentSearchRoll"),t=fh.active==="students",n=KE(i=>qE("name",i),300),s=KE(i=>qE("roll",i),300);r&&(Dt.studentSearchNameInput=r,r.disabled=!t,ws.addListener(r,"input",i=>{t&&n(i.target.value||"")})),e&&(Dt.studentSearchRollInput=e,e.disabled=!t,ws.addListener(e,"input",i=>{t&&s(i.target.value||"")}))}function qE(r,e){if(!Object.prototype.hasOwnProperty.call(Zl,r))return;const t=typeof e=="string"?e:(e==null?void 0:e.toString())||"";Zl[r]!==t&&(Zl[r]=t,Oae())}function Oae(){fh.active==="students"&&(!Ft.rankedStudents||Ft.rankedStudents.length===0||(XM(),Ap(Ft.rankedStudents,Ft.rankedGroups,Ft.groups,Ft.students,Ft.classes,Ft.sections,{onlyUpdateStudents:!0})))}function Qae(r=[]){const e=(Zl.name||"").trim().toLowerCase(),t=WE(Zl.roll);return!e&&!t?r:r.filter(n=>{if(!(n!=null&&n.student))return!1;const s=n.student;if(e&&!(s.name||"").toString().toLowerCase().includes(e))return!1;if(t){const i=WE(s.roll);if(!i||i!==t)return!1}return!0})}const Hae={"":"0","":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9"};function WE(r){return r==null?"":r.toString().trim().replace(/\s+/g,"").replace(/[-]/g,e=>Hae[e]||e)}function Q0(r){if(r==null)return"";const e=bn!=null&&bn.ensureBengaliText&&typeof bn.ensureBengaliText=="function"?bn.ensureBengaliText(r):String(r);return ld(e.trim())}function ld(r){return String(r).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function H0(r){const e=Number(r)||0;return e>=85?{name:"green",solid:"#16a34a",shadow:"rgba(22,163,74,.35)",grad:"linear-gradient(90deg,#16a34a 0%,#22c55e 40%,#86efac 100%)"}:e>=70?{name:"sky",solid:"#0284c7",shadow:"rgba(2,132,199,.30)",grad:"linear-gradient(90deg,#0284c7 0%,#0ea5e9 40%,#7dd3fc 100%)"}:e>=55?{name:"amber",solid:"#d97706",shadow:"rgba(217,119,6,.35)",grad:"linear-gradient(90deg,#d97706 0%,#f59e0b 40%,#facc15 100%)"}:{name:"rose",solid:"#e11d48",shadow:"rgba(225,29,72,.40)",grad:"linear-gradient(90deg,#e11d48 0%,#f43f5e 40%,#fb7185 100%)"}}function jae(r){const e={"team-leader":" ","time-keeper":" ",reporter:"","resource-manager":" ","peace-maker":" "},t=(r||"").toString().trim();return e[t]||t||" "}function Vae(r){const e=(r||"").toString().trim(),t={"team-leader":{icon:"fa-crown",bg:"rgba(251, 191, 36, .18)",fg:"#92400e",border:"rgba(245, 158, 11, .35)",glow:"rgba(251, 191, 36, .28)",darkBg:"rgba(245, 158, 11, .22)",darkFg:"#fde68a",darkBorder:"rgba(251, 191, 36, .45)",darkGlow:"rgba(251, 191, 36, .38)"},"time-keeper":{icon:"fa-stopwatch",bg:"rgba(56, 189, 248, .16)",fg:"#0c4a6e",border:"rgba(59, 130, 246, .35)",glow:"rgba(56, 189, 248, .26)",darkBg:"rgba(56, 189, 248, .22)",darkFg:"#e0f2fe",darkBorder:"rgba(56, 189, 248, .48)",darkGlow:"rgba(14, 165, 233, .35)"},reporter:{icon:"fa-pen-nib",bg:"rgba(196, 181, 253, .18)",fg:"#4c1d95",border:"rgba(167, 139, 250, .35)",glow:"rgba(196, 181, 253, .26)",darkBg:"rgba(167, 139, 250, .24)",darkFg:"#ede9fe",darkBorder:"rgba(196, 181, 253, .48)",darkGlow:"rgba(139, 92, 246, .35)"},"resource-manager":{icon:"fa-box-open",bg:"rgba(134, 239, 172, .18)",fg:"#065f46",border:"rgba(16, 185, 129, .35)",glow:"rgba(134, 239, 172, .26)",darkBg:"rgba(16, 185, 129, .22)",darkFg:"#d1fae5",darkBorder:"rgba(16, 185, 129, .45)",darkGlow:"rgba(5, 150, 105, .32)"},"peace-maker":{icon:"fa-dove",bg:"rgba(253, 164, 175, .18)",fg:"#7f1d1d",border:"rgba(244, 63, 94, .35)",glow:"rgba(253, 164, 175, .28)",darkBg:"rgba(244, 63, 94, .22)",darkFg:"#ffe4e6",darkBorder:"rgba(244, 63, 94, .45)",darkGlow:"rgba(244, 63, 94, .34)"}},n={icon:"fa-id-badge",bg:"rgba(226, 232, 240, .22)",fg:"#111827",border:"rgba(148,163,184,.35)",glow:"rgba(148,163,184,.20)",darkBg:"rgba(148,163,184,.20)",darkFg:"#e2e8f0",darkBorder:"rgba(148,163,184,.45)",darkGlow:"rgba(148,163,184,.30)"};return t[e]||n}function $ae(r){const e=(r||"").toString().trim().toLowerCase(),t=/science|/.test(e),n=/arts|/.test(e),s=/commerce||/.test(e),i=/vocational|/.test(e);return t?{icon:"fa-atom",bg:"rgba(153, 246, 228, .18)",fg:"#115e59",border:"rgba(45, 212, 191, .35)",glow:"rgba(94, 234, 212, .26)",darkBg:"rgba(45, 212, 191, .22)",darkFg:"#ccfbf1",darkBorder:"rgba(94, 234, 212, .48)",darkGlow:"rgba(20, 184, 166, .32)"}:n?{icon:"fa-palette",bg:"rgba(254, 215, 170, .20)",fg:"#7c2d12",border:"rgba(251, 146, 60, .35)",glow:"rgba(254, 215, 170, .28)",darkBg:"rgba(251, 146, 60, .24)",darkFg:"#ffedd5",darkBorder:"rgba(251, 146, 60, .48)",darkGlow:"rgba(249, 115, 22, .32)"}:s?{icon:"fa-chart-line",bg:"rgba(191, 219, 254, .20)",fg:"#1e3a8a",border:"rgba(99, 102, 241, .35)",glow:"rgba(191, 219, 254, .28)",darkBg:"rgba(99, 102, 241, .24)",darkFg:"#e0e7ff",darkBorder:"rgba(99, 102, 241, .48)",darkGlow:"rgba(79, 70, 229, .32)"}:i?{icon:"fa-tools",bg:"rgba(165, 243, 252, .20)",fg:"#164e63",border:"rgba(34, 211, 238, .35)",glow:"rgba(165, 243, 252, .28)",darkBg:"rgba(34, 211, 238, .22)",darkFg:"#cffafe",darkBorder:"rgba(34, 211, 238, .48)",darkGlow:"rgba(14, 165, 233, .32)"}:{icon:"fa-layer-group",bg:"rgba(241, 245, 249, .22)",fg:"#0f172a",border:"rgba(148,163,184,.35)",glow:"rgba(148,163,184,.18)",darkBg:"rgba(148,163,184,.20)",darkFg:"#e2e8f0",darkBorder:"rgba(148,163,184,.45)",darkGlow:"rgba(148,163,184,.28)"}}function YE(r,e){const t=ld(e||""),n=(r==null?void 0:r.bg)||"rgba(255,255,255,.85)",s=(r==null?void 0:r.fg)||"#0f172a",i=(r==null?void 0:r.border)||"rgba(0,0,0,.06)",a=(r==null?void 0:r.glow)||"rgba(0,0,0,.05)",o=(r==null?void 0:r.darkBg)||n,l=(r==null?void 0:r.darkFg)||s,c=(r==null?void 0:r.darkBorder)||i,A=(r==null?void 0:r.darkGlow)||a;return`<span class="rk-badge rk-badge--compact"
    style="--rk-badge-bg:${n};
           --rk-badge-fg:${s};
           --rk-badge-border:${i};
           --rk-badge-glow:${a};
           --rk-badge-bg-dark:${o};
           --rk-badge-fg-dark:${l};
           --rk-badge-border-dark:${c};
           --rk-badge-glow-dark:${A};">
           <i class="fas ${(r==null?void 0:r.icon)||"fa-circle"}"></i>${t}
  </span>`}function XE(){try{return typeof window<"u"&&window.matchMedia("(max-width: 480px)").matches?64:72}catch{return 72}}function JE(r,e,t=72){const n=Math.max(0,Math.min(100,Number(r)||0)),s=bn!=null&&bn.convertToBanglaNumber?bn.convertToBanglaNumber(n.toFixed(2)):n.toFixed(2),i=typeof t=="number"?t:72;return`
    <div class="relative flex items-center justify-center" style="width:${i}px;height:${i}px;">
      <div class="absolute inset-0 rounded-full"
           style="background: conic-gradient(${e.solid} ${n}%,
                                             rgba(0,0,0,0.08) ${n}% 100%);
                  filter: drop-shadow(0 6px 16px ${e.shadow});">
      </div>
      <div class="rk-meter-outer absolute inset-[18%] rounded-full bg-white dark:bg-gray-900 flex items-center justify-center">
        <span class="text-sm font-semibold text-gray-800 dark:text-gray-100">${s}%</span>
      </div>
    </div>
  `}function ZE(r){const e=Number(r)||0,t={1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",10:""};if(t[e])return`${t[e]} `;const n=`${e}`;return`${bn!=null&&bn.convertToBanglaNumber?bn.convertToBanglaNumber(n):n} `}function JM(r){if(!r)return null;if(r instanceof Date)return r.getTime();if(typeof r=="number")return r;if(typeof r=="string"){const e=Date.parse(r);return Number.isNaN(e)?null:e}if(typeof r=="object"){if(typeof r.toDate=="function")try{return r.toDate().getTime()}catch{return null}if(typeof r.seconds=="number")return r.seconds*1e3}return null}let As,zn,En;const EA="analysis",Gae=100,or={summaryPage:null,summaryContent:null,summaryFilterGroup:null,graphPage:null,graphFiltersContainer:null,graphDashboardContainer:null,graphDetailContainer:null,printableArea:null},kd={TABLE:"table",CHART:"chart"},pd={TABLE:"table",CHART:"chart"},zae={"team-leader":" ","time-keeper":" ",reporter:"","resource-manager":" ","peace-maker":" "},Ed={topic:{topic_learned_well:{id:"topic_learned_well",label:"  ",marks:10},topic_understood:{id:"topic_understood",label:" ",marks:5},topic_none:{id:"topic_none",label:"    ",marks:-5}},options:{attendance_regular:{id:"attendance_regular",label:"  ",marks:10},homework_done:{id:"homework_done",label:"   ",marks:5}}},Pu={FULL_POSITIVE:{id:"full_positive",label:"  "},IMPROVEMENT_NEEDED:{id:"improvement_needed",label:" "}},o_=(()=>{const r=new Map;return Object.values(Ed.topic).forEach(e=>{r.set(e.id,{...e,category:"topic",categoryLabel:" "})}),Object.values(Ed.options).forEach(e=>{r.set(e.id,{...e,category:"options",categoryLabel:" "})}),r.set(Pu.FULL_POSITIVE.id,{...Pu.FULL_POSITIVE,category:"summary",categoryLabel:" "}),r.set(Pu.IMPROVEMENT_NEEDED.id,{...Pu.IMPROVEMENT_NEEDED,category:"summary",categoryLabel:" "}),r})();let Ju=null,Rl=null,md=null,ZM=null,go=null;function Kae(){try{return document.documentElement.classList.contains("dark")}catch{return!1}}function l_(){const r=Kae();return{tick:r?"#e5e7eb":"#334155",grid:r?"rgba(148,163,184,0.25)":"rgba(148,163,184,0.2)",legend:r?"#f1f5f9":"#1f2937",tooltipTitle:r?"#e5e7eb":"#111827",tooltipBody:r?"#e5e7eb":"#111827",tooltipBg:r?"rgba(17,24,39,0.9)":"rgba(255,255,255,0.95)",border:r?"#334155":"#e5e7eb"}}function qae(r){return As=r.managers.stateManager,zn=r.managers.uiManager,En=r.utils,Wae(),c_(),Yae(),lx(),window.smartEvaluator||(window.smartEvaluator={}),window.smartEvaluator.components=window.smartEvaluator.components||{},window.smartEvaluator.components.analysis={render:lx,generateGroupAnalysisPDF:Ax,generateSelectedGroupPDF:dx,generateGroupWiseFullDetailsPDF:tI,printGroupAnalysis:ux},{renderSummary:eN,renderGraphs:tN,generateGroupAnalysisPDF:Ax,generateSelectedGroupPDF:dx,generateGroupWiseFullDetailsPDF:tI,printGroupAnalysis:ux}}function Wae(){or.summaryPage=document.getElementById("page-group-analysis"),or.summaryContent=document.getElementById("groupAnalysisDetails"),or.summaryFilterGroup=document.getElementById("analysisGroupSelect"),or.printableArea=document.getElementById("printableAnalysisArea"),or.graphPage=document.getElementById("page-graph-analysis"),or.graphFiltersContainer=document.getElementById("graphAnalysisContent")}function Yae(){or.summaryFilterGroup&&zn.addListener(or.summaryFilterGroup,"change",r=>{Dc({groupFilter:r.target.value})}),or.summaryContent&&zn.addListener(or.summaryContent,"click",r=>{const e=r.target.closest("[data-summary-action]");if(e){switch(r.preventDefault(),e.dataset.summaryAction){case"print":ux();break;case"pdf-all":Ax();break;case"pdf-group":e.disabled||dx();break}return}const t=r.target.closest("[data-summary-eval-view]");if(t){r.preventDefault();const n=t.dataset.analysisValue;n&&Dc({summaryEvaluationView:n})}}),or.graphFiltersContainer&&(zn.addListener(or.graphFiltersContainer,"click",r=>{const e=r.target.closest("[data-analysis-evaluation]");if(e){const s=e.dataset.analysisValue;Dc({evaluationType:s});return}const t=r.target.closest("[data-analysis-view]");if(t){const s=t.dataset.analysisValue;Dc({viewMode:s});return}const n=r.target.closest("[data-analysis-criteria-view]");if(n){const s=n.dataset.analysisValue;Dc({criteriaView:s})}}),zn.addListener(or.graphFiltersContainer,"change",r=>{switch(r.target.id){case"analysisGraphGroupSelect":Dc({groupFilter:r.target.value});break;case"analysisGraphTaskSelect":Dc({taskFilter:r.target.value});break;case"analysisFullCriteriaToggle":Dc({showFullOnly:r.target.checked});break}})),or.graphPage&&zn.addListener(or.graphPage,"click",r=>{const e=r.target.closest("[data-criteria-id]");if(e&&or.graphDashboardContainer){const t=e.dataset.criteriaId;if(!t||t===go)return;go=t,iN(),aN()}})}function c_(){const r=A_(As.getFilterSection(EA));return As.updateFilters(EA,r),r}function A_(r){const e=r&&typeof r=="object"?r:{};return{groupFilter:e.groupFilter??"all",taskFilter:e.taskFilter??"all",evaluationType:e.evaluationType??"all",viewMode:e.viewMode??kd.TABLE,showFullOnly:!!e.showFullOnly,criteriaView:e.criteriaView??"topic",summaryEvaluationView:e.summaryEvaluationView??pd.TABLE}}function lx(){const r=As.getFilterSection(EA),e=dp(r);try{eN(r,e)}catch(t){console.error(" Failed to render summary section:",t),or.summaryContent&&(or.summaryContent.innerHTML='<div class="card card-body text-rose-600 dark:text-rose-300 p-4">,     </div>')}try{tN(r,e)}catch(t){console.error(" Failed to render graph section:",t),or.graphFiltersContainer&&(or.graphFiltersContainer.innerHTML+='<div class="card card-body text-rose-600 dark:text-rose-300 p-4 mt-4">,     </div>')}}function Dc(r){const t={...{...As.getFilterSection(EA)||{}},...r};As.updateFilters(EA,t),lx()}function eN(r,e){if(!or.summaryPage||!or.summaryContent)return;let t=r;!t||typeof t!="object"?t=c_():t=A_(t);let n=e;if(!n)try{n=dp(t)}catch{n=null}Xae(t,n),Jae(t,n)}function Xae(r,e){if(!or.summaryFilterGroup)return;const t=e&&e.options&&Array.isArray(e.options.groups)?e.options.groups:[],n=r&&r.groupFilter?r.groupFilter:"all";or.summaryFilterGroup.innerHTML=['<option value="all"> </option>',...t.map(s=>`<option value="${s.id}" ${s.id===n?"selected":""}>${s.label}</option>`)].join(""),or.summaryFilterGroup.value=n}function Jae(r,e){if(!or.summaryContent)return;const{groupMetrics:t,summary:n}=e,s=e.groupDetails||new Map,i=r.groupFilter,a=r.summaryEvaluationView||pd.TABLE,o=i&&i!=="all",l=o?s.get(i):null;if(!o||!l){const p=eI(!1),f=lN(n),g=cN(t,r);or.summaryContent.innerHTML=`
      <div class="space-y-6" id="printableAnalysisArea">
        ${p}
        ${f}
        ${g}
      </div>
    `,cx();return}const c=eI(!0),A=Zae(l),d=eoe(l.metric),h=toe(l.members),u=roe(l.evaluations,a);or.summaryContent.innerHTML=`
    <div class="space-y-6" id="printableAnalysisArea">
      ${c}
      ${A}
      ${d}
      ${h}
      ${u}
    </div>
  `,a===pd.CHART?soe(l.evaluations):cx()}function eI(r){const e="inline-flex items-center gap-2 rounded-lg bg-blue-600 text-white px-4 py-2 shadow transition hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500",t="inline-flex items-center gap-2 rounded-lg border border-gray-200 dark:border-gray-700 px-4 py-2 text-gray-800 dark:text-gray-100 bg-white dark:bg-gray-900 hover:bg-gray-100 dark:hover:bg-gray-800 transition focus:outline-none focus:ring-2 focus:ring-blue-500";return`
    <div class="flex flex-wrap items-center justify-end gap-2">
      <button type="button" class="${t}" data-summary-action="print">
        <i class="fas fa-print"></i>
        Print
      </button>
      <button type="button" class="${t}" data-summary-action="pdf-all">
        <i class="fas fa-file-pdf"></i>
        Export PDF
      </button>
      <button type="button" class="${e}${r?"":" opacity-60 cursor-not-allowed"}" data-summary-action="pdf-group" ${r?"":"disabled"}>
        <i class="fas fa-download"></i>
        Selected Group PDF
      </button>
    </div>
  `}function Zae(r){var o,l,c;if(!r)return"";const e=r.metric||{},t=e.groupName||"Group",n=Or(e.studentCount||0),s=xo(e.participationRate||0),i=((l=(o=r.evaluations)==null?void 0:o[0])==null?void 0:l.dateLabel)||"-",a=(c=r.group)!=null&&c.mentor?yn(r.group.mentor):"";return`
    <div class="card card-body flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 bg-white dark:bg-gray-900 border border-gray-100 dark:border-gray-700">
      <div>
        <h2 class="text-2xl font-semibold text-gray-900 dark:text-gray-50">${t}</h2>
        <p class="text-sm text-gray-700 dark:text-gray-300">: ${n}  : ${s}</p>
        ${a?`<p class="text-sm text-gray-700 dark:text-gray-300">: ${a}</p>`:""}
      </div>
      <div class="text-sm text-gray-700 dark:text-gray-300"> : ${i}</div>
    </div>
  `}function eoe(r){return r?`
    <div class="grid gap-4 md:grid-cols-2 xl:grid-cols-4">
      ${rA(" ",r.evaluationCount,"bg-blue-50 text-blue-800 dark:bg-gray-800/80 dark:text-white","fa-clipboard-check")}
      ${rA("   (%)",xo(r.averageScore),"bg-emerald-50 text-emerald-800 dark:bg-gray-800/80 dark:text-white","fa-gauge")}
      ${rA(" ",xo(r.participationRate),"bg-indigo-50 text-indigo-800 dark:bg-gray-800/80 dark:text-white","fa-people-group")}
      ${rA(" ",Or(r.pendingStudents),"bg-amber-50 text-amber-800 dark:bg-gray-800/80 dark:text-white","fa-user-clock")}
    </div>
  `:""}function toe(r){return!Array.isArray(r)||!r.length?`
      <div class="card card-body bg-white dark:bg-gray-900 border border-gray-100 dark:border-gray-700">
        <div class="placeholder-content text-gray-800 dark:text-gray-200">
          <i class="fas fa-user-group mr-2"></i>
                  
        </div>
      </div>
    `:`
    <div class="card bg-white dark:bg-gray-900 border border-gray-100 dark:border-gray-700">
      <div class="card-header flex items-center justify-between">
        <h3 class="text-lg font-semibold text-gray-900 dark:text-gray-50">  </h3>
      </div>
      <div class="card-body overflow-x-auto">
        <table class="min-w-full text-sm divide-y divide-gray-200 dark:divide-gray-700">
          <thead class="bg-gray-50 dark:bg-gray-800">
            <tr>
              <th class="px-4 py-3 text-left font-semibold uppercase text-gray-700 dark:text-gray-300"> </th>
              <th class="px-4 py-3 text-left font-semibold uppercase text-gray-700 dark:text-gray-300"></th>
              <th class="px-4 py-3 text-left font-semibold uppercase text-gray-700 dark:text-gray-300"> </th>
              <th class="px-4 py-3 text-center font-semibold uppercase text-gray-700 dark:text-gray-300"> </th>
              <th class="px-4 py-3 text-center font-semibold uppercase text-gray-700 dark:text-gray-300"> </th>
              <th class="px-4 py-3 text-center font-semibold uppercase text-gray-700 dark:text-gray-300"> </th>
              <th class="px-4 py-3 text-left font-semibold uppercase text-gray-700 dark:text-gray-300"></th>
              <th class="px-4 py-3 text-center font-semibold uppercase text-gray-700 dark:text-gray-300"> </th>
            </tr>
          </thead>
          <tbody class="divide-y divide-gray-100 dark:divide-gray-800">
            ${r.map(t=>{const n=t.evaluationCount>0,s=n?Zo(t.avgTaskScore):"-",i=n?Zo(t.avgTeamScore):"-",a=n?Zo(t.avgProgressScore):"-",o=n?Zo(t.avgTotalScore):"-",l=t.latestComment?yn(t.latestComment):"-",c=ioe(t.role),A=Or(t.evaluationCount||0);return`
        <tr class="border-b border-gray-100 dark:border-gray-800 hover:bg-gray-50/70 dark:hover:bg-gray-800/50 transition">
          <td class="px-4 py-3">
            <div class="font-semibold text-gray-900 dark:text-gray-100">${t.name}</div>
            <div class="mt-1 flex flex-wrap items-center gap-2 text-xs text-gray-700 dark:text-gray-300">
              <span>: ${A}</span>
              ${c?`<span class="inline-flex items-center rounded-full bg-blue-100 text-blue-800 dark:bg-blue-900/40 dark:text-blue-100 px-2 py-0.5">${c}</span>`:""}
            </div>
          </td>
          <td class="px-4 py-3 text-gray-800 dark:text-gray-200">${t.roll?yn(t.roll):"-"}</td>
          <td class="px-4 py-3 text-gray-800 dark:text-gray-200">${t.academicGroup||"-"}</td>
          <td class="px-4 py-3 text-center text-gray-900 dark:text-gray-100">${i}</td>
          <td class="px-4 py-3 text-center text-gray-900 dark:text-gray-100">${s}</td>
          <td class="px-4 py-3 text-center text-gray-900 dark:text-gray-100">${a}</td>
          <td class="px-4 py-3 text-sm text-gray-800 dark:text-gray-200">${l}</td>
          <td class="px-4 py-3 text-center font-semibold text-indigo-700 dark:text-indigo-300">${o}</td>
        </tr>
      `}).join("")}
          </tbody>
        </table>
      </div>
    </div>
  `}function roe(r,e){if(!(Array.isArray(r)&&r.length>0))return`
      <div class="card card-body bg-white dark:bg-gray-900 border border-gray-100 dark:border-gray-700">
        <div class="placeholder-content text-gray-800 dark:text-gray-200">
          <i class="fas fa-chart-bar mr-2"></i>
                 
        </div>
      </div>
    `;const n=[pd.TABLE,pd.CHART].map(i=>Em(i,i===pd.TABLE?" ":"  ",e===i,"data-summary-eval-view")).join(""),s=e===pd.CHART?'<div class="h-80"><canvas id="summaryEvaluationChart"></canvas></div>':noe(r);return`
    <div class="card bg-white dark:bg-gray-900 border border-gray-100 dark:border-gray-700">
      <div class="card-header flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2">
        <h3 class="text-lg font-semibold text-gray-900 dark:text-gray-50">  </h3>
        <div class="flex flex-wrap gap-2">${n}</div>
      </div>
      <div class="card-body space-y-4">
        ${s}
      </div>
    </div>
  `}function noe(r){return`
    <div class="overflow-x-auto">
      <table class="min-w-full text-sm divide-y divide-gray-200 dark:divide-gray-700">
        <thead class="bg-gray-50 dark:bg-gray-800">
          <tr>
            <th class="px-4 py-3 text-left font-semibold uppercase text-gray-700 dark:text-gray-300"></th>
            <th class="px-4 py-3 text-left font-semibold uppercase text-gray-700 dark:text-gray-300"></th>
            <th class="px-4 py-3 text-center font-semibold uppercase text-gray-700 dark:text-gray-300"></th>
            <th class="px-4 py-3 text-center font-semibold uppercase text-gray-700 dark:text-gray-300"> </th>
            <th class="px-4 py-3 text-center font-semibold uppercase text-gray-700 dark:text-gray-300"> </th>
            <th class="px-4 py-3 text-center font-semibold uppercase text-gray-700 dark:text-gray-300"> </th>
            <th class="px-4 py-3 text-center font-semibold uppercase text-gray-700 dark:text-gray-300"> </th>
            <th class="px-4 py-3 text-center font-semibold uppercase text-gray-700 dark:text-gray-300"> %</th>
          </tr>
        </thead>
        <tbody class="divide-y divide-gray-100 dark:divide-gray-800">
          ${r.map(t=>{const n=t.assessedCount+t.pendingCount;return`
        <tr class="border-b border-gray-100 dark:border-gray-800 hover:bg-gray-50/70 dark:hover:bg-gray-800/50 transition">
          <td class="px-4 py-3 text-gray-900 dark:text-gray-100 font-semibold">${t.taskName}</td>
          <td class="px-4 py-3 text-gray-800 dark:text-gray-200">${t.dateLabel||"-"}</td>
          <td class="px-4 py-3 text-center text-gray-900 dark:text-gray-100">${Or(t.assessedCount)} / ${Or(n)}</td>
          <td class="px-4 py-3 text-center text-gray-900 dark:text-gray-100">${Zo(t.avgTaskScore)}</td>
          <td class="px-4 py-3 text-center text-gray-900 dark:text-gray-100">${Zo(t.avgTeamScore)}</td>
          <td class="px-4 py-3 text-center text-gray-900 dark:text-gray-100">${Zo(t.avgProgressScore)}</td>
          <td class="px-4 py-3 text-center text-gray-900 dark:text-gray-100">${Zo(t.avgTotalScore)}</td>
          <td class="px-4 py-3 text-center font-semibold text-indigo-700 dark:text-indigo-300">${xo(t.averagePercentage)}</td>
        </tr>
      `}).join("")}
        </tbody>
      </table>
    </div>
  `}function soe(r){if(!Array.isArray(r)||!r.length){cx();return}const e=document.getElementById("summaryEvaluationChart");if(!e)return;md&&(md.destroy(),md=null);const t=r.map(l=>l.taskName),n=r.map(l=>l.avgTaskScore||0),s=r.map(l=>l.avgTeamScore||0),i=r.map(l=>l.avgProgressScore||0),a=r.map(l=>l.avgTotalScore||0),o=l_();md=new Chart(e.getContext("2d"),{type:"bar",data:{labels:t,datasets:[{label:"",data:n,backgroundColor:"rgba(99, 102, 241, 0.85)"},{label:"",data:s,backgroundColor:"rgba(16, 185, 129, 0.85)"},{label:"",data:i,backgroundColor:"rgba(251, 191, 36, 0.9)"},{label:"",data:a,backgroundColor:"rgba(59, 130, 246, 0.9)"}]},options:{responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},scales:{x:{stacked:!1,ticks:{color:o.tick},grid:{color:o.grid}},y:{beginAtZero:!0,ticks:{color:o.tick,callback:l=>Zo(l)},grid:{color:o.grid}}},plugins:{legend:{position:"bottom",labels:{usePointStyle:!0,color:o.legend}},tooltip:{backgroundColor:o.tooltipBg,titleColor:o.tooltipTitle,bodyColor:o.tooltipBody,callbacks:{label:l=>`${l.dataset.label}: ${Zo(l.parsed.y)}`}}}}})}function cx(){md&&(md.destroy(),md=null)}function ioe(r){return r?zae[r]||yn(r):""}function tN(r,e){if(!or.graphPage||!or.graphFiltersContainer)return;let t=r;!t||typeof t!="object"?t=c_():t=A_(t);let n=e;if(!n)try{n=dp(t)}catch{n=null}n||(n={groupMetrics:[],summary:{},chartData:{bar:null,pie:null},criteriaContext:null,selectedGroupDetail:null,groupDetails:new Map,options:{groups:[],tasks:[]}}),aoe(t,n),ooe(t,n)}function aoe(r,e){const t=r||{},n=t.groupFilter||"all",s=t.taskFilter||"all",i=t.viewMode||kd.TABLE,a=t.evaluationType||"all",o=t.criteriaView||"topic",l=!!t.showFullOnly,c=(e==null?void 0:e.options)||{},A=Array.isArray(c.groups)?c.groups:[],d=Array.isArray(c.tasks)?c.tasks:[],h=(e==null?void 0:e.summary)||{},u=[`<option value="all"${n==="all"?" selected":""}> </option>`,...A.map(N=>`<option value="${N.id}"${N.id===n?" selected":""}>${N.label}</option>`)].join(""),p=[`<option value="all"${s==="all"?" selected":""}> </option>`,...d.map(N=>`<option value="${N.id}"${N.id===s?" selected":""}>${N.label}</option>`)].join(""),f=Object.values(kd).map(N=>Em(N,N===kd.TABLE?" ":" ",i===N,"data-analysis-view")).join(""),g=["all","mcq","regular"].map(N=>Em(N,N==="all"?" ":N==="mcq"?"MCQ ":" ",a===N,"data-analysis-evaluation")).join(""),m=["topic","options","summary"].map(N=>Em(N,N==="topic"?" ":N==="options"?" ":"",o===N,"data-analysis-criteria-view")).join(""),x=Or(h.groupsInView??0),S=Or(h.totalGroups??A.length),B=xo(h.participationRate??0),F=h.latestEvaluation||"-";or.graphFiltersContainer.innerHTML=`
    <div class="space-y-6">
      <div class="grid gap-4 lg:grid-cols-4">
        <div>
          <label class="label text-gray-900 dark:text-gray-100" for="analysisGraphGroupSelect"> </label>
          <select id="analysisGraphGroupSelect" class="form-select bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 border border-gray-200 dark:border-gray-700">
            ${u}
          </select>
        </div>
        <div>
          <label class="label text-gray-900 dark:text-gray-100" for="analysisGraphTaskSelect"> </label>
          <select id="analysisGraphTaskSelect" class="form-select bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 border border-gray-200 dark:border-gray-700">
            ${p}
          </select>
        </div>
        <div>
          <label class="label text-gray-900 dark:text-gray-100"> </label>
          <div class="flex flex-wrap gap-2" id="analysisGraphEvaluationButtons">
            ${g}
          </div>
        </div>
        <div>
          <label class="label text-gray-900 dark:text-gray-100"> </label>
          <div class="flex flex-wrap gap-2" id="analysisCriteriaViewButtons">
            ${m}
          </div>
        </div>
      </div>
      <div class="flex flex-col sm:flex-row sm:items-center justify-between gap-4">
        <div class="flex flex-wrap gap-2" id="analysisGraphViewButtons">
          ${f}
        </div>
        <label class="inline-flex items-center gap-2 text-sm text-gray-800 dark:text-gray-200">
          <input type="checkbox" class="form-checkbox" id="analysisFullCriteriaToggle" ${l?"checked":""}>
              
        </label>
        <div class="text-sm text-gray-800 dark:text-gray-200">
           : ${x} / ${S}  : ${B}   : ${F}
        </div>
      </div>
    </div>
  `}function ooe(r,e){const{groupMetrics:t,chartData:n,selectedGroupDetail:s,summary:i,criteriaContext:a}=e,o=rN(a,r.criteriaView),l=lN(i),c=uoe(a,r,o),A=r.viewMode===kd.TABLE?cN(t,r):moe(n),d=`
    <div class="graph-detail-container space-y-6">
      ${s?yoe(s):""}
      ${hoe()}
    </div>
  `,h=`
    <div class="space-y-6">
      ${l}
      ${A}
      ${c}
      ${d}
    </div>
  `;or.graphPage&&(or.graphDashboardContainer||(or.graphDashboardContainer=document.createElement("div"),or.graphDashboardContainer.className="graph-dashboard-container space-y-6",or.graphPage.appendChild(or.graphDashboardContainer)),or.graphDashboardContainer.innerHTML=h,or.graphDetailContainer=or.graphDashboardContainer.querySelector(".graph-detail-container"),iN(),aN(),r.viewMode===kd.CHART?boe(n):AN())}function Em(r,e,t,n){return`<button type="button" class="px-4 py-2 rounded-full border text-sm transition-colors ${t?"bg-blue-600 text-white border-blue-600 shadow":"bg-white dark:bg-gray-900 text-gray-800 dark:text-gray-100 border-gray-200 dark:border-gray-700 hover:bg-gray-100 dark:hover:bg-gray-800"}" ${n?`${n}=""`:""} data-analysis-value="${r}">${e}</button>`}function dp(r){const e=As.get("groups")||[],t=As.get("students")||[],n=As.get("tasks")||[],s=As.get("evaluations")||[],i=new Map(n.map(B=>[B.id,B])),a=new Map(e.map(B=>[B.id,B])),o=new Map(t.map(B=>[B.id,B])),l=new Map;t.forEach(B=>{l.has(B.groupId)||l.set(B.groupId,[]),l.get(B.groupId).push(B)});const c=new Map;e.forEach(B=>{var N;const F=((N=l.get(B.id))==null?void 0:N.length)||0;c.set(B.id,{groupId:B.id,groupName:yn(B.name),studentCount:F,evaluationDetails:[]})});const A=new Map,d=new Map;s.forEach(B=>{var F;try{const N=c.get(B.groupId);if(!N)return;const E=i.get(B.taskId);E&&A.set(E.id,{id:E.id,label:yn(E.name)});const w=Coe(E)?"mcq":"regular",v=B.scores||{},I=new Set,k=new Set,_=new Set,T={learnedWell:0,understood:0,notYet:0},L={attendance:0,homework:0},K=(((F=N.evaluationDetails)==null?void 0:F.length)||0)+1,se={evaluationId:B.id,taskId:B.taskId,taskName:voe(E,B,K),type:w,dateMs:woe(B.taskDate||B.updatedAt||B.evaluationDate),dateLabel:"",assessedCount:0,pendingCount:0,averagePercentage:0,participationRate:0,topicCounts:T,optionCounts:L,fullPositiveCount:0,improvementCount:0,fullPositiveAll:!1,participantIds:[],fullPositiveStudentIds:[],improvementStudentIds:[],weightedScoreSum:0,weight:0,studentRecords:[]};Object.entries(v).forEach(([X,$])=>{try{I.add(X);const V=($==null?void 0:$.ProgressCriteria)||{},he=V.topic||Ed.topic.topic_none.id,z=he===Ed.topic.topic_learned_well.id?"learnedWell":he===Ed.topic.topic_understood.id?"understood":"notYet";T[z]=(T[z]||0)+1;const M=!!V.attendance,O=!!V.homework;M&&(L.attendance+=1),O&&(L.homework+=1),z==="learnedWell"&&M&&O&&k.add(X),(z==="notYet"||!M||!O)&&_.add(X);const de=parseFloat(B.maxPossibleScore)||Boe(E)||Gae,ie=parseFloat($.totalScore)||0,le=de>0?ie/de*100:0,fe=parseFloat($==null?void 0:$.taskScore)||0,ve=parseFloat($==null?void 0:$.teamScore)||0,Ce=parseFloat($==null?void 0:$.ProgressScore)||0,Be=parseFloat($==null?void 0:$.mcqScore)||0,Qe=typeof($==null?void 0:$.comments)=="string"?$.comments.trim():"";se.weightedScoreSum+=le,se.weight+=1,se.studentRecords.push({studentId:X,topicId:he,topicKey:z,attendance:M,homework:O,taskScore:fe,teamScore:ve,ProgressScore:Ce,mcqScore:Be,totalScore:ie,maxScore:de,percentage:le,evaluationId:B.id,taskId:se.taskId,taskName:se.taskName,dateMs:se.dateMs,dateLabel:se.dateLabel,comments:yn(Qe),problemRecovered:!!$.problemRecovered})}catch(V){console.warn(` Skipping score record for student ${X} in evaluation ${B.id} due to error:`,V,$)}}),se.assessedCount=I.size,se.pendingCount=Math.max(N.studentCount-se.assessedCount,0),se.averagePercentage=se.weight>0?se.weightedScoreSum/se.weight:0,se.participationRate=N.studentCount>0?Math.min(100,se.assessedCount/N.studentCount*100):0,se.fullPositiveCount=k.size,se.improvementCount=_.size,se.fullPositiveAll=se.assessedCount>0&&se.fullPositiveCount===se.assessedCount,se.dateLabel=se.dateMs?dN(se.dateMs):"",se.participantIds=Array.from(I),se.fullPositiveStudentIds=Array.from(k),se.improvementStudentIds=Array.from(_),N.evaluationDetails.push(se)}catch(N){console.error(` Skipping evaluation ${B.id} due to processing error:`,N,B)}});const h=r.groupFilter,u=r.taskFilter,p=r.evaluationType,f=[];let g=null;c.forEach(B=>{if(h!=="all"&&B.groupId!==h)return;const F=B.evaluationDetails.filter(ie=>{const le=u==="all"||ie.taskId===u,fe=p==="all"||ie.type===p;return le&&fe});if(!F.length){const ie=(l.get(B.groupId)||[]).map(le=>({studentId:le.id,name:yn(le.name||le.id),roll:le.roll??"",role:le.role||"",academicGroup:yn(le.academicGroup||""),avgTaskScore:0,avgTeamScore:0,avgProgressScore:0,avgMcqScore:0,avgTotalScore:0,totalScore:0,evaluationCount:0,latestComment:""}));d.set(B.groupId,{metric:{groupId:B.groupId,groupName:B.groupName,studentCount:B.studentCount,evaluationCount:0,mcqEvaluationCount:0,assessedCount:0,assessmentEntries:0,pendingStudents:B.studentCount,averageScore:0,participationRate:0,scoreWeight:0,uniqueParticipantsCount:0,topicCounts:{learnedWell:0,understood:0,notYet:0},optionCounts:{attendance:0,homework:0},fullCriteriaStudents:0,improvementCount:0,fullCriteriaEvaluations:[],evaluationDetails:[],latestEvaluationMs:null},group:a.get(B.groupId)||null,members:ie,evaluations:[]});return}const N=F.length,E=F.filter(ie=>ie.type==="mcq").length,w=F.reduce((ie,le)=>ie+le.assessedCount,0),v=F.reduce((ie,le)=>ie+le.weightedScoreSum,0),I=F.reduce((ie,le)=>ie+le.weight,0),k={learnedWell:0,understood:0,notYet:0},_={attendance:0,homework:0},T=new Set,L=new Set,K=new Set,se=[];F.forEach(ie=>{k.learnedWell+=ie.topicCounts.learnedWell,k.understood+=ie.topicCounts.understood,k.notYet+=ie.topicCounts.notYet,_.attendance+=ie.optionCounts.attendance,_.homework+=ie.optionCounts.homework,ie.participantIds.forEach(le=>T.add(le)),ie.fullPositiveStudentIds.forEach(le=>L.add(le)),ie.improvementStudentIds.forEach(le=>K.add(le)),ie.fullPositiveAll&&se.push(ie.taskName)});const X=I>0?v/I:0,$=T.size,V=Math.max(B.studentCount-$,0),he=B.studentCount>0?Math.min(100,$/B.studentCount*100):0,z=F.reduce((ie,le)=>le.dateMs&&le.dateMs>ie?le.dateMs:ie,-1/0),M={groupId:B.groupId,groupName:B.groupName,studentCount:B.studentCount,evaluationCount:N,mcqEvaluationCount:E,assessedCount:$,assessmentEntries:w,pendingStudents:V,averageScore:X,participationRate:he,scoreWeight:I,uniqueParticipantsCount:$,topicCounts:k,optionCounts:_,fullCriteriaStudents:L.size,improvementCount:K.size,fullCriteriaEvaluations:se,evaluationDetails:F.sort((ie,le)=>(le.dateMs||0)-(ie.dateMs||0)),latestEvaluationMs:z>0?z:null},O=l.get(B.groupId)||[],H=new Map;O.forEach(ie=>{H.set(ie.id,{studentId:ie.id,name:yn(ie.name||ie.id),roll:ie.roll??"",role:ie.role||"",academicGroup:yn(ie.academicGroup||""),totalTaskScore:0,totalTeamScore:0,totalProgressScore:0,totalMcqScore:0,totalScore:0,evaluationCount:0,latestComment:"",latestCommentDate:-1/0})}),F.forEach(ie=>{ie.studentRecords.forEach(le=>{const fe=le.studentId;if(!fe)return;if(!H.has(fe)){const Ce=o.get(fe)||{};H.set(fe,{studentId:fe,name:yn(Ce.name||fe),roll:Ce.roll??"",role:Ce.role||"",academicGroup:yn(Ce.academicGroup||""),totalTaskScore:0,totalTeamScore:0,totalProgressScore:0,totalMcqScore:0,totalScore:0,evaluationCount:0,latestComment:"",latestCommentDate:-1/0})}const ve=H.get(fe);if(ve.totalTaskScore+=le.taskScore||0,ve.totalTeamScore+=le.teamScore||0,ve.totalProgressScore+=le.ProgressScore||0,ve.totalMcqScore+=le.mcqScore||0,ve.totalScore+=le.totalScore||0,ve.evaluationCount+=1,le.comments){const Ce=le.dateMs||0;Ce>=ve.latestCommentDate&&(ve.latestComment=le.comments,ve.latestCommentDate=Ce)}})});const J=Array.from(H.values()).map(ie=>{const le=ie.evaluationCount||0,fe=le||1;return{studentId:ie.studentId,name:ie.name,roll:ie.roll,role:ie.role,academicGroup:ie.academicGroup,avgTaskScore:le?ie.totalTaskScore/fe:0,avgTeamScore:le?ie.totalTeamScore/fe:0,avgProgressScore:le?ie.totalProgressScore/fe:0,avgMcqScore:le?ie.totalMcqScore/fe:0,avgTotalScore:le?ie.totalScore/fe:0,totalScore:ie.totalScore,evaluationCount:le,latestComment:ie.latestComment}}).sort((ie,le)=>le.evaluationCount!==ie.evaluationCount?le.evaluationCount-ie.evaluationCount:ie.name.localeCompare(le.name)),de=F.map(ie=>{const le=ie.studentRecords.length||0,fe=ie.studentRecords.reduce((Ce,Be)=>(Ce.task+=Be.taskScore||0,Ce.team+=Be.teamScore||0,Ce.Progress+=Be.ProgressScore||0,Ce.mcq+=Be.mcqScore||0,Ce.total+=Be.totalScore||0,Ce),{task:0,team:0,Progress:0,mcq:0,total:0}),ve=le||1;return{evaluationId:ie.evaluationId,taskName:ie.taskName,dateLabel:ie.dateLabel,dateMs:ie.dateMs||null,assessedCount:ie.assessedCount,pendingCount:ie.pendingCount,averagePercentage:ie.averagePercentage,avgTaskScore:le?fe.task/ve:0,avgTeamScore:le?fe.team/ve:0,avgProgressScore:le?fe.Progress/ve:0,avgMcqScore:le?fe.mcq/ve:0,avgTotalScore:le?fe.total/ve:0}}).sort((ie,le)=>(le.dateMs||0)-(ie.dateMs||0));d.set(B.groupId,{metric:M,group:a.get(B.groupId)||null,members:J,evaluations:de}),!(r.showFullOnly&&M.fullCriteriaEvaluations.length===0)&&(f.push(M),r.groupFilter!=="all"&&B.groupId===r.groupFilter&&(g=M))});const m=loe(f,h,c.size),x=coe(f,r),S=Aoe(f,o,a);return ZM=S,S&&go&&!S.criteriaBuckets.has(go)&&(go=null),{groupMetrics:f,summary:m,chartData:x,criteriaContext:S,selectedGroupDetail:g,groupDetails:d,options:{groups:e.map(B=>({id:B.id,label:yn(B.name)})),tasks:Array.from(A.values())}}}function loe(r,e,t){if(!r.length)return{groupsInView:0,totalGroups:e==="all"?t:1,totalEvaluations:0,totalMcqEvaluations:0,averageScore:0,pendingStudents:0,improvementStudents:0,participationRate:0,latestEvaluation:null,fullCriteriaGroups:0};const n=r.reduce((f,g)=>f+(g.evaluationCount||0),0),s=r.reduce((f,g)=>f+(g.mcqEvaluationCount||0),0),i=r.reduce((f,g)=>f+(g.studentCount||0),0),a=r.reduce((f,g)=>f+(g.uniqueParticipantsCount||0),0),o=Math.max(i-a,0),l=r.reduce((f,g)=>f+(g.improvementCount||0),0),c=r.reduce((f,g)=>f+(g.scoreWeight||0),0),A=r.reduce((f,g)=>f+(g.averageScore||0)*(g.scoreWeight||0),0),d=c>0?A/c:0,h=i>0?Math.min(100,a/i*100):0,u=r.reduce((f,g)=>g.latestEvaluationMs&&g.latestEvaluationMs>f?g.latestEvaluationMs:f,-1/0),p=r.filter(f=>f.fullCriteriaEvaluations.length>0).length;return{groupsInView:r.length,totalGroups:e==="all"?t:1,totalEvaluations:n,totalMcqEvaluations:s,averageScore:d,pendingStudents:o,improvementStudents:l,participationRate:h,latestEvaluation:u>0?dN(u):null,fullCriteriaGroups:p}}function coe(r,e){if(!r.length)return{bar:null,pie:null};const t=l_(),n=r.map(A=>A.groupName),s=r.map(A=>A.topicCounts.learnedWell),i=r.map(A=>A.topicCounts.understood),a=r.map(A=>A.topicCounts.notYet),o=r.map(A=>A.pendingStudents),l={labels:n,datasets:[{label:"  ",data:s,backgroundColor:"rgba(16, 185, 129, 0.85)",borderRadius:6},{label:" ",data:i,backgroundColor:"rgba(99, 102, 241, 0.85)",borderRadius:6},{label:"    ",data:a,backgroundColor:"rgba(251, 191, 36, 0.9)",borderRadius:6},{label:" ",data:o,type:"line",borderColor:"rgba(239, 68, 68, 0.95)",backgroundColor:"rgba(239, 68, 68, 0.25)",tension:.35,borderWidth:2,fill:!0,yAxisID:"y1"}],options:{responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},scales:{y:{beginAtZero:!0,ticks:{precision:0,color:t.tick,callback:A=>Or(A)},grid:{color:t.grid}},y1:{beginAtZero:!0,position:"right",grid:{drawOnChartArea:!1,color:t.grid},ticks:{precision:0,color:t.tick,callback:A=>Or(A)}},x:{ticks:{color:t.tick},grid:{color:t.grid}}},plugins:{legend:{position:"bottom",labels:{usePointStyle:!0,color:t.legend}},tooltip:{backgroundColor:t.tooltipBg,titleColor:t.tooltipTitle,bodyColor:t.tooltipBody}}}};let c=null;if(e.groupFilter!=="all"&&r.length===1){const A=r[0];A.topicCounts.learnedWell+A.topicCounts.understood+A.topicCounts.notYet>0&&(c={labels:["  "," ","    "],data:[A.topicCounts.learnedWell,A.topicCounts.understood,A.topicCounts.notYet],colors:["#10b981","#6366f1","#f59e0b"],title:`${A.groupName} -  `})}return{bar:l,pie:c}}function Aoe(r,e,t){if(!Array.isArray(r)||!r.length)return null;const n=new Map,s={topic:[],options:[],summary:[]},i=new Set,a=c=>{const A=o_.get(c);if(!A)return null;let d=n.get(c);return d||(d={id:c,label:yn(A.label),category:A.category,categoryLabel:A.categoryLabel,students:new Map,count:0,totalEntries:0},n.set(c,d),Array.isArray(s[A.category])&&s[A.category].push(d)),d},o=(c,A,d)=>{const h=a(c);if(!h)return;const u=h.students.get(A.studentId)||{studentId:A.studentId,name:A.name,groupId:A.groupId,groupName:A.groupName,records:[]};u.records.push(d),h.students.set(A.studentId,u)};r.forEach(c=>{const A=yn(c.groupName);(c.evaluationDetails||[]).forEach(d=>{Array.isArray(d.studentRecords)&&d.studentRecords.forEach(h=>{const u=h.studentId;if(!u)return;i.add(u);const p=e.get(u)||{},f=p.groupId||c.groupId,g=t.get(f),m={studentId:u,name:yn(p.name||h.displayName||u),groupId:f,groupName:yn((g==null?void 0:g.name)||A)},x={evaluationId:h.evaluationId,taskId:h.taskId,taskName:yn(h.taskName),dateMs:h.dateMs,dateLabel:h.dateLabel||"",topicId:h.topicId,topicKey:h.topicKey,attendance:!!h.attendance,homework:!!h.homework,percentage:h.percentage,totalScore:h.totalScore,maxScore:h.maxScore,groupId:c.groupId,groupName:A,studentId:h.studentId,taskScore:h.taskScore,problemRecovered:h.problemRecovered};h.topicId&&o(h.topicId,m,x),h.attendance&&o(Ed.options.attendance_regular.id,m,x),h.homework&&o(Ed.options.homework_done.id,m,x);const S=h.topicKey==="learnedWell"&&h.attendance&&h.homework,B=h.topicKey==="notYet"||!h.attendance||!h.homework;S&&o(Pu.FULL_POSITIVE.id,m,x),B&&o(Pu.IMPROVEMENT_NEEDED.id,m,x)})})}),n.forEach(c=>{c.count=c.students.size,c.totalEntries=Array.from(c.students.values()).reduce((A,d)=>A+d.records.length,0)});const l=c=>c.filter(A=>A.count>0).sort((A,d)=>d.count!==A.count?d.count-A.count:A.label.localeCompare(d.label));return s.topic=l(s.topic),s.options=l(s.options),s.summary=l(s.summary),!s.topic.length&&!s.options.length&&!s.summary.length?null:{criteriaBuckets:n,bucketsByCategory:s,totalUniqueStudents:i.size}}function rN(r,e){var n;if(!r)return[];const t=e==="topic"?"topic":e==="options"?"options":"summary";return Array.isArray((n=r.bucketsByCategory)==null?void 0:n[t])?r.bucketsByCategory[t]:[]}function nN(r){if(!r||!r.length)return go=null,null;if(go){const e=r.find(t=>t.id===go);if(e)return e}return go=r[0].id,r[0]}function doe(r){return r==="topic"?" ":r==="options"?" ":r==="summary"?"":""}function sN(r,e){const t=o_.get(r),n=t?t.label:e||"";return yn(n)}function uoe(r,e,t){if(!r)return"";if(!t||!t.length)return go=null,`
      <div class="card card-body bg-white dark:bg-gray-900 border border-gray-100 dark:border-gray-700">
        <div class="placeholder-content text-gray-800 dark:text-gray-200">
          <i class="fas fa-user-check mr-2"></i>
                 
        </div>
      </div>
    `;const n=nN(t),s=r.totalUniqueStudents||0,i="criteria-card block w-full rounded-2xl border transition-colors p-4 text-left focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-900",a="border-blue-600 bg-blue-600 text-white shadow-lg",o="border-gray-200 bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 hover:border-blue-400 hover:bg-blue-50/60 dark:hover:bg-gray-800 dark:border-gray-700",l=t.map(A=>{const d=n&&A.id===n.id,h=s>0?A.count/s*100:0,u=d?"text-white/90":"text-gray-700 dark:text-gray-300";return`
        <button
          type="button"
          class="${i} ${d?a:o}"
          data-criteria-id="${A.id}"
          data-base-class="${i}"
          data-active-class="${a}"
          data-inactive-class="${o}"
        >
          <span class="text-xs font-semibold uppercase tracking-wide ${u}">${doe(A.category)}</span>
          <div class="mt-2 flex items-baseline justify-between gap-2">
            <span class="text-lg font-semibold">${sN(A.id,A.label)}</span>
            <span class="text-3xl font-bold">${Or(A.count)}</span>
          </div>
          <div class="mt-1 flex items-center justify-between text-sm ${u}">
            <span>${Or(A.totalEntries)} </span>
            <span>${xo(h||0)}</span>
          </div>
        </button>
      `}).join("");return`
    <div class="card bg-white dark:bg-gray-900 border border-gray-100 dark:border-gray-700">
      <div class="card-header flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2">
        <h3 class="text-lg font-semibold text-gray-900 dark:text-gray-50">  </h3>
        <span class="text-xs font-semibold uppercase tracking-wide text-blue-700 dark:text-blue-300">${e.criteriaView==="topic"?" ":e.criteriaView==="options"?" ":""}</span>
      </div>
      <div class="card-body">
        <div class="grid gap-4 md:grid-cols-2 xl:grid-cols-${Math.min(t.length||1,4)}" data-criteria-grid>
          ${l}
        </div>
      </div>
    </div>
  `}function iN(){if(!or.graphDashboardContainer)return;or.graphDashboardContainer.querySelectorAll("[data-criteria-id]").forEach(e=>{const t=e.dataset.baseClass||"",n=e.dataset.activeClass||"",s=e.dataset.inactiveClass||"",i=e.dataset.criteriaId===go;e.className=`${t} ${i?n:s}`.trim()})}function hoe(r,e){return'<div class="space-y-4" data-criteria-detail></div>'}function aN(){if(!or.graphDetailContainer)return;const r=or.graphDetailContainer.querySelector("[data-criteria-detail]");if(!r)return;const e=As.getFilterSection(EA),t=rN(ZM,e.criteriaView),n=nN(t);r.innerHTML=n?foe(n):oN()}function oN(){return`
    <div class="card card-body bg-white dark:bg-gray-900 border border-gray-100 dark:border-gray-700">
      <div class="placeholder-content text-gray-800 dark:text-gray-200">
        <i class="fas fa-users mr-2"></i>
                
      </div>
    </div>
  `}function foe(r){if(!r||!r.students.size)return oN();const e=Array.from(r.students.values()).sort((t,n)=>n.records.length!==t.records.length?n.records.length-t.records.length:t.name.localeCompare(n.name)).map(t=>{const n=[...t.records].sort((i,a)=>(a.dateMs||0)-(i.dateMs||0)),s=n.map(i=>goe(i)).join("");return`
        <div class="rounded-2xl border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-900 p-4 space-y-3">
          <div class="flex flex-col sm:flex-row sm:items-start sm:justify-between gap-2">
            <div>
              <h5 class="text-lg font-semibold text-gray-900 dark:text-gray-50">${t.name}</h5>
              <p class="text-sm text-gray-700 dark:text-gray-300">${t.groupName||"  "}</p>
            </div>
            <div class="text-sm text-gray-700 dark:text-gray-300">
              <span class="inline-flex items-center gap-1 rounded-full bg-blue-100 dark:bg-blue-900/40 px-3 py-1 text-blue-800 dark:text-blue-100 font-medium">
                ${Or(n.length)} 
              </span>
            </div>
          </div>
          <div class="space-y-2">
            ${s}
          </div>
        </div>
      `}).join("");return`
    <div class="space-y-4">
      <div class="card bg-white dark:bg-gray-900 border border-gray-100 dark:border-gray-700">
        <div class="card-header flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2">
          <h4 class="text-lg font-semibold text-gray-900 dark:text-gray-50">${sN(r.id,r.label)}</h4>
          <span class="text-sm text-gray-700 dark:text-gray-300"> : ${Or(r.count)}</span>
        </div>
        <div class="card-body space-y-4">
          ${e}
        </div>
      </div>
    </div>
  `}function goe(r){const e=poe(r.topicId)||" ",t=r.attendance?"":"",n=r.attendance?"bg-emerald-100 text-emerald-800 dark:bg-emerald-700/50 dark:text-emerald-50":"bg-rose-100 text-rose-800 dark:bg-rose-700/50 dark:text-rose-50",s=r.homework?" ":" ",i=r.homework?"bg-violet-100 text-violet-800 dark:bg-violet-700/50 dark:text-violet-50":"bg-amber-100 text-amber-800 dark:bg-amber-700/50 dark:text-amber-50";return`
    <div class="rounded-xl border border-gray-100 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50 p-3 space-y-2">
      <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2">
        <div>
          <p class="text-sm font-semibold text-gray-900 dark:text-gray-100">${r.taskName}</p>
          <p class="text-xs text-gray-700 dark:text-gray-300">${r.dateLabel||" "}  ${r.groupName}</p>
        </div>
        <div class="text-sm font-semibold text-indigo-700 dark:text-indigo-300">
          ${xo(r.percentage)}
        </div>
      </div>
      <div class="flex flex-wrap gap-2 text-xs">
        <span class="inline-flex items-center rounded-full bg-sky-100 text-sky-800 dark:bg-sky-700/50 dark:text-sky-50 px-3 py-1 font-medium">${e}</span>
        <span class="inline-flex items-center rounded-full px-3 py-1 font-medium ${n}">${t}</span>
        <span class="inline-flex items-center rounded-full px-3 py-1 font-medium ${i}">${s}</span>
        ${(()=>{const a=r.topicKey,o=a==="understood"||a==="notYet";if(console.log(`Student: ${r.studentId}, TopicKey: ${a}, ProblemRecovered: ${r.problemRecovered}, IsProblematic: ${o}`),o){const l=r.problemRecovered?'<span class="inline-flex items-center rounded-full px-3 py-1 font-medium bg-green-100 text-green-800 dark:bg-green-700/50 dark:text-green-50">Problem Resolved</span>':'<span class="inline-flex items-center rounded-full px-3 py-1 font-medium bg-red-100 text-red-800 dark:bg-red-700/50 dark:text-red-50">Have a problem</span>';return console.log("Generating Tag HTML:",l),l}if(a==="learnedWell"&&r.problemRecovered){const l='<span class="inline-flex items-center rounded-full px-3 py-1 font-medium bg-green-100 text-green-800 dark:bg-green-700/50 dark:text-green-50">Problem Resolved</span>';return console.log("Generating Tag HTML (Resolved 10):",l),l}return""})()}
      </div>
    </div>
  `}function poe(r){const e=o_.get(r);return e?yn(e.label):""}function lN(r){return`
    <div class="grid gap-4 md:grid-cols-2 xl:grid-cols-4">
      ${rA(" ",r.totalEvaluations,"bg-blue-50 text-blue-800 dark:bg-gray-800/80 dark:text-white","fa-clipboard-list")}
      ${rA("MCQ ",r.totalMcqEvaluations,"bg-purple-50 text-purple-800 dark:bg-gray-800/80 dark:text-white","fa-brain")}
      ${rA("  (%)",xo(r.averageScore),"bg-emerald-50 text-emerald-800 dark:bg-gray-800/80 dark:text-white","fa-gauge")}
      ${rA(" ",r.pendingStudents,"bg-rose-50 text-rose-800 dark:bg-gray-800/80 dark:text-white","fa-user-clock")}
    </div>
  `}function rA(r,e,t,n){const s=typeof e=="string"?e:Or(e);return`
    <div class="rounded-2xl border ${t.includes("dark:")?"border-transparent":"border-gray-100"} ${t} p-4 shadow-sm backdrop-blur">
      <div class="flex items-center justify-between">
        <div>
          <div class="text-sm font-medium opacity-90">${r}</div>
          <div class="mt-2 text-2xl font-semibold">${s}</div>
        </div>
        <div class="text-3xl opacity-70"><i class="fas ${n}"></i></div>
      </div>
    </div>
  `}function cN(r,e){if(!r.length)return`
      <div class="card card-body bg-white dark:bg-gray-900 border border-gray-100 dark:border-gray-700">
        <div class="placeholder-content text-gray-800 dark:text-gray-200">
          <i class="fas fa-info-circle mr-2"></i>
                
        </div>
      </div>
    `;const t=[""," "," (/MCQ)","","  (%)","  (%)"," "," "," ","  "],n=r.map(s=>`
        <tr class="border-b border-gray-100 dark:border-gray-700 hover:bg-gray-50/70 dark:hover:bg-gray-800/50 transition">
          <td class="px-4 py-3 font-semibold text-gray-900 dark:text-gray-100">${s.groupName}</td>
          <td class="px-4 py-3 text-center text-gray-900 dark:text-gray-100">${Or(s.studentCount)}</td>
          <td class="px-4 py-3 text-center text-gray-900 dark:text-gray-100">${Or(s.evaluationCount)} / ${Or(s.mcqEvaluationCount)}</td>
          <td class="px-4 py-3 text-center text-gray-900 dark:text-gray-100">${Or(s.uniqueParticipantsCount)}</td>
          <td class="px-4 py-3 text-center ${_oe(s.averageScore)} font-semibold">${xo(s.averageScore)}</td>
          <td class="px-4 py-3 text-center text-indigo-700 dark:text-indigo-300 font-semibold">${xo(s.participationRate)}</td>
          <td class="px-4 py-3 text-center text-gray-900 dark:text-gray-100">${Or(s.pendingStudents)}</td>
          <td class="px-4 py-3 text-center text-emerald-700 dark:text-emerald-300 font-semibold">${Or(s.fullCriteriaStudents)}</td>
          <td class="px-4 py-3 text-center ${s.improvementCount>0?"text-rose-600 dark:text-rose-300 font-semibold":"text-gray-800 dark:text-gray-200"}">${Or(s.improvementCount)}</td>
          <td class="px-4 py-3 text-sm text-gray-800 dark:text-gray-200">${s.fullCriteriaEvaluations.map((i,a)=>{const o=typeof i=="string"&&i.trim().length?i.trim():typeof i=="number"?String(i):"",l=yn(o),c=l&&l.length?l:o,A=c&&c.length?c.length>32?`${c.slice(0,30)}`:c:` ${Or(a+1)}`;return`<span class="inline-flex items-center px-2 py-1 bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-100 rounded-full mr-1 mb-1 whitespace-nowrap" title="${xoe(c||A)}">${A}</span>`}).join("")||'<span class="text-gray-500 dark:text-gray-400"></span>'}</td>
        </tr>
      `).join("");return`
    <div class="card overflow-hidden bg-white dark:bg-gray-900 border border-gray-100 dark:border-gray-700">
      <div class="card-header flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2">
        <h3 class="text-lg font-semibold text-gray-900 dark:text-gray-50">  </h3>
        <p class="text-sm text-gray-800 dark:text-gray-200">
           : ${e.viewMode===kd.TABLE?"":""}   : ${Or(r.length)}
        </p>
      </div>
      <div class="overflow-x-auto">
        <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700 text-sm">
          <thead class="bg-gray-50 dark:bg-gray-800">
            <tr>
              ${t.map(s=>`<th scope="col" class="px-4 py-3 text-left font-semibold uppercase tracking-wide text-gray-700 dark:text-gray-300">${s}</th>`).join("")}
            </tr>
          </thead>
          <tbody class="bg-white dark:bg-gray-900 divide-y divide-gray-100 dark:divide-gray-800">
            ${n}
          </tbody>
        </table>
      </div>
    </div>
  `}function moe(r){if(!r.bar)return`
      <div class="card card-body bg-white dark:bg-gray-900 border border-gray-100 dark:border-gray-700">
        <div class="placeholder-content text-gray-800 dark:text-gray-200">
          <i class="fas fa-chart-column mr-2"></i>
               
        </div>
      </div>
    `;const e=r.pie?`
        <div class="card bg-white dark:bg-gray-900 border border-gray-100 dark:border-gray-700">
          <div class="card-header flex items-center justify-between">
            <h3 class="text-lg font-semibold text-gray-900 dark:text-gray-50">${r.pie.title}</h3>
          </div>
          <div class="card-body">
            <div class="h-80">
              <canvas id="analysisPieChart"></canvas>
            </div>
          </div>
        </div>
      `:"";return`
    <div class="grid gap-6 ${r.pie?"lg:grid-cols-3":"lg:grid-cols-1"}">
      <div class="card lg:col-span-2 bg-white dark:bg-gray-900 border border-gray-100 dark:border-gray-700">
        <div class="card-header flex items-center justify-between">
          <h3 class="text-lg font-semibold text-gray-900 dark:text-gray-50">  </h3>
        </div>
        <div class="card-body">
          <div class="h-[420px]">
            <canvas id="analysisBarChart"></canvas>
          </div>
        </div>
      </div>
      ${e}
    </div>
  `}function boe(r){var s,i,a,o,l,c,A,d,h,u,p,f,g,m,x,S,B,F,N,E,w,v,I,k,_,T,L,K,se,X,$,V,he;if(!r.bar){AN();return}const e=l_(),t=document.getElementById("analysisBarChart");t&&(Ju&&Ju.destroy(),Ju=new Chart(t.getContext("2d"),{type:"bar",data:{labels:r.bar.labels,datasets:r.bar.datasets},options:{...r.bar.options,scales:{...((s=r.bar.options)==null?void 0:s.scales)||{},x:{...((a=(i=r.bar.options)==null?void 0:i.scales)==null?void 0:a.x)||{},ticks:{...((c=(l=(o=r.bar.options)==null?void 0:o.scales)==null?void 0:l.x)==null?void 0:c.ticks)||{},color:e.tick},grid:{...((h=(d=(A=r.bar.options)==null?void 0:A.scales)==null?void 0:d.x)==null?void 0:h.grid)||{},color:e.grid}},y:{...((p=(u=r.bar.options)==null?void 0:u.scales)==null?void 0:p.y)||{},ticks:{...((m=(g=(f=r.bar.options)==null?void 0:f.scales)==null?void 0:g.y)==null?void 0:m.ticks)||{},color:e.tick},grid:{...((B=(S=(x=r.bar.options)==null?void 0:x.scales)==null?void 0:S.y)==null?void 0:B.grid)||{},color:e.grid}},y1:{...((N=(F=r.bar.options)==null?void 0:F.scales)==null?void 0:N.y1)||{},ticks:{...((v=(w=(E=r.bar.options)==null?void 0:E.scales)==null?void 0:w.y1)==null?void 0:v.ticks)||{},color:e.tick},grid:{...((_=(k=(I=r.bar.options)==null?void 0:I.scales)==null?void 0:k.y1)==null?void 0:_.grid)||{},color:e.grid,drawOnChartArea:!1}}},plugins:{...((T=r.bar.options)==null?void 0:T.plugins)||{},legend:{...((K=(L=r.bar.options)==null?void 0:L.plugins)==null?void 0:K.legend)||{},labels:{...(($=(X=(se=r.bar.options)==null?void 0:se.plugins)==null?void 0:X.legend)==null?void 0:$.labels)||{},color:e.legend,usePointStyle:!0}},tooltip:{...((he=(V=r.bar.options)==null?void 0:V.plugins)==null?void 0:he.tooltip)||{},backgroundColor:e.tooltipBg,titleColor:e.tooltipTitle,bodyColor:e.tooltipBody}}}}));const n=document.getElementById("analysisPieChart");n&&r.pie?(Rl&&Rl.destroy(),Rl=new Chart(n.getContext("2d"),{type:"doughnut",data:{labels:r.pie.labels,datasets:[{data:r.pie.data,backgroundColor:r.pie.colors}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{color:e.legend}},tooltip:{backgroundColor:e.tooltipBg,titleColor:e.tooltipTitle,bodyColor:e.tooltipBody}}}})):Rl&&(Rl.destroy(),Rl=null)}function AN(){Ju&&(Ju.destroy(),Ju=null),Rl&&(Rl.destroy(),Rl=null)}function yoe(r){const e=r.evaluationDetails.map(t=>{const n=t.topicCounts.learnedWell+t.topicCounts.understood+t.topicCounts.notYet,s=`
        <div class="flex flex-wrap gap-2 text-xs">
          <span class="px-3 py-1 rounded-full bg-emerald-100 text-emerald-800 dark:bg-emerald-700/50 dark:text-emerald-50">
              : ${Or(t.topicCounts.learnedWell)}
          </span>
          <span class="px-3 py-1 rounded-full bg-violet-100 text-violet-800 dark:bg-violet-700/50 dark:text-violet-50">
             : ${Or(t.topicCounts.understood)}
          </span>
          <span class="px-3 py-1 rounded-full bg-amber-100 text-amber-800 dark:bg-amber-700/50 dark:text-amber-50">
                : ${Or(t.topicCounts.notYet)}
          </span>
        </div>
      `,i=`
        <div class="flex flex-wrap gap-2 text-xs mt-2">
          <span class="px-3 py-1 rounded-full bg-sky-100 text-sky-800 dark:bg-sky-700/50 dark:text-sky-50">
             : ${Or(t.optionCounts.attendance)}
          </span>
          <span class="px-3 py-1 rounded-full bg-fuchsia-100 text-fuchsia-800 dark:bg-fuchsia-700/50 dark:text-fuchsia-50">
              : ${Or(t.optionCounts.homework)}
          </span>
        </div>
      `;return`
        <div class="border border-gray-100 dark:border-gray-700 rounded-xl p-4 space-y-3 bg-white dark:bg-gray-900">
          <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3">
            <div>
              <div class="text-base font-semibold text-gray-900 dark:text-gray-50">${yn(t.taskName)}</div>
              <div class="text-xs text-gray-700 dark:text-gray-300 mt-1 flex flex-wrap gap-3">
                <span><i class="fas fa-calendar-day mr-1"></i>${t.dateLabel||""}</span>
                <span><i class="fas fa-list-check mr-1"></i>${t.type==="mcq"?"MCQ":"/"}</span>
              </div>
            </div>
            <div class="flex flex-wrap gap-4 text-sm text-gray-900 dark:text-gray-100">
              <span class="font-semibold text-indigo-700 dark:text-indigo-300"> : ${xo(t.averagePercentage)}</span>
              <span>: ${Or(t.assessedCount)}</span>
              <span class="${t.pendingCount>0?"text-rose-700 dark:text-rose-300 font-semibold":""}">: ${Or(t.pendingCount)}</span>
              <span class="text-emerald-700 dark:text-emerald-300 font-semibold">: ${Or(t.fullPositiveCount)}</span>
            </div>
          </div>
          ${n>0?s:""}
          ${i}
        </div>
      `}).join("");return`
    <div class="card card-body space-y-4 bg-white dark:bg-gray-900 border border-gray-100 dark:border-gray-700">
      <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2">
        <h4 class="text-lg font-semibold text-gray-900 dark:text-gray-50">${r.groupName} -  </h4>
        <span class="text-sm text-gray-800 dark:text-gray-200">
           ${Or(r.evaluationCount)}  
        </span>
      </div>
      <div class="space-y-3">
        ${e}
      </div>
    </div>
  `}function Or(r){const e=Number.isFinite(r)?r:0;return En!=null&&En.convertToBanglaNumber?En.convertToBanglaNumber(Math.round(e)):Math.round(e).toString()}function xo(r){const t=(Number.isFinite(r)?r:0).toFixed(1);return En!=null&&En.convertToBanglaNumber?`${En.convertToBanglaNumber(t)}%`:`${t}%`}function Zo(r,e=2){const n=(Number.isFinite(r)?r:0).toFixed(e);return En!=null&&En.convertToBanglaNumber?En.convertToBanglaNumber(n):n}function dN(r){if(!r)return"";if(En!=null&&En.formatTimestamp)return En.formatTimestamp(r instanceof Date?r:new Date(r));const e=r instanceof Date?r:new Date(r);return Number.isNaN(e.getTime())?"":e.toLocaleDateString("bn-BD",{year:"numeric",month:"short",day:"numeric"})}function woe(r){if(!r)return null;if(r instanceof Date)return r.getTime();if(typeof r=="number")return r;if(typeof r=="string"){const e=Date.parse(r);return Number.isNaN(e)?null:e}if(typeof r=="object"){if(typeof r.toDate=="function")try{return r.toDate().getTime()}catch{return null}if(typeof r.seconds=="number")return r.seconds*1e3}return null}function yn(r){return r?En!=null&&En.ensureBengaliText&&typeof En.ensureBengaliText=="function"?En.ensureBengaliText(r):typeof r=="string"?r.trim():String(r):""}function voe(r,e,t=1){const n=yn((r==null?void 0:r.name)||(e==null?void 0:e.taskName)||"");if(n)return n;const s=yn((r==null?void 0:r.code)||(e==null?void 0:e.taskCode)||"");if(s)return s;const i=Number.isFinite(t)?Or(t):"";return i?` ${i}`:""}function xoe(r){const e=yn(r);return(typeof e=="string"?e.replace(/\r?\n/g," "):"").replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function _oe(r){return r>=80?"text-emerald-700 dark:text-emerald-300":r>=60?"text-blue-700 dark:text-blue-300":r>=40?"text-amber-700 dark:text-amber-300":"text-rose-700 dark:text-rose-300"}function Boe(r){if(!r)return null;if(typeof r.maxScore=="number")return r.maxScore;if(r.maxScoreBreakdown){const e=r.maxScoreBreakdown;return(parseFloat(e.task)||0)+(parseFloat(e.team)||0)+(parseFloat(e.Progress)||0)+(parseFloat(e.mcq)||0)}return null}function Coe(r){return!r||!r.maxScoreBreakdown?!1:parseFloat(r.maxScoreBreakdown.mcq)>0}async function Ax(){zn.showLoading("PDF  ...");try{const r=As.getFilterSection(EA),e=dp(r);if(!e||!e.groupMetrics||e.groupMetrics.length===0){zn.showToast("    ","warning");return}await En.pdfGenerator.generateGroupAnalysisPDF(e.groupMetrics,zn)}catch(r){console.error("Error generating group analysis PDF:",r),zn.showToast("PDF    ","error")}finally{zn.hideLoading()}}async function dx(){const r=As.getFilterSection(EA);if(!r||r.groupFilter==="all"){zn.showToast("      ","info");return}zn.showLoading("PDF  ...");try{const n=(dp(r).groupDetails||new Map).get(r.groupFilter);if(!n){zn.showToast("    ","warning");return}const s=As.get("classes")||[],i=As.get("sections")||[],a=new Map(s.map(l=>[l.id,l])),o=new Map(i.map(l=>[l.id,l]));await En.pdfGenerator.generateSingleGroupAnalysisPDF(n,zn,a,o)}catch(e){console.error("Error generating selected group PDF:",e),zn.showToast("PDF    ","error")}finally{zn.hideLoading()}}function ux(){window.print()}async function tI(r="all",e=null){zn.showLoading("PDF  ...");try{const t=As.get("groups")||[],n=As.get("students")||[],s=As.get("tasks")||[],i=As.get("evaluations")||[];if(t.length===0){zn.showToast("   ","warning");return}const a=As.get("classes")||[],o=As.get("sections")||[],l=new Map(a.map(A=>[A.id,A])),c=new Map(o.map(A=>[A.id,A]));await En.pdfGenerator.generateGroupWiseFullDetailsPDF(t,n,s,i,zn,r,e,l,c)}catch(t){console.error("Error generating group wise full details PDF:",t),zn.showToast("PDF    ","error")}finally{zn.hideLoading()}}let al,ur,Zu,bd,d_,uN,Id;const Lr={};let hN,cd=null;function Soe(r){return al=r.managers.stateManager,ur=r.managers.uiManager,Zu=r.services.dataService,uN=r.services.auth.authServiceInstance,Id=r.utils.permissionHelper,bd=r.utils,d_=r.app,hN=bd.createDebouncer(300),Eoe(),Ioe(),console.log(" Admin component initialized."),{render:koe}}async function koe(){if(!Lr.page){console.error(" Admin render failed: Page element #page-admin-management not found.");return}console.log("Rendering Admin Management page..."),ur.showLoading("   ...");try{const r=al.get("currentUserData");if((r==null?void 0:r.type)!=="super-admin"){mv([]),ur.displayEmptyMessage(Lr.adminManagementContent,"      "),console.warn("Admin Page: Non-super-admin tried to render.");return}const e=await Zu.loadAdmins();al.set("admins",e||[]),mv(e),fN()}catch(r){console.error(" Error rendering admin management page:",r),mv([]),ur.displayEmptyMessage(Lr.adminManagementContent,`     : ${r.message}`)}finally{ur.hideLoading()}}function Eoe(){Lr.page=document.getElementById("page-admin-management"),Lr.page?(Lr.totalUsers=Lr.page.querySelector("#totalUsers"),Lr.superAdminCount=Lr.page.querySelector("#superAdminCount"),Lr.adminCount=Lr.page.querySelector("#adminCount"),Lr.userCount=Lr.page.querySelector("#userCount"),Lr.adminSearchInput=Lr.page.querySelector("#adminSearchInput"),Lr.addAdminBtn=Lr.page.querySelector("#addAdminBtn"),Lr.adminManagementContent=Lr.page.querySelector("#adminManagementContent")):console.error(" Admin init failed: #page-admin-management element not found!")}function Ioe(){Lr.page&&(ur.addListener(Lr.adminSearchInput,"input",r=>{const e=r.target.value.trim();hN(()=>{al.updateFilters("adminManagement",{searchTerm:e.toLowerCase()}),fN()})}),ur.addListener(Lr.addAdminBtn,"click",Toe),ur.addListener(Lr.adminManagementContent,"click",r=>{var s;const e=r.target.closest(".edit-admin-btn"),t=r.target.closest(".delete-admin-btn"),n=(s=al.get("currentUser"))==null?void 0:s.uid;if(e)Foe(e.dataset.id);else if(t){const i=t.dataset.id;if(i===n){ur.showToast("      ","warning");return}Loe(i)}}))}function mv(r=[]){const e=r.length,t=r.filter(i=>i.type==="super-admin").length,n=r.filter(i=>i.type==="admin").length,s=r.filter(i=>i.type==="user").length;Lr.totalUsers&&(Lr.totalUsers.textContent=bd.convertToBanglaNumber(e)),Lr.superAdminCount&&(Lr.superAdminCount.textContent=bd.convertToBanglaNumber(t)),Lr.adminCount&&(Lr.adminCount.textContent=bd.convertToBanglaNumber(n)),Lr.userCount&&(Lr.userCount.textContent=bd.convertToBanglaNumber(s))}function fN(){var i,a;if(!Lr.adminManagementContent)return;const r=al.get("admins"),e=((i=al.getFilterSection("adminManagement"))==null?void 0:i.searchTerm)||"",t=(a=al.get("currentUser"))==null?void 0:a.uid,n=(r||[]).filter(o=>{if(!e)return!0;const l=(o.email||"").toLowerCase().includes(e),c=(o.type||"").toLowerCase().includes(e);return l||c});if(n.sort((o,l)=>(o.email||"").localeCompare(l.email||"")),ur.clearContainer(Lr.adminManagementContent),n.length===0){ur.displayEmptyMessage(Lr.adminManagementContent," /  ");return}let s=`
        <div class="overflow-x-auto">
            <table class="w-full min-w-[700px] border-collapse">
                <thead>
                    <tr class="bg-gray-100 dark:bg-gray-700">
                        <th class="th"></th>
                        <th class="th"></th>
                        <th class="th text-center"></th>
                        <th class="th text-center"></th>
                    </tr>
                </thead>
                <tbody>
    `;n.forEach(o=>{const c={"super-admin":" ",admin:"",user:""}[o.type]||o.type,A=o.permissions||{},d=o.id!==t;let h="";o.type==="super-admin"?h='<i class="fas fa-star text-yellow-500" title=" "></i>':o.type==="admin"?(h+=A.read?'<i class="fas fa-eye text-green-500 mx-1" title=""></i>':"",h+=A.write?'<i class="fas fa-plus text-blue-500 mx-1" title=""></i>':"",h+=A.edit?'<i class="fas fa-edit text-purple-500 mx-1" title=""></i>':"",h+=A.delete?'<i class="fas fa-trash text-red-500 mx-1" title=""></i>':""):h=A.read?'<i class="fas fa-eye text-green-500 mx-1" title=""></i>':'<i class="fas fa-eye-slash text-gray-400 mx-1" title=" "></i>',s+=`
            <tr class="border-b dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700/50">
                <td class="td p-3">${o.email}</td>
                <td class="td p-3">${c}</td>
                <td class="td p-3 text-center">${h||"-"}</td>
                <td class="td p-3 text-center whitespace-nowrap">
                    <button data-id="${o.id}" class="edit-admin-btn btn btn-light btn-sm p-1 mx-1" aria-label="">
                        <i class="fas fa-edit pointer-events-none"></i>
                    </button>
                    ${d?`
                    <button data-id="${o.id}" class="delete-admin-btn btn btn-danger btn-sm p-1 mx-1" aria-label="">
                        <i class="fas fa-trash pointer-events-none"></i>
                    </button>
                    `:`
                    <span class="inline-block p-1 mx-1" title="    ">
                        <i class="fas fa-trash text-gray-400"></i>
                    </span>
                    `}
                </td>
            </tr>
        `}),s+="</tbody></table></div>",Lr.adminManagementContent.innerHTML=s}function Toe(){cd=null,ur.showAdminModal(" /  ",null,gN)}function Foe(r){if(!(Id!=null&&Id.canEdit())){ur.showToast(" admin    ","warning");return}const e=al.get("admins").find(t=>t.id===r);if(!e){ur.showToast("   ","error");return}cd=r,ur.showAdminModal("/ ",e,gN)}function Loe(r){if(!(Id!=null&&Id.canDelete())){ur.showToast(" admin    ","warning");return}const e=al.get("admins").find(n=>n.id===r);if(!e){ur.showToast("   ","error");return}if(e.type==="super-admin"){ur.showToast("      ","warning");return}const t=`     "${e.email}" (${e.type})    ?   Firestore    , Firebase Auth  `;ur.showDeleteModal("  ",t,async()=>{ur.showLoading("  ...");try{await Zu.deleteAdmin(r),console.warn(`Firestore document for ${e.email} deleted. Corresponding Firebase Auth user MUST be deleted manually or via Cloud Function.`),ur.showToast("Firestore    Auth    ","warning",5e3),await d_.refreshAllData()}catch(n){console.error(" Error deleting admin:",n),ur.showToast(`   : ${n.message}`,"error")}finally{ur.hideLoading()}})}async function gN(){var a,o,l,c,A,d,h;const r=(a=ur.elements.adminEmail)==null?void 0:a.value.trim(),e=(o=ur.elements.adminPassword)==null?void 0:o.value,t=(l=ur.elements.adminTypeSelect)==null?void 0:l.value,n={read:((c=ur.elements.permissionRead)==null?void 0:c.checked)||!1,write:((A=ur.elements.permissionWrite)==null?void 0:A.checked)||!1,edit:((d=ur.elements.permissionEdit)==null?void 0:d.checked)||!1,delete:((h=ur.elements.permissionDelete)==null?void 0:h.checked)||!1};if(!bd.validateEmail(r)){ur.showToast("   ","warning");return}if(!cd&&(!e||e.length<6)){ur.showToast("       ","warning");return}if(cd&&e&&e.length<6){ur.showToast("     ","warning");return}let s={email:r,type:t,permissions:t==="super-admin"?{read:!0,write:!0,edit:!0,delete:!0}:t==="admin"?{read:n.read,write:n.write,edit:!1,delete:!1}:{read:!0,write:!1,edit:!1,delete:!1}};const i=cd?"":"";ur.showLoading(` ${i}  ...`);try{if(cd)await Zu.updateAdmin(cd,s),e?(console.warn(`Password change requested for ${r} but NOT PERFORMED. This requires Admin SDK or re-authentication.`),ur.showToast("      ","warning")):ur.showToast("   ","success");else{if(!confirm(`  :

 admin/user       
 Firebase   

    ?`)){ur.hideLoading();return}if(await uN.registerWithEmail(r,e,t),t==="super-admin"){const f=(await Zu.loadAdmins()).find(g=>g.email===r);f&&await Zu.updateAdmin(f.id,{permissions:s.permissions})}ur.showToast(` ${r}       `,"warning",5e3)}await d_.refreshAllData(),ur.hideModal(ur.elements.adminModal)}catch(u){console.error(` Error ${i}ing admin:`,u),ur.showToast(` ${i}  : ${u.message}`,"error")}finally{ur.hideLoading()}}let Fi,pt,Fu,Du,hx;const qe={},Uoe="",pN=" ",Pr={TASK_NAME:" ",GROUP_NAME:" ",STUDENT_NAME:" ",ROLL:"",TASK_SCORE:" ",TEAM_SCORE:" ",MCQ_SCORE:"MCQ ",Progress_SCORE:" ",TOTAL_SCORE:" ",MAX_SCORE:" ",COMMENTS:"",ACADEMIC_GROUP:" ",STUDENT_ROLE:" "};let j0,mN=!1,bN=!1;const V0="https://www.googleapis.com/auth/drive.file https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/userinfo.profile";let gh=null;const Moe="528853580065-9rhps4e6qhhot629gjqqiolul9a2luum.apps.googleusercontent.com";function Noe(r){return Fi=r.managers.stateManager,pt=r.managers.uiManager,Fu=r.services.dataService,Du=r.utils,hx=r.app,Roe(),Ooe(),Qoe(),Hoe(),console.log(" Export component initialized."),{render:Poe}}function Poe(){if(!qe.page){console.error(" Export render failed: Page element #page-export not found.");return}console.log("Rendering Export page..."),Koe(),Doe()}function Doe(){if(!qe.exportAssignmentFilter)return;const r=Fi.get("tasks")||[],e=qe.exportAssignmentFilter.value;for(;qe.exportAssignmentFilter.options.length>1;)qe.exportAssignmentFilter.remove(1);[...r].sort((n,s)=>{const i=new Date(n.date||0);return new Date(s.date||0)-i}).forEach(n=>{const s=document.createElement("option");s.value=n.id,s.textContent=n.name,qe.exportAssignmentFilter.appendChild(s)}),e&&Array.from(qe.exportAssignmentFilter.options).some(n=>n.value===e)&&(qe.exportAssignmentFilter.value=e)}function Roe(){if(qe.page=document.getElementById("page-export"),qe.page){if(qe.exportStudentsCSVBtn=qe.page.querySelector("#exportStudentsCSVBtn"),qe.exportGroupsCSVBtn=qe.page.querySelector("#exportGroupsCSVBtn"),qe.exportEvaluationsCSVBtn=qe.page.querySelector("#exportEvaluationsCSVBtn"),qe.exportAllDataJSONBtn=qe.page.querySelector("#exportAllDataJSONBtn"),qe.exportAllDataZipBtn=qe.page.querySelector("#exportAllDataZipBtn"),qe.exportGroupFullDetailsPDFBtn=qe.page.querySelector("#exportGroupFullDetailsPDFBtn"),qe.exportAssignmentFilter=qe.page.querySelector("#exportAssignmentFilter"),qe.totalStudentsCount=qe.page.querySelector("#totalStudentsCount"),qe.totalGroupsCount=qe.page.querySelector("#totalGroupsCount"),qe.totalEvaluationsCount=qe.page.querySelector("#totalEvaluationsCount"),qe.lastExportTime=qe.page.querySelector("#lastExportTime"),qe.backupRestoreContainer=qe.page.querySelector("#backupRestoreContainer"),!qe.backupRestoreContainer){const r=document.createElement("div");r.id="backupRestoreContainer",r.className="mt-8",qe.page.appendChild(r),qe.backupRestoreContainer=r}}else console.error(" Export init failed: #page-export element not found!")}function Ooe(){qe.backupRestoreContainer&&(qe.backupRestoreContainer.innerHTML=`
    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden">
      <div class="p-4 border-b border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900/50 flex justify-between items-center">
        <h3 class="text-lg font-semibold text-gray-800 dark:text-gray-200">
          <i class="fas fa-database mr-2 text-indigo-500"></i>  
        </h3>
        <span class="text-xs text-gray-500 bg-gray-200 dark:bg-gray-700 px-2 py-1 rounded">Advanced</span>
      </div>
      
      <div class="p-6 space-y-6">
        <!-- Local Restore -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div class="space-y-3">
            <h4 class="text-sm font-medium text-gray-700 dark:text-gray-300"> </h4>
            <p class="text-xs text-gray-500 dark:text-gray-400">
                 JSON          
            </p>
            <div class="space-y-3">
              <button id="downloadLocalBackupBtn" class="btn btn-primary w-full">
                <i class="fas fa-download mr-2"></i>   (JSON)
              </button>
              
              <div class="relative">
                <div class="absolute inset-0 flex items-center" aria-hidden="true">
                  <div class="w-full border-t border-gray-300 dark:border-gray-600"></div>
                </div>
                <div class="relative flex justify-center">
                  <span class="bg-white dark:bg-gray-800 px-2 text-xs text-gray-500 dark:text-gray-400">  </span>
                </div>
              </div>

              <div class="flex gap-2">
                <input type="file" id="restoreJSONInput" accept=".json" class="hidden" />
                <button id="triggerRestoreBtn" class="btn btn-secondary w-full">
                  <i class="fas fa-upload mr-2"></i>JSON   
                </button>
              </div>
            </div>
          </div>

          <!-- Google Drive -->
          <div class="space-y-3 border-l pl-0 md:pl-6 border-gray-200 dark:border-gray-700">
            <!-- Google Drive Sync -->
            <div class="space-y-3">
              <h4 class="text-sm font-medium text-gray-700 dark:text-gray-300">Google Drive Sync</h4>
              <p class="text-xs text-gray-500 dark:text-gray-400">
                       
              </p>
              
              <div id="gdriveAuthSection">
                <button id="gdriveConnectBtn" class="btn btn-dark w-full">
                  <i class="fab fa-google-drive mr-2"></i>Google Drive  
                </button>
              </div>

              <div id="gdriveActionsSection" class="hidden space-y-3">
                <!-- User Info & Status -->
                <div class="bg-gray-50 dark:bg-gray-800 p-3 rounded-lg border border-gray-200 dark:border-gray-700">
                  <div class="flex items-center justify-between mb-2">
                    <div class="flex items-center gap-2">
                      <img id="gdriveUserAvatar" src="" alt="User" class="w-8 h-8 rounded-full hidden">
                      <div>
                        <p id="gdriveUserEmail" class="text-xs font-medium text-gray-700 dark:text-gray-300">Connected</p>
                        <p class="text-[10px] text-green-600 dark:text-green-400 flex items-center">
                          <i class="fas fa-circle text-[6px] mr-1"></i>Active
                        </p>
                      </div>
                    </div>
                    <button id="gdriveDisconnectBtn" class="text-xs text-red-500 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-900/20 px-2 py-1 rounded transition-colors" title="Disconnect">
                      <i class="fas fa-sign-out-alt"></i>
                    </button>
                  </div>
                  
                  <div class="text-[10px] text-gray-500 dark:text-gray-400 border-t border-gray-200 dark:border-gray-700 pt-2 flex justify-between items-center">
                    <span>Last Backup:</span>
                    <span id="gdriveLastBackupTime" class="font-mono">Checking...</span>
                  </div>
                </div>

                <div class="grid grid-cols-2 gap-2">
                  <button id="gdriveUploadBtn" class="btn btn-success w-full text-xs">
                    <i class="fas fa-cloud-upload-alt mr-1"></i>
                  </button>
                  <button id="gdriveRestoreBtn" class="btn btn-warning w-full text-xs">
                    <i class="fas fa-cloud-download-alt mr-1"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  `,qe.downloadLocalBackupBtn=qe.backupRestoreContainer.querySelector("#downloadLocalBackupBtn"),qe.restoreJSONInput=qe.backupRestoreContainer.querySelector("#restoreJSONInput"),qe.triggerRestoreBtn=qe.backupRestoreContainer.querySelector("#triggerRestoreBtn"),qe.gdriveConnectBtn=qe.backupRestoreContainer.querySelector("#gdriveConnectBtn"),qe.gdriveDisconnectBtn=qe.backupRestoreContainer.querySelector("#gdriveDisconnectBtn"),qe.gdriveUploadBtn=qe.backupRestoreContainer.querySelector("#gdriveUploadBtn"),qe.gdriveRestoreBtn=qe.backupRestoreContainer.querySelector("#gdriveRestoreBtn"),qe.gdriveAuthSection=qe.backupRestoreContainer.querySelector("#gdriveAuthSection"),qe.gdriveActionsSection=qe.backupRestoreContainer.querySelector("#gdriveActionsSection"),qe.gdriveUserAvatar=qe.backupRestoreContainer.querySelector("#gdriveUserAvatar"),qe.gdriveUserEmail=qe.backupRestoreContainer.querySelector("#gdriveUserEmail"),qe.gdriveLastBackupTime=qe.backupRestoreContainer.querySelector("#gdriveLastBackupTime"))}function Qoe(){qe.page&&(pt.addListener(qe.exportStudentsCSVBtn,"click",qoe),pt.addListener(qe.exportGroupsCSVBtn,"click",Woe),pt.addListener(qe.exportEvaluationsCSVBtn,"click",Yoe),pt.addListener(qe.exportAllDataJSONBtn,"click",nI),pt.addListener(qe.exportAllDataZipBtn,"click",Xoe),pt.addListener(qe.exportGroupFullDetailsPDFBtn,"click",()=>{var r;if((r=hx.components.analysis)!=null&&r.generateGroupWiseFullDetailsPDF){pt.showToast("    PDF  ...","info");const e=qe.exportAssignmentFilter?qe.exportAssignmentFilter.value:"all";hx.components.analysis.generateGroupWiseFullDetailsPDF(e)}else pt.showToast("      ","error")}),qe.downloadLocalBackupBtn&&pt.addListener(qe.downloadLocalBackupBtn,"click",nI),qe.triggerRestoreBtn&&qe.restoreJSONInput&&(pt.addListener(qe.triggerRestoreBtn,"click",()=>qe.restoreJSONInput.click()),pt.addListener(qe.restoreJSONInput,"change",r=>{const e=r.target.files[0];e&&zoe(e),r.target.value=""})),qe.gdriveConnectBtn&&pt.addListener(qe.gdriveConnectBtn,"click",joe),qe.gdriveDisconnectBtn&&pt.addListener(qe.gdriveDisconnectBtn,"click",Voe),qe.gdriveUploadBtn&&pt.addListener(qe.gdriveUploadBtn,"click",$oe),qe.gdriveRestoreBtn&&pt.addListener(qe.gdriveRestoreBtn,"click",Goe))}function Hoe(){const r=document.createElement("script");r.src="https://apis.google.com/js/api.js",r.onload=()=>{gapi.load("client",async()=>{mN=!0,rI()})},document.head.appendChild(r);const e=document.createElement("script");e.src="https://accounts.google.com/gsi/client",e.onload=()=>{bN=!0,rI()},document.head.appendChild(e)}function rI(){if(mN&&bN){console.log("Google APIs loaded.");const r=localStorage.getItem("gdrive_access_token");r&&(console.log("Restoring Drive session from storage..."),gh=r,u_(!0),yN(r),_y(r))}}async function joe(){try{await gapi.client.init({discoveryDocs:[]}),j0=google.accounts.oauth2.initTokenClient({client_id:Moe,scope:V0,callback:""}),j0.callback=async r=>{if(r.error)throw r;if(console.log("Granted Scopes:",r.scope),!google.accounts.oauth2.hasGrantedAllScopes(r,...V0.split(" "))){pt.showToast("Google Drive   ","error");return}gh=r.access_token,localStorage.setItem("gdrive_access_token",r.access_token),u_(!0),pt.showToast("Google Drive  !","success"),yN(r.access_token),_y(r.access_token)},gapi.client.getToken()===null?j0.requestAccessToken({prompt:"consent",scope:V0}):j0.requestAccessToken({prompt:"consent",scope:V0})}catch(r){console.error("Drive Auth Error:",r),pt.showToast("Google Drive   ","error")}}function u_(r){r?(qe.gdriveAuthSection.classList.add("hidden"),qe.gdriveActionsSection.classList.remove("hidden")):(qe.gdriveAuthSection.classList.remove("hidden"),qe.gdriveActionsSection.classList.add("hidden"))}function Voe(){pt.showDeleteModal("Disconnect Drive?","     Google Drive   ?",()=>{Cb(),pt.showToast("Google Drive   ","info")})}function Cb(){const r=gapi.client.getToken(),e=(r==null?void 0:r.access_token)||gh;e&&google.accounts.oauth2.revoke(e,()=>{console.log("Access token revoked")}),gapi.client.setToken(null),gh=null,localStorage.removeItem("gdrive_access_token"),u_(!1)}async function yN(r){try{console.log("Fetching user info...");const e=await fetch("https://www.googleapis.com/oauth2/v3/userinfo",{headers:{Authorization:"Bearer "+r}});if(e.status===401){console.warn("User info fetch 401: Token invalid. Disconnecting..."),Cb();return}if(e.ok){const t=await e.json();console.log("User Data received:",t),qe.gdriveUserEmail&&(qe.gdriveUserEmail.textContent=t.email),qe.gdriveUserAvatar&&(qe.gdriveUserAvatar.src=t.picture||"",qe.gdriveUserAvatar.classList.toggle("hidden",!t.picture))}else console.warn("User info fetch failed:",e.status)}catch(e){console.error("Error fetching user info:",e)}}async function h_(r){const e="Smart Evaluate Backup System",t=`mimeType = 'application/vnd.google-apps.folder' and name = '${e}' and trashed = false`;try{const n=await fetch(`https://www.googleapis.com/drive/v3/files?q=${encodeURIComponent(t)}&fields=files(id)`,{headers:{Authorization:"Bearer "+r}});if(n.status===401)throw new Error("401 Unauthorized");if(!n.ok)throw new Error("Folder search failed");const s=await n.json();if(s.files&&s.files.length>0)return s.files[0].id;const i={name:e,mimeType:"application/vnd.google-apps.folder"},a=await fetch("https://www.googleapis.com/drive/v3/files",{method:"POST",headers:{Authorization:"Bearer "+r,"Content-Type":"application/json"},body:JSON.stringify(i)});if(!a.ok)throw new Error("Folder creation failed");return(await a.json()).id}catch(n){throw console.error("Error getting/creating backup folder:",n),n}}async function _y(r){try{qe.gdriveLastBackupTime&&(qe.gdriveLastBackupTime.textContent="Checking...");let e;try{e=await h_(r)}catch(s){if(s.message&&s.message.includes("401")){console.warn("Backup folder check 401. Disconnecting..."),Cb();return}console.warn("Could not get backup folder for checking time, falling back to root search",s)}let t="mimeType = 'application/json' and trashed = false";e&&(t+=` and '${e}' in parents`);const n=await fetch(`https://www.googleapis.com/drive/v3/files?q=${encodeURIComponent(t)}&orderBy=createdTime desc&pageSize=1&fields=files(createdTime)`,{headers:{Authorization:"Bearer "+r}});if(n.status===401){console.warn("Last backup fetch 401. Disconnecting..."),Cb();return}if(n.ok){const s=await n.json();if(s.files&&s.files.length>0){const i=new Date(s.files[0].createdTime).toLocaleString("bn-BD");qe.gdriveLastBackupTime&&(qe.gdriveLastBackupTime.textContent=i)}else qe.gdriveLastBackupTime&&(qe.gdriveLastBackupTime.textContent="No backup found")}}catch(e){console.error("Error fetching last backup time:",e),qe.gdriveLastBackupTime&&(qe.gdriveLastBackupTime.textContent="Error")}}async function $oe(){var r,e;pt.showLoading("Google Drive-  ...");try{const t=gapi.client.getToken(),n=(t==null?void 0:t.access_token)||gh;if(!n){pt.showToast("    ","error"),pt.hideLoading();return}const{groups:s,students:i,tasks:a,evaluations:o,admins:l}=Fi.getState(),c={exportDate:new Date().toISOString(),groups:s,students:i,tasks:a,evaluations:o,admins:((r=Fi.get("currentUserData"))==null?void 0:r.type)==="super-admin"?l:void 0},A=JSON.stringify(c,null,2),d=`smart_evaluator_backup_${new Date().toISOString().split("T")[0]}.json`,h=await h_(n),u=new Blob([A],{type:"application/json"}),p={name:d,mimeType:"application/json",parents:[h]},f=new FormData;f.append("metadata",new Blob([JSON.stringify(p)],{type:"application/json"})),f.append("file",u);const g=await fetch("https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart&fields=id",{method:"POST",headers:new Headers({Authorization:"Bearer "+n}),body:f}),m=await g.json();if(!g.ok)throw console.error("Drive API Error Details:",m),new Error(((e=m.error)==null?void 0:e.message)||"Upload failed");if(m.id)pt.showToast("    !","success"),_y(n);else throw new Error("Upload failed")}catch(t){console.error("Drive Upload Error:",t),pt.showToast("   ","error")}finally{pt.hideLoading()}}async function Goe(){pt.showLoading("   ...");try{const r=gapi.client.getToken(),e=(r==null?void 0:r.access_token)||gh;if(!e){pt.showToast("    ","error"),pt.hideLoading();return}let t;try{t=await h_(e)}catch(c){console.warn("Could not get backup folder for restore, falling back to root search",c)}let n="mimeType = 'application/json' and trashed = false";t&&(n+=` and '${t}' in parents`);const a=(await(await fetch(`https://www.googleapis.com/drive/v3/files?q=${encodeURIComponent(n)}&orderBy=createdTime desc&pageSize=10&fields=files(id, name, createdTime)`,{headers:{Authorization:"Bearer "+e}})).json()).files;if(!a||a.length===0){pt.showToast("    ","info"),pt.hideLoading();return}const o=a[0],l=`    :
: ${o.name}
: ${new Date(o.createdTime).toLocaleString("bn-BD")}`;pt.hideLoading(),pt.showConfirmModal(" ",l,async()=>{pt.showLoading("   ...");try{const c=o.id,A=await fetch(`https://www.googleapis.com/drive/v3/files/${c}?alt=media`,{headers:{Authorization:"Bearer "+e}});if(!A.ok)throw new Error("Download failed");const d=await A.json();await wN(d),pt.showToast("   !","success"),_y(e)}catch(c){console.error("Restore Error:",c),pt.showToast("  ","error")}finally{pt.hideLoading()}}," ","btn-warning")}catch(r){console.error("Drive Restore Error:",r),pt.showToast("    ","error")}finally{pt.hideLoading()}}async function zoe(r){pt.showLoading("    ...");const e=new FileReader;e.onload=async t=>{try{const n=JSON.parse(t.target.result);await wN(n)}catch(n){console.error("JSON Parse Error:",n),pt.showToast(" JSON ","error"),pt.hideLoading()}},e.readAsText(r)}async function wN(r){pt.showLoading("  ...    ");try{if(!r.students&&!r.groups&&!r.tasks)throw new Error("    ");r.groups&&await Fu.restoreCollection("groups",r.groups),r.students&&await Fu.restoreCollection("students",r.students),r.tasks&&await Fu.restoreCollection("tasks",r.tasks),r.evaluations&&await Fu.restoreCollection("evaluations",r.evaluations),r.admins&&await Fu.restoreCollection("admins",r.admins),pt.showToast("    !   ...","success"),setTimeout(()=>{window.location.reload()},2e3)}catch(e){console.error("Restore Error:",e),pt.showToast(` : ${e.message}`,"error"),pt.hideLoading()}}function Koe(){const{students:r,groups:e,evaluations:t}=Fi.getState(),n=(i,a)=>{i&&(i.textContent=Du.convertToBanglaNumber(a))};n(qe.totalStudentsCount,(r==null?void 0:r.length)||0),n(qe.totalGroupsCount,(e==null?void 0:e.length)||0),n(qe.totalEvaluationsCount,(t==null?void 0:t.length)||0);const s=localStorage.getItem("lastExportTimestamp");qe.lastExportTime&&(qe.lastExportTime.textContent=s?new Date(s).toLocaleTimeString("bn-BD",{hour:"numeric",minute:"2-digit"}):"-")}async function qoe(){pt.showLoading(" CSV  ...");try{const r=Fi.get("students")||[],e=Fi.get("groups")||[],t=new Map(e.map(i=>[i.id,i.name])),n=r.map(i=>({:i.name,:i.roll,:i.gender," ":i.academicGroup,:i.session,:i.contact||""," ":t.get(i.groupId)||""," ":i.role||""})).sort((i,a)=>(i.||"").localeCompare(a.||"","bn"));if(n.length===0){pt.showToast("     ","info");return}const s=Papa.unparse(n,{header:!0});up(s,"students_export.csv","text/csv;charset=utf-8;"),pt.showToast(" CSV    ","success")}catch(r){console.error(" Error exporting students CSV:",r),pt.showToast(`CSV   : ${r.message}`,"error")}finally{pt.hideLoading(),hp()}}async function Woe(){pt.showLoading(" CSV  ...");try{const r=Fi.get("groups")||[],e=Fi.get("students")||[],t=r.map(s=>({" ":s.name," ":e.filter(i=>i.groupId===s.id).length})).sort((s,i)=>(s[" "]||"").localeCompare(i[" "]||"","bn"));if(t.length===0){pt.showToast("     ","info");return}const n=Papa.unparse(t,{header:!0});up(n,"groups_export.csv","text/csv;charset=utf-8;"),pt.showToast(" CSV    ","success")}catch(r){console.error(" Error exporting groups CSV:",r),pt.showToast(`CSV   : ${r.message}`,"error")}finally{pt.hideLoading(),hp()}}async function Yoe(){pt.showLoading(" CSV  ...");try{const r=Fi.get("evaluations")||[],e=Fi.get("students")||[],t=Fi.get("tasks")||[],n=Fi.get("groups")||[],s=new Map(e.map(c=>[c.id,c])),i=new Map(t.map(c=>[c.id,c])),a=new Map(n.map(c=>[c.id,c.name])),o=[];if(r.forEach(c=>{const A=i.get(c.taskId),d=a.get(c.groupId)||c.groupName||"",h=(A==null?void 0:A.name)||c.taskName||"",u=(A==null?void 0:A.date)||c.taskDate||"",{display:p,sortValue:f}=fx(u),g=Number.parseFloat(c.maxPossibleScore)||Number.parseFloat(A==null?void 0:A.maxScore)||(typeof TOTAL_MAX_SCORE<"u"?TOTAL_MAX_SCORE:"");c!=null&&c.scores&&typeof c.scores=="object"&&Object.entries(c.scores).forEach(([m,x={}])=>{const S=s.get(String(m));if(!S)return;const B={[Pr.TASK_NAME]:h,[Pr.GROUP_NAME]:d,[Pr.STUDENT_NAME]:S.name??"",[Pr.ROLL]:S.roll??"",[Pr.ACADEMIC_GROUP]:S.academicGroup??"",[Pr.STUDENT_ROLE]:S.role??"",[Pr.TASK_SCORE]:x.taskScore??"",[Pr.TEAM_SCORE]:x.teamScore??"",[Pr.MCQ_SCORE]:x.mcqScore??"",[Pr.Progress_SCORE]:x.ProgressScore??"",[Pr.TOTAL_SCORE]:x.totalScore??"",[Pr.MAX_SCORE]:g??"",[Pr.COMMENTS]:x.comments??"",[pN]:p??"",__sortDate:f??Number.NEGATIVE_INFINITY};o.push(B)})}),o.length===0){pt.showToast("     ","info");return}o.sort((c,A)=>{const d=(A.__sortDate??Number.NEGATIVE_INFINITY)-(c.__sortDate??Number.NEGATIVE_INFINITY);if(d!==0)return d;const h=String(c[Pr.GROUP_NAME]||"").localeCompare(String(A[Pr.GROUP_NAME]||""),"bn");return h!==0?h:String(c[Pr.ROLL]||"").localeCompare(String(A[Pr.ROLL]||""),void 0,{numeric:!0})}),o.forEach(c=>delete c.__sortDate);const l=Papa.unparse(o,{header:!0});up(l,"evaluations_export.csv","text/csv;charset=utf-8;"),pt.showToast(" CSV    ","success")}catch(r){console.error(" Error exporting evaluations CSV:",r),pt.showToast(`CSV   : ${r.message}`,"error")}finally{pt.hideLoading(),hp()}}function nI(){var r;pt.showLoading("JSON   ...");try{const{groups:e,students:t,tasks:n,evaluations:s,admins:i}=Fi.getState(),a={exportDate:new Date().toISOString(),groups:e,students:t,tasks:n,evaluations:s,admins:((r=Fi.get("currentUserData"))==null?void 0:r.type)==="super-admin"?i:void 0},o=JSON.stringify(a,null,2);up(o,"smart_evaluator_backup.json","application/json;charset=utf-8;"),pt.showToast("  JSON    ","success")}catch(e){console.error(" Error exporting all data JSON:",e),pt.showToast(`JSON   : ${e.message}`,"error")}finally{pt.hideLoading(),hp()}}async function Xoe(){const r=window.JSZip;if(!r){pt.showToast("ZIP  (JSZip)   ","error"),console.error("JSZip library not found. Please include it in index.html");return}pt.showLoading("ZIP   ...");try{const e=new r,{groups:t=[],students:n=[],tasks:s=[],evaluations:i=[]}=Fi.getState(),a="\uFEFF",o=new Map(t.map(f=>[f.id,f.name])),l=n.map(f=>({:f.name,:f.roll,:f.gender," ":f.academicGroup,:f.session,:f.contact||""," ":o.get(f.groupId)||""," ":f.role||""})).sort((f,g)=>(f.||"").localeCompare(g.||"","bn"));l.length>0&&e.file("students.csv",a+Papa.unparse(l));const c=t.map(f=>({" ":f.name," ":n.filter(g=>g.groupId===f.id).length})).sort((f,g)=>(f[" "]||"").localeCompare(g[" "]||"","bn"));c.length>0&&e.file("groups.csv",a+Papa.unparse(c));const A=s.map(f=>{var S,B,F,N;const{display:g,sortValue:m}=fx(f.date),x={" ":f.name,"  ":f.maxScore,_:(S=f.maxScoreBreakdown)==null?void 0:S.task,_:(B=f.maxScoreBreakdown)==null?void 0:B.team,_:(F=f.maxScoreBreakdown)==null?void 0:F.Progress,_MCQ:(N=f.maxScoreBreakdown)==null?void 0:N.mcq,:f.description||""};return x[Uoe]=g,x.__sortDate=m,x}).sort((f,g)=>{const m=(g.__sortDate??Number.NEGATIVE_INFINITY)-(f.__sortDate??Number.NEGATIVE_INFINITY);return m!==0?m:String(f[" "]||"").localeCompare(String(g[" "]||""),"bn")});A.forEach(f=>delete f.__sortDate),A.length>0&&e.file("tasks.csv",a+Papa.unparse(A));const d=new Map(n.map(f=>[f.id,f])),h=new Map(s.map(f=>[f.id,f])),u=[];i.forEach(f=>{const g=h.get(f.taskId),m=o.get(f.groupId)||f.groupName||"",x=(g==null?void 0:g.name)||f.taskName||"",S=(g==null?void 0:g.date)||f.taskDate||"",{display:B,sortValue:F}=fx(S),N=Number.parseFloat(f.maxPossibleScore)||Number.parseFloat(g==null?void 0:g.maxScore)||(typeof TOTAL_MAX_SCORE<"u"?TOTAL_MAX_SCORE:"");f!=null&&f.scores&&typeof f.scores=="object"&&Object.entries(f.scores).forEach(([E,w={}])=>{const v=d.get(E);if(!v)return;const I={[Pr.TASK_NAME]:x,[Pr.GROUP_NAME]:m,[Pr.STUDENT_NAME]:v.name??"",[Pr.ROLL]:v.roll??"",[Pr.ACADEMIC_GROUP]:v.academicGroup??"",[Pr.STUDENT_ROLE]:v.role??"",[Pr.TASK_SCORE]:w.taskScore??"",[Pr.TEAM_SCORE]:w.teamScore??"",[Pr.MCQ_SCORE]:w.mcqScore??"",[Pr.Progress_SCORE]:w.ProgressScore??"",[Pr.TOTAL_SCORE]:w.totalScore??"",[Pr.MAX_SCORE]:N??"",[Pr.COMMENTS]:w.comments??""};I[pN]=B??"",I.__sortDate=F??Number.NEGATIVE_INFINITY,u.push(I)})}),u.length>0&&(u.sort((f,g)=>{const m=(g.__sortDate??Number.NEGATIVE_INFINITY)-(f.__sortDate??Number.NEGATIVE_INFINITY);if(m!==0)return m;const x=String(f[Pr.GROUP_NAME]||"").localeCompare(String(g[Pr.GROUP_NAME]||""),"bn");return x!==0?x:String(f[Pr.ROLL]||"").localeCompare(String(g[Pr.ROLL]||""),void 0,{numeric:!0})}),u.forEach(f=>delete f.__sortDate),e.file("evaluations_detailed.csv",a+Papa.unparse(u)));const p=await e.generateAsync({type:"blob"});up(p,`smart_evaluator_backup_${new Date().toISOString().split("T")[0]}.zip`),pt.showToast("  ZIP    ","success")}catch(e){console.error(" Error exporting all data ZIP:",e),pt.showToast(`ZIP   : ${e.message}`,"error")}finally{pt.hideLoading(),hp()}}function fx(r){if(r==null||r==="")return{display:"",sortValue:Number.NEGATIVE_INFINITY};let e=null;if(r instanceof Date)e=r;else if(typeof r=="number")e=new Date(r);else if(typeof r=="string"){const s=Date.parse(r);Number.isNaN(s)||(e=new Date(s))}else if(typeof r=="object")if(typeof r.toDate=="function")try{e=r.toDate()}catch{e=null}else typeof r.seconds=="number"&&(e=new Date(r.seconds*1e3));const t=Du!=null&&Du.formatTimestamp?Du.formatTimestamp(e||r):e?e.toISOString().split("T")[0]:String(r??"");let n=Number.NEGATIVE_INFINITY;if(e instanceof Date&&!Number.isNaN(e.getTime()))n=e.getTime();else if(typeof r=="number"&&Number.isFinite(r))n=r;else if(typeof r=="string"){const s=Date.parse(r);Number.isNaN(s)||(n=s)}return{display:t||"",sortValue:n}}function up(r,e,t=""){const n=t.startsWith("text/csv")&&typeof r=="string"?`\uFEFF${r}`:r,s=n instanceof Blob?n:new Blob([n],{type:t}),i=document.createElement("a"),a=URL.createObjectURL(s);i.href=a,i.download=e,document.body.appendChild(i),i.click(),setTimeout(()=>{document.body.removeChild(i),window.URL.revokeObjectURL(a)},100)}function hp(){const r=new Date,e=r.toLocaleTimeString("bn-BD",{hour:"numeric",minute:"2-digit"});qe.lastExportTime&&(qe.lastExportTime.textContent=e),localStorage.setItem("lastExportTimestamp",r.toISOString())}let Wo;const og={},f_=[{title:" ",icon:"fas fa-users",tone:"indigo",rules:["  -    (  )","         ","      ","          "]},{title:" ",icon:"fas fa-sitemap",tone:"emerald",rules:["   :  ,  ,  , ,   ","          (  )"," ,         "]},{title:" ",icon:"fas fa-clipboard-check",tone:"amber",rules:["     , MCQ = 40 , = 100 ","   : / ( ),  ( ),   ( )","      ",":    (+),   (+)"]},{title:"  ",icon:"fas fa-trophy",tone:"purple",rules:["   (  )     ","           ","         ","      "]}],sI={indigo:{icon:"bg-indigo-100 text-indigo-700",dot:"bg-indigo-500",border:"border-indigo-100"},emerald:{icon:"bg-emerald-100 text-emerald-700",dot:"bg-emerald-500",border:"border-emerald-100"},amber:{icon:"bg-amber-100 text-amber-700",dot:"bg-amber-500",border:"border-amber-100"},purple:{icon:"bg-purple-100 text-purple-700",dot:"bg-purple-500",border:"border-purple-100"}};let lg=[...f_];function Joe(r){return r.managers.uiManager,Wo=r.utils,rle(),Ug(),console.log(" Policy component initialized."),{render:Ug,setPolicyData:Zoe,expandAll:ele,collapseAll:tle}}function Ug(){if(!og.page||!og.policySectionsContainer)return;const e=(Array.isArray(lg)&&lg.length?lg:f_).map(nle).join("");og.policySectionsContainer.innerHTML=`
    <div class="grid gap-4 lg:grid-cols-2" aria-live="polite">
      ${e}
    </div>
  `}function Zoe(r=[]){Array.isArray(r)&&r.length?lg=r.map(sle):lg=[...f_],Ug()}function ele(){Ug()}function tle(){Ug()}function rle(){og.page=document.getElementById("page-group-policy"),og.policySectionsContainer=document.getElementById("policySections")}function nle(r,e){const{title:t,icon:n,rules:s,tone:i}=r,a=sI[i]||sI.indigo,o=s.map(c=>`
        <li class="flex gap-3">
          <span class="mt-2 h-2 w-2 rounded-full ${a.dot}"></span>
          <span class="text-sm text-gray-600 dark:text-gray-300">${aI(c)}</span>
        </li>`).join(""),l=Wo!=null&&Wo.convertToBanglaNumber?Wo.convertToBanglaNumber(String(e+1)):e+1;return`
    <article class="rounded-2xl border ${a.border} bg-white dark:bg-gray-900/80 p-4 shadow-sm hover:shadow-xl transition-shadow duration-300">
      <div class="flex items-center gap-3">
        <span class="flex h-10 w-10 items-center justify-center rounded-xl ${a.icon}">
          <i class="${n} text-base"></i>
        </span>
        <div>
          <p class="text-[10px] font-semibold text-gray-400"> ${l}</p>
          <h3 class="text-base font-semibold text-gray-900 dark:text-white">${aI(t)}</h3>
        </div>
      </div>
      <ul class="mt-3 space-y-1.5">${o}</ul>
    </article>
  `}function sle(r={}){const e=Array.isArray(r.rules)?r.rules.map(t=>iI(t)).filter(Boolean):[];return{title:iI(r.title)||" ",icon:r.icon||"fas fa-book-open",tone:r.tone||"indigo",rules:e.length?e:["    "]}}function iI(r){return r?Wo!=null&&Wo.ensureBengaliText&&typeof Wo.ensureBengaliText=="function"?Wo.ensureBengaliText(r):typeof r=="string"?r.trim():String(r).trim():""}function aI(r){return String(r||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}let Ms,Td,Kl;const dr={};let $0=null;const vN=["upcoming","ongoing","completed"],uo={upcoming:{label:" ",chip:"bg-sky-100 text-sky-700 dark:bg-sky-900/30 dark:text-sky-200",card:"border-sky-100 dark:border-sky-800/60",icon:"fas fa-calendar-plus text-sky-500"},ongoing:{label:" ",chip:"bg-amber-100 text-amber-700 dark:bg-amber-900/30 dark:text-amber-200",card:"border-amber-100 dark:border-amber-800/60",icon:"fas fa-spinner text-amber-500"},completed:{label:" ",chip:"bg-emerald-100 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-200",card:"border-emerald-100 dark:border-emerald-800/60",icon:"fas fa-check-circle text-emerald-500"}},Im={active:"upcoming"},Ls={classId:"",sectionId:"",subjectId:""},ile=["all","upcoming","ongoing","completed"],ale={all:{label:" ",description:" ",icon:"fas fa-layer-group",theme:"slate"},upcoming:{label:uo.upcoming.label,description:" ",icon:uo.upcoming.icon,theme:"sky"},ongoing:{label:uo.ongoing.label,description:" ",icon:uo.ongoing.icon,theme:"amber"},completed:{label:uo.completed.label,description:" ",icon:uo.completed.icon,theme:"emerald"}},ole=11,lle=55,cle=0,Ale=["","","","","","","","","","","",""],dle=["","","","","","",""];function ule(r){return Ms=r.managers.stateManager,Td=r.managers.uiManager,Kl=r.utils,gle(),ple(),hle(),fle(),console.log(" UpcomingAssignments (focus-first + 10:20 rule + soft 3D + rose chef) initialized."),{render:g_}}function hle(){dr.page=document.getElementById("page-upcoming-assignments"),dr.summary=document.getElementById("upcomingAssignmentSummary"),dr.list=document.getElementById("upcomingAssignmentsList"),dr.filter=document.getElementById("assignmentStatusFilter"),dr.filter&&(dr.filter.classList.add("hidden"),dr.filter.setAttribute("aria-hidden","true"),dr.filter.style.display="none"),dr.filtersContainer=null,dr.classFilter=null,dr.sectionFilter=null,dr.subjectFilter=null}function fle(){Td.addListener(document,"keydown",r=>{r.key==="Escape"&&(document.querySelectorAll('[data-acc-panel][data-open="true"]').forEach(e=>SN(e,!1)),document.querySelectorAll('[data-acc-btn][aria-expanded="true"]').forEach(e=>e.setAttribute("aria-expanded","false")))})}function gle(){if(document.getElementById("ua-tabs-styles"))return;const r=document.createElement("style");r.id="ua-tabs-styles",r.textContent=`
  .ua-tabbar {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    justify-content: center;
    padding: 0.25rem;
    background: transparent;
  }
  
  .ua-tab {
    position: relative;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.4rem 0.8rem;
    border-radius: 10px;
    border: 1px solid rgba(148, 163, 184, 0.2);
    background: rgba(255, 255, 255, 0.6);
    color: #475569;
    cursor: pointer;
    transition: all 0.3s ease;
    backdrop-filter: blur(8px);
    overflow: hidden;
    min-width: 130px;
    flex: 1 1 auto;
  }

  .dark .ua-tab {
    background: rgba(30, 41, 59, 0.6);
    border-color: rgba(148, 163, 184, 0.1);
    color: #94a3b8;
  }

  .ua-tab:hover {
    background: rgba(255, 255, 255, 0.9);
    transform: translateY(-1px);
  }
  .dark .ua-tab:hover {
    background: rgba(30, 41, 59, 0.9);
  }

  /* Active State */
  .ua-tab[aria-selected="true"] {
    background: #fff;
    color: #0f172a;
    border-color: transparent;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
  }
  .dark .ua-tab[aria-selected="true"] {
    background: #1e293b;
    color: #fff;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
  }

  /* Animated Border Gradient */
  .ua-tab[aria-selected="true"]::before {
    content: "";
    position: absolute;
    inset: 0;
    border-radius: 12px;
    padding: 2px;
    background: linear-gradient(90deg, #3b82f6, #8b5cf6, #ec4899, #3b82f6);
    background-size: 300% 100%;
    -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
    -webkit-mask-composite: xor;
    mask-composite: exclude;
    animation: borderFlow 3s linear infinite;
    pointer-events: none;
  }

  @keyframes borderFlow {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
  }

  /* Theme Colors */
  .ua-tab[aria-selected="true"][data-theme="sky"] { color: #0284c7; }
  .dark .ua-tab[aria-selected="true"][data-theme="sky"] { color: #38bdf8; }

  .ua-tab[aria-selected="true"][data-theme="amber"] { color: #d97706; }
  .dark .ua-tab[aria-selected="true"][data-theme="amber"] { color: #fbbf24; }

  .ua-tab[aria-selected="true"][data-theme="emerald"] { color: #059669; }
  .dark .ua-tab[aria-selected="true"][data-theme="emerald"] { color: #34d399; }

  /* Elements */
  .ua-tab-icon {
    font-size: 1.1rem;
    color: inherit;
    opacity: 0.8;
  }
  
  .ua-tab-label {
    font-size: 0.95rem;
    font-weight: 600;
    z-index: 1;
  }

  .ua-tab-count {
    font-size: 0.85rem;
    padding: 0.15rem 0.6rem;
    border-radius: 999px;
    background: rgba(0, 0, 0, 0.05);
    font-weight: 700;
    z-index: 1;
    margin-left: auto;
  }
  .dark .ua-tab-count {
    background: rgba(255, 255, 255, 0.1);
  }
  
  .ua-tab[aria-selected="true"] .ua-tab-count {
    background: currentColor;
    color: #fff;
    opacity: 0.9;
  }
  .dark .ua-tab[aria-selected="true"] .ua-tab-count {
    color: #1e293b;
  }

  .ua-tab-desc { display: none; }

  /* Mobile Layout */
  @media (max-width: 640px) {
    .ua-tabbar {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 0.75rem;
    }
    .ua-tab {
      display: grid;
      grid-template-columns: 1fr auto;
      grid-template-areas: 
        "icon count"
        "label label";
      align-items: center;
      padding: 1rem;
      min-width: 0;
      width: 100%;
      gap: 0.5rem;
      text-align: left;
    }
    
    .ua-tab-icon {
      grid-area: icon;
      justify-self: start;
      font-size: 1.5rem;
      margin: 0;
      opacity: 1;
    }

    .ua-tab-count {
      grid-area: count;
      justify-self: end;
      font-size: 1.5rem;
      background: transparent !important;
      padding: 0;
      border: none;
      line-height: 1;
      color: inherit !important;
      opacity: 1 !important;
      margin: 0;
      font-weight: 700;
    }

    .ua-tab-label {
      grid-area: label;
      justify-self: start;
      text-align: left;
      font-size: 0.85rem;
      opacity: 0.9;
      font-weight: 600;
      width: 100%;
      margin: 0;
      white-space: normal;
      line-height: 1.3;
    }
  }
  `,document.head.appendChild(r)}function ple(){if(document.getElementById("ua-pill-styles"))return;const r=document.createElement("style");r.id="ua-pill-styles",r.textContent=`
  /* Countdown pill (with conditional colors) */
  .cd-pill{
    display:inline-flex; align-items:center; gap:.45rem;
    border-radius:.7rem; padding:.28rem .65rem;
    font-weight:700; font-size:.875rem; line-height:1.1;
    border:1px solid var(--border);
    background: var(--surface-2);
    box-shadow: var(--inner-highlight);
    white-space:nowrap;
  }
  .cd-green{ color:#166534; background:rgba(187,247,208,.65); border-color:rgba(22,101,52,.25); }
  .dark .cd-green{ color:#A7F3D0; background:rgba(6,95,70,.35); border-color:rgba(167,243,208,.2); }
  .cd-amber{ color:#92400e; background:rgba(254,243,199,.65); border-color:rgba(146,64,14,.25); }
  .dark .cd-amber{ color:#FDE68A; background:rgba(120,53,15,.35); border-color:rgba(253,230,138,.2); }
  .cd-red{ color:#7f1d1d; background:rgba(254,226,226,.85); border-color:rgba(127,29,29,.22); }
  .dark .cd-red{ color:#fecaca; background:rgba(127,29,29,.28); border-color:rgba(254,202,202,.18); }
  @keyframes uablink { 0%, 60%, 100% { opacity:1 } 30% { opacity:.35 } }
  .cd-blink { animation: uablink 1.2s linear infinite; }

  /* Flat schedule pill aligned with countdown colors */
  .sched-pill{
    display:inline-flex; flex-wrap:wrap; align-items:center; gap:.45rem;
    border-radius:.75rem; padding:.35rem .8rem;
    font-size:.88rem; line-height:1.15;
    font-weight:600;
    border:1px solid rgba(148,163,184,.35);
    background: rgba(248,250,252,.85);
    color:#0f172a;
    white-space:normal;
    box-shadow: var(--inner-highlight);
  }
  .dark .sched-pill{
    background: rgba(30,41,59,.45);
    border-color: rgba(148,163,184,.35);
    color:#e2e8f0;
  }
  .sched-pill__label{
    font-weight:700;
    letter-spacing:.01em;
  }
  .sched-pill__value{
    font-weight:600;
  }
  .sched-pill[data-status="upcoming"]{
    background: rgba(16,185,129,.15);
    border-color: rgba(16,185,129,.35);
    color:#065f46;
  }
  .dark .sched-pill[data-status="upcoming"]{
    background: rgba(5,150,105,.35);
    border-color: rgba(16,185,129,.45);
    color:#a7f3d0;
  }
  .sched-pill[data-status="ongoing"]{
    background: rgba(251,191,36,.2);
    border-color: rgba(245,158,11,.35);
    color:#7c2d12;
  }
  .dark .sched-pill[data-status="ongoing"]{
    background: rgba(120,53,15,.35);
    border-color: rgba(251,191,36,.45);
    color:#fde68a;
  }
  .sched-pill[data-status="completed"]{
    background: rgba(148,163,184,.25);
    border-color: rgba(71,85,105,.35);
    color:#1f2937;
  }
  .dark .sched-pill[data-status="completed"]{
    background: rgba(30,41,59,.55);
    border-color: rgba(148,163,184,.45);
    color:#cbd5f5;
  }
  `,document.head.appendChild(r)}function gx(r){if(!r)return null;try{if(typeof r.toDate=="function")return r.toDate();const e=new Date(r);return Number.isNaN(e.getTime())?null:e}catch{return null}}function mle(r=[]){const e=(r==null?void 0:r.map((n,s)=>{const i=gx(n==null?void 0:n.createdAt),a=gx(n==null?void 0:n.date),o=i==null?void 0:i.getTime(),l=a==null?void 0:a.getTime(),c=Number.isFinite(o)?o:Number.isFinite(l)?l:s;return{id:n==null?void 0:n.id,timestamp:c,fallbackIndex:s}}).filter(n=>n.id))||[];e.sort((n,s)=>n.timestamp!==s.timestamp?n.timestamp-s.timestamp:n.fallbackIndex-s.fallbackIndex);const t=new Map;return e.forEach((n,s)=>t.set(n.id,s+1)),t}function xN(r){if(!r)return null;const e=new Date(r);return e.setHours(ole,lle,cle,0),e}function ci(r){const e=String(r);return Kl!=null&&Kl.convertToBanglaNumber?Kl.convertToBanglaNumber(e):e}function ble(r){if(!(r instanceof Date)||Number.isNaN(r.getTime()))return"  ";const e=ci(String(r.getDate()).padStart(2,"0")),t=Ale[r.getMonth()]||"",n=ci(r.getFullYear()),s=dle[r.getDay()]||"",i=_N(r);return`${e} ${t} ${n} - ${s}, ${i}`}function _N(r){const e=r.getHours(),t=r.getMinutes(),n=yle(e),s=e>=12?"pm":"am",i=e%12||12,a=String(t).padStart(2,"0"),o=`${ci(i)}:${ci(a)}`;return`${n} ${o} ${s}`}function yle(r){return r<4?"":r<12?"":r<16?"":r<19?"":""}function BN(r){var u;const e=Date.now(),t=((u=r==null?void 0:r.getTime)==null?void 0:u.call(r))??NaN;if(Number.isNaN(t))return{valid:!1};let n=0;try{const p=new Date;p.setHours(0,0,0,0);const f=new Date(r);f.setHours(0,0,0,0),n=Math.round((f.getTime()-p.getTime())/864e5)}catch{n=0}let s=t-e;const i=s<=0;i&&(s=Math.abs(s));const a=Math.floor(s/1e3),o=Math.floor(a/86400),l=Math.floor(a%86400/3600),c=Math.floor(a%3600/60),A=a%60,d=i?0:Math.ceil((t-e)/864e5),h=i?Number.POSITIVE_INFINITY:t-e;return{valid:!0,past:i,days:o,hours:l,minutes:c,seconds:A,remainingDays:d,remainingMs:h,dayDiff:n}}function CN(r,e=!0){if(!r.valid)return" ";const t=ci(r.days),n=ci(r.hours),s=ci(r.minutes),i=ci(r.seconds);let a="  ";r.past?a=r.dayDiff===-1?"  ":" ":r.dayDiff===0?a=" ":r.dayDiff===1?a=" ":r.dayDiff===2&&(a=" ");const o=r.past?"":"",l=[];return r.days>0&&l.push(`${t} `),l.push(`${n} `,`${s} `,`${i} `),`${a}: ${l.join(" ")} ${o}`}function wle(r){if(!r.valid)return"cd-pill";if(r.past)return"cd-pill cd-red";const e=r.remainingDays;return e>10?"cd-pill cd-green":e>=6?"cd-pill cd-amber":e>3?"cd-pill cd-red":"cd-pill cd-red cd-blink"}function g_(){if(!dr.page)return;let r,e;const t=Ms.get("currentUserData");t&&t.type==="teacher"?(r=Ms.getFilteredData("tasks",!0),e=Ms.getFilteredData("evaluations",!0)):(r=Ms.get("tasks")||[],e=Ms.get("evaluations")||[]),console.log(" Upcoming Assignments - Raw tasks:",r.length),r=Lle(r),console.log(" Upcoming Assignments - After filter:",r.length);const n=mle(r),s=r.map(A=>Sle(A,e,n)),i=Date.now(),a=A=>A.status==="upcoming"?0:A.status==="ongoing"?1:2,o=A=>{const d=A._dateObj;if(!d)return Number.POSITIVE_INFINITY;const h=d.getTime()-i;return h>0?h:Number.POSITIVE_INFINITY},l=A=>A._dateObj?A._dateObj.getTime():-1/0;s.sort((A,d)=>{const h=a(A),u=a(d);if(h!==u)return h-u;if(h===0){const p=o(A),f=o(d);return p!==f?p-f:l(A)-l(d)}return l(d)-l(A)}),n&&n.size>0?s.forEach((A,d)=>{A.assignmentNumber||(A.assignmentNumber=d+1)}):s.forEach((A,d)=>A.assignmentNumber=d+1),vle(s),Fle(),xle(s),Tle()}function vle(r){if(!dr.summary)return;const e={all:r.length,upcoming:r.filter(i=>i.status==="upcoming").length,ongoing:r.filter(i=>i.status==="ongoing").length,completed:r.filter(i=>i.status==="completed").length},t=`
    <div id="upcomingAssignmentsFilters" class="hidden flex flex-wrap gap-1.5 items-center justify-center mb-2">
      <select id="upcomingClassFilter" class="appearance-none bg-white/50 dark:bg-slate-800/50 border border-slate-200 dark:border-slate-700 text-slate-700 dark:text-slate-200 text-xs font-medium rounded-lg py-1 px-2 pr-6 focus:outline-none focus:ring-2 focus:ring-indigo-500/50 cursor-pointer backdrop-blur-sm transition-colors hover:bg-white/80 dark:hover:bg-slate-800/80 min-w-[100px]">
        <option value=""> </option>
      </select>
      <select id="upcomingSectionFilter" class="appearance-none bg-white/50 dark:bg-slate-800/50 border border-slate-200 dark:border-slate-700 text-slate-700 dark:text-slate-200 text-xs font-medium rounded-lg py-1 px-2 pr-6 focus:outline-none focus:ring-2 focus:ring-indigo-500/50 cursor-pointer backdrop-blur-sm transition-colors hover:bg-white/80 dark:hover:bg-slate-800/80 min-w-[100px]">
        <option value=""> </option>
      </select>
      <select id="upcomingSubjectFilter" class="appearance-none bg-white/50 dark:bg-slate-800/50 border border-slate-200 dark:border-slate-700 text-slate-700 dark:text-slate-200 text-xs font-medium rounded-lg py-1 px-2 pr-6 focus:outline-none focus:ring-2 focus:ring-indigo-500/50 cursor-pointer backdrop-blur-sm transition-colors hover:bg-white/80 dark:hover:bg-slate-800/80 min-w-[100px]">
        <option value=""> </option>
      </select>
    </div>
  `,n=`
    <div class="ua-tabbar" role="tablist" aria-label="Assignment filter tabs">
      ${ile.map(i=>{const a=ale[i];if(!a)return"";const o=Im.active===i,l=ci(e[i]??0);return`
          <button type="button" role="tab"
            class="ua-tab"
            data-tab="${i}"
            data-theme="${a.theme}"
            aria-selected="${o}">
            <i class="${a.icon} ua-tab-icon"></i>
            <span class="ua-tab-label">${a.label}</span>
            <span class="ua-tab-count">${l}</span>
            <span class="ua-tab-desc">${a.description}</span>
          </button>
        `}).join("")}
    </div>
  `;dr.summary.innerHTML=t+n,dr.summary.querySelectorAll("[data-tab]").forEach(i=>{Td.addListener(i,"click",()=>{const a=i.getAttribute("data-tab");!a||a===Im.active||(Im.active=a,g_())})})}function xle(r){if(!dr.list)return;const e=Im.active||"all",t=e==="all"?vN:[e];let n="";t.forEach(s=>{const i=r.filter(o=>o.status===s);if(!i.length)return;const a=i.map(_le).join("");n+=`
      <section class="space-y-4">
        <div class="flex items-center gap-2">
          <span class="chip-3d inline-flex items-center gap-2 rounded-full px-3 py-1 text-sm font-semibold ${uo[s].chip}">
            <i class="${uo[s].icon}"></i>${uo[s].label}
          </span>
          <span class="text-xs text-gray-500 dark:text-gray-400">${ci(i.length)}  </span>
        </div>
        <div class="space-y-3">${a}</div>
      </section>
    `}),dr.list.innerHTML=n||`
    <div class="placeholder-content">
      <i class="fas fa-inbox mr-2"></i>
           
    </div>
  `,Cle()}function _le(r){var F,N,E,w,v,I,k;const e=uo[r.status]||uo.upcoming,t=ci(r.participants),n=r.assignmentNumber||0,s=ci(n),i=r.dateLabel||"  ",a=`acc_${r.id||Math.random().toString(36).slice(2)}`,o=`panel_${r.id||Math.random().toString(36).slice(2)}`,l=`
    <span class="cd-pill" data-cd data-iso="${r.dateISO||""}" data-mode="start">
      <i class="fas fa-hourglass-half"></i>
      <span class="cd-text text-[11px] sm:text-sm">${CN(BN(r._dateObj))}</span>
    </span>
   
  `,c=`${r.scheduleText||" "} :`,A=`
    <span class="sched-pill" data-status="${r.status}">
      <span class="sched-pill__label text-sm sm:text-base">${c}</span>
      <span class="sched-pill__value text-xs sm:text-sm">${i}</span>
    </span>
  `,d=["bg-red-100 text-red-800 border-red-200 dark:bg-red-900 dark:text-white dark:border-red-700","bg-orange-100 text-orange-800 border-orange-200 dark:bg-orange-900 dark:text-white dark:border-orange-700","bg-yellow-100 text-yellow-800 border-yellow-200 dark:bg-yellow-900 dark:text-white dark:border-yellow-700","bg-green-100 text-green-800 border-green-200 dark:bg-green-900 dark:text-white dark:border-green-700","bg-teal-100 text-teal-800 border-teal-200 dark:bg-teal-900 dark:text-white dark:border-teal-700","bg-blue-100 text-blue-800 border-blue-200 dark:bg-blue-900 dark:text-white dark:border-blue-700","bg-indigo-100 text-indigo-800 border-indigo-200 dark:bg-indigo-900 dark:text-white dark:border-indigo-700","bg-purple-100 text-purple-800 border-purple-200 dark:bg-purple-900 dark:text-white dark:border-purple-700","bg-pink-100 text-pink-800 border-pink-200 dark:bg-pink-900 dark:text-white dark:border-pink-700","bg-gray-100 text-gray-800 border-gray-200 dark:bg-gray-700 dark:text-white dark:border-gray-600"];function h(_){if(!_)return d[0];const T=_.trim().toLowerCase();if(T.includes("")||T.includes("bangla"))return d[0];if(T.includes("")||T.includes("english"))return d[5];if(T.includes("")||T.includes("math"))return d[1];if(T.includes("")||T.includes("ict")||T.includes(""))return d[4];if(T.includes("")||T.includes("science"))return d[3];if(T.includes("")||T.includes("religion")||T.includes(""))return d[7];if(T.includes("")||T.includes("physics"))return d[8];if(T.includes("")||T.includes("chemistry"))return d[2];if(T.includes("")||T.includes("biology"))return d[6];let L=0;for(let K=0;K<_.length;K++)L=_.charCodeAt(K)+((L<<5)-L);return d[Math.abs(L)%d.length]}const u=Ms.get("classes")||[],p=Ms.get("sections")||[],f=Ms.get("subjects")||[],g=r.classId&&((F=u.find(_=>_.id===r.classId))==null?void 0:F.name)||"",m=r.sectionId&&((N=p.find(_=>_.id===r.sectionId))==null?void 0:N.name)||"",x=r.subjectId&&((E=f.find(_=>_.id===r.subjectId))==null?void 0:E.name)||"",S=h(x),B=`
    <div class="flex flex-wrap gap-1.5 mt-2">
      ${g?`<span class="inline-flex items-center gap-1 px-2.5 py-0.5 rounded-md text-[10px] sm:text-xs font-semibold bg-slate-100 text-slate-700 border border-slate-200 dark:bg-slate-800 dark:text-slate-300 dark:border-slate-700">
        <i class="fas fa-graduation-cap"></i> ${g}
      </span>`:""}
      ${m?`<span class="inline-flex items-center gap-1 px-2.5 py-0.5 rounded-md text-[10px] sm:text-xs font-semibold bg-slate-100 text-slate-700 border border-slate-200 dark:bg-slate-800 dark:text-slate-300 dark:border-slate-700">
        <i class="fas fa-layer-group"></i> ${m}
      </span>`:""}
      ${x?`<span class="inline-flex items-center gap-1 px-2.5 py-0.5 rounded-md text-[10px] sm:text-xs font-semibold border ${S}">
        <i class="fas fa-book"></i> ${x}
      </span>`:""}
    </div>
  `;return`
    <article class="relative card-3d card-3d--bevel focusable flex flex-col sm:flex-row overflow-visible sm:overflow-hidden" tabindex="0" role="group" aria-label="${Kl.ensureBengaliText(r.name)}">
      <!-- Left Rail:   (original design) -->
      <div class="flex-shrink-0 w-full sm:w-24 flex flex-row sm:flex-col items-center justify-center gap-2 bg-gray-50 dark:bg-gray-800/60 p-4 border-b sm:border-b-0 sm:border-r border-gray-100 dark:border-gray-700/50">
        <span class="text-xs font-semibold text-gray-500 dark:text-gray-400"></span>
        <span class="text-3xl font-extrabold text-blue-600 dark:text-blue-400">${s}</span>
      </div>

      <!-- Content -->
      <div class="flex-1 p-4 min-w-0">
        <div class="flex flex-col gap-3 md:flex-row md:items-start md:justify-between">
          <div class="min-w-0">
            <!-- Top row: chip + countdown + rose pill -->
            <div class="flex items-center flex-wrap gap-2">
              <span class="chip-3d inline-flex items-center gap-1 rounded-full px-2.5 py-0.5 text-xs font-semibold ${e.chip}">
                <i class="${e.icon}"></i>${e.label}
              </span>
              ${l}
              ${A}
            </div>

            <h4 class="text-xs sm:text-base font-semibold text-gray-900 dark:text-white mt-2">${r.name}</h4>
            ${B}
          </div>

          <div class="flex sm:flex-col  gap-2 text-[10px] sm:text-base text-gray-600 dark:text-gray-300">
            <span class="inline-flex items-center gap-2 rounded-lg bg-gray-100 dark:bg-gray-800/70 px-3 py-1 border border-gray-200/80 dark:border-white/10 shadow-[var(--inner-highlight)]">
              <i class="fas fa-user-check text-blue-500"></i> : ${t}
            </span>
            <span class="inline-flex items-center gap-2 rounded-lg bg-gray-100 dark:bg-gray-800/70 px-3 py-1 border border-gray-200/80 dark:border-white/10 shadow-[var(--inner-highlight)]" title=": -${ci(((w=r.maxScoreBreakdown)==null?void 0:w.task)??0)}, -${ci(((v=r.maxScoreBreakdown)==null?void 0:v.team)??0)}, -${ci(((I=r.maxScoreBreakdown)==null?void 0:I.Progress)??0)}, MCQ-${ci(((k=r.maxScoreBreakdown)==null?void 0:k.mcq)??0)}">
              <i class="fas fa-star text-amber-500"></i> : ${ci(r.maxScore||100)}
            </span>
            <span class="inline-flex items-center gap-2 rounded-lg bg-gray-100 dark:bg-gray-800/70 px-3 py-1 border border-gray-200/80 dark:border-white/10 shadow-[var(--inner-highlight)]">
              <i class="fas fa-clock text-purple-500"></i> : ${r.startTimeLabel||" : am"}
            </span>
          </div>
        </div>

        <!-- Accordion -->
        ${Ble(r,a,o)}
      </div>
    </article>
  `}function Ble(r,e,t){const n=(r.description||"").trim();if(!n)return"";const s=n.split(/[\n,]+/).map(a=>a.trim()).filter(Boolean),i=s.length<=1?`<p class="leading-relaxed">${Kl.ensureBengaliText(n)}</p>`:`<ul class="list-disc list-inside space-y-1.5">${s.map(a=>`<li>${Kl.ensureBengaliText(a)}</li>`).join("")}</ul>`;return`
    <div class="mt-4">
      <button
        id="${e}"
        data-acc-btn
        class="w-full flex items-center justify-between gap-3 rounded-xl border border-gray-300/80 dark:border-white/10 bg-gray-50 dark:bg-gray-800/60 px-4 py-2.5 text-left focusable"
        aria-expanded="false"
        aria-controls="${t}"
      >
        <span class="inline-flex items-center gap-2 text-sm font-semibold">
          <i class="fas fa-list-check"></i>
          -
        </span>
        <i class="fas fa-chevron-down transition-transform duration-200 ease-out" data-acc-chevron></i>
      </button>

      <div
        id="${t}"
        data-acc-panel
        data-open="false"
        class="overflow-hidden rounded-xl border border-gray-200/80 dark:border-white/10 bg-white/70 dark:bg-gray-900/60 mt-2"
        style="max-height:0; transition:max-height .28s ease;"
      >
        <div class="p-4 text-sm text-gray-700 dark:text-gray-300">${i}</div>
      </div>
    </div>
  `}function Cle(){document.querySelectorAll("[data-acc-btn]").forEach(e=>{if(e.__wired)return;e.__wired=!0;const t=e.getAttribute("aria-controls"),n=document.getElementById(t),s=e.querySelector("[data-acc-chevron]");Td.addListener(e,"click",()=>{const i=e.getAttribute("aria-expanded")==="true";e.setAttribute("aria-expanded",String(!i)),SN(n,!i),s&&(s.style.transform=i?"rotate(0deg)":"rotate(180deg)")})})}function SN(r,e){if(!r)return;const t=r.getAttribute("data-open")==="true";if(e===t)return;const n=r.getBoundingClientRect().height;r.style.maxHeight=n+"px",r.style.overflow="hidden",r.setAttribute("data-open",String(e));const s=e?r.scrollHeight:0;requestAnimationFrame(()=>{r.style.maxHeight=s+"px"});const i=()=>{r.style.maxHeight=e?"none":"0",r.style.overflow=e?"visible":"hidden",r.removeEventListener("transitionend",i)};r.addEventListener("transitionend",i,{once:!0})}function Sle(r,e,t){var h,u,p;const n=gx(r.date),s=xN(n)||n,i=kle({...r,date:s}),a=kN(s),o=Ile(r.id,e),l=t instanceof Map?t.get(r.id):void 0,c=typeof l=="number"&&Number.isFinite(l)?l:typeof r.assignmentNumber=="number"&&r.assignmentNumber>0?r.assignmentNumber:0,A=r.maxScoreBreakdown||{},d=r.maxScoreBreakdown?(parseFloat(A.task)||0)+(parseFloat(A.team)||0)+(parseFloat(A.Progress)||0)+(parseFloat(A.mcq)||0):parseFloat(r.maxScore)||100;return{id:r.id,name:Kl.ensureBengaliText(r.name||" "),status:i,dateLabel:a.label,timelineLabel:a.timelineLabel,scheduleText:a.scheduleText,startTimeLabel:a.startTimeLabel,description:r.description||"",participants:o,assignmentNumber:c,dateISO:s?s.toISOString():"",_dateObj:s,classId:r.classId||"",sectionId:r.sectionId||"",subjectId:r.subjectId||"",className:((h=(Ms.get("classes")||[]).find(f=>f.id===r.classId))==null?void 0:h.name)||"",sectionName:((u=(Ms.get("sections")||[]).find(f=>f.id===r.sectionId))==null?void 0:u.name)||"",subjectName:((p=(Ms.get("subjects")||[]).find(f=>f.id===r.subjectId))==null?void 0:p.name)||"",maxScore:d,maxScoreBreakdown:A}}function kle(r){const e=typeof r.status=="string"?r.status.toLowerCase():"";return vN.includes(e)?e:Ele(r.date)}function Ele(r){const{isFuture:e,isToday:t}=kN(r);return e?"upcoming":t?"ongoing":"completed"}function kN(r){if(!r)return{label:"  ",scheduleText:"  ",timelineLabel:" ",startTimeLabel:" : am",isFuture:!1,isToday:!1};const e=xN(r)||r,t=new Date,n=e.getTime()>t.getTime(),i=e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()&&e.getTime()>=t.getTime(),a=ble(e),o=_N(e);let l=" ",c=" ";return n?(l=" ",c=" "):i&&(l=" ",c=" "),{label:a,scheduleText:l,timelineLabel:c,startTimeLabel:o,isFuture:n,isToday:i}}function Ile(r,e){if(!r||!(e!=null&&e.length))return 0;const t=new Set;return e.forEach(n=>{if(n.taskId!==r)return;const s=n.scores||{};Object.keys(s).forEach(i=>t.add(i))}),t.size}function Tle(){$0&&(clearInterval($0),$0=null),oI(),$0=setInterval(oI,1e3)}function oI(){document.querySelectorAll("[data-cd][data-iso]").forEach(e=>{const t=e.getAttribute("data-iso")||"",n=e.getAttribute("data-mode")||"start",s=e.querySelector(".cd-text");if(!t||!s){s&&(s.textContent=" ");return}const i=new Date(t),a=BN(i);s.textContent=CN(a,n==="start");const o=wle(a);e.className=o})}function Fle(){if(dr.filtersContainer=document.getElementById("upcomingAssignmentsFilters"),dr.classFilter=document.getElementById("upcomingClassFilter"),dr.sectionFilter=document.getElementById("upcomingSectionFilter"),dr.subjectFilter=document.getElementById("upcomingSubjectFilter"),!dr.filtersContainer)return;const r=Ms.get("currentUserData"),e=r&&r.type==="teacher",t=r?r.type==="admin"||r.type==="super-admin":!0;if(e){dr.filtersContainer.classList.add("hidden");return}if(t){if(dr.filtersContainer.classList.remove("hidden"),!dr.classFilter||!dr.sectionFilter||!dr.subjectFilter)return;const n=Ms.get("classes")||[],s=Ms.get("sections")||[],i=Ms.get("subjects")||[],a=Array.from(new Map(n.map(c=>[c.name,c])).values()),o=Array.from(new Map(s.map(c=>[c.name,c])).values()),l=Array.from(new Map(i.map(c=>[c.name,c])).values());Td.populateSelect(dr.classFilter,a.map(c=>({value:c.id,text:c.name}))," "),Td.populateSelect(dr.sectionFilter,o.map(c=>({value:c.name,text:c.name}))," "),Td.populateSelect(dr.subjectFilter,l.map(c=>({value:c.name,text:c.name}))," "),Ls.classId&&(dr.classFilter.value=Ls.classId),Ls.sectionId&&(dr.sectionFilter.value=Ls.sectionId),Ls.subjectId&&(dr.subjectFilter.value=Ls.subjectId),dr.classFilter.onchange=bv,dr.sectionFilter.onchange=bv,dr.subjectFilter.onchange=bv}}function Lle(r){const e=Ms.get("currentUserData");if(e&&e.type==="teacher")return r;const n=Ls.classId&&Ls.classId!=="all"?Ls.classId:"",s=Ls.sectionId&&Ls.sectionId!=="all"?Ls.sectionId:"",i=Ls.subjectId&&Ls.subjectId!=="all"?Ls.subjectId:"";if(!n&&!s&&!i)return console.log(" No filters selected, showing all tasks:",r.length),r;const a=(s||"").trim().toLowerCase().normalize("NFC"),o=(i||"").trim().toLowerCase().normalize("NFC");console.log(" Filter values:",{classId:n,selectedSectionName:a,selectedSubjectName:o});const l=r.filter(c=>{var A;if(n&&String(c.classId)!==String(n))return!1;if(a){let d=((A=c.sectionName)==null?void 0:A.trim().toLowerCase())||"";if(!d&&c.sectionId){const u=(Ms.get("sections")||[]).find(p=>String(p.id)===String(c.sectionId));u&&(d=u.name.trim().toLowerCase())}if(!d||d!==a)return!1}if(o){let d=(c.subjectName||"").trim().toLowerCase().normalize("NFC");if(!d&&c.subjectId){const u=(Ms.get("subjects")||[]).find(p=>String(p.id)===String(c.subjectId));u&&(d=u.name.trim().toLowerCase().normalize("NFC"))}if(!d||d!==o)return!1}return!0});return console.log(" Filtered tasks:",l.length,"/",r.length),l}function bv(){dr.classFilter&&(Ls.classId=dr.classFilter.value),dr.sectionFilter&&(Ls.sectionId=dr.sectionFilter.value),dr.subjectFilter&&(Ls.subjectId=dr.subjectFilter.value),console.log(" Filter changed:",Ls),g_()}const ql={TABLE:"table",CHART:"chart"},Ule={taskFilter:"all",groupFilter:"all",evaluationType:"all",viewMode:ql.TABLE,showPendingOnly:!1},EN=100;let nA,Ru,Ks;const Gn={};let fA=null,xu=null,lI=null,G0=null;function Mle(r){var e;nA=r.managers.stateManager,Ru=r.managers.uiManager,Ks=r.utils,Nle();try{window.matchMedia&&(G0=window.matchMedia("(prefers-color-scheme: dark)"),(e=G0.addEventListener)==null||e.call(G0,"change",()=>Ou())),Gn.statsContentContainer&&"ResizeObserver"in window&&(lI=new ResizeObserver(()=>{fA&&fA.resize()}),lI.observe(Gn.statsContentContainer))}catch{}return console.log(" Statistics component initialized."),{render:Ou}}function Ou(){if(!Gn.page){console.error(" Statistics render failed: Page element #page-statistics not found.");return}const r=Ple();rce(Gn.page,()=>{try{const e=Vle(r);Dle(r,e),Ole(e,r)}catch(e){console.error(" Error rendering statistics page:",e),Gn.statsContentContainer&&Ru.displayEmptyMessage(Gn.statsContentContainer,`    : ${e.message}`)}})}function Nle(){if(Gn.page=document.getElementById("page-statistics"),!Gn.page){console.error(" Statistics init failed: #page-statistics element not found!");return}Gn.filterContainer=Gn.page.querySelector("#statsFilterContainer"),Gn.statsContentContainer=Gn.page.querySelector("#statsContentContainer"),Gn.filterContainer||console.warn("Statistics: #statsFilterContainer not found."),Gn.statsContentContainer||console.warn("Statistics: #statsContentContainer not found.")}function Ple(){const r={...Ule,...nA.getFilterSection("statistics")||{}};return nA.updateFilters("statistics",r),r}function Dle(r,e){if(!Gn.filterContainer)return;const{summary:t,groupOptions:n}=e,s=`
    <div class="grid gap-4 md:grid-cols-2 xl:grid-cols-4">
      ${z0(" ",t.totalEvaluations,"bg-blue-50 text-blue-700 dark:bg-gray-800/80 dark:text-white","fa-clipboard-list")}
      ${z0("MCQ ",t.totalMcqEvaluations,"bg-purple-50 text-purple-700 dark:bg-gray-800/80 dark:text-white","fa-brain")}
      ${z0("  (%)",ph(t.averageScore),"bg-emerald-50 text-emerald-700 dark:bg-gray-800/80 dark:text-white","fa-gauge")}
      ${z0(" ",t.pendingStudents,"bg-rose-50 text-rose-700 dark:bg-gray-800/80 dark:text-white","fa-user-clock")}
    </div>
  `,i=`
    <div class="card card-body space-y-4">
      <div class="grid gap-4 lg:grid-cols-3">
        <div>
          <label for="statsGroupFilter" class="label"> </label>
          <select id="statsGroupFilter" class="form-select stats-filter">
            <option value="all"> </option>
            ${n.map(a=>`<option value="${a.id}" ${a.id===r.groupFilter?"selected":""}>${a.label}</option>`).join("")}
          </select>
        </div>
        <div>
          <label class="label"> </label>
          <div class="flex flex-wrap gap-2" id="statsEvaluationTypeButtons">
            ${df("all"," ",r.evaluationType==="all")}
            ${df("mcq"," MCQ",r.evaluationType==="mcq")}
            ${df("regular","/",r.evaluationType==="regular")}
          </div>
        </div>
        <div>
          <label class="label"> </label>
          <div class="flex flex-wrap gap-2" id="statsViewModeButtons">
            ${df(ql.TABLE," ",r.viewMode===ql.TABLE)}
            ${df(ql.CHART," ",r.viewMode===ql.CHART)}
          </div>
        </div>
      </div>
      <div class="flex flex-col sm:flex-row sm:items-center justify-between gap-4">
        <label class="inline-flex items-center gap-2 text-sm text-gray-600 dark:text-gray-300">
          <input type="checkbox" id="statsPendingToggle" class="form-checkbox stats-filter" ${r.showPendingOnly?"checked":""}/>
              
        </label>
        <div class="text-sm text-gray-500 dark:text-gray-400">
           : ${Za(t.groupsInView)} / ${Za(t.totalGroups)}
            : ${ph(t.participationRate)}
            : ${t.latestEvaluation||""}
        </div>
      </div>
    </div>
  `;Gn.filterContainer.innerHTML=`
    <div class="space-y-6">
      ${s}
      ${i}
    </div>
  `,Rle(r)}function z0(r,e,t,n){const s=typeof e=="string"?e:Za(e);return`
    <div class="rounded-2xl border ${t} border-gray-200/60 dark:border-white/10 p-4 shadow-sm backdrop-blur">
      <div class="flex items-center justify-between">
        <div>
          <div class="text-sm font-medium opacity-80">${r}</div>
          <div class="mt-2 text-2xl font-semibold">${s}</div>
        </div>
        <div class="text-3xl opacity-70"><i class="fas ${n}"></i></div>
      </div>
    </div>
  `}function df(r,e,t){return`<button type="button" class="px-4 py-2 rounded-full border border-gray-200 dark:border-gray-700 text-sm transition-colors ${t?"bg-blue-600 text-white border-blue-600 shadow":"bg-white dark:bg-gray-800 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}" data-stat-value="${r}">${e}</button>`}function Rle(r){const e=Gn.filterContainer.querySelector("#statsGroupFilter"),t=Gn.filterContainer.querySelectorAll("#statsEvaluationTypeButtons button"),n=Gn.filterContainer.querySelectorAll("#statsViewModeButtons button"),s=Gn.filterContainer.querySelector("#statsPendingToggle");e&&Ru.addListener(e,"change",i=>{nA.updateFilters("statistics",{...r,groupFilter:i.target.value}),Ou()}),t.forEach(i=>{Ru.addListener(i,"click",()=>{const a=i.getAttribute("data-stat-value");a&&a!==r.evaluationType&&(nA.updateFilters("statistics",{...r,evaluationType:a}),Ou())})}),n.forEach(i=>{Ru.addListener(i,"click",()=>{const a=i.getAttribute("data-stat-value");a&&a!==r.viewMode&&(nA.updateFilters("statistics",{...r,viewMode:a}),Ou())})}),s&&Ru.addListener(s,"change",i=>{nA.updateFilters("statistics",{...r,showPendingOnly:i.target.checked}),Ou()})}function Ole(r,e){if(!Gn.statsContentContainer)return;const{groupMetrics:t,chartData:n}=r;let s='<div class="space-y-6">';e.viewMode===ql.TABLE?s+=Qle(t,e):e.viewMode===ql.CHART&&(s+=Hle(t)),e.groupFilter!=="all"&&t.length===1&&(s+=jle(t[0])),s+="</div>",Gn.statsContentContainer.innerHTML=s,e.viewMode===ql.CHART&&n?(Kle(n),setTimeout(()=>{fA&&fA.resize()},0)):px()}function Qle(r,e){if(!r.length)return`
      <div class="card card-body">
        <div class="placeholder-content">
          <i class="fas fa-info-circle mr-2"></i>
                
        </div>
      </div>
    `;const t=[""," "," ","MCQ ","  (%)","  (%)"," "," "],n=r.map(s=>`
        <tr class="border-b border-gray-100 dark:border-gray-700 hover:bg-gray-50/60 dark:hover:bg-gray-800/60 transition">
          <td class="px-4 py-3 font-medium text-gray-800 dark:text-gray-100">${kb(s.groupName)}</td>
          <td class="px-4 py-3 text-gray-700 dark:text-gray-300 text-center">${Za(s.studentCount)}</td>
          <td class="px-4 py-3 text-gray-700 dark:text-gray-300 text-center">${Za(s.evaluationCount)}</td>
          <td class="px-4 py-3 text-gray-700 dark:text-gray-300 text-center">${Za(s.mcqEvaluationCount)}</td>
          <td class="px-4 py-3 text-center">
            <span class="font-semibold ${Jle(s.averageScore)}">${ph(s.averageScore)}</span>
          </td>
          <td class="px-4 py-3 text-center">
            <span class="font-semibold text-indigo-600 dark:text-indigo-300">${ph(s.participationRate)}</span>
          </td>
          <td class="px-4 py-3 text-center">
            <span class="font-semibold ${s.pendingStudents>0?"text-rose-500":"text-emerald-500"}">
              ${Za(s.pendingStudents)}
            </span>
          </td>
          <td class="px-4 py-3 text-gray-600 dark:text-gray-300 text-sm text-center">${s.latestEvaluationLabel||""}</td>
        </tr>
      `).join("");return`
    <div class="card overflow-hidden">
      <div class="card-header flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2">
        <h3 class="text-lg font-semibold text-gray-800 dark:text-white">  </h3>
        <p class="text-sm text-gray-500 dark:text-gray-400">
           : ${e.viewMode===ql.TABLE?"":""}   : ${Xle(e.evaluationType)}
        </p>
      </div>
      <div class="overflow-x-auto">
        <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
          <thead class="bg-gray-50 dark:bg-gray-800/60">
            <tr>
              ${t.map(s=>`<th scope="col" class="px-4 py-3 text-left text-xs font-semibold uppercase tracking-wide text-gray-600 dark:text-gray-300">${s}</th>`).join("")}
            </tr>
          </thead>
          <tbody class="bg-white dark:bg-gray-900/60 divide-y divide-gray-100 dark:divide-gray-800">
            ${n}
          </tbody>
        </table>
      </div>
    </div>
  `}function Hle(r){return r.length?`
    <div class="card">
      <div class="card-header flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2">
        <h3 class="text-lg font-semibold text-gray-800 dark:text-white">   </h3>
        <p class="text-sm text-gray-500 dark:text-gray-400">   ,     </p>
      </div>
      <div class="card-body">
        <div class="h-96">
          <canvas id="groupStatisticsChart"></canvas>
        </div>
      </div>
    </div>
  `:`
      <div class="card card-body">
        <div class="placeholder-content">
          <i class="fas fa-chart-column mr-2"></i>
               
        </div>
      </div>
    `}function jle(r){if(!r||!r.evaluationDetails.length)return"";const e=r.evaluationDetails.map(t=>`
        <div class="border border-gray-100 dark:border-gray-700 rounded-xl p-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
          <div>
            <div class="text-base font-semibold text-gray-800 dark:text-white">${kb(t.taskName)}</div>
            <div class="text-xs text-gray-500 dark:text-gray-400 mt-1 flex flex-wrap gap-3">
              <span><i class="fas fa-calendar-day mr-1"></i>${t.dateLabel||""}</span>
              <span><i class="fas fa-list-check mr-1"></i>${t.type==="mcq"?"MCQ":"/"}</span>
            </div>
          </div>
          <div class="flex flex-wrap gap-4 text-sm text-gray-700 dark:text-gray-200">
            <span class="font-semibold text-indigo-600 dark:text-indigo-300"> : ${ph(t.averagePercentage)}</span>
            <span>: ${Za(t.assessedCount)}</span>
            <span class="${t.pendingCount>0?"text-rose-500 font-medium":""}">: ${Za(t.pendingCount)}</span>
          </div>
        </div>
      `).join("");return`
    <div class="card card-body space-y-4">
      <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2">
        <h4 class="text-lg font-semibold text-gray-800 dark:text-white">
          ${kb(r.groupName)} -  
        </h4>
        <span class="text-sm text-gray-500 dark:text-gray-400">
           ${Za(r.evaluationCount)}  
        </span>
      </div>
      <div class="space-y-3">
        ${e}
      </div>
    </div>
  `}function Vle(r){const{groups:e,students:t,tasks:n,evaluations:s}=nA.getState(),i=new Map,a=new Map(n.map(d=>[d.id,d]));e.forEach(d=>{const h=t.filter(u=>u.groupId===d.id).length;i.set(d.id,{groupId:d.id,groupName:kb(d.name),studentCount:h,evaluationDetails:[],evaluationCounts:{all:0,mcq:0,regular:0},participants:{all:new Set,mcq:new Set,regular:new Set},latestEvaluationMs:null})}),s.forEach(d=>{const h=i.get(d.groupId);if(!h)return;const u=a.get(d.taskId),p=parseFloat(d.maxPossibleScore)||Wle(u)||EN,g=Yle(u)?"mcq":"regular",m=d.scores||{},x=Object.keys(m),S=x.length,B=Math.max(h.studentCount-S,0);let F=0;x.forEach(v=>{var _;const I=parseFloat((_=m[v])==null?void 0:_.totalScore)||0,k=p>0?I/p*100:0;F+=k,h.participants.all.add(v),h.participants[g].add(v)});const N=S>0?F/S:0,E=h.studentCount>0?Math.min(100,S/h.studentCount*100):0,w=Zle(d.taskDate||d.completedAt||d.updatedAt||d.createdAt||(u==null?void 0:u.date));w&&(!h.latestEvaluationMs||w>h.latestEvaluationMs)&&(h.latestEvaluationMs=w),h.evaluationCounts.all+=1,h.evaluationCounts[g]+=1,h.evaluationDetails.push({type:g,assessedCount:S,pendingCount:B,averagePercentage:N,weightedScoreSum:F,weight:S,participationRate:E,dateMs:w,dateLabel:Sb(w||(u==null?void 0:u.date)),taskName:(u==null?void 0:u.name)||d.taskName||" "})});const o=[];i.forEach(d=>{o.push($le(d,r))});const l=o.filter(d=>r.groupFilter==="all"?!0:d.groupId===r.groupFilter).filter(d=>r.showPendingOnly?d.pendingStudents>0:!0).sort((d,h)=>h.evaluationCount-d.evaluationCount||h.averageScore-d.averageScore),c=Gle(o,l,r),A=zle(l);return{filtersUsed:r,groupMetrics:l,summary:c,chartData:A,groupOptions:o.map(d=>({id:d.groupId,label:d.groupName}))}}function $le(r,e){const t=e.evaluationType==="all"?r.evaluationDetails:r.evaluationDetails.filter(d=>d.type===e.evaluationType),n=t.length,s=t.reduce((d,h)=>d+h.assessedCount,0),i=t.reduce((d,h)=>d+h.pendingCount,0),a=t.reduce((d,h)=>d+h.weightedScoreSum,0),o=t.reduce((d,h)=>d+h.weight,0),l=o>0?a/o:0,c=n>0&&r.studentCount>0?Math.min(100,s/(r.studentCount*n)*100):0,A=t.reduce((d,h)=>h.dateMs&&h.dateMs>d.maxDate?{maxDate:h.dateMs,label:h.dateLabel}:d,{maxDate:-1/0,label:null});return{groupId:r.groupId,groupName:r.groupName,studentCount:r.studentCount,evaluationCount:n,mcqEvaluationCount:r.evaluationCounts.mcq,pendingStudents:i,averageScore:l,participationRate:c,assessedCount:s,weightedScoreSum:a,weight:o,latestEvaluationLabel:A.label||(r.latestEvaluationMs?Sb(r.latestEvaluationMs):null),uniqueParticipants:qle(r.participants,e.evaluationType),potentialParticipants:r.studentCount*Math.max(n,1),evaluationDetails:t.sort((d,h)=>(h.dateMs||0)-(d.dateMs||0))}}function Gle(r,e,t){const n=e.reduce((d,h)=>d+h.evaluationCount,0),s=t.evaluationType==="mcq"?n:e.reduce((d,h)=>d+h.mcqEvaluationCount,0),i=e.reduce((d,h)=>d+h.pendingStudents,0),a=e.reduce((d,h)=>d+h.weightedScoreSum,0),o=e.reduce((d,h)=>d+h.weight,0),l=e.reduce((d,h)=>d+h.assessedCount,0),c=e.reduce((d,h)=>d+h.potentialParticipants,0),A=e.reduce((d,h)=>{const u=h.evaluationDetails[0];return u!=null&&u.dateMs&&u.dateMs>d?u.dateMs:d},-1/0);return{totalGroups:r.length,groupsInView:e.length,totalEvaluations:n,totalMcqEvaluations:s,averageScore:o>0?a/o:0,pendingStudents:i,participationRate:c>0?Math.min(100,l/c*100):0,latestEvaluation:A>0?Sb(A):null}}function zle(r){if(!r.length)return null;const e=tce(),t=r.map(o=>o.groupName),n=r.map(o=>Number(o.averageScore.toFixed(2))),s=r.map(o=>Number(o.participationRate.toFixed(2))),i=r.map(o=>o.pendingStudents),a=i.length?Math.max(...i):0;return{labels:t,datasets:[{type:"bar",label:"  (%)",data:n,backgroundColor:e.scoreBar,borderRadius:8,yAxisID:"y"},{type:"bar",label:"  (%)",data:s,backgroundColor:e.partBar,borderRadius:8,yAxisID:"y"},{type:"line",label:"  ()",data:i,backgroundColor:e.pendLine,borderColor:e.pendLineBorder,pointBackgroundColor:e.pendLineBorder,pointBorderColor:e.pendLineBorder,pointRadius:3,borderWidth:2,tension:.35,fill:!1,yAxisID:"y1"}],options:{maintainAspectRatio:!1,responsive:!0,interaction:{mode:"index",intersect:!1},scales:{y:{beginAtZero:!0,max:EN,ticks:{color:e.ticks,callback:o=>`${o}%`},grid:{color:e.grid}},y1:{beginAtZero:!0,position:"right",suggestedMax:a*1.2||10,ticks:{color:e.ticks,callback:o=>Za(o)},grid:{drawOnChartArea:!1}},x:{ticks:{color:e.ticks},grid:{color:e.grid}}},plugins:{tooltip:{backgroundColor:e.tooltipBg,titleColor:e.tooltipFg,bodyColor:e.tooltipFg,callbacks:{label:o=>o.dataset.yAxisID==="y1"?`${o.dataset.label}: ${Za(o.parsed.y)} `:`${o.dataset.label}: ${ph(o.parsed.y)}`}},legend:{labels:{usePointStyle:!0,color:e.legend}}},animation:!1}}}function Kle(r){const e=document.getElementById("groupStatisticsChart");e&&(px(),fA=new Chart(e.getContext("2d"),{type:"bar",data:{labels:r.labels,datasets:r.datasets},options:r.options}))}function px(){fA&&(fA.destroy(),fA=null)}function qle(r,e){return e==="mcq"?r.mcq.size:e==="regular"?r.regular.size:r.all.size}function Wle(r){if(!r)return null;if(typeof r.maxScore=="number")return r.maxScore;if(r.maxScoreBreakdown){const e=r.maxScoreBreakdown;return(parseFloat(e.task)||0)+(parseFloat(e.team)||0)+(parseFloat(e.Progress)||0)+(parseFloat(e.mcq)||0)}return null}function Yle(r){return!r||!r.maxScoreBreakdown?!1:parseFloat(r.maxScoreBreakdown.mcq)>0}function Xle(r){switch(r){case"mcq":return"MCQ";case"regular":return"/";default:return" "}}function Jle(r){return r>=80?"text-emerald-500":r>=60?"text-blue-500":r>=40?"text-amber-500":"text-rose-500"}function Za(r){return Ks!=null&&Ks.convertToBanglaNumber?Ks.convertToBanglaNumber(Math.round(r??0)):Math.round(r??0).toString()}function ph(r){const t=(Number.isFinite(r)?r:0).toFixed(1);return Ks!=null&&Ks.convertToBanglaNumber?`${Ks.convertToBanglaNumber(t)}%`:`${t}%`}function Sb(r){if(!r)return"";if(Ks!=null&&Ks.formatTimestamp)return Ks.formatTimestamp(r instanceof Date?r:new Date(r));const e=r instanceof Date?r:new Date(r);return Number.isNaN(e.getTime())?"":e.toLocaleDateString("bn-BD",{year:"numeric",month:"short",day:"numeric"})}function Zle(r){if(!r)return null;if(r instanceof Date)return r.getTime();if(typeof r=="number")return r;if(typeof r=="string"){const e=Date.parse(r);return Number.isNaN(e)?null:e}if(typeof r=="object"){if(typeof r.toDate=="function")try{return r.toDate().getTime()}catch{return null}if(typeof r.seconds=="number")return r.seconds*1e3}return null}function kb(r){return r?Ks!=null&&Ks.ensureBengaliText&&typeof Ks.ensureBengaliText=="function"?Ks.ensureBengaliText(r):typeof r=="string"?r.trim():String(r):""}function ece(){const r=document.documentElement;return r.classList.contains("dark")?!0:r.classList.contains("light")?!1:window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches}function tce(){const r=ece();return{dark:r,scoreBar:r?"rgba(96, 165, 250, 0.9)":"rgba(37, 99, 235, 0.9)",partBar:r?"rgba(52, 211, 153, 0.9)":"rgba(16, 185, 129, 0.9)",pendLine:r?"rgba(248, 113, 113, 1.0)":"rgba(220, 38, 38, 1.0)",pendLineBorder:r?"rgba(252, 165, 165, 1.0)":"rgba(239, 68, 68, 1.0)",grid:r?"rgba(148,163,184,0.25)":"rgba(100,116,139,0.2)",ticks:r?"#E5E7EB":"#334155",legend:r?"#F1F5F9":"#0F172A",tooltipBg:r?"rgba(2,6,23,0.9)":"rgba(255,255,255,0.95)",tooltipFg:r?"#F8FAFC":"#0F172A"}}function rce(r,e){if(!r)return;if(!!(r.offsetParent||r.getClientRects().length)){e();return}xu==null||xu.disconnect(),xu=new MutationObserver(()=>{!!(r.offsetParent||r.getClientRects().length)&&(xu.disconnect(),e())});let n=r;for(;n&&n!==document;)xu.observe(n,{attributes:!0,attributeFilter:["class","style"],subtree:!1}),n=n.parentElement}bh.register(...dT);bh.register(Hx);let Ai,IN,id,Gc,mx=[];const Ii={page:null,container:null};let tr={class:"all",section:"all",group:"all",academicGroup:"all",session:"all",gender:"all",role:"all",assignment:"all",extra:[]};const TN=[{id:"topic_none",text:"    (-)",type:"topic"},{id:"topic_understood",text:"  (+)",type:"topic"},{id:"topic_learned_well",text:"   (+)",type:"topic"},{id:"homework_done",text:"     (+)",type:"option"},{id:"attendance_regular",text:"   (+)",type:"option"},{id:"problem_resolved",text:" ",type:"status"},{id:"has_problem",text:" ",type:"status"}];function nce(r){return Ai=r.managers.stateManager,IN=r.managers.uiManager,id=r.services.dataService,Gc=r.utils,sce(),FN(),console.log(" Student Filter component initialized."),{render:ice}}async function FN(){try{await Promise.all([id.loadStudents(),id.loadGroups(),id.loadEvaluations(),id.loadTasks(),id.loadClasses(),id.loadSections()]),console.log(" Student Filter data loaded."),Ii.container&&Ad()}catch(r){console.error("Failed to load data for Student Filter:",r)}}function sce(){Ii.page=document.getElementById("page-student-filter"),Ii.page&&(Ii.container=Ii.page.querySelector("#studentFilterContainer"))}function ice(){!Ii.page||!Ii.container||(console.log("Rendering Student Filter page..."),Ii.container.innerHTML=`
    <div class="space-y-6">
      <!-- Top Filter Panel -->
      <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700 p-5 transition-all duration-300 hover:shadow-md">
        <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-4 border-b border-gray-100 dark:border-gray-700 pb-2">
          <h3 class="font-bold text-lg text-gray-800 dark:text-white flex items-center gap-2">
             
          </h3>
          <div class="flex items-center gap-2 mt-2 md:mt-0">
             <button id="sfRefreshBtn" class="text-xs font-medium text-blue-500 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 transition-colors flex items-center gap-1">
              <i class="fas fa-sync-alt"></i> 
            </button>
            <button id="sfResetBtn" class="text-xs font-medium text-red-500 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 transition-colors flex items-center gap-1">
              
            </button>
          </div>
        </div>
        
        <!-- Primary Filters Grid -->
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 mb-4">
          <!-- Class -->
          <div class="relative">
            <label class="block text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-1.5"></label>
            <div class="relative">
               <select id="sfClass" class="w-full form-select rounded-lg border-gray-200 dark:bg-gray-700/50 dark:border-gray-600 dark:text-gray-100 text-sm focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 transition-all">
                <option value="all"> </option>
              </select>
            </div>
          </div>

          <!-- Section -->
          <div class="relative">
            <label class="block text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-1.5"></label>
            <div class="relative">
               <select id="sfSection" class="w-full form-select rounded-lg border-gray-200 dark:bg-gray-700/50 dark:border-gray-600 dark:text-gray-100 text-sm focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 transition-all">
                <option value="all"> </option>
              </select>
            </div>
          </div>

          <!-- Group -->
          <div class="relative">
            <label class="block text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-1.5"></label>
            <div class="relative">
               <select id="sfGroup" class="w-full form-select rounded-lg border-gray-200 dark:bg-gray-700/50 dark:border-gray-600 dark:text-gray-100 text-sm focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 transition-all">
                <option value="all"> </option>
              </select>
            </div>
          </div>

          <!-- Academic Group -->
          <div class="relative">
            <label class="block text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-1.5"> </label>
            <div class="relative">
               <select id="sfAcademic" class="w-full form-select rounded-lg border-gray-200 dark:bg-gray-700/50 dark:border-gray-600 dark:text-gray-100 text-sm focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 transition-all">
                <option value="all"></option>
              </select>
            </div>

          </div>

           <!-- Session -->
          <div class="relative">
            <label class="block text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-1.5"></label>
            <div class="relative">
               <select id="sfSession" class="w-full form-select rounded-lg border-gray-200 dark:bg-gray-700/50 dark:border-gray-600 dark:text-gray-100 text-sm focus:ring-2 focus:ring-purple-500/20 focus:border-purple-500 transition-all">
                <option value="all"></option>
              </select>
            </div>
          </div>

          <!-- Gender -->
          <div class="relative">
            <label class="block text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-1.5"></label>
            <div class="relative">
               <select id="sfGender" class="w-full form-select rounded-lg border-gray-200 dark:bg-gray-700/50 dark:border-gray-600 dark:text-gray-100 text-sm focus:ring-2 focus:ring-pink-500/20 focus:border-pink-500 transition-all">
                <option value="all"></option>
                <option value=""></option>
                <option value=""></option>
              </select>
            </div>
          </div>

          <!-- Role -->
           <div class="relative">
            <label class="block text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-1.5"></label>
            <div class="relative">
               <select id="sfRole" class="w-full form-select rounded-lg border-gray-200 dark:bg-gray-700/50 dark:border-gray-600 dark:text-gray-100 text-sm focus:ring-2 focus:ring-orange-500/20 focus:border-orange-500 transition-all">
                <option value="all"></option>
                <option value="team-leader"> </option>
                <option value="time-keeper"> </option>
                <option value="reporter"></option>
                <option value="resource-manager"> </option>
                <option value="peace-maker"> </option>
              </select>
            </div>
          </div>

           <!-- Assignment (Target Assignment) -->
          <div class="relative">
            <label class="block text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-1.5"></label>
             <div class="relative">
               <select id="sfAssignment" class="w-full form-select rounded-lg border-gray-200 dark:bg-gray-700/50 dark:border-gray-600 dark:text-gray-100 text-sm focus:ring-2 focus:ring-cyan-500/20 focus:border-cyan-500 transition-all">
                <option value="all">  ()</option>
              </select>
            </div>
          </div>
        </div>

        <!-- Extra Filters (Chips Layout) -->
        <div class="pt-4 border-t border-gray-100 dark:border-gray-700">
          <label class="block text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-3">  </label>
          <div class="flex flex-wrap gap-2">
            ${TN.map(r=>`
              <label class="group relative cursor-pointer select-none">
                <input type="checkbox" value="${r.id}" class="peer sr-only sf-extra-check">
                <div class="px-3 py-1.5 rounded-full border border-gray-200 dark:border-gray-600 bg-gray-50 dark:bg-gray-700/50 text-gray-600 dark:text-gray-300 text-xs font-medium transition-all peer-checked:bg-blue-50 peer-checked:text-blue-600 peer-checked:border-blue-200 dark:peer-checked:bg-blue-900/30 dark:peer-checked:text-blue-300 dark:peer-checked:border-blue-700/50 hover:bg-gray-100 dark:hover:bg-gray-700">
                  ${r.text}
                </div>
              </label>
            `).join("")}
             <label class="group relative cursor-pointer select-none">
                <input type="checkbox" value="unevaluated" class="peer sr-only sf-extra-check">
                <div class="px-3 py-1.5 rounded-full border border-gray-200 dark:border-gray-600 bg-gray-50 dark:bg-gray-700/50 text-gray-600 dark:text-gray-300 text-xs font-medium transition-all peer-checked:bg-amber-50 peer-checked:text-amber-600 peer-checked:border-amber-200 dark:peer-checked:bg-amber-900/30 dark:peer-checked:text-amber-300 dark:peer-checked:border-amber-700/50 hover:bg-gray-100 dark:hover:bg-gray-700">
                   
                </div>
              </label>
             
              <label class="group relative cursor-pointer select-none">
                <input type="checkbox" value="absent_mcq" class="peer sr-only sf-extra-check">
                <div class="px-3 py-1.5 rounded-full border border-gray-200 dark:border-gray-600 bg-gray-50 dark:bg-gray-700/50 text-gray-600 dark:text-gray-300 text-xs font-medium transition-all peer-checked:bg-rose-50 peer-checked:text-rose-600 peer-checked:border-rose-200 dark:peer-checked:bg-rose-900/30 dark:peer-checked:text-rose-300 dark:peer-checked:border-rose-700/50 hover:bg-gray-100 dark:hover:bg-gray-700">
                  MCQ  
                </div>
              </label>
          </div>
        </div>
      </div>

      <!-- Main Content (Table & Chart) -->
      <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden">
        <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex flex-col sm:flex-row justify-between items-center gap-4 bg-gray-50/50 dark:bg-gray-900/50 backdrop-blur-sm">
          <div class="flex flex-col sm:flex-row items-start sm:items-center gap-2 sm:gap-4 w-full sm:w-auto">
            <div class="flex items-center gap-2">
              <span class="flex h-8 w-8 items-center justify-center rounded-lg bg-blue-100 text-blue-600 dark:bg-blue-900/30 dark:text-blue-400">
                <i class="fas fa-list-ul"></i>
              </span>
              <h3 class="font-bold text-gray-800 dark:text-gray-200" id="sfResultCount">: ...</h3>
            </div>
            
             <!-- Color Legend (Header) -->
            <div id="sfChartLegend" class="hidden flex-wrap gap-2 sm:ml-2">
              <span class="inline-flex items-center gap-1 text-[10px] text-gray-500 dark:text-gray-400 bg-white dark:bg-gray-700 px-2 py-0.5 rounded-full border border-gray-100 dark:border-gray-600 shadow-sm">
                <span class="w-2 h-2 rounded-full bg-purple-400"></span> 
              </span>
              <span class="inline-flex items-center gap-1 text-[10px] text-gray-500 dark:text-gray-400 bg-white dark:bg-gray-700 px-2 py-0.5 rounded-full border border-gray-100 dark:border-gray-600 shadow-sm">
                <span class="w-2 h-2 rounded-full bg-orange-400"></span> 
              </span>
              <span class="inline-flex items-center gap-1 text-[10px] text-gray-500 dark:text-gray-400 bg-white dark:bg-gray-700 px-2 py-0.5 rounded-full border border-gray-100 dark:border-gray-600 shadow-sm">
                <span class="w-2 h-2 rounded-full bg-blue-400"></span> 
              </span>
            </div>
          </div>
          
          <div class="flex items-center gap-3 w-full sm:w-auto justify-between sm:justify-end">
             <!-- View Toggle -->
            <div class="flex items-center bg-gray-100 dark:bg-gray-700 rounded-lg p-1">
              <button id="sfViewTable" class="px-3 py-1.5 rounded-md text-xs font-bold bg-white dark:bg-gray-600 shadow-sm text-gray-800 dark:text-white transition-all flex items-center gap-1.5">
                <i class="fas fa-table"></i> 
              </button>
              <button id="sfViewChart" class="px-3 py-1.5 rounded-md text-xs font-bold text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 transition-all flex items-center gap-1.5">
                <i class="fas fa-chart-bar"></i> 
              </button>
            </div>

            <button id="sfPrintBtn" class="btn btn-sm btn-primary shadow-sm flex items-center gap-2">
              <i class="fas fa-print"></i>  
            </button>
          </div>
        </div>

        <!-- Table View -->
        <div id="sfTableContainer" class="overflow-x-auto transition-all duration-300">
          <table class="w-full text-sm text-left">
            <thead class="text-xs text-gray-500 uppercase bg-gray-50 dark:bg-gray-900/30 dark:text-gray-400 border-b border-gray-100 dark:border-gray-700">
              <tr>
                <th class="px-6 py-3 font-semibold tracking-wider">#</th>
                <th class="px-6 py-3 font-semibold tracking-wider"></th>
                <th class="px-6 py-3 font-semibold tracking-wider"></th>
                <th class="px-6 py-3 font-semibold tracking-wider"></th>
                <th class="px-6 py-3 font-semibold tracking-wider"></th>
                <th class="px-6 py-3 font-semibold tracking-wider"></th>
                <th class="px-6 py-3 font-semibold tracking-wider"></th>
                <th class="px-6 py-3 font-semibold tracking-wider"> </th>
                <th class="px-6 py-3 font-semibold tracking-wider"></th>
                <th class="px-6 py-3 font-semibold tracking-wider"></th>
                <th class="px-6 py-3 font-semibold tracking-wider"></th>

                <th class="px-6 py-3 text-center font-semibold tracking-wider" id="sfScoreHeader"> </th>
              </tr>
            </thead>
            <tbody id="sfTableBody" class="divide-y divide-gray-100 dark:divide-gray-700/50">
              <!-- Rows will be injected here -->
            </tbody>
          </table>
        </div>

        <!-- Chart View -->
        <div id="sfChartContainer" class="hidden p-4 sm:p-6 w-full h-[500px] sm:h-[600px] bg-white dark:bg-gray-800 transition-all duration-300">
             <canvas id="sfChartCanvas"></canvas>
        </div>

        <div id="sfEmptyState" class="hidden py-12 flex flex-col items-center justify-center text-gray-400 dark:text-gray-500">
          <div class="bg-gray-50 dark:bg-gray-800 p-4 rounded-full mb-3">
             <i class="fas fa-search text-3xl opacity-50"></i>
          </div>
          <p class="text-lg font-medium">   </p>
          <p class="text-sm opacity-75">     </p>
        </div>
      </div>
    </div>
  `,ace(),oce(),Ad())}function ace(){const r=Ai.get("groups")||[],e=Ai.get("students")||[],t=Ai.get("tasks")||[],n=Ai.get("classes")||[],s=Ai.get("sections")||[],i=document.getElementById("sfClass");i&&n.forEach(A=>{const d=document.createElement("option");d.value=A.id,d.textContent=A.name,i.appendChild(d)}),LN(s);const a=document.getElementById("sfGroup");a&&r.forEach(A=>{const d=document.createElement("option");d.value=A.id,d.textContent=A.name,a.appendChild(d)});const o=document.getElementById("sfAcademic");o&&[...new Set(e.map(d=>d.academicGroup).filter(Boolean))].sort().forEach(d=>{const h=document.createElement("option");h.value=d,h.textContent=d,o.appendChild(h)});const l=document.getElementById("sfSession");l&&[...new Set(e.map(d=>d.session).filter(Boolean))].sort().forEach(d=>{const h=document.createElement("option");h.value=d,h.textContent=d,l.appendChild(h)});const c=document.getElementById("sfAssignment");c&&(t.sort((A,d)=>(d.date||"").localeCompare(A.date||"")),t.forEach(A=>{const d=document.createElement("option");d.value=A.id,d.textContent=A.name,c.appendChild(d)}))}function LN(r,e="all"){const t=document.getElementById("sfSection");if(!t)return;const n=t.value;t.innerHTML='<option value="all"> </option>',(e==="all"?r:r.filter(i=>i.classId===e)).forEach(i=>{const a=document.createElement("option");a.value=i.id,a.textContent=i.name,t.appendChild(a)}),e==="all"||r.find(i=>i.id===n&&i.classId===e)?t.value=n:(t.value="all",tr.section="all")}function oce(){const r=Ii.container,e=r.querySelector("#sfViewTable"),t=r.querySelector("#sfViewChart");e&&t&&(e.addEventListener("click",()=>{tr.viewMode="table",cI(),Ad()}),t.addEventListener("click",()=>{tr.viewMode="chart",cI(),Ad()})),["sfClass","sfSection","sfGroup","sfAcademic","sfSession","sfGender","sfRole","sfAssignment"].forEach(o=>{const l=r.querySelector(`#${o}`);l&&l.addEventListener("change",c=>{const A=o.replace("sf","");let d=A.charAt(0).toLowerCase()+A.slice(1);if(d==="academic"&&(d="academicGroup"),tr[d]=c.target.value,o==="sfClass"){const h=Ai.get("sections")||[];LN(h,c.target.value)}Ad()})}),r.querySelectorAll(".sf-extra-check").forEach(o=>{o.addEventListener("change",l=>{l.target.checked?tr.extra.push(l.target.value):tr.extra=tr.extra.filter(c=>c!==l.target.value),Ad()})});const s=r.querySelector("#sfResetBtn");s&&s.addEventListener("click",()=>{tr={group:"all",academicGroup:"all",session:"all",gender:"all",role:"all",assignment:"all",extra:[],viewMode:tr.viewMode||"table"},["sfClass","sfSection","sfGroup","sfAcademic","sfSession","sfGender","sfRole","sfAssignment"].forEach(o=>{const l=r.querySelector(`#${o}`);l&&(l.value="all")}),r.querySelectorAll(".sf-extra-check").forEach(o=>o.checked=!1),Ad()});const i=r.querySelector("#sfRefreshBtn");i&&i.addEventListener("click",()=>{FN()});const a=r.querySelector("#sfPrintBtn");a&&a.addEventListener("click",()=>{if(mx.length===0){IN.showToast("     ","warning");return}const o=Ai.get("evaluations")||[],l=Ai.get("groups")||[],c=Ai.get("tasks")||[],A=Ai.get("classes")||[],d=Ai.get("sections")||[],h=new Map(l.map(m=>[m.id,m])),u=new Map(c.map(m=>[m.id,m])),p=new Map(A.map(m=>[m.id,m])),f=new Map(d.map(m=>[m.id,m])),g=new Map(TN.map(m=>[m.id,m.text]));g.set("unevaluated"," "),g.set("absent_mcq","MCQ  "),gM(mx,tr,o,h,g,u,p,f)})}function cI(){const r=Ii.container,e=r.querySelector("#sfViewTable"),t=r.querySelector("#sfViewChart"),n=r.querySelector("#sfTableContainer"),s=r.querySelector("#sfChartContainer"),i=r.querySelector("#sfChartLegend");tr.viewMode==="chart"?(e.className="px-3 py-1.5 rounded-md text-xs font-bold text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 transition-all flex items-center gap-1.5",t.className="px-3 py-1.5 rounded-md text-xs font-bold bg-white dark:bg-gray-600 shadow-sm text-gray-800 dark:text-white transition-all flex items-center gap-1.5",n.classList.add("hidden"),s.classList.remove("hidden"),i&&i.classList.remove("hidden"),i&&i.classList.add("flex")):(e.className="px-3 py-1.5 rounded-md text-xs font-bold bg-white dark:bg-gray-600 shadow-sm text-gray-800 dark:text-white transition-all flex items-center gap-1.5",t.className="px-3 py-1.5 rounded-md text-xs font-bold text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 transition-all flex items-center gap-1.5",n.classList.remove("hidden"),s.classList.add("hidden"),i&&i.classList.add("hidden"),i&&i.classList.remove("flex"))}function Ad(){const r=Ai.get("students")||[],e=Ai.get("groups")||[],t=Ai.get("evaluations")||[],n=Ai.get("classes")||[],s=Ai.get("sections")||[],i=new Map(e.map(g=>[g.id,g])),a=new Map(n.map(g=>[g.id,g])),o=new Map(s.map(g=>[g.id,g])),l=r.filter(g=>{var x;if(tr.class!=="all"&&g.classId!==tr.class||tr.section!=="all"&&g.sectionId!==tr.section||tr.group!=="all"&&g.groupId!==tr.group||tr.academicGroup!=="all"&&(g.academicGroup||"").trim()!==tr.academicGroup||tr.session!=="all"&&g.session!==tr.session)return!1;if(tr.gender!=="all"){const S=(g.gender||"").trim().normalize("NFC"),B=tr.gender.trim().normalize("NFC");if(S!==B)return!1}if(tr.role!=="all"&&g.role!==tr.role)return!1;const m=[];if(t.forEach(S=>{S.scores&&S.scores[g.id]&&m.push({taskId:S.taskId,taskDate:S.taskDate,...S.scores[g.id]})}),tr.extra.length>0){for(const S of tr.extra)if(S==="unevaluated"){if(m.length>0)return!1}else if(S==="absent_task")if(tr.assignment!=="all"){const B=m.find(F=>F.taskId===tr.assignment);return!B||!B.taskScore}else return!!(m.length===0||m.some(F=>!F.taskScore));else if(S==="absent_mcq")if(tr.assignment!=="all"){const B=m.find(F=>F.taskId===tr.assignment);return!B||!B.mcqScore}else return!!(m.length===0||m.some(F=>!F.mcqScore));else if(S==="problem_resolved"){if(tr.assignment!=="all"){const B=m.find(F=>F.taskId===tr.assignment);return B?B.problemRecovered===!0:!1}else if(!m.some(N=>N.problemRecovered===!0)||m.some(N=>{var v;const E=(v=N.ProgressCriteria)==null?void 0:v.topic;return(E==="topic_understood"||E==="topic_none")&&!N.problemRecovered}))return!1}else if(S==="has_problem"){if(tr.assignment!=="all"){const B=m.find(E=>E.taskId===tr.assignment);if(!B)return!1;const F=(x=B.ProgressCriteria)==null?void 0:x.topic;return(F==="topic_understood"||F==="topic_none")&&!B.problemRecovered}else if(!m.some(F=>{var w;const N=(w=F.ProgressCriteria)==null?void 0:w.topic;return(N==="topic_understood"||N==="topic_none")&&!F.problemRecovered}))return!1}else if(!m.some(F=>{const N=F.ProgressCriteria||{};return S.startsWith("topic_")?N.topic===S:S==="homework_done"?N.homework===!0:S==="attendance_regular"?N.attendance===!0:!1}))return!1}return!0});mx=l;const c=Ii.container.querySelector("#sfTableBody"),A=Ii.container.querySelector("#sfResultCount"),d=Ii.container.querySelector("#sfEmptyState"),h=Ii.container.querySelector("#sfTableContainer"),u=Ii.container.querySelector("#sfChartContainer");if(A&&(A.textContent=`: ${Gc.convertToBanglaNumber(l.length)} `),l.length===0){h&&h.classList.add("hidden"),u&&u.classList.add("hidden"),d&&d.classList.remove("hidden");return}if(d&&d.classList.add("hidden"),tr.viewMode==="chart"){h&&h.classList.add("hidden"),u&&u.classList.remove("hidden"),lce(l,t);return}else h&&h.classList.remove("hidden"),u&&u.classList.add("hidden");c&&(c.innerHTML="");const p=Ii.container.querySelector("thead tr");let f=p.querySelector("#sfSpecificScoreHeader");tr.assignment!=="all"?f||(f=document.createElement("th"),f.id="sfSpecificScoreHeader",f.className="px-6 py-3 text-center font-semibold tracking-wider text-blue-600 dark:text-blue-400 whitespace-nowrap",f.textContent=" ",p.appendChild(f)):f&&f.remove(),l.forEach((g,m)=>{var X,$,V,he;const x=document.createElement("tr");x.className="bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors cursor-pointer";const S=((X=i.get(g.groupId))==null?void 0:X.name)||"-",B=(($=a.get(g.classId))==null?void 0:$.name)||"-",F=((V=o.get(g.sectionId))==null?void 0:V.name)||"-",N=[];t.forEach(z=>{z.scores&&z.scores[g.id]&&N.push({taskId:z.taskId,...z.scores[g.id]})});const E=N.reduce((z,M)=>z+(M.totalScore||0),0),w=N.length?(E/N.length).toFixed(1):0,v=N.length?Gc.convertToBanglaNumber(w):"-";let I="-",k="text-gray-500 dark:text-gray-400";if(tr.assignment!=="all"){const z=N.find(M=>M.taskId===tr.assignment);z&&(I=Gc.convertToBanglaNumber(z.totalScore),k="font-bold text-blue-600 dark:text-blue-400")}let _="-";const T=(g.gender||"").trim();T===""||T.toLowerCase()==="male"?_='<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-800 dark:text-blue-100"></span>':T===""||T.toLowerCase()==="female"?_='<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-pink-100 text-pink-800 dark:bg-pink-800 dark:text-pink-100"></span>':T&&(_=`<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200">${T}</span>`);let L="-",K=!1,se=!1;if(tr.assignment!=="all"){const z=N.find(M=>M.taskId===tr.assignment);if(z){const M=(he=z.ProgressCriteria)==null?void 0:he.topic;(M==="topic_understood"||M==="topic_none")&&!z.problemRecovered&&(K=!0),z.problemRecovered&&(se=!0)}}else K=N.some(z=>{var H;const M=(H=z.ProgressCriteria)==null?void 0:H.topic;return(M==="topic_understood"||M==="topic_none")&&!z.problemRecovered}),K||(se=N.some(z=>z.problemRecovered===!0));K?L=`<span class="inline-flex items-center gap-1 px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300 border border-red-200 dark:border-red-800">
            <i class="fas fa-exclamation-circle"></i>  
          </span>`:se&&(L=`<span class="inline-flex items-center gap-1 px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300 border border-green-200 dark:border-green-800">
            <i class="fas fa-check-circle"></i> 
          </span>`),x.innerHTML=`
        <td class="px-6 py-3 font-medium text-gray-500 dark:text-gray-400">${Gc.convertToBanglaNumber(m+1)}</td>
        <td class="px-6 py-3 font-medium text-gray-900 dark:text-white whitespace-nowrap">${g.name}</td>
        <td class="px-6 py-3">${Gc.convertToBanglaNumber(g.roll)}</td>
        <td class="px-6 py-3 whitespace-nowrap">${B}</td>
        <td class="px-6 py-3 whitespace-nowrap">${F}</td>
        <td class="px-6 py-3">${_}</td>
        <td class="px-6 py-3 whitespace-nowrap">${S}</td>
        <td class="px-6 py-3 whitespace-nowrap">${Ace(g.academicGroup)}</td>
        <td class="px-6 py-3">${g.session||"-"}</td>
        <td class="px-6 py-3 whitespace-nowrap">${dce(g.role)}</td>
        <td class="px-6 py-3 whitespace-nowrap">${L}</td>

        <td class="px-6 py-3 text-center font-medium">${v}</td>
        ${tr.assignment!=="all"?`<td class="px-6 py-3 text-center ${k}">${I}</td>`:""}
      `,x.addEventListener("click",()=>{typeof window<"u"&&typeof window.openStudentModalById=="function"?window.openStudentModalById(g.id):console.warn("Student modal function not available")}),c.appendChild(x)})}let yv=null;function lce(r,e){const t=document.getElementById("sfChartCanvas");if(!t)return;const n=r.map(o=>{const l=[];e.forEach(A=>{A.scores&&A.scores[o.id]&&l.push({taskId:A.taskId,...A.scores[o.id]})});let c=0;if(tr.assignment!=="all"){const A=l.find(d=>d.taskId===tr.assignment);c=A&&Number(A.totalScore)||0}else{const A=l.reduce((d,h)=>d+(Number(h.totalScore)||0),0);c=l.length?A/l.length:0}return{name:o.name,roll:o.roll,academicGroup:o.academicGroup,score:Number(c.toFixed(1))}});n.sort((o,l)=>l.score-o.score);const s=n.map(o=>o.name),i=n.map(o=>o.score),a=n.map(o=>cce(o.academicGroup));yv&&yv.destroy(),yv=new bh(t,{type:"bar",data:{labels:s,datasets:[{label:tr.assignment!=="all"?" ":" ",data:i,backgroundColor:a,borderRadius:6,borderSkipped:!1,barPercentage:.7,categoryPercentage:.8}]},options:{responsive:!0,maintainAspectRatio:!1,indexAxis:"x",plugins:{legend:{display:!1},tooltip:{callbacks:{label:function(o){const l=n[o.dataIndex];return`${l.name} (${l.roll}) - ${Gc.convertToBanglaNumber(l.score)}`}}},datalabels:{anchor:"end",align:"top",formatter:o=>Gc.convertToBanglaNumber(o),font:{weight:"bold",size:11},color:document.documentElement.classList.contains("dark")?"#e5e7eb":"#6b7280"}},scales:{y:{beginAtZero:!0,grid:{color:document.documentElement.classList.contains("dark")?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.05)",borderDash:[5,5]},ticks:{color:document.documentElement.classList.contains("dark")?"#e5e7eb":"#6b7280",font:{family:"'Noto Sans Bengali', sans-serif"}}},x:{grid:{display:!1},ticks:{autoSkip:!1,maxRotation:90,minRotation:45,color:document.documentElement.classList.contains("dark")?"#e5e7eb":"#6b7280",font:{size:10,family:"'Noto Sans Bengali', sans-serif"}}}},onClick:(o,l)=>{if(l.length>0){const c=l[0].index,A=r.find(d=>d.name===n[c].name&&d.roll===n[c].roll);A&&typeof window<"u"&&typeof window.openStudentModalById=="function"&&window.openStudentModalById(A.id)}}}})}function cce(r){const e=(r||"").toString().trim().toLowerCase();return/science|/.test(e)?"rgba(168, 85, 247, 0.7)":/arts|/.test(e)?"rgba(249, 115, 22, 0.7)":/commerce||/.test(e)?"rgba(59, 130, 246, 0.7)":/vocational|/.test(e)?"rgba(6, 182, 212, 0.7)":"rgba(107, 114, 128, 0.7)"}function Ace(r){if(!r)return"-";const e={Science:"bg-purple-100 text-purple-800 dark:bg-purple-800 dark:text-purple-100","Business Studies":"bg-blue-100 text-blue-800 dark:bg-blue-800 dark:text-blue-100",Humanities:"bg-amber-100 text-amber-800 dark:bg-amber-800 dark:text-amber-100"};let t="bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300";return r.includes("Science")||r.includes("")?t=e.Science:r.includes("Business")||r.includes("")?t=e["Business Studies"]:(r.includes("Humanities")||r.includes(""))&&(t=e.Humanities),`<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${t}">${r}</span>`}function dce(r){if(!r)return"-";const t={"team-leader":{label:" ",cls:"bg-red-100 text-red-800 dark:bg-red-800 dark:text-red-100"},"time-keeper":{label:" ",cls:"bg-yellow-100 text-yellow-800 dark:bg-yellow-800 dark:text-yellow-100"},reporter:{label:"",cls:"bg-green-100 text-green-800 dark:bg-green-800 dark:text-green-100"},"resource-manager":{label:" ",cls:"bg-indigo-100 text-indigo-800 dark:bg-indigo-800 dark:text-indigo-100"},"peace-maker":{label:" ",cls:"bg-pink-100 text-pink-800 dark:bg-pink-800 dark:text-pink-100"}}[r]||{label:r,cls:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"};return`<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${t.cls}">${t.label}</span>`}const Sa={dashboardSections:{hero:!0,stats:!0,eliteGroups:!0,topGroups:!0,academicStats:!0,ranking:!0},theme:"theme-blue",sidebar:{dashboard:{visible:!0,type:"public",label:"",icon:"fa-tachometer-alt",locked:!0},"upcoming-assignments":{visible:!0,type:"public",label:" ",icon:"fa-calendar-week"},"student-ranking":{visible:!0,type:"public",label:" ",icon:"fa-trophy"},"all-students":{visible:!0,type:"public",label:" ",icon:"fa-user-graduate"},"student-filter":{visible:!0,type:"public",label:" ",icon:"fa-filter"},"group-analysis":{visible:!0,type:"public",label:" ",icon:"fa-chart-bar"},"graph-analysis":{visible:!0,type:"public",label:" ",icon:"fa-chart-line"},statistics:{visible:!0,type:"public",label:" ",icon:"fa-calculator"},"group-policy":{visible:!0,type:"public",label:" ",icon:"fa-book"},export:{visible:!0,type:"public",label:"",icon:"fa-file-export"},"public-settings":{visible:!0,type:"public",label:" ",icon:"fa-cog"},groups:{visible:!0,type:"private",label:" ",icon:"fa-layer-group"},members:{visible:!0,type:"private",label:" ",icon:"fa-users"},tasks:{visible:!0,type:"private",label:" ",icon:"fa-tasks"},evaluation:{visible:!0,type:"private",label:"",icon:"fa-clipboard-check"},"class-management":{visible:!0,type:"private",label:" ",icon:"fa-school"},"teacher-management":{visible:!0,type:"private",label:" ",icon:"fa-chalkboard-teacher"},"data-migration":{visible:!0,type:"private",label:" ",icon:"fa-database"},"admin-management":{visible:!0,type:"private",label:" ",icon:"fa-user-shield"},settings:{visible:!0,type:"private",label:"",icon:"fa-cog",locked:!0}}};let fr=JSON.parse(JSON.stringify(Sa));const UN="app_settings_v2";function uce(r){return wce(),hce(),Gd(),console.log(" Settings component initialized"),{render:By,applySettings:Gd,isPagePublic:yce,toggleSidebarType:pce,toggleDashboardSection:mce,toggleSidebarVisibility:gce,setTheme:bce}}function hce(){Object.keys(fr.sidebar).forEach(r=>{Sa.sidebar.hasOwnProperty(r)||delete fr.sidebar[r]}),Object.keys(Sa.sidebar).forEach(r=>{fr.sidebar[r]?(Sa.sidebar[r].locked&&(fr.sidebar[r].locked=!0,fr.sidebar[r].visible=!0,fr.sidebar[r].type=Sa.sidebar[r].type),fr.sidebar[r].label=Sa.sidebar[r].label,fr.sidebar[r].icon=Sa.sidebar[r].icon,!Sa.sidebar[r].locked&&fr.sidebar[r].visible===void 0&&(fr.sidebar[r].visible=Sa.sidebar[r].visible)):fr.sidebar[r]=Sa.sidebar[r]}),Object.keys(Sa.dashboardSections).forEach(r=>{fr.dashboardSections[r]===void 0&&(fr.dashboardSections[r]=Sa.dashboardSections[r])}),fp()}function By(){const r=document.getElementById("settingsContent");if(!r)return;const t=ir.get("activePage")==="public-settings",n=ir.get("currentUserData"),s=n&&(n.type==="admin"||n.type==="super-admin"),i=q2.getThemes(),a=fr.theme||"theme-blue",o=`
    <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700 overflow-hidden">
      <div class="p-6 border-b border-gray-100 dark:border-gray-700 bg-gray-50/50 dark:bg-gray-800/50">
        <div class="flex items-center gap-3">
          <div class="w-10 h-10 rounded-full bg-pink-100 dark:bg-pink-900/30 flex items-center justify-center text-pink-600 dark:text-pink-400">
            <i class="fas fa-palette"></i>
          </div>
          <div>
            <h4 class="font-bold text-gray-800 dark:text-white"> </h4>
            <p class="text-xs text-gray-500 dark:text-gray-400">    </p>
          </div>
        </div>
      </div>
      <div class="p-6 space-y-6">
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
          ${Object.entries(i).map(([l,c])=>{const A=a===c,d={"theme-blue":"bg-blue-500","theme-emerald":"bg-emerald-500","theme-violet":"bg-violet-500","theme-amber":"bg-amber-500"},h={"theme-blue":"Blue","theme-emerald":"Emerald","theme-violet":"Violet","theme-amber":"Amber"};return`
              <button onclick="window.smartEvaluator.components.settings.setTheme('${c}')" 
                class="relative group p-4 rounded-xl border-2 transition-all duration-200 flex flex-col items-center gap-3 ${A?"border-primary-500 bg-primary-50 dark:bg-primary-900/10":"border-gray-100 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}">
                <div class="w-12 h-12 rounded-full ${d[c]} shadow-lg group-hover:scale-110 transition-transform duration-200 flex items-center justify-center">
                  ${A?'<i class="fas fa-check text-white"></i>':""}
                </div>
                <span class="text-sm font-medium text-gray-700 dark:text-gray-300">${h[c]}</span>
              </button>
            `}).join("")}
        </div>

        ${s?`
        <div class="flex items-center justify-between pt-4 border-t border-gray-100 dark:border-gray-700">
          <div>
            <p class="font-medium text-gray-800 dark:text-white">    </p>
            <p class="text-xs text-gray-500 dark:text-gray-400">      </p>
          </div>
          <label class="relative inline-flex items-center cursor-pointer">
            <input type="checkbox" id="globalThemeToggle" class="sr-only peer">
            <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer dark:bg-gray-600 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-primary-600"></div>
          </label>
        </div>
        `:""}
      </div>
    </div>
  `;if(t){r.innerHTML=`
      <div class="space-y-8 max-w-4xl mx-auto">
        <div class="bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-sm border border-gray-100 dark:border-gray-700">
          <h3 class="text-xl font-bold text-gray-800 dark:text-white mb-2"> </h3>
          <p class="text-gray-500 dark:text-gray-400 text-sm">            </p>
        </div>
        ${o}
      </div>
    `;return}r.innerHTML=`
    <div class="space-y-8">
      <div class="bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-sm border border-gray-100 dark:border-gray-700">
        <h3 class="text-xl font-bold text-gray-800 dark:text-white mb-2"> </h3>
        <p class="text-gray-500 dark:text-gray-400 text-sm">      </p>
      </div>

      <div class="grid grid-cols-1 xl:grid-cols-3 gap-8">
        <div class="xl:col-span-2 space-y-6">
          <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700 overflow-hidden">
            <div class="p-6 border-b border-gray-100 dark:border-gray-700 flex justify-between items-center bg-gray-50/50 dark:bg-gray-800/50">
              <div class="flex items-center gap-3">
                <div class="w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center text-blue-600 dark:text-blue-400">
                  <i class="fas fa-bars"></i>
                </div>
                <div>
                  <h4 class="font-bold text-gray-800 dark:text-white"> </h4>
                  <p class="text-xs text-gray-500 dark:text-gray-400">    </p>
                </div>
              </div>
            </div>
            
            <div class="overflow-x-auto">
              <table class="w-full text-sm text-left">
                <thead class="text-xs text-gray-500 uppercase bg-gray-50/80 dark:bg-gray-700/50 dark:text-gray-400">
                  <tr>
                    <th scope="col" class="px-6 py-4 font-semibold"> </th>
                    <th scope="col" class="px-6 py-4 text-center font-semibold"></th>
                    <th scope="col" class="px-6 py-4 text-center font-semibold"> </th>
                  </tr>
                </thead>
                <tbody class="divide-y divide-gray-100 dark:divide-gray-700/50">
                  ${fce()}
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <div class="space-y-6">
          ${o}

          <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700 overflow-hidden">
            <div class="p-6 border-b border-gray-100 dark:border-gray-700 bg-gray-50/50 dark:bg-gray-800/50">
              <div class="flex items-center gap-3">
                <div class="w-10 h-10 rounded-full bg-purple-100 dark:bg-purple-900/30 flex items-center justify-center text-purple-600 dark:text-purple-400">
                  <i class="fas fa-tachometer-alt"></i>
                </div>
                <div>
                  <h4 class="font-bold text-gray-800 dark:text-white"> </h4>
                  <p class="text-xs text-gray-500 dark:text-gray-400">   </p>
                </div>
              </div>
            </div>
            <div class="p-6 space-y-4">
              ${uf("hero"," ","    ","fa-star","indigo")}
              ${uf("stats"," "," ,    ","fa-chart-pie","blue")}
              ${uf("topGroups","  ( )","    ","fa-crown","yellow")}
              ${uf("academicStats"," "," ","fa-university","sky")}
              ${uf("ranking"," ","   ","fa-list-ol","emerald")}
            </div>
          </div>
          
          <div class="bg-sky-50 dark:bg-gray-700/60 rounded-2xl p-6 border border-sky-100 dark:border-gray-600">
            <div class="flex gap-3">
              <i class="fas fa-info-circle text-sky-600 dark:text-sky-400 mt-1"></i>
              <div>
                <h5 class="font-semibold text-sky-800 dark:text-white text-sm"> </h5>
                <p class="text-xs text-sky-700/90 dark:text-gray-200 mt-1 leading-relaxed">
                  ''         ''          
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  `}function uf(r,e,t,n,s){const i=fr.dashboardSections[r];return'<div class="flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700/30 rounded-xl border border-gray-100 dark:border-gray-700 hover:border-purple-200 dark:hover:border-purple-500/30 transition-colors"><div class="flex items-center gap-4"><div class="w-10 h-10 rounded-lg bg-'+s+"-100 dark:bg-"+s+"-900/30 flex items-center justify-center text-"+s+"-600 dark:text-"+s+'-400 shadow-sm"><i class="fas '+n+'"></i></div><div><p class="font-semibold text-gray-900 dark:text-white">'+e+'</p><p class="text-xs text-gray-500 dark:text-gray-400 mt-0.5">'+t+'</p></div></div><label class="relative inline-flex items-center cursor-pointer"><input type="checkbox" class="sr-only peer" '+(i?"checked":"")+` onchange="window.smartEvaluator.components.settings.toggleDashboardSection('`+r+`', this.checked)"><div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-purple-300/50 dark:peer-focus:ring-purple-800/50 rounded-full peer dark:bg-gray-600 peer-checked:after:translate-x-full peer-checked:after:border-white after-content-empty after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-purple-600"></div></label></div>`}function fce(){return Object.keys(Sa.sidebar).map(r=>{const e=fr.sidebar[r];if(!e)return"";const t=e.locked;return'<tr class="group hover:bg-gray-50 dark:hover:bg-gray-700/30 transition-colors border-b border-gray-50 dark:border-gray-800 last:border-0"><td class="px-6 py-4"><div class="flex items-center gap-4"><div class="w-8 h-8 rounded-lg bg-gray-100 dark:bg-gray-700 flex items-center justify-center text-gray-500 dark:text-gray-400 group-hover:bg-white group-hover:shadow-sm dark:group-hover:bg-gray-600 transition-all"><i class="fas '+e.icon+'"></i></div><span class="font-medium text-gray-700 dark:text-gray-200">'+e.label+'</span></div></td><td class="px-6 py-4 text-center"><label class="relative inline-flex items-center '+(t?"cursor-not-allowed opacity-60":"cursor-pointer")+'"><input type="checkbox" class="sr-only peer" '+(e.visible?"checked":"")+" "+(t?"disabled":"")+` onchange="window.smartEvaluator.components.settings.toggleSidebarVisibility('`+r+`', this.checked)"><div class="w-9 h-5 bg-gray-200 peer-focus:outline-none rounded-full peer dark:bg-gray-600 peer-checked:after:translate-x-full peer-checked:after:border-white after-content-empty after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"></div></label></td><td class="px-6 py-4 text-center"><button class="relative inline-flex items-center justify-center px-4 py-1.5 overflow-hidden text-xs font-medium transition-all duration-300 ease-out rounded-full group-btn `+(t?"cursor-not-allowed opacity-60":"hover:shadow-md cursor-pointer")+" "+(e.type==="private"?"bg-red-50 text-red-600 dark:bg-red-900/20 dark:text-red-400 border border-red-200 dark:border-red-800":"bg-emerald-50 text-emerald-600 dark:bg-emerald-900/20 dark:text-emerald-400 border border-emerald-200 dark:border-emerald-800")+'" '+(t?"disabled":"")+` onclick="window.smartEvaluator.components.settings.toggleSidebarType('`+r+`')"><span class="mr-1.5"><i class="fas `+(e.type==="private"?"fa-lock":"fa-globe")+'"></i></span>'+(e.type==="private"?"":"")+"</button></td></tr>"}).join("")}function gce(r,e){fr.sidebar[r]&&!fr.sidebar[r].locked&&(fr.sidebar[r].visible=e,fp(),Gd())}function pce(r){fr.sidebar[r]&&!fr.sidebar[r].locked&&(fr.sidebar[r].type=fr.sidebar[r].type==="public"?"private":"public",fp(),Gd(),By())}async function mce(r,e){fr.dashboardSections.hasOwnProperty(r)&&(fr.dashboardSections[r]=e,await fp(),Gd())}async function bce(r){fr.theme=r;const e=document.getElementById("globalThemeToggle"),t=e&&e.checked;await fp(t),Gd(),By()}function yce(r){return fr.sidebar[r]?fr.sidebar[r].type==="public":!1}async function wce(){const r=localStorage.getItem(UN);if(r)try{const e=JSON.parse(r);fr.sidebar={...fr.sidebar,...e.sidebar},e.theme&&(fr.theme=e.theme,console.log(" Local theme loaded:",e.theme))}catch(e){console.error("Failed to parse local settings",e)}try{const e=await YU();e&&(e.dashboardSections&&(fr.dashboardSections={...fr.dashboardSections,...e.dashboardSections}),e.theme&&!JSON.parse(r||"{}").theme&&(fr.theme=e.theme,console.log(" Global theme loaded:",e.theme))),Gd(),document.getElementById("settingsContent")&&By()}catch(e){console.error("Failed to load global settings:",e)}}async function fp(r=!1){var t,n;const e={sidebar:fr.sidebar,theme:fr.theme};if(localStorage.setItem(UN,JSON.stringify(e)),((t=ir.get("currentUserData"))==null?void 0:t.type)==="super-admin"||((n=ir.get("currentUserData"))==null?void 0:n.type)==="admin")try{const s={dashboardSections:fr.dashboardSections};r&&(s.theme=fr.theme),await XU(s),r&&Gt.showToast("    ","success")}catch(s){console.error("Failed to save global settings:",s),Gt.showToast("    ","error")}}function Gd(){Object.entries(fr.sidebar).forEach(([e,t])=>{const n=document.querySelector(`button[data-page="${e}"]`);n&&(t.visible?n.removeAttribute("data-settings-hidden"):(n.classList.add("hidden"),n.setAttribute("data-settings-hidden","true")),t.type==="private"?n.classList.add("private-tab"):n.classList.remove("private-tab"))});const r={hero:"dashboard-hero",stats:"dashboard-stats",topGroups:"dashboard-top-groups",academicStats:"dashboard-academic-stats",ranking:"dashboard-ranking",eliteGroups:"elite-groups"};Object.entries(fr.dashboardSections).forEach(([e,t])=>{const n=r[e];if(n){const s=document.getElementById(n);s&&(t?s.classList.remove("hidden"):s.classList.add("hidden"))}}),vce(),fr.theme&&q2.applyTheme(fr.theme)}function vce(){const r=ir.get("currentUserData"),e=r&&(r.type==="admin"||r.type==="super-admin");console.log(" _refreshSidebarAuth called"),console.log(" Current User Data:",r),console.log(" Is Admin:",e),document.querySelectorAll(".nav-btn").forEach(s=>{if(s.hasAttribute("data-settings-hidden")){s.classList.add("hidden");return}if(s.classList.contains("private-tab")){const i=s.dataset.page,a=r&&r.type==="teacher";e||a&&(i==="tasks"||i==="evaluation")?s.classList.remove("hidden"):s.classList.add("hidden")}else s.classList.remove("hidden")});const t=document.querySelector(".private-tab-divider");t&&(Array.from(document.querySelectorAll(".private-tab")).some(i=>!i.classList.contains("hidden"))?t.classList.remove("hidden"):t.classList.add("hidden"));const n=document.querySelector('button[data-page="public-settings"]');n&&(r?n.classList.remove("hidden"):n.classList.add("hidden"))}class xce{constructor(){this.container=null,this.initialized=!1,this.editingId=null,this.editingType=null}init(){if(!this.initialized){if(this.container=document.getElementById("page-class-management"),!this.container){console.warn("page-class-management container not found");return}console.log("ClassManagement initialized."),this.initialized=!0}}async render(){if(!this.container)return;const e=ir.get("currentUserData");if(!e||e.type!=="super-admin"){this.container.innerHTML='<div class="text-center text-red-500 mt-10 p-6">       </div>';return}this.container.innerHTML=this._getHTML(),this._attachListeners(),this._renderList()}_getHTML(){return`
      <div class="max-w-7xl mx-auto">
        <div class="mb-6 flex items-center justify-between">
          <div>
            <h2 class="text-2xl font-bold text-gray-900 dark:text-white"> </h2>
            <p class="text-sm text-gray-600 dark:text-gray-400 mt-1">, , ,   </p>
          </div>
          <button id="btnAddClass" class="px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-medium transition-colors flex items-center gap-2">
            <i class="fas fa-plus"></i> 
          </button>
        </div>
        <div id="classList" class="space-y-4"></div>
      </div>

      <!-- Modal -->
      <div id="classModal" class="fixed inset-0 z-[9999] hidden bg-black/50 flex items-center justify-center p-4">
        <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-lg w-full">
          <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between">
            <h3 id="modalTitle" class="text-xl font-bold text-gray-900 dark:text-white"> </h3>
            <button id="btnCloseModal" type="button" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300">
              <i class="fas fa-times text-xl"></i>
            </button>
          </div>
          <form id="classForm" class="p-6 space-y-4">
            <!-- Name Field -->
            <div>
              <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"> *</label>
              <input id="inputName" name="name" type="text" required class="form-input w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-indigo-500" placeholder=" ">
            </div>

            <!-- Code Field (for classes only) -->
            <div id="codeField">
              <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"></label>
              <input id="inputCode" name="code" type="text" class="form-input w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-indigo-500" placeholder=": IX, X, XI">
            </div>

            <!-- Academic Session Field (for classes only) -->
            <div id="sessionField">
              <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"></label>
              <input id="inputSession" name="session" type="text" class="form-input w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-indigo-500" placeholder=": -">
            </div>

            <!-- Section Field (for subjects only) -->
            <div id="sectionField" class="hidden">
              <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"> ()</label>
              <select id="inputSection" name="sectionId" class="form-select w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-indigo-500">
                <option value="">  </option>
              </select>
              <p class="text-xs text-gray-500 mt-1">     ,    (  )</p>
            </div>

            <div class="flex gap-3 pt-4 border-t border-gray-200 dark:border-gray-700">
              <button type="button" id="btnCancelForm" class="flex-1 px-4 py-2.5 border-2 border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 font-medium transition-colors">
                
              </button>
              <button type="submit" id="btnSubmitForm" class="flex-1 px-4 py-2.5 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-medium transition-colors shadow-sm">
                
              </button>
            </div>
          </form>
        </div>
      </div>
    `}_attachListeners(){var n,s,i,a;const e=document.getElementById("btnAddClass");e&&e.addEventListener("click",()=>this._openModal("class")),(n=document.getElementById("classForm"))==null||n.addEventListener("submit",o=>this._handleSubmit(o)),(s=document.getElementById("btnCloseModal"))==null||s.addEventListener("click",()=>this._closeModal()),(i=document.getElementById("btnCancelForm"))==null||i.addEventListener("click",()=>this._closeModal()),(a=document.getElementById("classModal"))==null||a.addEventListener("click",o=>{o.target.id==="classModal"&&this._closeModal()});const t=document.getElementById("classList");t&&t.addEventListener("click",async o=>{const l=o.target.closest("button");if(!l)return;const c=l.dataset.action,A=l.dataset.id,d=l.dataset.classid;console.log(" Button clicked:",{action:c,id:A,classId:d}),c==="editClass"?this._openModal("class",A):c==="deleteClass"?this._deleteClass(A):c==="addSection"?(console.log(" Add section for classId:",d),this._openModal("section",null,d)):c==="deleteSection"?this._deleteSection(A):c==="addSubject"?(console.log(" Add subject for classId:",d),this._openModal("subject",null,d)):c==="deleteSubject"&&this._deleteSubject(A)})}_renderList(){const e=ir.get("classes")||[],t=ir.get("sections")||[],n=ir.get("subjects")||[],s=document.getElementById("classList");if(s){if(e.length===0){s.innerHTML='<div class="text-center py-16 text-gray-500 dark:text-gray-400 bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700"><i class="fas fa-school text-5xl mb-4 opacity-30"></i><p class="text-lg">   </p></div>';return}s.innerHTML=e.map(i=>{const a=t.filter(l=>l.classId===i.id),o=n.filter(l=>l.classId===i.id);return`
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden">
          <div class="p-4 flex items-center justify-between bg-gray-50 dark:bg-gray-900/50 border-b border-gray-200 dark:border-gray-700">
            <h3 class="text-lg font-bold text-gray-800 dark:text-gray-200">${this._escape(i.name)}</h3>
            <div class="flex gap-2">
              <button data-action="editClass" data-id="${i.id}" class="px-3 py-1.5 rounded text-sm font-medium bg-blue-100 text-blue-700 hover:bg-blue-200 dark:bg-blue-900/30 dark:text-blue-400"><i class="fas fa-edit mr-1"></i></button>
              <button data-action="deleteClass" data-id="${i.id}" class="px-3 py-1.5 rounded text-sm font-medium bg-red-100 text-red-700 hover:bg-red-200 dark:bg-red-900/30 dark:text-red-400"><i class="fas fa-trash mr-1"></i></button>
            </div>
          </div>
          <div class="p-4 grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <div class="flex items-center justify-between mb-3">
                <h4 class="text-sm font-semibold text-gray-600 dark:text-gray-300 uppercase"> (${a.length})</h4>
                <button data-action="addSection" data-classid="${i.id}" class="text-xs px-3 py-1 bg-indigo-50 text-indigo-600 hover:bg-indigo-100 dark:bg-indigo-900/30 dark:text-indigo-400 rounded"><i class="fas fa-plus mr-1"></i> </button>
              </div>
              <div class="space-y-2">
                ${a.length?a.map(l=>`
                  <div class="flex items-center justify-between p-2 bg-gray-50 dark:bg-gray-700/30 rounded border border-gray-100 dark:border-gray-700">
                    <span class="text-sm font-medium dark:text-gray-200">${this._escape(l.name)}</span>
                    <button data-action="deleteSection" data-id="${l.id}" class="text-red-500 hover:text-red-700 text-xs"><i class="fas fa-times"></i></button>
                  </div>
                `).join(""):'<p class="text-xs text-gray-400 italic">  </p>'}
              </div>
            </div>
            <div>
              <div class="flex items-center justify-between mb-3">
                <h4 class="text-sm font-semibold text-gray-600 dark:text-gray-300 uppercase"> (${o.length})</h4>
                <button data-action="addSubject" data-classid="${i.id}" class="text-xs px-3 py-1 bg-indigo-50 text-indigo-600 hover:bg-indigo-100 dark:bg-indigo-900/30 dark:text-indigo-400 rounded"><i class="fas fa-plus mr-1"></i> </button>
              </div>
              <div class="space-y-2">
                ${o.length?o.map(l=>{var A;const c=l.sectionId&&((A=t.find(d=>d.id===l.sectionId))==null?void 0:A.name)||"";return`
                  <div class="flex items-center justify-between p-2 bg-gray-50 dark:bg-gray-700/30 rounded border border-gray-100 dark:border-gray-700">
                    <div class="flex flex-col">
                        <span class="text-sm font-medium dark:text-gray-200">${this._escape(l.name)}</span>
                        ${c?`<span class="text-[10px] text-indigo-600 dark:text-indigo-400 bg-indigo-50 dark:bg-indigo-900/20 px-1.5 py-0.5 rounded w-fit mt-0.5">${this._escape(c)}</span>`:""}
                    </div>
                    <button data-action="deleteSubject" data-id="${l.id}" class="text-red-500 hover:text-red-700 text-xs"><i class="fas fa-times"></i></button>
                  </div>
                `}).join(""):'<p class="text-xs text-gray-400 italic">  </p>'}
              </div>
            </div>
          </div>
        </div>
      `}).join("")}}_openModal(e,t=null,n=null){console.log(" Opening modal:",{type:e,id:t,classId:n}),this.editingType=e,this.editingId=t,this.editingClassId=n;const s={class:"",section:"",subject:""},i={class:" ",section:" ",subject:" "};document.getElementById("modalTitle").textContent=t?`${s[e]}  `:` ${s[e]}`,document.getElementById("inputName").placeholder=i[e];const a=document.getElementById("codeField"),o=document.getElementById("sessionField"),l=document.getElementById("sectionField"),c=document.getElementById("inputSection");if(e==="class")a.classList.remove("hidden"),o.classList.remove("hidden"),l.classList.add("hidden");else if(e==="subject"){a.classList.add("hidden"),o.classList.add("hidden"),l.classList.remove("hidden");const d=(ir.get("sections")||[]).filter(h=>h.classId===n);c.innerHTML='<option value="">   ()</option>'+d.map(h=>`<option value="${h.id}">${h.name}</option>`).join("")}else a.classList.add("hidden"),o.classList.add("hidden"),l.classList.add("hidden");if(t){let A;e==="class"?A=ir.get("classes").find(d=>d.id===t):e==="section"?A=ir.get("sections").find(d=>d.id===t):e==="subject"&&(A=ir.get("subjects").find(d=>d.id===t)),document.getElementById("inputName").value=(A==null?void 0:A.name)||"",document.getElementById("inputCode").value=(A==null?void 0:A.code)||"",document.getElementById("inputSession").value=(A==null?void 0:A.session)||"",e==="subject"&&c&&(c.value=(A==null?void 0:A.sectionId)||"")}else document.getElementById("inputName").value="",document.getElementById("inputCode").value="",document.getElementById("inputSession").value="",c&&(c.value="");document.getElementById("classModal").classList.remove("hidden"),setTimeout(()=>document.getElementById("inputName").focus(),100)}_closeModal(){document.getElementById("classModal").classList.add("hidden"),this.editingType=null,this.editingId=null,this.editingClassId=null}async _handleSubmit(e){e.preventDefault(),e.stopPropagation(),console.log(" Form submit triggered");const t=new FormData(e.target),n=(t.get("name")||"").trim(),s=(t.get("code")||"").trim(),i=(t.get("session")||"").trim(),a=(t.get("sectionId")||"").trim();if(console.log(" Form values (FormData):",{name:n,code:s,session:i,sectionId:a}),!n){console.log(" Name validation failed - name is empty!"),Gt.showToast(" ","warning");return}const o=this.editingType,l=this.editingId,c=this.editingClassId,A=o==="class"?"classes":o==="section"?"sections":"subjects";if((ir.get(A)||[]).some(u=>{if(l&&u.id===l)return!1;if(u.name.trim().toLowerCase()===n.toLowerCase()){if(o!=="class"&&u.classId===c)return o==="subject"?(u.sectionId||"")===(a||""):!0;if(o==="class")return!0}return!1})){Gt.showToast("  "+(o==="class"?"":o==="section"?"":"")+"  !","warning");return}Gt.showLoading(" ...");try{const u=this.editingType,p=this.editingId,f=this.editingClassId;if(p){const S=u==="class"?"classes":u==="section"?"sections":"subjects",B={name:n};s&&(B.code=s),i&&(B.session=i),u==="subject"&&(B.sectionId=a||null),await So(S,p,B),Gt.showToast(" ","success")}else{const S={name:n,createdAt:new Date().toISOString()};s&&(S.code=s),i&&(S.session=i),u!=="class"&&(S.classId=f),u==="subject"&&a&&(S.sectionId=a),await ru(u==="class"?"classes":u==="section"?"sections":"subjects",S),Gt.showToast(" ","success")}const[g,m,x]=await Promise.all([ix(),xm(),_m()]);ir.update({classes:g,sections:m,subjects:x}),this._closeModal(),this._renderList()}catch(u){console.error(" Error saving:",u),Gt.showToast(" : "+u.message,"error")}finally{Gt.hideLoading()}}async _deleteClass(e){console.log(" _deleteClass called with ID:",e);const n=ir.get("classes").find(a=>a.id===e),s=(n==null?void 0:n.name)||" ",i=await this._showConfirmDialog(s+"  ","    /     ?");if(console.log(" User confirmed:",i),!i){console.log(" User cancelled delete");return}console.log(" Starting delete process..."),Gt.showLoading(" ...");try{const a=ir.get("sections").filter(d=>d.classId===e),o=ir.get("subjects").filter(d=>d.classId===e);console.log(" Deleting:",{class:e,sections:a.length,subjects:o.length}),await Ya("classes",e),await Promise.all([...a.map(d=>Ya("sections",d.id)),...o.map(d=>Ya("subjects",d.id))]);const[l,c,A]=await Promise.all([ix(),xm(),_m()]);ir.update({classes:l,sections:c,subjects:A}),Gt.showToast(" ","success"),this._renderList(),console.log(" Delete successful")}catch(a){console.error(" Error deleting:",a),Gt.showToast(" ","error")}finally{Gt.hideLoading()}}async _deleteSection(e){const n=ir.get("sections").find(a=>a.id===e),s=(n==null?void 0:n.name)||" ";if(await this._showConfirmDialog(s+"  ","  ?")){Gt.showLoading(" ...");try{await Ya("sections",e);const a=await xm();ir.set("sections",a),Gt.showToast("  ","success"),this._renderList()}catch(a){console.error("Error deleting section:",a),Gt.showToast(" ","error")}finally{Gt.hideLoading()}}}async _deleteSubject(e){const n=ir.get("subjects").find(a=>a.id===e),s=(n==null?void 0:n.name)||" ";if(await this._showConfirmDialog(s+"  ","  ?")){Gt.showLoading(" ...");try{await Ya("subjects",e);const a=await _m();ir.set("subjects",a),Gt.showToast("  ","success"),this._renderList()}catch(a){console.error("Error deleting subject:",a),Gt.showToast(" ","error")}finally{Gt.hideLoading()}}}_showConfirmDialog(e,t){return new Promise(n=>{const s=Date.now(),i=`
        <div id="confirmModal-${s}" class="fixed inset-0 z-[10000] bg-black/50 flex items-center justify-center p-4">
          <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-md w-full">
            <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
              <h3 class="text-xl font-bold text-gray-900 dark:text-white">${e}</h3>
            </div>
            <div class="p-6">
              <p class="text-gray-700 dark:text-gray-300">${t}</p>
            </div>
            <div class="px-6 py-4 border-t border-gray-200 dark:border-gray-700 flex gap-3">
              <button id="btnCancel-${s}" class="flex-1 px-4 py-2.5 border-2 border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 font-medium transition-colors">
                
              </button>
              <button id="btnOK-${s}" class="flex-1 px-4 py-2.5 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium transition-colors shadow-sm">
                 
              </button>
            </div>
          </div>
        </div>
      `,a=document.createElement("div");a.innerHTML=i,document.body.appendChild(a.firstElementChild),setTimeout(()=>{const o=document.getElementById(`confirmModal-${s}`),l=document.getElementById(`btnOK-${s}`),c=document.getElementById(`btnCancel-${s}`);if(!o||!l||!c){console.error("Modal elements not found!"),n(!1);return}const A=()=>{o&&o.parentNode&&o.remove()};l.addEventListener("click",d=>{d.preventDefault(),d.stopPropagation(),console.log(" Delete confirmed"),A(),n(!0)}),c.addEventListener("click",d=>{d.preventDefault(),d.stopPropagation(),console.log(" Delete cancelled"),A(),n(!1)}),o.addEventListener("click",d=>{d.target===o&&(console.log(" Delete cancelled (background click)"),A(),n(!1))}),l.focus()},50)})}_escape(e){if(!e)return"";const t=document.createElement("div");return t.textContent=e,t.innerHTML}}const AI=new xce;function _ce(){return AI.init(),{render:()=>AI.render()}}let $r,gA,yd=null,eh="active";function Bce(r){return $r=r.managers,gA=r.services,r.utils,console.log("Teacher Management component initialized."),{render:Cce}}function Cce(){console.log("Rendering Teacher Management page...");const r=document.getElementById("page-teacher-management");if(!r){console.error("Teacher Management container not found.");return}const e=$r.stateManager.get("currentUserData");if(!e||e.type!=="super-admin"){r.innerHTML='<div class="text-center text-red-500 mt-10 p-6">       </div>';return}r.innerHTML=Sce(),kce(),mh()}function Sce(){return`
    <div class="max-w-7xl mx-auto">
      <div class="mb-6 flex items-center justify-between">
        <div>
          <h2 class="text-2xl font-bold text-gray-900 dark:text-white"> </h2>
          <p class="text-sm text-gray-600 dark:text-gray-400 mt-1">   //  </p>
        </div>
        <button id="btnAddTeacher" class="px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-medium transition-colors flex items-center gap-2">
          <i class="fas fa-plus"></i> 
        </button>
      </div>

      <!-- View Toggle -->
      <div class="mb-4 flex gap-2 bg-white dark:bg-gray-800 rounded-lg p-1 border border-gray-200 dark:border-gray-700 inline-flex">
        <button id="btnShowActive" class="px-4 py-2 rounded-md text-sm font-medium transition-colors bg-indigo-600 text-white">
           
        </button>
        <button id="btnShowDeleted" class="px-4 py-2 rounded-md text-sm font-medium transition-colors text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700">
           
        </button>
      </div>

      <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden">
        <div class="overflow-x-auto">
          <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
            <thead class="bg-gray-50 dark:bg-gray-700/50">
              <tr>
                <th class="px-4 py-3 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase"></th>
                <th class="px-4 py-3 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase"></th>
                <th class="px-4 py-3 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase"></th>
                <th class="px-4 py-3 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase"></th>
                <th class="px-4 py-3 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase"></th>
                <th class="px-4 py-3 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase"></th>
              </tr>
            </thead>
            <tbody id="teachersTableBody" class="divide-y divide-y-gray-200 dark:divide-gray-700 bg-white dark:bg-gray-800"></tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Teacher Modal -->
    <div id="teacherModal" class="fixed inset-0 z-[9999] hidden bg-black/50 flex items-center justify-center p-4">
      <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
        <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between sticky top-0 bg-white dark:bg-gray-800 z-10">
          <h3 id="modalTitle" class="text-xl font-bold text-gray-900 dark:text-white"> </h3>
          <button id="btnCloseModal" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300">
            <i class="fas fa-times text-xl"></i>
          </button>
        </div>
        <form id="teacherForm" class="p-6 space-y-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"> *</label>
            <input id="inputName" type="text" required class="form-input w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white" placeholder=" ">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"> *</label>
            <input id="inputEmail" type="email" required class="form-input w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white" placeholder="teacher@example.com">
          </div>
          <div id="passwordField">
            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"> *</label>
            <input id="inputPassword" type="password" minlength="6" class="form-input w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white" placeholder="  ">
            <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">*    </p>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"></label>
            <select id="selectClasses" multiple class="form-select w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white h-32"></select>
            <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">Ctrl/Cmd +     </p>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"></label>
            <select id="selectSections" multiple class="form-select w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white h-32"></select>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"></label>
            <select id="selectSubjects" multiple class="form-select w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white h-32"></select>
          </div>
          <div class="flex gap-3 pt-4 border-t border-gray-200 dark:border-gray-700">
            <button type="button" id="btnCancelForm" class="flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 font-medium transition-colors"></button>
            <button type="submit" class="flex-1 px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-medium transition-colors"></button>
          </div>
        </form>
      </div>
    </div>
  `}function kce(){var r,e,t,n,s,i,a,o;(r=document.getElementById("btnAddTeacher"))==null||r.addEventListener("click",Ece),(e=document.getElementById("teacherForm"))==null||e.addEventListener("submit",Tce),(t=document.getElementById("btnCloseModal"))==null||t.addEventListener("click",Tm),(n=document.getElementById("btnCancelForm"))==null||n.addEventListener("click",Tm),(s=document.getElementById("teacherModal"))==null||s.addEventListener("click",l=>{l.target.id==="teacherModal"&&Tm()}),(i=document.getElementById("btnShowActive"))==null||i.addEventListener("click",()=>{eh="active",dI(),mh()}),(a=document.getElementById("btnShowDeleted"))==null||a.addEventListener("click",()=>{eh="deleted",dI(),mh()}),(o=document.getElementById("teachersTableBody"))==null||o.addEventListener("click",async l=>{const c=l.target.closest("button");if(!c)return;const{action:A,id:d}=c.dataset;A==="edit"?Ice(d):A==="delete"?Fce(d):A==="restore"&&Lce(d)})}function mh(){const r=$r.stateManager.get("teachers")||[],e=eh==="active"?r.filter(a=>!a.deleted):r.filter(a=>a.deleted===!0),t=$r.stateManager.get("classes")||[],n=$r.stateManager.get("sections")||[],s=$r.stateManager.get("subjects")||[],i=document.getElementById("teachersTableBody");if(i){if(e.length===0){const a=eh==="active"?"    ":"    ";i.innerHTML=`<tr><td colspan="6" class="px-4 py-8 text-center text-gray-500 dark:text-gray-400">${a}</td></tr>`;return}i.innerHTML=e.map(a=>{const o=(a.assignedClasses||[]).map(d=>{var h;return((h=t.find(u=>u.id===d))==null?void 0:h.name)||"?"}).join(", ")||"-",l=(a.assignedSections||[]).map(d=>{var h;return((h=n.find(u=>u.id===d))==null?void 0:h.name)||"?"}).join(", ")||"-",c=(a.assignedSubjects||[]).map(d=>{var h;return((h=s.find(u=>u.id===d))==null?void 0:h.name)||"?"}).join(", ")||"-",A=eh==="active"?`
        <button data-action="edit" data-id="${a.id}" class="px-3 py-1 rounded text-xs font-medium bg-blue-100 text-blue-700 hover:bg-blue-200 dark:bg-blue-900/30 dark:text-blue-400"><i class="fas fa-pencil-alt mr-1"></i></button>
        <button data-action="delete" data-id="${a.id}" class="px-3 py-1 rounded text-xs font-medium bg-red-100 text-red-700 hover:bg-red-200 dark:bg-red-900/30 dark:text-red-400"><i class="fas fa-trash-alt mr-1"></i></button>
      `:`
        <button data-action="restore" data-id="${a.id}" class="px-3 py-1 rounded text-xs font-medium bg-green-100 text-green-700 hover:bg-green-200 dark:bg-green-900/30 dark:text-green-400"><i class="fas fa-undo mr-1"></i> </button>
      `;return`
      <tr class="hover:bg-gray-50 dark:hover:bg-gray-700/50">
        <td class="px-4 py-3 text-sm">${Mg(a.name||a.email)}</td>
        <td class="px-4 py-3 text-sm">${Mg(a.email)}</td>
        <td class="px-4 py-3 text-sm">${o}</td>
        <td class="px-4 py-3 text-sm">${l}</td>
        <td class="px-4 py-3 text-sm">${c}</td>
        <td class="px-4 py-3 text-sm">
          <div class="flex gap-2">
            ${A}
          </div>
        </td>
      </tr>
    `}).join("")}}function dI(){const r=document.getElementById("btnShowActive"),e=document.getElementById("btnShowDeleted");eh==="active"?(r==null||r.classList.add("bg-indigo-600","text-white"),r==null||r.classList.remove("text-gray-600","dark:text-gray-400","hover:bg-gray-100","dark:hover:bg-gray-700"),e==null||e.classList.remove("bg-indigo-600","text-white"),e==null||e.classList.add("text-gray-600","dark:text-gray-400","hover:bg-gray-100","dark:hover:bg-gray-700")):(e==null||e.classList.add("bg-indigo-600","text-white"),e==null||e.classList.remove("text-gray-600","dark:text-gray-400","hover:bg-gray-100","dark:hover:bg-gray-700"),r==null||r.classList.remove("bg-indigo-600","text-white"),r==null||r.classList.add("text-gray-600","dark:text-gray-400","hover:bg-gray-100","dark:hover:bg-gray-700"))}function Ece(){yd=null,document.getElementById("modalTitle").textContent=" ",document.getElementById("teacherForm").reset(),document.getElementById("passwordField").classList.remove("hidden"),document.getElementById("inputPassword").required=!0,MN(),document.getElementById("teacherModal").classList.remove("hidden")}function Ice(r){const t=$r.stateManager.get("teachers").find(n=>n.id===r);t&&(yd=r,document.getElementById("modalTitle").textContent=" ",document.getElementById("inputName").value=t.name||"",document.getElementById("inputEmail").value=t.email||"",document.getElementById("passwordField").classList.add("hidden"),document.getElementById("inputPassword").required=!1,MN(),wv("selectClasses",t.assignedClasses||[]),wv("selectSections",t.assignedSections||[]),wv("selectSubjects",t.assignedSubjects||[]),document.getElementById("teacherModal").classList.remove("hidden"))}function Tm(){document.getElementById("teacherModal").classList.add("hidden"),yd=null}function MN(){const r=$r.stateManager.get("classes")||[];$r.stateManager.get("sections"),$r.stateManager.get("subjects"),document.getElementById("selectClasses").innerHTML=r.map(t=>`<option value="${t.id}">${Mg(t.name)}</option>`).join(""),bx();const e=document.getElementById("selectClasses");if(e){const t=e.cloneNode(!0);e.parentNode.replaceChild(t,e),t.addEventListener("change",bx)}}function bx(){const r=document.getElementById("selectClasses"),e=document.getElementById("selectSections"),t=document.getElementById("selectSubjects");if(!r||!e||!t)return;const n=Array.from(r.selectedOptions).map(l=>l.value),s=$r.stateManager.get("sections")||[],i=$r.stateManager.get("subjects")||[];let a=s,o=i;n.length>0&&(a=s.filter(l=>n.includes(l.classId)),o=i.filter(l=>n.includes(l.classId)),console.log(" Filtered by classes:",n),console.log(" Sections:",a.length,"/",s.length),console.log(" Subjects:",o.length,"/",i.length)),e.innerHTML=a.map(l=>`<option value="${l.id}">${Mg(l.name)}</option>`).join(""),t.innerHTML=o.map(l=>`<option value="${l.id}">${Mg(l.name)}</option>`).join("")}function wv(r,e){const t=document.getElementById(r);Array.from(t.options).forEach(n=>{n.selected=e.includes(n.value)}),r==="selectClasses"&&bx()}function vv(r){return Array.from(document.getElementById(r).selectedOptions).map(e=>e.value)}async function Tce(r){r.preventDefault();const e=document.getElementById("inputName").value.trim(),t=document.getElementById("inputEmail").value.trim(),n=document.getElementById("inputPassword").value,s=vv("selectClasses"),i=vv("selectSections"),a=vv("selectSubjects");if(!e||!t){$r.uiManager.showToast("   ","warning");return}if(!yd&&(!n||n.length<6)){$r.uiManager.showToast("     ","warning");return}$r.uiManager.showLoading(yd?" ...":"  ...");try{yd?(await gA.dataService.updateTeacher(yd,{name:e,assignedClasses:s,assignedSections:i,assignedSubjects:a}),$r.uiManager.showToast("  ","success")):(await gA.authService.registerTeacher(t,n,{name:e,assignedClasses:s,assignedSections:i,assignedSubjects:a}),$r.uiManager.showToast("  ","success"));const o=await gA.dataService.loadTeachers("all");$r.stateManager.set("teachers",o),Tm(),mh()}catch(o){console.error("Error saving teacher:",o),$r.uiManager.showToast(`: ${o.message}`,"error")}finally{$r.uiManager.hideLoading()}}async function Fce(r){console.log(" Delete teacher called, ID:",r);const t=$r.stateManager.get("teachers").find(i=>i.id===r);if(console.log(" Teacher found:",t),!t){console.warn(" Teacher not found");return}const n=t.name||t.email,s=await NN(n+"  ","<p>  ?      login   </p>");if(console.log(" User confirmed:",s),!!s){console.log(" Starting delete..."),$r.uiManager.showLoading(" ...");try{console.log(" Calling deleteTeacher service..."),await gA.dataService.deleteTeacher(r),console.log(" Teacher deleted from Firestore");const i=await gA.dataService.loadTeachers("all");console.log(" Reloaded teachers:",i.length),$r.stateManager.set("teachers",i),$r.uiManager.showToast("  ","success"),mh(),console.log(" UI updated")}catch(i){console.error(" Error deleting teacher:",i),$r.uiManager.showToast(`  : ${i.message}`,"error")}finally{$r.uiManager.hideLoading()}}}async function Lce(r){console.log(" Restore teacher called, ID:",r);const t=$r.stateManager.get("teachers").find(i=>i.id===r);if(!t){console.warn(" Teacher not found");return}const n=t.name||t.email;if(await NN(n+"  ","<p>    ?     login  </p>")){$r.uiManager.showLoading(" ...");try{await gA.dataService.restoreTeacher(r),console.log(" Teacher restored");const i=await gA.dataService.loadTeachers("all");$r.stateManager.set("teachers",i),$r.uiManager.showToast("  ","success"),mh()}catch(i){console.error(" Error restoring teacher:",i),$r.uiManager.showToast(`  : ${i.message}`,"error")}finally{$r.uiManager.hideLoading()}}}function NN(r,e){return new Promise(t=>{const n=Date.now(),s=`
      <div id="confirmModal-${n}" class="fixed inset-0 z-[10000] bg-black/50 flex items-center justify-center p-4">
        <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-md w-full">
          <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
            <h3 class="text-xl font-bold text-gray-900 dark:text-white">${r}</h3>
          </div>
          <div class="p-6">
            <p class="text-gray-700 dark:text-gray-300">${e}</p>
          </div>
          <div class="px-6 py-4 border-t border-gray-200 dark:border-gray-700 flex gap-3">
            <button id="btnCancel-${n}" class="flex-1 px-4 py-2.5 border-2 border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 font-medium transition-colors">
              
            </button>
            <button id="btnOK-${n}" class="flex-1 px-4 py-2.5 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium transition-colors shadow-sm">
               
            </button>
          </div>
        </div>
      </div>
    `,i=document.createElement("div");i.innerHTML=s,document.body.appendChild(i.firstElementChild),setTimeout(()=>{const a=document.getElementById(`confirmModal-${n}`),o=document.getElementById(`btnOK-${n}`),l=document.getElementById(`btnCancel-${n}`);if(!a||!o||!l){console.error("Modal elements not found!"),t(!1);return}const c=()=>{a&&a.parentNode&&a.remove()};o.addEventListener("click",A=>{A.preventDefault(),A.stopPropagation(),console.log(" Delete confirmed"),c(),t(!0)}),l.addEventListener("click",A=>{A.preventDefault(),A.stopPropagation(),console.log(" Delete cancelled"),c(),t(!1)}),a.addEventListener("click",A=>{A.target===a&&(console.log(" Delete cancelled (background click)"),c(),t(!1))}),o.focus()},50)})}function Mg(r){if(!r)return"";const e=document.createElement("div");return e.textContent=r,e.innerHTML}let Li,dl,Uf;const Ct={},er={issues:[],approved:[],skipped:[],scanning:!1,migrating:!1,progress:0};function Uce(r){return Li=r.managers.stateManager,dl=r.managers.uiManager,Uf=r.services.dataService,console.log(" Data Migration component initialized."),{render:Mce}}function Mce(){console.log(" Data Migration render called");try{const r=document.getElementById("page-data-migration");if(!r){console.error(" Page element #page-data-migration not found!");return}console.log(" Found page element, setting innerHTML..."),r.innerHTML=Nce(),console.log(" Caching elements..."),Pce(),console.log(" Attaching listeners..."),Dce(),r.classList.remove("hidden"),console.log(" Data Migration Tool rendered successfully.")}catch(r){console.error(" Error rendering Data Migration Tool:",r);const e=document.getElementById("page-data-migration");e&&(e.innerHTML=`<div class="p-4 text-red-600">Error rendering tool: ${r.message}</div>`)}}function Nce(){return`
    <div class="max-w-7xl mx-auto p-6 space-y-6">
      <!-- Header -->
      <div class="bg-gradient-to-r from-indigo-500 to-purple-600 dark:from-indigo-600 dark:to-purple-700 rounded-2xl p-6 text-white shadow-lg">
        <div class="flex items-center gap-3 mb-2">
          <i class="fas fa-database text-3xl"></i>
          <h1 class="text-2xl font-bold">  </h1>
        </div>
        <p class="text-indigo-100 dark:text-indigo-200">    - ,     </p>
      </div>

      <!-- Status Overview -->
      <div id="statusOverview" class="grid grid-cols-1 md:grid-cols-3 gap-4">
        <!-- Will be populated dynamically -->
      </div>

      <!-- Action Buttons -->
      <div class="flex flex-wrap gap-3">
        <button id="btnScanDatabase" class="btn-primary flex items-center gap-2">
          <i class="fas fa-search"></i>
          <span>  </span>
        </button>
        <button id="btnStartMigration" class="btn-success flex items-center gap-2 hidden">
          <i class="fas fa-play"></i>
          <span>  </span>
        </button>
        <button id="btnRollback" class="btn-danger flex items-center gap-2 hidden">
          <i class="fas fa-undo"></i>
          <span> </span>
        </button>
      </div>

      <!-- Progress Bar -->
      <div id="progressContainer" class="hidden">
        <div class="bg-white dark:bg-slate-800 rounded-lg p-4 shadow">
          <div class="flex items-center justify-between mb-2">
            <span class="text-sm font-medium text-slate-700 dark:text-slate-300"></span>
            <span id="progressText" class="text-sm font-medium text-indigo-600 dark:text-indigo-400">0%</span>
          </div>
          <div class="w-full bg-slate-200 dark:bg-slate-700 rounded-full h-2">
            <div id="progressBar" class="bg-indigo-600 dark:bg-indigo-500 h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
          </div>
        </div>
      </div>

      <!-- Issues List -->
      <div id="issuesContainer" class="hidden">
        <div class="bg-white dark:bg-slate-800 rounded-lg shadow-lg overflow-hidden">
          <!-- Header with action buttons -->
          <div class="p-4 bg-slate-50 dark:bg-slate-900 border-b border-slate-200 dark:border-slate-700">
            <div class="flex flex-wrap items-center justify-between gap-3">
              <h2 class="text-lg font-semibold text-slate-800 dark:text-slate-200"> </h2>
              <div class="flex flex-wrap gap-2">
                <button id="btnApproveAll" class="text-xs px-3 py-1.5 bg-green-500 text-white rounded-lg hover:bg-green-600 font-medium">
                    
                </button>
                <button id="btnSkipAll" class="text-xs px-3 py-1.5 bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400 rounded-lg hover:bg-red-200">
                    
                </button>
                <button id="btnResetAll" class="text-xs px-3 py-1.5 bg-slate-200 text-slate-700 dark:bg-slate-700 dark:text-slate-300 rounded-lg hover:bg-slate-300 dark:hover:bg-slate-600">
                   
                </button>
              </div>
            </div>
          </div>
          
          <!-- Bulk Selection Toolbar -->
          <div class="p-4 bg-indigo-50 dark:bg-indigo-900/20 border-b border-indigo-200 dark:border-indigo-800">
            <p class="text-xs text-indigo-700 dark:text-indigo-300 mb-2 font-medium">
              <i class="fas fa-magic mr-1"></i>     :
            </p>
            <div class="flex flex-wrap items-center gap-3">
              <div class="flex items-center gap-2">
                <label class="text-xs text-slate-600 dark:text-slate-400">:</label>
                <select id="bulkClassSelect" class="text-sm px-3 py-1.5 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-800 dark:text-slate-200">
                  <option value=""> </option>
                </select>
              </div>
              <div class="flex items-center gap-2">
                <label class="text-xs text-slate-600 dark:text-slate-400">:</label>
                <select id="bulkSectionSelect" class="text-sm px-3 py-1.5 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-800 dark:text-slate-200">
                  <option value=""> </option>
                </select>
              </div>
              <div class="flex items-center gap-2">
                <label class="text-xs text-slate-600 dark:text-slate-400">:</label>
                <select id="bulkSubjectSelect" class="text-sm px-3 py-1.5 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-800 dark:text-slate-200">
                  <option value=""> </option>
                </select>
              </div>
              <button id="btnApplyBulk" class="text-sm px-4 py-1.5 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 font-medium">
                <i class="fas fa-check-double mr-1"></i>   
              </button>
            </div>
          </div>
          
          <div id="issuesList" class="divide-y divide-slate-200 dark:divide-slate-700 max-h-[500px] overflow-y-auto">
            <!-- Issues will be populated here -->
          </div>
        </div>
      </div>

      <!-- Empty State -->
      <div id="emptyState" class="text-center py-12">
        <i class="fas fa-info-circle text-6xl text-slate-300 dark:text-slate-600 mb-4"></i>
        <p class="text-slate-500 dark:text-slate-400">     </p>
      </div>
    </div>
  `}function Pce(){Ct.statusOverview=document.getElementById("statusOverview"),Ct.btnScanDatabase=document.getElementById("btnScanDatabase"),Ct.btnStartMigration=document.getElementById("btnStartMigration"),Ct.btnRollback=document.getElementById("btnRollback"),Ct.btnApproveAll=document.getElementById("btnApproveAll"),Ct.btnSkipAll=document.getElementById("btnSkipAll"),Ct.btnResetAll=document.getElementById("btnResetAll"),Ct.bulkClassSelect=document.getElementById("bulkClassSelect"),Ct.bulkSectionSelect=document.getElementById("bulkSectionSelect"),Ct.bulkSubjectSelect=document.getElementById("bulkSubjectSelect"),Ct.btnApplyBulk=document.getElementById("btnApplyBulk"),Ct.progressContainer=document.getElementById("progressContainer"),Ct.progressBar=document.getElementById("progressBar"),Ct.progressText=document.getElementById("progressText"),Ct.issuesContainer=document.getElementById("issuesContainer"),Ct.issuesList=document.getElementById("issuesList"),Ct.emptyState=document.getElementById("emptyState")}function Dce(){var r,e,t,n,s,i,a;(r=Ct.btnScanDatabase)==null||r.addEventListener("click",PN),(e=Ct.btnStartMigration)==null||e.addEventListener("click",Wce),(t=Ct.btnRollback)==null||t.addEventListener("click",Zce),(n=Ct.btnApproveAll)==null||n.addEventListener("click",Vce),(s=Ct.btnSkipAll)==null||s.addEventListener("click",$ce),(i=Ct.btnResetAll)==null||i.addEventListener("click",Gce),(a=Ct.btnApplyBulk)==null||a.addEventListener("click",zce)}async function PN(){if(!er.scanning){er.scanning=!0,Ct.btnScanDatabase.disabled=!0,Ct.btnScanDatabase.innerHTML='<i class="fas fa-spinner fa-spin"></i>   ...';try{await Rce(),Qce(),Lh(),er.issues.length>0?(Ct.emptyState.classList.add("hidden"),Ct.issuesContainer.classList.remove("hidden"),Ct.btnStartMigration.classList.remove("hidden"),Kce()):dl.showToast("   !     ","success")}catch(r){console.error("Scan error:",r),dl.showToast("   : "+r.message,"error")}finally{er.scanning=!1,Ct.btnScanDatabase.disabled=!1,Ct.btnScanDatabase.innerHTML='<i class="fas fa-search"></i>   '}}}async function Rce(){console.log(" Scanning database for migration issues...");const r=Li.get("evaluations")||[],e=Li.get("tasks")||[],t=Li.get("groups")||[],n=Li.get("subjects")||[];er.issues=[],console.log(" Scan data counts:",{evaluations:r.length,tasks:e.length,groups:t.length,subjects:n.length}),n.length>0&&(console.log(" Sample subject:",n[0]),console.log(" Subject classId check:",n.map(s=>({name:s.name,classId:s.classId,sectionId:s.sectionId})))),r.length>0&&(console.log(" Sample evaluation structure:",r[0]),console.log(" Evaluation keys:",Object.keys(r[0])));for(const s of r)if(!s.classId||!s.sectionId){const i=t.find(o=>o.id===s.groupId),a={id:`eval-${s.id}`,type:"evaluation",documentId:s.id,missing:[],current:s,suggested:{},source:"group-data",status:"pending",confidence:0};if(s.classId||a.missing.push("classId"),s.sectionId||a.missing.push("sectionId"),i){const o=i.classId||i.class_id||i.class,l=i.sectionId||i.section_id||i.section;o&&!s.classId&&(a.suggested.classId=o,a.confidence+=.5),l&&!s.sectionId&&(a.suggested.sectionId=l,a.confidence+=.5),a.groupName=i.name||s.groupName||"Unknown Group",!o&&!l&&console.log(" Group has no class/section:",{groupId:i.id,groupName:i.name,groupFields:Object.keys(i)})}else a.confidence=0,a.error="Group not found",a.groupName=s.groupName||"Unknown",console.log(" Group not found for evaluation:",s.groupId);er.issues.push(a)}for(const s of e)if(!s.subjectId){const i={id:`task-${s.id}`,type:"task",documentId:s.id,missing:["subjectId"],current:s,suggested:{},source:"name-analysis",status:"pending",confidence:0},a=Oce(s.name,n);a&&(i.suggested.subjectId=a.id,i.suggested.subjectName=a.name,i.confidence=.6),er.issues.push(i)}for(const s of t)if(!s.classId||!s.sectionId){const i={id:`group-${s.id}`,type:"group",documentId:s.id,missing:[],current:s,suggested:{},source:"manual-input",status:"pending",confidence:0,groupName:s.name||"Unknown Group"};s.classId||i.missing.push("classId"),s.sectionId||i.missing.push("sectionId"),er.issues.push(i)}for(const s of n){if(s.classId&&s.sectionId)continue;const i={id:`subject-${s.id}`,type:"subject",documentId:s.id,missing:[],current:s,suggested:{classId:s.classId||"",sectionId:s.sectionId||""},source:"manual-input",status:"pending",confidence:0,subjectName:s.name||"Unknown Subject"};s.classId||i.missing.push("classId"),s.sectionId||i.missing.push("sectionId"),er.issues.push(i)}console.log(` Scan complete. Found ${er.issues.length} issues.`)}function Oce(r,e){if(!r)return null;const t=r.toLowerCase();for(const n of e){const s=n.name.toLowerCase();if(t.includes(s)||s.includes(t))return n}return null}function DN(r){let e=0;return r.type==="evaluation"||r.type==="group"||r.type==="subject"?(r.suggested.classId&&(e+=.5),r.suggested.sectionId&&(e+=.5)):r.type==="task"?r.suggested.subjectId&&(e=1):r.type==="cross-class-mismatch"&&r.suggested.subjectId&&(e=1),e}function Qce(){const r=er.issues.length,e=er.issues.filter(i=>i.type==="evaluation").length,t=er.issues.filter(i=>i.type==="task").length,n=er.issues.filter(i=>i.type==="group").length,s=er.issues.filter(i=>i.type==="subject").length;Ct.statusOverview.innerHTML=`
    <div class="bg-white dark:bg-slate-800 rounded-lg p-4 shadow">
      <div class="flex items-center gap-3 mb-2">
        <div class="w-10 h-10 rounded-full bg-indigo-100 dark:bg-indigo-900/30 flex items-center justify-center">
          <i class="fas fa-clipboard-list text-indigo-600 dark:text-indigo-400"></i>
        </div>
        <div>
          <p class="text-2xl font-bold text-slate-800 dark:text-slate-200">${r}</p>
          <p class="text-xs text-slate-500 dark:text-slate-400"> </p>
        </div>
      </div>
    </div>
    
    <div class="bg-white dark:bg-slate-800 rounded-lg p-4 shadow">
      <div class="flex items-center gap-3 mb-2">
        <div class="w-10 h-10 rounded-full bg-amber-100 dark:bg-amber-900/30 flex items-center justify-center">
          <i class="fas fa-star text-amber-600 dark:text-amber-400"></i>
        </div>
        <div>
          <p class="text-2xl font-bold text-slate-800 dark:text-slate-200">${e}</p>
          <p class="text-xs text-slate-500 dark:text-slate-400"></p>
        </div>
      </div>
    </div>
    
    <div class="bg-white dark:bg-slate-800 rounded-lg p-4 shadow">
      <div class="flex items-center gap-3 mb-2">
        <div class="w-10 h-10 rounded-full bg-emerald-100 dark:bg-emerald-900/30 flex items-center justify-center">
          <i class="fas fa-tasks text-emerald-600 dark:text-emerald-400"></i>
        </div>
        <div>
          <p class="text-2xl font-bold text-slate-800 dark:text-slate-200">${t}</p>
          <p class="text-xs text-slate-500 dark:text-slate-400"></p>
        </div>
      </div>
    </div>
    
    <div class="bg-white dark:bg-slate-800 rounded-lg p-4 shadow">
      <div class="flex items-center gap-3 mb-2">
        <div class="w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center">
          <i class="fas fa-users text-blue-600 dark:text-blue-400"></i>
        </div>
        <div>
          <p class="text-2xl font-bold text-slate-800 dark:text-slate-200">${n}</p>
          <p class="text-xs text-slate-500 dark:text-slate-400"></p>
        </div>
      </div>
    </div>
    
    <div class="bg-white dark:bg-slate-800 rounded-lg p-4 shadow">
      <div class="flex items-center gap-3 mb-2">
        <div class="w-10 h-10 rounded-full bg-purple-100 dark:bg-purple-900/30 flex items-center justify-center">
          <i class="fas fa-book text-purple-600 dark:text-purple-400"></i>
        </div>
        <div>
          <p class="text-2xl font-bold text-slate-800 dark:text-slate-200">${s}</p>
          <p class="text-xs text-slate-500 dark:text-slate-400"></p>
        </div>
      </div>
    </div>
  `}function Lh(){if(er.issues.length===0){Ct.issuesList.innerHTML='<p class="p-4 text-center text-slate-500">  </p>';return}Ct.issuesList.innerHTML=er.issues.map(r=>Hce(r)).join(""),Ct.issuesList.querySelectorAll("[data-action]").forEach(r=>{r.addEventListener("click",e=>{const t=e.currentTarget.dataset.action,n=e.currentTarget.dataset.issueId;jce(t,n)})}),Ct.issuesList.querySelectorAll("select[data-issue-id]").forEach(r=>{r.addEventListener("change",e=>{const t=e.target.dataset.issueId,n=e.target.dataset.field,s=e.target.value,i=er.issues.find(a=>a.id===t);i&&(i.suggested[n]=s||null,i.confidence=DN(i),console.log(` Updated ${t}.suggested.${n} = ${s}`),n==="classId"&&qce(t,s))})})}function Hce(r){const e="".repeat(Math.ceil(r.confidence*3)),t=r.confidence>=.9?"text-green-600":r.confidence>=.7?"text-yellow-600":"text-red-600",n=er.approved.includes(r.id),s=er.skipped.includes(r.id);let i="";n?i='<span class="text-xs px-2 py-1 bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400 rounded"> </span>':s&&(i='<span class="text-xs px-2 py-1 bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400 rounded">  </span>');const a=Li.get("classes")||[],o=Li.get("sections")||[],l=Li.get("subjects")||[];let c="";if(r.type==="evaluation"||r.type==="group"||r.type==="subject"){const u=a.map(f=>`<option value="${f.id}" ${r.suggested.classId===f.id?"selected":""}>${f.name}</option>`).join(""),p=o.map(f=>`<option value="${f.id}" ${r.suggested.sectionId===f.id?"selected":""}>${f.name}</option>`).join("");c=`
      <div class="flex flex-wrap gap-2 mt-2">
        <div class="flex items-center gap-1">
          <label class="text-xs text-slate-500 dark:text-slate-400">:</label>
          <select data-issue-id="${r.id}" data-field="classId" 
            class="text-xs px-2 py-1 border border-slate-300 dark:border-slate-600 rounded bg-white dark:bg-slate-700 text-slate-800 dark:text-slate-200">
            <option value=""> </option>
            ${u}
          </select>
        </div>
        <div class="flex items-center gap-1">
          <label class="text-xs text-slate-500 dark:text-slate-400">:</label>
          <select data-issue-id="${r.id}" data-field="sectionId" 
            class="text-xs px-2 py-1 border border-slate-300 dark:border-slate-600 rounded bg-white dark:bg-slate-700 text-slate-800 dark:text-slate-200">
            <option value=""> </option>
            ${p}
          </select>
        </div>
      </div>
    `}else if(r.type==="task"){const u=l.map(p=>`<option value="${p.id}" ${r.suggested.subjectId===p.id?"selected":""}>${p.name}</option>`).join("");c=`
      <div class="flex items-center gap-2 mt-2">
        <label class="text-xs text-slate-500 dark:text-slate-400">:</label>
        <select data-issue-id="${r.id}" data-field="subjectId" 
          class="text-xs px-2 py-1 border border-slate-300 dark:border-slate-600 rounded bg-white dark:bg-slate-700 text-slate-800 dark:text-slate-200">
          <option value=""> </option>
          ${u}
        </select>
      </div>
    `}else if(r.type==="cross-class-mismatch"){const u=r.current.classId,f=l.filter(g=>g.classId===u).map(g=>`<option value="${g.id}" ${r.suggested.subjectId===g.id?"selected":""}>${g.name}</option>`).join("");c=`
        <div class="mt-2 p-2 bg-red-50 dark:bg-red-900/20 rounded border border-red-100 dark:border-red-800">
            <p class="text-xs text-red-600 dark:text-red-400 mb-1"><i class="fas fa-exclamation-triangle mr-1"></i>      !</p>
            <div class="flex items-center gap-2">
                <label class="text-xs text-slate-500 dark:text-slate-400"> :</label>
                <select data-issue-id="${r.id}" data-field="subjectId" 
                class="text-xs px-2 py-1 border border-slate-300 dark:border-slate-600 rounded bg-white dark:bg-slate-700 text-slate-800 dark:text-slate-200">
                <option value=""> </option>
                ${f}
                </select>
            </div>
        </div>
      `}const A={evaluation:{bg:"bg-amber-100 text-amber-700 dark:bg-amber-900/30 dark:text-amber-400",label:""},task:{bg:"bg-emerald-100 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-400",label:""},group:{bg:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400",label:""},subject:{bg:"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-400",label:""}},d=A[r.type]||A.evaluation;let h="";return r.type==="evaluation"?h=`: ${r.groupName||"Unknown"}`:r.type==="task"?h=`: ${r.current.name||"Unnamed"}`:r.type==="group"?h=`: ${r.groupName||r.current.name||"Unknown"}`:r.type==="subject"&&(h=`: ${r.subjectName||r.current.name||"Unknown"}`),`
    <div class="p-4 hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors border-b border-slate-200 dark:border-slate-700 ${n||s?"opacity-60":""}">
      <div class="flex items-start justify-between gap-4">
        <div class="flex-1">
          <div class="flex items-center gap-2 mb-2">
            <span class="text-xs px-2 py-1 rounded ${d.bg}">
              ${d.label}
            </span>
            <span class="text-xs ${t}">${e||""}</span>
            ${i}
          </div>
          
          <p class="text-sm font-medium text-slate-800 dark:text-slate-200 mb-1">
            ${h}
          </p>
          
          <p class="text-xs text-slate-500 dark:text-slate-400 mb-1">
            : <span class="text-red-500">${r.missing.join(", ")}</span>
          </p>
          
          ${c}
        </div>
        
        <div class="flex flex-col gap-2">
          ${!n&&!s?`
            <button data-action="approve" data-issue-id="${r.id}" class="px-3 py-1.5 text-xs bg-green-500 text-white rounded hover:bg-green-600 font-medium">
               
            </button>
            <button data-action="skip" data-issue-id="${r.id}" class="px-3 py-1.5 text-xs bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400 rounded hover:bg-red-200 dark:hover:bg-red-900/50">
               
            </button>
          `:""}
        </div>
      </div>
    </div>
  `}function jce(r,e){r==="approve"?er.approved.includes(e)||(er.approved.push(e),er.skipped=er.skipped.filter(t=>t!==e)):r==="skip"&&(er.skipped.includes(e)||(er.skipped.push(e),er.approved=er.approved.filter(t=>t!==e))),Lh()}function Vce(){er.approved=er.issues.map(r=>r.id),er.skipped=[],Lh()}function $ce(){er.skipped=er.issues.map(r=>r.id),er.approved=[],Lh()}function Gce(){er.approved=[],er.skipped=[],er.issues.forEach(r=>{r.suggested={},r.confidence=0}),Ct.bulkClassSelect&&(Ct.bulkClassSelect.value=""),Ct.bulkSectionSelect&&(Ct.bulkSectionSelect.value=""),Ct.bulkSubjectSelect&&(Ct.bulkSubjectSelect.value=""),Lh(),dl.showToast("    ","info")}function zce(){var s,i,a;const r=((s=Ct.bulkClassSelect)==null?void 0:s.value)||null,e=((i=Ct.bulkSectionSelect)==null?void 0:i.value)||null,t=((a=Ct.bulkSubjectSelect)==null?void 0:a.value)||null;if(!r&&!e&&!t){dl.showToast("      ","warning");return}let n=0;er.issues.forEach(o=>{o.type==="evaluation"?(r&&o.missing.includes("classId")&&(o.suggested.classId=r,n++),e&&o.missing.includes("sectionId")&&(o.suggested.sectionId=e,n++)):o.type==="task"&&t&&o.missing.includes("subjectId")&&(o.suggested.subjectId=t,n++),o.confidence=DN(o)}),Lh(),dl.showToast(`${n}    `,"success")}function Kce(){const r=Li.get("classes")||[];if(Li.get("sections"),Li.get("subjects"),Ct.bulkClassSelect){const e=r.map(t=>`<option value="${t.id}">${t.name}</option>`).join("");Ct.bulkClassSelect.innerHTML=`<option value=""> </option>${e}`,Ct.bulkClassSelect.removeEventListener("change",uI),Ct.bulkClassSelect.addEventListener("change",uI)}RN(),ON()}function uI(){RN(),ON()}function RN(){var a;const r=Li.get("sections")||[],e=((a=Ct.bulkClassSelect)==null?void 0:a.value)||"";if(!Ct.bulkSectionSelect)return;let t=r;e&&(t=r.filter(o=>o.classId===e||o.class_id===e||o.class===e));const n=[],s=new Set;t.forEach(o=>{s.has(o.name)||(s.add(o.name),n.push(o))});const i=n.map(o=>`<option value="${o.id}">${o.name}</option>`).join("");Ct.bulkSectionSelect.innerHTML=`<option value=""> </option>${i}`}function ON(){var a;const r=Li.get("subjects")||[],e=((a=Ct.bulkClassSelect)==null?void 0:a.value)||"";if(!Ct.bulkSubjectSelect)return;let t=r;e&&(t=r.filter(o=>o.classId===e||o.class_id===e||o.class===e||!o.classId));const n=[],s=new Set;t.forEach(o=>{s.has(o.name)||(s.add(o.name),n.push(o))});const i=n.map(o=>`<option value="${o.id}">${o.name}</option>`).join("");Ct.bulkSubjectSelect.innerHTML=`<option value=""> </option>${i}`}function qce(r,e){const t=Li.get("sections")||[],n=Ct.issuesList.querySelector(`select[data-issue-id="${r}"][data-field="sectionId"]`);if(!n)return;const s=n.value,i=er.issues.find(c=>c.id===r);let a=t;e&&(a=t.filter(c=>c.classId===e||c.class_id===e||c.class===e));const o=a.map(c=>`<option value="${c.id}" ${s===c.id?"selected":""}>${c.name}</option>`).join("");n.innerHTML=`<option value=""> </option>${o}`,!a.some(c=>c.id===s)&&i&&(i.suggested.sectionId=null,n.value=""),console.log(` Filtered sections for ${r}: ${a.length} options`)}async function Wce(){const r=er.approved.length;if(r===0){dl.showToast("    ","warning");return}await Jce("  ",` ${r}         ?`)&&await Yce()}async function Yce(){er.migrating=!0,Ct.progressContainer.classList.remove("hidden"),Ct.btnStartMigration.disabled=!0;const r=er.issues.filter(n=>er.approved.includes(n.id)),e=r.length;let t=0;try{for(const s of r){await Xce(s),t++;const i=Math.round(t/e*100);Ct.progressBar.style.width=`${i}%`,Ct.progressText.textContent=`${i}%`,await new Promise(a=>setTimeout(a,100))}dl.showToast(` ${t}    !`,"success");const n=Li.get("subjects")||[];for(const s of r)if(s.type==="subject"){const i=n.findIndex(a=>a.id===s.documentId);i!==-1&&(s.suggested.classId&&(n[i].classId=s.suggested.classId),s.suggested.sectionId&&(n[i].sectionId=s.suggested.sectionId))}Li.set("subjects",n),setTimeout(()=>{er.approved=[],er.skipped=[],PN()},1e3)}catch(n){console.error("Migration error:",n),dl.showToast(" : "+n.message,"error")}finally{er.migrating=!1,Ct.btnStartMigration.disabled=!1,setTimeout(()=>{Ct.progressContainer.classList.add("hidden"),Ct.progressBar.style.width="0%",Ct.progressText.textContent="0%"},2e3)}}async function Xce(r){const e={};r.suggested.classId&&(e.classId=r.suggested.classId),r.suggested.sectionId&&(e.sectionId=r.suggested.sectionId),r.suggested.subjectId&&(e.subjectId=r.suggested.subjectId),console.log(`Updating ${r.type}/${r.documentId}:`,e),r.type==="evaluation"?await Uf.updateEvaluation(r.documentId,e):r.type==="task"||r.type==="cross-class-mismatch"?await Uf.updateTask(r.documentId,e):r.type==="group"?await Uf.updateGroup(r.documentId,e):r.type==="subject"&&await Uf.updateSubject(r.documentId,e)}function Jce(r,e){return new Promise(t=>{const n=confirm(`${r}

${e}`);t(n)})}function Zce(){dl.showNotification("   ...","info")}class eAe{constructor(){this.services={dataService:JU,authService:Al,auth:{loginWithEmail:Dse,registerWithEmail:Rse,signInWithGoogle:Ose,logout:Qse,authServiceInstance:Al}},this.managers={stateManager:ir,uiManager:Gt,cacheManager:_s,themeManager:q2},this.utils={...VY,permissionHelper:jse,pdfGenerator:Jse},this.components={},this.publicPages=["dashboard","upcoming-assignments","all-students","group-policy","export","student-ranking","group-analysis","graph-analysis","graph-analysis","statistics","student-filter"],console.log("SmartGroupEvaluator app instantiated.")}async init(){console.log(" Initializing application..."),Gt.showLoading("  ...");try{this.managers.themeManager.init(),this._initComponents(),this._setupGlobalEventListeners(),await this._loadInitialData(),this._populateInitialFilters(),this.showPage("dashboard"),console.log(" Application initialized successfully.")}catch(e){console.error(" Initialization failed:",e),Gt.showToast(`    : ${e.message}`,"error",1e4),Gt.elements.appContainer&&(Gt.elements.appContainer.innerHTML='<div class="p-6 text-center text-red-600 dark:text-red-400">      </div>')}finally{ir.get("authLoading")||Gt.hideLoading()}}_initComponents(){console.log(" Initializing components...");const e={managers:this.managers,services:this.services,utils:this.utils,app:this};try{this.components.groups=_ie(e),this.components.tasks=tae(e),this.components.dashboard=tie(e),this.components.members=Oie(e),this.components.evaluation=wae(e),this.components.settings=uce(e),this.components.classManagement=_ce(e),this.components.teacherManagement=Bce(e),this.components.dataMigration=Uce(e),this.components.admin=Soe(e),this.components.exportModule=Noe(e),this.components.policy=Joe(e),this.components.upcomingAssignments=ule(e),this.components.statistics=Mle(e),this.components.ranking=Lae(e),this.components.analysis=qae(e),this.components.studentFilter=nce(e),console.log(" All components initialized.")}catch(t){throw console.error(" Error initializing components:",t),new Error(`Component initialization failed: ${t.message}`)}}_setupGlobalEventListeners(){console.log(" Setting up global event listeners...");const e=this.managers.uiManager;e.elements.sidebar?e.addListener(e.elements.sidebar,"click",t=>{const n=t.target.closest(".nav-btn");if(n&&!n.disabled){const s=n.dataset.page;s&&(t.preventDefault(),this.showPage(s))}}):console.warn("Sidebar element not found for setting up navigation."),e.addListener(e.elements.loginBtn,"click",()=>this._handleLogin()),e.addListener(e.elements.registerBtn,"click",()=>this._handleRegister()),e.addListener(e.elements.googleSignInBtn,"click",()=>this._handleGoogleSignIn()),e.addListener(e.elements.confirmLogout,"click",()=>this._handleLogout()),console.log(" Global event listeners attached.")}async _loadInitialData(){var e,t;console.log(" Loading initial data...");try{const[n,s,i,a,o,l,c,A,d]=await Promise.allSettled([this.services.dataService.loadGroups(),this.services.dataService.loadStudents(),this.services.dataService.loadTasks(),this.services.dataService.loadEvaluations(),this.services.dataService.loadGlobalSettings(),this.services.dataService.loadClasses(),this.services.dataService.loadSections(),this.services.dataService.loadSubjects(),this.services.dataService.loadTeachers()]),h=n.status==="fulfilled"?n.value:[],u=s.status==="fulfilled"?s.value:[],p=i.status==="fulfilled"?i.value:[],f=a.status==="fulfilled"?a.value:[],g=o.status==="fulfilled"?o.value:{},m=l.status==="fulfilled"?l.value:[],x=c.status==="fulfilled"?c.value:[],S=A.status==="fulfilled"?A.value:[],B=d.status==="fulfilled"?d.value:[];n.status==="rejected"&&console.warn(" Failed to load groups:",n.reason),s.status==="rejected"&&console.warn(" Failed to load students:",s.reason),i.status==="rejected"&&console.warn(" Failed to load tasks:",i.reason),a.status==="rejected"&&console.warn(" Failed to load evaluations:",a.reason),o.status==="rejected"&&console.warn(" Failed to load global settings:",o.reason),l.status==="rejected"&&console.warn(" Failed to load classes:",l.reason),c.status==="rejected"&&console.warn(" Failed to load sections:",c.reason),A.status==="rejected"&&console.warn(" Failed to load subjects:",A.reason),d.status==="rejected"&&console.warn(" Failed to load teachers:",d.reason),this.managers.stateManager.update({groups:h||[],students:u||[],tasks:p||[],evaluations:f||[],classes:m||[],sections:x||[],subjects:S||[],teachers:B||[]});const F=this.managers.stateManager.get("currentUser"),N=this.managers.stateManager.get("currentTeacher");F&&N&&N.assignedClasses&&N.assignedClasses.length>0&&(this.managers.stateManager.setActiveContext({classId:N.assignedClasses[0],sectionId:((e=N.assignedSections)==null?void 0:e[0])||null,subjectId:((t=N.assignedSubjects)==null?void 0:t[0])||null,teacherId:N.id}),console.log(" Teacher context set:",this.managers.stateManager.get("activeContext"))),g&&g.dashboardConfig&&(console.log(" Global Dashboard Config Loaded:",g.dashboardConfig),this.managers.stateManager.setDashboardConfig(g.dashboardConfig)),console.log(" Initial data loaded and state updated.")}catch(n){console.error(" Error loading initial data:",n),this.managers.uiManager.showToast(`      : ${n.message}`,"error")}}_populateInitialFilters(){var e,t,n,s;console.log(" Populating initial filters...");try{(e=this.components.members)==null||e.populateFilters(),(t=this.components.evaluation)==null||t.render(),(n=this.components.analysis)==null||n.renderSummary(),(s=this.components.statistics)==null||s.render()}catch(i){console.error(" Error populating initial filters:",i),this.managers.uiManager.showToast("     ","warning")}}showPage(e){var t,n;if((!e||typeof e!="string")&&(console.warn(`showPage: Invalid pageId "${e}". Defaulting to dashboard.`),e="dashboard"),console.log(`Navigating to page: ${e}`),!this._checkAuthAndPermissions(e)){this.managers.uiManager.showToast("      ","warning"),this.managers.stateManager.get("activePage")!=="dashboard"&&(console.log("Redirecting to dashboard due to permissions."),this.showPage("dashboard"));return}this.managers.uiManager.showPage(e);try{const s=this._getComponentKeyForPage(e),i=s?this.components[s]:null;if(i){let a=i.render;e==="all-students"&&i.renderStudentCards?a=i.renderStudentCards:e==="group-analysis"&&i.renderSummary?a=i.renderSummary:e==="graph-analysis"&&i.renderGraphs&&(a=i.renderGraphs),typeof a=="function"?(console.log(`Rendering component "${s}" for page: ${e}`),a(),(n=(t=window.smartEvaluator)==null?void 0:t.components.settings)==null||n.applySettings()):console.warn(`No suitable render function found on component "${s}" for page: ${e}`)}else console.warn(`No component instance found for page key "${s}" (derived from page ID "${e}")`)}catch(s){console.error(` Error rendering page ${e}:`,s),this.managers.uiManager.showToast(`'${e}'     `,"error");const i=document.getElementById(`page-${e}`);i&&this.managers.uiManager.displayEmptyMessage(i,"       ")}}_getComponentKeyForPage(e){switch(e){case"export":return"exportModule";case"all-students":return"members";case"group-analysis":return"analysis";case"graph-analysis":return"analysis";case"student-ranking":return"ranking";case"admin-management":return"admin";case"group-policy":return"policy";case"upcoming-assignments":return"upcomingAssignments";case"student-filter":return"studentFilter";case"class-management":return"classManagement";case"teacher-management":return"teacherManagement";case"data-migration":return"dataMigration";case"public-settings":return"settings";default:return e}}_checkAuthAndPermissions(e){if(this.publicPages.includes(e))return!0;if(!this.managers.stateManager.get("currentUser"))return!1;const n=this.managers.stateManager.get("currentUserData"),s=(n==null?void 0:n.type)||"user";return e==="admin-management"||e==="teacher-management"||e==="class-management"?s==="super-admin":e==="settings"?s==="admin"||s==="super-admin":e==="public-settings"?!0:s==="teacher"?["tasks","evaluation"].includes(e):s==="admin"||s==="super-admin"}async _handleLogin(){var n,s;const e=(n=this.managers.uiManager.elements.loginEmail)==null?void 0:n.value,t=(s=this.managers.uiManager.elements.loginPassword)==null?void 0:s.value;if(!e||!t){this.managers.uiManager.showToast("   ","warning");return}this.managers.uiManager.showLoading("  ...");try{await this.services.auth.loginWithEmail(e,t)}catch(i){console.error("Login failed (handled by authService):",i.message)}finally{this.managers.uiManager.hideLoading()}}async _handleRegister(){var s,i,a;const e=(s=this.managers.uiManager.elements.registerEmail)==null?void 0:s.value,t=(i=this.managers.uiManager.elements.registerPassword)==null?void 0:i.value,n=(a=this.managers.uiManager.elements.adminType)==null?void 0:a.value;if(!e||!t||t.length<6){this.managers.uiManager.showToast("       ","warning");return}this.managers.uiManager.showLoading(" ...");try{await this.services.auth.registerWithEmail(e,t,n),this.managers.uiManager._toggleAuthForm(!1)}catch(o){console.error("Registration failed (handled by authService):",o.message)}finally{this.managers.uiManager.hideLoading()}}async _handleGoogleSignIn(){this.managers.uiManager.showLoading("Google    ...");try{await this.services.auth.signInWithGoogle()}catch(e){console.error("Google Sign-In failed (handled by authService):",e.message)}finally{this.managers.uiManager.hideLoading()}}async _handleLogout(){this.managers.uiManager.showLoading("  ...");try{await this.services.auth.logout(),this.managers.uiManager.hideModal(this.managers.uiManager.elements.logoutModal)}catch(e){console.error("Logout failed (handled by authService):",e.message)}finally{this.managers.uiManager.hideLoading()}}async refreshAllData(){console.log(" Forcing data refresh..."),this.managers.cacheManager.setForceRefresh(),this.managers.uiManager.showLoading("   ...");try{await this._loadInitialData(),this._populateInitialFilters();const e=this.managers.stateManager.get("activePage");e&&this.showPage(e),this.managers.uiManager.showToast("    !","success")}catch(e){console.error(" Data refresh failed:",e),this.managers.uiManager.showToast("   ","error")}finally{this.managers.uiManager.hideLoading()}}}document.addEventListener("DOMContentLoaded",()=>{try{const r=new eAe;window.smartEvaluator=r,r.init(),console.log(" Application instance created and init sequence started.")}catch(r){console.error(" Failed to instantiate/initialize SmartGroupEvaluator:",r);const e=document.getElementById("appContainer")||document.body;e.innerHTML=`<div class="p-6 text-center text-red-600 dark:text-red-400">   : ${r.message}</div>`}});(()=>{if(window.__SDM_MODAL_INIT__)return;window.__SDM_MODAL_INIT__=!0;const r={els:{},chart:null,bound:!1},e=(()=>{try{return new Intl.DateTimeFormat("bn-BD",{year:"numeric",month:"short",day:"numeric"})}catch{return null}})(),t=new Intl.DateTimeFormat(void 0,{year:"numeric",month:"short",day:"numeric"}),n=document.createElement("canvas"),s=n.getContext("2d"),i=$=>document.getElementById($),a=$=>Array.from(document.querySelectorAll($)),o=($,V="")=>$==null?V:String($),l=$=>String($).replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"),c=$=>{var V,he;try{return((he=(V=window.smartEvaluator)==null?void 0:V.utils)==null?void 0:he.convertToBanglaNumber(String($)))??String($)}catch{return String($)}},A=($,V=2)=>{const he=typeof $=="number"?$:parseFloat($||0);return c((Number.isFinite(he)?he:0).toFixed(V))},d=$=>$ instanceof Date&&!Number.isNaN($.getTime())?e?e.format($):t.format($):"-",h=$=>({"team-leader":"bg-amber-50 text-amber-700 border-amber-200 dark:bg-amber-900/20 dark:text-amber-200 dark:border-amber-700/40","time-keeper":"bg-sky-50 text-sky-700 border-sky-200 dark:bg-sky-900/20 dark:text-sky-200 dark:border-sky-700/40",reporter:"bg-purple-50 text-purple-700 border-purple-200 dark:bg-purple-900/20 dark:text-purple-200 dark:border-purple-700/40","resource-manager":"bg-emerald-50 text-emerald-700 border-emerald-200 dark:bg-emerald-900/20 dark:text-emerald-200 dark:border-emerald-700/40","peace-maker":"bg-rose-50 text-rose-700 border-rose-200 dark:bg-rose-900/20 dark:text-rose-200 dark:border-rose-700/40"})[$]||"bg-gray-50 text-gray-700 border-gray-200 dark:bg-gray-800/40 dark:text-gray-200 dark:border-gray-700/40",u=$=>({"team-leader":" ","time-keeper":" ",reporter:"","resource-manager":" ","peace-maker":" "})[$]||($?String($):""),p=$=>{const V=Number($)||0;return V>=85?{badge:"bg-emerald-50 text-emerald-700 dark:bg-emerald-900/25 dark:text-emerald-300",chip:"text-emerald-600"}:V>=70?{badge:"bg-sky-50 text-sky-700 dark:bg-sky-900/25 dark:text-sky-300",chip:"text-sky-600"}:V>=55?{badge:"bg-amber-50 text-amber-700 dark:bg-amber-900/25 dark:text-amber-300",chip:"text-amber-600"}:{badge:"bg-rose-50 text-rose-700 dark:bg-rose-900/25 dark:text-rose-300",chip:"text-rose-600"}},f=$=>$==null?"":String($).trim();function g(){var he,z,M;const $=window.smartEvaluator;if(!$)return{students:[],evaluations:[],tasks:[],groups:[]};const V=((M=(z=(he=$.managers)==null?void 0:he.stateManager)==null?void 0:z.getState)==null?void 0:M.call(z))||{};return{students:Array.isArray(V.students)?V.students:[],evaluations:Array.isArray(V.evaluations)?V.evaluations:[],tasks:Array.isArray(V.tasks)?V.tasks:[],groups:Array.isArray(V.groups)?V.groups:[],classes:Array.isArray(V.classes)?V.classes:[],sections:Array.isArray(V.sections)?V.sections:[]}}async function m($){var O,H;const V=window.smartEvaluator,he=(O=V==null?void 0:V.services)==null?void 0:O.dataService;if(!he)return $;const z=(H=V.managers)==null?void 0:H.stateManager,M=[["students","loadStudents"],["groups","loadGroups"],["tasks","loadTasks"],["evaluations","loadEvaluations"],["classes","loadClasses"],["sections","loadSections"]].map(async([J,de])=>{if(Array.isArray($[J])&&$[J].length)return;const ie=he[de];if(typeof ie=="function")try{$[J]=await ie()||[],z!=null&&z.set&&z.set(J,$[J])}catch(le){console.warn(`[SDM] Failed to load ${J}:`,le)}});return await Promise.all(M),$}function x($,V){const he=f($),z=new Map(V.tasks.map(M=>[M==null?void 0:M.id,M]));return V.evaluations.map(M=>{var D,G,ce,Z;const O=(D=M==null?void 0:M.scores)==null?void 0:D[he];if(!O)return null;const H=z.get(M==null?void 0:M.taskId)||null,J=parseFloat(M==null?void 0:M.maxPossibleScore)||parseFloat(H==null?void 0:H.maxScore)||100,de=parseFloat(O==null?void 0:O.totalScore)||0,ie=J>0?de/J*100:0;let le=null;(G=M==null?void 0:M.taskDate)!=null&&G.seconds?le=M.taskDate.seconds*1e3:(ce=M==null?void 0:M.evaluationDate)!=null&&ce.seconds?le=M.evaluationDate.seconds*1e3:le=Date.parse(M==null?void 0:M.taskDate)||0||Date.parse(M==null?void 0:M.updatedAt)||0||Date.parse(H==null?void 0:H.date)||0||null;const fe=(H==null?void 0:H.maxScoreBreakdown)||(M==null?void 0:M.maxScoreBreakdown)||{},ve=parseFloat(fe.task)||0,Ce=parseFloat(fe.team)||0,Be=parseFloat(fe.Progress)||0,Qe=parseFloat(fe.mcq)||0;return{taskName:(H==null?void 0:H.name)||(M==null?void 0:M.taskName)||"",date:le?new Date(le):null,taskScore:parseFloat(O==null?void 0:O.taskScore)||0,teamScore:parseFloat(O==null?void 0:O.teamScore)||0,Progress:parseFloat(O==null?void 0:O.ProgressScore)||0,mcq:parseFloat(O==null?void 0:O.mcqScore)||0,maxTask:ve,maxTeam:Ce,maxProgress:Be,maxMcq:Qe,total:de,max:J,pct:ie,comments:typeof(O==null?void 0:O.comments)=="string"?O.comments.trim():"",problemRecovered:(O==null?void 0:O.problemRecovered)||!1,topic:((Z=O==null?void 0:O.ProgressCriteria)==null?void 0:Z.topic)||null}}).filter(Boolean).sort((M,O)=>{var H,J;return(((H=M.date)==null?void 0:H.getTime())??0)-(((J=O.date)==null?void 0:J.getTime())??0)})}function S($,V){try{const he=f($),z=new Map(V.tasks.map(H=>[H==null?void 0:H.id,H])),O=V.students.map(H=>{const J=f(H==null?void 0:H.id),de=V.evaluations.map(ie=>{var Be;const le=(Be=ie==null?void 0:ie.scores)==null?void 0:Be[J],fe=z.get(ie==null?void 0:ie.taskId);if(!le||!fe)return null;const ve=parseFloat(ie==null?void 0:ie.maxPossibleScore)||parseFloat(fe==null?void 0:fe.maxScore)||100,Ce=parseFloat(le==null?void 0:le.totalScore)||0;return ve>0?Ce/ve*100:0}).filter(ie=>typeof ie=="number");return{id:J,avg:de.length?de.reduce((ie,le)=>ie+le,0)/de.length:-1}}).filter(H=>((H==null?void 0:H.avg)??-1)>=0).sort((H,J)=>J.avg-H.avg).findIndex(H=>(H==null?void 0:H.id)===he);return O>=0?c(O+1):"-"}catch{return"-"}}async function B($){try{if(!zr)return null;const V=await eu(Ws(zr,"students",String($)));if(V.exists()){const M=V.data()||{};return M.role||M.duty||null}const he=NA(gl(zr,"students"),ac("id","==",String($)),ip(1)),z=await dc(he);if(!z.empty){const M=z.docs[0].data()||{};return M.role||M.duty||null}}catch(V){console.warn("Error fetching student role:",V)}return null}function F($,V){const he=i($);he&&(he.textContent=V||"")}function N($,V){const he=i($);he&&(he.innerHTML=V)}function E($,V,he,z,M,O,H,J){const de=i("sdmAvatar");de&&(de.src=$.photoURL||$.avatar||"images/smart.png",de.onerror=()=>{de.onerror=null,de.src="images/smart.png"},de.alt=`${$.name||$.id||"Student"} avatar`),F("sdmTitle"," "),F("sdmRoll",$.roll?`: ${c($.roll)}`:"");const ie=l($.name||$.id||""),le=o($.role).trim(),fe=u(le),ve=h(le),Ce=fe?`<span class="inline-flex items-center gap-1 rounded-full border px-2 py-0.5 text-[11px] font-semibold ${ve}">
           <i class="fas fa-id-badge"></i>${l(fe)}
         </span>`:"";N("sdmName",`<span class="mr-2 align-middle">${ie}</span>${Ce}`),F("sdmTitle","  "),F("sdmRoll",$.roll?`: ${c($.roll)}`:""),F("sdmGroup",V?`: ${V}`:""),F("sdmClass",H?`: ${H}`:""),F("sdmSection",J?`: ${J}`:""),F("sdmAcademic",$.academicGroup?` : ${$.academicGroup}`:""),F("sdmSession",$.session?`: ${$.session}`:""),$.email||$.contact,F("sdmContact",""),F("sdmGroup",V?`: ${V}`:""),F("sdmClass",H?`: ${H}`:""),F("sdmSection",J?`: ${J}`:""),F("sdmAcademic",$.academicGroup?` : ${$.academicGroup}`:""),F("sdmSession",$.session?`: ${$.session}`:""),F("sdmContact",""),F("sdmAvgTotal",A(M)),F("sdmAvgPct",`${A(z,1)}%`),F("sdmRank",O);const Be=i("sdmParamList");if(Be){const D=document.createDocumentFragment();Be.innerHTML="";const G=Math.max(1,he.length),ce=he.reduce((W,ee)=>({task:W.task+(ee.taskScore||0),team:W.team+(ee.teamScore||0),Progress:W.Progress+(ee.Progress||0),mcq:W.mcq+(ee.mcq||0),total:W.total+(ee.total||0)}),{task:0,team:0,Progress:0,mcq:0,total:0}),Z=ce.total/G||0;[["",ce.task/G],["",ce.team/G],["",ce.Progress/G],["MCQ",ce.mcq/G]].forEach(([W,ee])=>{const ye=document.createElement("li"),xe=p(Z>0?ee/Z*100:0);ye.className=`rounded border border-gray-200 dark:border-gray-700 px-3 py-2 bg-white dark:bg-gray-800 ${xe.chip}`,ye.textContent=`${W}: ${A(ee)}`,D.appendChild(ye)}),Be.appendChild(D);try{const W=Math.max(1,he.length),ee=he.reduce((Ee,Ne)=>({task:Ee.task+(Ne.taskScore||0),team:Ee.team+(Ne.teamScore||0),Progress:Ee.Progress+(Ne.Progress||0),mcq:Ee.mcq+(Ne.mcq||0),total:Ee.total+(Ne.total||0)}),{task:0,team:0,Progress:0,mcq:0,total:0}),ye=ee.total/W||0,we=[{key:"task",label:"",color:"indigo",value:ee.task/W},{key:"team",label:"",color:"emerald",value:ee.team/W},{key:"Progress",label:"",color:"amber",value:ee.Progress/W},{key:"mcq",label:"MCQ",color:"sky",value:ee.mcq/W}].map(({label:Ee,color:Ne,value:Ue})=>{const je=ye>0?Math.max(0,Math.min(1,Ue/ye)):0,st=Math.round(je*100);return`
            <li class="rounded-lg border border-gray-200 dark:border-gray-700 p-3 bg-white dark:bg-gray-800">
              <div class="flex items-center justify-between mb-2">
                <span class="inline-flex items-center gap-1 rounded-full px-2 py-0.5 text-xs font-semibold bg-${Ne}-50 text-${Ne}-700 dark:bg-${Ne}-900/20 dark:text-${Ne}-200">${l(Ee)}</span>
                <span class="text-sm font-semibold text-${Ne}-600 dark:text-${Ne}-300">${A(Ue)}</span>
              </div>
              <div class="h-2 w-full rounded-full bg-slate-100 dark:bg-slate-700 overflow-hidden">
                <div class="h-2 rounded-full bg-${Ne}-500" style="width:${st}%"></div>
              </div>
              <div class="mt-1 text-[11px] text-gray-500 dark:text-gray-400"> : ${c(st)}%</div>
            </li>`}).join("");Be.innerHTML=we}catch{}try{const W=Math.max(1,he.length),ee=he.reduce((Ee,Ne)=>({task:Ee.task+(Ne.taskScore||0),team:Ee.team+(Ne.teamScore||0),Progress:Ee.Progress+(Ne.Progress||0),mcq:Ee.mcq+(Ne.mcq||0)}),{task:0,team:0,Progress:0,mcq:0}),ye=he.reduce((Ee,Ne)=>({task:Ee.task+(Ne.maxTask||0),team:Ee.team+(Ne.maxTeam||0),Progress:Ee.Progress+(Ne.maxProgress||0),mcq:Ee.mcq+(Ne.maxMcq||0)}),{task:0,team:0,Progress:0,mcq:0}),we=[{key:"task",label:"",color:"indigo"},{key:"team",label:"",color:"emerald"},{key:"Progress",label:"",color:"amber"},{key:"mcq",label:"MCQ",color:"sky"}].map(({key:Ee,label:Ne,color:Ue})=>{const je=ee[Ee]/W||0,st=ye[Ee]||0,Ze=st>0?Math.round(Math.max(0,Math.min(1,ee[Ee]/st))*100):0;return`
            <li class="rounded-lg border border-gray-200 dark:border-gray-700 p-3 bg-white dark:bg-gray-800">
              <div class="flex items-center justify-between mb-2">
                <span class="inline-flex items-center gap-1 rounded-full px-2 py-0.5 text-xs font-semibold bg-${Ue}-50 text-${Ue}-700 dark:bg-${Ue}-900/20 dark:text-${Ue}-200">${l(Ne)}</span>
                <span class="text-sm font-semibold text-${Ue}-600 dark:text-${Ue}-300">${A(je)}</span>
              </div>
              <div class="h-2 w-full rounded-full bg-slate-100 dark:bg-slate-700 overflow-hidden">
                <div class="h-2 rounded-full bg-${Ue}-500" style="width:${Ze}%"></div>
              </div>
              <div class="mt-1 text-[11px] text-gray-500 dark:text-gray-400">  : ${c(Ze)}%</div>
            </li>`}).join("");Be.innerHTML=we}catch{}}const Qe=i("sdmFootnote");Qe&&(Qe.textContent=`${c(he.length)}     `)}function w($){const V=i("sdmTableBody");if(!V)return;if(!Array.isArray($)||$.length===0){V.innerHTML='<tr><td colspan="9" class="px-3 py-4 text-center text-sm text-gray-500 dark:text-gray-400">     </td></tr>';return}const he=document.createDocumentFragment();for(const z of $){const M=document.createElement("tr"),O=p(z.pct),H=z.date?d(z.date):"-";let J="-";const de=z.topic;(de==="topic_understood"||de==="topic_none")&&(z.problemRecovered?J='<span class="inline-flex items-center gap-1 rounded border border-green-200 bg-green-50 px-1.5 py-0.5 text-[10px] font-medium text-green-700 dark:border-green-800 dark:bg-green-900/20 dark:text-green-300"><i class="fas fa-check-circle text-[10px]"></i>  </span>':J='<span class="inline-flex items-center gap-1 rounded border border-red-200 bg-red-50 px-1.5 py-0.5 text-[10px] font-medium text-red-700 dark:border-red-800 dark:bg-red-900/20 dark:text-red-300"><i class="fas fa-exclamation-circle text-[10px]"></i>  </span>'),de==="topic_learned_well"&&z.problemRecovered&&(J='<span class="inline-flex items-center gap-1 rounded border border-green-200 bg-green-50 px-1.5 py-0.5 text-[10px] font-medium text-green-700 dark:border-green-800 dark:bg-green-900/20 dark:text-green-300"><i class="fas fa-check-circle text-[10px]"></i>  </span>'),M.innerHTML=`
        <td class="px-3 py-2">
            ${l(z.taskName||"-")}
        </td>
        <td class="px-3 py-2"><span class="inline-block rounded px-2 py-0.5 text-xs font-medium bg-sky-50 text-sky-700 dark:bg-sky-900/20 dark:text-sky-300">${A(z.taskScore)}</span></td>
        <td class="px-3 py-2"><span class="inline-block rounded px-2 py-0.5 text-xs font-medium bg-emerald-50 text-emerald-700 dark:bg-emerald-900/20 dark:text-emerald-300">${A(z.teamScore)}</span></td>
        <td class="px-3 py-2"><span class="inline-block rounded px-2 py-0.5 text-xs font-medium bg-amber-50 text-amber-700 dark:bg-amber-900/20 dark:text-amber-300">${A(z.Progress)}</span></td>
        <td class="px-3 py-2"><span class="inline-block rounded px-2 py-0.5 text-xs font-medium bg-indigo-50 text-indigo-700 dark:bg-indigo-900/20 dark:text-indigo-300">${A(z.mcq)}</span></td>
        <td class="px-3 py-2">${A(z.total)}</td>
        <td class="px-3 py-2"><span class="inline-block rounded px-2 py-0.5 text-xs font-semibold ${O.badge}">${A(z.pct,1)}%</span></td>
        <td class="px-3 py-2 whitespace-nowrap">${J}</td>
        <td class="px-3 py-2">${l(z.comments||"")}</td>
        <td class="px-3 py-2">${l(H)}</td>`,he.appendChild(M)}V.innerHTML="",V.appendChild(he)}function v($){var O;const V=i("sdmChart");if(!V||!window.Chart)return;const he=$.map(H=>H.taskName||(H.date?d(H.date):"N/A")),z=$.map(H=>Number((H.pct||0).toFixed(1))),M=z.map((H,J,de)=>J===de.length-1?"#22c55e":"#94a3b8");if(r.chart&&Array.isArray((O=r.chart.data)==null?void 0:O.labels)&&r.chart.data.labels.length===he.length){r.chart.data.labels=he,r.chart.data.datasets[0].data=z,r.chart.data.datasets[0].backgroundColor=M,r.chart.update("none");return}if(r.chart){try{r.chart.destroy()}catch{}r.chart=null}r.chart=new window.Chart(V,{type:"bar",data:{labels:he,datasets:[{data:z,backgroundColor:M,borderRadius:6,maxBarThickness:32,categoryPercentage:.6,barPercentage:.8}]},options:{responsive:!0,maintainAspectRatio:!1,animation:{duration:150},plugins:{legend:{display:!1},tooltip:{displayColors:!1}},scales:{x:{grid:{display:!1},ticks:{maxRotation:0,autoSkip:!0,autoSkipPadding:8}},y:{beginAtZero:!0,max:100,grace:"5%",grid:{color:"rgba(148,163,184,0.25)"},ticks:{stepSize:20,callback:H=>c(H)}}}}})}function I($,V){const he=URL.createObjectURL($);try{const z=document.createElement("a");z.href=he,z.download=V,document.body.appendChild(z),z.click(),z.remove()}finally{setTimeout(()=>URL.revokeObjectURL(he),1200)}}function k(){const $=r.els.modal;if(!$)return;const V=$.__evals||[],he=$.__student||{};if(!V.length)return;const z=["Title","Task","Team","Progress","MCQ","Total","Percent","Comments","Date"],M=fe=>{var ve;try{return((ve=fe?new Date(fe):null)==null?void 0:ve.toISOString().slice(0,10))||""}catch{return""}},O=V.map(fe=>[fe.taskName||"",Number(fe.taskScore||0).toFixed(2),Number(fe.teamScore||0).toFixed(2),Number(fe.Progress||0).toFixed(2),Number(fe.mcq||0).toFixed(2),Number(fe.total||0).toFixed(2),Number(fe.pct||0).toFixed(1),(fe.comments||"").replace(/\r?\n/g," "),M(fe.date)]),H=fe=>{const ve=String(fe??"");return/[",\n]/.test(ve)?`"${ve.replace(/"/g,'""')}"`:ve},J="\uFEFF",de=[z.map(H).join(","),...O.map(fe=>fe.map(H).join(","))].join(`\r
`),ie=new Blob([J+de],{type:"text/csv;charset=utf-8;"}),le=`${(he.name||he.id||"student").replace(/[\\/:*?"<>|]+/g,"_").trim()||"student"}_report.csv`;I(ie,le)}function _(){var it;const $=r.els.modal;if(!$)return;const V=$.__evals||[],he=$.__student||{};if(!V.length)return;const z=window.jspdf&&window.jspdf.jsPDF||null;if(!z){console.error("jsPDF not loaded");return}if(!!!((it=window.jspdf)!=null&&it.autoTable||z!=null&&z.autoTable||z!=null&&z.API&&z.API.autoTable)){console.error("autoTable plugin missing");return}const O=new z("p","pt","a4"),H=36,J=[79,70,229],de=O.internal.pageSize.getWidth(),ie=O.internal.pageSize.getHeight(),le=(lt,tt,rt,ft={})=>O.text(lt,tt,rt,ft),fe=(lt,tt,rt,ft,St=[226,232,240])=>{O.setDrawColor(...St),O.line(lt,tt,rt,ft)},ve=(lt,tt)=>O.splitTextToSize(lt,tt),Ce=(lt,tt,rt,ft=200,St=10,yt="#0f172a")=>{try{const jt=String(lt??"");if(!jt)return;const Rt=2,wr=6*Rt;s.font=`${St*Rt}px 'Noto Sans Bengali','Hind Siliguri','SolaimanLipi','Segoe UI',sans-serif`;const Qr=s.measureText(jt);n.width=Math.ceil(Qr.width)+wr,n.height=Math.ceil(St*1.6*Rt)+wr;const Lt=n.getContext("2d");Lt.font=s.font,Lt.fillStyle=yt,Lt.textBaseline="top",Lt.fillText(jt,wr/2,wr/2);const Ut=n.toDataURL("image/png"),mr=.75;let gs=n.width*mr,Pn=n.height*mr;if(gs>ft){const hi=ft/gs;gs=ft,Pn*=hi}O.addImage(Ut,"PNG",tt,rt-St*.8,gs,Pn)}catch{}},Be=78,Qe=28,D=()=>{const lt=H+12,tt=new Date,rt=tt.getFullYear(),ft=String(tt.getMonth()+1).padStart(2,"0"),St=String(tt.getDate()).padStart(2,"0"),yt=tt.getHours(),jt=String(tt.getMinutes()).padStart(2,"0"),Rt=yt>=12?"pm":"am",wr=yt%12||12,Qr=String(wr).padStart(2,"0"),Lt=`Generated: ${rt}-${ft}-${St} ${Qr}:${jt} ${Rt}`;O.setFont("helvetica","normal"),O.setFontSize(9),O.setTextColor(71,85,105),le(Lt,de-H-8,H+14,{align:"right"}),O.setTextColor(17,24,39),O.setFont("helvetica","bold"),O.setFontSize(12),le("SMART EVALUATE Automated SYSTEM",de/2,lt+6,{align:"center"}),O.setFontSize(14),le("Student Result Report",de/2,lt+22,{align:"center"}),O.setDrawColor(226,232,240),O.setTextColor(17,24,39),fe(H,H+Be-8,de-H,H+Be-8)},G=()=>{const lt=ie-Qe;fe(H,lt,de-H,lt),O.setFont("helvetica","normal"),O.setFontSize(9),O.setTextColor(107,114,128),le(`Page ${O.internal.getCurrentPageInfo().pageNumber}`,de-H-40,ie-10)},ce=()=>{const lt=O.internal.getNumberOfPages();for(let tt=1;tt<=lt;tt++)O.setPage(tt),D(),G()};let Z=H+Be+2;const W="Institution: Muktijoddha Major Mostofa College, Rajapur, Mirsharai, Chattogram",ee="Developed by: Mustafa Rahman Sir, Senior Software Engineer",ye="Query for Contact: 01840-643946";O.setTextColor(17,24,39),O.setFont("helvetica","normal"),O.setFontSize(11),O.text(ve(W,de-H*2),H,Z),Z+=22;const xe=40;O.setDrawColor(99,102,241),O.setFillColor(238,242,255),O.rect(H,Z,de-H*2,xe,"FD"),O.setTextColor(55,48,163),O.setFont("helvetica","bold"),O.setFontSize(10),O.text(ee,H+10,Z+16),O.setFont("helvetica","normal"),O.text(ye,H+10,Z+30),Z+=xe+10;const we=96,Ee=(de-H*2)/2,Ne=H+Ee+12,Ue=Z+20;O.setDrawColor(226,232,240),O.setFillColor(248,250,252),O.rect(H,Z,de-H*2,we,"FD"),O.setTextColor(15,23,42);const je=(lt,tt,rt)=>{O.setFont("helvetica","bold"),O.setFontSize(10),le(lt,H+12,rt),O.setFont("helvetica","normal");const ft=H+12+120,St=(de-H*2)/2-(ft-(H+12))-12;/[^\x00-\x7F]/.test(String(tt||""))?Ce(tt,ft,rt,St,10):le(String(tt??""),ft,rt)};je("Student:",he.name||he.id||"",Ue),je("Roll:",he.roll||"-",Ue+16),je("Group:",r.els.modal.__groupName||"-",Ue+32),je("Academic Group:",he.academicGroup||"-",Ue+48);const st=u(he.role)||"-";O.setFont("helvetica","bold"),O.setFontSize(10),le("Duty:",H+12,Ue+64),Ce(String(st),H+12+120,Ue+64,(de-H*2)/2-132,10),O.setFont("helvetica","bold"),O.setFontSize(10),le("Average Total:",Ne,Ue),O.setFont("helvetica","normal"),le(String((r.els.modal.__avgTotal||0).toFixed(2)),Ne+90,Ue),O.setFont("helvetica","bold"),le("Average %:",Ne,Ue+16),O.setFont("helvetica","normal"),le(`${(r.els.modal.__avgPct||0).toFixed(1)}%`,Ne+90,Ue+16),O.setFont("helvetica","bold"),le("Rank:",Ne,Ue+32),O.setFont("helvetica","normal"),Ce(String(r.els.modal.__rank??"-"),Ne+90,Ue+32,40,10),Z+=we+14;const Ze=[["Assignment","Task","Team","Progress","MCQ","Total","%","Status","Date"]],ct=V.map((lt,tt)=>{const rt=(lt.comments||"").replace(/\r?\n/g," ").trim();rt.length>240;const ft=lt.taskName||"";let St="-";return(lt.taskScore===5||lt.taskScore===-5)&&(St=lt.problemRecovered?"Problem Resolved":"Have a problem"),[`Assignment-${tt+1}`,ft,Number(lt.taskScore||0).toFixed(2),Number(lt.teamScore||0).toFixed(2),Number(lt.Progress||0).toFixed(2),Number(lt.mcq||0).toFixed(2),Number(lt.total||0).toFixed(2),Number(lt.pct||0).toFixed(1),St,lt.date?new Date(lt.date).toISOString().slice(0,10):""]});(O.autoTable||z.API.autoTable).call(O,{startY:Z,head:Ze,body:ct,styles:{font:"helvetica",fontSize:9,cellPadding:4,lineWidth:.25,lineColor:[226,232,240]},headStyles:{fillColor:J,textColor:255,halign:"left"},alternateRowStyles:{fillColor:[248,250,252]},columnStyles:{0:{cellWidth:60},1:{cellWidth:60},2:{cellWidth:35,halign:"right"},3:{cellWidth:35,halign:"right"},4:{cellWidth:40,halign:"right"},5:{cellWidth:35,halign:"right"},6:{cellWidth:40,halign:"right"},7:{cellWidth:40,halign:"center"},8:{cellWidth:60},9:{cellWidth:80}},margin:{left:H,right:H,top:H+Be,bottom:Qe+6},tableWidth:de-H*2,pageBreak:"auto"}),ce();const wt=`${(he.name||he.id||"student").replace(/[\\/:*?"<>|]+/g,"_").trim()||"student"}_report.pdf`;O.save(wt)}async function T($,V){if(!$||$.dataset.busy==="1")return;$.dataset.busy="1";const he=$.disabled;$.disabled=!0,$.classList.add("opacity-60","pointer-events-none");try{await Promise.resolve(V())}finally{setTimeout(()=>{$.dataset.busy="0",$.disabled=he,$.classList.remove("opacity-60","pointer-events-none")},500)}}async function L($,V={}){var ce,Z,W;const he=r.els.modal;if(!he)return;const z=f($);if(!z){console.warn("[SDM] openStudentModalById called without a valid studentId.");return}const M=g(),O=(V==null?void 0:V.state)||{},H={students:Array.isArray(O.students)&&O.students.length?O.students:M.students,evaluations:Array.isArray(O.evaluations)&&O.evaluations.length?O.evaluations:M.evaluations,tasks:Array.isArray(O.tasks)&&O.tasks.length?O.tasks:M.tasks,groups:Array.isArray(O.groups)&&O.groups.length?O.groups:M.groups,classes:Array.isArray(O.classes)&&O.classes.length?O.classes:M.classes,sections:Array.isArray(O.sections)&&O.sections.length?O.sections:M.sections};await m(H);let J=null;if(V.student&&f(V.student.id)===z)J={...V.student};else{const ee=H.students.findIndex(ye=>f(ye==null?void 0:ye.id)===z);ee>=0&&(J={...H.students[ee]})}if(!J){console.warn("[SDM] Student not found for modal:",$);return}const de=await B(z);de&&(J.role=de);const ie=V.groupName||((ce=H.groups.find(ee=>f(ee==null?void 0:ee.id)===f(J.groupId)))==null?void 0:ce.name)||"",le=((Z=H.classes.find(ee=>f(ee==null?void 0:ee.id)===f(J.classId)))==null?void 0:Z.name)||"",fe=((W=H.sections.find(ee=>f(ee==null?void 0:ee.id)===f(J.sectionId)))==null?void 0:W.name)||"",ve=x(z,H),Ce=Math.max(1,ve.length),Be=ve.reduce((ee,ye)=>({total:ee.total+(ye.total||0),pct:ee.pct+(ye.pct||0)}),{total:0,pct:0}),Qe=Be.pct/Ce,D=Be.total/Ce,G=S($,H);E(J,ie,ve,Qe,D,G,le,fe),w(ve),v(ve),he.__evals=ve,he.__student=J,he.__groupName=ie,he.__avgPct=Qe,he.__avgTotal=D,he.__rank=G!=="-"?G:null,K("table"),he.classList.remove("hidden")}function K($){var he,z,M,O,H,J;const V=$==="chart";(he=r.els.wrapChart)==null||he.classList.toggle("hidden",!V),(z=r.els.wrapTable)==null||z.classList.toggle("hidden",V),(M=r.els.btnTable)==null||M.classList.toggle("bg-gray-100",!V),(O=r.els.btnTable)==null||O.classList.toggle("dark:bg-gray-800",!V),(H=r.els.btnChart)==null||H.classList.toggle("bg-gray-100",V),(J=r.els.btnChart)==null||J.classList.toggle("dark:bg-gray-800",V)}function se(){var $,V,he,z;r.bound||(r.bound=!0,document.addEventListener("click",M=>{var O;if(M.target.closest("[data-modal-close]")&&((O=r.els.modal)==null||O.classList.add("hidden"),r.chart)){try{r.chart.destroy()}catch{}r.chart=null}}),document.addEventListener("keydown",M=>{if(M.key==="Escape"&&r.els.modal&&!r.els.modal.classList.contains("hidden")&&(r.els.modal.classList.add("hidden"),r.chart)){try{r.chart.destroy()}catch{}r.chart=null}}),document.addEventListener("click",M=>{const O=M.target.closest(".ranking-card, .view-rank-details-btn");if(!O)return;const H=O.getAttribute("data-student-id");H&&(M.preventDefault(),window.openStudentModalById(H))}),($=r.els.btnCsv)==null||$.addEventListener("click",M=>{M.stopPropagation(),T(r.els.btnCsv,k)}),(V=r.els.btnPdf)==null||V.addEventListener("click",M=>{M.stopPropagation(),T(r.els.btnPdf,_)}),(he=r.els.btnTable)==null||he.addEventListener("click",()=>K("table")),(z=r.els.btnChart)==null||z.addEventListener("click",()=>K("chart")),a('img[src="avatar.png"]').forEach(M=>{M.src="images/smart.png",M.onerror=()=>{M.onerror=null,M.src="images/smart.png"}}))}function X(){if(r.els.modal=i("studentDetailModal"),r.els.btnCsv=i("sdmDownloadCsv"),r.els.btnPdf=i("sdmDownloadPdf"),r.els.btnTable=i("sdmBtnTable"),r.els.btnChart=i("sdmBtnChart"),r.els.wrapTable=i("sdmTableWrap"),r.els.wrapChart=i("sdmChartWrap"),!r.els.modal){console.warn("[SDM] modal node missing; script loaded but no #studentDetailModal.");return}se(),window.openStudentModalById||(window.openStudentModalById=L)}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",X,{once:!0}):X()})();(()=>{if(window.__GDM_MODAL_INIT__)return;window.__GDM_MODAL_INIT__=!0;const r={els:{},bound:!1,state:{currentGroupId:null}},e=g=>document.getElementById(g),t=g=>{var m,x;try{return((x=(m=window.smartEvaluator)==null?void 0:m.utils)==null?void 0:x.convertToBanglaNumber(String(g)))??String(g)}catch{return String(g)}},n=g=>String(g??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"),s=g=>({"team-leader":" ","time-keeper":" ",reporter:"","resource-manager":" ","peace-maker":" "})[String(g||"").trim()]||(g?String(g):""),i=g=>({"team-leader":"bg-amber-50 text-amber-700 border-amber-200","time-keeper":"bg-sky-50 text-sky-700 border-sky-200",reporter:"bg-purple-50 text-purple-700 border-purple-200","resource-manager":"bg-emerald-50 text-emerald-700 border-emerald-200","peace-maker":"bg-rose-50 text-rose-700 border-rose-200"})[String(g||"").trim()]||"bg-gray-50 text-gray-700 border-gray-200",a=["bg-emerald-50 text-emerald-700 border-emerald-200 dark:bg-emerald-500/10 dark:text-emerald-300 dark:border-emerald-700/40","bg-indigo-50 text-indigo-700 border-indigo-200 dark:bg-indigo-500/10 dark:text-indigo-300 dark:border-indigo-700/40","bg-rose-50 text-rose-700 border-rose-200 dark:bg-rose-500/10 dark:text-rose-300 dark:border-rose-700/40","bg-amber-50 text-amber-700 border-amber-200 dark:bg-amber-500/10 dark:text-amber-300 dark:border-amber-700/40","bg-sky-50 text-sky-700 border-sky-200 dark:bg-sky-500/10 dark:text-sky-300 dark:border-sky-700/40","bg-fuchsia-50 text-fuchsia-700 border-fuchsia-200 dark:bg-fuchsia-500/10 dark:text-fuchsia-300 dark:border-fuchsia-700/40","bg-lime-50 text-lime-700 border-lime-200 dark:bg-lime-500/10 dark:text-lime-300 dark:border-lime-700/40","bg-teal-50 text-teal-700 border-teal-200 dark:bg-teal-500/10 dark:text-teal-300 dark:border-teal-700/40","bg-orange-50 text-orange-700 border-orange-200 dark:bg-orange-500/10 dark:text-orange-300 dark:border-orange-700/40","bg-cyan-50 text-cyan-700 border-cyan-200 dark:bg-cyan-500/10 dark:text-cyan-300 dark:border-cyan-700/40"],o=g=>{const m=String(g||"").trim();if(!m)return"bg-gray-50 text-gray-700 border-gray-200 dark:bg-gray-800/40 dark:text-gray-300 dark:border-gray-700/60";let x=0;for(let S=0;S<m.length;S++)x=x*31+m.charCodeAt(S)>>>0;return a[x%a.length]},l=g=>{const m=Number(g)||0;return m>=85?"bg-emerald-50 text-emerald-700":m>=70?"bg-sky-50 text-sky-700":m>=55?"bg-amber-50 text-amber-700":"bg-rose-50 text-rose-700"};function c(){var x,S,B;const g=window.smartEvaluator;if(!g)return{groups:[],students:[],tasks:[],evaluations:[],classes:[],sections:[],subjects:[]};const m=((B=(S=(x=g.managers)==null?void 0:x.stateManager)==null?void 0:S.getState)==null?void 0:B.call(S))||{};return{groups:Array.isArray(m.groups)?m.groups:[],students:Array.isArray(m.students)?m.students:[],tasks:Array.isArray(m.tasks)?m.tasks:[],evaluations:Array.isArray(m.evaluations)?m.evaluations:[],classes:Array.isArray(m.classes)?m.classes:[],sections:Array.isArray(m.sections)?m.sections:[],subjects:Array.isArray(m.subjects)?m.subjects:[]}}function A(g){if(!g)return 0;if(typeof g=="object"&&g.seconds)return g.seconds*1e3;const m=Date.parse(g);return Number.isFinite(m)?m:0}function d(g,m){var se,X,$,V,he,z,M,O,H,J,de,ie,le,fe,ve,Ce;const x=new Map(m.tasks.map(Be=>[Be==null?void 0:Be.id,Be])),S=m.students.filter(Be=>String(Be==null?void 0:Be.groupId)===String(g)),B=new Set(S.map(Be=>String(Be==null?void 0:Be.id))),F=window.smartEvaluator,N=($=(X=(se=F==null?void 0:F.managers)==null?void 0:se.stateManager)==null?void 0:X.get)==null?void 0:$.call(X,"currentUserData"),E=(z=(he=(V=F==null?void 0:F.managers)==null?void 0:V.stateManager)==null?void 0:he.get)==null?void 0:z.call(he,"currentTeacher"),w=(N==null?void 0:N.type)==="teacher",v=w?(E==null?void 0:E.assignedSubjects)||[]:[];let I=m.evaluations.filter(Be=>String(Be==null?void 0:Be.groupId)===String(g));if(w&&v.length>0){const Be=((H=(O=(M=F==null?void 0:F.managers)==null?void 0:M.stateManager)==null?void 0:O.get)==null?void 0:H.call(O,"subjects"))||[],Qe=new Set(Be.filter(D=>v.includes(D.id)).map(D=>{var G;return(G=D.name)==null?void 0:G.trim()}));I=I.filter(D=>{const G=x.get(D==null?void 0:D.taskId);if(!G||!G.subjectId)return!1;if(v.includes(G.subjectId))return!0;const ce=Be.find(Z=>Z.id===G.subjectId);return!!(ce&&ce.name&&Qe.has(ce.name.trim()))}),console.log(" Teacher modal: Filtered evaluations from",m.evaluations.filter(D=>String(D==null?void 0:D.groupId)===String(g)).length,"to",I.length)}const k=(ie=(de=(J=F==null?void 0:F.managers)==null?void 0:J.stateManager)==null?void 0:de.get)==null?void 0:ie.call(de,"activeContext");if(k){const{classId:Be,sectionId:Qe,subjectId:D}=k;if(Be||Qe||D){const G=((ve=(fe=(le=F==null?void 0:F.managers)==null?void 0:le.stateManager)==null?void 0:fe.get)==null?void 0:ve.call(fe,"subjects"))||[],ce=G.find(W=>W.id===D),Z=(Ce=ce==null?void 0:ce.name)==null?void 0:Ce.trim();I=I.filter(W=>{var ye;const ee=x.get(W==null?void 0:W.taskId);if(!ee||Be&&ee.classId&&String(ee.classId)!==String(Be)||Qe&&ee.sectionId&&String(ee.sectionId)!==String(Qe))return!1;if(D&&ee.subjectId){if(String(ee.subjectId)===String(D))return!0;if(Z){const xe=G.find(we=>we.id===ee.subjectId);if(((ye=xe==null?void 0:xe.name)==null?void 0:ye.trim())===Z)return!0}return!1}return!0}),console.log(" Global Context Filter Applied (Relaxed):",{classId:Be,sectionId:Qe,subjectId:D,count:I.length})}}const _=I.map(Be=>{const Qe=x.get(Be==null?void 0:Be.taskId),D=parseFloat(Be==null?void 0:Be.maxPossibleScore)||parseFloat(Qe==null?void 0:Qe.maxScore)||100;let G=0,ce=0,Z=null,W=-1;if(D>0&&(Be!=null&&Be.scores))for(const[ye,xe]of Object.entries(Be.scores)){if(!B.has(String(ye)))continue;const Ee=(parseFloat(xe==null?void 0:xe.totalScore)||0)/D*100;G++,ce+=Ee,Ee>W&&(W=Ee,Z=ye)}const ee=A((Be==null?void 0:Be.taskDate)||(Be==null?void 0:Be.updatedAt)||(Be==null?void 0:Be.evaluationDate)||(Be==null?void 0:Be.createdAt)||(Qe==null?void 0:Qe.date));return{ev:Be,task:Qe,ts:ee,avgPct:G?ce/G:0,count:G,topStudentId:Z,topPct:W}}),T=_.length?_.reduce((Be,Qe)=>Be+Qe.avgPct,0)/_.length:0,K=m.groups.map(Be=>{const Qe=String(Be==null?void 0:Be.id),G=m.evaluations.filter(ce=>String(ce==null?void 0:ce.groupId)===Qe).map(ce=>{const Z=x.get(ce==null?void 0:ce.taskId),W=parseFloat(ce==null?void 0:ce.maxPossibleScore)||parseFloat(Z==null?void 0:Z.maxScore)||100;if(W<=0||!(ce!=null&&ce.scores))return 0;let ee=0,ye=0;for(const xe of Object.values(ce.scores)){const we=parseFloat(xe==null?void 0:xe.totalScore)||0;ee++,ye+=we/W*100}return ee?ye/ee:0});return{id:Qe,avg:G.length?G.reduce((ce,Z)=>ce+Z,0)/G.length:-1}}).filter(Be=>Be.avg>=0).sort((Be,Qe)=>Qe.avg-Be.avg).findIndex(Be=>Be.id===String(g));return{members:S,perEval:_,groupAvg:T,rank:K>=0?K+1:null}}async function h(g){var m,x,S;try{r.state.currentGroupId=g;const B=window.smartEvaluator;if((m=B==null?void 0:B.managers)!=null&&m.cacheManager)try{B.managers.cacheManager.clear("evaluations_data")}catch(se){console.warn("Failed to clear evaluations cache:",se)}const F=c(),N=F.groups.find(se=>String(se==null?void 0:se.id)===String(g));if(!N)return;const{perEval:E,groupAvg:w,rank:v}=d(g,F),I=(N==null?void 0:N.name)||(N==null?void 0:N.label)||g,k=e("gdmTitle");k&&(k.textContent="  ");const _=e("gdmGroupName");_&&(_.textContent=I);const T=e("gdmGroupAvg");T&&(T.textContent=`${(w||0).toFixed(1)}%`);const L=e("gdmGroupRank");L&&(L.textContent=v?t(v):"-");try{const se=e("gdmAssignSelect"),X=e("gdmAssignBody"),$=e("gdmAssignMeta");if(se&&X){const V=(x=X.closest("table"))==null?void 0:x.querySelector("thead tr");if(V&&!V.querySelector(".gdm-dynamic-header")){const O=document.createElement("th");O.className="px-3 py-2 text-center whitespace-nowrap gdm-dynamic-header",O.textContent="";const H=document.createElement("th");H.className="px-3 py-2 text-center whitespace-nowrap gdm-dynamic-header",H.textContent="",V.children.length>=3&&(V.insertBefore(H,V.children[3]),V.insertBefore(O,V.children[3]))}const he=E.slice().sort((O,H)=>(H.ts||0)-(O.ts||0)),z=O=>{var le,fe,ve;if(!O)return"Unknown Task";const H=((le=F.classes.find(Ce=>Ce.id===O.classId))==null?void 0:le.name)||"",J=((fe=F.sections.find(Ce=>Ce.id===O.sectionId))==null?void 0:fe.name)||"",de=((ve=F.subjects.find(Ce=>Ce.id===O.subjectId))==null?void 0:ve.name)||"";let ie="";return H&&(ie+=`${H} `),J&&(ie+=`(${J}) `),de&&(ie+=`- ${de}`),ie?`${ie.trim()} : ${O.name}`:O.name};se.innerHTML=he.map((O,H)=>{const J=O.ts?new Date(O.ts).toISOString().slice(0,10):"-",de=z(O.task);return`<option value="${H}">${n(de)} (${J})</option>`}).join("");const M=O=>{var Ce,Be,Qe,D,G;const H=he[O|0];if(!H){X.innerHTML="";const ce=e("gdmAssignAvg");ce&&(ce.textContent="-"),$&&($.textContent="Task: - | Date: -");const Z=e("gdmAssignName");Z&&(Z.textContent="");const W=e("gdmAssignTitle");W&&(W.textContent="Assignment-wise Details");return}try{const ce=H.ts?new Date(H.ts).toISOString().slice(0,10):"-",Z=((Ce=H.task)==null?void 0:Ce.name)||`Assignment-${O+1}`;if($){const ye=H.task,xe=((Be=F.classes.find(Ne=>Ne.id===(ye==null?void 0:ye.classId)))==null?void 0:Be.name)||"",we=((Qe=F.sections.find(Ne=>Ne.id===(ye==null?void 0:ye.sectionId)))==null?void 0:Qe.name)||"",Ee=((D=F.subjects.find(Ne=>Ne.id===(ye==null?void 0:ye.subjectId)))==null?void 0:D.name)||"";$.innerHTML=`
                    <div class="flex flex-col gap-2 mb-2">
                        <div class="flex flex-wrap items-center gap-2 text-sm">
                            ${xe?`<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300 border border-blue-200 dark:border-blue-700 shadow-sm"><i class="fas fa-layer-group mr-1.5"></i>${n(xe)}</span>`:""}
                            ${we?`<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300 border border-purple-200 dark:border-purple-700 shadow-sm"><i class="fas fa-puzzle-piece mr-1.5"></i>${n(we)}</span>`:""}
                            ${Ee?`<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-emerald-100 text-emerald-800 dark:bg-emerald-900 dark:text-emerald-300 border border-emerald-200 dark:border-emerald-700 shadow-sm"><i class="fas fa-book mr-1.5"></i>${n(Ee)}</span>`:""}
                             <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300 border border-gray-200 dark:border-gray-600 shadow-sm ml-auto"><i class="far fa-calendar-alt mr-1.5"></i>${ce}</span>
                        </div>
                        <div class="flex items-start gap-2 mt-1">
                            <div class="mt-1 p-1.5 rounded bg-indigo-50 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-400">
                                <i class="fas fa-tasks text-sm"></i>
                            </div>
                            <div>
                                <h3 class="text-lg font-bold text-gray-900 dark:text-white leading-tight">${n(Z)}</h3>
                                <p class="text-xs text-gray-500 dark:text-gray-400 mt-0.5">ASSIGNMENT DETAILS</p>
                            </div>
                        </div>
                    </div>
                 `}const W=e("gdmAssignName");W&&(W.textContent=Z);const ee=e("gdmAssignTitle");ee&&(ee.textContent="Assignment-wise Details")}catch{}const J=e("gdmAssignAvg");J&&(J.textContent=(H.avgPct||0).toFixed(1)+"%");const de=((G=H.ev)==null?void 0:G.scores)||{},ie=new Map(F.classes.map(ce=>[ce.id,ce])),le=new Map(F.sections.map(ce=>[ce.id,ce])),fe=F.students.filter(ce=>String(ce.groupId)===String(g)).map(ce=>{var tt,rt,ft,St,yt;const Z=de[ce.id],W=parseFloat(Z==null?void 0:Z.taskScore)||0,ee=parseFloat(Z==null?void 0:Z.teamScore)||0,ye=parseFloat(Z==null?void 0:Z.ProgressScore)||0,xe=parseFloat(Z==null?void 0:Z.mcqScore)||0,we=parseFloat(Z==null?void 0:Z.totalScore)||W+ee+ye+xe,Ee=parseFloat((tt=H.ev)==null?void 0:tt.maxPossibleScore)||parseFloat((rt=H.task)==null?void 0:rt.maxScore)||100,Ne=Ee>0?we/Ee*100:0,Ue=ce.role||ce.duty||"",je=s(Ue),st=je?`<span class="inline-flex items-center gap-1 rounded-full border px-2 py-0.5 text-[11px] font-semibold ${i(Ue)}"><i class="fas fa-id-badge"></i>${n(je)}</span>`:"-",Ze=typeof(Z==null?void 0:Z.comments)=="string"?Z.comments.trim():"",ct=ce.academicGroup||ce.academic_group||ce.academic||"",wt=o(ct),it=((ft=ie.get(ce.classId))==null?void 0:ft.name)||"-",lt=((St=le.get(ce.sectionId))==null?void 0:St.name)||"-";return{roll:ce.roll||ce.studentRoll||ce.classRoll||ce.rollNumber||null,badge:st,name:ce.name||ce.id,agName:ct,agClass:wt,className:it,sectionName:lt,agName:ct,agClass:wt,taskScore:W,teamScore:ee,Progress:ye,mcq:xe,total:we,pct:Ne,comment:Ze,taskScore:W,teamScore:ee,Progress:ye,mcq:xe,total:we,pct:Ne,comment:Ze,problemRecovered:(Z==null?void 0:Z.problemRecovered)||!1,topic:((yt=Z==null?void 0:Z.ProgressCriteria)==null?void 0:yt.topic)||null}}).filter(ce=>Number.isFinite(ce.total)).sort((ce,Z)=>Z.pct-ce.pct),ve=document.createDocumentFragment();fe.forEach(ce=>{const Z=document.createElement("tr"),W=l(ce.pct),ee=ce.comment.length>120?ce.comment.slice(0,117)+".":ce.comment;Z.innerHTML=`
                <td class="px-3 py-2 whitespace-nowrap">${t(ce.roll??"-")}</td>
                <td class="px-3 py-2 whitespace-nowrap">
                  ${ce.badge}
                </td>
                <td class="px-3 py-2 whitespace-nowrap">
                  <span class="font-medium">${n(ce.name)}</span>
                  ${ce.agName?`<span class="ml-2 inline-flex items-center gap-1 rounded-full border px-2 py-0.5 text-[11px] font-semibold ${ce.agClass}"><i class="fas fa-graduation-cap"></i>${n(ce.agName)}</span>`:""}
                </td>
                <td class="px-3 py-2 whitespace-nowrap text-center">${n(ce.className)}</td>
                <td class="px-3 py-2 whitespace-nowrap text-center">${n(ce.sectionName)}</td>
                <td class="px-3 py-2 text-right">${ce.taskScore.toFixed(2)}</td>
                <td class="px-3 py-2 text-right">${ce.teamScore.toFixed(2)}</td>
                <td class="px-3 py-2 text-right">${ce.Progress.toFixed(2)}</td>
                <td class="px-3 py-2 text-right">${ce.mcq.toFixed(2)}</td>
                <td class="px-3 py-2 text-right font-semibold">${ce.total.toFixed(2)}</td>
                <td class="px-3 py-2 text-right"><span class="inline-block rounded px-2 py-0.5 text-xs font-semibold ${W}">${ce.pct.toFixed(1)}%</span></td>
                <td class="px-3 py-2 text-center whitespace-nowrap">
                  ${(()=>{const ye=ce.topic;return ye==="topic_understood"||ye==="topic_none"?ce.problemRecovered?'<span class="inline-flex items-center gap-1 rounded border border-green-200 bg-green-50 px-1.5 py-0.5 text-[10px] font-medium text-green-700 dark:border-green-800 dark:bg-green-900/20 dark:text-green-300"><i class="fas fa-check-circle text-[10px]"></i>  </span>':'<span class="inline-flex items-center gap-1 rounded border border-red-200 bg-red-50 px-1.5 py-0.5 text-[10px] font-medium text-red-700 dark:border-red-800 dark:bg-red-900/20 dark:text-red-300"><i class="fas fa-exclamation-circle text-[10px]"></i>  </span>':ye==="topic_learned_well"&&ce.problemRecovered?'<span class="inline-flex items-center gap-1 rounded border border-green-200 bg-green-50 px-1.5 py-0.5 text-[10px] font-medium text-green-700 dark:border-green-800 dark:bg-green-900/20 dark:text-green-300"><i class="fas fa-check-circle text-[10px]"></i>  </span>':"-"})()}
                </td>
                <td class="px-3 py-2 comments-cell">${n(ee)}</td>`,ve.appendChild(Z)}),X.innerHTML="",X.appendChild(ve)};M(0),se.onchange=O=>{const H=parseInt(O.target.value,10)||0;M(H)}}}catch{}const K=e("gdmEvalsBody");if(K){K.innerHTML="";const se=E.slice().sort((V,he)=>(he.ts||0)-(V.ts||0)),X=document.createDocumentFragment(),$=new Map(F.students.map(V=>[String(V==null?void 0:V.id),(V==null?void 0:V.name)||(V==null?void 0:V.id)]));se.forEach((V,he)=>{var H;const z=document.createElement("tr"),M=V.ts?new Date(V.ts).toISOString().slice(0,10):"-",O=V.topStudentId?$.get(String(V.topStudentId))||V.topStudentId:"-";z.innerHTML=`
            <td class="px-3 py-2 whitespace-nowrap">${n(((H=V.task)==null?void 0:H.name)||`Assignment-${he+1}`)}</td>
            <td class="px-3 py-2 whitespace-nowrap">${M}</td>
            <td class="px-3 py-2">${V.count}</td>
            <td class="px-3 py-2">${V.avgPct.toFixed(1)}%</td>
            <td class="px-3 py-2 whitespace-nowrap">${n(O)}</td>`,X.appendChild(z)}),K.appendChild(X)}(S=r.els.modal)==null||S.classList.remove("hidden"),u("members")}catch(B){console.error("[GDM] renderGroupModal failed:",B)}}function u(g){var x,S,B,F;const m=g==="members";(x=r.els.members)==null||x.classList.toggle("hidden",!m),(S=r.els.evals)==null||S.classList.toggle("hidden",m),(B=r.els.btnMembers)==null||B.classList.toggle("bg-gray-100",m),(F=r.els.btnEvals)==null||F.classList.toggle("bg-gray-100",!m)}function p(){var g,m,x;r.bound||(r.bound=!0,document.addEventListener("click",S=>{var B;S.target.closest("[data-group-modal-close]")&&((B=r.els.modal)==null||B.classList.add("hidden"))}),(g=r.els.btnMembers)==null||g.addEventListener("click",()=>u("members")),(m=r.els.btnEvals)==null||m.addEventListener("click",()=>u("evals")),(x=r.els.btnPrint)==null||x.addEventListener("click",()=>{var k,_;const S=window.smartEvaluator;if(!((_=(k=S==null?void 0:S.components)==null?void 0:k.analysis)!=null&&_.generateGroupWiseFullDetailsPDF)){console.warn("PDF generator not found");return}const B=r.state.currentGroupId;if(!B)return;let F="all";const N=r.els.assignSelect;if(N&&N.value){const T=c(),{perEval:L}=d(B,T),K=L.slice().sort(($,V)=>(V.ts||0)-($.ts||0)),se=parseInt(N.value,10)||0,X=K[se];X&&X.task&&(F=X.task.id)}S.managers.uiManager.showToast("PDF  ...","info");const{groups:E,students:w,tasks:v,evaluations:I}=c();S.components.analysis.generateGroupWiseFullDetailsPDF(F,B)}))}function f(){if(r.els.modal=e("groupDetailModal"),r.els.btnMembers=e("gdmBtnMembers"),r.els.btnEvals=e("gdmBtnEvals"),r.els.btnPrint=e("gdmBtnPrint"),r.els.members=e("gdmMembersWrap"),r.els.evals=e("gdmEvalsWrap"),r.els.assignSelect=e("gdmAssignSelect"),!r.els.modal){console.warn("[GDM] modal node missing; script loaded but no #groupDetailModal.");return}p(),window.openGroupModalById||(window.openGroupModalById=h)}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",f,{once:!0}):f()})();document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll("img:not([loading])").forEach(t=>{t.dataset.priority||(t.loading="lazy",t.decoding=t.decoding||"async")});const e=()=>{document.documentElement.classList.add("perf-hydrated")};"requestIdleCallback"in window?requestIdleCallback(e,{timeout:2e3}):setTimeout(e,1500)});kt.prototype.autoTable=function(...r){return n2(this,...r)};kt.API=kt.API||{};kt.API.autoTable=function(...r){return n2(this,...r)};bh.register(...dT,Hx,ZT);typeof window<"u"&&(window.Chart=bh,window.ChartDataLabels=Hx,window.ChartZoom=ZT,window.html2canvas=nF,window.jsPDF=kt,window.jspdf=window.jspdf||{},window.jspdf.jsPDF=kt,window.jspdf.autoTable=n2,window.JSZip=SY,window.Papa=TY);export{nn as _,Jp as c,jx as g};
